(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function pg(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const un={},Mc=[],la=()=>{},qw=()=>!1,ah=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),dg=t=>t.startsWith("onUpdate:"),dr=Object.assign,gg=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Xw=Object.prototype.hasOwnProperty,Zt=(t,e)=>Xw.call(t,e),Nt=Array.isArray,Iu=t=>oh(t)==="[object Map]",Yw=t=>oh(t)==="[object Set]",Ft=t=>typeof t=="function",Zn=t=>typeof t=="string",Zc=t=>typeof t=="symbol",Gn=t=>t!==null&&typeof t=="object",Yy=t=>(Gn(t)||Ft(t))&&Ft(t.then)&&Ft(t.catch),Jw=Object.prototype.toString,oh=t=>Jw.call(t),Zw=t=>oh(t).slice(8,-1),Qw=t=>oh(t)==="[object Object]",mg=t=>Zn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Pu=pg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),sh=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},eC=/-(\w)/g,es=sh(t=>t.replace(eC,(e,n)=>n?n.toUpperCase():"")),tC=/\B([A-Z])/g,fc=sh(t=>t.replace(tC,"-$1").toLowerCase()),Jy=sh(t=>t.charAt(0).toUpperCase()+t.slice(1)),zh=sh(t=>t?`on${Jy(t)}`:""),Yo=(t,e)=>!Object.is(t,e),jh=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},od=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},nC=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let O2;const ch=()=>O2||(O2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function vg(t){if(Nt(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=Zn(r)?oC(r):vg(r);if(i)for(const a in i)e[a]=i[a]}return e}else if(Zn(t)||Gn(t))return t}const rC=/;(?![^(]*\))/g,iC=/:([^]+)/,aC=/\/\*[^]*?\*\//g;function oC(t){const e={};return t.replace(aC,"").split(rC).forEach(n=>{if(n){const r=n.split(iC);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function yg(t){let e="";if(Zn(t))e=t;else if(Nt(t))for(let n=0;n<t.length;n++){const r=yg(t[n]);r&&(e+=r+" ")}else if(Gn(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const sC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",cC=pg(sC);function Zy(t){return!!t||t===""}/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wr;class uC{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wr,!e&&Wr&&(this.index=(Wr.scopes||(Wr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Wr;try{return Wr=this,e()}finally{Wr=n}}}on(){++this._on===1&&(this.prevScope=Wr,Wr=this)}off(){this._on>0&&--this._on===0&&(Wr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function lC(){return Wr}let cn;const $h=new WeakSet;class Qy{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wr&&Wr.active&&Wr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,$h.has(this)&&($h.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||t5(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,R2(this),n5(this);const e=cn,n=Wi;cn=this,Wi=!0;try{return this.fn()}finally{r5(this),cn=e,Wi=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Cg(e);this.deps=this.depsTail=void 0,R2(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?$h.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){sd(this)&&this.run()}get dirty(){return sd(this)}}let e5=0,Vu,ku;function t5(t,e=!1){if(t.flags|=8,e){t.next=ku,ku=t;return}t.next=Vu,Vu=t}function xg(){e5++}function wg(){if(--e5>0)return;if(ku){let e=ku;for(ku=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Vu;){let e=Vu;for(Vu=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function n5(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function r5(t){let e,n=t.depsTail,r=n;for(;r;){const i=r.prevDep;r.version===-1?(r===n&&(n=i),Cg(r),fC(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}t.deps=e,t.depsTail=n}function sd(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(i5(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function i5(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===rl)||(t.globalVersion=rl,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!sd(t))))return;t.flags|=2;const e=t.dep,n=cn,r=Wi;cn=t,Wi=!0;try{n5(t);const i=t.fn(t._value);(e.version===0||Yo(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{cn=n,Wi=r,r5(t),t.flags&=-3}}function Cg(t,e=!1){const{dep:n,prevSub:r,nextSub:i}=t;if(r&&(r.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let a=n.computed.deps;a;a=a.nextDep)Cg(a,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function fC(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Wi=!0;const a5=[];function eo(){a5.push(Wi),Wi=!1}function to(){const t=a5.pop();Wi=t===void 0?!0:t}function R2(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=cn;cn=void 0;try{e()}finally{cn=n}}}let rl=0;class hC{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Tg{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!cn||!Wi||cn===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==cn)n=this.activeLink=new hC(cn,this),cn.deps?(n.prevDep=cn.depsTail,cn.depsTail.nextDep=n,cn.depsTail=n):cn.deps=cn.depsTail=n,o5(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=cn.depsTail,n.nextDep=void 0,cn.depsTail.nextDep=n,cn.depsTail=n,cn.deps===n&&(cn.deps=r)}return n}trigger(e){this.version++,rl++,this.notify(e)}notify(e){xg();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{wg()}}}function o5(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)o5(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const cd=new WeakMap,ec=Symbol(""),ud=Symbol(""),il=Symbol("");function fr(t,e,n){if(Wi&&cn){let r=cd.get(t);r||cd.set(t,r=new Map);let i=r.get(n);i||(r.set(n,i=new Tg),i.map=r,i.key=n),i.track()}}function ja(t,e,n,r,i,a){const o=cd.get(t);if(!o){rl++;return}const s=c=>{c&&c.trigger()};if(xg(),e==="clear")o.forEach(s);else{const c=Nt(t),l=c&&mg(n);if(c&&n==="length"){const f=Number(r);o.forEach((u,h)=>{(h==="length"||h===il||!Zc(h)&&h>=f)&&s(u)})}else switch((n!==void 0||o.has(void 0))&&s(o.get(n)),l&&s(o.get(il)),e){case"add":c?l&&s(o.get("length")):(s(o.get(ec)),Iu(t)&&s(o.get(ud)));break;case"delete":c||(s(o.get(ec)),Iu(t)&&s(o.get(ud)));break;case"set":Iu(t)&&s(o.get(ec));break}}wg()}function dc(t){const e=Jt(t);return e===t?e:(fr(e,"iterate",il),zi(t)?e:e.map(Nr))}function _g(t){return fr(t=Jt(t),"iterate",il),t}const pC={__proto__:null,[Symbol.iterator](){return Hh(this,Symbol.iterator,Nr)},concat(...t){return dc(this).concat(...t.map(e=>Nt(e)?dc(e):e))},entries(){return Hh(this,"entries",t=>(t[1]=Nr(t[1]),t))},every(t,e){return Fa(this,"every",t,e,void 0,arguments)},filter(t,e){return Fa(this,"filter",t,e,n=>n.map(Nr),arguments)},find(t,e){return Fa(this,"find",t,e,Nr,arguments)},findIndex(t,e){return Fa(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Fa(this,"findLast",t,e,Nr,arguments)},findLastIndex(t,e){return Fa(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Fa(this,"forEach",t,e,void 0,arguments)},includes(...t){return Kh(this,"includes",t)},indexOf(...t){return Kh(this,"indexOf",t)},join(t){return dc(this).join(t)},lastIndexOf(...t){return Kh(this,"lastIndexOf",t)},map(t,e){return Fa(this,"map",t,e,void 0,arguments)},pop(){return lu(this,"pop")},push(...t){return lu(this,"push",t)},reduce(t,...e){return M2(this,"reduce",t,e)},reduceRight(t,...e){return M2(this,"reduceRight",t,e)},shift(){return lu(this,"shift")},some(t,e){return Fa(this,"some",t,e,void 0,arguments)},splice(...t){return lu(this,"splice",t)},toReversed(){return dc(this).toReversed()},toSorted(t){return dc(this).toSorted(t)},toSpliced(...t){return dc(this).toSpliced(...t)},unshift(...t){return lu(this,"unshift",t)},values(){return Hh(this,"values",Nr)}};function Hh(t,e,n){const r=_g(t),i=r[e]();return r!==t&&!zi(t)&&(i._next=i.next,i.next=()=>{const a=i._next();return a.value&&(a.value=n(a.value)),a}),i}const dC=Array.prototype;function Fa(t,e,n,r,i,a){const o=_g(t),s=o!==t&&!zi(t),c=o[e];if(c!==dC[e]){const u=c.apply(t,a);return s?Nr(u):u}let l=n;o!==t&&(s?l=function(u,h){return n.call(this,Nr(u),h,t)}:n.length>2&&(l=function(u,h){return n.call(this,u,h,t)}));const f=c.call(o,l,r);return s&&i?i(f):f}function M2(t,e,n,r){const i=_g(t);let a=n;return i!==t&&(zi(t)?n.length>3&&(a=function(o,s,c){return n.call(this,o,s,c,t)}):a=function(o,s,c){return n.call(this,o,Nr(s),c,t)}),i[e](a,...r)}function Kh(t,e,n){const r=Jt(t);fr(r,"iterate",il);const i=r[e](...n);return(i===-1||i===!1)&&Dg(n[0])?(n[0]=Jt(n[0]),r[e](...n)):i}function lu(t,e,n=[]){eo(),xg();const r=Jt(t)[e].apply(t,n);return wg(),to(),r}const gC=pg("__proto__,__v_isRef,__isVue"),s5=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Zc));function mC(t){Zc(t)||(t=String(t));const e=Jt(this);return fr(e,"has",t),e.hasOwnProperty(t)}class c5{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return a;if(n==="__v_raw")return r===(i?a?EC:h5:a?f5:l5).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Nt(e);if(!i){let c;if(o&&(c=pC[n]))return c;if(n==="hasOwnProperty")return mC}const s=Reflect.get(e,n,pr(e)?e:r);return(Zc(n)?s5.has(n):gC(n))||(i||fr(e,"get",n),a)?s:pr(s)?o&&mg(n)?s:s.value:Gn(s)?i?p5(s):bg(s):s}}class u5 extends c5{constructor(e=!1){super(!1,e)}set(e,n,r,i){let a=e[n];if(!this._isShallow){const c=rc(a);if(!zi(r)&&!rc(r)&&(a=Jt(a),r=Jt(r)),!Nt(e)&&pr(a)&&!pr(r))return c?!1:(a.value=r,!0)}const o=Nt(e)&&mg(n)?Number(n)<e.length:Zt(e,n),s=Reflect.set(e,n,r,pr(e)?e:i);return e===Jt(i)&&(o?Yo(r,a)&&ja(e,"set",n,r):ja(e,"add",n,r)),s}deleteProperty(e,n){const r=Zt(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&r&&ja(e,"delete",n,void 0),i}has(e,n){const r=Reflect.has(e,n);return(!Zc(n)||!s5.has(n))&&fr(e,"has",n),r}ownKeys(e){return fr(e,"iterate",Nt(e)?"length":ec),Reflect.ownKeys(e)}}class vC extends c5{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const yC=new u5,xC=new vC,wC=new u5(!0);const ld=t=>t,Xl=t=>Reflect.getPrototypeOf(t);function CC(t,e,n){return function(...r){const i=this.__v_raw,a=Jt(i),o=Iu(a),s=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=i[t](...r),f=n?ld:e?fd:Nr;return!e&&fr(a,"iterate",c?ud:ec),{next(){const{value:u,done:h}=l.next();return h?{value:u,done:h}:{value:s?[f(u[0]),f(u[1])]:f(u),done:h}},[Symbol.iterator](){return this}}}}function Yl(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function TC(t,e){const n={get(i){const a=this.__v_raw,o=Jt(a),s=Jt(i);t||(Yo(i,s)&&fr(o,"get",i),fr(o,"get",s));const{has:c}=Xl(o),l=e?ld:t?fd:Nr;if(c.call(o,i))return l(a.get(i));if(c.call(o,s))return l(a.get(s));a!==o&&a.get(i)},get size(){const i=this.__v_raw;return!t&&fr(Jt(i),"iterate",ec),Reflect.get(i,"size",i)},has(i){const a=this.__v_raw,o=Jt(a),s=Jt(i);return t||(Yo(i,s)&&fr(o,"has",i),fr(o,"has",s)),i===s?a.has(i):a.has(i)||a.has(s)},forEach(i,a){const o=this,s=o.__v_raw,c=Jt(s),l=e?ld:t?fd:Nr;return!t&&fr(c,"iterate",ec),s.forEach((f,u)=>i.call(a,l(f),l(u),o))}};return dr(n,t?{add:Yl("add"),set:Yl("set"),delete:Yl("delete"),clear:Yl("clear")}:{add(i){!e&&!zi(i)&&!rc(i)&&(i=Jt(i));const a=Jt(this);return Xl(a).has.call(a,i)||(a.add(i),ja(a,"add",i,i)),this},set(i,a){!e&&!zi(a)&&!rc(a)&&(a=Jt(a));const o=Jt(this),{has:s,get:c}=Xl(o);let l=s.call(o,i);l||(i=Jt(i),l=s.call(o,i));const f=c.call(o,i);return o.set(i,a),l?Yo(a,f)&&ja(o,"set",i,a):ja(o,"add",i,a),this},delete(i){const a=Jt(this),{has:o,get:s}=Xl(a);let c=o.call(a,i);c||(i=Jt(i),c=o.call(a,i)),s&&s.call(a,i);const l=a.delete(i);return c&&ja(a,"delete",i,void 0),l},clear(){const i=Jt(this),a=i.size!==0,o=i.clear();return a&&ja(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=CC(i,t,e)}),n}function Sg(t,e){const n=TC(t,e);return(r,i,a)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(Zt(n,i)&&i in r?n:r,i,a)}const _C={get:Sg(!1,!1)},SC={get:Sg(!1,!0)},bC={get:Sg(!0,!1)};const l5=new WeakMap,f5=new WeakMap,h5=new WeakMap,EC=new WeakMap;function DC(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function OC(t){return t.__v_skip||!Object.isExtensible(t)?0:DC(Zw(t))}function bg(t){return rc(t)?t:Eg(t,!1,yC,_C,l5)}function RC(t){return Eg(t,!1,wC,SC,f5)}function p5(t){return Eg(t,!0,xC,bC,h5)}function Eg(t,e,n,r,i){if(!Gn(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const a=OC(t);if(a===0)return t;const o=i.get(t);if(o)return o;const s=new Proxy(t,a===2?r:n);return i.set(t,s),s}function Uu(t){return rc(t)?Uu(t.__v_raw):!!(t&&t.__v_isReactive)}function rc(t){return!!(t&&t.__v_isReadonly)}function zi(t){return!!(t&&t.__v_isShallow)}function Dg(t){return t?!!t.__v_raw:!1}function Jt(t){const e=t&&t.__v_raw;return e?Jt(e):t}function MC(t){return!Zt(t,"__v_skip")&&Object.isExtensible(t)&&od(t,"__v_skip",!0),t}const Nr=t=>Gn(t)?bg(t):t,fd=t=>Gn(t)?p5(t):t;function pr(t){return t?t.__v_isRef===!0:!1}function NC(t){return LC(t,!1)}function LC(t,e){return pr(t)?t:new AC(t,e)}class AC{constructor(e,n){this.dep=new Tg,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Jt(e),this._value=n?e:Nr(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||zi(e)||rc(e);e=r?e:Jt(e),Yo(e,n)&&(this._rawValue=e,this._value=r?e:Nr(e),this.dep.trigger())}}function FC(t){return pr(t)?t.value:t}const IC={get:(t,e,n)=>e==="__v_raw"?t:FC(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return pr(i)&&!pr(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function d5(t){return Uu(t)?t:new Proxy(t,IC)}class PC{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Tg(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=rl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&cn!==this)return t5(this,!0),!0}get value(){const e=this.dep.track();return i5(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function VC(t,e,n=!1){let r,i;return Ft(t)?r=t:(r=t.get,i=t.set),new PC(r,i,n)}const Jl={},lf=new WeakMap;let Bs;function kC(t,e=!1,n=Bs){if(n){let r=lf.get(n);r||lf.set(n,r=[]),r.push(t)}}function UC(t,e,n=un){const{immediate:r,deep:i,once:a,scheduler:o,augmentJob:s,call:c}=n,l=w=>i?w:zi(w)||i===!1||i===0?Bo(w,1):Bo(w);let f,u,h,p,d=!1,g=!1;if(pr(t)?(u=()=>t.value,d=zi(t)):Uu(t)?(u=()=>l(t),d=!0):Nt(t)?(g=!0,d=t.some(w=>Uu(w)||zi(w)),u=()=>t.map(w=>{if(pr(w))return w.value;if(Uu(w))return l(w);if(Ft(w))return c?c(w,2):w()})):Ft(t)?e?u=c?()=>c(t,2):t:u=()=>{if(h){eo();try{h()}finally{to()}}const w=Bs;Bs=f;try{return c?c(t,3,[p]):t(p)}finally{Bs=w}}:u=la,e&&i){const w=u,C=i===!0?1/0:i;u=()=>Bo(w(),C)}const y=lC(),x=()=>{f.stop(),y&&y.active&&gg(y.effects,f)};if(a&&e){const w=e;e=(...C)=>{w(...C),x()}}let m=g?new Array(t.length).fill(Jl):Jl;const v=w=>{if(!(!(f.flags&1)||!f.dirty&&!w))if(e){const C=f.run();if(i||d||(g?C.some((T,_)=>Yo(T,m[_])):Yo(C,m))){h&&h();const T=Bs;Bs=f;try{const _=[C,m===Jl?void 0:g&&m[0]===Jl?[]:m,p];m=C,c?c(e,3,_):e(..._)}finally{Bs=T}}}else f.run()};return s&&s(v),f=new Qy(u),f.scheduler=o?()=>o(v,!1):v,p=w=>kC(w,!1,f),h=f.onStop=()=>{const w=lf.get(f);if(w){if(c)c(w,4);else for(const C of w)C();lf.delete(f)}},e?r?v(!0):m=f.run():o?o(v.bind(null,!0),!0):f.run(),x.pause=f.pause.bind(f),x.resume=f.resume.bind(f),x.stop=x,x}function Bo(t,e=1/0,n){if(e<=0||!Gn(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,pr(t))Bo(t.value,e,n);else if(Nt(t))for(let r=0;r<t.length;r++)Bo(t[r],e,n);else if(Yw(t)||Iu(t))t.forEach(r=>{Bo(r,e,n)});else if(Qw(t)){for(const r in t)Bo(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Bo(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function El(t,e,n,r){try{return r?t(...r):t()}catch(i){uh(i,e,n)}}function pa(t,e,n,r){if(Ft(t)){const i=El(t,e,n,r);return i&&Yy(i)&&i.catch(a=>{uh(a,e,n)}),i}if(Nt(t)){const i=[];for(let a=0;a<t.length;a++)i.push(pa(t[a],e,n,r));return i}}function uh(t,e,n,r=!0){const i=e?e.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||un;if(e){let s=e.parent;const c=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;s;){const f=s.ec;if(f){for(let u=0;u<f.length;u++)if(f[u](t,c,l)===!1)return}s=s.parent}if(a){eo(),El(a,null,10,[t,c,l]),to();return}}BC(t,n,i,r,o)}function BC(t,e,n,r=!0,i=!1){if(i)throw t;console.error(t)}const Lr=[];let ra=-1;const Nc=[];let Vo=null,Cc=0;const g5=Promise.resolve();let ff=null;function GC(t){const e=ff||g5;return t?e.then(this?t.bind(this):t):e}function WC(t){let e=ra+1,n=Lr.length;for(;e<n;){const r=e+n>>>1,i=Lr[r],a=al(i);a<t||a===t&&i.flags&2?e=r+1:n=r}return e}function Og(t){if(!(t.flags&1)){const e=al(t),n=Lr[Lr.length-1];!n||!(t.flags&2)&&e>=al(n)?Lr.push(t):Lr.splice(WC(e),0,t),t.flags|=1,m5()}}function m5(){ff||(ff=g5.then(y5))}function zC(t){Nt(t)?Nc.push(...t):Vo&&t.id===-1?Vo.splice(Cc+1,0,t):t.flags&1||(Nc.push(t),t.flags|=1),m5()}function N2(t,e,n=ra+1){for(;n<Lr.length;n++){const r=Lr[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Lr.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function v5(t){if(Nc.length){const e=[...new Set(Nc)].sort((n,r)=>al(n)-al(r));if(Nc.length=0,Vo){Vo.push(...e);return}for(Vo=e,Cc=0;Cc<Vo.length;Cc++){const n=Vo[Cc];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Vo=null,Cc=0}}const al=t=>t.id==null?t.flags&2?-1:1/0:t.id;function y5(t){try{for(ra=0;ra<Lr.length;ra++){const e=Lr[ra];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),El(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ra<Lr.length;ra++){const e=Lr[ra];e&&(e.flags&=-2)}ra=-1,Lr.length=0,v5(),ff=null,(Lr.length||Nc.length)&&y5()}}let sa=null,x5=null;function hf(t){const e=sa;return sa=t,x5=t&&t.type.__scopeId||null,e}function jC(t,e=sa,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&B2(-1);const a=hf(e);let o;try{o=t(...i)}finally{hf(a),r._d&&B2(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Os(t,e,n,r){const i=t.dirs,a=e&&e.dirs;for(let o=0;o<i.length;o++){const s=i[o];a&&(s.oldValue=a[o].value);let c=s.dir[r];c&&(eo(),pa(c,n,8,[t.el,s,t,e]),to())}}const $C=Symbol("_vte"),HC=t=>t.__isTeleport;function Rg(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Rg(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function KC(t,e){return Ft(t)?dr({name:t.name},e,{setup:t}):t}function w5(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Bu(t,e,n,r,i=!1){if(Nt(t)){t.forEach((d,g)=>Bu(d,e&&(Nt(e)?e[g]:e),n,r,i));return}if(Gu(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Bu(t,e,n,r.component.subTree);return}const a=r.shapeFlag&4?Ag(r.component):r.el,o=i?null:a,{i:s,r:c}=t,l=e&&e.r,f=s.refs===un?s.refs={}:s.refs,u=s.setupState,h=Jt(u),p=u===un?()=>!1:d=>Zt(h,d);if(l!=null&&l!==c&&(Zn(l)?(f[l]=null,p(l)&&(u[l]=null)):pr(l)&&(l.value=null)),Ft(c))El(c,s,12,[o,f]);else{const d=Zn(c),g=pr(c);if(d||g){const y=()=>{if(t.f){const x=d?p(c)?u[c]:f[c]:c.value;i?Nt(x)&&gg(x,a):Nt(x)?x.includes(a)||x.push(a):d?(f[c]=[a],p(c)&&(u[c]=f[c])):(c.value=[a],t.k&&(f[t.k]=c.value))}else d?(f[c]=o,p(c)&&(u[c]=o)):g&&(c.value=o,t.k&&(f[t.k]=o))};o?(y.id=-1,Qr(y,n)):y()}}}ch().requestIdleCallback;ch().cancelIdleCallback;const Gu=t=>!!t.type.__asyncLoader,C5=t=>t.type.__isKeepAlive;function qC(t,e){T5(t,"a",e)}function XC(t,e){T5(t,"da",e)}function T5(t,e,n=Fr){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(lh(e,r,n),n){let i=n.parent;for(;i&&i.parent;)C5(i.parent.vnode)&&YC(r,e,n,i),i=i.parent}}function YC(t,e,n,r){const i=lh(e,t,r,!0);S5(()=>{gg(r[e],i)},n)}function lh(t,e,n=Fr,r=!1){if(n){const i=n[t]||(n[t]=[]),a=e.__weh||(e.__weh=(...o)=>{eo();const s=Dl(n),c=pa(e,n,t,o);return s(),to(),c});return r?i.unshift(a):i.push(a),a}}const ao=t=>(e,n=Fr)=>{(!sl||t==="sp")&&lh(t,(...r)=>e(...r),n)},JC=ao("bm"),_5=ao("m"),ZC=ao("bu"),QC=ao("u"),eT=ao("bum"),S5=ao("um"),tT=ao("sp"),nT=ao("rtg"),rT=ao("rtc");function iT(t,e=Fr){lh("ec",t,e)}const aT=Symbol.for("v-ndc"),hd=t=>t?K5(t)?Ag(t):hd(t.parent):null,Wu=dr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>hd(t.parent),$root:t=>hd(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>E5(t),$forceUpdate:t=>t.f||(t.f=()=>{Og(t.update)}),$nextTick:t=>t.n||(t.n=GC.bind(t.proxy)),$watch:t=>DT.bind(t)}),qh=(t,e)=>t!==un&&!t.__isScriptSetup&&Zt(t,e),oT={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:i,props:a,accessCache:o,type:s,appContext:c}=t;let l;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return a[e]}else{if(qh(r,e))return o[e]=1,r[e];if(i!==un&&Zt(i,e))return o[e]=2,i[e];if((l=t.propsOptions[0])&&Zt(l,e))return o[e]=3,a[e];if(n!==un&&Zt(n,e))return o[e]=4,n[e];pd&&(o[e]=0)}}const f=Wu[e];let u,h;if(f)return e==="$attrs"&&fr(t.attrs,"get",""),f(t);if((u=s.__cssModules)&&(u=u[e]))return u;if(n!==un&&Zt(n,e))return o[e]=4,n[e];if(h=c.config.globalProperties,Zt(h,e))return h[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:a}=t;return qh(i,e)?(i[e]=n,!0):r!==un&&Zt(r,e)?(r[e]=n,!0):Zt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(a[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:a}},o){let s;return!!n[o]||t!==un&&Zt(t,o)||qh(e,o)||(s=a[0])&&Zt(s,o)||Zt(r,o)||Zt(Wu,o)||Zt(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Zt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function L2(t){return Nt(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let pd=!0;function sT(t){const e=E5(t),n=t.proxy,r=t.ctx;pd=!1,e.beforeCreate&&A2(e.beforeCreate,t,"bc");const{data:i,computed:a,methods:o,watch:s,provide:c,inject:l,created:f,beforeMount:u,mounted:h,beforeUpdate:p,updated:d,activated:g,deactivated:y,beforeDestroy:x,beforeUnmount:m,destroyed:v,unmounted:w,render:C,renderTracked:T,renderTriggered:_,errorCaptured:S,serverPrefetch:b,expose:D,inheritAttrs:E,components:R,directives:F,filters:M}=e;if(l&&cT(l,r,null),o)for(const Y in o){const W=o[Y];Ft(W)&&(r[Y]=W.bind(n))}if(i){const Y=i.call(n,n);Gn(Y)&&(t.data=bg(Y))}if(pd=!0,a)for(const Y in a){const W=a[Y],B=Ft(W)?W.bind(n,n):Ft(W.get)?W.get.bind(n,n):la,j=!Ft(W)&&Ft(W.set)?W.set.bind(n):la,ie=XT({get:B,set:j});Object.defineProperty(r,Y,{enumerable:!0,configurable:!0,get:()=>ie.value,set:ae=>ie.value=ae})}if(s)for(const Y in s)b5(s[Y],r,n,Y);if(c){const Y=Ft(c)?c.call(n):c;Reflect.ownKeys(Y).forEach(W=>{dT(W,Y[W])})}f&&A2(f,t,"c");function z(Y,W){Nt(W)?W.forEach(B=>Y(B.bind(n))):W&&Y(W.bind(n))}if(z(JC,u),z(_5,h),z(ZC,p),z(QC,d),z(qC,g),z(XC,y),z(iT,S),z(rT,T),z(nT,_),z(eT,m),z(S5,w),z(tT,b),Nt(D))if(D.length){const Y=t.exposed||(t.exposed={});D.forEach(W=>{Object.defineProperty(Y,W,{get:()=>n[W],set:B=>n[W]=B})})}else t.exposed||(t.exposed={});C&&t.render===la&&(t.render=C),E!=null&&(t.inheritAttrs=E),R&&(t.components=R),F&&(t.directives=F),b&&w5(t)}function cT(t,e,n=la){Nt(t)&&(t=dd(t));for(const r in t){const i=t[r];let a;Gn(i)?"default"in i?a=L0(i.from||r,i.default,!0):a=L0(i.from||r):a=L0(i),pr(a)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):e[r]=a}}function A2(t,e,n){pa(Nt(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function b5(t,e,n,r){let i=r.includes(".")?U5(n,r):()=>n[r];if(Zn(t)){const a=e[t];Ft(a)&&Yh(i,a)}else if(Ft(t))Yh(i,t.bind(n));else if(Gn(t))if(Nt(t))t.forEach(a=>b5(a,e,n,r));else{const a=Ft(t.handler)?t.handler.bind(n):e[t.handler];Ft(a)&&Yh(i,a,t)}}function E5(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:a,config:{optionMergeStrategies:o}}=t.appContext,s=a.get(e);let c;return s?c=s:!i.length&&!n&&!r?c=e:(c={},i.length&&i.forEach(l=>pf(c,l,o,!0)),pf(c,e,o)),Gn(e)&&a.set(e,c),c}function pf(t,e,n,r=!1){const{mixins:i,extends:a}=e;a&&pf(t,a,n,!0),i&&i.forEach(o=>pf(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const s=uT[o]||n&&n[o];t[o]=s?s(t[o],e[o]):e[o]}return t}const uT={data:F2,props:I2,emits:I2,methods:_u,computed:_u,beforeCreate:Rr,created:Rr,beforeMount:Rr,mounted:Rr,beforeUpdate:Rr,updated:Rr,beforeDestroy:Rr,beforeUnmount:Rr,destroyed:Rr,unmounted:Rr,activated:Rr,deactivated:Rr,errorCaptured:Rr,serverPrefetch:Rr,components:_u,directives:_u,watch:fT,provide:F2,inject:lT};function F2(t,e){return e?t?function(){return dr(Ft(t)?t.call(this,this):t,Ft(e)?e.call(this,this):e)}:e:t}function lT(t,e){return _u(dd(t),dd(e))}function dd(t){if(Nt(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Rr(t,e){return t?[...new Set([].concat(t,e))]:e}function _u(t,e){return t?dr(Object.create(null),t,e):e}function I2(t,e){return t?Nt(t)&&Nt(e)?[...new Set([...t,...e])]:dr(Object.create(null),L2(t),L2(e??{})):e}function fT(t,e){if(!t)return e;if(!e)return t;const n=dr(Object.create(null),t);for(const r in e)n[r]=Rr(t[r],e[r]);return n}function D5(){return{app:null,config:{isNativeTag:qw,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hT=0;function pT(t,e){return function(r,i=null){Ft(r)||(r=dr({},r)),i!=null&&!Gn(i)&&(i=null);const a=D5(),o=new WeakSet,s=[];let c=!1;const l=a.app={_uid:hT++,_component:r,_props:i,_container:null,_context:a,_instance:null,version:YT,get config(){return a.config},set config(f){},use(f,...u){return o.has(f)||(f&&Ft(f.install)?(o.add(f),f.install(l,...u)):Ft(f)&&(o.add(f),f(l,...u))),l},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),l},component(f,u){return u?(a.components[f]=u,l):a.components[f]},directive(f,u){return u?(a.directives[f]=u,l):a.directives[f]},mount(f,u,h){if(!c){const p=l._ceVNode||Jo(r,i);return p.appContext=a,h===!0?h="svg":h===!1&&(h=void 0),t(p,f,h),c=!0,l._container=f,f.__vue_app__=l,Ag(p.component)}},onUnmount(f){s.push(f)},unmount(){c&&(pa(s,l._instance,16),t(null,l._container),delete l._container.__vue_app__)},provide(f,u){return a.provides[f]=u,l},runWithContext(f){const u=Lc;Lc=l;try{return f()}finally{Lc=u}}};return l}}let Lc=null;function dT(t,e){if(Fr){let n=Fr.provides;const r=Fr.parent&&Fr.parent.provides;r===n&&(n=Fr.provides=Object.create(r)),n[t]=e}}function L0(t,e,n=!1){const r=Fr||sa;if(r||Lc){let i=Lc?Lc._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&Ft(e)?e.call(r&&r.proxy):e}}const O5={},R5=()=>Object.create(O5),M5=t=>Object.getPrototypeOf(t)===O5;function gT(t,e,n,r=!1){const i={},a=R5();t.propsDefaults=Object.create(null),N5(t,e,i,a);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=r?i:RC(i):t.type.props?t.props=i:t.props=a,t.attrs=a}function mT(t,e,n,r){const{props:i,attrs:a,vnode:{patchFlag:o}}=t,s=Jt(i),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const f=t.vnode.dynamicProps;for(let u=0;u<f.length;u++){let h=f[u];if(fh(t.emitsOptions,h))continue;const p=e[h];if(c)if(Zt(a,h))p!==a[h]&&(a[h]=p,l=!0);else{const d=es(h);i[d]=gd(c,s,d,p,t,!1)}else p!==a[h]&&(a[h]=p,l=!0)}}}else{N5(t,e,i,a)&&(l=!0);let f;for(const u in s)(!e||!Zt(e,u)&&((f=fc(u))===u||!Zt(e,f)))&&(c?n&&(n[u]!==void 0||n[f]!==void 0)&&(i[u]=gd(c,s,u,void 0,t,!0)):delete i[u]);if(a!==s)for(const u in a)(!e||!Zt(e,u))&&(delete a[u],l=!0)}l&&ja(t.attrs,"set","")}function N5(t,e,n,r){const[i,a]=t.propsOptions;let o=!1,s;if(e)for(let c in e){if(Pu(c))continue;const l=e[c];let f;i&&Zt(i,f=es(c))?!a||!a.includes(f)?n[f]=l:(s||(s={}))[f]=l:fh(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(a){const c=Jt(n),l=s||un;for(let f=0;f<a.length;f++){const u=a[f];n[u]=gd(i,c,u,l[u],t,!Zt(l,u))}}return o}function gd(t,e,n,r,i,a){const o=t[n];if(o!=null){const s=Zt(o,"default");if(s&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Ft(c)){const{propsDefaults:l}=i;if(n in l)r=l[n];else{const f=Dl(i);r=l[n]=c.call(null,e),f()}}else r=c;i.ce&&i.ce._setProp(n,r)}o[0]&&(a&&!s?r=!1:o[1]&&(r===""||r===fc(n))&&(r=!0))}return r}const vT=new WeakMap;function L5(t,e,n=!1){const r=n?vT:e.propsCache,i=r.get(t);if(i)return i;const a=t.props,o={},s=[];let c=!1;if(!Ft(t)){const f=u=>{c=!0;const[h,p]=L5(u,e,!0);dr(o,h),p&&s.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(f),t.extends&&f(t.extends),t.mixins&&t.mixins.forEach(f)}if(!a&&!c)return Gn(t)&&r.set(t,Mc),Mc;if(Nt(a))for(let f=0;f<a.length;f++){const u=es(a[f]);P2(u)&&(o[u]=un)}else if(a)for(const f in a){const u=es(f);if(P2(u)){const h=a[f],p=o[u]=Nt(h)||Ft(h)?{type:h}:dr({},h),d=p.type;let g=!1,y=!0;if(Nt(d))for(let x=0;x<d.length;++x){const m=d[x],v=Ft(m)&&m.name;if(v==="Boolean"){g=!0;break}else v==="String"&&(y=!1)}else g=Ft(d)&&d.name==="Boolean";p[0]=g,p[1]=y,(g||Zt(p,"default"))&&s.push(u)}}const l=[o,s];return Gn(t)&&r.set(t,l),l}function P2(t){return t[0]!=="$"&&!Pu(t)}const Mg=t=>t[0]==="_"||t==="$stable",Ng=t=>Nt(t)?t.map(aa):[aa(t)],yT=(t,e,n)=>{if(e._n)return e;const r=jC((...i)=>Ng(e(...i)),n);return r._c=!1,r},A5=(t,e,n)=>{const r=t._ctx;for(const i in t){if(Mg(i))continue;const a=t[i];if(Ft(a))e[i]=yT(i,a,r);else if(a!=null){const o=Ng(a);e[i]=()=>o}}},F5=(t,e)=>{const n=Ng(e);t.slots.default=()=>n},I5=(t,e,n)=>{for(const r in e)(n||!Mg(r))&&(t[r]=e[r])},xT=(t,e,n)=>{const r=t.slots=R5();if(t.vnode.shapeFlag&32){const i=e.__;i&&od(r,"__",i,!0);const a=e._;a?(I5(r,e,n),n&&od(r,"_",a,!0)):A5(e,r)}else e&&F5(t,e)},wT=(t,e,n)=>{const{vnode:r,slots:i}=t;let a=!0,o=un;if(r.shapeFlag&32){const s=e._;s?n&&s===1?a=!1:I5(i,e,n):(a=!e.$stable,A5(e,i)),o=e}else e&&(F5(t,e),o={default:1});if(a)for(const s in i)!Mg(s)&&o[s]==null&&delete i[s]},Qr=FT;function CT(t){return TT(t)}function TT(t,e){const n=ch();n.__VUE__=!0;const{insert:r,remove:i,patchProp:a,createElement:o,createText:s,createComment:c,setText:l,setElementText:f,parentNode:u,nextSibling:h,setScopeId:p=la,insertStaticContent:d}=t,g=(A,L,k,$=null,H=null,se=null,me=void 0,ye=null,_e=!!L.dynamicChildren)=>{if(A===L)return;A&&!fu(A,L)&&($=Re(A),ae(A,H,se,!0),A=null),L.patchFlag===-2&&(_e=!1,L.dynamicChildren=null);const{type:K,ref:ne,shapeFlag:ce}=L;switch(K){case hh:y(A,L,k,$);break;case Gc:x(A,L,k,$);break;case Jh:A==null&&m(L,k,$,me);break;case Ga:R(A,L,k,$,H,se,me,ye,_e);break;default:ce&1?C(A,L,k,$,H,se,me,ye,_e):ce&6?F(A,L,k,$,H,se,me,ye,_e):(ce&64||ce&128)&&K.process(A,L,k,$,H,se,me,ye,_e,P)}ne!=null&&H?Bu(ne,A&&A.ref,se,L||A,!L):ne==null&&A&&A.ref!=null&&Bu(A.ref,null,se,A,!0)},y=(A,L,k,$)=>{if(A==null)r(L.el=s(L.children),k,$);else{const H=L.el=A.el;L.children!==A.children&&l(H,L.children)}},x=(A,L,k,$)=>{A==null?r(L.el=c(L.children||""),k,$):L.el=A.el},m=(A,L,k,$)=>{[A.el,A.anchor]=d(A.children,L,k,$,A.el,A.anchor)},v=({el:A,anchor:L},k,$)=>{let H;for(;A&&A!==L;)H=h(A),r(A,k,$),A=H;r(L,k,$)},w=({el:A,anchor:L})=>{let k;for(;A&&A!==L;)k=h(A),i(A),A=k;i(L)},C=(A,L,k,$,H,se,me,ye,_e)=>{L.type==="svg"?me="svg":L.type==="math"&&(me="mathml"),A==null?T(L,k,$,H,se,me,ye,_e):b(A,L,H,se,me,ye,_e)},T=(A,L,k,$,H,se,me,ye)=>{let _e,K;const{props:ne,shapeFlag:ce,transition:re,dirs:ue}=A;if(_e=A.el=o(A.type,se,ne&&ne.is,ne),ce&8?f(_e,A.children):ce&16&&S(A.children,_e,null,$,H,Xh(A,se),me,ye),ue&&Os(A,null,$,"created"),_(_e,A,A.scopeId,me,$),ne){for(const te in ne)te!=="value"&&!Pu(te)&&a(_e,te,null,ne[te],se,$);"value"in ne&&a(_e,"value",null,ne.value,se),(K=ne.onVnodeBeforeMount)&&Zi(K,$,A)}ue&&Os(A,null,$,"beforeMount");const De=_T(H,re);De&&re.beforeEnter(_e),r(_e,L,k),((K=ne&&ne.onVnodeMounted)||De||ue)&&Qr(()=>{K&&Zi(K,$,A),De&&re.enter(_e),ue&&Os(A,null,$,"mounted")},H)},_=(A,L,k,$,H)=>{if(k&&p(A,k),$)for(let se=0;se<$.length;se++)p(A,$[se]);if(H){let se=H.subTree;if(L===se||G5(se.type)&&(se.ssContent===L||se.ssFallback===L)){const me=H.vnode;_(A,me,me.scopeId,me.slotScopeIds,H.parent)}}},S=(A,L,k,$,H,se,me,ye,_e=0)=>{for(let K=_e;K<A.length;K++){const ne=A[K]=ye?ko(A[K]):aa(A[K]);g(null,ne,L,k,$,H,se,me,ye)}},b=(A,L,k,$,H,se,me)=>{const ye=L.el=A.el;let{patchFlag:_e,dynamicChildren:K,dirs:ne}=L;_e|=A.patchFlag&16;const ce=A.props||un,re=L.props||un;let ue;if(k&&Rs(k,!1),(ue=re.onVnodeBeforeUpdate)&&Zi(ue,k,L,A),ne&&Os(L,A,k,"beforeUpdate"),k&&Rs(k,!0),(ce.innerHTML&&re.innerHTML==null||ce.textContent&&re.textContent==null)&&f(ye,""),K?D(A.dynamicChildren,K,ye,k,$,Xh(L,H),se):me||W(A,L,ye,null,k,$,Xh(L,H),se,!1),_e>0){if(_e&16)E(ye,ce,re,k,H);else if(_e&2&&ce.class!==re.class&&a(ye,"class",null,re.class,H),_e&4&&a(ye,"style",ce.style,re.style,H),_e&8){const De=L.dynamicProps;for(let te=0;te<De.length;te++){const Ue=De[te],Ye=ce[Ue],qe=re[Ue];(qe!==Ye||Ue==="value")&&a(ye,Ue,Ye,qe,H,k)}}_e&1&&A.children!==L.children&&f(ye,L.children)}else!me&&K==null&&E(ye,ce,re,k,H);((ue=re.onVnodeUpdated)||ne)&&Qr(()=>{ue&&Zi(ue,k,L,A),ne&&Os(L,A,k,"updated")},$)},D=(A,L,k,$,H,se,me)=>{for(let ye=0;ye<L.length;ye++){const _e=A[ye],K=L[ye],ne=_e.el&&(_e.type===Ga||!fu(_e,K)||_e.shapeFlag&198)?u(_e.el):k;g(_e,K,ne,null,$,H,se,me,!0)}},E=(A,L,k,$,H)=>{if(L!==k){if(L!==un)for(const se in L)!Pu(se)&&!(se in k)&&a(A,se,L[se],null,H,$);for(const se in k){if(Pu(se))continue;const me=k[se],ye=L[se];me!==ye&&se!=="value"&&a(A,se,ye,me,H,$)}"value"in k&&a(A,"value",L.value,k.value,H)}},R=(A,L,k,$,H,se,me,ye,_e)=>{const K=L.el=A?A.el:s(""),ne=L.anchor=A?A.anchor:s("");let{patchFlag:ce,dynamicChildren:re,slotScopeIds:ue}=L;ue&&(ye=ye?ye.concat(ue):ue),A==null?(r(K,k,$),r(ne,k,$),S(L.children||[],k,ne,H,se,me,ye,_e)):ce>0&&ce&64&&re&&A.dynamicChildren?(D(A.dynamicChildren,re,k,H,se,me,ye),(L.key!=null||H&&L===H.subTree)&&P5(A,L,!0)):W(A,L,k,ne,H,se,me,ye,_e)},F=(A,L,k,$,H,se,me,ye,_e)=>{L.slotScopeIds=ye,A==null?L.shapeFlag&512?H.ctx.activate(L,k,$,me,_e):M(L,k,$,H,se,me,_e):U(A,L,_e)},M=(A,L,k,$,H,se,me)=>{const ye=A.component=zT(A,$,H);if(C5(A)&&(ye.ctx.renderer=P),jT(ye,!1,me),ye.asyncDep){if(H&&H.registerDep(ye,z,me),!A.el){const _e=ye.subTree=Jo(Gc);x(null,_e,L,k)}}else z(ye,A,L,k,H,se,me)},U=(A,L,k)=>{const $=L.component=A.component;if(LT(A,L,k))if($.asyncDep&&!$.asyncResolved){Y($,L,k);return}else $.next=L,$.update();else L.el=A.el,$.vnode=L},z=(A,L,k,$,H,se,me)=>{const ye=()=>{if(A.isMounted){let{next:ce,bu:re,u:ue,parent:De,vnode:te}=A;{const Fe=V5(A);if(Fe){ce&&(ce.el=te.el,Y(A,ce,me)),Fe.asyncDep.then(()=>{A.isUnmounted||ye()});return}}let Ue=ce,Ye;Rs(A,!1),ce?(ce.el=te.el,Y(A,ce,me)):ce=te,re&&jh(re),(Ye=ce.props&&ce.props.onVnodeBeforeUpdate)&&Zi(Ye,De,ce,te),Rs(A,!0);const qe=k2(A),xe=A.subTree;A.subTree=qe,g(xe,qe,u(xe.el),Re(xe),A,H,se),ce.el=qe.el,Ue===null&&AT(A,qe.el),ue&&Qr(ue,H),(Ye=ce.props&&ce.props.onVnodeUpdated)&&Qr(()=>Zi(Ye,De,ce,te),H)}else{let ce;const{el:re,props:ue}=L,{bm:De,m:te,parent:Ue,root:Ye,type:qe}=A,xe=Gu(L);Rs(A,!1),De&&jh(De),!xe&&(ce=ue&&ue.onVnodeBeforeMount)&&Zi(ce,Ue,L),Rs(A,!0);{Ye.ce&&Ye.ce._def.shadowRoot!==!1&&Ye.ce._injectChildStyle(qe);const Fe=A.subTree=k2(A);g(null,Fe,k,$,A,H,se),L.el=Fe.el}if(te&&Qr(te,H),!xe&&(ce=ue&&ue.onVnodeMounted)){const Fe=L;Qr(()=>Zi(ce,Ue,Fe),H)}(L.shapeFlag&256||Ue&&Gu(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&A.a&&Qr(A.a,H),A.isMounted=!0,L=k=$=null}};A.scope.on();const _e=A.effect=new Qy(ye);A.scope.off();const K=A.update=_e.run.bind(_e),ne=A.job=_e.runIfDirty.bind(_e);ne.i=A,ne.id=A.uid,_e.scheduler=()=>Og(ne),Rs(A,!0),K()},Y=(A,L,k)=>{L.component=A;const $=A.vnode.props;A.vnode=L,A.next=null,mT(A,L.props,$,k),wT(A,L.children,k),eo(),N2(A),to()},W=(A,L,k,$,H,se,me,ye,_e=!1)=>{const K=A&&A.children,ne=A?A.shapeFlag:0,ce=L.children,{patchFlag:re,shapeFlag:ue}=L;if(re>0){if(re&128){j(K,ce,k,$,H,se,me,ye,_e);return}else if(re&256){B(K,ce,k,$,H,se,me,ye,_e);return}}ue&8?(ne&16&&be(K,H,se),ce!==K&&f(k,ce)):ne&16?ue&16?j(K,ce,k,$,H,se,me,ye,_e):be(K,H,se,!0):(ne&8&&f(k,""),ue&16&&S(ce,k,$,H,se,me,ye,_e))},B=(A,L,k,$,H,se,me,ye,_e)=>{A=A||Mc,L=L||Mc;const K=A.length,ne=L.length,ce=Math.min(K,ne);let re;for(re=0;re<ce;re++){const ue=L[re]=_e?ko(L[re]):aa(L[re]);g(A[re],ue,k,null,H,se,me,ye,_e)}K>ne?be(A,H,se,!0,!1,ce):S(L,k,$,H,se,me,ye,_e,ce)},j=(A,L,k,$,H,se,me,ye,_e)=>{let K=0;const ne=L.length;let ce=A.length-1,re=ne-1;for(;K<=ce&&K<=re;){const ue=A[K],De=L[K]=_e?ko(L[K]):aa(L[K]);if(fu(ue,De))g(ue,De,k,null,H,se,me,ye,_e);else break;K++}for(;K<=ce&&K<=re;){const ue=A[ce],De=L[re]=_e?ko(L[re]):aa(L[re]);if(fu(ue,De))g(ue,De,k,null,H,se,me,ye,_e);else break;ce--,re--}if(K>ce){if(K<=re){const ue=re+1,De=ue<ne?L[ue].el:$;for(;K<=re;)g(null,L[K]=_e?ko(L[K]):aa(L[K]),k,De,H,se,me,ye,_e),K++}}else if(K>re)for(;K<=ce;)ae(A[K],H,se,!0),K++;else{const ue=K,De=K,te=new Map;for(K=De;K<=re;K++){const Xe=L[K]=_e?ko(L[K]):aa(L[K]);Xe.key!=null&&te.set(Xe.key,K)}let Ue,Ye=0;const qe=re-De+1;let xe=!1,Fe=0;const ze=new Array(qe);for(K=0;K<qe;K++)ze[K]=0;for(K=ue;K<=ce;K++){const Xe=A[K];if(Ye>=qe){ae(Xe,H,se,!0);continue}let ot;if(Xe.key!=null)ot=te.get(Xe.key);else for(Ue=De;Ue<=re;Ue++)if(ze[Ue-De]===0&&fu(Xe,L[Ue])){ot=Ue;break}ot===void 0?ae(Xe,H,se,!0):(ze[ot-De]=K+1,ot>=Fe?Fe=ot:xe=!0,g(Xe,L[ot],k,null,H,se,me,ye,_e),Ye++)}const $e=xe?ST(ze):Mc;for(Ue=$e.length-1,K=qe-1;K>=0;K--){const Xe=De+K,ot=L[Xe],rt=Xe+1<ne?L[Xe+1].el:$;ze[K]===0?g(null,ot,k,rt,H,se,me,ye,_e):xe&&(Ue<0||K!==$e[Ue]?ie(ot,k,rt,2):Ue--)}}},ie=(A,L,k,$,H=null)=>{const{el:se,type:me,transition:ye,children:_e,shapeFlag:K}=A;if(K&6){ie(A.component.subTree,L,k,$);return}if(K&128){A.suspense.move(L,k,$);return}if(K&64){me.move(A,L,k,P);return}if(me===Ga){r(se,L,k);for(let ce=0;ce<_e.length;ce++)ie(_e[ce],L,k,$);r(A.anchor,L,k);return}if(me===Jh){v(A,L,k);return}if($!==2&&K&1&&ye)if($===0)ye.beforeEnter(se),r(se,L,k),Qr(()=>ye.enter(se),H);else{const{leave:ce,delayLeave:re,afterLeave:ue}=ye,De=()=>{A.ctx.isUnmounted?i(se):r(se,L,k)},te=()=>{ce(se,()=>{De(),ue&&ue()})};re?re(se,De,te):te()}else r(se,L,k)},ae=(A,L,k,$=!1,H=!1)=>{const{type:se,props:me,ref:ye,children:_e,dynamicChildren:K,shapeFlag:ne,patchFlag:ce,dirs:re,cacheIndex:ue}=A;if(ce===-2&&(H=!1),ye!=null&&(eo(),Bu(ye,null,k,A,!0),to()),ue!=null&&(L.renderCache[ue]=void 0),ne&256){L.ctx.deactivate(A);return}const De=ne&1&&re,te=!Gu(A);let Ue;if(te&&(Ue=me&&me.onVnodeBeforeUnmount)&&Zi(Ue,L,A),ne&6)ge(A.component,k,$);else{if(ne&128){A.suspense.unmount(k,$);return}De&&Os(A,null,L,"beforeUnmount"),ne&64?A.type.remove(A,L,k,P,$):K&&!K.hasOnce&&(se!==Ga||ce>0&&ce&64)?be(K,L,k,!1,!0):(se===Ga&&ce&384||!H&&ne&16)&&be(_e,L,k),$&&fe(A)}(te&&(Ue=me&&me.onVnodeUnmounted)||De)&&Qr(()=>{Ue&&Zi(Ue,L,A),De&&Os(A,null,L,"unmounted")},k)},fe=A=>{const{type:L,el:k,anchor:$,transition:H}=A;if(L===Ga){Ee(k,$);return}if(L===Jh){w(A);return}const se=()=>{i(k),H&&!H.persisted&&H.afterLeave&&H.afterLeave()};if(A.shapeFlag&1&&H&&!H.persisted){const{leave:me,delayLeave:ye}=H,_e=()=>me(k,se);ye?ye(A.el,se,_e):_e()}else se()},Ee=(A,L)=>{let k;for(;A!==L;)k=h(A),i(A),A=k;i(L)},ge=(A,L,k)=>{const{bum:$,scope:H,job:se,subTree:me,um:ye,m:_e,a:K,parent:ne,slots:{__:ce}}=A;V2(_e),V2(K),$&&jh($),ne&&Nt(ce)&&ce.forEach(re=>{ne.renderCache[re]=void 0}),H.stop(),se&&(se.flags|=8,ae(me,A,L,k)),ye&&Qr(ye,L),Qr(()=>{A.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},be=(A,L,k,$=!1,H=!1,se=0)=>{for(let me=se;me<A.length;me++)ae(A[me],L,k,$,H)},Re=A=>{if(A.shapeFlag&6)return Re(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const L=h(A.anchor||A.el),k=L&&L[$C];return k?h(k):L};let Ne=!1;const Ce=(A,L,k)=>{A==null?L._vnode&&ae(L._vnode,null,null,!0):g(L._vnode||null,A,L,null,null,null,k),L._vnode=A,Ne||(Ne=!0,N2(),v5(),Ne=!1)},P={p:g,um:ae,m:ie,r:fe,mt:M,mc:S,pc:W,pbc:D,n:Re,o:t};return{render:Ce,hydrate:void 0,createApp:pT(Ce)}}function Xh({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Rs({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function _T(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function P5(t,e,n=!1){const r=t.children,i=e.children;if(Nt(r)&&Nt(i))for(let a=0;a<r.length;a++){const o=r[a];let s=i[a];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=i[a]=ko(i[a]),s.el=o.el),!n&&s.patchFlag!==-2&&P5(o,s)),s.type===hh&&(s.el=o.el),s.type===Gc&&!s.el&&(s.el=o.el)}}function ST(t){const e=t.slice(),n=[0];let r,i,a,o,s;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}for(a=0,o=n.length-1;a<o;)s=a+o>>1,t[n[s]]<l?a=s+1:o=s;l<t[n[a]]&&(a>0&&(e[r]=n[a-1]),n[a]=r)}}for(a=n.length,o=n[a-1];a-- >0;)n[a]=o,o=e[o];return n}function V5(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:V5(e)}function V2(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const bT=Symbol.for("v-scx"),ET=()=>L0(bT);function Yh(t,e,n){return k5(t,e,n)}function k5(t,e,n=un){const{immediate:r,deep:i,flush:a,once:o}=n,s=dr({},n),c=e&&r||!e&&a!=="post";let l;if(sl){if(a==="sync"){const p=ET();l=p.__watcherHandles||(p.__watcherHandles=[])}else if(!c){const p=()=>{};return p.stop=la,p.resume=la,p.pause=la,p}}const f=Fr;s.call=(p,d,g)=>pa(p,f,d,g);let u=!1;a==="post"?s.scheduler=p=>{Qr(p,f&&f.suspense)}:a!=="sync"&&(u=!0,s.scheduler=(p,d)=>{d?p():Og(p)}),s.augmentJob=p=>{e&&(p.flags|=4),u&&(p.flags|=2,f&&(p.id=f.uid,p.i=f))};const h=UC(t,e,s);return sl&&(l?l.push(h):c&&h()),h}function DT(t,e,n){const r=this.proxy,i=Zn(t)?t.includes(".")?U5(r,t):()=>r[t]:t.bind(r,r);let a;Ft(e)?a=e:(a=e.handler,n=e);const o=Dl(this),s=k5(i,a.bind(r),n);return o(),s}function U5(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}const OT=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${es(e)}Modifiers`]||t[`${fc(e)}Modifiers`];function RT(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||un;let i=n;const a=e.startsWith("update:"),o=a&&OT(r,e.slice(7));o&&(o.trim&&(i=n.map(f=>Zn(f)?f.trim():f)),o.number&&(i=n.map(nC)));let s,c=r[s=zh(e)]||r[s=zh(es(e))];!c&&a&&(c=r[s=zh(fc(e))]),c&&pa(c,t,6,i);const l=r[s+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[s])return;t.emitted[s]=!0,pa(l,t,6,i)}}function B5(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const a=t.emits;let o={},s=!1;if(!Ft(t)){const c=l=>{const f=B5(l,e,!0);f&&(s=!0,dr(o,f))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!a&&!s?(Gn(t)&&r.set(t,null),null):(Nt(a)?a.forEach(c=>o[c]=null):dr(o,a),Gn(t)&&r.set(t,o),o)}function fh(t,e){return!t||!ah(e)?!1:(e=e.slice(2).replace(/Once$/,""),Zt(t,e[0].toLowerCase()+e.slice(1))||Zt(t,fc(e))||Zt(t,e))}function k2(t){const{type:e,vnode:n,proxy:r,withProxy:i,propsOptions:[a],slots:o,attrs:s,emit:c,render:l,renderCache:f,props:u,data:h,setupState:p,ctx:d,inheritAttrs:g}=t,y=hf(t);let x,m;try{if(n.shapeFlag&4){const w=i||r,C=w;x=aa(l.call(C,w,f,u,p,h,d)),m=s}else{const w=e;x=aa(w.length>1?w(u,{attrs:s,slots:o,emit:c}):w(u,null)),m=e.props?s:MT(s)}}catch(w){zu.length=0,uh(w,t,1),x=Jo(Gc)}let v=x;if(m&&g!==!1){const w=Object.keys(m),{shapeFlag:C}=v;w.length&&C&7&&(a&&w.some(dg)&&(m=NT(m,a)),v=Wc(v,m,!1,!0))}return n.dirs&&(v=Wc(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(n.dirs):n.dirs),n.transition&&Rg(v,n.transition),x=v,hf(y),x}const MT=t=>{let e;for(const n in t)(n==="class"||n==="style"||ah(n))&&((e||(e={}))[n]=t[n]);return e},NT=(t,e)=>{const n={};for(const r in t)(!dg(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function LT(t,e,n){const{props:r,children:i,component:a}=t,{props:o,children:s,patchFlag:c}=e,l=a.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?U2(r,o,l):!!o;if(c&8){const f=e.dynamicProps;for(let u=0;u<f.length;u++){const h=f[u];if(o[h]!==r[h]&&!fh(l,h))return!0}}}else return(i||s)&&(!s||!s.$stable)?!0:r===o?!1:r?o?U2(r,o,l):!0:!!o;return!1}function U2(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(e[a]!==t[a]&&!fh(n,a))return!0}return!1}function AT({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const G5=t=>t.__isSuspense;function FT(t,e){e&&e.pendingBranch?Nt(t)?e.effects.push(...t):e.effects.push(t):zC(t)}const Ga=Symbol.for("v-fgt"),hh=Symbol.for("v-txt"),Gc=Symbol.for("v-cmt"),Jh=Symbol.for("v-stc"),zu=[];let ii=null;function W5(t=!1){zu.push(ii=t?null:[])}function IT(){zu.pop(),ii=zu[zu.length-1]||null}let ol=1;function B2(t,e=!1){ol+=t,t<0&&ii&&e&&(ii.hasOnce=!0)}function PT(t){return t.dynamicChildren=ol>0?ii||Mc:null,IT(),ol>0&&ii&&ii.push(t),t}function z5(t,e,n,r,i,a){return PT(H5(t,e,n,r,i,a,!0))}function j5(t){return t?t.__v_isVNode===!0:!1}function fu(t,e){return t.type===e.type&&t.key===e.key}const $5=({key:t})=>t??null,A0=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Zn(t)||pr(t)||Ft(t)?{i:sa,r:t,k:e,f:!!n}:t:null);function H5(t,e=null,n=null,r=0,i=null,a=t===Ga?0:1,o=!1,s=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&$5(e),ref:e&&A0(e),scopeId:x5,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:sa};return s?(Lg(c,n),a&128&&t.normalize(c)):n&&(c.shapeFlag|=Zn(n)?8:16),ol>0&&!o&&ii&&(c.patchFlag>0||a&6)&&c.patchFlag!==32&&ii.push(c),c}const Jo=VT;function VT(t,e=null,n=null,r=0,i=null,a=!1){if((!t||t===aT)&&(t=Gc),j5(t)){const s=Wc(t,e,!0);return n&&Lg(s,n),ol>0&&!a&&ii&&(s.shapeFlag&6?ii[ii.indexOf(t)]=s:ii.push(s)),s.patchFlag=-2,s}if(qT(t)&&(t=t.__vccOpts),e){e=kT(e);let{class:s,style:c}=e;s&&!Zn(s)&&(e.class=yg(s)),Gn(c)&&(Dg(c)&&!Nt(c)&&(c=dr({},c)),e.style=vg(c))}const o=Zn(t)?1:G5(t)?128:HC(t)?64:Gn(t)?4:Ft(t)?2:0;return H5(t,e,n,r,i,o,a,!0)}function kT(t){return t?Dg(t)||M5(t)?dr({},t):t:null}function Wc(t,e,n=!1,r=!1){const{props:i,ref:a,patchFlag:o,children:s,transition:c}=t,l=e?BT(i||{},e):i,f={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&$5(l),ref:e&&e.ref?n&&a?Nt(a)?a.concat(A0(e)):[a,A0(e)]:A0(e):a,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:s,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ga?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Wc(t.ssContent),ssFallback:t.ssFallback&&Wc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&Rg(f,c.clone(f)),f}function UT(t=" ",e=0){return Jo(hh,null,t,e)}function aa(t){return t==null||typeof t=="boolean"?Jo(Gc):Nt(t)?Jo(Ga,null,t.slice()):j5(t)?ko(t):Jo(hh,null,String(t))}function ko(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Wc(t)}function Lg(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(Nt(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),Lg(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!M5(e)?e._ctx=sa:i===3&&sa&&(sa.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ft(e)?(e={default:e,_ctx:sa},n=32):(e=String(e),r&64?(n=16,e=[UT(e)]):n=8);t.children=e,t.shapeFlag|=n}function BT(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=yg([e.class,r.class]));else if(i==="style")e.style=vg([e.style,r.style]);else if(ah(i)){const a=e[i],o=r[i];o&&a!==o&&!(Nt(a)&&a.includes(o))&&(e[i]=a?[].concat(a,o):o)}else i!==""&&(e[i]=r[i])}return e}function Zi(t,e,n,r=null){pa(t,e,7,[n,r])}const GT=D5();let WT=0;function zT(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||GT,a={uid:WT++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new uC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:L5(r,i),emitsOptions:B5(r,i),emit:null,emitted:null,propsDefaults:un,inheritAttrs:r.inheritAttrs,ctx:un,data:un,props:un,attrs:un,slots:un,refs:un,setupState:un,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=RT.bind(null,a),t.ce&&t.ce(a),a}let Fr=null,df,md;{const t=ch(),e=(n,r)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(r),a=>{i.length>1?i.forEach(o=>o(a)):i[0](a)}};df=e("__VUE_INSTANCE_SETTERS__",n=>Fr=n),md=e("__VUE_SSR_SETTERS__",n=>sl=n)}const Dl=t=>{const e=Fr;return df(t),t.scope.on(),()=>{t.scope.off(),df(e)}},G2=()=>{Fr&&Fr.scope.off(),df(null)};function K5(t){return t.vnode.shapeFlag&4}let sl=!1;function jT(t,e=!1,n=!1){e&&md(e);const{props:r,children:i}=t.vnode,a=K5(t);gT(t,r,a,e),xT(t,i,n||e);const o=a?$T(t,e):void 0;return e&&md(!1),o}function $T(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,oT);const{setup:r}=n;if(r){eo();const i=t.setupContext=r.length>1?KT(t):null,a=Dl(t),o=El(r,t,0,[t.props,i]),s=Yy(o);if(to(),a(),(s||t.sp)&&!Gu(t)&&w5(t),s){if(o.then(G2,G2),e)return o.then(c=>{W2(t,c)}).catch(c=>{uh(c,t,0)});t.asyncDep=o}else W2(t,o)}else q5(t)}function W2(t,e,n){Ft(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Gn(e)&&(t.setupState=d5(e)),q5(t)}function q5(t,e,n){const r=t.type;t.render||(t.render=r.render||la);{const i=Dl(t);eo();try{sT(t)}finally{to(),i()}}}const HT={get(t,e){return fr(t,"get",""),t[e]}};function KT(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,HT),slots:t.slots,emit:t.emit,expose:e}}function Ag(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(d5(MC(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Wu)return Wu[n](t)},has(e,n){return n in e||n in Wu}})):t.proxy}function qT(t){return Ft(t)&&"__vccOpts"in t}const XT=(t,e)=>VC(t,e,sl),YT="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let vd;const z2=typeof window<"u"&&window.trustedTypes;if(z2)try{vd=z2.createPolicy("vue",{createHTML:t=>t})}catch{}const X5=vd?t=>vd.createHTML(t):t=>t,JT="http://www.w3.org/2000/svg",ZT="http://www.w3.org/1998/Math/MathML",Ua=typeof document<"u"?document:null,j2=Ua&&Ua.createElement("template"),QT={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e==="svg"?Ua.createElementNS(JT,t):e==="mathml"?Ua.createElementNS(ZT,t):n?Ua.createElement(t,{is:n}):Ua.createElement(t);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Ua.createTextNode(t),createComment:t=>Ua.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ua.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,a){const o=n?n.previousSibling:e.lastChild;if(i&&(i===a||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===a||!(i=i.nextSibling)););else{j2.innerHTML=X5(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const s=j2.content;if(r==="svg"||r==="mathml"){const c=s.firstChild;for(;c.firstChild;)s.appendChild(c.firstChild);s.removeChild(c)}e.insertBefore(s,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},e7=Symbol("_vtc");function t7(t,e,n){const r=t[e7];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const $2=Symbol("_vod"),n7=Symbol("_vsh"),r7=Symbol(""),i7=/(^|;)\s*display\s*:/;function a7(t,e,n){const r=t.style,i=Zn(n);let a=!1;if(n&&!i){if(e)if(Zn(e))for(const o of e.split(";")){const s=o.slice(0,o.indexOf(":")).trim();n[s]==null&&F0(r,s,"")}else for(const o in e)n[o]==null&&F0(r,o,"");for(const o in n)o==="display"&&(a=!0),F0(r,o,n[o])}else if(i){if(e!==n){const o=r[r7];o&&(n+=";"+o),r.cssText=n,a=i7.test(n)}}else e&&t.removeAttribute("style");$2 in t&&(t[$2]=a?r.display:"",t[n7]&&(r.display="none"))}const H2=/\s*!important$/;function F0(t,e,n){if(Nt(n))n.forEach(r=>F0(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=o7(t,e);H2.test(n)?t.setProperty(fc(r),n.replace(H2,""),"important"):t[r]=n}}const K2=["Webkit","Moz","ms"],Zh={};function o7(t,e){const n=Zh[e];if(n)return n;let r=es(e);if(r!=="filter"&&r in t)return Zh[e]=r;r=Jy(r);for(let i=0;i<K2.length;i++){const a=K2[i]+r;if(a in t)return Zh[e]=a}return e}const q2="http://www.w3.org/1999/xlink";function X2(t,e,n,r,i,a=cC(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(q2,e.slice(6,e.length)):t.setAttributeNS(q2,e,n):n==null||a&&!Zy(n)?t.removeAttribute(e):t.setAttribute(e,a?"":Zc(n)?String(n):n)}function Y2(t,e,n,r,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?X5(n):n);return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const s=a==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(s!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const s=typeof t[e];s==="boolean"?n=Zy(n):n==null&&s==="string"?(n="",o=!0):s==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function s7(t,e,n,r){t.addEventListener(e,n,r)}function c7(t,e,n,r){t.removeEventListener(e,n,r)}const J2=Symbol("_vei");function u7(t,e,n,r,i=null){const a=t[J2]||(t[J2]={}),o=a[e];if(r&&o)o.value=r;else{const[s,c]=l7(e);if(r){const l=a[e]=p7(r,i);s7(t,s,l,c)}else o&&(c7(t,s,o,c),a[e]=void 0)}}const Z2=/(?:Once|Passive|Capture)$/;function l7(t){let e;if(Z2.test(t)){e={};let r;for(;r=t.match(Z2);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):fc(t.slice(2)),e]}let Qh=0;const f7=Promise.resolve(),h7=()=>Qh||(f7.then(()=>Qh=0),Qh=Date.now());function p7(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;pa(d7(r,n.value),e,5,[r])};return n.value=t,n.attached=h7(),n}function d7(t,e){if(Nt(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const Q2=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,g7=(t,e,n,r,i,a)=>{const o=i==="svg";e==="class"?t7(t,r,o):e==="style"?a7(t,n,r):ah(e)?dg(e)||u7(t,e,n,r,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):m7(t,e,r,o))?(Y2(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&X2(t,e,r,o,a,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Zn(r))?Y2(t,es(e),r,a,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),X2(t,e,r,o))};function m7(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Q2(e)&&Ft(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Q2(e)&&Zn(n)?!1:e in t}const v7=dr({patchProp:g7},QT);let em;function y7(){return em||(em=CT(v7))}const x7=(...t)=>{const e=y7().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=C7(r);if(!i)return;const a=e._component;!Ft(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,w7(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function w7(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function C7(t){return Zn(t)?document.querySelector(t):t}var Je;(function(t){t.ERROR_EVENT="CORNERSTONE_ERROR",t.CACHE_SIZE_EXCEEDED="CACHE_SIZE_EXCEEDED",t.IMAGE_LOAD_ERROR="IMAGE_LOAD_ERROR",t.CAMERA_MODIFIED="CORNERSTONE_CAMERA_MODIFIED",t.CAMERA_RESET="CORNERSTONE_CAMERA_RESET",t.VOI_MODIFIED="CORNERSTONE_VOI_MODIFIED",t.PRESET_MODIFIED="CORNERSTONE_VIEWPORT_RENDERING_PRESET_MODIFIED",t.DISPLAY_AREA_MODIFIED="CORNERSTONE_DISPLAY_AREA_MODIFIED",t.ELEMENT_DISABLED="CORNERSTONE_ELEMENT_DISABLED",t.ELEMENT_ENABLED="CORNERSTONE_ELEMENT_ENABLED",t.IMAGE_RENDERED="CORNERSTONE_IMAGE_RENDERED",t.IMAGE_VOLUME_MODIFIED="CORNERSTONE_IMAGE_VOLUME_MODIFIED",t.IMAGE_VOLUME_LOADING_COMPLETED="CORNERSTONE_IMAGE_VOLUME_LOADING_COMPLETED",t.IMAGE_LOADED="CORNERSTONE_IMAGE_LOADED",t.IMAGE_RETRIEVAL_STAGE="CORNERSTONE_IMAGE_RETRIEVAL_STAGE",t.IMAGE_LOAD_FAILED="CORNERSTONE_IMAGE_LOAD_FAILED",t.VOLUME_VIEWPORT_NEW_VOLUME="CORNERSTONE_VOLUME_VIEWPORT_NEW_VOLUME",t.VOLUME_LOADED="CORNERSTONE_VOLUME_LOADED",t.VOLUME_LOADED_FAILED="CORNERSTONE_VOLUME_LOADED_FAILED",t.IMAGE_CACHE_IMAGE_ADDED="CORNERSTONE_IMAGE_CACHE_IMAGE_ADDED",t.IMAGE_CACHE_IMAGE_REMOVED="CORNERSTONE_IMAGE_CACHE_IMAGE_REMOVED",t.VOLUME_CACHE_VOLUME_ADDED="CORNERSTONE_VOLUME_CACHE_VOLUME_ADDED",t.VOLUME_CACHE_VOLUME_REMOVED="CORNERSTONE_VOLUME_CACHE_VOLUME_REMOVED",t.STACK_NEW_IMAGE="CORNERSTONE_STACK_NEW_IMAGE",t.VOLUME_NEW_IMAGE="CORNERSTONE_VOLUME_NEW_IMAGE",t.PRE_STACK_NEW_IMAGE="CORNERSTONE_PRE_STACK_NEW_IMAGE",t.IMAGE_SPACING_CALIBRATED="CORNERSTONE_IMAGE_SPACING_CALIBRATED",t.VIEWPORT_NEW_IMAGE_SET="CORNERSTONE_VIEWPORT_NEW_IMAGE_SET",t.STACK_VIEWPORT_SCROLL="CORNERSTONE_STACK_VIEWPORT_SCROLL",t.STACK_SCROLL_OUT_OF_BOUNDS="STACK_SCROLL_OUT_OF_BOUNDS",t.GEOMETRY_CACHE_GEOMETRY_ADDED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_ADDED",t.GEOMETRY_CACHE_GEOMETRY_REMOVED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_REMOVED",t.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS="VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS",t.VOLUME_VIEWPORT_SCROLL="VOLUME_VIEWPORT_SCROLL",t.CLIPPING_PLANES_UPDATED="CORNERSTONE_CLIPPING_PLANES_UPDATED",t.WEB_WORKER_PROGRESS="CORNERSTONE_WEB_WORKER_PROGRESS",t.COLORMAP_MODIFIED="CORNERSTONE_COLORMAP_MODIFIED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED="DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED",t.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED="DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED",t.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED="DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED",t.DYNAMIC_VOLUME_TIME_POINT_LOADED="DYNAMIC_VOLUME_TIME_POINT_LOADED",t.GEOMETRY_LOADED="GEOMETRY_LOADED",t.GEOMETRY_LOAD_PROGRESS="GEOMETRY_LOAD_PROGRESS",t.GEOMETRY_LOADED_FAILED="GEOMETRY_LOADED_FAILED",t.ACTORS_CHANGED="CORNERSTONE_ACTORS_CHANGED"})(Je||(Je={}));var St;(function(t){t.Interaction="interaction",t.Thumbnail="thumbnail",t.Prefetch="prefetch",t.Compute="compute"})(St||(St={}));var tn;(function(t){t.STACK="stack",t.ORTHOGRAPHIC="orthographic",t.PERSPECTIVE="perspective",t.VOLUME_3D="volume3d",t.VIDEO="video",t.WHOLE_SLIDE="wholeSlide"})(tn||(tn={}));var Ka;(function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t[t.FAST_LINEAR=2]="FAST_LINEAR"})(Ka||(Ka={}));const I0={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4,RADON_TRANSFORM_BLEND:5,LABELMAP_EDGE_PROJECTION_BLEND:6},T7={OFF:0,NORMALIZED:1,RAW:2};var Y5={BlendMode:I0,FilterMode:T7};const{BlendMode:hu}=Y5;var yd;(function(t){t[t.COMPOSITE=hu.COMPOSITE_BLEND]="COMPOSITE",t[t.MAXIMUM_INTENSITY_BLEND=hu.MAXIMUM_INTENSITY_BLEND]="MAXIMUM_INTENSITY_BLEND",t[t.MINIMUM_INTENSITY_BLEND=hu.MINIMUM_INTENSITY_BLEND]="MINIMUM_INTENSITY_BLEND",t[t.AVERAGE_INTENSITY_BLEND=hu.AVERAGE_INTENSITY_BLEND]="AVERAGE_INTENSITY_BLEND",t[t.LABELMAP_EDGE_PROJECTION_BLEND=hu.LABELMAP_EDGE_PROJECTION_BLEND]="LABELMAP_EDGE_PROJECTION_BLEND"})(yd||(yd={}));const _7=yd;var Zo;(function(t){t.AXIAL="axial",t.CORONAL="coronal",t.SAGITTAL="sagittal",t.ACQUISITION="acquisition",t.AXIAL_REFORMAT="axial_reformat",t.CORONAL_REFORMAT="coronal_reformat",t.SAGITTAL_REFORMAT="sagittal_reformat",t.REFORMAT="reformat"})(Zo||(Zo={}));var Ya;(function(t){t.CONTOUR="CONTOUR",t.SURFACE="SURFACE",t.MESH="MESH"})(Ya||(Ya={}));var xd;(function(t){t.CLOSED_PLANAR="CLOSED_PLANAR",t.OPEN_PLANAR="OPEN_PLANAR"})(xd||(xd={}));const S7=xd;var ai;(function(t){t.PLY="PLY",t.STL="STL",t.OBJ="OBJ",t.VTP="VTP"})(ai||(ai={}));var ar;(function(t){t.LINEAR="LINEAR",t.SAMPLED_SIGMOID="SIGMOID",t.LINEAR_EXACT="LINEAR_EXACT"})(ar||(ar={}));var wd;(function(t){t.SUM="SUM",t.AVERAGE="AVERAGE",t.SUBTRACT="SUBTRACT"})(wd||(wd={}));const b7=wd;var oa;(function(t){t.NOT_APPLICABLE="",t.ERMF="ERMF",t.USER="User",t.PROJECTION="Proj",t.REGION="Region",t.ERROR="Error",t.UNCALIBRATED="Uncalibrated",t.CALIBRATED="Calibrated",t.UNKNOWN="Unknown"})(oa||(oa={}));var Mr;(function(t){t.NO_DATA="noData",t.LOADING="loading",t.PRE_RENDER="preRender",t.RESIZE="resize",t.RENDERED="rendered"})(Mr||(Mr={}));var jr;(function(t){t[t.FAR_REPLICATE=1]="FAR_REPLICATE",t[t.ADJACENT_REPLICATE=3]="ADJACENT_REPLICATE",t[t.SUBRESOLUTION=6]="SUBRESOLUTION",t[t.LOSSY=7]="LOSSY",t[t.FULL_RESOLUTION=8]="FULL_RESOLUTION"})(jr||(jr={}));var cl;(function(t){t.FRAME="f",t.SECOND="s"})(cl||(cl={}));const E7=Object.freeze(Object.defineProperty({__proto__:null,get SpeedUnit(){return cl}},Symbol.toStringTag,{value:"Module"}));var Ir;(function(t){t.CALIBRATION="calibrationModule",t.CINE="cineModule",t.GENERAL_IMAGE="generalImageModule",t.GENERAL_SERIES="generalSeriesModule",t.GENERAL_STUDY="generalStudyModule",t.IMAGE_PIXEL="imagePixelModule",t.IMAGE_PLANE="imagePlaneModule",t.IMAGE_URL="imageUrlModule",t.MODALITY_LUT="modalityLutModule",t.MULTIFRAME="multiframeModule",t.NM_MULTIFRAME_GEOMETRY="nmMultiframeGeometryModule",t.OVERLAY_PLANE="overlayPlaneModule",t.PATIENT="patientModule",t.PATIENT_STUDY="patientStudyModule",t.PET_IMAGE="petImageModule",t.PET_ISOTOPE="petIsotopeModule",t.PET_SERIES="petSeriesModule",t.SOP_COMMON="sopCommonModule",t.ULTRASOUND_ENHANCED_REGION="ultrasoundEnhancedRegionModule",t.VOI_LUT="voiLutModule",t.WADO_WEB_CLIENT="wadoWebClient"})(Ir||(Ir={}));var Cd;(function(t){t.SUM="SUM",t.SUBTRACT="SUBTRACT",t.AVERAGE="AVERAGE"})(Cd||(Cd={}));var gf;(function(t){t.RLE="RLE",t.Volume="Volume"})(gf||(gf={}));var ic;(function(t){t.Tiled="tiled",t.ContextPool="contextPool"})(ic||(ic={}));const ph=Object.freeze(Object.defineProperty({__proto__:null,BlendModes:_7,CalibrationTypes:oa,ContourType:S7,DynamicOperatorType:b7,Events:Je,get GenerateImageType(){return Cd},GeometryType:Ya,ImageQualityStatus:jr,InterpolationType:Ka,MeshType:ai,MetadataModules:Ir,OrientationAxis:Zo,RenderingEngineModeEnum:ic,RequestType:St,VOILUTFunctionType:ar,VideoEnums:E7,ViewportStatus:Mr,ViewportType:tn,VoxelManagerEnum:gf},Symbol.toStringTag,{value:"Module"})),Td={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}},Tn={MINIMUM_SLAB_THICKNESS:.05,MAXIMUM_RAY_DISTANCE:1e6};Object.freeze(Tn);const xi=.001;function J5(t){const e=Object.getOwnPropertyNames(t);for(const n of e){const r=t[n];r&&typeof r=="object"&&J5(r)}return Object.freeze(t)}const D7={axial:{viewPlaneNormal:[0,0,-1],viewUp:[0,-1,0],viewRight:[1,0,0]},sagittal:{viewPlaneNormal:[1,0,0],viewUp:[0,0,1],viewRight:[0,1,0]},coronal:{viewPlaneNormal:[0,-1,0],viewUp:[0,0,1],viewRight:[1,0,0]}},jo=J5(D7),Z5=[{name:"CT-AAA",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 143.556 0 166.222 0.686275 214.389 0.696078 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 143.556 0.615686 0.356863 0.184314 166.222 0.882353 0.603922 0.290196 214.389 1 1 1 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-AAA2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"16 -3024 0 129.542 0 145.244 0.166667 157.02 0.5 169.918 0.627451 395.575 0.8125 1578.73 0.8125 3071 0.8125",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"32 -3024 0 0 0 129.542 0.54902 0.25098 0.14902 145.244 0.6 0.627451 0.843137 157.02 0.890196 0.47451 0.6 169.918 0.992157 0.870588 0.392157 395.575 1 0.886275 0.658824 1578.73 1 0.829256 0.957922 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -16.4458 0 641.385 0.715686 3071 0.705882",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -16.4458 0.729412 0.254902 0.301961 641.385 0.905882 0.815686 0.552941 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bones",gradientOpacity:"4 0 1 985.12 1",specularPower:"1",scalarOpacity:"8 -1000 0 152.19 0 278.93 0.190476 952 0.2",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -1000 0.3 0.3 1 -488 0.3 1 0.3 463.28 1 0 0 659.15 1 0.912535 0.0374849 953 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-Cardiac",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 -77.6875 0 94.9518 0.285714 179.052 0.553571 260.439 0.848214 3071 0.875",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 -77.6875 0.54902 0.25098 0.14902 94.9518 0.882353 0.603922 0.290196 179.052 1 0.937033 0.954531 260.439 0.615686 0 0 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 42.8964 0 163.488 0.428571 277.642 0.776786 1587 0.754902 3071 0.754902",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 42.8964 0.54902 0.25098 0.14902 163.488 0.917647 0.639216 0.0588235 277.642 1 0.878431 0.623529 1587 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -3024 0 -86.9767 0 45.3791 0.169643 139.919 0.589286 347.907 0.607143 1224.16 0.607143 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -3024 0 0 0 -86.9767 0 0.25098 1 45.3791 1 0 0 139.919 1 0.894893 0.894893 347.907 1 1 0.25098 1224.16 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Contrast-Enhanced",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 67.0106 0 251.105 0.446429 439.291 0.625 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 67.0106 0.54902 0.25098 0.14902 251.105 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Vessels",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -3024 0 -1278.35 0 22.8277 0.428571 439.291 0.625 3071 0.616071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -3024 0 0 0 -1278.35 0.54902 0.25098 0.14902 22.8277 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 136.47 0 159.215 0.258929 318.43 0.571429 478.693 0.776786 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 136.47 0 0 0 159.215 0.159804 0.159804 0.159804 318.43 0.764706 0.764706 0.764706 478.693 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-2",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 142.677 0 145.016 0.116071 192.174 0.5625 217.24 0.776786 384.347 0.830357 3661 0.830357",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 142.677 0 0 0 145.016 0.615686 0 0.0156863 192.174 0.909804 0.454902 0 217.24 0.972549 0.807843 0.611765 384.347 0.909804 0.909804 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -2048 0 128.643 0 129.982 0.0982143 173.636 0.669643 255.884 0.857143 584.878 0.866071 3661 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -2048 0 0 0 128.643 0 0 0 129.982 0.615686 0 0.0156863 173.636 0.909804 0.454902 0 255.884 0.886275 0.886275 0.886275 584.878 0.968627 0.968627 0.968627 3661 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cropped-Volume-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -451 0 -450 1 1050 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -451 0 0 0 -450 0.0556356 0.0556356 0.0556356 1050 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Fat",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"14 -1000 0 -100 0 -99 0.15 -60 0.15 -59 0 101.2 0 952 0",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"36 -1000 0.3 0.3 1 -497.5 0.3 1 0.3 -99 0 0 1 -76.946 0 1 0 -65.481 0.835431 0.888889 0.0165387 83.89 1 0 0 463.28 1 0 0 659.15 1 0.912535 0.0374849 2952 1 0.300267 0.299886",diffuse:"1",interpolation:"1"},{name:"CT-Liver-Vasculature",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 149.113 0 157.884 0.482143 339.96 0.660714 388.526 0.830357 1197.95 0.839286 3661 0.848214",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 149.113 0 0 0 157.884 0.501961 0.25098 0 339.96 0.695386 0.59603 0.36886 388.526 0.854902 0.85098 0.827451 1197.95 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Lung",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"12 -1000 0 -600 0 -599 0.15 -400 0.15 -399 0 2952 0",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -1000 0.3 0.3 1 -600 0 0 1 -530 0.134704 0.781726 0.0724558 -460 0.929244 1 0.109473 -400 0.888889 0.254949 0.0240258 2952 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -637.62 0 700 1 3071 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -637.62 1 1 1 700 1 1 1 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Muscle",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 -155.407 0 217.641 0.676471 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 -155.407 0.54902 0.25098 0.14902 217.641 0.882353 0.603922 0.290196 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Pulmonary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 -568.625 0 -364.081 0.0714286 -244.813 0.401786 18.2775 0.607143 447.798 0.830357 3592.73 0.839286",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 -568.625 0 0 0 -364.081 0.396078 0.301961 0.180392 -244.813 0.611765 0.352941 0.0705882 18.2775 0.843137 0.0156863 0.156863 447.798 0.752941 0.752941 0.752941 3592.73 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Soft-Tissue",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -167.01 0 -160 1 240 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -167.01 0 0 0 -160 0.0556356 0.0556356 0.0556356 240 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Air",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0.705882 -900.0 0.715686 -500.0 0 3071 0",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 1 1 1 -900.0 0.2 1.0 1.0 -500.0 0.3 0.3 1.0 3071 0 0 0 ",diffuse:"0.9",interpolation:"1"},{name:"MR-Angio",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 151.354 0 158.279 0.4375 190.112 0.580357 200.873 0.732143 3661 0.741071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 151.354 0 0 0 158.279 0.74902 0.376471 0 190.112 1 0.866667 0.733333 200.873 0.937255 0.937255 0.937255 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-Default",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 0 0 20 0 40 0.15 120 0.3 220 0.375 1024 0.5",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 0 0 0 0 20 0.168627 0 0 40 0.403922 0.145098 0.0784314 120 0.780392 0.607843 0.380392 220 0.847059 0.835294 0.788235 1024 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"8 0 0 98.3725 0 416.637 1 2800 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"16 0 1 1 1 98.3725 1 1 1 416.637 1 1 1 2800 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-T2-Brain",gradientOpacity:"4 0 1 160.25 1",specularPower:"40",scalarOpacity:"10 0 0 36.05 0 218.302 0.171429 412.406 1 641 1",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"16 0 0 0 0 98.7223 0.956863 0.839216 0.192157 412.406 0 0.592157 0.807843 641 1 1 1",diffuse:"0.6",interpolation:"1"},{name:"DTI-FA-Brain",gradientOpacity:"4 0 1 0.9950 1",specularPower:"40",scalarOpacity:"16 0 0 0 0 0.3501 0.0158 0.49379 0.7619 0.6419 1 0.9920 1 0.9950 0 0.9950 0",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"28 0 1 0 0 0 1 0 0 0.24974 0.4941 1 0 0.49949 0 0.9882 1 0.7492 0.51764 0 1 0.9950 1 0 0 0.9950 1 0 0",diffuse:"0.9",interpolation:"1"}],O7={slicer3D:[160/255,164/255,217/255]},Q5=Object.freeze(Object.defineProperty({__proto__:null,BACKGROUND_COLORS:O7,CPU_COLORMAPS:Td,EPSILON:xi,MPR_CAMERA_VALUES:jo,RENDERING_DEFAULTS:Tn,VIEWPORT_PRESETS:Z5},Symbol.toStringTag,{value:"Module"})),pu={},ul={get:t=>pu[t],set:t=>{const e=t.id;pu[e]=t},delete:t=>delete pu[t],getAll:()=>{const e=Object.keys(pu).map(n=>pu[n]);return e.sort((n,r)=>n.id[0]==="_"&&r.id[0]!=="_"?1:n.id[0]!=="_"&&r.id[0]==="_"?-1:0),e}};function Ol(t){return ul.get(t)}function is(){return ul.getAll()}const mf=t=>t&&typeof t=="object"&&Object.prototype.toString.call(t)!=="[object RegExp]"&&Object.prototype.toString.call(t)!=="[object Date]",R7=t=>Array.isArray(t)?[]:{},ll=(t,e)=>e&&e.clone===!0&&mf(t)?Rl(R7(t),t,e):t,tm=(t,e,n)=>{const r=t.slice();return e.forEach(function(i,a){typeof r[a]>"u"?r[a]=ll(i,n):mf(i)?r[a]=Rl(t[a],i,n):t.indexOf(i)===-1&&(r[a]=ll(i,n))}),r},M7=(t,e,n)=>{const r={};return mf(t)&&Object.keys(t).forEach(function(i){r[i]=ll(t[i],n)}),Object.keys(e).forEach(function(i){!mf(e[i])||!t[i]?r[i]=ll(e[i],n):r[i]=Rl(t[i],e[i],n)}),r},Rl=(t={},e={},n=void 0)=>{const r=Array.isArray(e),a=(n||{arrayMerge:tm}).arrayMerge||tm;return r?Array.isArray(t)?a(t,e,n):ll(e,n):M7(t,e,n)};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const e3=Symbol("Comlink.proxy"),N7=Symbol("Comlink.endpoint"),t3=Symbol("Comlink.releaseProxy"),ep=Symbol("Comlink.finalizer"),P0=Symbol("Comlink.thrown"),n3=t=>typeof t=="object"&&t!==null||typeof t=="function",L7={canHandle:t=>n3(t)&&t[e3],serialize(t){const{port1:e,port2:n}=new MessageChannel;return Fg(t,e),[n,[n]]},deserialize(t){return t.start(),_d(t)}},A7={canHandle:t=>n3(t)&&P0 in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},r3=new Map([["proxy",L7],["throw",A7]]);function F7(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function Fg(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!F7(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:o,path:s}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(js);let l;try{const f=s.slice(0,-1).reduce((h,p)=>h[p],t),u=s.reduce((h,p)=>h[p],t);switch(o){case"GET":l=u;break;case"SET":f[s.slice(-1)[0]]=js(i.data.value),l=!0;break;case"APPLY":l=u.apply(f,c);break;case"CONSTRUCT":{const h=new u(...c);l=s3(h)}break;case"ENDPOINT":{const{port1:h,port2:p}=new MessageChannel;Fg(t,p),l=U7(h,[h])}break;case"RELEASE":l=void 0;break;default:return}}catch(f){l={value:f,[P0]:0}}Promise.resolve(l).catch(f=>({value:f,[P0]:0})).then(f=>{const[u,h]=xf(f);e.postMessage(Object.assign(Object.assign({},u),{id:a}),h),o==="RELEASE"&&(e.removeEventListener("message",r),i3(e),ep in t&&typeof t[ep]=="function"&&t[ep]())}).catch(f=>{const[u,h]=xf({value:new TypeError("Unserializable return value"),[P0]:0});e.postMessage(Object.assign(Object.assign({},u),{id:a}),h)})}),e.start&&e.start()}function I7(t){return t.constructor.name==="MessagePort"}function i3(t){I7(t)&&t.close()}function _d(t,e){const n=new Map;return t.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const o=n.get(a.id);if(o)try{o(a)}finally{n.delete(a.id)}}),Sd(t,n,[],e)}function Zl(t){if(t)throw new Error("Proxy has been released and is not useable")}function a3(t){return Tc(t,new Map,{type:"RELEASE"}).then(()=>{i3(t)})}const vf=new WeakMap,yf="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(vf.get(t)||0)-1;vf.set(t,e),e===0&&a3(t)});function P7(t,e){const n=(vf.get(e)||0)+1;vf.set(e,n),yf&&yf.register(t,e,t)}function V7(t){yf&&yf.unregister(t)}function Sd(t,e,n=[],r=function(){}){let i=!1;const a=new Proxy(r,{get(o,s){if(Zl(i),s===t3)return()=>{V7(a),a3(t),e.clear(),i=!0};if(s==="then"){if(n.length===0)return{then:()=>a};const c=Tc(t,e,{type:"GET",path:n.map(l=>l.toString())}).then(js);return c.then.bind(c)}return Sd(t,e,[...n,s])},set(o,s,c){Zl(i);const[l,f]=xf(c);return Tc(t,e,{type:"SET",path:[...n,s].map(u=>u.toString()),value:l},f).then(js)},apply(o,s,c){Zl(i);const l=n[n.length-1];if(l===N7)return Tc(t,e,{type:"ENDPOINT"}).then(js);if(l==="bind")return Sd(t,e,n.slice(0,-1));const[f,u]=nm(c);return Tc(t,e,{type:"APPLY",path:n.map(h=>h.toString()),argumentList:f},u).then(js)},construct(o,s){Zl(i);const[c,l]=nm(s);return Tc(t,e,{type:"CONSTRUCT",path:n.map(f=>f.toString()),argumentList:c},l).then(js)}});return P7(a,t),a}function k7(t){return Array.prototype.concat.apply([],t)}function nm(t){const e=t.map(xf);return[e.map(n=>n[0]),k7(e.map(n=>n[1]))]}const o3=new WeakMap;function U7(t,e){return o3.set(t,e),t}function s3(t){return Object.assign(t,{[e3]:!0})}function xf(t){for(const[e,n]of r3)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},o3.get(t)||[]]}function js(t){switch(t.type){case"HANDLER":return r3.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Tc(t,e,n,r){return new Promise(i=>{const a=B7();e.set(a,i),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),r)})}function B7(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function si(){return typeof crypto.randomUUID=="function"?crypto.randomUUID():("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}class Ig{constructor(e){this.numRequests={[St.Interaction]:0,[St.Thumbnail]:0,[St.Prefetch]:0,[St.Compute]:0},this.id=e||si(),this.requestPool={[St.Interaction]:{0:[]},[St.Thumbnail]:{0:[]},[St.Prefetch]:{0:[]},[St.Compute]:{0:[]}},this.grabDelay=5,this.awake=!1,this.numRequests={[St.Interaction]:0,[St.Thumbnail]:0,[St.Prefetch]:0,[St.Compute]:0},this.maxNumRequests={[St.Interaction]:6,[St.Thumbnail]:6,[St.Prefetch]:5,[St.Compute]:1e3}}setMaxSimultaneousRequests(e,n){this.maxNumRequests[e]=n}getMaxSimultaneousRequests(e){return this.maxNumRequests[e]}destroy(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}addRequest(e,n,r,i=0){const a={requestFn:e,type:n,additionalDetails:r};this.requestPool[n][i]===void 0&&(this.requestPool[n][i]=[]),this.requestPool[n][i].push(a),this.startGrabbing()}filterRequests(e){Object.keys(this.requestPool).forEach(n=>{const r=this.requestPool[n];Object.keys(r).forEach(i=>{r[i]=r[i].filter(a=>e(a))})})}clearRequestStack(e){if(!this.requestPool[e])throw new Error(`No category for the type ${e} found`);this.requestPool[e]={0:[]}}sendRequests(e){const n=this.maxNumRequests[e]-this.numRequests[e];let r=0;for(let i=0;i<n;i++){const a=this.getNextRequest(e);if(a===null)return!1;if(a){this.numRequests[e]++,this.awake=!0;let o;try{o=a.requestFn()}catch(s){console.warn("sendRequest failed",s)}o?.finally?o.finally(()=>{this.numRequests[e]--,this.startAgain()}):(this.numRequests[e]--,r++)}}return r&&this.startAgain(),!0}getNextRequest(e){const n=this.getSortedPriorityGroups(e);for(const r of n)if(this.requestPool[e][r].length)return this.requestPool[e][r].shift();return null}startGrabbing(){const e=this.sendRequests(St.Interaction),n=this.sendRequests(St.Thumbnail),r=this.sendRequests(St.Prefetch),i=this.sendRequests(St.Compute);!e&&!n&&!r&&!i&&(this.awake=!1)}startAgain(){this.awake&&(this.grabDelay!==void 0?this.timeoutHandle||(this.timeoutHandle=window.setTimeout(()=>{this.timeoutHandle=null,this.startGrabbing()},this.grabDelay)):this.startGrabbing())}getSortedPriorityGroups(e){return Object.keys(this.requestPool[e]).map(Number).filter(r=>this.requestPool[e][r].length).sort((r,i)=>r-i)}getRequestPool(){return this.requestPool}}class c3{constructor(){this.workerRegistry={},this.workerPoolManager=new Ig("webworker")}registerWorker(e,n,r={}){const{maxWorkerInstances:i=1,overwrite:a=!1,autoTerminateOnIdle:o={enabled:!1,idleTimeThreshold:3e3}}=r;if(this.workerRegistry[e]&&!a){console.warn(`Worker type '${e}' is already registered...`);return}a&&this.workerRegistry[e]?.idleCheckIntervalId&&clearInterval(this.workerRegistry[e].idleCheckIntervalId);const s={workerFn:null,instances:[],loadCounters:[],lastActiveTime:[],nativeWorkers:[],autoTerminateOnIdle:o.enabled,idleCheckIntervalId:null,idleTimeThreshold:o.idleTimeThreshold};s.loadCounters=Array(i).fill(0),s.lastActiveTime=Array(i).fill(null);for(let c=0;c<i;c++){const l=n();s.instances.push(_d(l)),s.nativeWorkers.push(l),s.workerFn=n}this.workerRegistry[e]=s}getNextWorkerAPI(e){const n=this.workerRegistry[e];if(!n)return console.error(`Worker type '${e}' is not registered.`),null;const r=n.instances.filter(o=>o!==null);let i=0,a=n.loadCounters[0]||0;for(let o=1;o<r.length;o++){const s=n.loadCounters[o]||0;s<a&&(i=o,a=s)}if(n.instances[i]===null){const o=n.workerFn();n.instances[i]=_d(o),n.nativeWorkers[i]=o}return n.loadCounters[i]+=1,{api:n.instances[i],index:i}}executeTask(e,n,r={},{requestType:i=St.Compute,priority:a=0,options:o={},callbacks:s=[]}={}){return new Promise((c,l)=>{const f=async()=>{const{api:u,index:h}=this.getNextWorkerAPI(e);if(!u){const p=new Error(`No available worker instance for '${e}'`);console.error(p),l(p);return}try{let p=[];s.length&&(p=s.map(y=>s3(y)));const d=this.workerRegistry[e];d.processing=!0;const g=await u[n](r,...p);d.processing=!1,d.lastActiveTime[h]=Date.now(),d.autoTerminateOnIdle&&!d.idleCheckIntervalId&&d.idleTimeThreshold&&(d.idleCheckIntervalId=setInterval(()=>{this.terminateIdleWorkers(e,d.idleTimeThreshold)},d.idleTimeThreshold)),c(g)}catch(p){console.error(`Error executing method '${n}' on worker '${e}':`,p),l(p)}finally{this.workerRegistry[e].loadCounters[h]--}};this.workerPoolManager.addRequest(f,i,o,a)})}terminateIdleWorkers(e,n){const r=this.workerRegistry[e];if(r.processing)return;const i=Date.now();r.instances.forEach((a,o)=>{const s=r.lastActiveTime[o],c=s!==null&&r.loadCounters[o]>0,l=i-s;!c&&l>n&&this.terminateWorkerInstance(e,o)})}terminate(e){const n=this.workerRegistry[e];if(!n){console.error(`Worker type '${e}' is not registered.`);return}n.instances.forEach((r,i)=>{this.terminateWorkerInstance(e,i)})}terminateWorkerInstance(e,n){const r=this.workerRegistry[e],i=r.instances[n];i!==null&&(i[t3](),r.nativeWorkers[n].terminate(),r.instances[n]=null,r.lastActiveTime[n]=null)}}const tp=4,G7=5,W7=1,rm=[1,1];function im({ext:t,filterType:e,texData:n,internalFormat:r,glDataType:i}){try{const a=document.createElement("canvas");a.width=tp,a.height=tp;const o=a.getContext("webgl2");if(!o)return!1;const s=`#version 300 es
    void main() {
      gl_PointSize = ${tp.toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,c=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `;let l;if(t&&(l=o.getExtension(t),!l))return!1;const f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,s),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,c),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const h=o.createProgram();if(o.attachShader(h,f),o.attachShader(h,u),o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))return!1;const p=o.createTexture();o.bindTexture(o.TEXTURE_2D,p),o.texImage2D(o.TEXTURE_2D,0,r(o,l),G7,W7,0,o.RED,i(o,l),n);const d=e==="LINEAR"?o.LINEAR:o.NEAREST;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,d),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,d),o.useProgram(h),o.drawArrays(o.POINTS,0,1);const g=new Uint8Array(4);o.readPixels(rm[0],rm[1],1,1,o.RGBA,o.UNSIGNED_BYTE,g);const[y,x,m]=g,v=o.getExtension("WEBGL_lose_context");return v&&v.loseContext(),y===x&&x===m&&y!==0}catch{return!1}}function z7(){const t=new Int16Array([32767,2e3,3e3,4e3,5e3,16784,7e3,8e3,9e3,32767]);return{norm16:im({ext:"EXT_texture_norm16",filterType:"NEAREST",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT}),norm16Linear:im({ext:"EXT_texture_norm16",filterType:"LINEAR",texData:t,internalFormat:(e,n)=>n.R16_SNORM_EXT,glDataType:e=>e.SHORT})}}let $o=!1;const bd={gpuTier:{tier:2},isMobile:!1,rendering:{useCPURendering:!1,preferSizeOverAccuracy:!1,strictZSpacingForVolumeViewport:!0,renderingEngineMode:ic.ContextPool,webGlContextCount:7},peerImport:t=>null};let ni={...bd,rendering:{...bd.rendering}},ju=null,u3=!1;function j7(){const t=document.createElement("canvas");return t.getContext("webgl2")||t.getContext("webgl")||t.getContext("experimental-webgl")}function l3(){const t=j7();return t instanceof WebGLRenderingContext||t instanceof WebGL2RenderingContext}function $7(){const t=z7();return t.norm16&&t.norm16Linear}function f3(){return/iPad|iPhone|iPod/.test(navigator.platform)?!0:navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel")}function H7(t=ni){return $o||(u3=$7(),ni=Rl(bd,t),ni.isMobile&&(ni.rendering.webGlContextCount=1),f3()&&(t.rendering?.preferSizeOverAccuracy?ni.rendering.preferSizeOverAccuracy=!0:console.log("norm16 texture not supported, you can turn on the preferSizeOverAccuracy flag to use native data type, but be aware of the inaccuracy of the rendering in high bits")),l3()?console.log("CornerstoneRender: using GPU rendering"):(console.log("CornerstoneRender: GPU not detected, using CPU rendering"),ni.rendering.useCPURendering=!0),$o=!0,ju||(ju=new c3),$o)}function K7(){return u3}function q7(t,e=!0){ni.rendering.useCPURendering=t,$o=!0,e&&gh()}function X7(t){ni.rendering.preferSizeOverAccuracy=t,$o=!0,gh()}function dh(){return!f3()}function Y7(){ni.rendering.useCPURendering=!l3(),gh()}function Ac(){return ni.rendering.useCPURendering}function h3(){return $o}function J7(){$o=!1}function hc(){return ni}function Z7(t){ni=t,gh()}function gh(){is().forEach(t=>{t.getViewports().forEach(e=>{e.updateRenderingPipeline()})})}function p3(){return ju||(ju=new c3),ju}async function d3(t){return ni.peerImport(t)}class Q7{constructor(){this.listeners={},this.debouncedListeners={}}reset(){this.listeners={},this.debouncedListeners={}}addEventListenerOnce(e,n){const r=i=>{this.removeEventListener(e,r),n.call(this,i)};this.addEventListener(e,r)}addEventListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].indexOf(n)===-1&&this.listeners[e].push(n)}addEventListenerDebounced(e,n,r){this.debouncedListeners[e]=this.debouncedListeners[e]||{};const i=this.debouncedListeners[e];if(!i[n]){const a=o=>{i[n]&&clearTimeout(i[n].timeoutId),i[n].timeoutId=setTimeout(()=>{n.call(this,o)},r)};i[n]={original:n,handle:a,timeoutId:null},this.addEventListener(e,a)}}removeEventListenerDebounced(e,n){if(this.debouncedListeners[e]?.[n]){const r=this.debouncedListeners[e][n];this.removeEventListener(e,r.handle),clearTimeout(r.timeoutId),delete this.debouncedListeners[e][n]}}removeEventListener(e,n){if(!this.listeners[e])return;const r=this.listeners[e],i=r.length;for(let a=0;a<i;a++)if(r[a]===n){r.splice(a,1);return}}dispatchEvent(e){if(!this.listeners[e.type])return!e.defaultPrevented;const n=this.listeners[e.type].slice(),r=n.length;for(let i=0;i<r;i++)try{n[i].call(this,e)}catch(a){console.error(`error in event listener of type:  ${e.type}`,a)}return!e.defaultPrevented}}const vt=new Q7;function et(t=vt,e,n=null){if(!e)throw new Error("Event type was not defined");const r=new CustomEvent(e,{detail:n,cancelable:!0});return t?.dispatchEvent(r)}var du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e_(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var np,am;function t_(){return am||(am=1,np=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),np}var n_=t_();const Pg=wa(n_);var rp,om;function g3(){if(om)return rp;om=1;var t=Object.prototype.toString;return rp=function(n){var r=t.call(n),i=r==="[object Arguments]";return i||(i=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),i},rp}var ip,sm;function r_(){if(sm)return ip;sm=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=g3(),i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),o=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(h){var p=h.constructor;return p&&p.prototype===h},l={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if(typeof window>"u")return!1;for(var h in window)try{if(!l["$"+h]&&e.call(window,h)&&window[h]!==null&&typeof window[h]=="object")try{c(window[h])}catch{return!0}}catch{return!0}return!1}(),u=function(h){if(typeof window>"u"||!f)return c(h);try{return c(h)}catch{return!1}};t=function(p){var d=p!==null&&typeof p=="object",g=n.call(p)==="[object Function]",y=r(p),x=d&&n.call(p)==="[object String]",m=[];if(!d&&!g&&!y)throw new TypeError("Object.keys called on a non-object");var v=o&&g;if(x&&p.length>0&&!e.call(p,0))for(var w=0;w<p.length;++w)m.push(String(w));if(y&&p.length>0)for(var C=0;C<p.length;++C)m.push(String(C));else for(var T in p)!(v&&T==="prototype")&&e.call(p,T)&&m.push(String(T));if(a)for(var _=u(p),S=0;S<s.length;++S)!(_&&s[S]==="constructor")&&e.call(p,s[S])&&m.push(s[S]);return m}}return ip=t,ip}var ap,cm;function i_(){if(cm)return ap;cm=1;var t=Array.prototype.slice,e=g3(),n=Object.keys,r=n?function(o){return n(o)}:r_(),i=Object.keys;return r.shim=function(){if(Object.keys){var o=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);o||(Object.keys=function(c){return e(c)?i(t.call(c)):i(c)})}else Object.keys=r;return Object.keys||r},ap=r,ap}var op,um;function m3(){if(um)return op;um=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return op=t,op}var sp,lm;function a_(){return lm||(lm=1,sp=SyntaxError),sp}var cp,fm;function o_(){return fm||(fm=1,cp=TypeError),cp}var up,hm;function s_(){return hm||(hm=1,up=Object.getOwnPropertyDescriptor),up}var lp,pm;function c_(){if(pm)return lp;pm=1;var t=s_();if(t)try{t([],"length")}catch{t=null}return lp=t,lp}var fp,dm;function u_(){if(dm)return fp;dm=1;var t=m3(),e=a_(),n=o_(),r=c_();return fp=function(a,o,s){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,h=!!r&&r(a,o);if(t)t(a,o,{configurable:f===null&&h?h.configurable:!f,enumerable:c===null&&h?h.enumerable:!c,value:s,writable:l===null&&h?h.writable:!l});else if(u||!c&&!l&&!f)a[o]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},fp}var hp,gm;function l_(){if(gm)return hp;gm=1;var t=m3(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},hp=e,hp}var pp,mm;function v3(){if(mm)return pp;mm=1;var t=i_(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,i=u_(),a=function(l){return typeof l=="function"&&n.call(l)==="[object Function]"},o=l_()(),s=function(l,f,u,h){if(f in l){if(h===!0){if(l[f]===u)return}else if(!a(h)||!h())return}o?i(l,f,u,!0):i(l,f,u)},c=function(l,f){var u=arguments.length>2?arguments[2]:{},h=t(f);e&&(h=r.call(h,Object.getOwnPropertySymbols(f)));for(var p=0;p<h.length;p+=1)s(l,h[p],f[h[p]],u[h[p]])};return c.supportsDescriptors=!!o,pp=c,pp}var gu={exports:{}},vm;function y3(){return vm||(vm=1,typeof self<"u"?gu.exports=self:typeof window<"u"?gu.exports=window:gu.exports=Function("return this")()),gu.exports}var dp,ym;function x3(){if(ym)return dp;ym=1;var t=y3();return dp=function(){return typeof du!="object"||!du||du.Math!==Math||du.Array!==Array?t:du},dp}var gp,xm;function f_(){if(xm)return gp;xm=1;var t=v3(),e=x3();return gp=function(){var r=e();if(t.supportsDescriptors){var i=Object.getOwnPropertyDescriptor(r,"globalThis");(!i||i.configurable&&(i.enumerable||!i.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},gp}var mp,wm;function h_(){if(wm)return mp;wm=1;var t=v3(),e=y3(),n=x3(),r=f_(),i=n(),a=function(){return i};return t(a,{getPolyfill:n,implementation:e,shim:r}),mp=a,mp}var p_=h_();const d_=wa(p_),Vi=d_(),w3={vtkObject:()=>null};function Bi(t){if(t==null||t.isA)return t;if(!t.vtkClass)return Vi.console&&Vi.console.error&&Vi.console.error("Invalid VTK object"),null;const e=w3[t.vtkClass];if(!e)return Vi.console&&Vi.console.error&&Vi.console.error(`No vtk class found for Object of type ${t.vtkClass}`),null;const n={...t};Object.keys(n).forEach(i=>{n[i]&&typeof n[i]=="object"&&n[i].vtkClass&&(n[i]=Bi(n[i]))});const r=e(n);return r&&r.modified&&r.modified(),r}function g_(t,e){w3[t]=e}Bi.register=g_;class vp extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}let Ed=0;const C3=Symbol("void");function m_(){return Ed}const T3={};function $s(){}const v_=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];v_.forEach(t=>{T3[t]=$s});Vi.console=console.hasOwnProperty("log")?console:T3;const ts={debug:$s,error:Vi.console.error||$s,info:Vi.console.info||$s,log:Vi.console.log||$s,warn:Vi.console.warn||$s};function _3(t,e){ts[t]&&(ts[t]=e||$s)}function S3(){ts.log(...arguments)}function b3(){ts.info(...arguments)}function wf(){ts.debug(...arguments)}function At(){ts.error(...arguments)}function mh(){ts.warn(...arguments)}const Cm={};function E3(t){Cm[t]||(ts.error(t),Cm[t]=!0)}const gr=Object.create(null);gr.Float32Array=Float32Array;gr.Float64Array=Float64Array;gr.Uint8Array=Uint8Array;gr.Int8Array=Int8Array;gr.Uint16Array=Uint16Array;gr.Int16Array=Int16Array;gr.Uint32Array=Uint32Array;gr.Int32Array=Int32Array;gr.Uint8ClampedArray=Uint8ClampedArray;try{gr.BigInt64Array=BigInt64Array,gr.BigUint64Array=BigUint64Array}catch{}function Qc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new(gr[t]||Float64Array)(...n)}function vh(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return(gr[t]||Float64Array).from(...n)}function yh(t){return t.charAt(0).toUpperCase()+t.slice(1)}function En(t){return yh(t[0]==="_"?t.slice(1):t)}function D3(t){return t.charAt(0).toLowerCase()+t.slice(1)}function O3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let i=Number(t),a="B";for(;i>n;)i/=n,a=r.pop();return`${i.toFixed(e)} ${a}`}function R3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=t;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(e)}function M3(t){Object.keys(t).forEach(e=>{Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function y_(t){return Object.values(gr).some(e=>t instanceof e)}function x_(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return!1}function w_(t,e){return Object.keys(t).find(n=>t[n]===e)}function N3(t){return t&&t.isA?t.getState():t}function Vg(t){setTimeout(t,0)}function L3(t,e){const n=performance.now();t.finally(()=>{const r=performance.now()-n;e(r)})}function an(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};M3(e);const n=[];if(Number.isInteger(e.mtime)||(e.mtime=++Ed),!("classHierarchy"in e))e.classHierarchy=new vp("vtkObject");else if(!(e.classHierarchy instanceof vp)){const a=new vp;for(let o=0;o<e.classHierarchy.length;o++)a.push(e.classHierarchy[o]);e.classHierarchy=a}function r(a){n[a]=null}function i(a){function o(){r(a)}return Object.freeze({unsubscribe:o})}return t.isDeleted=()=>!!e.deleted,t.modified=a=>{if(e.deleted){At("instance deleted - cannot call any method");return}a&&a<t.getMTime()||(e.mtime=++Ed,n.forEach(o=>o&&o(t)))},t.onModified=a=>{if(e.deleted)return At("instance deleted - cannot call any method"),null;const o=n.length;return n.push(a),i(o)},t.getMTime=()=>e.mtime,t.isA=a=>{let o=e.classHierarchy.length;for(;o--;)if(e.classHierarchy[o]===a)return!0;return!1},t.getClassName=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-a]},t.set=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=!1;return Object.keys(a).forEach(l=>{const f=s?null:t[`set${yh(l)}`];f&&Array.isArray(a[l])&&f.length>1?c=f(...a[l])||c:f?c=f(a[l])||c:(["mtime"].indexOf(l)===-1&&!o&&mh(`Warning: Set value to model directly ${l}, ${a[l]}`),c=e[l]!==a[l]||c,e[l]=a[l])}),c},t.get=function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];if(!o.length)return e;const c={};return o.forEach(l=>{c[l]=e[l]}),c},t.getReferenceByName=a=>e[a],t.delete=()=>{Object.keys(e).forEach(a=>delete e[a]),n.forEach((a,o)=>r(o)),e.deleted=!0},t.getState=()=>{if(e.deleted)return null;const a={...e,vtkClass:t.getClassName()};Object.keys(a).forEach(s=>{a[s]===null||a[s]===void 0||s[0]==="_"?delete a[s]:a[s].isA?a[s]=a[s].getState():Array.isArray(a[s])?a[s]=a[s].map(N3):y_(a[s])&&(a[s]=Array.from(a[s]))});const o={};return Object.keys(a).sort().forEach(s=>{o[s]=a[s]}),o.mtime&&delete o.mtime,o},t.shallowCopy=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.getClassName()!==t.getClassName())throw new Error(`Cannot ShallowCopy ${a.getClassName()} into ${t.getClassName()}`);const s=a.get(),c=Object.keys(e).sort();Object.keys(s).sort().forEach(f=>{const u=c.indexOf(f);u===-1?o&&wf(`add ${f} in shallowCopy`):c.splice(u,1),e[f]=s[f]}),c.length&&o&&wf(`Untouched keys: ${c.join(", ")}`),t.modified()},t.toJSON=function(){return t.getState()},t}const C_={object(t,e,n){return function(){return{...e[n.name]}}}};function mr(t,e,n){n.forEach(r=>{if(typeof r=="object"){const i=C_[r.type];i?t[`get${En(r.name)}`]=i(t,e,r):t[`get${En(r.name)}`]=()=>e[r.name]}else t[`get${En(r)}`]=()=>e[r]})}const A3={enum(t,e,n){const r=`_on${En(n.name)}Changed`;return i=>{if(typeof i=="string"){if(n.enum[i]!==void 0)return e[n.name]!==n.enum[i]?(e[n.name]=n.enum[i],t.modified(),!0):!1;throw At(`Set Enum with invalid argument ${n}, ${i}`),new RangeError("Set Enum with invalid string argument")}if(typeof i=="number"){if(e[n.name]!==i){if(Object.keys(n.enum).map(a=>n.enum[a]).indexOf(i)!==-1){const a=e[n.name];return e[n.name]=i,e[r]?.(t,e,i,a),t.modified(),!0}throw At(`Set Enum outside numeric range ${n}, ${i}`),new RangeError("Set Enum outside numeric range")}return!1}throw At(`Set Enum with invalid argument (String/Number) ${n}, ${i}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(t,e,n){n.params?.length===1&&mh('Setter of type "object" with a single "param" field is not supported');const r=`_on${En(n.name)}Changed`;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];let s;if(a.length>1&&n.params?.length?s=n.params.reduce((c,l,f)=>Object.assign(c,{[l]:a[f]}),{}):s=a[0],!Pg(e[n.name],s)){const c=e[n.name];return e[n.name]=s,e[r]?.(t,e,s,c),t.modified(),!0}return!1}}};function Tm(t){if(typeof t=="object"){const e=A3[t.type];if(e)return(n,r)=>e(n,r,t);throw At(`No setter for field ${t}`),new TypeError("No setter for field")}return function(n,r){const i=`_on${En(t)}Changed`;return function(o){if(r.deleted)return At("instance deleted - cannot call any method"),!1;if(r[t]!==o){const s=r[t.name];return r[t]=o,r[i]?.(n,r,o,s),n.modified(),!0}return!1}}}function Ml(t,e,n){n.forEach(r=>{typeof r=="object"?t[`set${En(r.name)}`]=Tm(r)(t,e):t[`set${En(r)}`]=Tm(r)(t,e)})}function bn(t,e,n){mr(t,e,n),Ml(t,e,n)}function eu(t,e,n){n.forEach(r=>{t[`get${En(r)}`]=()=>e[r]?Array.from(e[r]):e[r],t[`get${En(r)}ByReference`]=()=>e[r]})}function kg(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(a=>{if(e[a]&&r&&e[a].length!==r)throw new RangeError(`Invalid initial number of values for array (${a})`);const o=`_on${En(a)}Changed`;t[`set${En(a)}`]=function(){if(e.deleted)return At("instance deleted - cannot call any method"),!1;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];let f=c,u,h=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],h=!0),f==null)u=e[a]!==f;else{if(r&&f.length!==r)if(f.length<r&&i!==void 0)for(f=Array.from(f),h=!1;f.length<r;)f.push(i);else throw new RangeError(`Invalid number of values for array setter (${a})`);u=e[a]==null||e[a].length!==f.length;for(let p=0;!u&&p<f.length;++p)u=e[a][p]!==f[p];u&&h&&(f=Array.from(f))}if(u){const p=e[a.name];e[a]=f,e[o]?.(t,e,f,p),t.modified()}return u},t[`set${En(a)}From`]=s=>{const c=e[a];s.forEach((l,f)=>{c[f]=l})}})}function Ug(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;eu(t,e,n),kg(t,e,n,r,i)}function Nl(t,e,n){for(let r=0;r<n.length;r++){const i=n[r];e[i]!==void 0&&(e[`_${i}`]=e[i],delete e[i])}}function Bg(t,e,n,r){e.inputData?e.inputData=e.inputData.map(Bi):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(Bi):e.inputConnection=[],e.output?e.output=e.output.map(Bi):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(Bi):e.inputArrayToProcess=[],e.numberOfInputs=n;function i(p){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){At("instance deleted - cannot call any method");return}if(d>=e.numberOfInputs){At(`algorithm ${t.getClassName()} only has ${e.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(e.inputData[d]!==p||e.inputConnection[d])&&(e.inputData[d]=p,e.inputConnection[d]=null,t.modified&&t.modified())}function a(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[p]&&(e.inputData[p]=e.inputConnection[p]()),e.inputData[p]}function o(p){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){At("instance deleted - cannot call any method");return}if(d>=e.numberOfInputs){let g=`algorithm ${t.getClassName()} only has `;g+=`${e.numberOfInputs}`,g+=" input ports. To add more input ports, use addInputConnection()",At(g);return}e.inputData[d]=null,e.inputConnection[d]=p}function s(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[p]}function c(){let p=e.numberOfInputs;for(;p&&!e.inputData[p-1]&&!e.inputConnection[p-1];)p--;return p===e.numberOfInputs&&e.numberOfInputs++,p}function l(p){if(e.deleted){At("instance deleted - cannot call any method");return}o(p,c())}function f(p){if(e.deleted){At("instance deleted - cannot call any method");return}i(p,c())}function u(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(At("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[p])}t.shouldUpdate=()=>{const p=t.getMTime();let d=1/0,g=r;for(;g--;){if(!e.output[g]||e.output[g].isDeleted())return!0;const y=e.output[g].getMTime();if(y<p)return!0;y<d&&(d=y)}for(g=e.numberOfInputs;g--;)if(e.inputConnection[g]?.filter.shouldUpdate()||t.getInputData(g)?.getMTime()>d)return!0;return!1};function h(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const d=()=>u(p);return d.filter=t,d}if(e.numberOfInputs){let p=e.numberOfInputs;for(;p--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=i,t.setInputConnection=o,t.addInputData=f,t.addInputConnection=l,t.getInputData=a,t.getInputConnection=s}r&&(t.getOutputData=u,t.getOutputPort=h),t.update=()=>{const p=[];if(e.numberOfInputs){let d=0;for(;d<e.numberOfInputs;)p[d]=t.getInputData(d),d++}t.shouldUpdate()&&t.requestData&&t.requestData(p,e.output)},t.getNumberOfInputPorts=()=>e.numberOfInputs,t.getNumberOfOutputPorts=()=>r||e.output.length,t.getInputArrayToProcess=p=>{const d=e.inputArrayToProcess[p],g=e.inputData[p];return d&&g?g[`get${d.fieldAssociation}`]().getArray(d.arrayName):null},t.setInputArrayToProcess=function(p,d,g){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;e.inputArrayToProcess.length<p;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[p]={arrayName:d,fieldAssociation:g,attributeType:y}}}const Gg=Symbol("Event abort");function Wg(t,e,n){const r=[],i=t.delete;let a=1;function o(l){for(let f=0;f<r.length;++f){const[u]=r[f];if(u===l){r.splice(f,1);return}}}function s(l){function f(){o(l)}return Object.freeze({unsubscribe:f})}function c(){if(e.deleted){At("instance deleted - cannot call any method");return}const l=r.slice();for(let f=0;f<l.length;++f){const[,u,h]=l[f];if(u){if(h<0)setTimeout(()=>u.apply(t,arguments),1-h);else if(u.apply(t,arguments)===Gg)break}}}t[`invoke${En(n)}`]=c,t[`on${En(n)}`]=function(l){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!l.apply)return console.error(`Invalid callback for event ${n}`),null;if(e.deleted)return At("instance deleted - cannot call any method"),null;const u=a++;return r.push([u,l,f]),r.sort((h,p)=>p[2]-h[2]),s(u)},t.delete=()=>{i(),r.forEach(l=>{let[f]=l;return o(f)})}}function kt(t,e){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i={},a={};return t(a,i,r),Object.freeze(a)};return e&&Bi.register(e,n),n}function Ll(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e.filter(o=>!!o).map(o=>o(...i))}}function zg(t){return t&&t.isA&&t.isA("vtkObject")}function Cf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(zg(t)){if(r.indexOf(t)>=0)return n;r.push(t);const i=e(t);i!==void 0&&n.push(i);const a=t.get();Object.keys(a).forEach(o=>{const s=a[o];Array.isArray(s)?s.forEach(c=>{Cf(c,e,n,r)}):Cf(s,e,n,r)})}return n}function F3(t,e,n){var r=this;let i;const a=function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];const l=r,f=()=>{i=null,n||t.apply(l,s)},u=n&&!i;clearTimeout(i),i=setTimeout(f,e),u&&t.apply(l,s)};return a.cancel=()=>clearTimeout(i),a}function I3(t,e){let n=!1,r=null;function i(){n=!1,r!==null&&(a(...r),r=null)}function a(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];if(n){r=s;return}n=!0,t(...s),setTimeout(i,e)}return a}function jg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},n),t.setKey=(r,i)=>{e.keystore[r]=i},t.getKey=r=>e.keystore[r],t.getAllKeys=()=>Object.keys(e.keystore),t.deleteKey=r=>delete e.keystore[r],t.clearKeystore=()=>t.getAllKeys().forEach(r=>delete e.keystore[r])}let T_=1;const Ql="__root__";function P3(t,e){jg(t,e);const n=t.delete;e.proxyId=`${T_++}`,e.ui=JSON.parse(JSON.stringify(e.ui||[])),mr(t,e,["proxyId","proxyGroup","proxyName"]),bn(t,e,["proxyManager"]);const r={},i={};function a(l,f){i[f]||(i[f]=[]);const u=i[f];for(let h=0;h<l.length;h++)u.push(l[h].name),r[l[h].name]=l[h],l[h].children&&l[h].children.length&&a(l[h].children,l[h].name)}a(e.ui,Ql),t.updateUI=l=>{e.ui=JSON.parse(JSON.stringify(l||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(i).forEach(f=>delete i[f]),a(e.ui,Ql),t.modified()};function o(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ql;return i[l]}t.updateProxyProperty=(l,f)=>{const u=r[l];u?Object.assign(u,f):r[l]={...f}},t.activate=()=>{if(e.proxyManager){const l=`setActive${En(t.getProxyGroup().slice(0,-1))}`;e.proxyManager[l]&&e.proxyManager[l](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=(l,f)=>{f in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[f]=[]),e.propertyLinkSubscribers[f].push(l)},t.gcPropertyLinks=l=>{const f=e.propertyLinkSubscribers[l]||[];for(;f.length;)f.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(l){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[l])return e.propertyLinkMap[l];let u=null;const h=[];let p=0,d=!1;function g(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(d)return null;const T=[];let _=null;for(p=h.length;p--;){const b=h[p];b.instance===w?_=b:T.push(b)}if(!_)return null;const S=_.instance[`get${En(_.propertyName)}`]();if(!x_(S,u)||C){for(u=S,d=!0;T.length;){const b=T.pop();b.instance.set({[b.propertyName]:u})}d=!1}return e.propertyLinkMap[l].persistent&&(e.propertyLinkMap[l].value=S),S}function y(w,C){const T=[];for(p=h.length;p--;){const _=h[p];_.instance===w&&(_.propertyName===C||C===void 0)&&(_.subscription.unsubscribe(),T.push(p))}for(;T.length;)h.splice(T.pop(),1)}function x(w,C){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const _=w.onModified(g),S=h[0];return h.push({instance:w,propertyName:C,subscription:_}),T&&(e.propertyLinkMap[l].persistent&&e.propertyLinkMap[l].value!==void 0?w.set({[C]:e.propertyLinkMap[l].value}):S&&g(S.instance,!0)),{unsubscribe:()=>y(w,C)}}function m(){for(;h.length;)h.pop().subscription.unsubscribe()}const v={bind:x,unbind:y,unsubscribe:m,persistent:f};return e.propertyLinkMap[l]=v,v};function s(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ql;const f=[],u=e.proxyId,h=o(l)||[];for(let p=0;p<h.length;p++){const d=h[p],g=t[`get${En(d)}`],y=g?g():void 0,x={id:u,name:d,value:y},m=s(d);m.length&&(x.children=m),f.push(x)}return f}t.listPropertyNames=()=>s().map(l=>l.name),t.getPropertyByName=l=>s().find(f=>f.name===l),t.getPropertyDomainByName=l=>(r[l]||{}).domain,t.getProxySection=()=>({id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:s()}),t.delete=()=>{const l=Object.keys(e.propertyLinkMap);let f=l.length;for(;f--;)e.propertyLinkMap[l[f]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),n()},t.getState=()=>null;function c(){if(e.links)for(let l=0;l<e.links.length;l++){const{link:f,property:u,persistent:h,updateOnBind:p,type:d}=e.links[l];if(d==="application"){const g=e.proxyManager.getPropertyLink(f,h);t.registerPropertyLinkForGC(g,"application"),g.bind(t,u,p)}}}Vg(c)}function V3(t,e,n){const r=t.delete,i=[],a=Object.keys(n);let o=a.length;for(;o--;){const s=a[o],{modelKey:c,property:l,modified:f=!0}=n[s],u=En(l),h=En(s);t[`get${h}`]=e[c][`get${u}`],t[`set${h}`]=e[c][`set${u}`],f&&i.push(e[c].onModified(t.modified))}t.delete=()=>{for(;i.length;)i.pop().unsubscribe();r()}}function k3(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function i(s){const c=Object.keys(s);let l=c.length;for(;l--;){const f=c[l];e[f].set(s[f])}}const a=Object.keys(r);let o=a.length;for(;o--;){const s=a[o];e[s]=r[s];const c=n[s];t[`set${En(s)}`]=l=>{if(l!==e[s]){e[s]=l;const f=c[l];i(f),t.modified()}}}a.length&&mr(t,e,a)}const _m=10,Sm=40,bm=800;function U3(t){let e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*_m,i=n*_m,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(t.deltaMode===1?(r*=Sm,i*=Sm):(r*=bm,i*=bm)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n||e,pixelX:r,pixelY:i||r}}var J={algo:Bg,capitalize:yh,chain:Ll,debounce:F3,enumToString:w_,event:Wg,EVENT_ABORT:Gg,formatBytesToProperUnit:O3,formatNumbersWithThousandSeparator:R3,get:mr,getArray:eu,getCurrentGlobalMTime:m_,getStateArrayMapFunc:N3,isVtkObject:zg,keystore:jg,measurePromiseExecution:L3,moveToProtected:Nl,newInstance:kt,newTypedArray:Qc,newTypedArrayFrom:vh,normalizeWheel:U3,obj:an,proxy:P3,proxyPropertyMapping:V3,proxyPropertyState:k3,safeArrays:M3,set:Ml,setArray:kg,setGet:bn,setGetArray:Ug,setImmediate:Vg,setLoggerFunction:_3,throttle:I3,traverseInstanceTree:Cf,TYPED_ARRAYS:gr,uncapitalize:D3,VOID:C3,vtkDebugMacro:wf,vtkErrorMacro:At,vtkInfoMacro:b3,vtkLogMacro:S3,vtkOnceErrorMacro:E3,vtkWarningMacro:mh,objectSetterMap:A3},sr=Object.freeze({__proto__:null,VOID:C3,setLoggerFunction:_3,vtkLogMacro:S3,vtkInfoMacro:b3,vtkDebugMacro:wf,vtkErrorMacro:At,vtkWarningMacro:mh,vtkOnceErrorMacro:E3,TYPED_ARRAYS:gr,newTypedArray:Qc,newTypedArrayFrom:vh,capitalize:yh,_capitalize:En,uncapitalize:D3,formatBytesToProperUnit:O3,formatNumbersWithThousandSeparator:R3,setImmediateVTK:Vg,measurePromiseExecution:L3,obj:an,get:mr,set:Ml,setGet:bn,getArray:eu,setArray:kg,setGetArray:Ug,moveToProtected:Nl,algo:Bg,EVENT_ABORT:Gg,event:Wg,newInstance:kt,chain:Ll,isVtkObject:zg,traverseInstanceTree:Cf,debounce:F3,throttle:I3,keystore:jg,proxy:P3,proxyPropertyMapping:V3,proxyPropertyState:k3,normalizeWheel:U3,default:J}),V0={exports:{}},__=V0.exports,Em;function S_(){return Em||(Em=1,function(t){(function(e,n,r){function i(c){var l=this,f=s();l.next=function(){var u=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=u-(l.c=u|0)},l.c=1,l.s0=f(" "),l.s1=f(" "),l.s2=f(" "),l.s0-=f(c),l.s0<0&&(l.s0+=1),l.s1-=f(c),l.s1<0&&(l.s1+=1),l.s2-=f(c),l.s2<0&&(l.s2+=1),f=null}function a(c,l){return l.c=c.c,l.s0=c.s0,l.s1=c.s1,l.s2=c.s2,l}function o(c,l){var f=new i(c),u=l&&l.state,h=f.next;return h.int32=function(){return f.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,u&&(typeof u=="object"&&a(u,f),h.state=function(){return a(f,{})}),h}function s(){var c=4022871197,l=function(f){f=String(f);for(var u=0;u<f.length;u++){c+=f.charCodeAt(u);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=o:this.alea=o})(__,t)}(V0)),V0.exports}var k0={exports:{}},b_=k0.exports,Dm;function E_(){return Dm||(Dm=1,function(t){(function(e,n,r){function i(s){var c=this,l="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var u=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^u^u>>>8},s===(s|0)?c.x=s:l+=s;for(var f=0;f<l.length+64;f++)c.x^=l.charCodeAt(f)|0,c.next()}function a(s,c){return c.x=s.x,c.y=s.y,c.z=s.z,c.w=s.w,c}function o(s,c){var l=new i(s),f=c&&c.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,d=(h+p)/(1<<21);while(d===0);return d},u.int32=l.next,u.quick=u,f&&(typeof f=="object"&&a(f,l),u.state=function(){return a(l,{})}),u}n&&n.exports?n.exports=o:this.xor128=o})(b_,t)}(k0)),k0.exports}var U0={exports:{}},D_=U0.exports,Om;function O_(){return Om||(Om=1,function(t){(function(e,n,r){function i(s){var c=this,l="";c.next=function(){var u=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(u^u<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,s===(s|0)?c.x=s:l+=s;for(var f=0;f<l.length+64;f++)c.x^=l.charCodeAt(f)|0,f==l.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function a(s,c){return c.x=s.x,c.y=s.y,c.z=s.z,c.w=s.w,c.v=s.v,c.d=s.d,c}function o(s,c){var l=new i(s),f=c&&c.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,d=(h+p)/(1<<21);while(d===0);return d},u.int32=l.next,u.quick=u,f&&(typeof f=="object"&&a(f,l),u.state=function(){return a(l,{})}),u}n&&n.exports?n.exports=o:this.xorwow=o})(D_,t)}(U0)),U0.exports}var B0={exports:{}},R_=B0.exports,Rm;function M_(){return Rm||(Rm=1,function(t){(function(e,n,r){function i(s){var c=this;c.next=function(){var f=c.x,u=c.i,h,p;return h=f[u],h^=h>>>7,p=h^h<<24,h=f[u+1&7],p^=h^h>>>10,h=f[u+3&7],p^=h^h>>>3,h=f[u+4&7],p^=h^h<<7,h=f[u+7&7],h=h^h<<13,p^=h^h<<9,f[u]=p,c.i=u+1&7,p};function l(f,u){var h,p=[];if(u===(u|0))p[0]=u;else for(u=""+u,h=0;h<u.length;++h)p[h&7]=p[h&7]<<15^u.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],f.x=p,f.i=0,h=256;h>0;--h)f.next()}l(c,s)}function a(s,c){return c.x=s.x.slice(),c.i=s.i,c}function o(s,c){s==null&&(s=+new Date);var l=new i(s),f=c&&c.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,d=(h+p)/(1<<21);while(d===0);return d},u.int32=l.next,u.quick=u,f&&(f.x&&a(f,l),u.state=function(){return a(l,{})}),u}n&&n.exports?n.exports=o:this.xorshift7=o})(R_,t)}(B0)),B0.exports}var G0={exports:{}},N_=G0.exports,Mm;function L_(){return Mm||(Mm=1,function(t){(function(e,n,r){function i(s){var c=this;c.next=function(){var f=c.w,u=c.X,h=c.i,p,d;return c.w=f=f+1640531527|0,d=u[h+34&127],p=u[h=h+1&127],d^=d<<13,p^=p<<17,d^=d>>>15,p^=p>>>12,d=u[h]=d^p,c.i=h,d+(f^f>>>16)|0};function l(f,u){var h,p,d,g,y,x=[],m=128;for(u===(u|0)?(p=u,u=null):(u=u+"\0",p=0,m=Math.max(m,u.length)),d=0,g=-32;g<m;++g)u&&(p^=u.charCodeAt((g+32)%u.length)),g===0&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,g>=0&&(y=y+1640531527|0,h=x[g&127]^=p+y,d=h==0?d+1:0);for(d>=128&&(x[(u&&u.length||0)&127]=-1),d=127,g=4*128;g>0;--g)p=x[d+34&127],h=x[d=d+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,x[d]=p^h;f.w=y,f.X=x,f.i=d}l(c,s)}function a(s,c){return c.i=s.i,c.w=s.w,c.X=s.X.slice(),c}function o(s,c){s==null&&(s=+new Date);var l=new i(s),f=c&&c.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,d=(h+p)/(1<<21);while(d===0);return d},u.int32=l.next,u.quick=u,f&&(f.X&&a(f,l),u.state=function(){return a(l,{})}),u}n&&n.exports?n.exports=o:this.xor4096=o})(N_,t)}(G0)),G0.exports}var W0={exports:{}},A_=W0.exports,Nm;function F_(){return Nm||(Nm=1,function(t){(function(e,n,r){function i(s){var c=this,l="";c.next=function(){var u=c.b,h=c.c,p=c.d,d=c.a;return u=u<<25^u>>>7^h,h=h-p|0,p=p<<24^p>>>8^d,d=d-u|0,c.b=u=u<<20^u>>>12^h,c.c=h=h-p|0,c.d=p<<16^h>>>16^d,c.a=d-u|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,s===Math.floor(s)?(c.a=s/4294967296|0,c.b=s|0):l+=s;for(var f=0;f<l.length+20;f++)c.b^=l.charCodeAt(f)|0,c.next()}function a(s,c){return c.a=s.a,c.b=s.b,c.c=s.c,c.d=s.d,c}function o(s,c){var l=new i(s),f=c&&c.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var h=l.next()>>>11,p=(l.next()>>>0)/4294967296,d=(h+p)/(1<<21);while(d===0);return d},u.int32=l.next,u.quick=u,f&&(typeof f=="object"&&a(f,l),u.state=function(){return a(l,{})}),u}n&&n.exports?n.exports=o:this.tychei=o})(A_,t)}(W0)),W0.exports}var z0={exports:{}};const I_={},P_=Object.freeze(Object.defineProperty({__proto__:null,default:I_},Symbol.toStringTag,{value:"Module"})),da=e_(P_);var V_=z0.exports,Lm;function k_(){return Lm||(Lm=1,function(t){(function(e,n,r){var i=256,a=6,o=52,s="random",c=r.pow(i,a),l=r.pow(2,o),f=l*2,u=i-1,h;function p(w,C,T){var _=[];C=C==!0?{entropy:!0}:C||{};var S=x(y(C.entropy?[w,v(n)]:w??m(),3),_),b=new d(_),D=function(){for(var E=b.g(a),R=c,F=0;E<l;)E=(E+F)*i,R*=i,F=b.g(1);for(;E>=f;)E/=2,R/=2,F>>>=1;return(E+F)/R};return D.int32=function(){return b.g(4)|0},D.quick=function(){return b.g(4)/4294967296},D.double=D,x(v(b.S),n),(C.pass||T||function(E,R,F,M){return M&&(M.S&&g(M,b),E.state=function(){return g(b,{})}),F?(r[s]=E,R):E})(D,S,"global"in C?C.global:this==r,C.state)}function d(w){var C,T=w.length,_=this,S=0,b=_.i=_.j=0,D=_.S=[];for(T||(w=[T++]);S<i;)D[S]=S++;for(S=0;S<i;S++)D[S]=D[b=u&b+w[S%T]+(C=D[S])],D[b]=C;(_.g=function(E){for(var R,F=0,M=_.i,U=_.j,z=_.S;E--;)R=z[M=u&M+1],F=F*i+z[u&(z[M]=z[U=u&U+R])+(z[U]=R)];return _.i=M,_.j=U,F})(i)}function g(w,C){return C.i=w.i,C.j=w.j,C.S=w.S.slice(),C}function y(w,C){var T=[],_=typeof w,S;if(C&&_=="object")for(S in w)try{T.push(y(w[S],C-1))}catch{}return T.length?T:_=="string"?w:w+"\0"}function x(w,C){for(var T=w+"",_,S=0;S<T.length;)C[u&S]=u&(_^=C[u&S]*19)+T.charCodeAt(S++);return v(C)}function m(){try{var w;return h&&(w=h.randomBytes)?w=w(i):(w=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(w)),v(w)}catch{var C=e.navigator,T=C&&C.plugins;return[+new Date,e,T,e.screen,v(n)]}}function v(w){return String.fromCharCode.apply(0,w)}if(x(r.random(),n),t.exports){t.exports=p;try{h=da}catch{}}else r["seed"+s]=p})(typeof self<"u"?self:V_,[],Math)}(z0)),z0.exports}var yp,Am;function U_(){if(Am)return yp;Am=1;var t=S_(),e=E_(),n=O_(),r=M_(),i=L_(),a=F_(),o=k_();return o.alea=t,o.xor128=e,o.xorwow=n,o.xorshift7=r,o.xor4096=i,o.tychei=a,yp=o,yp}var B_=U_();const G_=wa(B_),$g=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],W_=[1,0,0,0,1,0,0,0,1],Hg=1e-6,Kg=1e-12,{vtkErrorMacro:B3,vtkWarningMacro:ac}=J;let G3=0;const Fm=20;function Al(t){return()=>B3(`vtkMath::${t} - NOT IMPLEMENTED`)}function $u(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[n*e+a],t[n*e+a]=t[r*e+a],t[r*e+a]=i}function Su(t,e,n,r){let i;for(let a=0;a<e;a++)i=t[a*e+n],t[a*e+n]=t[a*e+r],t[a*e+r]=i}function ln(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const e=Array(t);for(let n=0;n<t;++n)e[n]=0;return e}const z_=()=>Math.PI;function j_(t,e){return e>1023?t*2**1023*2**(e-1023):e<-1074?t*2**-1074*2**(e+1074):t*2**e}function Cn(t){return t/180*Math.PI}function Tf(t){return t*180/Math.PI}const{round:bu,floor:qg,ceil:$_,min:H_,max:K_}=Math;function q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0;for(let i=e,a=t.length;i<a;i+=n)t[i]<r&&(r=t[i]);return r}function X_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=-1/0;for(let i=e,a=t.length;i<a;i+=n)r<t[i]&&(r=t[i]);return r}function Y_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0,i=-1/0;for(let a=e,o=t.length;a<o;a+=n)t[a]<r&&(r=t[a]),i<t[a]&&(i=t[a]);return[r,i]}const J_=Al("ceilLog2"),Z_=Al("factorial");function gi(t){let e=1;for(;e<t;)e*=2;return e}function Eu(t){return t===gi(t)}function Q_(t,e){let n=1;for(let r=1;r<=e;++r)n*=(t-r+1)/r;return Math.floor(n)}function eS(t,e){if(t<e)return 0;const n=ln(e);for(let r=0;r<e;++r)n[r]=r;return n}function tS(t,e,n){let r=0;for(let i=e-1;i>=0;--i)if(n[i]<t-e+i){let a=n[i]+1;for(;i<e;)n[i++]=a++;r=1;break}return r}function nS(t){G_(`${t}`,{global:!0}),G3=t}function rS(){return G3}function iS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)-t;return t+n*Math.random()}const aS=Al("gaussian");function _f(t,e,n){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function Ja(t,e,n){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function W3(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function z3(t,e){return t[0]*=e,t[1]*=e,t}function Dd(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function oS(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function Et(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function sS(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[0]*e[2],n[3]=t[1]*e[0],n[4]=t[1]*e[1],n[5]=t[1]*e[2],n[6]=t[2]*e[0],n[7]=t[2]*e[1],n[8]=t[2]*e[2]}function ga(t,e,n){const r=t[1]*e[2]-t[2]*e[1],i=t[2]*e[0]-t[0]*e[2],a=t[0]*e[1]-t[1]*e[0];return n[0]=r,n[1]=i,n[2]=a,n}function Ho(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{let n=0;for(let r=0;r<e;r++)n+=t[r]*t[r];return Math.sqrt(n)}}}function oc(t){const e=Ho(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function cS(t,e,n,r){const i=t[0]*t[0],a=t[1]*t[1],o=t[2]*t[2],s=Math.sqrt(i+a+o);let c,l,f;i>a&&i>o?(c=0,l=1,f=2):a>o?(c=1,l=2,f=0):(c=2,l=0,f=1);const u=t[c]/s,h=t[l]/s,p=t[f]/s,d=Math.sqrt(u*u+p*p);if(r!==0){const g=Math.sin(r),y=Math.cos(r);e&&(e[c]=(p*y-u*h*g)/d,e[l]=g*d,e[f]=(-(u*y)-h*p*g)/d),n&&(n[c]=(-(p*g)-u*h*y)/d,n[l]=y*d,n[f]=(u*g-h*p*y)/d)}else e&&(e[c]=p/d,e[l]=0,e[f]=-u/d),n&&(n[c]=-u*h/d,n[l]=d,n[f]=-h*p/d)}function uS(t,e,n){const r=Et(e,e);if(r===0)return n[0]=0,n[1]=0,n[2]=0,!1;const i=Et(t,e)/r;for(let a=0;a<3;a++)n[a]=e[a];return W3(n,i),!0}function Od(t,e){return t[0]*e[0]+t[1]*e[1]}function lS(t,e,n){const r=Od(e,e);if(r===0)return n[0]=0,n[1]=0,!1;const i=Od(t,e)/r;for(let a=0;a<2;a++)n[a]=e[a];return z3(n,i),!0}function ia(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function fS(t,e){const n=[0,0,0];return ga(t,e,n),Math.atan2(Ho(n),Et(t,e))}function hS(t,e,n){const r=Math.abs(t-n);return 1/Math.sqrt(2*Math.PI*e)*Math.exp(-(r**2)/(2*e))}function pS(t,e,n){const r=Math.abs(t-n);return Math.exp(-(r**2)/(2*e))}function dS(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[1]*e[0],n[3]=t[1]*e[1]}function j3(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function $3(t){const e=j3(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function _n(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function gS(t,e){let n,r,i;const a=[0,0,0];for(let o=0;o<3;o++)i=Math.abs(t[o*3]),(r=Math.abs(t[o*3+1]))>i&&(i=r),(r=Math.abs(t[o*3+2]))>i&&(i=r),a[o]=1/i;i=a[0]*Math.abs(t[0]),n=0,(r=a[1]*Math.abs(t[3]))>=i&&(i=r,n=1),(r=a[2]*Math.abs(t[6]))>=i&&(n=2),n!==0&&($u(t,3,n,0),a[n]=a[0]),e[0]=n,t[3]/=t[0],t[6]/=t[0],t[4]-=t[3]*t[1],t[7]-=t[6]*t[1],i=a[1]*Math.abs(t[4]),n=1,(r=a[2]*Math.abs(t[7]))>=i&&(n=2,$u(t,3,1,2),a[2]=a[1]),e[1]=n,t[7]/=t[4],t[5]-=t[3]*t[2],t[8]-=t[6]*t[2]+t[7]*t[5],e[2]=2}function mS(t,e,n){let r=n[e[0]];n[e[0]]=n[0],n[0]=r,r=n[e[1]],n[e[1]]=n[1],n[1]=r-t[3]*n[0],r=n[e[2]],n[e[2]]=n[2],n[2]=r-t[6]*n[0]-t[7]*n[1],n[2]/=t[8],n[1]=(n[1]-t[5]*n[2])/t[4],n[0]=(n[0]-t[1]*n[1]-t[2]*n[2])/t[0]}function vS(t,e,n){const r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],f=t[7],u=t[8],h=+_n(s,f,c,u),p=-_n(o,l,c,u),d=+_n(o,l,s,f),g=-_n(i,f,a,u),y=+_n(r,l,a,u),x=-_n(r,l,i,f),m=+_n(i,s,a,c),v=-_n(r,o,a,c),w=+_n(r,o,i,s),C=r*h+i*p+a*d,T=h*e[0]+g*e[1]+m*e[2],_=p*e[0]+y*e[1]+v*e[2],S=d*e[0]+x*e[1]+w*e[2];n[0]=T/C,n[1]=_/C,n[2]=S/C}function j0(t,e,n){const r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],i=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],a=t[6]*e[0]+t[7]*e[1]+t[8]*e[2];n[0]=r,n[1]=i,n[2]=a}function Rd(t,e,n){const r=[...t],i=[...e];for(let a=0;a<3;a++)n[a]=r[0]*i[a]+r[1]*i[a+3]+r[2]*i[a+6],n[a+3]=r[3]*i[a]+r[4]*i[a+3]+r[5]*i[a+6],n[a+6]=r[6]*i[a]+r[7]*i[a+3]+r[8]*i[a+6]}function yS(t,e,n,r,i,a,o){r!==i&&B3("Number of columns of A must match number of rows of B.");const s=[...t],c=[...e];for(let l=0;l<n;l++)for(let f=0;f<a;f++){o[l*a+f]=0;for(let u=0;u<r;u++)o[l*a+f]+=s[l*r+u]*c[f+a*u]}}function Fc(t,e){let n;n=t[3],e[3]=t[1],e[1]=n,n=t[6],e[6]=t[2],e[2]=n,n=t[7],e[7]=t[5],e[5]=n,e[0]=t[0],e[4]=t[4],e[8]=t[8]}function xS(t,e){const n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],f=t[8],u=+_n(o,l,s,f),h=-_n(a,c,s,f),p=+_n(a,c,o,l),d=-_n(r,l,i,f),g=+_n(n,c,i,f),y=-_n(n,c,r,l),x=+_n(r,o,i,s),m=-_n(n,a,i,s),v=+_n(n,a,r,o),w=n*u+r*h+i*p;w===0&&ac("Matrix has 0 determinant"),e[0]=u/w,e[3]=h/w,e[6]=p/w,e[1]=d/w,e[4]=g/w,e[7]=y/w,e[2]=x/w,e[5]=m/w,e[8]=v/w}function xh(t){return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}function H3(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Hg;if(t.length!==e.length)return!1;function r(i,a){return Math.abs(i-e[a])<=n}return t.every(r)}const Fl=H3;function K3(t){for(let e=0;e<3;e++)t[e*3]=t[e*3+1]=t[e*3+2]=0,t[e*3+e]=1}function q3(t,e){for(let n=0;n<t;n++){for(let r=0;r<t;r++)e[n*t+r]=0;e[n*t+n]=1}return e}function wS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hg;return Fl(t,$g,e)}function CS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hg;return Fl(t,W_,e)}function X3(t,e){const n=t[0]*t[0],r=t[0]*t[1],i=t[0]*t[2],a=t[0]*t[3],o=t[1]*t[1],s=t[2]*t[2],c=t[3]*t[3],l=t[1]*t[2],f=t[1]*t[3],u=t[2]*t[3],h=o+s+c;let p=1/(n+h);const d=(n-h)*p;p*=2,e[0]=o*p+d,e[3]=(l+a)*p,e[6]=(f-i)*p,e[1]=(l-a)*p,e[4]=s*p+d,e[7]=(u+r)*p,e[2]=(f+i)*p,e[5]=(u-r)*p,e[8]=c*p+d}function $0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${t}`.includes("e"))return+`${Math.round(`${t}e+${e}`)}e-${e}`;const n=`${t}`.split("e");let r="";return+n[1]+e>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+e}`)}e-${e}`}function Md(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=$0(t[0],n),e[1]=$0(t[1],n),e[2]=$0(t[2],n),e}function Il(t,e,n,r){let i,a,o,s,c,l,f,u,h,p,d,g,y,x,m,v;const w=ln(e),C=ln(e),T=(S,b,D)=>{x=S[b],y=S[D],S[b]=x-g*(y+x*p),S[D]=y+g*(x-y*p)};for(q3(e,r),c=0;c<e;c++)w[c]=n[c]=t[c+c*e],C[c]=0;for(i=0;i<Fm;i++){for(d=0,c=0;c<e-1;c++)for(s=c+1;s<e;s++)d+=Math.abs(t[c*e+s]);if(d===0)break;for(i<3?f=.2*d/(e*e):f=0,c=0;c<e-1;c++)for(s=c+1;s<e;s++)if(x=100*Math.abs(t[c*e+s]),i>3&&Math.abs(n[c])+x===Math.abs(n[c])&&Math.abs(n[s])+x===Math.abs(n[s]))t[c*e+s]=0;else if(Math.abs(t[c*e+s])>f){for(y=n[s]-n[c],Math.abs(y)+x===Math.abs(y)?h=t[c*e+s]/y:(u=.5*y/t[c*e+s],h=1/(Math.abs(u)+Math.sqrt(1+u*u)),u<0&&(h=-h)),m=1/Math.sqrt(1+h*h),g=h*m,p=g/(1+m),y=h*t[c*e+s],C[c]-=y,C[s]+=y,n[c]-=y,n[s]+=y,t[c*e+s]=0,a=0;a<=c-1;a++)T(t,a*e+c,a*e+s);for(a=c+1;a<=s-1;a++)T(t,c*e+a,a*e+s);for(a=s+1;a<e;a++)T(t,c*e+a,s*e+a);for(a=0;a<e;a++)T(r,a*e+c,a*e+s)}for(c=0;c<e;c++)w[c]+=C[c],n[c]=w[c],C[c]=0}if(i>=Fm)return ac("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(a=0;a<e-1;a++){for(o=a,v=n[o],i=a+1;i<e;i++)(n[i]>=v||Math.abs(n[i]-v)<Kg)&&(o=i,v=n[o]);o!==a&&(n[o]=n[a],n[a]=v,Su(r,e,a,o))}const _=(e>>1)+(e&1);for(l=0,i=0;i<e*e;i++)r[i]>=0&&l++;if(l<_)for(i=0;i<e;i++)r[i*e+a]*=-1;return 1}function Y3(t,e){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=t[0]+t[4]+t[8],n[5]=t[0]-t[4]-t[8],n[10]=-t[0]+t[4]-t[8],n[15]=-t[0]-t[4]+t[8],n[1]=n[4]=t[7]-t[5],n[2]=n[8]=t[2]-t[6],n[3]=n[12]=t[3]-t[1],n[6]=n[9]=t[3]+t[1],n[7]=n[13]=t[2]+t[6],n[11]=n[14]=t[7]+t[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],a=[...n];Il(a,4,i,r),e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12]}function TS(t,e,n){const r=t[0]*e[0],i=t[0]*e[1],a=t[0]*e[2],o=t[0]*e[3],s=t[1]*e[0],c=t[1]*e[1],l=t[1]*e[2],f=t[1]*e[3],u=t[2]*e[0],h=t[2]*e[1],p=t[2]*e[2],d=t[2]*e[3],g=t[3]*e[0],y=t[3]*e[1],x=t[3]*e[2],m=t[3]*e[3];n[0]=r-c-p-m,n[1]=i+s+d-x,n[2]=a-f+u+y,n[3]=o+l-h+g}function J3(t,e){for(let h=0;h<9;h++)e[h]=t[h];const n=ln(3),r=ln(3);let i;for(let h=0;h<3;h++){const p=Math.abs(e[h*3]),d=Math.abs(e[h*3+1]),g=Math.abs(e[h*3+2]);i=d>p?d:p,i=g>i?g:i,n[h]=1,i!==0&&(n[h]/=i)}const a=Math.abs(e[0])*n[0],o=Math.abs(e[3])*n[1],s=Math.abs(e[6])*n[2];r[0]=0,i=a,o>=i&&(i=o,r[0]=1),s>=i&&(r[0]=2),r[0]!==0&&(Su(e,3,r[0],0),n[r[0]]=n[0]);const c=Math.abs(e[4])*n[1],l=Math.abs(e[7])*n[2];r[1]=1,i=c,l>=i&&(r[1]=2,Su(e,3,1,2)),r[2]=2;let f=0;if(xh(e)<0){f=1;for(let h=0;h<9;h++)e[h]=-e[h]}const u=ln(4);if(Y3(e,u),X3(u,e),f)for(let h=0;h<9;h++)e[h]=-e[h];r[1]!==1&&Su(e,3,r[1],1),r[0]!==0&&Su(e,3,r[0],0)}function Z3(t,e,n){let r,i,a,o,s,c;const l=[...t];if(Il(l,3,e,n),e[0]===e[1]&&e[0]===e[2]){K3(n);return}for(Fc(n,n),r=0;r<3;r++)if(e[(r+1)%3]===e[(r+2)%3]){for(c=Math.abs(n[r*3]),o=0,i=1;i<3;i++)c<(s=Math.abs(n[r*3+i]))&&(c=s,o=i);o!==r&&(s=e[o],e[o]=e[r],e[r]=s,$u(n,3,r,o)),n[o*3+o]<0&&(n[o*3]=-n[o*3],n[o*3+1]=-n[o*3+1],n[o*3+2]=-n[o*3+2]),i=(o+1)%3,a=(o+2)%3,n[i*3]=0,n[i*3+1]=0,n[i*3+2]=0,n[i*3+i]=1;const f=ga([n[o*3],n[o*3+1],n[o*3+2]],[n[i*3],n[i*3+1],n[i*3+2]],[]);oc(f);const u=ga(f,[n[o*3],n[o*3+1],n[o*3+2]],[]);for(let h=0;h<3;h++)n[a*3+h]=f[h],n[i*3+h]=u[h];Fc(n,n);return}for(c=Math.abs(n[0]),o=0,r=1;r<3;r++)c<(s=Math.abs(n[r*3]))&&(c=s,o=r);if(o!==0){const f=e[o];e[o]=e[0],e[0]=f,$u(n,3,o,0)}if(Math.abs(n[4])<Math.abs(n[7])){const f=e[2];e[2]=e[1],e[1]=f,$u(n,3,1,2)}for(r=0;r<2;r++)n[r*3+r]<0&&(n[r*3]=-n[r*3],n[r*3+1]=-n[r*3+1],n[r*3+2]=-n[r*3+2]);xh(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),Fc(n,n)}function _S(t,e,n,r){let i;const a=[...t],o=xh(a);if(o<0)for(i=0;i<9;i++)a[i]=-a[i];J3(a,e),Fc(a,a),Rd(a,e,r),Z3(r,n,r),Rd(e,r,e),Fc(r,r),o<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function Xg(t,e,n){let r,i,a,o,s=0,c,l,f;const u=ln(n);for(r=0;r<n;r++){for(o=0,i=0;i<n;i++)(f=Math.abs(t[r*n+i]))>o&&(o=f);if(o===0)return ac("Unable to factor linear system"),0;u[r]=1/o}for(i=0;i<n;i++){for(r=0;r<i;r++){for(c=t[r*n+i],a=0;a<r;a++)c-=t[r*n+a]*t[a*n+i];t[r*n+i]=c}for(o=0,r=i;r<n;r++){for(c=t[r*n+i],a=0;a<i;a++)c-=t[r*n+a]*t[a*n+i];t[r*n+i]=c,(l=u[r]*Math.abs(c))>=o&&(o=l,s=r)}if(i!==s){for(a=0;a<n;a++)l=t[s*n+a],t[s*n+a]=t[i*n+a],t[i*n+a]=l;u[s]=u[i]}if(e[i]=s,Math.abs(t[i*n+i])<=Kg)return ac("Unable to factor linear system"),0;if(i!==n-1)for(l=1/t[i*n+i],r=i+1;r<n;r++)t[r*n+i]*=l}return 1}function Yg(t,e,n,r){let i,a,o,s,c;for(o=-1,i=0;i<r;i++){if(s=e[i],c=n[s],n[s]=n[i],o>=0)for(a=o;a<=i-1;a++)c-=t[i*r+a]*n[a];else c!==0&&(o=i);n[i]=c}for(i=r-1;i>=0;i--){for(c=n[i],a=i+1;a<r;a++)c-=t[i*r+a]*n[a];n[i]=c/t[i*r+i]}}function Q3(t,e,n){if(n===2){const i=ln(2),a=_n(t[0],t[1],t[2],t[3]);return a===0?0:(i[0]=(t[3]*e[0]-t[1]*e[1])/a,i[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=i[0],e[1]=i[1],1)}if(n===1)return t[0]===0?0:(e[0]/=t[0],1);const r=ln(n);return Xg(t,r,n)===0?0:(Yg(t,r,e,n),1)}function e4(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;const a=r||ln(n),o=i||ln(n);if(Xg(t,a,n)===0)return null;for(let s=0;s<n;s++){for(let c=0;c<n;c++)o[c]=0;o[s]=1,Yg(t,a,o,n);for(let c=0;c<n;c++)e[c*n+s]=o[c]}return e}function SS(t,e){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e;i++)for(let a=i;a<e;a++)Math.abs(t[i*e+a])>r&&(r=Math.abs(t[i*e+a]));for(let i=0;i<e;i++)Math.abs(t[i*e+i])<n&&(n=Math.abs(t[i*e+i]));return n===0?Number.MAX_VALUE:r/n}function bS(t,e,n){return Il(t,3,e,n)}function Nd(t,e,n,r){if(t<n)return ac("Insufficient number of samples. Underdetermined."),0;let i,a,o;const s=ln(n*n),c=ln(n),l=ln(n*n);for(o=0;o<t;o++)for(i=0;i<n;i++)for(a=i;a<n;a++)s[i*n+a]+=e[o*n+i]*e[o*n+a];for(i=0;i<n;i++)for(a=0;a<i;a++)s[i*n+a]=s[a*n+i];for(Il(s,n,c,l),i=0;i<n;i++)r[i]=l[i*n+n-1];return 1}function ES(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;if(t<n||t<i)return ac("Insufficient number of samples. Underdetermined."),0;const s=ln(i);let c=1,l,f=0,u,h,p,d=0;if(o){for(h=0;h<i;h++)s[h]=1;for(u=0;u<t;u++)for(h=0;h<i;h++)Math.abs(r[u*i+h])>Kg&&(c=0,s[h]=0);if(c&&i===1)return ac("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),Nd(t,e,n,a);if(c)d=1;else for(h=0;h<i;h++)s[h]&&(d=1)}d&&(l=ln(n),f=Nd(t,e,n,l));const g=ln(n*n),y=ln(n*n),x=ln(n*i);for(p=0;p<t;p++)for(u=0;u<n;u++){for(h=u;h<n;h++)g[u*n+h]+=e[p*n+u]*e[p*n+h];for(h=0;h<i;h++)x[u*i+h]+=e[p*n+u]*r[p*i+h]}for(u=0;u<n;u++)for(h=0;h<u;h++)g[u*n+h]=g[h*n+u];const m=e4(g,y,n);if(m)for(u=0;u<n;u++)for(h=0;h<i;h++)for(a[u*i+h]=0,p=0;p<n;p++)a[u*i+h]+=y[u*n+p]*x[p*i+h];if(d){for(h=0;h<i;h++)if(s[h])for(u=0;u<n;u++)a[u*i+h]=l[u*i]}return d?f&&m:m}function DS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,.5,1];switch(t.length){case 3:return e[0]=parseInt(t[0],16)*17/255,e[1]=parseInt(t[1],16)*17/255,e[2]=parseInt(t[2],16)*17/255,e;case 4:return e[0]=parseInt(t[1],16)*17/255,e[1]=parseInt(t[2],16)*17/255,e[2]=parseInt(t[3],16)*17/255,e;case 6:return e[0]=parseInt(t.substr(0,2),16)/255,e[1]=parseInt(t.substr(2,2),16)/255,e[2]=parseInt(t.substr(4,2),16)/255,e;case 7:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e;case 9:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e[3]=parseInt(t.substr(7,2),16)/255,e;default:return e}}function Du(t,e){let n,r;const[i,a,o]=t,s=1/3,c=1/6,l=2/3;let f=i,u=i;a>f?f=a:a<u&&(u=a),o>f?f=o:o<u&&(u=o);const h=f;h>0?r=(f-u)/f:r=0,r>0?(i===f?n=c*(a-o)/(f-u):a===f?n=s+c*(o-i)/(f-u):n=l+c*(i-a)/(f-u),n<0&&(n+=1)):n=0,e[0]=n,e[1]=r,e[2]=h}function Hs(t,e){const[n,r,i]=t,a=1/3,o=1/6,s=2/3,c=5/6;let l,f,u;n>o&&n<=a?(f=1,l=(a-n)/o,u=0):n>a&&n<=.5?(f=1,u=(n-a)/o,l=0):n>.5&&n<=s?(u=1,f=(s-n)/o,l=0):n>s&&n<=c?(u=1,l=(n-s)/o,f=0):n>c&&n<=1?(l=1,u=(1-n)/o,f=0):(l=1,f=n/o,u=0),l=r*l+(1-r),f=r*f+(1-r),u=r*u+(1-r),l*=i,f*=i,u*=i,e[0]=l,e[1]=f,e[2]=u}function t4(t,e){const[n,r,i]=t;let a=(n+16)/116,o=r/500+a,s=a-i/200;a**3>.008856?a**=3:a=(a-16/116)/7.787,o**3>.008856?o**=3:o=(o-16/116)/7.787,s**3>.008856?s**=3:s=(s-16/116)/7.787;const c=.9505,l=1,f=1.089;e[0]=c*o,e[1]=l*a,e[2]=f*s}function n4(t,e){const[n,r,i]=t,a=.9505,o=1,s=1.089;let c=n/a,l=r/o,f=i/s;c>.008856?c**=1/3:c=7.787*c+16/116,l>.008856?l**=1/3:l=7.787*l+16/116,f>.008856?f**=1/3:f=7.787*f+16/116,e[0]=116*l-16,e[1]=500*(c-l),e[2]=200*(l-f)}function r4(t,e){const[n,r,i]=t;let a=n*3.2406+r*-1.5372+i*-.4986,o=n*-.9689+r*1.8758+i*.0415,s=n*.0557+r*-.204+i*1.057;a>.0031308?a=1.055*a**(1/2.4)-.055:a*=12.92,o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92,s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92;let c=a;c<o&&(c=o),c<s&&(c=s),c>1&&(a/=c,o/=c,s/=c),a<0&&(a=0),o<0&&(o=0),s<0&&(s=0),e[0]=a,e[1]=o,e[2]=s}function i4(t,e){let[n,r,i]=t;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,i>.04045?i=((i+.055)/1.055)**2.4:i/=12.92,e[0]=n*.4124+r*.3576+i*.1805,e[1]=n*.2126+r*.7152+i*.0722,e[2]=n*.0193+r*.1192+i*.9505}function Ys(t,e){const n=[0,0,0];i4(t,n),n4(n,e)}function Sf(t,e){const n=[0,0,0];t4(t,n),r4(n,e)}function tu(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function H0(t){return!(t[1]-t[0]<0)}function OS(t,e,n){return n[0]=Math.min(t[0],e[0]),n[1]=Math.max(t[0],e[0]),n[2]=Math.min(t[1],e[1]),n[3]=Math.max(t[1],e[1]),n[4]=Math.min(t[2],e[2]),n[5]=Math.max(t[2],e[2]),n}function Gi(t,e,n){return t<e?e:t>n?n:t}function Ld(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=Gi(t[0],e[0],n[0]),r[1]=Gi(t[1],e[1],n[1]),r[2]=Gi(t[2],e[2],n[2]),r}function RS(t,e){let n=0;return e[0]!==e[1]&&(t<e[0]?n=e[0]:t>e[1]?n=e[1]:n=t,n=(n-e[0])/(e[1]-e[0])),n}const MS=Al("GetScalarTypeFittingRange"),NS=Al("GetAdjustedScalarRange");function LS(t,e){if(!t||!e)return 0;for(let n=0;n<6;n+=2)if(t[n]<e[n]||t[n]>e[n+1]||t[n+1]<e[n]||t[n+1]>e[n+1])return 0;return 1}function AS(t,e,n){if(!t||!e)return 0;for(let r=0;r<6;r+=2)if(t[r]+n[r/2]<e[r]||t[r]-n[r/2]>e[r+1]||t[r+1]+n[r/2]<e[r]||t[r+1]-n[r/2]>e[r+1])return 0;return 1}function FS(t,e,n){if(!t||!e||!n)return 0;for(let r=0;r<3;r++)if(t[r]+n[r]<e[2*r]||t[r]-n[r]>e[2*r+1])return 0;return 1}function IS(t,e,n,r){const i=ln(3),a=ln(3),o=ln(3),s=ln(3),c=ln(3),l=ln(3);for(let w=0;w<3;++w)i[w]=t[w]-e[w],a[w]=e[w]-n[w],o[w]=n[w]-t[w],s[w]=-i[w],c[w]=-a[w],l[w]=-o[w];const f=Ho(s),u=Ho(c),h=Ho(o),p=ln(3);ga(i,a,p);const d=Ho(p),g=f*u*h/(2*d),y=2*d*d,x=u*u*Et(i,l)/y,m=h*h*Et(s,a)/y,v=f*f*Et(o,c)/y;for(let w=0;w<3;++w)r[w]=x*t[w]+m*e[w]+v*n[w];return g}const PS=1/0,VS=-1/0,a4=t=>!Number.isFinite(t),{isFinite:kS,isNaN:Ad}=Number,bf=Ad;function ns(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function US(t){let e=-1,n=-1;for(let r=0;r<t.length;r++){const i=Math.abs(t[r]);i>e&&(n=r,e=i)}return n}function o4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;const n=new Array(e),r=new Array(e);for(let a=0;a<e;++a)n[a]=a,r[a]=a;for(let a=e-1;a>0;a--){let o=-1/0,s=0,c=0;for(let l=0;l<=a;++l){const f=n[l];for(let u=0;u<=a;++u){const h=r[u],p=Math.abs(t[f+e*h]);p>o&&(o=p,s=l,c=u)}}[n[a],n[s]]=[n[s],n[a]],[r[a],r[c]]=[r[c],r[a]]}const i=new Array(e*e).fill(0);for(let a=0;a<e;++a){const o=n[a]+e*r[a];i[o]=t[o]<0?-1:1}return i}function s4(t){const e=Math.floor(t*255);return e>15?e.toString(16):`0${e.toString(16)}`}function BS(t){return`${arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#"}${t.map(s4).join("")}`}function e0(t){return Math.round(t*255)}function GS(t){return t.length===3?`rgb(${t.map(e0).join(", ")})`:`rgba(${e0(t[0]||0)}, ${e0(t[1]||0)}, ${e0(t[2]||0)}, ${t[3]||0})`}var mi={Pi:z_,ldexp:j_,radiansFromDegrees:Cn,degreesFromRadians:Tf,round:bu,floor:qg,ceil:$_,ceilLog2:J_,min:H_,max:K_,arrayMin:q_,arrayMax:X_,arrayRange:Y_,isPowerOfTwo:Eu,nearestPowerOfTwo:gi,factorial:Z_,binomial:Q_,beginCombination:eS,nextCombination:tS,randomSeed:nS,getSeed:rS,random:iS,gaussian:aS,add:_f,subtract:Ja,multiplyScalar:W3,multiplyScalar2D:z3,multiplyAccumulate:Dd,multiplyAccumulate2D:oS,dot:Et,outer:sS,cross:ga,norm:Ho,normalize:oc,perpendiculars:cS,projectVector:uS,projectVector2D:lS,distance2BetweenPoints:ia,angleBetweenVectors:fS,gaussianAmplitude:hS,gaussianWeight:pS,dot2D:Od,outer2D:dS,norm2D:j3,normalize2D:$3,determinant2x2:_n,LUFactor3x3:gS,LUSolve3x3:mS,linearSolve3x3:vS,multiply3x3_vect3:j0,multiply3x3_mat3:Rd,multiplyMatrix:yS,transpose3x3:Fc,invert3x3:xS,identity3x3:K3,identity:q3,isIdentity:wS,isIdentity3x3:CS,determinant3x3:xh,quaternionToMatrix3x3:X3,areEquals:H3,areMatricesEqual:Fl,roundNumber:$0,roundVector:Md,matrix3x3ToQuaternion:Y3,multiplyQuaternion:TS,orthogonalize3x3:J3,diagonalize3x3:Z3,singularValueDecomposition3x3:_S,solveLinearSystem:Q3,invertMatrix:e4,luFactorLinearSystem:Xg,luSolveLinearSystem:Yg,estimateMatrixCondition:SS,jacobi:bS,jacobiN:Il,solveHomogeneousLeastSquares:Nd,solveLeastSquares:ES,hex2float:DS,rgb2hsv:Du,hsv2rgb:Hs,lab2xyz:t4,xyz2lab:n4,xyz2rgb:r4,rgb2xyz:i4,rgb2lab:Ys,lab2rgb:Sf,uninitializeBounds:tu,areBoundsInitialized:H0,computeBoundsFromPoints:OS,clampValue:Gi,clampVector:Ld,clampAndNormalizeValue:RS,getScalarTypeFittingRange:MS,getAdjustedScalarRange:NS,extentIsWithinOtherExtent:LS,boundsIsWithinOtherBounds:AS,pointIsWithinBounds:FS,solve3PointCircle:IS,inf:PS,negInf:VS,isInf:a4,isNan:Ad,isNaN:Ad,isFinite:kS,createUninitializedBounds:ns,getMajorAxisIndex:US,getSparseOrthogonalMatrix:o4,floatToHex2:s4,floatRGB2HexCode:BS,float2CssRGBA:GS};const c4={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ot={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},WS=Ot.FLOAT;var u4={DefaultDataType:WS,DataTypeByteSize:c4,VtkDataTypes:Ot};const{vtkErrorMacro:zS}=sr,{DefaultDataType:jS}=u4,$S=1e-6;function Fd(t,e,n){const r=t.length;let i=Number.MAX_VALUE,a=-Number.MAX_VALUE,o,s;for(s=e;s<r;s+=n)if(!Number.isNaN(t[s])){i=t[s],a=i;break}for(;s<r;s+=n)o=t[s],o<i?i=o:o>a&&(a=o);return{min:i,max:a}}function HS(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE,n=0,r=0;return{add(i){t>i&&(t=i),e<i&&(e=i),n++,r+=i},get(){return{min:t,max:e,count:n,sum:r,mean:r/n}},getRange(){return{min:t,max:e}}}}function l4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&n>1){const i=t.length/n,a=new Float64Array(i);for(let o=0,s=0;o<i;++o){for(let c=s+n;s<c;++s)a[o]+=t[s]*t[s];a[o]**=.5}return Fd(a,0,1)}return Fd(t,e<0?0:e,n)}function Im(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=t||[];for(;n.length<=e;)n.push(null);return n}function Jg(t){return Object.prototype.toString.call(t).slice(8,-1)}function KS(t){const e=t.getNumberOfComponents();let n=0;const r=new Array(e);for(let i=0;i<t.getNumberOfTuples();++i){t.getTuple(i,r);const a=Ho(r,e);a>n&&(n=a)}return n}const qS={computeRange:l4,createRangeHelper:HS,fastComputeRange:Fd,getDataType:Jg,getMaxNorm:KS};function XS(t,e){e.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const i=t.getNumberOfComponents(),a=e.values.length/(i>0?i:1);if(r===a)return!0;if(r>a){const o=e.values;return e.values=Qc(e.dataType,(r+a)*i),e.values.set(o),!0}return e.size>r*i&&(e.size=r*i,t.dataChange()),!0}t.dataChange=()=>{e.ranges=null,t.modified()},t.resize=r=>{n(r);const i=r*t.getNumberOfComponents();return e.size!==i?(e.size=i,t.dataChange(),!0):!1},t.initialize=()=>{t.resize(0)},t.getElementComponentSize=()=>e.values.BYTES_PER_ELEMENT,t.getComponent=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[r*e.numberOfComponents+i]},t.setComponent=(r,i,a)=>{a!==e.values[r*e.numberOfComponents+i]&&(e.values[r*e.numberOfComponents+i]=a,t.dataChange())},t.getValue=r=>{const i=r/e.numberOfComponents,a=r%e.numberOfComponents;return t.getComponent(i,a)},t.setValue=(r,i)=>{const a=r/e.numberOfComponents,o=r%e.numberOfComponents;t.setComponent(a,o,i)},t.getData=()=>e.size===e.values.length?e.values:e.values.subarray(0,e.size),t.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=r;i<0&&(i=e.numberOfComponents===1?0:e.numberOfComponents);let a=null;return e.ranges||(e.ranges=Im(e.ranges,e.numberOfComponents)),a=e.ranges[i],a?(e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple):(a=l4(t.getData(),r,e.numberOfComponents),e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple)},t.setRange=(r,i)=>{e.ranges||(e.ranges=Im(e.ranges,e.numberOfComponents));const a={min:r.min,max:r.max};return e.ranges[i]=a,e.rangeTuple[0]=a.min,e.rangeTuple[1]=a.max,e.rangeTuple},t.getRanges=function(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0))return structuredClone(e.ranges);const i=[];for(let a=0;a<e.numberOfComponents;a++){const[o,s]=t.getRange(a),c={min:o,max:s};i.push(c)}if(e.numberOfComponents>1){const[a,o]=t.getRange(-1),s={min:a,max:o};i.push(s)}return i},t.setTuple=(r,i)=>{const a=r*e.numberOfComponents;for(let o=0;o<e.numberOfComponents;o++)e.values[a+o]=i[o]},t.setTuples=(r,i)=>{let a=r*e.numberOfComponents;const o=Math.min(i.length,e.size-a);for(let s=0;s<o;)e.values[a++]=i[s++]},t.insertTuple=(r,i)=>(e.size<=r*e.numberOfComponents&&(e.size=(r+1)*e.numberOfComponents,n(r+1)),t.setTuple(r,i),r),t.insertTuples=(r,i)=>{const a=r+i.length/e.numberOfComponents;return e.size<a*e.numberOfComponents&&(e.size=a*e.numberOfComponents,n(a)),t.setTuples(r,i),a},t.insertNextTuple=r=>{const i=e.size/e.numberOfComponents;return t.insertTuple(i,r)},t.insertNextTuples=r=>{const i=e.size/e.numberOfComponents;return t.insertTuples(i,r)},t.findTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$S;for(let a=0;a<e.size;a+=e.numberOfComponents)if(Math.abs(r[0]-e.values[a])<=i){let o=!0;for(let s=1;s<e.numberOfComponents;++s)if(Math.abs(r[s]-e.values[a+s])>i){o=!1;break}if(o)return a/e.numberOfComponents}return-1},t.getTuple=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const a=e.numberOfComponents||1,o=r*a;switch(a){case 4:i[3]=e.values[o+3];case 3:i[2]=e.values[o+2];case 2:i[1]=e.values[o+1];case 1:i[0]=e.values[o];break;default:for(let s=a-1;s>=0;--s)i[s]=e.values[o+s]}return i},t.getTuples=(r,i)=>{const a=(r??0)*e.numberOfComponents,o=(i??t.getNumberOfTuples())*e.numberOfComponents,s=t.getData().subarray(a,o);return s.length>0?s:null},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.size,t.getNumberOfTuples=()=>e.size/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>h4({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents}),t.getName=()=>(e.name||(t.modified(),e.name=`vtkDataArray${t.getMTime()}`),e.name),t.setData=(r,i)=>{e.values=r,e.size=r.length,e.dataType=Jg(r),i&&(e.numberOfComponents=i),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=()=>{if(e.deleted)return null;const r={...e,vtkClass:t.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(a=>{r[a]||delete r[a]});const i={};return Object.keys(r).sort().forEach(a=>{i[a]=r[a]}),i.mtime&&delete i.mtime,i},t.deepCopy=r=>{const i=t.getDataType(),a=e.values;t.shallowCopy(r),e.ranges=structuredClone(r.getRanges()),a?.length>=r.getNumberOfValues()&&i===r.getDataType()?(a.set(r.getData()),e.values=a,t.dataChange()):t.setData(r.getData().slice())},t.interpolateTuple=(r,i,a,o,s,c)=>{const l=e.numberOfComponents||1;(l!==i.getNumberOfComponents()||l!==o.getNumberOfComponents())&&zS("numberOfComponents must match");const f=i.getTuple(a),u=o.getTuple(s),h=[];switch(h.length=l,l){case 4:h[3]=f[3]+(u[3]-f[3])*c;case 3:h[2]=f[2]+(u[2]-f[2])*c;case 2:h[1]=f[1]+(u[1]-f[1])*c;case 1:h[0]=f[0]+(u[0]-f[0])*c;break;default:for(let p=0;p<l;p++)h[p]=f[p]+(u[p]-f[p])*c}return t.insertTuple(r,h)}}const YS={name:"",numberOfComponents:1,dataType:jS,rangeTuple:[0,0]};function f4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,YS,n),Array.isArray(n.values)&&n.dataType===void 0&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=vh(e.dataType,e.values)):e.values=Qc(e.dataType,e.size),e.values&&(e.size=e.size??e.values.length,e.dataType=Jg(e.values)),an(t,e),Ml(t,e,["name","numberOfComponents"]),e.size%e.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");XS(t,e)}const h4=kt(f4,"vtkDataArray");var ft={newInstance:h4,extend:f4,...qS,...u4};const JS={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},Id={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4};var Zg={VectorMode:JS,ScalarMappingTarget:Id};const ZS={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},QS={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},eb={BY_ID:0,BY_NAME:1};var wh={ColorMode:ZS,GetArray:eb,ScalarMode:QS};const{ScalarMappingTarget:Pm,VectorMode:ta}=Zg,{VtkDataTypes:Ro}=ft,{ColorMode:t0}=wh,{vtkErrorMacro:Vm}=J;function tb(t){return t}function km(t){return Math.floor(t*255+.5)}function nb(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=()=>t.setVectorMode(ta.MAGNITUDE),t.setVectorModeToComponent=()=>t.setVectorMode(ta.COMPONENT),t.setVectorModeToRGBColors=()=>t.setVectorMode(ta.RGBCOLORS),t.build=()=>{},t.isOpaque=()=>!0,t.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r)){if(n&&r&&n.length!==r.length){Vm("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],r&&n){const i=r.length;for(let a=0;a<i;a++)e.annotationArray.push({value:n[a],annotation:String(r[a])})}t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=(n,r)=>{let i=t.checkForAnnotatedValue(n),a=!1;return i>=0?e.annotationArray[i].annotation!==r&&(e.annotationArray[i].annotation=r,a=!0):(e.annotationArray.push({value:n,annotation:r}),i=e.annotationArray.length-1,a=!0),a&&(t.updateAnnotatedValueMap(),t.modified()),i},t.getNumberOfAnnotatedValues=()=>e.annotationArray.length,t.getAnnotatedValue=n=>n<0||n>=e.annotationArray.length?null:e.annotationArray[n].value,t.getAnnotation=n=>e.annotationArray[n]===void 0?null:e.annotationArray[n].annotation,t.getAnnotatedValueIndex=n=>e.annotationArray.length?t.checkForAnnotatedValue(n):-1,t.removeAnnotation=n=>{const r=t.checkForAnnotatedValue(n),i=r>=0;return i&&(e.annotationArray.splice(r,1),t.updateAnnotatedValueMap(),t.modified()),i},t.resetAnnotations=()=>{e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=(n,r)=>{if(e.indexedLookup){const i=t.getAnnotatedValueIndex(n);t.getIndexedColor(i,r)}else t.getColor(parseFloat(n),r),r[3]=1},t.checkForAnnotatedValue=n=>t.getAnnotatedValueIndexInternal(n),t.getAnnotatedValueIndexInternal=n=>{if(e.annotatedValueMap[n]!==void 0){const r=e.annotationArray.length;return e.annotatedValueMap[n]%r}return-1},t.getIndexedColor=(n,r)=>{r[0]=0,r[1]=0,r[2]=0,r[3]=0},t.updateAnnotatedValueMap=()=>{e.annotatedValueMap=[];const n=e.annotationArray.length;for(let r=0;r<n;r++)e.annotatedValueMap[e.annotationArray[r].value]=r},t.mapScalars=(n,r,i)=>{const a=n.getNumberOfComponents();let o=null;if(r===t0.DEFAULT&&(n.getDataType()===Ro.UNSIGNED_CHAR||n.getDataType()===Ro.UNSIGNED_CHAR_CLAMPED)||r===t0.DIRECT_SCALARS&&n)o=t.convertToRGBA(n,a,n.getNumberOfTuples());else{const s={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:Ro.UNSIGNED_CHAR},c=J.newTypedArray(s.dataType,4*n.getNumberOfTuples());s.values=c,s.size=c.length,o=ft.newInstance(s);let l=i;l<0&&a>1?t.mapVectorsThroughTable(n,o,Pm.RGBA,-1,-1):(l<0&&(l=0),l>=a&&(l=a-1),t.mapScalarsThroughTable(n,o,Pm.RGBA,l))}return o},t.mapVectorsToMagnitude=(n,r,i)=>{const a=n.getNumberOfTuples(),o=n.getNumberOfComponents(),s=r.getData(),c=n.getData();for(let l=0;l<a;l++){let f=0;for(let u=0;u<i;u++)f+=c[l*o+u]*c[l*o+u];s[l]=Math.sqrt(f)}},t.mapVectorsThroughTable=(n,r,i,a,o)=>{let s=t.getVectorMode(),c=o,l=a;const f=n.getNumberOfComponents();s===ta.COMPONENT?(l===-1&&(l=t.getVectorComponent()),l<0&&(l=0),l>=f&&(l=f-1)):(c===-1&&(c=t.getVectorSize()),c<=0?(l=0,c=f):(l<0&&(l=0),l>=f&&(l=f-1),l+c>f&&(c=f-l)),s===ta.MAGNITUDE&&(f===1||c===1)&&(s=ta.COMPONENT));let u=0;switch(l>0&&(u=l),s){case ta.COMPONENT:{t.mapScalarsThroughTable(n,r,i,u);break}case ta.RGBCOLORS:break;case ta.MAGNITUDE:default:{const h=ft.newInstance({numberOfComponents:1,values:new Float32Array(n.getNumberOfTuples())});t.mapVectorsToMagnitude(n,h,c),t.mapScalarsThroughTable(h,r,i,0);break}}},t.luminanceToRGBA=(n,r,i,a)=>{const o=a(i),s=r.getData(),c=n.getData(),l=s.length,f=0,u=1;let h=0;for(let p=f;p<l;p+=u){const d=a(s[p]);c[h*4]=d,c[h*4+1]=d,c[h*4+2]=d,c[h*4+3]=o,h++}},t.luminanceAlphaToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),c=o.length,l=0,f=2;let u=0;for(let h=l;h<c;h+=f){const p=a(o[h]);s[u]=p,s[u+1]=p,s[u+2]=p,s[u+3]=a(o[h+1])*i,u+=4}},t.rGBToRGBA=(n,r,i,a)=>{const o=km(i),s=r.getData(),c=n.getData(),l=s.length,f=0,u=3;let h=0;for(let p=f;p<l;p+=u)c[h*4]=a(s[p]),c[h*4+1]=a(s[p+1]),c[h*4+2]=a(s[p+2]),c[h*4+3]=o,h++},t.rGBAToRGBA=(n,r,i,a)=>{const o=r.getData(),s=n.getData(),c=o.length,l=0,f=4;let u=0;for(let h=l;h<c;h+=f)s[u*4]=a(o[h]),s[u*4+1]=a(o[h+1]),s[u*4+2]=a(o[h+2]),s[u*4+3]=a(o[h+3])*i,u++},t.convertToRGBA=(n,r,i)=>{let{alpha:a}=e;if(r===4&&a>=1&&n.getDataType()===Ro.UNSIGNED_CHAR)return n;const o=ft.newInstance({numberOfComponents:4,empty:!0,size:4*i,dataType:Ro.UNSIGNED_CHAR});if(i<=0)return o;a=a>0?a:0,a=a<1?a:1;let s=tb;switch((n.getDataType()===Ro.FLOAT||n.getDataType()===Ro.DOUBLE)&&(s=km),r){case 1:t.luminanceToRGBA(o,n,a,s);break;case 2:t.luminanceAlphaToRGBA(o,n,s);break;case 3:t.rGBToRGBA(o,n,a,s);break;case 4:t.rGBAToRGBA(o,n,a,s);break;default:return Vm("Cannot convert colors"),null}return o},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>256*256*256,t.setRange=(n,r)=>t.setMappingRange(n,r),t.getRange=()=>t.getMappingRange(),t.areScalarsOpaque=(n,r,i)=>{if(!n)return t.isOpaque();const a=n.getNumberOfComponents();return r===t0.DEFAULT&&n.getDataType()===Ro.UNSIGNED_CHAR||r===t0.DIRECT_SCALARS?a===3||a===1?e.alpha>=1:n.getRange(a-1)[0]===255:!0}}const rb={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:ta.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function p4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rb,n),J.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],J.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),J.setArray(t,e,["mappingRange"],2),J.getArray(t,e,["mappingRange"]),nb(t,e)}const ib=J.newInstance(p4,"vtkScalarsToColors");var Ch={newInstance:ib,extend:p4,...Zg};const ab={RGB:0,HSV:1,LAB:2,DIVERGING:3},ob={LINEAR:0,LOG10:1};var d4={ColorSpace:ab,Scale:ob};const{ColorSpace:pi,Scale:Qg}=d4,{ScalarMappingTarget:n0}=Ch,{vtkDebugMacro:sb,vtkErrorMacro:Ia,vtkWarningMacro:cb}=J;function Um(t,e){const n=t[0],r=t[1],i=t[2],a=Math.sqrt(n*n+r*r+i*i),o=a>.001?Math.acos(n/a):0,s=o>.001?Math.atan2(i,r):0;e[0]=a,e[1]=o,e[2]=s}function ub(t,e){const n=t[0],r=t[1],i=t[2];e[0]=n*Math.cos(r),e[1]=n*Math.sin(r)*Math.cos(i),e[2]=n*Math.sin(r)*Math.sin(i)}function Bm(t,e){if(t[0]>=e-.1)return t[2];const n=t[1]*Math.sqrt(e*e-t[0]*t[0])/(t[0]*Math.sin(t[1]));return t[2]>-.3*Math.PI?t[2]+n:t[2]-n}function lb(t,e){let n=t-e;for(n<0&&(n=-n);n>=2*Math.PI;)n-=2*Math.PI;return n>Math.PI&&(n=2*Math.PI-n),n}function Gm(t,e,n,r){const i=[],a=[];Ys(e,i),Ys(n,a);const o=[],s=[];Um(i,o),Um(a,s);let c=t;if(o[1]>.05&&s[1]>.05&&lb(o[2],s[2])>.33*Math.PI){let u=Math.max(o[0],s[0]);u=Math.max(88,u),t<.5?(s[0]=u,s[1]=0,s[2]=0,c*=2):(o[0]=u,o[1]=0,o[2]=0,c=2*c-1)}o[1]<.05&&s[1]>.05?o[2]=Bm(s,o[0]):s[1]<.05&&o[1]>.05&&(s[2]=Bm(o,s[0]));const l=[];l[0]=(1-c)*o[0]+c*s[0],l[1]=(1-c)*o[1]+c*s[1],l[2]=(1-c)*o[2]+c*s[2];const f=[];ub(l,f),Sf(f,r)}function fb(t,e){e.classHierarchy.push("vtkColorTransferFunction"),t.getSize=()=>e.nodes.length,t.addRGBPoint=(n,r,i,a)=>t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(o<0||o>1)return Ia("Midpoint outside range [0.0, 1.0]"),-1;if(s<0||s>1)return Ia("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const c={x:n,r,g:i,b:a,midpoint:o,sharpness:s};e.nodes.push(c),t.sortAndUpdateRange();let l=0;for(;l<e.nodes.length&&e.nodes[l].x!==n;l++);return l<e.nodes.length?l:-1},t.addHSVPoint=(n,r,i,a)=>t.addHSVPointLong(n,r,i,a,.5,0),t.addHSVPointLong=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;const c=[];return Hs([r,i,a],c),t.addRGBPoint(n,c[0],c[1],c[2],o,s)},t.setNodes=n=>{if(e.nodes!==n){const r=JSON.stringify(e.nodes);e.nodes=n;const i=JSON.stringify(e.nodes);if(t.sortAndUpdateRange()||r!==i)return t.modified(),!0}return!1},t.sortAndUpdateRange=()=>{const n=JSON.stringify(e.nodes);e.nodes.sort((a,o)=>a.x-o.x);const r=JSON.stringify(e.nodes),i=t.updateRange();return!i&&n!==r?(t.modified(),!0):i},t.updateRange=()=>{const n=[2];n[0]=e.mappingRange[0],n[1]=e.mappingRange[1];const r=e.nodes.length;return r?(e.mappingRange[0]=e.nodes[0].x,e.mappingRange[1]=e.nodes[r-1].x):(e.mappingRange[0]=0,e.mappingRange[1]=0),n[0]===e.mappingRange[0]&&n[1]===e.mappingRange[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r=0;for(;r<e.nodes.length&&e.nodes[r].x!==n;r++);const i=r;if(r>=e.nodes.length)return-1;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.movePoint=(n,r)=>{if(n!==r){t.removePoint(r);for(let i=0;i<e.nodes.length;i++)if(e.nodes[i].x===n){e.nodes[i].x=r,t.sortAndUpdateRange();break}}},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addRGBSegment=(n,r,i,a,o,s,c,l)=>{t.sortAndUpdateRange();for(let f=0;f<e.nodes.length;)e.nodes[f].x>=n&&e.nodes[f].x<=o?e.nodes.splice(f,1):f++;t.addRGBPointLong(n,r,i,a,.5,0),t.addRGBPointLong(o,s,c,l,.5,0),t.modified()},t.addHSVSegment=(n,r,i,a,o,s,c,l)=>{const f=[r,i,a],u=[s,c,l],h=[],p=[];Hs(f,h),Hs(u,p),t.addRGBSegment(n,h[0],h[1],h[2],o,p[0],p[1],p[2])},t.mapValue=n=>{const r=[];return t.getColor(n,r),[Math.floor(255*r[0]+.5),Math.floor(255*r[1]+.5),Math.floor(255*r[2]+.5),255]},t.getColor=(n,r)=>{if(e.indexedLookup){const i=t.getSize(),a=t.getAnnotatedValueIndexInternal(n);if(a<0||i===0){const o=t.getNanColorByReference();r[0]=o[0],r[1]=o[1],r[2]=o[2]}else{const o=[];t.getNodeValue(a%i,o),r[0]=o[1],r[1]=o[2],r[2]=o[3]}return}t.getTable(n,n,1,r)},t.getRedValue=n=>{const r=[];return t.getColor(n,r),r[0]},t.getGreenValue=n=>{const r=[];return t.getColor(n,r),r[1]},t.getBlueValue=n=>{const r=[];return t.getColor(n,r),r[2]},t.getTable=(n,r,i,a)=>{const o=Number(n),s=Number(r);if(bf(o)||bf(s)){for(let b=0;b<i;b++)a[b*3+0]=e.nanColor[0],a[b*3+1]=e.nanColor[1],a[b*3+2]=e.nanColor[2];return}let c=0;const l=e.nodes.length;let f=0,u=0,h=0;l!==0&&(f=e.nodes[l-1].r,u=e.nodes[l-1].g,h=e.nodes[l-1].b);let p=0,d=0,g=0;const y=[0,0,0],x=[0,0,0];let m=0,v=0;const w=[];let C=e.scale===Qg.LOG10;C&&(C=e.mappingRange[0]>0);let T=0,_=0,S=0;C&&(T=Math.log10(o),_=Math.log10(s));for(let b=0;b<i;b++){const D=3*b;if(i>1?C?(S=T+b/(i-1)*(_-T),p=10**S):p=o+b/(i-1)*(s-o):C?(S=.5*(T+_),p=10**S):p=.5*(o+s),e.discretize){const E=e.mappingRange;if(p>=E[0]&&p<=E[1]){const R=e.numberOfValues,F=E[1]-E[0];if(R<=1)p=E[0]+F/2;else{const M=(p-E[0])/F,U=qg(R*M);p=E[0]+U/(R-1)*F}}}for(;c<l&&p>e.nodes[c].x;)c++,c<l&&(d=e.nodes[c-1].x,g=e.nodes[c].x,C&&(d=Math.log10(d),g=Math.log10(g)),y[0]=e.nodes[c-1].r,x[0]=e.nodes[c].r,y[1]=e.nodes[c-1].g,x[1]=e.nodes[c].g,y[2]=e.nodes[c-1].b,x[2]=e.nodes[c].b,m=e.nodes[c-1].midpoint,v=e.nodes[c-1].sharpness,m<1e-5&&(m=1e-5),m>.99999&&(m=.99999));if(p>e.mappingRange[1])a[D]=0,a[D+1]=0,a[D+2]=0,e.clamping&&(t.getUseAboveRangeColor()?(a[D]=e.aboveRangeColor[0],a[D+1]=e.aboveRangeColor[1],a[D+2]=e.aboveRangeColor[2]):(a[D]=f,a[D+1]=u,a[D+2]=h));else if(p<e.mappingRange[0]||a4(p)&&p<0)a[D]=0,a[D+1]=0,a[D+2]=0,e.clamping&&(t.getUseBelowRangeColor()?(a[D]=e.belowRangeColor[0],a[D+1]=e.belowRangeColor[1],a[D+2]=e.belowRangeColor[2]):l>0&&(a[D]=e.nodes[0].r,a[D+1]=e.nodes[0].g,a[D+2]=e.nodes[0].b));else if(c===0&&(Math.abs(p-o)<1e-6||e.discretize))l>0?(a[D]=e.nodes[0].r,a[D+1]=e.nodes[0].g,a[D+2]=e.nodes[0].b):(a[D]=0,a[D+1]=0,a[D+2]=0);else{let E=0;if(C?E=(S-d)/(g-d):E=(p-d)/(g-d),E<m?E=.5*E/m:E=.5+.5*(E-m)/(1-m),v>.99)if(E<.5){a[D]=y[0],a[D+1]=y[1],a[D+2]=y[2];continue}else{a[D]=x[0],a[D+1]=x[1],a[D+2]=x[2];continue}if(v<.01){if(e.colorSpace===pi.RGB)a[D]=(1-E)*y[0]+E*x[0],a[D+1]=(1-E)*y[1]+E*x[1],a[D+2]=(1-E)*y[2]+E*x[2];else if(e.colorSpace===pi.HSV){const j=[],ie=[];Du(y,j),Du(x,ie),e.hSVWrap&&(j[0]-ie[0]>.5||ie[0]-j[0]>.5)&&(j[0]>ie[0]?j[0]-=1:ie[0]-=1);const ae=[];ae[0]=(1-E)*j[0]+E*ie[0],ae[0]<0&&(ae[0]+=1),ae[1]=(1-E)*j[1]+E*ie[1],ae[2]=(1-E)*j[2]+E*ie[2],Hs(ae,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]}else if(e.colorSpace===pi.LAB){const j=[],ie=[];Ys(y,j),Ys(x,ie);const ae=[];ae[0]=(1-E)*j[0]+E*ie[0],ae[1]=(1-E)*j[1]+E*ie[1],ae[2]=(1-E)*j[2]+E*ie[2],Sf(ae,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]}else e.colorSpace===pi.DIVERGING?(Gm(E,y,x,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]):Ia("ColorSpace set to invalid value.",e.colorSpace);continue}E<.5?E=.5*(E*2)**(1+10*v):E>.5&&(E=1-.5*((1-E)*2)**(1+10*v));const R=E*E,F=R*E,M=2*F-3*R+1,U=-2*F+3*R,z=F-2*R+E,Y=F-R;let W,B;if(e.colorSpace===pi.RGB)for(let j=0;j<3;j++)W=x[j]-y[j],B=(1-v)*W,a[D+j]=M*y[j]+U*x[j]+z*B+Y*B;else if(e.colorSpace===pi.HSV){const j=[],ie=[];Du(y,j),Du(x,ie),e.hSVWrap&&(j[0]-ie[0]>.5||ie[0]-j[0]>.5)&&(j[0]>ie[0]?j[0]-=1:ie[0]-=1);const ae=[];for(let fe=0;fe<3;fe++)W=ie[fe]-j[fe],B=(1-v)*W,ae[fe]=M*j[fe]+U*ie[fe]+z*B+Y*B,fe===0&&ae[fe]<0&&(ae[fe]+=1);Hs(ae,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]}else if(e.colorSpace===pi.LAB){const j=[],ie=[];Ys(y,j),Ys(x,ie);const ae=[];for(let fe=0;fe<3;fe++)W=ie[fe]-j[fe],B=(1-v)*W,ae[fe]=M*j[fe]+U*ie[fe]+z*B+Y*B;Sf(ae,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]}else e.colorSpace===pi.DIVERGING?(Gm(E,y,x,w),a[D]=w[0],a[D+1]=w[1],a[D+2]=w[2]):Ia("ColorSpace set to invalid value.");for(let j=0;j<3;j++)a[D+j]=a[D+j]<0?0:a[D+j],a[D+j]=a[D+j]>1?1:a[D+j]}}},t.getUint8Table=function(n,r,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t.getMTime()<=e.buildTime&&e.tableSize===i&&e.tableWithAlpha!==a)return e.table;if(e.nodes.length===0)return Ia("Attempting to lookup a value with no points in the function"),e.table;const o=a?4:3;(e.tableSize!==i||e.tableWithAlpha!==a)&&(e.table=new Uint8Array(i*o),e.tableSize=i,e.tableWithAlpha=a);const s=[];t.getTable(n,r,i,s);for(let c=0;c<i;c++)e.table[c*o+0]=Math.floor(s[c*3+0]*255+.5),e.table[c*o+1]=Math.floor(s[c*3+1]*255+.5),e.table[c*o+2]=Math.floor(s[c*3+2]*255+.5),a&&(e.table[c*o+3]=255);return e.buildTime.modified(),e.table},t.buildFunctionFromArray=n=>{t.removeAllPoints();const r=n.getNumberOfComponents();for(let i=0;i<n.getNumberOfTuples();i++)switch(r){case 3:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:.5,sharpness:0});break}case 4:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:.5,sharpness:0});break}case 5:{e.nodes.push({x:i,r:n.getComponent(i,0),g:n.getComponent(i,1),b:n.getComponent(i,2),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}case 6:{e.nodes.push({x:n.getComponent(i,0),r:n.getComponent(i,1),g:n.getComponent(i,2),b:n.getComponent(i,3),midpoint:n.getComponent(i,4),sharpness:n.getComponent(i,5)});break}}t.sortAndUpdateRange()},t.buildFunctionFromTable=(n,r,i,a)=>{let o=0;t.removeAllPoints(),i>1&&(o=(r-n)/(i-1));for(let s=0;s<i;s++){const c={x:n+o*s,r:a[s*3],g:a[s*3+1],b:a[s*3+2],sharpness:0,midpoint:.5};e.nodes.push(c)}t.sortAndUpdateRange()},t.getNodeValue=(n,r)=>n<0||n>=e.nodes.length?(Ia("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].r,r[2]=e.nodes[n].g,r[3]=e.nodes[n].b,r[4]=e.nodes[n].midpoint,r[5]=e.nodes[n].sharpness,1),t.setNodeValue=(n,r)=>{if(n<0||n>=e.nodes.length)return Ia("Index out of range!"),-1;const i=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].r=r[1],e.nodes[n].g=r[2],e.nodes[n].b=r[3],e.nodes[n].midpoint=r[4],e.nodes[n].sharpness=r[5],i!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.getNumberOfAvailableColors=()=>{if(e.indexedLookup&&t.getSize())return t.getSize();if(e.tableSize)return e.tableSize;const n=e.nodes?.length??0;return Math.max(4094,n)},t.getIndexedColor=(n,r)=>{const i=t.getSize();if(i>0&&n>=0){const o=[];t.getNodeValue(n%i,o);for(let s=0;s<3;++s)r[s]=o[s+1];r[3]=1;return}const a=t.getNanColorByReference();r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=1},t.fillFromDataPointer=(n,r)=>{if(!(n<=0||!r)){t.removeAllPoints();for(let i=0;i<n;i++)t.addRGBPoint(r[i*4],r[i*4+1],r[i*4+2],r[i*4+3])}},t.setMappingRange=(n,r)=>{const i=[n,r],a=t.getRange();if(a[1]===i[1]&&a[0]===i[0])return;if(i[1]===i[0]){Ia("attempt to set zero width color range");return}const o=(i[1]-i[0])/(a[1]-a[0]),s=i[0]-a[0]*o;for(let c=0;c<e.nodes.length;++c)e.nodes[c].x=e.nodes[c].x*o+s;e.mappingRange[0]=i[0],e.mappingRange[1]=i[1],t.modified()},t.adjustRange=n=>{const r=t.getRange(),i=[];r[0]<n[0]?(t.getColor(n[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])):(t.getColor(r[0],i),t.addRGBPoint(n[0],i[0],i[1],i[2])),r[1]>n[1]?(t.getColor(n[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])):(t.getColor(r[1],i),t.addRGBPoint(n[1],i[0],i[1],i[2])),t.sortAndUpdateRange();for(let a=0;a<e.nodes.length;)e.nodes[a].x>=n[0]&&e.nodes[a].x<=n[1]?e.nodes.splice(a,1):++a;return 1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{if(e.nodes.length<2)return-1;let n=Number.MAX_VALUE;for(let r=0;r<e.nodes.length-1;r++){const i=e.nodes[r+1].x-e.nodes[r].x;i<n&&(n=i)}return n},t.mapScalarsThroughTable=(n,r,i,a)=>{if(t.getSize()===0){sb("Transfer Function Has No Points!");return}e.indexedLookup?t.mapDataIndexed(n,r,i,a):t.mapData(n,r,i,a)},t.mapData=(n,r,i,a)=>{if(t.getSize()===0){cb("Transfer Function Has No Points!");return}const o=Math.floor(t.getAlpha()*255+.5),s=n.getNumberOfTuples(),c=n.getNumberOfComponents(),l=r.getData(),f=n.getData(),u=[];if(i===n0.RGBA)for(let h=0;h<s;h++){const p=f[h*c+a];t.getColor(p,u),l[h*4]=Math.floor(u[0]*255+.5),l[h*4+1]=Math.floor(u[1]*255+.5),l[h*4+2]=Math.floor(u[2]*255+.5),l[h*4+3]=o}if(i===n0.RGB)for(let h=0;h<s;h++){const p=f[h*c+a];t.getColor(p,u),l[h*3]=Math.floor(u[0]*255+.5),l[h*3+1]=Math.floor(u[1]*255+.5),l[h*3+2]=Math.floor(u[2]*255+.5)}if(i===n0.LUMINANCE)for(let h=0;h<s;h++){const p=f[h*c+a];t.getColor(p,u),l[h]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5)}if(i===n0.LUMINANCE_ALPHA)for(let h=0;h<s;h++){const p=f[h*c+a];t.getColor(p,u),l[h*2]=Math.floor(u[0]*76.5+u[1]*150.45+u[2]*28.05+.5),l[h*2+1]=o}},t.applyColorMap=n=>{const r=JSON.stringify(e.colorSpace);n.ColorSpace&&(e.colorSpace=pi[n.ColorSpace.toUpperCase()],e.colorSpace===void 0&&(Ia(`ColorSpace ${n.ColorSpace} not supported, using RGB instead`),e.colorSpace=pi.RGB));let i=r!==JSON.stringify(e.colorSpace);const a=i||JSON.stringify(e.nanColor);if(n.NanColor)for(e.nanColor=[].concat(n.NanColor);e.nanColor.length<4;)e.nanColor.push(1);i=i||a!==JSON.stringify(e.nanColor);const o=i||JSON.stringify(e.nodes);if(n.RGBPoints){const l=n.RGBPoints.length;e.nodes=[];const f=.5,u=0;for(let h=0;h<l;h+=4)e.nodes.push({x:n.RGBPoints[h],r:n.RGBPoints[h+1],g:n.RGBPoints[h+2],b:n.RGBPoints[h+3],midpoint:f,sharpness:u})}const s=t.sortAndUpdateRange(),c=!s&&(i||o!==JSON.stringify(e.nodes));return c&&t.modified(),s||c}}const hb={clamping:!0,colorSpace:pi.RGB,hSVWrap:!0,scale:Qg.LINEAR,nanColor:null,belowRangeColor:null,aboveRangeColor:null,useAboveRangeColor:!1,useBelowRangeColor:!1,allowDuplicateScalars:!1,table:null,tableSize:0,buildTime:null,nodes:null,discretize:!1,numberOfValues:256};function g4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hb,n),Ch.extend(t,e,n),e.table=[],e.nodes=[],e.nanColor=[.5,0,0,1],e.belowRangeColor=[0,0,0,1],e.aboveRangeColor=[1,1,1,1],e.buildTime={},J.obj(e.buildTime),J.get(t,e,["buildTime","mappingRange"]),J.setGet(t,e,["useAboveRangeColor","useBelowRangeColor","discretize","numberOfValues",{type:"enum",name:"colorSpace",enum:pi},{type:"enum",name:"scale",enum:Qg}]),J.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),J.getArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"]),fb(t,e)}const pb=J.newInstance(g4,"vtkColorTransferFunction");var rs={newInstance:pb,extend:g4,...d4},db=[{Name:"KAAMS",IndexedColors:[1,1,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,0,1,1,.63,.63,1,.67,.5,.33,1,.5,.75,.53,.35,.7,1,.75,.5],Annotations:[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11]},{ColorSpace:"Diverging",Name:"Cool to Warm",NanColor:[1,1,0],RGBPoints:[0,.23137254902,.298039215686,.752941176471,.5,.865,.865,.865,1,.705882352941,.0156862745098,.149019607843]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Cool to Warm (Extended)",NanColor:[.25,0,0],RGBPoints:[0,0,0,.34902,.03125,.039216,.062745,.380392,.0625,.062745,.117647,.411765,.09375,.090196,.184314,.45098,.125,.12549,.262745,.501961,.15625,.160784,.337255,.541176,.1875,.2,.396078,.568627,.21875,.239216,.454902,.6,.25,.286275,.521569,.65098,.28125,.337255,.592157,.701961,.3125,.388235,.654902,.74902,.34375,.466667,.737255,.819608,.375,.572549,.819608,.878431,.40625,.654902,.866667,.909804,.4375,.752941,.917647,.941176,.46875,.823529,.956863,.968627,.5,.988235,.960784,.901961,.5,.941176,.984314,.988235,.52,.988235,.945098,.85098,.54,.980392,.898039,.784314,.5625,.968627,.835294,.698039,.59375,.94902,.733333,.588235,.625,.929412,.65098,.509804,.65625,.909804,.564706,.435294,.6875,.878431,.458824,.352941,.71875,.839216,.388235,.286275,.75,.760784,.294118,.211765,.78125,.701961,.211765,.168627,.8125,.65098,.156863,.129412,.84375,.6,.094118,.094118,.875,.54902,.066667,.098039,.90625,.501961,.05098,.12549,.9375,.45098,.054902,.172549,.96875,.4,.054902,.192157,1,.34902,.070588,.211765]},{ColorSpace:"Diverging",Name:"Warm to Cool",NanColor:[1,1,0],RGBPoints:[0,.705882352941,.0156862745098,.149019607843,.5,.865,.865,.865,1,.23137254902,.298039215686,.752941176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Warm to Cool (Extended)",NanColor:[.250004,0,0],RGBPoints:[0,.34902,0,.129412,.025,.4,.00392157,.101961,.05,.470588,.0156863,.0901961,.075,.54902,.027451,.0705882,.1,.619608,.0627451,.0431373,.125,.690196,.12549,.0627451,.15,.741176,.184314,.0745098,.175,.788235,.266667,.0941176,.2,.811765,.345098,.113725,.225,.831373,.411765,.133333,.25,.85098,.47451,.145098,.275,.870588,.54902,.156863,.3,.878431,.619608,.168627,.325,.890196,.658824,.196078,.35,.909804,.717647,.235294,.375,.929412,.776471,.278431,.395522,.94902,.823529,.321569,.418905,.968627,.87451,.407843,.444278,.980392,.917647,.509804,.470149,.988235,.956863,.643137,.483582,.992157,.964706,.713725,.499,.988235,.980392,.870588,.5,1,1,1,.501,.913725,.988235,.937255,.516418,.827451,.980392,.886275,.531343,.764706,.980392,.866667,.546766,.658824,.980392,.843137,.564179,.572549,.964706,.835294,.587562,.423529,.941176,.87451,.60597,.262745,.901961,.862745,.629851,.0705882,.854902,.870588,.651741,.0509804,.8,.85098,.681592,.0235294,.709804,.831373,.712935,.0313725,.615686,.811765,.75,.0313725,.537255,.788235,.775,.0392157,.466667,.768627,.8,.0509804,.396078,.741176,.825,.054902,.317647,.709804,.85,.054902,.243137,.678431,.875,.0431373,.164706,.639216,.9,.0313725,.0980392,.6,.925,.0392157,.0392157,.560784,.95,.105882,.0509804,.509804,.975,.113725,.0235294,.45098,1,.12549,0,.380392]},{ColorSpace:"RGB",Name:"Rainbow Desaturated",NanColor:[1,1,0],RGBPoints:[0,.278431372549,.278431372549,.858823529412,.143,0,0,.360784313725,.285,0,1,1,.429,0,.501960784314,0,.571,1,1,0,.714,1,.380392156863,0,.857,.419607843137,0,0,1,.878431372549,.301960784314,.301960784314]},{ColorSpace:"RGB",Name:"Cold and Hot",NanColor:[1,1,0],RGBPoints:[0,0,1,1,.45,0,0,1,.5,0,0,.501960784314,.55,1,0,0,1,1,1,0]},{ColorSpace:"RGB",Name:"Black-Body Radiation",NanColor:[0,.498039215686,1],RGBPoints:[0,0,0,0,.4,.901960784314,0,0,.8,.901960784314,.901960784314,0,1,1,1,1]},{ColorSpace:"RGB",Name:"X Ray",NanColor:[1,0,0],RGBPoints:[0,1,1,1,1,0,0,0]},{ColorSpace:"RGB",Name:"Grayscale",NanColor:[1,0,0],RGBPoints:[0,0,0,0,1,1,1,1]},{ColorSpace:"RGB",Name:"BkRd",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,1,0,0]},{ColorSpace:"RGB",Name:"BkGn",NanColor:[1,0,1],RGBPoints:[0,0,0,0,1,0,1,0]},{ColorSpace:"RGB",Name:"BkBu",NanColor:[1,1,0],RGBPoints:[0,0,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"BkMa",NanColor:[0,1,0],RGBPoints:[0,0,0,0,1,1,0,1]},{ColorSpace:"RGB",Name:"BkCy",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,0,1,1]},{ColorSpace:"RGB",Name:"Black, Blue and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,0,0,.501960784314,.666,0,.501960784314,1,1,1,1,1]},{ColorSpace:"RGB",Name:"Black, Orange and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,.501960784314,0,0,.666,1,.501960784314,0,1,1,1,1]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear YGB 1211g",NanColor:[.25,0,0],RGBPoints:[0,1,.988235,.968627,.02,1,.952941,.878431,.05,.968627,.905882,.776471,.1,.94902,.898039,.647059,.15,.901961,.878431,.556863,.2,.847059,.858824,.482353,.25,.690196,.819608,.435294,.3,.513725,.768627,.384314,.35,.337255,.721569,.337255,.4,.278431,.658824,.392157,.45,.231373,.639216,.435294,.5,.203922,.6,.486275,.55,.172549,.568627,.537255,.6,.141176,.517647,.54902,.65,.133333,.458824,.541176,.7,.12549,.396078,.529412,.75,.117647,.321569,.521569,.8,.121569,.258824,.509804,.85,.133333,.227451,.501961,.9,.145098,.192157,.490196,.95,.188235,.164706,.470588,1,.258824,.196078,.439216]},{ColorSpace:"CIELAB",Creator:"Francesca Samsel",Name:"Linear Green (Gr4L)",NanColor:[.25,0,0],RGBPoints:[0,.054902,.109804,.121569,.05,.07451,.172549,.180392,.1,.086275,.231373,.219608,.15,.094118,.278431,.25098,.2,.109804,.34902,.278431,.25,.113725,.4,.278431,.3,.117647,.45098,.270588,.35,.117647,.490196,.243137,.4,.113725,.521569,.203922,.45,.109804,.54902,.152941,.5,.082353,.588235,.082353,.55,.109804,.631373,.05098,.6,.211765,.678431,.082353,.65,.317647,.721569,.113725,.7,.431373,.760784,.160784,.75,.556863,.8,.239216,.8,.666667,.839216,.294118,.85,.784314,.878431,.396078,.9,.886275,.921569,.533333,.95,.960784,.94902,.670588,1,1,.984314,.901961]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear Blue (8_31f)",NanColor:[.25,0,0],RGBPoints:[0,.960784,1,.980392,.05,.815686,.960784,.913725,.1,.670588,.929412,.870588,.15,.556863,.901961,.843137,.2,.478431,.870588,.823529,.25,.439216,.831373,.803922,.3,.4,.8,.788235,.35,.376471,.768627,.768627,.4,.34902,.709804,.729412,.45,.32549,.654902,.690196,.5,.301961,.607843,.658824,.55,.247059,.545098,.619608,.6,.239216,.494118,.580392,.65,.227451,.439216,.541176,.7,.227451,.403922,.521569,.75,.231373,.368627,.501961,.8,.227451,.321569,.470588,.85,.219608,.282353,.439216,.9,.192157,.235294,.4,.95,.160784,.184314,.34902,1,.133333,.12549,.301961]},{ColorSpace:"HSV",Name:"Blue to Red Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,0,0,1,1,1,0,0]},{ColorSpace:"HSV",Name:"Red to Blue Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,1,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended White",NanColor:[1,1,0],RGBPoints:[0,1,1,1,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Grey",NanColor:[1,1,0],RGBPoints:[0,.317647058824,.341176470588,.43137254902,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Black",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Blue to Yellow",NanColor:[1,0,0],RGBPoints:[0,.0392156862745,.0392156862745,.949019607843,1,.949019607843,.949019607843,.0392156862745]},{ColorSpace:"HSV",Name:"blot",RGBPoints:[0,0,0,1,.166,0,0,1,.167,1,0,1,.332,1,0,1,.333,0,1,1,.5,0,1,1,.501,0,1,0,.666,0,1,0,.667,1,1,0,.832,1,1,0,.833,1,0,0,1,1,0,0]},{ColorSpace:"Lab",Name:"CIELab Blue to Red",NanColor:[1,1,0],RGBPoints:[0,0,.6,.749019607843,1,.76862745098,.466666666667,.341176470588]},{ColorSpace:"RGB",Name:"jet",RGBPoints:[-1,0,0,.5625,-.777778,0,0,1,-.269841,0,1,1,-.015873,.5,1,.5,.238095,1,1,0,.746032,1,0,0,1,.5,0,0]},{ColorSpace:"RGB",Name:"rainbow",RGBPoints:[-1,0,0,1,-.5,0,1,1,0,0,1,0,.5,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"erdc_rainbow_bright",RGBPoints:[-1,.32549,.14902,.960784,-.866221,.297047,.375586,.963836,-.732441,.180302,.536818,.964627,-.598662,.1302,.649207,.929647,-.464883,.0445143,.749654,.855998,-.331104,.0271325,.830713,.721527,-.197324,.259504,.866145,.543555,-.0635452,.428364,.890725,.329819,.0702341,.568503,.898508,.187623,.204013,.738259,.890317,.0825461,.337793,.84546,.86136,.0147555,.471572,.912191,.808018,0,.605351,.962848,.710445,0,.73913,.999469,.600258,.0176284,.87291,.994156,.445975,.193912,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"erdc_rainbow_dark",RGBPoints:[-1,0,0,.423499,-.866221,0,.119346,.529237,-.732441,0,.238691,.634976,-.598662,0,.346852,.68788,-.464883,0,.45022,.718141,-.331104,0,.553554,.664839,-.197324,0,.651082,.519303,-.0635452,.115841,.72479,.352857,.0702341,.326771,.781195,.140187,.204013,.522765,.798524,.0284624,.337793,.703162,.788685,.00885756,.471572,.845118,.751133,0,.605351,.955734,.690825,0,.73913,.995402,.567916,.0618524,.87291,.987712,.403398,.164851,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"nic_CubicL",RGBPoints:[-1,.479965,.0118108,.5307,-.87451,.522213,.0551282,.706919,-.74902,.50839,.237278,.867764,-.623529,.451617,.373834,.987255,-.498039,.39365,.497255,.97506,-.372549,.328631,.599639,.891843,-.247059,.250043,.690286,.778553,-.121569,.249656,.764905,.645857,.00392157,.297954,.821466,.50449,.129412,.337509,.872595,.358447,.254902,.430011,.913789,.297079,.380392,.587191,.931381,.333353,.505882,.727937,.93591,.353742,.631373,.826403,.921081,.365066,.756863,.893201,.846317,.372662,.882353,.965347,.73884,.378506,1,.983235,.597451,.366856]},{ColorSpace:"Lab",Name:"nic_CubicYF",RGBPoints:[-1,.5151,.0482,.6697,-.87451,.520711,.168955,.800574,-.74902,.493694,.278596,.911824,-.623529,.440026,.369475,.984978,-.498039,.398932,.457593,.987053,-.372549,.350651,.540644,.929608,-.247059,.298827,.615625,.857729,-.121569,.239928,.685061,.769531,.00392157,.228832,.739349,.673287,.129412,.263297,.78608,.569988,.254902,.298107,.828337,.460214,.380392,.33092,.864071,.352674,.505882,.38306,.898169,.287309,.631373,.49023,.917481,.307961,.756863,.62372,.926026,.332309,.882353,.717458,.92527,.342476,1,.8,.9255,.3529]},{ColorSpace:"Lab",Name:"gist_earth",RGBPoints:[-1,0,0,0,-.87451,.239216,.027451,.415686,-.74902,.0901961,.254902,.556863,-.623529,.0941176,.352941,.54902,-.498039,.105882,.435294,.533333,-.372549,.12549,.52549,.501961,-.247059,.156863,.596078,.443137,-.121569,.196078,.65098,.380392,.00392157,.282353,.717647,.301961,.129412,.466667,.772549,.27451,.254902,.678431,.784314,.309804,.380392,.901961,.756863,.376471,.505882,.992157,.705882,.521569,.631373,1,.721569,.701961,.756863,1,.784314,.784314,.882353,1,.866667,.866667,1,1,1,1]},{ColorSpace:"Lab",Name:"2hot",RGBPoints:[-1,.0416667,0,0,-.873016,.208333,0,0,-.746032,.375,0,0,-.619048,.541667,0,0,-.492063,.708333,0,0,-.365079,.854137,0,0,-.238095,.937488,.039062,0,-.111111,1,.208333,0,.015873,1,.375,0,.142857,1,.541667,0,.269841,1,.708333,0,.396825,1,.858805,.03125,.52381,1,.947392,.15625,.650794,1,1,.3125,.777778,1,1,.5625,.904762,1,1,.8125,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_red2yellow_BW",RGBPoints:[-1,754296e-12,0,109827e-10,-.87451,.18285,.0264094,0,-.74902,.3066,0,0,-.623529,.422841,0,0,-.498039,.522945,0,0,-.372549,.605721,0,0,-.247059,.672502,.14168,0,-.121569,.728167,.244025,0,.00392157,.781215,.333454,0,.129412,.825,.423586,0,.254902,.855893,.516793,0,.380392,.880491,.608846,0,.505882,.910305,.695505,0,.631373,.94109,.779067,.223528,.756863,.967873,.858572,.473521,.882353,.986815,.933211,.751583,1,1,1,.999997]},{ColorSpace:"Lab",Name:"erdc_marine2gold_BW",RGBPoints:[-1,111641e-12,0,162551e-11,-.87451,.0413146,.0619808,.209857,-.74902,.0185557,.101341,.350684,-.623529,.00486405,.149847,.461054,-.498039,.0836345,.210845,.517906,-.372549,.173222,.276134,.541793,-.247059,.259857,.343877,.535869,-.121569,.362299,.408124,.504293,.00392157,.468266,.468276,.468257,.129412,.582781,.527545,.374914,.254902,.691591,.585251,.274266,.380392,.784454,.645091,.247332,.505882,.862299,.710383,.27518,.631373,.920863,.782923,.351563,.756863,.955792,.859699,.533541,.882353,.976162,.93433,.780671,1,1,1,.999983]},{ColorSpace:"Lab",Name:"erdc_blue2gold_BW",RGBPoints:[-1,0,0,0,-.87451,.0742735,.0440331,.230013,-.74902,.125276,.0258685,.415826,-.623529,.143879,.0163031,.591346,-.498039,.212261,.0627855,.705239,-.372549,.306048,.141178,.763636,-.247059,.391537,.232286,.773263,-.121569,.461734,.336633,.708321,.00392157,.54209,.427581,.590007,.129412,.61704,.508623,.460978,.254902,.702703,.579586,.309117,.380392,.790336,.644811,.170397,.505882,.870173,.710733,.117134,.631373,.93656,.781991,.157144,.756863,.965672,.862068,.409836,.882353,.985751,.936296,.714162,1,1,1,.999999]},{ColorSpace:"Lab",Name:"erdc_sapphire2gold_BW",RGBPoints:[-1,.107704,.107708,.107694,-.87451,.1851,.112354,.308554,-.74902,.236782,.114233,.48788,-.623529,.28296,.126187,.639464,-.498039,.344787,.171643,.739713,-.372549,.413325,.242371,.76913,-.247059,.481863,.3131,.719841,-.121569,.550402,.383829,.612222,.00392157,.61894,.454558,.51126,.129412,.687478,.525287,.39993,.254902,.756017,.596016,.289923,.380392,.824555,.666745,.255498,.505882,.892979,.736822,.27696,.631373,.938851,.804966,.351734,.756863,.966491,.874853,.53572,.882353,.982105,.94153,.782579,1,1,1,.999986]},{ColorSpace:"Lab",Name:"erdc_red2purple_BW",RGBPoints:[-1,0,0,0,-.87451,.167793,.0166271,.0431278,-.74902,.262608,.0107595,.0791181,-.623529,.351902,.0101858,.100926,-.498039,.441257,.0160835,.131919,-.372549,.5221,.0555972,.195625,-.247059,.593852,.104294,.310234,-.121569,.654628,.158115,.448486,.00392157,.707443,.220914,.570253,.129412,.749504,.293268,.67897,.254902,.781587,.370517,.779269,.380392,.809951,.451099,.855831,.505882,.84424,.531462,.900451,.631373,.865174,.620901,.91606,.756863,.875041,.714054,.910284,.882353,.880764,.80554,.896276,1,.887572,.887591,.887556]},{ColorSpace:"Lab",Name:"erdc_purple2pink_BW",RGBPoints:[-1,0,0,0,-.87451,.117562,.0291202,.175876,-.74902,.178368,.0458476,.285454,-.623529,.237731,.0680173,.387717,-.498039,.300877,.0956291,.484802,-.372549,.370929,.136858,.554985,-.247059,.449033,.189273,.58863,-.121569,.529971,.245796,.598587,.00392157,.609914,.300643,.610244,.129412,.697079,.351286,.616371,.254902,.785858,.401991,.617376,.380392,.862517,.45745,.64463,.505882,.91359,.525462,.705336,.631373,.932583,.61064,.767412,.756863,.922478,.706966,.817522,.882353,.901302,.803071,.856311,1,.887571,.887591,.887549]},{ColorSpace:"Lab",Name:"erdc_pbj_lin",RGBPoints:[-1,0,0,0,-.87451,.091821,.0611476,.10617,-.74902,.160311,.0900022,.192713,-.623529,.22484,.12126,.272128,-.498039,.291263,.157469,.340828,-.372549,.360015,.200388,.388903,-.247059,.437497,.250058,.387201,-.121569,.512636,.304969,.355955,.00392157,.582603,.360874,.33488,.129412,.655126,.416374,.306351,.254902,.725889,.473329,.279051,.380392,.778125,.537928,.302697,.505882,.815894,.606931,.382431,.631373,.839159,.679308,.497608,.756863,.854748,.751666,.631792,.882353,.869483,.822508,.768592,1,.887572,.887589,.887565]},{ColorSpace:"Lab",Name:"erdc_blue2green_muted",RGBPoints:[-1,.107704,.107708,.107695,-.87451,.141522,.13066,.270741,-.74902,.180123,.146119,.42308,-.623529,.210161,.169674,.551795,-.498039,.239701,.212939,.634969,-.372549,.253916,.282947,.653641,-.247059,.242791,.366933,.608521,-.121569,.226302,.446776,.52693,.00392157,.236237,.514689,.458798,.129412,.274641,.577589,.376069,.254902,.349625,.633993,.288131,.380392,.4437,.683677,.260497,.505882,.536247,.731214,.285424,.631373,.628472,.777128,.349151,.756863,.718259,.819287,.496825,.882353,.804768,.856164,.703299,1,.887571,.887591,.887548]},{ColorSpace:"Lab",Name:"erdc_blue2green_BW",RGBPoints:[-1,363578e-12,0,529374e-11,-.87451,.0539915,.0577948,.212806,-.74902,.0620393,.0758942,.388959,-.623529,.0697499,.102032,.54177,-.498039,.113295,.156156,.64334,-.372549,.152047,.243196,.670283,-.247059,.158096,.344084,.622864,-.121569,.151142,.43922,.532767,.00392157,.17155,.521588,.457719,.129412,.225861,.599141,.363997,.254902,.32328,.67007,.259083,.380392,.442344,.733697,.223754,.505882,.558409,.794941,.257411,.631373,.673875,.854344,.340822,.756863,.787244,.909326,.524717,.882353,.896483,.958063,.775914,1,1,1,.999982]},{ColorSpace:"Lab",Name:"GREEN-WHITE_LINEAR",RGBPoints:[-1,0,0,0,-.87451,0,.062745,0,-.74902,0,.12549,0,-.623529,0,.188235,0,-.498039,0,.25098,0,-.372549,0,.313725,0,-.247059,0,.376471,0,-.121569,.094118,.439216,0,.00392157,.196078,.501961,0,.129412,.294118,.564706,0,.254902,.396078,.627451,0,.380392,.498039,.690196,0,.505882,.6,.752941,.145098,.631373,.701961,.815686,.364706,.756863,.8,.878431,.580392,.882353,.901961,.941176,.796078,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_green2yellow_BW",RGBPoints:[-1,0,0,0,-.87451,0,.105542,.0603919,-.74902,0,.159454,.104148,-.623529,0,.219502,.15542,-.498039,0,.282276,.203811,-.372549,0,.346331,.235652,-.247059,0,.411765,.235428,-.121569,0,.477177,.217977,.00392157,.0593644,.541635,.21361,.129412,.233081,.604722,.210591,.254902,.369803,.664942,.226536,.380392,.498446,.722367,.288237,.505882,.601929,.782244,.380815,.631373,.703207,.840497,.512134,.756863,.803186,.896433,.674462,.882353,.903834,.950266,.846715,1,1,1,.999981]},{ColorSpace:"Lab",Name:"blue2cyan",RGBPoints:[-1,0,0,0,-.87451,0,.152941,.364706,-.74902,0,.254902,.470588,-.623529,0,.34902,.572549,-.498039,0,.443137,.670588,-.372549,0,.537255,.772549,-.247059,0,.627451,.870588,-.121569,0,.717647,.964706,.00392157,.0784314,.772549,1,.129412,.207843,.858824,1,.254902,.32549,.941176,1,.380392,.45098,1,1,.505882,.560784,1,1,.631373,.662745,1,1,.756863,.760784,1,1,.882353,.870588,1,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_blue2cyan_BW",RGBPoints:[-1,405298e-12,0,59012e-10,-.87451,.0207526,.0740933,.18093,-.74902,0,.121033,.30343,-.623529,0,.166892,.416095,-.498039,0,.216768,.524796,-.372549,.0164769,.275471,.608585,-.247059,.0544527,.344824,.659267,-.121569,.0880643,.419118,.688675,.00392157,.127938,.492556,.720256,.129412,.149476,.566946,.756918,.254902,.188961,.641333,.792122,.380392,.245482,.715336,.827609,.505882,.329216,.786235,.874761,.631373,.453558,.852803,.918466,.756863,.626281,.910493,.954,.882353,.82257,.958709,.980146,1,1,1,.999989]},{ColorSpace:"Lab",Name:"erdc_blue_BW",RGBPoints:[-1,0,0,0,-.87451,.0425591,.0763529,.150682,-.74902,.0569472,.119154,.275403,-.623529,.0635978,.164772,.395427,-.498039,.0774342,.213851,.510014,-.372549,.106815,.267034,.615102,-.247059,.122093,.324649,.720068,-.121569,.160851,.387068,.806956,.00392157,.213754,.453516,.878012,.129412,.26722,.524656,.932436,.254902,.326844,.599279,.968038,.380392,.403403,.674712,.984784,.505882,.499703,.745519,1,.631373,.615055,.813983,1,.756863,.74405,.879228,1,.882353,.877909,.941913,1,1,1,1,.999996]},{ColorSpace:"Lab",Name:"BLUE-WHITE",RGBPoints:[-1,0,0,0,-.87451,0,0,.082353,-.74902,0,0,.168627,-.623529,0,0,.254902,-.498039,0,0,.337255,-.372549,0,0,.423529,-.247059,0,0,.509804,-.121569,0,.101961,.592157,.00392157,0,.203922,.678431,.129412,0,.301961,.764706,.254902,0,.403922,.85098,.380392,0,.505882,.933333,.505882,0,.603922,1,.631373,.254902,.705882,1,.756863,.509804,.807843,1,.882353,.764706,.905882,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_purple_BW",RGBPoints:[-1,4264e-11,0,620844e-12,-.87451,.100579,.0593111,.145666,-.74902,.167794,.0889224,.254953,-.623529,.231446,.123339,.360511,-.498039,.296699,.163027,.461278,-.372549,.363211,.209286,.55306,-.247059,.431136,.260776,.637195,-.121569,.498202,.320012,.705799,.00392157,.567456,.380459,.778091,.129412,.629381,.445284,.8448,.254902,.688373,.517374,.895694,.380392,.74891,.590906,.93976,.505882,.805017,.667956,.977626,.631373,.850914,.752618,.992396,.756863,.89724,.838454,.994093,.882353,.948461,.922603,.994449,1,1,1,.999967]},{ColorSpace:"Lab",Name:"erdc_magenta_BW",RGBPoints:[-1,0,0,254023e-10,-.87451,.128696,.0456782,.11635,-.74902,.228133,.0476299,.201452,-.623529,.327273,.0374065,.282107,-.498039,.420953,.0408166,.35709,-.372549,.511562,.0642203,.430511,-.247059,.599552,.102686,.504257,-.121569,.684646,.150536,.579429,.00392157,.765817,.205978,.656062,.129412,.839176,.27229,.731807,.254902,.89536,.357594,.797309,.380392,.930238,.457825,.846984,.505882,.945921,.564536,.880571,.631373,.948995,.670753,.902279,.756863,.947124,.772819,.918171,.882353,.947265,.869424,.934352,1,.954719,.95475,.954726]},{ColorSpace:"Lab",Name:"magenta",RGBPoints:[-1,0,0,0,-.87451,.364706,0,.152941,-.74902,.470588,0,.254902,-.623529,.572549,0,.34902,-.498039,.670588,0,.443137,-.372549,.772549,0,.537255,-.247059,.870588,0,.627451,-.121569,.964706,0,.717647,.00392157,1,.0784314,.772549,.129412,1,.207843,.858824,.254902,1,.32549,.941176,.380392,1,.45098,1,.505882,1,.560784,1,.631373,1,.662745,1,.756863,1,.760784,1,.882353,1,.870588,1,1,1,1,1]},{ColorSpace:"Lab",Name:"RED-PURPLE",RGBPoints:[-1,0,0,0,-.87451,.188235,0,.007843,-.74902,.345098,0,.035294,-.623529,.439216,0,.098039,-.498039,.533333,0,.152941,-.372549,.627451,.015686,.211765,-.247059,.721569,.031373,.266667,-.121569,.8,.047059,.329412,.00392157,.862745,.047059,.403922,.129412,.941176,.062745,.466667,.254902,.988235,.078431,.54902,.380392,.988235,.141176,.643137,.505882,.988235,.25098,.729412,.631373,.988235,.376471,.811765,.756863,.988235,.54902,.886275,.882353,.988235,.752941,.952941,1,.996078,.996078,.996078]},{ColorSpace:"Lab",Name:"erdc_red_BW",RGBPoints:[-1,0,0,0,-.87451,.147204,.0480135,.0401815,-.74902,.253411,.0617478,.0301333,-.623529,.356059,.0746331,.0446897,-.498039,.457731,.0934935,.0636931,-.372549,.557199,.122714,.0860013,-.247059,.665179,.144238,.105585,-.121569,.763833,.187056,.138326,.00392157,.847035,.254558,.189407,.129412,.905663,.345937,.258215,.254902,.941431,.447111,.346277,.380392,.962608,.546927,.457571,.505882,.987833,.637276,.569944,.631373,.994202,.732176,.687958,.756863,.993304,.826268,.800567,.882353,.994413,.917205,.906393,1,1,1,.999979]},{ColorSpace:"Lab",Name:"RED_TEMPERATURE",RGBPoints:[-1,0,0,0,-.87451,.090196,0,0,-.74902,.180392,0,0,-.623529,.270588,0,0,-.498039,.360784,0,0,-.372549,.45098,0,0,-.247059,.545098,0,0,-.121569,.635294,0,0,.00392157,.72549,.058824,0,.129412,.815686,.176471,0,.254902,.905882,.294118,0,.380392,1,.411765,0,.505882,1,.533333,.027451,.631373,1,.65098,.27451,.756863,1,.768627,.521569,.882353,1,.886275,.768627,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_orange_BW",RGBPoints:[-1,0,0,253806e-10,-.87451,.135871,.0593824,0,-.74902,.224328,.0907216,0,-.623529,.318083,.119647,0,-.498039,.414443,.150246,0,-.372549,.511077,.184884,0,-.247059,.605501,.226033,0,-.121569,.695274,.275491,0,.00392157,.777826,.334445,0,.129412,.851498,.402441,0,.254902,.915899,.47759,602975e-9,.380392,.971984,.557882,.0361443,.505882,1,.641287,.135967,.631373,1,.725198,.27997,.756863,1,.808205,.438135,.882353,1,.89306,.587036,1,1,.977928,.721599]},{ColorSpace:"Lab",Name:"heated_object",RGBPoints:[-1,0,0,0,-.87451,.34902,.0862745,0,-.74902,.45098,.172549,0,-.623529,.52549,.231373,0,-.498039,.580392,.278431,0,-.372549,.623529,.313725,0,-.247059,.670588,.352941,0,-.121569,.717647,.392157,0,.00392157,.772549,.439216,0,.129412,.839216,.494118,0,.254902,.901961,.541176,0,.380392,.968627,.6,0,.505882,1,.658824,0,.631373,1,.721569,0,.756863,1,.827451,.298039,.882353,1,.976471,.72549,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_gold_BW",RGBPoints:[-1,0,0,190933e-10,-.87451,.128363,.0636265,0,-.74902,.193795,.111057,0,-.623529,.25976,.15987,0,-.498039,.328546,.210589,0,-.372549,.399726,.26332,0,-.247059,.472969,.318261,0,-.121569,.546245,.375827,0,.00392157,.61745,.436719,0,.129412,.685545,.501113,0,.254902,.749578,.568799,0,.380392,.80962,.6394,0,.505882,.865572,.712699,.10257,.631373,.917709,.787569,.233665,.756863,.966914,.863138,.369608,.882353,1,.939405,.496104,1,.999225,1,.612275]},{ColorSpace:"Lab",Name:"erdc_brown_BW",RGBPoints:[-1,33216e-11,0,483629e-11,-.87451,.14693,.0518172,0,-.74902,.225806,.0814996,0,-.623529,.301681,.111452,0,-.498039,.370487,.150664,0,-.372549,.43108,.199477,0,-.247059,.4849,.255107,0,-.121569,.536798,.313486,0,.00392157,.59286,.371167,0,.129412,.653119,.428135,0,.254902,.714589,.485917,.0379541,.380392,.774667,.54565,.116634,.505882,.831222,.608047,.183895,.631373,.880305,.674199,.260298,.756863,.922314,.742472,.367086,.882353,.959408,.811222,.497258,1,.993548,.875183,.622093]},{ColorSpace:"Lab",Name:"copper_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0784314,.0501961,.0313725,-.74902,.156863,.100392,.0627451,-.623529,.235294,.150588,.0941176,-.498039,.313725,.200784,.12549,-.372549,.392157,.25098,.156863,-.247059,.470588,.301176,.188235,-.121569,.54902,.351373,.219608,.00392157,.627451,.401569,.25098,.129412,.705882,.451765,.282353,.254902,.784314,.501961,.313725,.380392,.862745,.552157,.345098,.505882,.941176,.602353,.376471,.631373,1,.652549,.407843,.756863,1,.702745,.439216,.882353,1,.752941,.470588,1,1,.8,.5]},{ColorSpace:"Lab",Name:"pink_Matlab",RGBPoints:[-1,0,0,0,-.87451,.312416,.204524,.204524,-.74902,.441822,.289241,.289241,-.623529,.54112,.354246,.354246,-.498039,.624831,.409048,.409048,-.372549,.698582,.45733,.45733,-.247059,.764404,.502282,.500979,-.121569,.791292,.591516,.54112,.00392157,.817297,.66895,.578481,.129412,.842499,.738308,.613572,.254902,.866968,.801687,.646762,.380392,.890766,.86041,.678329,.505882,.913944,.913944,.711254,.631373,.936549,.936549,.79459,.756863,.958621,.958621,.869979,.882353,.980196,.980196,.939336,1,1,1,1]},{ColorSpace:"Lab",Name:"bone_Matlab",RGBPoints:[-1,0,0,0,-.87451,.054902,.054902,.075817,-.74902,.109804,.109804,.151634,-.623529,.164706,.164706,.227451,-.498039,.219608,.219608,.303268,-.372549,.27451,.27451,.379085,-.247059,.329412,.329902,.454412,-.121569,.384314,.405719,.509314,.00392157,.439216,.481536,.564216,.129412,.494118,.557353,.619118,.254902,.54902,.63317,.67402,.380392,.603922,.708987,.728922,.505882,.660294,.783824,.783824,.631373,.746569,.838725,.838725,.756863,.832843,.893627,.893627,.882353,.919118,.948529,.948529,1,1,1,1]},{ColorSpace:"Lab",Name:"gray_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0627451,.0627451,.0627451,-.74902,.12549,.12549,.12549,-.623529,.188235,.188235,.188235,-.498039,.25098,.25098,.25098,-.372549,.313725,.313725,.313725,-.247059,.376471,.376471,.376471,-.121569,.439216,.439216,.439216,.00392157,.501961,.501961,.501961,.129412,.564706,.564706,.564706,.254902,.627451,.627451,.627451,.380392,.690196,.690196,.690196,.505882,.752941,.752941,.752941,.631373,.815686,.815686,.815686,.756863,.878431,.878431,.878431,.882353,.941176,.941176,.941176,1,1,1,1]},{ColorSpace:"Lab",Name:"Purples",RGBPoints:[-1,.247059,0,.490196,-.87451,.288397,.07677,.525629,-.74902,.32975,.153587,.561092,-.623529,.373057,.236263,.600461,-.498039,.416363,.319,.639923,-.372549,.459669,.405613,.685198,-.247059,.503345,.491534,.730058,-.121569,.562399,.54862,.757616,.00392157,.621453,.606075,.785544,.129412,.680508,.674971,.824914,.254902,.739562,.743406,.863899,.380392,.798616,.800492,.893426,.505882,.85684,.856655,.922491,.631373,.898178,.894056,.942176,.756863,.938654,.930919,.961646,.882353,.964245,.958478,.977393,1,.988235,.984314,.992157]},{ColorSpace:"Lab",Name:"Blues",RGBPoints:[-1,.031373,.188235,.419608,-.87451,.031373,.253195,.516063,-.74902,.031757,.318139,.612149,-.623529,.080969,.38113,.661361,-.498039,.130427,.444152,.710327,-.372549,.195386,.509112,.743791,-.247059,.260715,.573841,.777209,-.121569,.341423,.628958,.808704,.00392157,.422745,.684075,.839892,.129412,.523137,.739193,.861546,.254902,.622684,.793464,.883429,.380392,.701423,.826928,.910988,.505882,.778685,.8603,.937993,.631373,.825928,.891795,.953741,.756863,.87328,.923291,.969489,.882353,.922491,.954787,.985236,1,.968627,.984314,1]},{ColorSpace:"Lab",Name:"Greens",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546082,.271326,-.372549,.197232,.609073,.31857,-.247059,.257255,.671742,.365859,-.121569,.357647,.720953,.415071,.00392157,.45767,.769919,.465021,.129412,.546251,.811257,.537855,.254902,.634295,.852211,.610688,.380392,.709097,.883706,.683522,.505882,.78316,.914833,.755894,.631373,.842215,.938454,.818885,.756863,.899977,.961538,.880692,.882353,.935409,.975317,.92203,1,.968627,.988235,.960784]},{ColorSpace:"Lab",Name:"PuBu",RGBPoints:[-1,.301961,0,.294118,-.87451,.404321,.029527,.390573,-.74902,.50599,.059592,.486782,-.623529,.519769,.158016,.551742,-.498039,.533456,.256194,.616301,-.372549,.54133,.33887,.655671,-.247059,.54902,.421592,.695087,-.121569,.54902,.506236,.736424,.00392157,.550127,.590573,.777701,.129412,.585559,.665375,.81707,.254902,.622145,.739023,.855825,.380392,.687105,.784298,.879446,.505882,.752065,.829758,.903253,.631373,.817024,.87897,.930811,.756863,.880907,.927213,.957832,.882353,.926182,.958708,.975548,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"BuPu",RGBPoints:[-1,.007843,.219608,.345098,-.87451,.01178,.286536,.449427,-.74902,.015702,.35328,.553479,-.623529,.01767,.396586,.622376,-.498039,.021115,.4402,.690688,-.372549,.11757,.503191,.722184,-.247059,.214625,.565859,.753633,-.121569,.336671,.615071,.78316,.00392157,.457978,.663975,.812503,.129412,.556401,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821638,.903068,.631373,.873387,.864944,.92669,.756863,.927536,.907605,.949988,.882353,.964937,.9391,.967705,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGn",RGBPoints:[-1,.031373,.25098,.505882,-.87451,.031373,.329719,.590527,-.74902,.031911,.408397,.674787,-.623529,.100807,.479262,.710219,-.498039,.169704,.550219,.745744,-.372549,.238601,.62699,.787082,-.247059,.307958,.703114,.826759,-.121569,.39654,.752326,.797232,.00392157,.485121,.801046,.767705,.129412,.573702,.83451,.738178,.254902,.661592,.867743,.711034,.380392,.732457,.895302,.74253,.505882,.801845,.922307,.774579,.631373,.841215,.938055,.817885,.756863,.880907,.95391,.861084,.882353,.926182,.971626,.902422,1,.968627,.988235,.941176]},{ColorSpace:"Lab",Name:"GnBu",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546175,.272095,-.372549,.197232,.615071,.368551,-.247059,.256609,.683276,.464867,-.121569,.329443,.722645,.555417,.00392157,.403137,.762138,.645413,.129412,.503529,.805444,.718247,.254902,.603922,.848597,.790465,.380392,.704314,.887966,.847551,.505882,.802307,.926321,.903714,.631373,.851519,.944037,.941115,.756863,.899977,.961538,.976901,.882353,.935409,.975317,.984775,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"GnBuPu",RGBPoints:[-1,.003922,.27451,.211765,-.87451,.003922,.349312,.280661,-.74902,.003937,.423852,.349773,-.623529,.005905,.46519,.446228,-.498039,.009443,.506344,.542837,-.372549,.111803,.535871,.649135,-.247059,.214025,.565859,.753633,-.121569,.310481,.615071,.78316,.00392157,.407797,.663975,.812503,.129412,.531811,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821176,.902884,.631373,.873387,.854641,.922568,.756863,.927536,.888535,.942361,.882353,.964937,.929873,.964014,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGnYl",RGBPoints:[-1,.031373,.113725,.345098,-.87451,.088458,.159,.463206,-.74902,.145052,.204567,.5807,-.623529,.139146,.287243,.620069,-.498039,.13318,.370196,.659562,-.372549,.123337,.470588,.706805,-.247059,.115386,.570335,.753126,-.121569,.186251,.643168,.761,.00392157,.258716,.71514,.768074,.129412,.380761,.760415,.750358,.254902,.503576,.806075,.732795,.380392,.645306,.861192,.719016,.505882,.783899,.91511,.705606,.631373,.858701,.944637,.6997,.756863,.931349,.973303,.698424,.882353,.966782,.987082,.777163,1,1,1,.85098]},{ColorSpace:"Lab",Name:"PuRd",RGBPoints:[-1,.286275,0,.415686,-.87451,.38273,.001968,.441276,-.74902,.479231,.003922,.466774,-.623529,.581592,.003922,.480554,-.498039,.683799,.00549,.494887,-.372549,.776317,.105882,.544098,-.247059,.867866,.206321,.592618,-.121569,.919047,.308681,.612303,.00392157,.968812,.411226,.632603,.129412,.974717,.519493,.671972,.254902,.980546,.626451,.71065,.380392,.984483,.701253,.732303,.505882,.988328,.77504,.755617,.631373,.990296,.828189,.812703,.756863,.992372,.880907,.869035,.882353,.996309,.926182,.912341,1,1,.968627,.952941]},{ColorSpace:"Lab",Name:"RdPu",RGBPoints:[-1,.403922,0,.121569,-.87451,.500377,0,.192434,-.74902,.596909,277e-6,.263037,-.623529,.703206,.035709,.300438,-.498039,.808612,.071296,.338854,-.372549,.857824,.116571,.441215,-.247059,.905513,.163552,.54293,-.121569,.889765,.281661,.617732,.00392157,.873156,.39897,.691611,.129412,.82985,.491488,.736886,.254902,.789081,.583237,.781853,.380392,.810734,.656071,.819254,.505882,.833126,.729181,.85684,.631373,.870527,.80792,.898178,.756863,.907605,.884398,.938331,.882353,.9391,.921799,.958016,1,.968627,.956863,.976471]},{ColorSpace:"Lab",Name:"Oranges",RGBPoints:[-1,.498039,.152941,.015686,-.87451,.57481,.182468,.013718,-.74902,.651765,.212042,.011734,-.623529,.752157,.247474,.007797,-.498039,.851719,.283368,.004475,-.372549,.898962,.348328,.039908,-.247059,.945652,.413426,.076401,-.121569,.969273,.484291,.157109,.00392157,.992157,.554971,.238185,.129412,.992157,.619931,.330704,.254902,.992157,.684967,.423837,.380392,.992157,.751895,.532103,.505882,.992249,.817716,.639354,.631373,.994218,.861023,.725967,.756863,.996186,.903576,.810965,.882353,.998155,.933103,.868051,1,1,.960784,.921569]},{ColorSpace:"Lab",Name:"Reds",RGBPoints:[-1,.403922,0,.05098,-.87451,.525967,.029527,.066728,-.74902,.647643,.058962,.082476,-.623529,.722445,.076678,.098224,-.498039,.797186,.095194,.114187,-.372549,.868051,.164091,.143714,-.247059,.937809,.233541,.173933,-.121569,.96143,.326059,.232987,.00392157,.984375,.418147,.292657,.129412,.986344,.496886,.371396,.254902,.988235,.575702,.450673,.380392,.988235,.656409,.543191,.505882,.98842,.736747,.635894,.631373,.992357,.809581,.732349,.756863,.996186,.880692,.826759,.882353,.998155,.92203,.885813,1,1,.960784,.941176]},{ColorSpace:"Lab",Name:"RdOr",RGBPoints:[-1,.498039,0,0,-.87451,.6004,0,0,-.74902,.702514,738e-6,477e-6,-.623529,.773379,.095225,.061499,-.498039,.843875,.189865,.12283,-.372549,.891119,.294195,.203537,-.247059,.937855,.397924,.283137,-.121569,.963445,.476663,.316601,.00392157,.988297,.555771,.351665,.129412,.990265,.646321,.436309,.254902,.992157,.735256,.519646,.380392,.992157,.784468,.570827,.505882,.992249,.833218,.623483,.631373,.994218,.872587,.706159,.756863,.996186,.911419,.788189,.882353,.998155,.940946,.859054,1,1,.968627,.92549]},{ColorSpace:"Lab",Name:"BrOrYl",RGBPoints:[-1,.4,.145098,.023529,-.87451,.500392,.174625,.019592,-.74902,.600784,.204291,.015656,-.623529,.701176,.251534,.011719,-.498039,.800984,.299146,.008397,-.372549,.863975,.370012,.043829,-.247059,.926321,.441107,.0794,-.121569,.961753,.521815,.120738,.00392157,.996078,.602645,.163122,.129412,.996078,.68729,.237924,.254902,.996078,.771011,.314879,.380392,.996078,.832034,.444798,.505882,.996171,.892042,.572595,.631373,.998139,.931411,.65724,.756863,1,.969489,.741669,.882353,1,.985236,.822376,1,1,1,.898039]},{ColorSpace:"Lab",Name:"RdOrYl",RGBPoints:[-1,.501961,0,.14902,-.87451,.622038,0,.14902,-.74902,.741761,4e-4,.148866,-.623529,.816563,.05158,.129181,-.498039,.890965,.10356,.110235,-.372549,.940177,.205921,.137793,-.247059,.988281,.308789,.165536,-.121569,.99025,.432803,.200969,.00392157,.992218,.555217,.236278,.129412,.994187,.628051,.267774,.254902,.996078,.701038,.301269,.380392,.996078,.777809,.383945,.505882,.996171,.852826,.466621,.631373,.998139,.892195,.549296,.756863,1,.931349,.632188,.882353,1,.966782,.7188,1,1,1,.8]},{ColorSpace:"Lab",Name:"CIELab_blue2red",RGBPoints:[-1,0,.6,.74902,1,.76863,.46667,.34118]},{ColorSpace:"Lab",Name:"blue2yellow",RGBPoints:[-1,0,0,1,0,.5,.5,.5,1,1,1,0]},{ColorSpace:"Lab",Name:"erdc_blue2gold",RGBPoints:[-1,.175119,.0438468,1,-.874016,.22383,.159771,.94557,-.748031,.27254,.233611,.891216,-.622047,.321251,.296526,.836857,-.496063,.369962,.354296,.782359,-.370079,.418672,.409139,.72754,-.244094,.467383,.462152,.672148,-.11811,.51609,.51396,.615825,.00787402,.572863,.55452,.559172,.133858,.630269,.593822,.517729,.259843,.689588,.624668,.47446,.385827,.745394,.656113,.428638,.511811,.798624,.688104,.379105,.637795,.849926,.720593,.323834,.76378,.899765,.753543,.258657,.889764,.948487,.78692,.171778,1,.990413,.816451,.00729848]},{ColorSpace:"Lab",Name:"erdc_blue2yellow",RGBPoints:[-1,.0830122,0,.495617,-.87451,.141973,.0551288,.57363,-.74902,.193048,.110258,.604561,-.623529,.234231,.165386,.57643,-.498039,.275413,.220515,.548299,-.372549,.316596,.275644,.520169,-.247059,.357778,.330773,.492038,-.121569,.398961,.385901,.463908,.00392157,.449929,.438487,.426815,.129412,.511572,.488299,.379944,.254902,.581222,.53603,.325741,.380392,.650871,.583761,.271538,.505882,.720521,.631493,.217335,.631373,.79017,.679224,.163132,.756863,.85982,.726955,.108929,.882353,.910254,.774159,.14112,1,.927513,.81759,.306289]},{ColorSpace:"Lab",Name:"erdc_cyan2orange",RGBPoints:[-1,.0471513,.213874,.414329,-.87451,.0674702,.256648,.439027,-.74902,.0959957,.299331,.462089,-.623529,.132428,.341872,.483212,-.498039,.188743,.38277,.500597,-.372549,.268511,.420229,.512179,-.247059,.352945,.455602,.519101,-.121569,.43893,.489368,.521538,.00392157,.522445,.522495,.522436,.129412,.600089,.555682,.53205,.254902,.67988,.587981,.539163,.380392,.761011,.619586,.544439,.505882,.84278,.650741,.548567,.631373,.910713,.687347,.557822,.756863,.952232,.734972,.577775,.882353,.975642,.789858,.604868,1,.990752,.843643,.632857]},{ColorSpace:"Lab",Name:"erdc_purple2green",RGBPoints:[-1,.235006,.0483128,.530899,-.87451,.302968,.108419,.552391,-.74902,.360241,.166059,.569502,-.623529,.406746,.226782,.579373,-.498039,.444073,.28964,.582094,-.372549,.473648,.353774,.577947,-.247059,.497636,.418154,.567911,-.121569,.519086,.481741,.553968,.00392157,.542884,.542914,.542875,.129412,.566303,.603989,.527499,.254902,.595218,.662965,.516857,.380392,.628641,.720701,.510673,.505882,.665373,.777849,.508165,.631373,.704182,.834921,.508303,.756863,.743846,.892328,.50999,.882353,.783158,.950422,.512181,1,.818617,1,.513888]},{ColorSpace:"Lab",Name:"erdc_purple2green_dark",RGBPoints:[-1,.107656,0,.428682,-.87451,.1924,0,.449799,-.74902,.255118,.0648939,.466726,-.623529,.304256,.133066,.476703,-.498039,.343202,.19716,.479793,-.372549,.373876,.260353,.476241,-.247059,.398497,.322872,.466953,-.121569,.420016,.384252,.453785,.00392157,.44319,.443216,.443186,.129412,.465553,.502139,.428233,.254902,.492959,.559151,.417591,.380392,.524654,.615092,.411016,.505882,.55959,.670583,.40779,.631373,.596614,.726102,.406948,.756863,.634544,.782032,.407439,.882353,.672183,.838703,.408237,1,.706131,.892759,.408452]},{ColorSpace:"Lab",Name:"coolwarm",RGBPoints:[-1,.229806,.298718,.753683,-.875,.303869,.406535,.844959,-.75,.383013,.509419,.917388,-.625,.466667,.604563,.968155,-.5,.552953,.688929,.995376,-.375,.639176,.7596,.998151,-.25,.722193,.813953,.976575,-.125,.798692,.849786,.931689,0,.865395,.86541,.865396,.125,.924128,.827385,.774508,.25,.958853,.769768,.678008,.375,.969954,.694267,.579375,.5,.958003,.602842,.481776,.625,.923945,.497309,.38797,.75,.869187,.378313,.300267,.875,.795632,.241284,.220526,1,.705673,.0155562,.150233]},{ColorSpace:"Lab",Name:"BuRd",RGBPoints:[-1,.019608,.188235,.380392,-.87451,.088504,.321107,.564937,-.74902,.163399,.444983,.697501,-.623529,.247059,.555709,.754095,-.498039,.420684,.676432,.818685,-.372549,.606459,.789773,.880277,-.247059,.761476,.868512,.924567,-.121569,.878047,.925721,.951942,.00392157,.969089,.966474,.964937,.129412,.983852,.897578,.846828,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"Spectral_lowBlue",RGBPoints:[-1,.368627,.309804,.635294,-.87451,.260361,.450058,.70173,-.74902,.248058,.591311,.717186,-.623529,.376009,.734025,.658132,-.498039,.537947,.814764,.64506,-.372549,.702345,.879585,.636678,-.247059,.84752,.938639,.607151,-.121569,.940408,.976163,.656055,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.937793,.398539,.270127,.756863,.861515,.282891,.299654,.882353,.746482,.144637,.288812,1,.619608,.003922,.258824]},{ColorSpace:"Lab",Name:"GnRP",RGBPoints:[-1,0,.266667,.105882,-.87451,.066436,.394617,.174779,-.74902,.168858,.524567,.25767,-.623529,.323875,.657439,.361015,-.498039,.504883,.772318,.506344,-.372549,.678431,.870127,.654902,-.247059,.803922,.921799,.780392,-.121569,.897116,.951942,.882814,.00392157,.967397,.965936,.967474,.129412,.928028,.879815,.930565,.254902,.866052,.780777,.882891,.380392,.77501,.665129,.821376,.505882,.675663,.537024,.737024,.631373,.57847,.396155,.645982,.756863,.492349,.223914,.547559,.882353,.375548,.096886,.423299,1,.25098,0,.294118]},{ColorSpace:"Lab",Name:"GYPi",RGBPoints:[-1,.152941,.392157,.098039,-.87451,.246444,.505344,.117724,-.74902,.351942,.614533,.161399,-.623529,.474971,.717878,.240138,-.498039,.611995,.811226,.392849,-.372549,.746328,.893118,.565321,-.247059,.859516,.94233,.747405,-.121569,.928105,.96386,.875663,.00392157,.969089,.966859,.968012,.129412,.983852,.910265,.948328,.254902,.979239,.833218,.914648,.380392,.949712,.729873,.862976,.505882,.905652,.58293,.763552,.631373,.85521,.410073,.652211,.756863,.793695,.183699,.531642,.882353,.683737,.063899,.420761,1,.556863,.003922,.321569]},{ColorSpace:"Lab",Name:"GnYlRd",RGBPoints:[-1,0,.407843,.215686,-.87451,.063975,.525952,.277201,-.74902,.177932,.633064,.332718,-.623529,.364937,.724106,.379469,-.498039,.527951,.797155,.40223,-.372549,.678431,.862822,.433449,-.247059,.803922,.916955,.514648,-.121569,.909419,.961861,.625067,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.939023,.389927,.245521,.756863,.867666,.239831,.176624,.882353,.762399,.110727,.151326,1,.647059,0,.14902]},{ColorSpace:"Lab",Name:"GBBr",RGBPoints:[-1,0,.235294,.188235,-.87451,.002461,.338639,.301423,-.74902,.055902,.448981,.417609,-.623529,.183852,.56955,.538178,-.498039,.357785,.700115,.660746,-.372549,.540177,.819531,.77624,-.247059,.714879,.890888,.864821,-.121569,.851134,.934564,.922645,.00392157,.960861,.959785,.95694,.129412,.963322,.927797,.83391,.254902,.939946,.868897,.68935,.380392,.883353,.775394,.517109,.505882,.808074,.625836,.324106,.631373,.717647,.476355,.15494,.756863,.592157,.358247,.06882,.882353,.458593,.26436,.031142,1,.329412,.188235,.019608]},{ColorSpace:"Lab",Name:"PuOr",RGBPoints:[-1,.498039,.231373,.031373,-.87451,.62599,.30273,.026451,-.74902,.746943,.387082,.037524,-.623529,.85767,.490427,.071972,-.498039,.936409,.617762,.236371,-.372549,.992695,.743099,.43291,-.247059,.995156,.841523,.63714,-.121569,.985313,.913802,.813687,.00392157,.966244,.966398,.967705,.129412,.889965,.89504,.938178,.254902,.806151,.804306,.894656,.380392,.712649,.688658,.833141,.505882,.594233,.554325,.744637,.631373,.474894,.404229,.652364,.756863,.366628,.217224,.563783,.882353,.266436,.089965,.434833,1,.176471,0,.294118]},{ColorSpace:"Lab",Name:"PRGn",RGBPoints:[-1,.25098,0,.294118,-.87451,.383852,.103345,.431911,-.74902,.497732,.234679,.55371,-.623529,.583852,.40692,.652134,-.498039,.681968,.545175,.742561,-.372549,.7807,.672357,.825221,-.247059,.871742,.788005,.886736,-.121569,.930488,.885198,.932872,.00392157,.966321,.968089,.965859,.129412,.892503,.950865,.877278,.254902,.796078,.91857,.772549,.380392,.670588,.866897,.647059,.505882,.493195,.765398,.496655,.631373,.314187,.649135,.354556,.756863,.15917,.516263,.251211,.882353,.062284,.386621,.170473,1,0,.266667,.105882]},{ColorSpace:"Lab",Name:"PiYG",RGBPoints:[-1,.556863,.003922,.321569,-.87451,.692195,.067897,.427374,-.74902,.797539,.197847,.539177,-.623529,.859054,.424221,.659746,-.498039,.908574,.592618,.770319,-.372549,.951557,.736332,.866205,-.247059,.981084,.839677,.917878,-.121569,.98293,.913802,.949558,.00392157,.96732,.968474,.965629,.129412,.92549,.963552,.869666,.254902,.852441,.939254,.736025,.380392,.739254,.890042,.553941,.505882,.60323,.805536,.382238,.631373,.467282,.711419,.235217,.756863,.344252,.608074,.156478,.882353,.2406,.49827,.116494,1,.152941,.392157,.098039]},{ColorSpace:"Lab",Name:"OrPu",RGBPoints:[-1,.176471,0,.294118,-.87451,.272434,.095963,.444214,-.74902,.373395,.228912,.56932,-.623529,.481661,.415917,.657901,-.498039,.601922,.562937,.750481,-.372549,.718493,.695886,.836986,-.247059,.811995,.811534,.898501,-.121569,.894733,.8995,.940023,.00392157,.969166,.966859,.963629,.129412,.98639,.910265,.803691,.254902,.995002,.835371,.624375,.380392,.992541,.736947,.420146,.505882,.931949,.609458,.224221,.631373,.85075,.483968,.069819,.756863,.740023,.380623,.035371,.882353,.617993,.29827,.026759,1,.498039,.231373,.031373]},{ColorSpace:"Lab",Name:"BrBG",RGBPoints:[-1,.329412,.188235,.019608,-.87451,.467205,.269435,.031911,-.74902,.6,.365629,.074202,-.623529,.72549,.483737,.160323,-.498039,.812995,.635832,.336409,-.372549,.88689,.781238,.527874,-.247059,.943483,.87474,.700115,-.121569,.963168,.929796,.841599,.00392157,.957247,.959938,.959554,.129412,.84406,.932872,.920185,.254902,.70396,.886428,.859285,.380392,.529258,.815071,.770704,.505882,.346251,.691811,.653057,.631373,.175855,.562015,.530642,.756863,.047905,.441446,.410073,.882353,.002307,.33218,.294348,1,0,.235294,.188235]},{ColorSpace:"Lab",Name:"GyRd",RGBPoints:[-1,.101961,.101961,.101961,-.87451,.227451,.227451,.227451,-.74902,.359939,.359939,.359939,-.623529,.502653,.502653,.502653,-.498039,.631373,.631373,.631373,-.372549,.749865,.749865,.749865,-.247059,.843368,.843368,.843368,-.121569,.926105,.926105,.926105,.00392157,.999846,.997232,.995694,.129412,.994925,.908651,.857901,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen",RGBPoints:[-1,.297553,0,.489074,-.87451,.40259,.151146,.567754,-.74902,.516038,.284843,.658231,-.623529,.629783,.423646,.750938,-.498039,.735198,.563697,.835956,-.372549,.82408,.695541,.903582,-.247059,.889091,.807454,.944862,-.121569,.92334,.886917,.951839,.00392157,.921045,.921084,.921003,.129412,.877324,.907455,.845381,.254902,.797649,.849713,.734695,.380392,.691646,.75964,.600532,.505882,.568981,.649159,.453807,.631373,.438945,.529756,.304259,.756863,.30973,.412001,.158303,.882353,.187078,.305111,.00251458,1,.101655,.220836,0]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen_dim",RGBPoints:[-1,.404088,.131038,.592767,-.87451,.486469,.230957,.651243,-.74902,.575165,.339335,.717723,-.623529,.662741,.454332,.784263,-.498039,.742071,.570213,.842918,-.372549,.806935,.678992,.886227,-.247059,.852219,.771315,.90763,-.121569,.873345,.837327,.901572,.00392157,.866783,.86682,.866745,.129412,.82839,.858225,.796812,.254902,.762578,.814287,.700202,.380392,.676429,.744229,.585735,.505882,.577033,.65732,.461526,.631373,.47128,.562476,.33476,.756863,.365461,.467957,.21076,.882353,.264758,.381138,.0878313,1,.182591,.312249,0]},{ColorSpace:"Lab",Name:"erdc_divLow_icePeach",RGBPoints:[-1,.480048,.817441,.998056,-.87451,.425898,.726921,.883187,-.74902,.366682,.629445,.761936,-.623529,.308756,.531002,.640217,-.498039,.258021,.43705,.523433,-.372549,.219244,.352381,.416348,-.247059,.195127,.281032,.322979,-.121569,.186286,.22627,.246525,.00392157,.192352,.19236,.192364,.129412,.255927,.214469,.191756,.254902,.340459,.254426,.206666,.380392,.444655,.309315,.234029,.505882,.565353,.376004,.270969,.631373,.697917,.450748,.314293,.756863,.836657,.529064,.360227,.882353,.972695,.614884,.413123,1,1,.705904,.472699]},{ColorSpace:"Lab",Name:"erdc_divLow_purpleGreen",RGBPoints:[-1,.956034,.666487,.952663,-.87451,.874457,.572698,.936352,-.74902,.753465,.488253,.909063,-.623529,.63309,.413507,.763833,-.498039,.514491,.345878,.620015,-.372549,.405008,.288141,.484376,-.247059,.311388,.241986,.363556,-.121569,.238722,.209044,.263449,.00392157,.192352,.192366,.192362,.129412,.200379,.233201,.168618,.254902,.230151,.291737,.165227,.380392,.279481,.366076,.178607,.505882,.344927,.453267,.205703,.631373,.421554,.549449,.242643,.756863,.503334,.649999,.284377,.882353,.583497,.749672,.324969,1,.650705,.837228,.356264]},{ColorSpace:"Lab",Name:"Haze_green",RGBPoints:[-1,1,.835294,.886275,-.87451,.937255,.756863,.870443,-.74902,.875817,.666376,.857807,-.623529,.778359,.583007,.808134,-.498039,.676253,.494118,.745098,-.372549,.561365,.390123,.682353,-.247059,.438344,.262745,.621496,-.121569,.321133,.141031,.558751,.00392157,.203922,.0217865,.495861,.129412,.265505,.129412,.433261,.254902,.311692,.255338,.37008,.380392,.356282,.377342,.310821,.505882,.39971,.488889,.258243,.631373,.442556,.604357,.205519,.756863,.48671,.71968,.152941,.882353,.529847,.830356,.100944,1,.572549,.933333,.054902]},{ColorSpace:"Lab",Name:"Haze_lime",RGBPoints:[-1,.704034,.784196,1,-.87451,.633111,.691418,.956078,-.74902,.564021,.600606,.912157,-.623529,.496827,.51189,.868235,-.498039,.43157,.425416,.824314,-.372549,.368248,.341347,.780392,-.247059,.306767,.259855,.736471,-.121569,.246862,.181069,.692549,.00392157,.191619,.109542,.648627,.129412,.257404,.194031,.604706,.254902,.321794,.278775,.560784,.380392,.387909,.364617,.516863,.505882,.456569,.451881,.472941,.631373,.527424,.540773,.42902,.756863,.599759,.631427,.385098,.882353,.673065,.723898,.341176,1,.742751,.812252,.3]},{ColorSpace:"RGB",Name:"Haze",RGBPoints:[-1,1,.835294,.996078,-.00392157,.023529,.141176,.498039,.00392157,.015686,.137255,.494118,1,.984314,.764706,0]},{ColorSpace:"Lab",Name:"Haze_cyan",RGBPoints:[-1,.956863,1,.835294,-.87451,.933188,.921714,.760784,-.74902,.870588,.803486,.671605,-.623529,.807843,.684096,.583297,-.498039,.745098,.569208,.494118,-.372549,.682353,.437763,.390123,-.247059,.621496,.288163,.262745,-.121569,.558751,.144517,.141031,.00392157,.495861,.0217865,.0413943,.129412,.433261,.137255,.129412,.254902,.37008,.263181,.255338,.380392,.306318,.381845,.372694,.505882,.243137,.503994,.494263,.631373,.180392,.629484,.619753,.756863,.117647,.754975,.747131,.882353,.054902,.876398,.866812,1,0,.988235,.976471]},{ColorSpace:"Lab",Name:"nic_Edge",RGBPoints:[-1,.191208,.191208,.191208,-.87451,.239484,.00545035,.614821,-.74902,.220593,.0617459,.863547,-.623529,.17509,.278988,.97794,-.498039,.143526,.576069,.998553,-.372549,.166456,.871883,.96594,-.247059,.376202,.993555,.981833,-.121569,.681996,.991297,.999239,.00392157,.954172,.952734,.94374,.129412,.999735,.99301,.662896,.254902,.979399,.991466,.357973,.380392,.968771,.854967,.162659,.505882,.999245,.556697,.144323,.631373,.973959,.26223,.177946,.756863,.852358,.0526707,.222974,.882353,.593889,.00912724,.238855,1,.191208,.191208,.191208]},{ColorSpace:"Lab",Name:"erdc_iceFire_H",RGBPoints:[-1,405432e-12,0,590122e-11,-.87451,0,.120401,.302675,-.74902,0,.216583,.524574,-.623529,.0552475,.345025,.6595,-.498039,.128047,.492588,.720288,-.372549,.188955,.641309,.792092,-.247059,.327673,.784935,.873434,-.121569,.60824,.892164,.935547,.00392157,.881371,.912178,.818099,.129412,.951407,.835621,.449279,.254902,.904481,.690489,0,.380392,.85407,.510864,0,.505882,.777093,.33018,88199e-8,.631373,.672862,.139087,.00269398,.756863,.508815,0,0,.882353,.299417,366289e-9,547829e-9,1,.0157519,.00332021,455569e-13]},{ColorSpace:"Lab",Name:"erdc_iceFire_L",RGBPoints:[-1,.870485,.913768,.832905,-.87451,.586919,.887865,.934003,-.74902,.31583,.776442,.867858,-.623529,.18302,.632034,.787722,-.498039,.117909,.484134,.713825,-.372549,.0507239,.335979,.654741,-.247059,0,.209874,.511832,-.121569,0,.114689,.28935,.00392157,.0157519,.00332021,455569e-13,.129412,.312914,0,0,.254902,.520865,0,0,.380392,.680105,.15255,.0025996,.505882,.785109,.339479,797922e-9,.631373,.857354,.522494,0,.756863,.910974,.699774,0,.882353,.951921,.842817,.478545,1,.881371,.912178,.818099]},{ColorSpace:"RGB",Name:"hsv",RGBPoints:[-1,1,0,0,-.666666,1,0,1,-.333333,0,0,1,0,0,1,1,.33333,0,1,0,.66666,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"hue_L60",RGBPoints:[-1,.964784,.400592,.349549,-.87451,.964915,.372498,.53785,-.74902,.892353,.401039,.759569,-.623529,.79263,.446956,.903017,-.498039,.682208,.49954,.966673,-.372549,.56392,.553082,.968836,-.247059,.442031,.606396,.901601,-.121569,.305499,.65701,.765784,.00392157,.197251,.687914,.620914,.129412,.193882,.701887,.472654,.254902,.249866,.706123,.320005,.380392,.35132,.697417,.202919,.505882,.498097,.669467,.125232,.631373,.637477,.626239,.107431,.756863,.762115,.56872,.155812,.882353,.889434,.481116,.240445,1,.964784,.400592,.349549]},{IndexedColors:[0,0,0,.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,.6509803921568628,.3372549019607843,.1568627450980392],Name:"Spectrum",NanColor:[.6509803921568628,.3372549019607843,.1568627450980392]},{IndexedColors:[.4745098039215686,.09019607843137255,.09019607843137255,.7098039215686275,.00392156862745098,.00392156862745098,.9372549019607843,.2784313725490196,.09803921568627451,.9764705882352941,.5137254901960784,.1411764705882353,1,.7058823529411765,0,1,.8980392156862745,.02352941176470588],Name:"Warm",NanColor:[1,.8980392156862745,.02352941176470588]},{IndexedColors:[.4588235294117647,.6941176470588235,.00392156862745098,.3450980392156863,.5019607843137255,.1607843137254902,.3137254901960784,.8431372549019608,.7490196078431373,.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.6039215686274509,.407843137254902,1,.3725490196078431,.2,.5019607843137255],Name:"Cool",NanColor:[.3725490196078431,.2,.5019607843137255]},{IndexedColors:[.2313725490196079,.407843137254902,.6705882352941176,.1098039215686274,.5843137254901961,.803921568627451,.3058823529411765,.8509803921568627,.9176470588235294,.4509803921568628,.6039215686274509,.8352941176470589,.2588235294117647,.2392156862745098,.6627450980392157,.3137254901960784,.3294117647058823,.5294117647058824,.06274509803921569,.1647058823529412,.3215686274509804],Name:"Blues",NanColor:[.06274509803921569,.1647058823529412,.3215686274509804]},{IndexedColors:[.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.4,.2431372549019608,.7176470588235294,.6352941176470588,.3294117647058823,.8117647058823529,.8705882352941177,.3803921568627451,.807843137254902,.8627450980392157,.3803921568627451,.5843137254901961,.2392156862745098,.06274509803921569,.3215686274509804],Name:"Wild Flower",NanColor:[.2392156862745098,.06274509803921569,.3215686274509804]},{IndexedColors:[.396078431372549,.4862745098039216,.2156862745098039,.4588235294117647,.6941176470588235,.00392156862745098,.6980392156862745,.7294117647058823,.1882352941176471,1,.8980392156862745,.02352941176470588,1,.7058823529411765,0,.9764705882352941,.5137254901960784,.1411764705882353],Name:"Citrus",NanColor:[.9764705882352941,.5137254901960784,.1411764705882353]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (11)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (10)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (9)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (8)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (7)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (6)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.9686274509803922,.9686274509803922,.9686274509803922,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (5)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (4)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9450980392156862,.6392156862745098,.2509803921568627,.9686274509803922,.9686274509803922,.9686274509803922,.6,.5568627450980392,.7647058823529411],Name:"Brewer Diverging Purple-Orange (3)",NanColor:[.6,.5568627450980392,.7647058823529411]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (11)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (10)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (9)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (8)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (7)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (6)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,1,1,.7490196078431373,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (5)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (4)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.9882352941176471,.5529411764705883,.3490196078431372,1,1,.7490196078431373,.6,.8352941176470589,.5803921568627451],Name:"Brewer Diverging Spectral (3)",NanColor:[.6,.8352941176470589,.5803921568627451]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (11)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (10)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (9)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (8)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (7)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (6)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.9607843137254902,.9607843137254902,.9607843137254902,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (5)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (4)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.8470588235294118,.7019607843137254,.396078431372549,.9607843137254902,.9607843137254902,.9607843137254902,.3529411764705883,.7058823529411765,.6745098039215687],Name:"Brewer Diverging Brown-Blue-Green (3)",NanColor:[.3529411764705883,.7058823529411765,.6745098039215687]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.4274509803921568,.1725490196078431,0,.2666666666666667,.1058823529411765],Name:"Brewer Sequential Blue-Green (9)",NanColor:[0,.2666666666666667,.1058823529411765]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (8)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.8,.9254901960784314,.9019607843137255,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (7)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (6)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (5)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1372549019607843,.5450980392156862,.2705882352941176],Name:"Brewer Sequential Blue-Green (4)",NanColor:[.1372549019607843,.5450980392156862,.2705882352941176]},{IndexedColors:[.8980392156862745,.9607843137254902,.9764705882352941,.6,.8470588235294118,.788235294117647,.1725490196078431,.6352941176470588,.3725490196078431],Name:"Brewer Sequential Blue-Green (3)",NanColor:[.1725490196078431,.6352941176470588,.3725490196078431]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.6,.203921568627451,.01568627450980392,.4,.1450980392156863,.02352941176470588],Name:"Brewer Sequential Yellow-Orange-Brown (9)",NanColor:[.4,.1450980392156863,.02352941176470588]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (8)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (7)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (6)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (5)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8,.2980392156862745,.00784313725490196],Name:"Brewer Sequential Yellow-Orange-Brown (4)",NanColor:[.8,.2980392156862745,.00784313725490196]},{IndexedColors:[1,.9686274509803922,.7372549019607844,.996078431372549,.7686274509803922,.3098039215686275,.8509803921568627,.3725490196078431,.05490196078431372],Name:"Brewer Sequential Yellow-Orange-Brown (3)",NanColor:[.8509803921568627,.3725490196078431,.05490196078431372]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.5058823529411764,.05882352941176471,.4862745098039216,.3019607843137255,0,.2941176470588235],Name:"Brewer Sequential Blue-Purple (9)",NanColor:[.3019607843137255,0,.2941176470588235]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (8)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (7)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (6)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (5)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.2549019607843137,.615686274509804],Name:"Brewer Sequential Blue-Purple (4)",NanColor:[.5333333333333333,.2549019607843137,.615686274509804]},{IndexedColors:[.8784313725490196,.9254901960784314,.9568627450980393,.6196078431372549,.7372549019607844,.8549019607843137,.5333333333333333,.3372549019607843,.6549019607843137],Name:"Brewer Sequential Blue-Purple (3)",NanColor:[.5333333333333333,.3372549019607843,.6549019607843137]},{IndexedColors:[.4980392156862745,.788235294117647,.4980392156862745,.7450980392156863,.6823529411764706,.8313725490196079,.9921568627450981,.7529411764705882,.5254901960784314,1,1,.6,.2196078431372549,.4235294117647059,.6901960784313725,.9411764705882353,.00784313725490196,.4980392156862745,.7490196078431373,.3568627450980392,.09019607843137255,.4,.4,.4],Name:"Brewer Qualitative Accent",NanColor:[.4,.4,.4]},{IndexedColors:[.1058823529411765,.6196078431372549,.4666666666666667,.8509803921568627,.3725490196078431,.00784313725490196,.4588235294117647,.4392156862745098,.7019607843137254,.9058823529411765,.1607843137254902,.5411764705882353,.4,.6509803921568628,.1176470588235294,.9019607843137255,.6705882352941176,.00784313725490196,.6509803921568628,.4627450980392157,.1137254901960784,.4,.4,.4],Name:"Brewer Qualitative Dark2",NanColor:[.4,.4,.4]},{IndexedColors:[.4,.7607843137254902,.6470588235294118,.9882352941176471,.5529411764705883,.3843137254901961,.5529411764705883,.6274509803921569,.796078431372549,.9058823529411765,.5411764705882353,.7647058823529411,.6509803921568628,.8470588235294118,.3294117647058823,1,.8509803921568627,.1843137254901961,.8980392156862745,.7686274509803922,.5803921568627451,.7019607843137254,.7019607843137254,.7019607843137254],Name:"Brewer Qualitative Set2",NanColor:[.7019607843137254,.7019607843137254,.7019607843137254]},{IndexedColors:[.7019607843137254,.8862745098039215,.803921568627451,.9921568627450981,.803921568627451,.6745098039215687,.796078431372549,.8352941176470589,.9098039215686274,.9568627450980393,.792156862745098,.8941176470588236,.9019607843137255,.9607843137254902,.788235294117647,1,.9490196078431372,.6823529411764706,.9450980392156862,.8862745098039215,.8,.8,.8,.8],Name:"Brewer Qualitative Pastel2",NanColor:[.8,.8,.8]},{IndexedColors:[.984313725490196,.7058823529411765,.6823529411764706,.7019607843137254,.803921568627451,.8901960784313725,.8,.9215686274509803,.7725490196078432,.8705882352941177,.796078431372549,.8941176470588236,.996078431372549,.8509803921568627,.6509803921568628,1,1,.8,.8980392156862745,.8470588235294118,.7411764705882353,.9921568627450981,.8549019607843137,.9254901960784314,.9490196078431372,.9490196078431372,.9490196078431372],Name:"Brewer Qualitative Pastel1",NanColor:[.9490196078431372,.9490196078431372,.9490196078431372]},{IndexedColors:[.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,1,1,.2,.6509803921568628,.3372549019607843,.1568627450980392,.9686274509803922,.5058823529411764,.7490196078431373,.6,.6,.6],Name:"Brewer Qualitative Set1",NanColor:[.6,.6,.6]},{IndexedColors:[.6509803921568628,.807843137254902,.8901960784313725,.1215686274509804,.4705882352941176,.7058823529411765,.6980392156862745,.8745098039215686,.5411764705882353,.2,.6274509803921569,.1725490196078431,.984313725490196,.6039215686274509,.6,.8901960784313725,.1019607843137255,.1098039215686274,.9921568627450981,.7490196078431373,.4352941176470588,1,.4980392156862745,0,.792156862745098,.6980392156862745,.8392156862745098,.4156862745098039,.2392156862745098,.6039215686274509,1,1,.6],Name:"Brewer Qualitative Paired",NanColor:[1,1,.6]},{IndexedColors:[.5529411764705883,.8274509803921568,.7803921568627451,1,1,.7019607843137254,.7450980392156863,.7294117647058823,.8549019607843137,.984313725490196,.5019607843137255,.4470588235294118,.5019607843137255,.6941176470588235,.8274509803921568,.9921568627450981,.7058823529411765,.3843137254901961,.7019607843137254,.8705882352941177,.4117647058823529,.9882352941176471,.803921568627451,.8980392156862745,.8509803921568627,.8509803921568627,.8509803921568627,.7372549019607844,.5019607843137255,.7411764705882353,.8,.9215686274509803,.7725490196078432,1,.9294117647058824,.4352941176470588],Name:"Brewer Qualitative Set3",NanColor:[1,.9294117647058824,.4352941176470588]},{IndexedColors:[1,0,0,1,.862745,0,0,.695201,0],Name:"Traffic Lights",NanColor:[.803922,0,.803922]},{IndexedColors:[.908659,.604013,.581857,1,.862745,0,0,.695201,0],Name:"Traffic Lights For Deuteranopes",NanColor:[.803922,0,.803922]},{IndexedColors:[.4196078431372549,0,.07058823529411765,.9019607843137255,.9411764705882353,.0196078431372549,.01568627450980392,.6196078431372549,.00784313725490196],Name:"Traffic Lights For Deuteranopes 2",NanColor:[.803922,0,.803922]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Muted Blue-Green",NanColor:[.25,0,0],RGBPoints:[0,.109804,.27451,.301961,.02,.129412,.309804,.341176,.05,.14902,.341176,.380392,.1,.188235,.403922,.458824,.15,.227451,.447059,.521569,.2,.290196,.494118,.588235,.25,.368627,.552941,.670588,.3,.458824,.619608,.74902,.35,.588235,.713725,.85098,.4,.72549,.815686,.941176,.45,.831373,.882353,.980392,.475,.909804,.933333,1,.5,.980392,.984314,1,.5,.996078,1,.94902,.5,1,1,.980392,.5,.980392,.984314,1,.525,.972549,.988235,.890196,.55,.917647,.960784,.835294,.6,.835294,.921569,.772549,.65,.768627,.901961,.737255,.7,.670588,.831373,.654902,.75,.576471,.760784,.584314,.8,.498039,.678431,.521569,.85,.392157,.560784,.427451,.9,.294118,.45098,.333333,.95,.211765,.34902,.254902,1,.152941,.278431,.196078]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Green-Blue Asymmetric Divergent (62Blbc)",NanColor:[.25,0,0],RGBPoints:[0,.121569,.2,.145098,.05,.196078,.301961,.223529,.1,.258824,.4,.278431,.2,.341176,.54902,.341176,.25,.419608,.619608,.376471,.3,.545098,.701961,.392157,.35,.643137,.780392,.403922,.4,.729412,.819608,.45098,.45,.811765,.870588,.521569,.5,.898039,.909804,.564706,.55,.941176,.92549,.686275,.6,.960784,.94902,.776471,.64,1,1,1,.65,.890196,.988235,.972549,.7,.721569,.894118,.901961,.75,.631373,.823529,.839216,.8,.517647,.662745,.701961,.85,.384314,.494118,.54902,.9,.298039,.360784,.45098,.95,.223529,.25098,.34902,.99,.156863,.172549,.25098,1,.137255,.137255,.188235]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Asymmtrical Earth Tones (6_21b)",NanColor:[.25,0,0],RGBPoints:[0,.141176,.14902,.2,.05,.215686,.258824,.321569,.1,.243137,.368627,.380392,.15,.27451,.439216,.4,.2,.32549,.501961,.384314,.25,.403922,.6,.419608,.3,.486275,.701961,.454902,.35,.556863,.74902,.494118,.4,.670588,.8,.545098,.5,.854902,.901961,.631373,.55,.92549,.941176,.694118,.6,.960784,.94902,.776471,.65,.988235,.968627,.909804,.7,.839216,.815686,.772549,.75,.701961,.662745,.615686,.8,.6,.529412,.478431,.85,.501961,.403922,.360784,.9,.439216,.313725,.290196,1,.301961,.164706,.176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Yellow 15",NanColor:[.25,0,0],RGBPoints:[0,1,1,.988235,.002,1,1,.988235,.05,.984314,.988235,.843137,.1,.988235,.988235,.741176,.15,.980392,.968627,.654902,.2,.980392,.945098,.576471,.25,.968627,.905882,.486275,.3,.968627,.862745,.388235,.35,.960784,.803922,.286275,.4,.94902,.741176,.219608,.45,.941176,.678431,.14902,.5,.929412,.607843,.094118,.55,.921569,.545098,.054902,.6,.909804,.486275,.035294,.65,.890196,.411765,.019608,.7,.8,.305882,0,.75,.760784,.239216,0,.8,.678431,.180392,.011765,.85,.6,.121569,.023529,.9,.501961,.054902,.031373,.95,.4,.039216,.058824,1,.301961,.047059,.090196]},{ColorSpace:"Diverging",Name:"Magma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002258,.001295,.018331,.007843,.003279,.002305,.023708,.011765,.004512,.00349,.029965,.015686,.00595,.004843,.03713,.019608,.007588,.006356,.044973,.023529,.009426,.008022,.052844,.027451,.011465,.009828,.06075,.031373,.013708,.011771,.068667,.035294,.016156,.01384,.076603,.039216,.018815,.016026,.084584,.043137,.021692,.01832,.09261,.047059,.024792,.020715,.100676,.05098,.028123,.023201,.108787,.054902,.031696,.025765,.116965,.058824,.03552,.028397,.125209,.062745,.039608,.03109,.133515,.066667,.04383,.03383,.141886,.070588,.048062,.036607,.150327,.07451,.05232,.039407,.158841,.078431,.056615,.04216,.167446,.082353,.060949,.044794,.176129,.086275,.06533,.047318,.184892,.090196,.069764,.049726,.193735,.094118,.074257,.052017,.20266,.098039,.078815,.054184,.211667,.101961,.083446,.056225,.220755,.105882,.088155,.058133,.229922,.109804,.092949,.059904,.239164,.113725,.097833,.061531,.248477,.117647,.102815,.06301,.257854,.121569,.107899,.064335,.267289,.12549,.113094,.065492,.276784,.129412,.118405,.066479,.286321,.133333,.123833,.067295,.295879,.137255,.12938,.067935,.305443,.141176,.135053,.068391,.315,.145098,.140858,.068654,.324538,.14902,.146785,.068738,.334011,.152941,.152839,.068637,.343404,.156863,.159018,.068354,.352688,.160784,.165308,.067911,.361816,.164706,.171713,.067305,.370771,.168627,.178212,.066576,.379497,.172549,.184801,.065732,.387973,.176471,.19146,.064818,.396152,.180392,.198177,.063862,.404009,.184314,.204935,.062907,.411514,.188235,.211718,.061992,.418647,.192157,.218512,.061158,.425392,.196078,.225302,.060445,.431742,.2,.232077,.059889,.437695,.203922,.238826,.059517,.443256,.207843,.245543,.059352,.448436,.211765,.25222,.059415,.453248,.215686,.258857,.059706,.45771,.219608,.265447,.060237,.46184,.223529,.271994,.060994,.46566,.227451,.278493,.061978,.46919,.231373,.284951,.063168,.472451,.235294,.291366,.064553,.475462,.239216,.29774,.066117,.478243,.243137,.304081,.067835,.480812,.247059,.310382,.069702,.483186,.25098,.316654,.07169,.48538,.254902,.322899,.073782,.487408,.258824,.329114,.075972,.489287,.262745,.335308,.078236,.491024,.266667,.341482,.080564,.492631,.270588,.347636,.082946,.494121,.27451,.353773,.085373,.495501,.278431,.359898,.087831,.496778,.282353,.366012,.090314,.49796,.286275,.372116,.092816,.499053,.290196,.378211,.095332,.500067,.294118,.384299,.097855,.501002,.298039,.390384,.100379,.501864,.301961,.396467,.102902,.502658,.305882,.402548,.10542,.503386,.309804,.408629,.10793,.504052,.313725,.414709,.110431,.504662,.317647,.420791,.11292,.505215,.321569,.426877,.115395,.505714,.32549,.432967,.117855,.50616,.329412,.439062,.120298,.506555,.333333,.445163,.122724,.506901,.337255,.451271,.125132,.507198,.341176,.457386,.127522,.507448,.345098,.463508,.129893,.507652,.34902,.46964,.132245,.507809,.352941,.47578,.134577,.507921,.356863,.481929,.136891,.507989,.360784,.488088,.139186,.508011,.364706,.494258,.141462,.507988,.368627,.500438,.143719,.50792,.372549,.506629,.145958,.507806,.376471,.512831,.148179,.507648,.380392,.519045,.150383,.507443,.384314,.52527,.152569,.507192,.388235,.531507,.154739,.506895,.392157,.537755,.156894,.506551,.396078,.544015,.159033,.506159,.4,.550287,.161158,.505719,.403922,.556571,.163269,.50523,.407843,.562866,.165368,.504692,.411765,.569172,.167454,.504105,.415686,.57549,.16953,.503466,.419608,.581819,.171596,.502777,.423529,.588158,.173652,.502035,.427451,.594508,.175701,.501241,.431373,.600868,.177743,.500394,.435294,.607238,.179779,.499492,.439216,.613617,.181811,.498536,.443137,.620005,.18384,.497524,.447059,.626401,.185867,.496456,.45098,.632805,.187893,.495332,.454902,.639216,.189921,.49415,.458824,.645633,.191952,.49291,.462745,.652056,.193986,.491611,.466667,.658483,.196027,.490253,.470588,.664915,.198075,.488836,.47451,.671349,.200133,.487358,.478431,.677786,.202203,.485819,.482353,.684224,.204286,.484219,.486275,.690661,.206384,.482558,.490196,.697098,.208501,.480835,.494118,.703532,.210638,.479049,.498039,.709962,.212797,.477201,.501961,.716387,.214982,.47529,.505882,.722805,.217194,.473316,.509804,.729216,.219437,.471279,.513725,.735616,.221713,.46918,.517647,.742004,.224025,.467018,.521569,.748378,.226377,.464794,.52549,.754737,.228772,.462509,.529412,.761077,.231214,.460162,.533333,.767398,.233705,.457755,.537255,.773695,.236249,.455289,.541176,.779968,.238851,.452765,.545098,.786212,.241514,.450184,.54902,.792427,.244242,.447543,.552941,.798608,.24704,.444848,.556863,.804752,.249911,.442102,.560784,.810855,.252861,.439305,.564706,.816914,.255895,.436461,.568627,.822926,.259016,.433573,.572549,.828886,.262229,.430644,.576471,.834791,.26554,.427671,.580392,.840636,.268953,.424666,.584314,.846416,.272473,.421631,.588235,.852126,.276106,.418573,.592157,.857763,.279857,.415496,.596078,.86332,.283729,.412403,.6,.868793,.287728,.409303,.603922,.874176,.291859,.406205,.607843,.879464,.296125,.403118,.611765,.884651,.30053,.400047,.615686,.889731,.305079,.397002,.619608,.8947,.309773,.393995,.623529,.899552,.314616,.391037,.627451,.904281,.31961,.388137,.631373,.908884,.324755,.385308,.635294,.913354,.330052,.382563,.639216,.917689,.3355,.379915,.643137,.921884,.341098,.377376,.647059,.925937,.346844,.374959,.65098,.929845,.352734,.372677,.654902,.933606,.358764,.370541,.658824,.937221,.364929,.368567,.662745,.940687,.371224,.366762,.666667,.944006,.377643,.365136,.670588,.94718,.384178,.363701,.67451,.95021,.39082,.362468,.678431,.953099,.397563,.361438,.682353,.955849,.4044,.360619,.686275,.958464,.411324,.360014,.690196,.960949,.418323,.35963,.694118,.96331,.42539,.359469,.698039,.965549,.432519,.359529,.701961,.967671,.439703,.35981,.705882,.96968,.446936,.360311,.709804,.971582,.45421,.36103,.713725,.973381,.46152,.361965,.717647,.975082,.468861,.363111,.721569,.97669,.476226,.364466,.72549,.97821,.483612,.366025,.729412,.979645,.491014,.367783,.733333,.981,.498428,.369734,.737255,.982279,.505851,.371874,.741176,.983485,.51328,.374198,.745098,.984622,.520713,.376698,.74902,.985693,.528148,.379371,.752941,.9867,.535582,.38221,.756863,.987646,.543015,.38521,.760784,.988533,.550446,.388365,.764706,.989363,.557873,.391671,.768627,.990138,.565296,.395122,.772549,.990871,.572706,.398714,.776471,.991558,.580107,.402441,.780392,.992196,.587502,.406299,.784314,.992785,.594891,.410283,.788235,.993326,.602275,.41439,.792157,.993834,.609644,.418613,.796078,.994309,.616999,.42295,.8,.994738,.62435,.427397,.803922,.995122,.631696,.431951,.807843,.99548,.639027,.436607,.811765,.99581,.646344,.441361,.815686,.996096,.653659,.446213,.819608,.996341,.660969,.45116,.823529,.99658,.668256,.456192,.827451,.996775,.675541,.461314,.831373,.996925,.682828,.466526,.835294,.997077,.690088,.471811,.839216,.997186,.697349,.477182,.843137,.997254,.704611,.482635,.847059,.997325,.711848,.488154,.85098,.997351,.719089,.493755,.854902,.997351,.726324,.499428,.858824,.997341,.733545,.505167,.862745,.997285,.740772,.510983,.866667,.997228,.747981,.516859,.870588,.997138,.75519,.522806,.87451,.997019,.762398,.528821,.878431,.996898,.769591,.534892,.882353,.996727,.776795,.541039,.886275,.996571,.783977,.547233,.890196,.996369,.791167,.553499,.894118,.996162,.798348,.55982,.898039,.995932,.805527,.566202,.901961,.99568,.812706,.572645,.905882,.995424,.819875,.57914,.909804,.995131,.827052,.585701,.913725,.994851,.834213,.592307,.917647,.994524,.841387,.598983,.921569,.994222,.84854,.605696,.92549,.993866,.855711,.612482,.929412,.993545,.862859,.619299,.933333,.99317,.870024,.626189,.937255,.992831,.877168,.633109,.941176,.99244,.88433,.640099,.945098,.992089,.89147,.647116,.94902,.991688,.898627,.654202,.952941,.991332,.905763,.661309,.956863,.99093,.912915,.668481,.960784,.99057,.920049,.675675,.964706,.990175,.927196,.682926,.968627,.989815,.934329,.690198,.972549,.989434,.94147,.697519,.976471,.989077,.948604,.704863,.980392,.988717,.955742,.712242,.984314,.988367,.962878,.719649,.988235,.988033,.970012,.727077,.992157,.987691,.977154,.734536,.996078,.987387,.984288,.742002,1,.987053,.991438,.749504]},{ColorSpace:"Diverging",Name:"Inferno (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002267,.00127,.01857,.007843,.003299,.002249,.024239,.011765,.004547,.003392,.030909,.015686,.006006,.004692,.038558,.019608,.007676,.006136,.046836,.023529,.009561,.007713,.055143,.027451,.011663,.009417,.06346,.031373,.013995,.011225,.071862,.035294,.016561,.013136,.080282,.039216,.019373,.015133,.088767,.043137,.022447,.017199,.097327,.047059,.025793,.019331,.10593,.05098,.029432,.021503,.114621,.054902,.033385,.023702,.123397,.058824,.037668,.025921,.132232,.062745,.042253,.028139,.141141,.066667,.046915,.030324,.150164,.070588,.051644,.032474,.159254,.07451,.056449,.034569,.168414,.078431,.06134,.03659,.177642,.082353,.066331,.038504,.186962,.086275,.071429,.040294,.196354,.090196,.076637,.041905,.205799,.094118,.081962,.043328,.215289,.098039,.087411,.044556,.224813,.101961,.09299,.045583,.234358,.105882,.098702,.046402,.243904,.109804,.104551,.047008,.25343,.113725,.110536,.047399,.262912,.117647,.116656,.047574,.272321,.121569,.122908,.047536,.281624,.12549,.129285,.047293,.290788,.129412,.135778,.046856,.299776,.133333,.142378,.046242,.308553,.137255,.149073,.045468,.317085,.141176,.15585,.044559,.325338,.145098,.162689,.043554,.333277,.14902,.169575,.042489,.340874,.152941,.176493,.041402,.348111,.156863,.183429,.040329,.354971,.160784,.190367,.039309,.361447,.164706,.197297,.0384,.367535,.168627,.204209,.037632,.373238,.172549,.211095,.03703,.378563,.176471,.217949,.036615,.383522,.180392,.224763,.036405,.388129,.184314,.231538,.036405,.3924,.188235,.238273,.036621,.396353,.192157,.244967,.037055,.400007,.196078,.25162,.037705,.403378,.2,.258234,.038571,.406485,.203922,.26481,.039647,.409345,.207843,.271347,.040922,.411976,.211765,.27785,.042353,.414392,.215686,.284321,.043933,.416608,.219608,.290763,.045644,.418637,.223529,.297178,.04747,.420491,.227451,.303568,.049396,.422182,.231373,.309935,.051407,.423721,.235294,.316282,.05349,.425116,.239216,.32261,.055634,.426377,.243137,.328921,.057827,.427511,.247059,.335217,.06006,.428524,.25098,.3415,.062325,.429425,.254902,.347771,.064616,.430217,.258824,.354032,.066925,.430906,.262745,.360284,.069247,.431497,.266667,.366529,.071579,.431994,.270588,.372768,.073915,.4324,.27451,.379001,.076253,.432719,.278431,.385228,.078591,.432955,.282353,.391453,.080927,.433109,.286275,.397674,.083257,.433183,.290196,.403894,.08558,.433179,.294118,.410113,.087896,.433098,.298039,.416331,.090203,.432943,.301961,.422549,.092501,.432714,.305882,.428768,.09479,.432412,.309804,.434987,.097069,.432039,.313725,.441207,.099338,.431594,.317647,.447428,.101597,.43108,.321569,.453651,.103848,.430498,.32549,.459875,.106089,.429846,.329412,.4661,.108322,.429125,.333333,.472328,.110547,.428334,.337255,.478558,.112764,.427475,.341176,.484789,.114974,.426548,.345098,.491022,.117179,.425552,.34902,.497257,.119379,.424488,.352941,.503493,.121575,.423356,.356863,.50973,.123769,.422156,.360784,.515967,.12596,.420887,.364706,.522206,.12815,.419549,.368627,.528444,.130341,.418142,.372549,.534683,.132534,.416667,.376471,.54092,.134729,.415123,.380392,.547157,.136929,.413511,.384314,.553392,.139134,.411829,.388235,.559624,.141346,.410078,.392157,.565854,.143567,.408258,.396078,.572081,.145797,.406369,.4,.578304,.148039,.404411,.403922,.584521,.150294,.402385,.407843,.590734,.152563,.40029,.411765,.59694,.154848,.398125,.415686,.603139,.157151,.395891,.419608,.60933,.159474,.393589,.423529,.615513,.161817,.391219,.427451,.621685,.164184,.388781,.431373,.627847,.166575,.386276,.435294,.633998,.168992,.383704,.439216,.640135,.171438,.381065,.443137,.64626,.173914,.378359,.447059,.652369,.176421,.375586,.45098,.658463,.178962,.372748,.454902,.66454,.181539,.369846,.458824,.670599,.184153,.366879,.462745,.676638,.186807,.363849,.466667,.682656,.189501,.360757,.470588,.688653,.192239,.357603,.47451,.694627,.195021,.354388,.478431,.700576,.197851,.351113,.482353,.7065,.200728,.347777,.486275,.712396,.203656,.344383,.490196,.718264,.206636,.340931,.494118,.724103,.20967,.337424,.498039,.729909,.212759,.333861,.501961,.735683,.215906,.330245,.505882,.741423,.219112,.326576,.509804,.747127,.222378,.322856,.513725,.752794,.225706,.319085,.517647,.758422,.229097,.315266,.521569,.76401,.232554,.311399,.52549,.769556,.236077,.307485,.529412,.775059,.239667,.303526,.533333,.780517,.243327,.299523,.537255,.785929,.247056,.295477,.541176,.791293,.250856,.29139,.545098,.796607,.254728,.287264,.54902,.801871,.258674,.283099,.552941,.807082,.262692,.278898,.556863,.812239,.266786,.274661,.560784,.817341,.270954,.27039,.564706,.822386,.275197,.266085,.568627,.827372,.279517,.26175,.572549,.832299,.283913,.257383,.576471,.837165,.288385,.252988,.580392,.841969,.292933,.248564,.584314,.846709,.297559,.244113,.588235,.851384,.30226,.239636,.592157,.855992,.307038,.235133,.596078,.860533,.311892,.230606,.6,.865006,.316822,.226055,.603922,.869409,.321827,.221482,.607843,.873741,.326906,.216886,.611765,.878001,.33206,.212268,.615686,.882188,.337287,.207628,.619608,.886302,.342586,.202968,.623529,.890341,.347957,.198286,.627451,.894305,.353399,.193584,.631373,.898192,.358911,.18886,.635294,.902003,.364492,.184116,.639216,.905735,.37014,.17935,.643137,.90939,.375856,.174563,.647059,.912966,.381636,.169755,.65098,.916462,.387481,.164924,.654902,.919879,.393389,.16007,.658824,.923215,.399359,.155193,.662745,.92647,.405389,.150292,.666667,.929644,.411479,.145367,.670588,.932737,.417627,.140417,.67451,.935747,.423831,.13544,.678431,.938675,.430091,.130438,.682353,.941521,.436405,.125409,.686275,.944285,.442772,.120354,.690196,.946965,.449191,.115272,.694118,.949562,.45566,.110164,.698039,.952075,.462178,.105031,.701961,.954506,.468744,.099874,.705882,.956852,.475356,.094695,.709804,.959114,.482014,.089499,.713725,.961293,.488716,.084289,.717647,.963387,.495462,.079073,.721569,.965397,.502249,.073859,.72549,.967322,.509078,.068659,.729412,.969163,.515946,.063488,.733333,.970919,.522853,.058367,.737255,.97259,.529798,.053324,.741176,.974176,.53678,.048392,.745098,.975677,.543798,.043618,.74902,.977092,.55085,.03905,.752941,.978422,.557937,.034931,.756863,.979666,.565057,.031409,.760784,.980824,.572209,.028508,.764706,.981895,.579392,.02625,.768627,.982881,.586606,.024661,.772549,.983779,.593849,.02377,.776471,.984591,.601122,.023606,.780392,.985315,.608422,.024202,.784314,.985952,.61575,.025592,.788235,.986502,.623105,.027814,.792157,.986964,.630485,.030908,.796078,.987337,.63789,.034916,.8,.987622,.64532,.039886,.803922,.987819,.652773,.045581,.807843,.987926,.66025,.05175,.811765,.987945,.667748,.058329,.815686,.987874,.675267,.065257,.819608,.987714,.682807,.072489,.823529,.987464,.690366,.07999,.827451,.987124,.697944,.087731,.831373,.986694,.70554,.095694,.835294,.986175,.713153,.103863,.839216,.985566,.720782,.112229,.843137,.984865,.728427,.120785,.847059,.984075,.736087,.129527,.85098,.983196,.743758,.138453,.854902,.982228,.751442,.147565,.858824,.981173,.759135,.156863,.862745,.980032,.766837,.166353,.866667,.978806,.774545,.176037,.870588,.977497,.782258,.185923,.87451,.976108,.789974,.196018,.878431,.974638,.797692,.206332,.882353,.973088,.805409,.216877,.886275,.971468,.813122,.227658,.890196,.969783,.820825,.238686,.894118,.968041,.828515,.249972,.898039,.966243,.836191,.261534,.901961,.964394,.843848,.273391,.905882,.962517,.851476,.285546,.909804,.960626,.859069,.29801,.913725,.95872,.866624,.31082,.917647,.956834,.874129,.323974,.921569,.954997,.881569,.337475,.92549,.953215,.888942,.351369,.929412,.951546,.896226,.365627,.933333,.950018,.903409,.380271,.937255,.948683,.910473,.395289,.941176,.947594,.917399,.410665,.945098,.946809,.924168,.426373,.94902,.946392,.930761,.442367,.952941,.946403,.937159,.458592,.956863,.946903,.943348,.47497,.960784,.947937,.949318,.491426,.964706,.949545,.955063,.50786,.968627,.95174,.960587,.524203,.972549,.954529,.965896,.540361,.976471,.957896,.971003,.556275,.980392,.961812,.975924,.571925,.984314,.966249,.980678,.587206,.988235,.971162,.985282,.602154,.992157,.976511,.989753,.61676,.996078,.982257,.994109,.631017,1,.988362,.998364,.644924]},{ColorSpace:"Diverging",Name:"Plasma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.050383,.029803,.527975,.003922,.063536,.028426,.533124,.007843,.075353,.027206,.538007,.011765,.086222,.026125,.542658,.015686,.096379,.025165,.547103,.019608,.10598,.024309,.551368,.023529,.115124,.023556,.555468,.027451,.123903,.022878,.559423,.031373,.132381,.022258,.56325,.035294,.140603,.021687,.566959,.039216,.148607,.021154,.570562,.043137,.156421,.020651,.574065,.047059,.16407,.020171,.577478,.05098,.171574,.019706,.580806,.054902,.17895,.019252,.584054,.058824,.186213,.018803,.587228,.062745,.193374,.018354,.59033,.066667,.200445,.017902,.593364,.070588,.207435,.017442,.596333,.07451,.21435,.016973,.599239,.078431,.221197,.016497,.602083,.082353,.227983,.016007,.604867,.086275,.234715,.015502,.607592,.090196,.241396,.014979,.610259,.094118,.248032,.014439,.612868,.098039,.254627,.013882,.615419,.101961,.261183,.013308,.617911,.105882,.267703,.012716,.620346,.109804,.274191,.012109,.622722,.113725,.280648,.011488,.625038,.117647,.287076,.010855,.627295,.121569,.293478,.010213,.62949,.12549,.299855,.009561,.631624,.129412,.30621,.008902,.633694,.133333,.312543,.008239,.6357,.137255,.318856,.007576,.63764,.141176,.32515,.006915,.639512,.145098,.331426,.006261,.641316,.14902,.337683,.005618,.643049,.152941,.343925,.004991,.64471,.156863,.35015,.004382,.646298,.160784,.356359,.003798,.64781,.164706,.362553,.003243,.649245,.168627,.368733,.002724,.650601,.172549,.374897,.002245,.651876,.176471,.381047,.001814,.653068,.180392,.387183,.001434,.654177,.184314,.393304,.001114,.655199,.188235,.399411,859e-6,.656133,.192157,.405503,678e-6,.656977,.196078,.41158,577e-6,.65773,.2,.417642,564e-6,.65839,.203922,.423689,646e-6,.658956,.207843,.429719,831e-6,.659425,.211765,.435734,.001127,.659797,.215686,.441732,.00154,.660069,.219608,.447714,.00208,.66024,.223529,.453677,.002755,.66031,.227451,.459623,.003574,.660277,.231373,.46555,.004545,.660139,.235294,.471457,.005678,.659897,.239216,.477344,.00698,.659549,.243137,.48321,.00846,.659095,.247059,.489055,.010127,.658534,.25098,.494877,.01199,.657865,.254902,.500678,.014055,.657088,.258824,.506454,.016333,.656202,.262745,.512206,.018833,.655209,.266667,.517933,.021563,.654109,.270588,.523633,.024532,.652901,.27451,.529306,.027747,.651586,.278431,.534952,.031217,.650165,.282353,.54057,.03495,.64864,.286275,.546157,.038954,.64701,.290196,.551715,.043136,.645277,.294118,.557243,.047331,.643443,.298039,.562738,.051545,.641509,.301961,.568201,.055778,.639477,.305882,.573632,.060028,.637349,.309804,.579029,.064296,.635126,.313725,.584391,.068579,.632812,.317647,.589719,.072878,.630408,.321569,.595011,.07719,.627917,.32549,.600266,.081516,.625342,.329412,.605485,.085854,.622686,.333333,.610667,.090204,.619951,.337255,.615812,.094564,.61714,.341176,.620919,.098934,.614257,.345098,.625987,.103312,.611305,.34902,.631017,.107699,.608287,.352941,.636008,.112092,.605205,.356863,.640959,.116492,.602065,.360784,.645872,.120898,.598867,.364706,.650746,.125309,.595617,.368627,.65558,.129725,.592317,.372549,.660374,.134144,.588971,.376471,.665129,.138566,.585582,.380392,.669845,.142992,.582154,.384314,.674522,.147419,.578688,.388235,.67916,.151848,.575189,.392157,.683758,.156278,.57166,.396078,.688318,.160709,.568103,.4,.69284,.165141,.564522,.403922,.697324,.169573,.560919,.407843,.701769,.174005,.557296,.411765,.706178,.178437,.553657,.415686,.710549,.182868,.550004,.419608,.714883,.187299,.546338,.423529,.719181,.191729,.542663,.427451,.723444,.196158,.538981,.431373,.72767,.200586,.535293,.435294,.731862,.205013,.531601,.439216,.736019,.209439,.527908,.443137,.740143,.213864,.524216,.447059,.744232,.218288,.520524,.45098,.748289,.222711,.516834,.454902,.752312,.227133,.513149,.458824,.756304,.231555,.509468,.462745,.760264,.235976,.505794,.466667,.764193,.240396,.502126,.470588,.76809,.244817,.498465,.47451,.771958,.249237,.494813,.478431,.775796,.253658,.491171,.482353,.779604,.258078,.487539,.486275,.783383,.2625,.483918,.490196,.787133,.266922,.480307,.494118,.790855,.271345,.476706,.498039,.794549,.27577,.473117,.501961,.798216,.280197,.469538,.505882,.801855,.284626,.465971,.509804,.805467,.289057,.462415,.513725,.809052,.293491,.45887,.517647,.812612,.297928,.455338,.521569,.816144,.302368,.451816,.52549,.819651,.306812,.448306,.529412,.823132,.311261,.444806,.533333,.826588,.315714,.441316,.537255,.830018,.320172,.437836,.541176,.833422,.324635,.434366,.545098,.836801,.329105,.430905,.54902,.840155,.33358,.427455,.552941,.843484,.338062,.424013,.556863,.846788,.342551,.420579,.560784,.850066,.347048,.417153,.564706,.853319,.351553,.413734,.568627,.856547,.356066,.410322,.572549,.85975,.360588,.406917,.576471,.862927,.365119,.403519,.580392,.866078,.36966,.400126,.584314,.869203,.374212,.396738,.588235,.872303,.378774,.393355,.592157,.875376,.383347,.389976,.596078,.878423,.387932,.3866,.6,.881443,.392529,.383229,.603922,.884436,.397139,.37986,.607843,.887402,.401762,.376494,.611765,.89034,.406398,.37313,.615686,.89325,.411048,.369768,.619608,.896131,.415712,.366407,.623529,.898984,.420392,.363047,.627451,.901807,.425087,.359688,.631373,.904601,.429797,.356329,.635294,.907365,.434524,.35297,.639216,.910098,.439268,.34961,.643137,.9128,.444029,.346251,.647059,.915471,.448807,.34289,.65098,.918109,.453603,.339529,.654902,.920714,.458417,.336166,.658824,.923287,.463251,.332801,.662745,.925825,.468103,.329435,.666667,.928329,.472975,.326067,.670588,.930798,.477867,.322697,.67451,.933232,.48278,.319325,.678431,.93563,.487712,.315952,.682353,.93799,.492667,.312575,.686275,.940313,.497642,.309197,.690196,.942598,.502639,.305816,.694118,.944844,.507658,.302433,.698039,.947051,.512699,.299049,.701961,.949217,.517763,.295662,.705882,.951344,.52285,.292275,.709804,.953428,.52796,.288883,.713725,.95547,.533093,.28549,.717647,.957469,.53825,.282096,.721569,.959424,.543431,.278701,.72549,.961336,.548636,.275305,.729412,.963203,.553865,.271909,.733333,.965024,.559118,.268513,.737255,.966798,.564396,.265118,.741176,.968526,.5697,.261721,.745098,.970205,.575028,.258325,.74902,.971835,.580382,.254931,.752941,.973416,.585761,.25154,.756863,.974947,.591165,.248151,.760784,.976428,.596595,.244767,.764706,.977856,.602051,.241387,.768627,.979233,.607532,.238013,.772549,.980556,.613039,.234646,.776471,.981826,.618572,.231287,.780392,.983041,.624131,.227937,.784314,.984199,.629718,.224595,.788235,.985301,.63533,.221265,.792157,.986345,.640969,.217948,.796078,.987332,.646633,.214648,.8,.98826,.652325,.211364,.803922,.989128,.658043,.2081,.807843,.989935,.663787,.204859,.811765,.990681,.669558,.201642,.815686,.991365,.675355,.198453,.819608,.991985,.681179,.195295,.823529,.992541,.68703,.19217,.827451,.993032,.692907,.189084,.831373,.993456,.69881,.186041,.835294,.993814,.704741,.183043,.839216,.994103,.710698,.180097,.843137,.994324,.716681,.177208,.847059,.994474,.722691,.174381,.85098,.994553,.728728,.171622,.854902,.994561,.734791,.168938,.858824,.994495,.74088,.166335,.862745,.994355,.746995,.163821,.866667,.994141,.753137,.161404,.870588,.993851,.759304,.159092,.87451,.993482,.765499,.156891,.878431,.993033,.77172,.154808,.882353,.992505,.777967,.152855,.886275,.991897,.784239,.151042,.890196,.991209,.790537,.149377,.894118,.990439,.796859,.14787,.898039,.989587,.803205,.146529,.901961,.988648,.809579,.145357,.905882,.987621,.815978,.144363,.909804,.986509,.822401,.143557,.913725,.985314,.828846,.142945,.917647,.984031,.835315,.142528,.921569,.982653,.841812,.142303,.92549,.98119,.848329,.142279,.929412,.979644,.854866,.142453,.933333,.977995,.861432,.142808,.937255,.976265,.868016,.143351,.941176,.974443,.874622,.144061,.945098,.97253,.88125,.144923,.94902,.970533,.887896,.145919,.952941,.968443,.894564,.147014,.956863,.966271,.901249,.14818,.960784,.964021,.90795,.14937,.964706,.961681,.914672,.15052,.968627,.959276,.921407,.151566,.972549,.956808,.928152,.152409,.976471,.954287,.934908,.152921,.980392,.951726,.941671,.152925,.984314,.949151,.948435,.152178,.988235,.946602,.95519,.150328,.992157,.944152,.961916,.146861,.996078,.941896,.96859,.140956,1,.940015,.975158,.131326]},{ColorSpace:"Diverging",Name:"Viridis (matplotlib)",NanColor:[1,0,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Eric Firing",RGBPoints:[0,.267004,.004874,.329415,.003922,.26851,.009605,.335427,.007843,.269944,.014625,.341379,.011765,.271305,.019942,.347269,.015686,.272594,.025563,.353093,.019608,.273809,.031497,.358853,.023529,.274952,.037752,.364543,.027451,.276022,.044167,.370164,.031373,.277018,.050344,.375715,.035294,.277941,.056324,.381191,.039216,.278791,.062145,.386592,.043137,.279566,.067836,.391917,.047059,.280267,.073417,.397163,.05098,.280894,.078907,.402329,.054902,.281446,.08432,.407414,.058824,.281924,.089666,.412415,.062745,.282327,.094955,.417331,.066667,.282656,.100196,.42216,.070588,.28291,.105393,.426902,.07451,.283091,.110553,.431554,.078431,.283197,.11568,.436115,.082353,.283229,.120777,.440584,.086275,.283187,.125848,.44496,.090196,.283072,.130895,.449241,.094118,.282884,.13592,.453427,.098039,.282623,.140926,.457517,.101961,.28229,.145912,.46151,.105882,.281887,.150881,.465405,.109804,.281412,.155834,.469201,.113725,.280868,.160771,.472899,.117647,.280255,.165693,.476498,.121569,.279574,.170599,.479997,.12549,.278826,.17549,.483397,.129412,.278012,.180367,.486697,.133333,.277134,.185228,.489898,.137255,.276194,.190074,.493001,.141176,.275191,.194905,.496005,.145098,.274128,.199721,.498911,.14902,.273006,.20452,.501721,.152941,.271828,.209303,.504434,.156863,.270595,.214069,.507052,.160784,.269308,.218818,.509577,.164706,.267968,.223549,.512008,.168627,.26658,.228262,.514349,.172549,.265145,.232956,.516599,.176471,.263663,.237631,.518762,.180392,.262138,.242286,.520837,.184314,.260571,.246922,.522828,.188235,.258965,.251537,.524736,.192157,.257322,.25613,.526563,.196078,.255645,.260703,.528312,.2,.253935,.265254,.529983,.203922,.252194,.269783,.531579,.207843,.250425,.27429,.533103,.211765,.248629,.278775,.534556,.215686,.246811,.283237,.535941,.219608,.244972,.287675,.53726,.223529,.243113,.292092,.538516,.227451,.241237,.296485,.539709,.231373,.239346,.300855,.540844,.235294,.237441,.305202,.541921,.239216,.235526,.309527,.542944,.243137,.233603,.313828,.543914,.247059,.231674,.318106,.544834,.25098,.229739,.322361,.545706,.254902,.227802,.326594,.546532,.258824,.225863,.330805,.547314,.262745,.223925,.334994,.548053,.266667,.221989,.339161,.548752,.270588,.220057,.343307,.549413,.27451,.21813,.347432,.550038,.278431,.21621,.351535,.550627,.282353,.214298,.355619,.551184,.286275,.212395,.359683,.55171,.290196,.210503,.363727,.552206,.294118,.208623,.367752,.552675,.298039,.206756,.371758,.553117,.301961,.204903,.375746,.553533,.305882,.203063,.379716,.553925,.309804,.201239,.38367,.554294,.313725,.19943,.387607,.554642,.317647,.197636,.391528,.554969,.321569,.19586,.395433,.555276,.32549,.1941,.399323,.555565,.329412,.192357,.403199,.555836,.333333,.190631,.407061,.556089,.337255,.188923,.41091,.556326,.341176,.187231,.414746,.556547,.345098,.185556,.41857,.556753,.34902,.183898,.422383,.556944,.352941,.182256,.426184,.55712,.356863,.180629,.429975,.557282,.360784,.179019,.433756,.55743,.364706,.177423,.437527,.557565,.368627,.175841,.44129,.557685,.372549,.174274,.445044,.557792,.376471,.172719,.448791,.557885,.380392,.171176,.45253,.557965,.384314,.169646,.456262,.55803,.388235,.168126,.459988,.558082,.392157,.166617,.463708,.558119,.396078,.165117,.467423,.558141,.4,.163625,.471133,.558148,.403922,.162142,.474838,.55814,.407843,.160665,.47854,.558115,.411765,.159194,.482237,.558073,.415686,.157729,.485932,.558013,.419608,.15627,.489624,.557936,.423529,.154815,.493313,.55784,.427451,.153364,.497,.557724,.431373,.151918,.500685,.557587,.435294,.150476,.504369,.55743,.439216,.149039,.508051,.55725,.443137,.147607,.511733,.557049,.447059,.14618,.515413,.556823,.45098,.144759,.519093,.556572,.454902,.143343,.522773,.556295,.458824,.141935,.526453,.555991,.462745,.140536,.530132,.555659,.466667,.139147,.533812,.555298,.470588,.13777,.537492,.554906,.47451,.136408,.541173,.554483,.478431,.135066,.544853,.554029,.482353,.133743,.548535,.553541,.486275,.132444,.552216,.553018,.490196,.131172,.555899,.552459,.494118,.129933,.559582,.551864,.498039,.128729,.563265,.551229,.501961,.127568,.566949,.550556,.505882,.126453,.570633,.549841,.509804,.125394,.574318,.549086,.513725,.124395,.578002,.548287,.517647,.123463,.581687,.547445,.521569,.122606,.585371,.546557,.52549,.121831,.589055,.545623,.529412,.121148,.592739,.544641,.533333,.120565,.596422,.543611,.537255,.120092,.600104,.54253,.541176,.119738,.603785,.5414,.545098,.119512,.607464,.540218,.54902,.119423,.611141,.538982,.552941,.119483,.614817,.537692,.556863,.119699,.61849,.536347,.560784,.120081,.622161,.534946,.564706,.120638,.625828,.533488,.568627,.12138,.629492,.531973,.572549,.122312,.633153,.530398,.576471,.123444,.636809,.528763,.580392,.12478,.640461,.527068,.584314,.126326,.644107,.525311,.588235,.128087,.647749,.523491,.592157,.130067,.651384,.521608,.596078,.132268,.655014,.519661,.6,.134692,.658636,.517649,.603922,.137339,.662252,.515571,.607843,.14021,.665859,.513427,.611765,.143303,.669459,.511215,.615686,.146616,.67305,.508936,.619608,.150148,.676631,.506589,.623529,.153894,.680203,.504172,.627451,.157851,.683765,.501686,.631373,.162016,.687316,.499129,.635294,.166383,.690856,.496502,.639216,.170948,.694384,.493803,.643137,.175707,.6979,.491033,.647059,.180653,.701402,.488189,.65098,.185783,.704891,.485273,.654902,.19109,.708366,.482284,.658824,.196571,.711827,.479221,.662745,.202219,.715272,.476084,.666667,.20803,.718701,.472873,.670588,.214,.722114,.469588,.67451,.220124,.725509,.466226,.678431,.226397,.728888,.462789,.682353,.232815,.732247,.459277,.686275,.239374,.735588,.455688,.690196,.24607,.73891,.452024,.694118,.252899,.742211,.448284,.698039,.259857,.745492,.444467,.701961,.266941,.748751,.440573,.705882,.274149,.751988,.436601,.709804,.281477,.755203,.432552,.713725,.288921,.758394,.428426,.717647,.296479,.761561,.424223,.721569,.304148,.764704,.419943,.72549,.311925,.767822,.415586,.729412,.319809,.770914,.411152,.733333,.327796,.77398,.40664,.737255,.335885,.777018,.402049,.741176,.344074,.780029,.397381,.745098,.35236,.783011,.392636,.74902,.360741,.785964,.387814,.752941,.369214,.788888,.382914,.756863,.377779,.791781,.377939,.760784,.386433,.794644,.372886,.764706,.395174,.797475,.367757,.768627,.404001,.800275,.362552,.772549,.412913,.803041,.357269,.776471,.421908,.805774,.35191,.780392,.430983,.808473,.346476,.784314,.440137,.811138,.340967,.788235,.449368,.813768,.335384,.792157,.458674,.816363,.329727,.796078,.468053,.818921,.323998,.8,.477504,.821444,.318195,.803922,.487026,.823929,.312321,.807843,.496615,.826376,.306377,.811765,.506271,.828786,.300362,.815686,.515992,.831158,.294279,.819608,.525776,.833491,.288127,.823529,.535621,.835785,.281908,.827451,.545524,.838039,.275626,.831373,.555484,.840254,.269281,.835294,.565498,.84243,.262877,.839216,.575563,.844566,.256415,.843137,.585678,.846661,.249897,.847059,.595839,.848717,.243329,.85098,.606045,.850733,.236712,.854902,.616293,.852709,.230052,.858824,.626579,.854645,.223353,.862745,.636902,.856542,.21662,.866667,.647257,.8584,.209861,.870588,.657642,.860219,.203082,.87451,.668054,.861999,.196293,.878431,.678489,.863742,.189503,.882353,.688944,.865448,.182725,.886275,.699415,.867117,.175971,.890196,.709898,.868751,.169257,.894118,.720391,.87035,.162603,.898039,.730889,.871916,.156029,.901961,.741388,.873449,.149561,.905882,.751884,.874951,.143228,.909804,.762373,.876424,.137064,.913725,.772852,.877868,.131109,.917647,.783315,.879285,.125405,.921569,.79376,.880678,.120005,.92549,.804182,.882046,.114965,.929412,.814576,.883393,.110347,.933333,.82494,.88472,.106217,.937255,.83527,.886029,.102646,.941176,.845561,.887322,.099702,.945098,.85581,.888601,.097452,.94902,.866013,.889868,.095953,.952941,.876168,.891125,.09525,.956863,.886271,.892374,.095374,.960784,.89632,.893616,.096335,.964706,.906311,.894855,.098125,.968627,.916242,.896091,.100717,.972549,.926106,.89733,.104071,.976471,.935904,.89857,.108131,.980392,.945636,.899815,.112838,.984314,.9553,.901065,.118128,.988235,.964894,.902323,.123941,.992157,.974417,.90359,.130215,.996078,.983868,.904867,.136897,1,.993248,.906157,.143936]},{ShowIndexedColorActiveValues:1,IndexedColors:[.07,.5,.7,1,1,1,.85,1,1,.8,.5,1,.76,1,0,1,.71,.71,.5,.5,.5,.05,.05,1,1,.05,.05,.7,1,1,.7,.89,.96,.67,.36,.95,.54,1,0,.75,.65,.65,.5,.6,.6,1,.5,0,1,1,.19,.12,.94,.12,.5,.82,.89,.56,.25,.83,.24,1,0,.9,.9,.9,.75,.76,.78,.65,.65,.67,.54,.6,.78,.61,.48,.78,.5,.48,.78,.44,.48,.78,.36,.48,.76,1,.48,.38,.49,.5,.69,.76,.56,.56,.4,.56,.56,.74,.5,.89,1,.63,0,.65,.16,.16,.36,.72,.82,.44,.18,.69,0,1,0,.58,1,1,.58,.88,.88,.45,.76,.79,.33,.71,.71,.23,.62,.62,.14,.56,.56,.04,.49,.55,0,.41,.52,.88,.88,1,1,.85,.56,.65,.46,.45,.4,.5,.5,.62,.39,.71,.83,.48,0,.58,0,.58,.26,.62,.69,.34,.09,.56,0,.79,0,.44,.83,1,1,1,.78,.85,1,.78,.78,1,.78,.64,1,.78,.56,1,.78,.38,1,.78,.27,1,.78,.19,1,.78,.12,1,.78,0,1,.61,0,.9,.46,0,.83,.32,0,.75,.22,0,.67,.14,.3,.76,1,.3,.65,1,.13,.58,.84,.15,.49,.67,.15,.4,.59,.09,.33,.53,.96,.93,.82,.8,.82,.12,.71,.71,.76,.65,.33,.3,.34,.35,.38,.62,.31,.71,.67,.36,0,.46,.31,.27,.26,.51,.59,.26,0,.4,0,.49,0,.44,.67,.98,0,.73,1,0,.63,1,0,.56,1,0,.5,1,0,.42,1,.33,.36,.95,.47,.36,.89,.54,.31,.89,.63,.21,.83,.7,.12,.83,.7,.12,.73,.7,.05,.65,.74,.05,.53,.78,0,.4,.8,0,.35,.82,0,.31,.85,0,.27,.88,0,.22,.9,0,.18,.91,0,.15,.92,0,.14,.93,0,.13,.94,0,.12,.95,0,.11,.96,0,.1,.97,0,.09,.98,0,.08,.99,0,.07,1,0,.06],Annotations:[0,"Xx",1,"H",2,"He",3,"Li",4,"Be",5,"B",6,"C",7,"N",8,"O",9,"F",10,"Ne",11,"Na",12,"Mg",13,"Al",14,"Si",15,"P",16,"S",17,"Cl",18,"Ar",19,"K",20,"Ca",21,"Sc",22,"Ti",23,"V",24,"Cr",25,"Mn",26,"Fe",27,"Co",28,"Ni",29,"Cu",30,"Zn",31,"Ga",32,"Ge",33,"As",34,"Se",35,"Br",36,"Kr",37,"Rb",38,"Sr",39,"Y",40,"Zr",41,"Nb",42,"Mo",43,"Tc",44,"Ru",45,"Rh",46,"Pd",47,"Ag",48,"Cd",49,"In",50,"Sn",51,"Sb",52,"Te",53,"I",54,"Xe",55,"Cs",56,"Ba",57,"La",58,"Ce",59,"Pr",60,"Nd",61,"Pm",62,"Sm",63,"Eu",64,"Gd",65,"Tb",66,"Dy",67,"Ho",68,"Er",69,"Tm",70,"Yb",71,"Lu",72,"Hf",73,"Ta",74,"W",75,"Re",76,"Os",77,"Ir",78,"Pt",79,"Au",80,"Hg",81,"Tl",82,"Pb",83,"Bi",84,"Po",85,"At",86,"Rn",87,"Fr",88,"Ra",89,"Ac",90,"Th",91,"Pa",92,"U",93,"Np",94,"Pu",95,"Am",96,"Cm",97,"Bk",98,"Cf",99,"Es",100,"Fm",101,"Md",102,"No",103,"Lr",104,"Rf",105,"Db",106,"Sg",107,"Bh",108,"Hs",109,"Mt",110,"Ds",111,"Rg",112,"Cn",113,"Uut",114,"Uuq",115,"Uup",116,"Uuh",117,"Uus",118,"Uuo"],Name:"BlueObeliskElements"}];const zc=Object.create(null);db.filter(t=>t.RGBPoints).filter(t=>t.ColorSpace!=="CIELAB").forEach(t=>{zc[t.Name]=t});const jc=Object.keys(zc);jc.sort();function gb(t){return zc[t]}function mb(t){!t.RGBPoints||t.ColorSpace==="CIELAB"||(zc[t.Name]||(jc.push(t.Name),jc.sort()),zc[t.Name]=t)}function vb(t){const e=jc.indexOf(t);e>-1&&jc.splice(e,1),delete zc[t]}var fl={addPreset:mb,removePresetByName:vb,getPresetByName:gb,rgbPresetNames:jc};const{vtkErrorMacro:r0}=J;function yb(t,e){e.classHierarchy.push("vtkPiecewiseFunction"),t.getSize=()=>e.nodes.length,t.getType=()=>{let n,r=0,i=0;e.nodes.length>0&&(r=e.nodes[0].y);for(let a=1;a<e.nodes.length;a++){if(n=e.nodes[a].y,n!==r)if(n>r)switch(i){case 0:case 1:i=1;break;case 2:default:i=3;break}else switch(i){case 0:case 2:i=2;break;case 1:default:i=3;break}if(r=n,i===3)break}switch(i){case 0:return"Constant";case 1:return"NonDecreasing";case 2:return"NonIncreasing";case 3:default:return"Varied"}},t.getDataPointer=()=>{const n=e.nodes.length;if(e.function=null,n>0){e.function=[];for(let r=0;r<n;r++)e.function[2*r]=e.nodes[r].x,e.function[2*r+1]=e.nodes[r].y}return e.function},t.getFirstNonZeroValue=()=>{if(e.nodes.length===0)return 0;let n=1,r=0,i=0;for(;i<e.nodes.length;i++)if(e.nodes[i].y!==0){n=0;break}return n?r=Number.MAX_VALUE:i>0?r=e.nodes[i-1].x:e.clamping?r=-Number.MAX_VALUE:r=e.nodes[0].x,r},t.getNodeValue=(n,r)=>{const i=e.nodes.length;return n<0||n>=i?(r0("Index out of range!"),-1):(r[0]=e.nodes[n].x,r[1]=e.nodes[n].y,r[2]=e.nodes[n].midpoint,r[3]=e.nodes[n].sharpness,1)},t.setNodeValue=(n,r)=>{const i=e.nodes.length;if(n<0||n>=i)return r0("Index out of range!"),-1;const a=e.nodes[n].x;return e.nodes[n].x=r[0],e.nodes[n].y=r[1],e.nodes[n].midpoint=r[2],e.nodes[n].sharpness=r[3],a!==r[0]?t.sortAndUpdateRange():t.modified(),1},t.addPoint=(n,r)=>t.addPointLong(n,r,.5,0),t.addPointLong=(n,r,i,a)=>{if(i<0||i>1)return r0("Midpoint outside range [0.0, 1.0]"),-1;if(a<0||a>1)return r0("Sharpness outside range [0.0, 1.0]"),-1;e.allowDuplicateScalars||t.removePoint(n);const o={x:n,y:r,midpoint:i,sharpness:a};e.nodes.push(o),t.sortAndUpdateRange();let s;for(s=0;s<e.nodes.length&&e.nodes[s].x!==n;s++);return s<e.nodes.length?s:-1},t.setNodes=n=>{e.nodes!==n&&(e.nodes=n,t.sortAndUpdateRange())},t.sortAndUpdateRange=()=>{e.nodes.sort((r,i)=>r.x-i.x),t.updateRange()||t.modified()},t.updateRange=()=>{const n=e.range.slice(),r=e.nodes.length;return r?(e.range[0]=e.nodes[0].x,e.range[1]=e.nodes[r-1].x):(e.range[0]=0,e.range[1]=0),n[0]===e.range[0]&&n[1]===e.range[1]?!1:(t.modified(),!0)},t.removePoint=n=>{let r;for(r=0;r<e.nodes.length&&e.nodes[r].x!==n;r++);if(r>=e.nodes.length)return-1;const i=r;let a=!1;return e.nodes.splice(r,1),(r===0||r===e.nodes.length)&&(a=t.updateRange()),a||t.modified(),i},t.removeAllPoints=()=>{e.nodes=[],t.sortAndUpdateRange()},t.addSegment=(n,r,i,a)=>{t.sortAndUpdateRange();for(let o=0;o<e.nodes.length;)e.nodes[o].x>=n&&e.nodes[o].x<=i?e.nodes.splice(o,1):o++;t.addPoint(n,r,.5,0),t.addPoint(i,a,.5,0)},t.getValue=n=>{const r=[];return t.getTable(n,n,1,r),r[0]},t.adjustRange=n=>{if(n.length<2)return 0;const r=t.getRange();r[0]<n[0]?t.addPoint(n[0],t.getValue(n[0])):t.addPoint(n[0],t.getValue(r[0])),r[1]>n[1]?t.addPoint(n[1],t.getValue(n[1])):t.addPoint(n[1],t.getValue(r[1])),t.sortAndUpdateRange();for(let i=0;i<e.nodes.length;)e.nodes[i].x>=n[0]&&e.nodes[i].x<=n[1]?e.nodes.splice(i,1):++i;return t.sortAndUpdateRange(),1},t.estimateMinNumberOfSamples=(n,r)=>{const i=t.findMinimumXDistance();return Math.ceil((r-n)/i)},t.findMinimumXDistance=()=>{const n=e.nodes.length;if(n<2)return-1;let r=e.nodes[1].x-e.nodes[0].x;for(let i=0;i<n-1;i++){const a=e.nodes[i+1].x-e.nodes[i].x;a<r&&(r=a)}return r},t.getTable=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s,c=0;const l=e.nodes.length;let f=0;l!==0&&(f=e.nodes[l-1].y);let u=0,h=0,p=0,d=0,g=0,y=0,x=0;for(s=0;s<i;s++){const m=o*s;for(i>1?u=n+s/(i-1)*(r-n):u=.5*(n+r);c<l&&u>e.nodes[c].x;)c++,c<l&&(h=e.nodes[c-1].x,p=e.nodes[c].x,d=e.nodes[c-1].y,g=e.nodes[c].y,y=e.nodes[c-1].midpoint,x=e.nodes[c-1].sharpness,y<1e-5&&(y=1e-5),y>.99999&&(y=.99999));if(c>=l)a[m]=e.clamping?f:0;else if(c===0)a[m]=e.clamping?e.nodes[0].y:0;else{let v=(u-h)/(p-h);if(v<y?v=.5*v/y:v=.5+.5*(v-y)/(1-y),x>.99)if(v<.5){a[m]=d;continue}else{a[m]=g;continue}if(x<.01){a[m]=(1-v)*d+v*g;continue}v<.5?v=.5*(v*2)**(1+10*x):v>.5&&(v=1-.5*((1-v)*2)**(1+10*x));const w=v*v,C=w*v,T=2*C-3*w+1,_=-2*C+3*w,S=C-2*w+v,b=C-w,D=g-d,E=(1-x)*D;a[m]=T*d+_*g+S*E+b*E;const R=d<g?d:g,F=d>g?d:g;a[m]=a[m]<R?R:a[m],a[m]=a[m]>F?F:a[m]}}}}const xb={range:[0,0],clamping:!0,allowDuplicateScalars:!1};function m4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xb,n),J.obj(t,e),e.nodes=[],J.setGet(t,e,["allowDuplicateScalars","clamping"]),J.setArray(t,e,["range"],2),J.getArray(t,e,["range"]),yb(t,e)}const wb=J.newInstance(m4,"vtkPiecewiseFunction");var $c={newInstance:wb,extend:m4},Gt=1e-6,Dn=typeof Float32Array<"u"?Float32Array:Array,Cb=Math.PI/180;function Tb(t){return t*Cb}function Wm(t,e){return Math.abs(t-e)<=Gt*Math.max(1,Math.abs(t),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function e1(){var t=new Dn(9);return Dn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Th(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function _b(t){var e=new Dn(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Sb(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ou(t,e,n,r,i,a,o,s,c){var l=new Dn(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=r,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l[8]=c,l}function v4(t,e,n,r,i,a,o,s,c,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t}function wi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function t1(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Pl(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8],u=f*o-s*l,h=-f*a+s*c,p=l*a-o*c,d=n*u+r*h+i*p;return d?(d=1/d,t[0]=u*d,t[1]=(-f*r+i*l)*d,t[2]=(s*r-i*o)*d,t[3]=h*d,t[4]=(f*n-i*c)*d,t[5]=(-s*n+i*a)*d,t[6]=p*d,t[7]=(-l*n+r*c)*d,t[8]=(o*n-r*a)*d,t):null}function bb(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8];return t[0]=o*f-s*l,t[1]=i*l-r*f,t[2]=r*s-i*o,t[3]=s*c-a*f,t[4]=n*f-i*c,t[5]=i*a-n*s,t[6]=a*l-o*c,t[7]=r*c-n*l,t[8]=n*o-r*a,t}function Gs(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8];return e*(l*a-o*c)+n*(-l*i+o*s)+r*(c*i-a*s)}function Hc(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],f=e[7],u=e[8],h=n[0],p=n[1],d=n[2],g=n[3],y=n[4],x=n[5],m=n[6],v=n[7],w=n[8];return t[0]=h*r+p*o+d*l,t[1]=h*i+p*s+d*f,t[2]=h*a+p*c+d*u,t[3]=g*r+y*o+x*l,t[4]=g*i+y*s+x*f,t[5]=g*a+y*c+x*u,t[6]=m*r+v*o+w*l,t[7]=m*i+v*s+w*f,t[8]=m*a+v*c+w*u,t}function Eb(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],f=e[7],u=e[8],h=n[0],p=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=c,t[6]=h*r+p*o+l,t[7]=h*i+p*s+f,t[8]=h*a+p*c+u,t}function Db(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],f=e[7],u=e[8],h=Math.sin(n),p=Math.cos(n);return t[0]=p*r+h*o,t[1]=p*i+h*s,t[2]=p*a+h*c,t[3]=p*o-h*r,t[4]=p*s-h*i,t[5]=p*c-h*a,t[6]=l,t[7]=f,t[8]=u,t}function Ob(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Rb(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Mb(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Nb(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lb(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ab(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,l=n*o,f=r*o,u=r*s,h=i*o,p=i*s,d=i*c,g=a*o,y=a*s,x=a*c;return t[0]=1-u-d,t[3]=f-x,t[6]=h+y,t[1]=f+x,t[4]=1-l-d,t[7]=p-g,t[2]=h-y,t[5]=p+g,t[8]=1-l-u,t}function Fb(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8],u=e[9],h=e[10],p=e[11],d=e[12],g=e[13],y=e[14],x=e[15],m=n*s-r*o,v=n*c-i*o,w=n*l-a*o,C=r*c-i*s,T=r*l-a*s,_=i*l-a*c,S=f*g-u*d,b=f*y-h*d,D=f*x-p*d,E=u*y-h*g,R=u*x-p*g,F=h*x-p*y,M=m*F-v*R+w*E+C*D-T*b+_*S;return M?(M=1/M,t[0]=(s*F-c*R+l*E)*M,t[1]=(c*D-o*F-l*b)*M,t[2]=(o*R-s*D+l*S)*M,t[3]=(i*R-r*F-a*E)*M,t[4]=(n*F-i*D+a*b)*M,t[5]=(r*D-n*R-a*S)*M,t[6]=(g*_-y*T+x*C)*M,t[7]=(y*w-d*_-x*v)*M,t[8]=(d*T-g*w+x*m)*M,t):null}function Ib(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Pb(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Vb(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function kb(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function y4(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Ub(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Bb(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Gb(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Wb(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],f=t[8],u=e[0],h=e[1],p=e[2],d=e[3],g=e[4],y=e[5],x=e[6],m=e[7],v=e[8];return Math.abs(n-u)<=Gt*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-h)<=Gt*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-p)<=Gt*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-d)<=Gt*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-g)<=Gt*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-y)<=Gt*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(c-x)<=Gt*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(l-m)<=Gt*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(f-v)<=Gt*Math.max(1,Math.abs(f),Math.abs(v))}var zb=Hc,jb=y4;const $b=Object.freeze(Object.defineProperty({__proto__:null,add:kb,adjoint:bb,clone:_b,copy:Sb,create:e1,determinant:Gs,equals:Wb,exactEquals:Gb,frob:Vb,fromMat2d:Lb,fromMat4:Th,fromQuat:Ab,fromRotation:Mb,fromScaling:Nb,fromTranslation:Rb,fromValues:Ou,identity:wi,invert:Pl,mul:zb,multiply:Hc,multiplyScalar:Ub,multiplyScalarAndAdd:Bb,normalFromMat4:Fb,projection:Ib,rotate:Db,scale:Ob,set:v4,str:Pb,sub:jb,subtract:y4,translate:Eb,transpose:t1},Symbol.toStringTag,{value:"Module"}));function ma(){var t=new Dn(16);return Dn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Hb(t){var e=new Dn(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function pn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function x4(t,e,n,r,i,a,o,s,c,l,f,u,h,p,d,g){var y=new Dn(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=a,y[6]=o,y[7]=s,y[8]=c,y[9]=l,y[10]=f,y[11]=u,y[12]=h,y[13]=p,y[14]=d,y[15]=g,y}function Kb(t,e,n,r,i,a,o,s,c,l,f,u,h,p,d,g,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t[9]=f,t[10]=u,t[11]=h,t[12]=p,t[13]=d,t[14]=g,t[15]=y,t}function ut(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Rt(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Sn(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8],u=e[9],h=e[10],p=e[11],d=e[12],g=e[13],y=e[14],x=e[15],m=n*s-r*o,v=n*c-i*o,w=n*l-a*o,C=r*c-i*s,T=r*l-a*s,_=i*l-a*c,S=f*g-u*d,b=f*y-h*d,D=f*x-p*d,E=u*y-h*g,R=u*x-p*g,F=h*x-p*y,M=m*F-v*R+w*E+C*D-T*b+_*S;return M?(M=1/M,t[0]=(s*F-c*R+l*E)*M,t[1]=(i*R-r*F-a*E)*M,t[2]=(g*_-y*T+x*C)*M,t[3]=(h*T-u*_-p*C)*M,t[4]=(c*D-o*F-l*b)*M,t[5]=(n*F-i*D+a*b)*M,t[6]=(y*w-d*_-x*v)*M,t[7]=(f*_-h*w+p*v)*M,t[8]=(o*R-s*D+l*S)*M,t[9]=(r*D-n*R-a*S)*M,t[10]=(d*T-g*w+x*m)*M,t[11]=(u*w-f*T-p*m)*M,t[12]=(s*b-o*E-c*S)*M,t[13]=(n*E-r*b+i*S)*M,t[14]=(g*v-d*C-y*m)*M,t[15]=(f*C-u*v+h*m)*M,t):null}function qb(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8],u=e[9],h=e[10],p=e[11],d=e[12],g=e[13],y=e[14],x=e[15];return t[0]=s*(h*x-p*y)-u*(c*x-l*y)+g*(c*p-l*h),t[1]=-(r*(h*x-p*y)-u*(i*x-a*y)+g*(i*p-a*h)),t[2]=r*(c*x-l*y)-s*(i*x-a*y)+g*(i*l-a*c),t[3]=-(r*(c*p-l*h)-s*(i*p-a*h)+u*(i*l-a*c)),t[4]=-(o*(h*x-p*y)-f*(c*x-l*y)+d*(c*p-l*h)),t[5]=n*(h*x-p*y)-f*(i*x-a*y)+d*(i*p-a*h),t[6]=-(n*(c*x-l*y)-o*(i*x-a*y)+d*(i*l-a*c)),t[7]=n*(c*p-l*h)-o*(i*p-a*h)+f*(i*l-a*c),t[8]=o*(u*x-p*g)-f*(s*x-l*g)+d*(s*p-l*u),t[9]=-(n*(u*x-p*g)-f*(r*x-a*g)+d*(r*p-a*u)),t[10]=n*(s*x-l*g)-o*(r*x-a*g)+d*(r*l-a*s),t[11]=-(n*(s*p-l*u)-o*(r*p-a*u)+f*(r*l-a*s)),t[12]=-(o*(u*y-h*g)-f*(s*y-c*g)+d*(s*h-c*u)),t[13]=n*(u*y-h*g)-f*(r*y-i*g)+d*(r*h-i*u),t[14]=-(n*(s*y-c*g)-o*(r*y-i*g)+d*(r*c-i*s)),t[15]=n*(s*h-c*u)-o*(r*h-i*u)+f*(r*c-i*s),t}function Xb(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],f=t[9],u=t[10],h=t[11],p=t[12],d=t[13],g=t[14],y=t[15],x=e*o-n*a,m=e*s-r*a,v=e*c-i*a,w=n*s-r*o,C=n*c-i*o,T=r*c-i*s,_=l*d-f*p,S=l*g-u*p,b=l*y-h*p,D=f*g-u*d,E=f*y-h*d,R=u*y-h*g;return x*R-m*E+v*D+w*b-C*S+T*_}function It(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],f=e[7],u=e[8],h=e[9],p=e[10],d=e[11],g=e[12],y=e[13],x=e[14],m=e[15],v=n[0],w=n[1],C=n[2],T=n[3];return t[0]=v*r+w*s+C*u+T*g,t[1]=v*i+w*c+C*h+T*y,t[2]=v*a+w*l+C*p+T*x,t[3]=v*o+w*f+C*d+T*m,v=n[4],w=n[5],C=n[6],T=n[7],t[4]=v*r+w*s+C*u+T*g,t[5]=v*i+w*c+C*h+T*y,t[6]=v*a+w*l+C*p+T*x,t[7]=v*o+w*f+C*d+T*m,v=n[8],w=n[9],C=n[10],T=n[11],t[8]=v*r+w*s+C*u+T*g,t[9]=v*i+w*c+C*h+T*y,t[10]=v*a+w*l+C*p+T*x,t[11]=v*o+w*f+C*d+T*m,v=n[12],w=n[13],C=n[14],T=n[15],t[12]=v*r+w*s+C*u+T*g,t[13]=v*i+w*c+C*h+T*y,t[14]=v*a+w*l+C*p+T*x,t[15]=v*o+w*f+C*d+T*m,t}function hn(t,e,n){var r=n[0],i=n[1],a=n[2],o,s,c,l,f,u,h,p,d,g,y,x;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],c=e[2],l=e[3],f=e[4],u=e[5],h=e[6],p=e[7],d=e[8],g=e[9],y=e[10],x=e[11],t[0]=o,t[1]=s,t[2]=c,t[3]=l,t[4]=f,t[5]=u,t[6]=h,t[7]=p,t[8]=d,t[9]=g,t[10]=y,t[11]=x,t[12]=o*r+f*i+d*a+e[12],t[13]=s*r+u*i+g*a+e[13],t[14]=c*r+h*i+y*a+e[14],t[15]=l*r+p*i+x*a+e[15]),t}function va(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Li(t,e,n,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),c,l,f,u,h,p,d,g,y,x,m,v,w,C,T,_,S,b,D,E,R,F,M,U;return s<Gt?null:(s=1/s,i*=s,a*=s,o*=s,c=Math.sin(n),l=Math.cos(n),f=1-l,u=e[0],h=e[1],p=e[2],d=e[3],g=e[4],y=e[5],x=e[6],m=e[7],v=e[8],w=e[9],C=e[10],T=e[11],_=i*i*f+l,S=a*i*f+o*c,b=o*i*f-a*c,D=i*a*f-o*c,E=a*a*f+l,R=o*a*f+i*c,F=i*o*f+a*c,M=a*o*f-i*c,U=o*o*f+l,t[0]=u*_+g*S+v*b,t[1]=h*_+y*S+w*b,t[2]=p*_+x*S+C*b,t[3]=d*_+m*S+T*b,t[4]=u*D+g*E+v*R,t[5]=h*D+y*E+w*R,t[6]=p*D+x*E+C*R,t[7]=d*D+m*E+T*R,t[8]=u*F+g*M+v*U,t[9]=h*F+y*M+w*U,t[10]=p*F+x*M+C*U,t[11]=d*F+m*M+T*U,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function n1(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],f=e[9],u=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+l*r,t[5]=o*i+f*r,t[6]=s*i+u*r,t[7]=c*i+h*r,t[8]=l*i-a*r,t[9]=f*i-o*r,t[10]=u*i-s*r,t[11]=h*i-c*r,t}function r1(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],c=e[3],l=e[8],f=e[9],u=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-l*r,t[1]=o*i-f*r,t[2]=s*i-u*r,t[3]=c*i-h*r,t[8]=a*r+l*i,t[9]=o*r+f*i,t[10]=s*r+u*i,t[11]=c*r+h*i,t}function i1(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],c=e[3],l=e[4],f=e[5],u=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+l*r,t[1]=o*i+f*r,t[2]=s*i+u*r,t[3]=c*i+h*r,t[4]=l*i-a*r,t[5]=f*i-o*r,t[6]=u*i-s*r,t[7]=h*i-c*r,t}function Vl(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function a1(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o1(t,e,n){var r=n[0],i=n[1],a=n[2],o=Math.hypot(r,i,a),s,c,l;return o<Gt?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),c=Math.cos(e),l=1-c,t[0]=r*r*l+c,t[1]=i*r*l+a*s,t[2]=a*r*l-i*s,t[3]=0,t[4]=r*i*l-a*s,t[5]=i*i*l+c,t[6]=a*i*l+r*s,t[7]=0,t[8]=r*a*l+i*s,t[9]=i*a*l-r*s,t[10]=a*a*l+c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Yb(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jb(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zb(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w4(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,c=i+i,l=a+a,f=r*s,u=r*c,h=r*l,p=i*c,d=i*l,g=a*l,y=o*s,x=o*c,m=o*l;return t[0]=1-(p+g),t[1]=u+m,t[2]=h-x,t[3]=0,t[4]=u-m,t[5]=1-(f+g),t[6]=d+y,t[7]=0,t[8]=h+x,t[9]=d-y,t[10]=1-(f+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Qb(t,e){var n=new Dn(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],c=e[5],l=e[6],f=e[7],u=r*r+i*i+a*a+o*o;return u>0?(n[0]=(s*o+f*r+c*a-l*i)*2/u,n[1]=(c*o+f*i+l*r-s*a)*2/u,n[2]=(l*o+f*a+s*i-c*r)*2/u):(n[0]=(s*o+f*r+c*a-l*i)*2,n[1]=(c*o+f*i+l*r-s*a)*2,n[2]=(l*o+f*a+s*i-c*r)*2),w4(t,e,n),t}function eE(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function C4(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],c=e[8],l=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(c,l,f),t}function Pd(t,e){var n=new Dn(3);C4(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,c=e[2]*a,l=e[4]*r,f=e[5]*i,u=e[6]*a,h=e[8]*r,p=e[9]*i,d=e[10]*a,g=o+f+d,y=0;return g>0?(y=Math.sqrt(g+1)*2,t[3]=.25*y,t[0]=(u-p)/y,t[1]=(h-c)/y,t[2]=(s-l)/y):o>f&&o>d?(y=Math.sqrt(1+o-f-d)*2,t[3]=(u-p)/y,t[0]=.25*y,t[1]=(s+l)/y,t[2]=(h+c)/y):f>d?(y=Math.sqrt(1+f-o-d)*2,t[3]=(h-c)/y,t[0]=(s+l)/y,t[1]=.25*y,t[2]=(u+p)/y):(y=Math.sqrt(1+d-o-f)*2,t[3]=(s-l)/y,t[0]=(h+c)/y,t[1]=(u+p)/y,t[2]=.25*y),t}function T4(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],c=i+i,l=a+a,f=o+o,u=i*c,h=i*l,p=i*f,d=a*l,g=a*f,y=o*f,x=s*c,m=s*l,v=s*f,w=r[0],C=r[1],T=r[2];return t[0]=(1-(d+y))*w,t[1]=(h+v)*w,t[2]=(p-m)*w,t[3]=0,t[4]=(h-v)*C,t[5]=(1-(u+y))*C,t[6]=(g+x)*C,t[7]=0,t[8]=(p+m)*T,t[9]=(g-x)*T,t[10]=(1-(u+d))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function tE(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],c=e[3],l=a+a,f=o+o,u=s+s,h=a*l,p=a*f,d=a*u,g=o*f,y=o*u,x=s*u,m=c*l,v=c*f,w=c*u,C=r[0],T=r[1],_=r[2],S=i[0],b=i[1],D=i[2],E=(1-(g+x))*C,R=(p+w)*C,F=(d-v)*C,M=(p-w)*T,U=(1-(h+x))*T,z=(y+m)*T,Y=(d+v)*_,W=(y-m)*_,B=(1-(h+g))*_;return t[0]=E,t[1]=R,t[2]=F,t[3]=0,t[4]=M,t[5]=U,t[6]=z,t[7]=0,t[8]=Y,t[9]=W,t[10]=B,t[11]=0,t[12]=n[0]+S-(E*S+M*b+Y*D),t[13]=n[1]+b-(R*S+U*b+W*D),t[14]=n[2]+D-(F*S+z*b+B*D),t[15]=1,t}function Ef(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,l=n*o,f=r*o,u=r*s,h=i*o,p=i*s,d=i*c,g=a*o,y=a*s,x=a*c;return t[0]=1-u-d,t[1]=f+x,t[2]=h-y,t[3]=0,t[4]=f-x,t[5]=1-l-d,t[6]=p+g,t[7]=0,t[8]=h+y,t[9]=p-g,t[10]=1-l-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nE(t,e,n,r,i,a,o){var s=1/(n-e),c=1/(i-r),l=1/(a-o);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*c,t[10]=(o+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*l,t[15]=0,t}function _4(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var rE=_4;function iE(t,e,n,r,i){var a=1/Math.tan(e/2),o;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t}function aE(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),c=2/(o+s),l=2/(i+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((o-s)*c*.5),t[9]=(i-a)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function S4(t,e,n,r,i,a,o){var s=1/(e-n),c=1/(r-i),l=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*c,t[14]=(o+a)*l,t[15]=1,t}var s1=S4;function oE(t,e,n,r,i,a,o){var s=1/(e-n),c=1/(r-i),l=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*c,t[14]=a*l,t[15]=1,t}function b4(t,e,n,r){var i,a,o,s,c,l,f,u,h,p,d=e[0],g=e[1],y=e[2],x=r[0],m=r[1],v=r[2],w=n[0],C=n[1],T=n[2];return Math.abs(d-w)<Gt&&Math.abs(g-C)<Gt&&Math.abs(y-T)<Gt?ut(t):(f=d-w,u=g-C,h=y-T,p=1/Math.hypot(f,u,h),f*=p,u*=p,h*=p,i=m*h-v*u,a=v*f-x*h,o=x*u-m*f,p=Math.hypot(i,a,o),p?(p=1/p,i*=p,a*=p,o*=p):(i=0,a=0,o=0),s=u*o-h*a,c=h*i-f*o,l=f*a-u*i,p=Math.hypot(s,c,l),p?(p=1/p,s*=p,c*=p,l*=p):(s=0,c=0,l=0),t[0]=i,t[1]=s,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=u,t[7]=0,t[8]=o,t[9]=l,t[10]=h,t[11]=0,t[12]=-(i*d+a*g+o*y),t[13]=-(s*d+c*g+l*y),t[14]=-(f*d+u*g+h*y),t[15]=1,t)}function sE(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],c=r[1],l=r[2],f=i-n[0],u=a-n[1],h=o-n[2],p=f*f+u*u+h*h;p>0&&(p=1/Math.sqrt(p),f*=p,u*=p,h*=p);var d=c*h-l*u,g=l*f-s*h,y=s*u-c*f;return p=d*d+g*g+y*y,p>0&&(p=1/Math.sqrt(p),d*=p,g*=p,y*=p),t[0]=d,t[1]=g,t[2]=y,t[3]=0,t[4]=u*y-h*g,t[5]=h*d-f*y,t[6]=f*g-u*d,t[7]=0,t[8]=f,t[9]=u,t[10]=h,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function cE(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function uE(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function lE(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function E4(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function fE(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function hE(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function pE(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function dE(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],f=t[8],u=t[9],h=t[10],p=t[11],d=t[12],g=t[13],y=t[14],x=t[15],m=e[0],v=e[1],w=e[2],C=e[3],T=e[4],_=e[5],S=e[6],b=e[7],D=e[8],E=e[9],R=e[10],F=e[11],M=e[12],U=e[13],z=e[14],Y=e[15];return Math.abs(n-m)<=Gt*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-v)<=Gt*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(i-w)<=Gt*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-C)<=Gt*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(o-T)<=Gt*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-_)<=Gt*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(c-S)<=Gt*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(l-b)<=Gt*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(f-D)<=Gt*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(u-E)<=Gt*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-R)<=Gt*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(p-F)<=Gt*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(d-M)<=Gt*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(g-U)<=Gt*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(y-z)<=Gt*Math.max(1,Math.abs(y),Math.abs(z))&&Math.abs(x-Y)<=Gt*Math.max(1,Math.abs(x),Math.abs(Y))}var Df=It,gE=E4;const hl=Object.freeze(Object.defineProperty({__proto__:null,add:lE,adjoint:qb,clone:Hb,copy:pn,create:ma,determinant:Xb,equals:dE,exactEquals:pE,frob:uE,fromQuat:Ef,fromQuat2:Qb,fromRotation:o1,fromRotationTranslation:w4,fromRotationTranslationScale:T4,fromRotationTranslationScaleOrigin:tE,fromScaling:a1,fromTranslation:Vl,fromValues:x4,fromXRotation:Yb,fromYRotation:Jb,fromZRotation:Zb,frustum:nE,getRotation:Pd,getScaling:C4,getTranslation:eE,identity:ut,invert:Sn,lookAt:b4,mul:Df,multiply:It,multiplyScalar:fE,multiplyScalarAndAdd:hE,ortho:s1,orthoNO:S4,orthoZO:oE,perspective:rE,perspectiveFromFieldOfView:aE,perspectiveNO:_4,perspectiveZO:iE,rotate:Li,rotateX:n1,rotateY:r1,rotateZ:i1,scale:va,set:Kb,str:cE,sub:gE,subtract:E4,targetTo:sE,translate:hn,transpose:Rt},Symbol.toStringTag,{value:"Module"}));function it(){var t=new Dn(3);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function D4(t){var e=new Dn(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Qo(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Qt(t,e,n){var r=new Dn(3);return r[0]=t,r[1]=e,r[2]=n,r}function mE(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function $t(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function vi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ln(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function vE(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function yE(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function lr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function zr(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function O4(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Za(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function R4(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function gn(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function zt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mn(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2];return t[0]=i*c-a*s,t[1]=a*o-r*c,t[2]=r*s-i*o,t}function Dt(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function K0(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function M4(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],c=Math.sqrt(n*n+r*r+i*i),l=Math.sqrt(a*a+o*o+s*s),f=c*l,u=f&&zt(t,e)/f;return Math.acos(Math.min(Math.max(u,-1),1))}function xE(t){return t[0]=0,t[1]=0,t[2]=0,t}function zm(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function jm(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=Gt*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=Gt*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=Gt*Math.max(1,Math.abs(i),Math.abs(s))}var Bn=Ln,wE=vE,N4=Qo;(function(){var t=it();return function(e,n,r,i,a,o){var s,c;for(n||(n=3),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();function CE(){var t=new Dn(4);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function TE(t,e,n,r){var i=new Dn(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function $m(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function _E(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t}function Js(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}(function(){var t=CE();return function(e,n,r,i,a,o){var s,c;for(n||(n=4),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();function sc(){var t=new Dn(4);return Dn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function c1(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function SE(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>Gt?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Hm(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],c=n[1],l=n[2],f=n[3];return t[0]=r*f+o*s+i*l-a*c,t[1]=i*f+o*c+a*s-r*l,t[2]=a*f+o*l+r*c-i*s,t[3]=o*f-r*s-i*c-a*l,t}function q0(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],c=n[0],l=n[1],f=n[2],u=n[3],h,p,d,g,y;return p=i*c+a*l+o*f+s*u,p<0&&(p=-p,c=-c,l=-l,f=-f,u=-u),1-p>Gt?(h=Math.acos(p),d=Math.sin(h),g=Math.sin((1-r)*h)/d,y=Math.sin(r*h)/d):(g=1-r,y=r),t[0]=g*i+y*c,t[1]=g*a+y*l,t[2]=g*o+y*f,t[3]=g*s+y*u,t}function bE(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function EE(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[a*3+o]-e[o*3+a])*r,t[a]=(e[a*3+i]+e[i*3+a])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var Km=TE,L4=_E;(function(){var t=it(),e=Qt(1,0,0),n=Qt(0,1,0);return function(r,i,a){var o=zt(i,a);return o<-.999999?(mn(t,e,i),N4(t)<1e-6&&mn(t,n,i),gn(t,t),c1(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(mn(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,L4(r,r))}})();(function(){var t=sc(),e=sc();return function(n,r,i,a,o,s){return q0(t,r,o,s),q0(e,i,a,s),q0(n,t,e,2*s*(1-s)),n}})();(function(){var t=e1();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],L4(e,EE(e,t))}})();function A4(){var t=new Dn(2);return Dn!=Float32Array&&(t[0]=0,t[1]=0),t}function qm(t,e){var n=new Dn(2);return n[0]=t,n[1]=e,n}function u1(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Of(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Xm(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}var Rf=Of;(function(){var t=A4();return function(e,n,r,i,a,o){var s,c;for(n||(n=2),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}})();function yi(t){const e=t.indexOf(":");return t.substring(e+1)}function F4(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return(e>>>0).toString(36)}const DE=1073741824;class OE{constructor(){this._imageCache=new Map,this._volumeCache=new Map,this._imageIdsToVolumeIdCache=new Map,this._referencedImageIdToImageIdCache=new Map,this._geometryCache=new Map,this._imageCacheSize=0,this._maxCacheSize=3*DE,this._geometryCacheSize=0,this.setMaxCacheSize=e=>{if(!e||typeof e!="number"){const n=`New max cacheSize ${this._maxCacheSize} should be defined and should be a number.`;throw new Error(n)}this._maxCacheSize=e},this.isCacheable=e=>{const n=this.getBytesAvailable(),r=Array.from(this._imageCache.values()).reduce((a,o)=>o.sharedCacheKey?a:a+o.sizeInBytes,0);return n+r>=e},this.getMaxCacheSize=()=>this._maxCacheSize,this.getCacheSize=()=>this._imageCacheSize,this._decacheImage=(e,n=!1)=>{const r=this._imageCache.get(e);if(!r)return;if(r.sharedCacheKey&&!n)throw new Error("Cannot decache an image with a shared cache key. You need to manually decache the volume first.");const{imageLoadObject:i}=r;r.image?.referencedImageId&&this._referencedImageIdToImageIdCache.delete(r.image.referencedImageId),i?.cancelFn&&i.cancelFn(),i?.decache&&i.decache(),this._imageCache.delete(e)},this._decacheVolume=e=>{const n=this._volumeCache.get(e);if(!n)return;const{volumeLoadObject:r,volume:i}=n;i&&(i.cancelLoading&&i.cancelLoading(),i.imageData&&i.imageData.delete(),r.cancelFn&&r.cancelFn(),i.imageIds&&i.imageIds.forEach(a=>{const o=this._imageCache.get(a);o&&o.sharedCacheKey===e&&(o.sharedCacheKey=void 0)}),this._volumeCache.delete(e))},this.purgeCache=()=>{const e=this._imageCache.keys();for(this.purgeVolumeCache();;){const{value:n,done:r}=e.next();if(r)break;this.removeImageLoadObject(n,{force:!0}),et(vt,Je.IMAGE_CACHE_IMAGE_REMOVED,{imageId:n})}},this.purgeVolumeCache=()=>{const e=this._volumeCache.keys();for(;;){const{value:n,done:r}=e.next();if(r)break;this.removeVolumeLoadObject(n),et(vt,Je.VOLUME_CACHE_VOLUME_REMOVED,{volumeId:n})}},this.getVolumeLoadObject=e=>{if(e===void 0)throw new Error("getVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(n)return n.timeStamp=Date.now(),n.volumeLoadObject},this.putGeometryLoadObject=(e,n)=>{if(e===void 0)throw new Error("putGeometryLoadObject: geometryId must not be undefined");if(n.promise===void 0)throw new Error("putGeometryLoadObject: geometryLoadObject.promise must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometryLoadObject: geometryId already present in geometryCache");if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putGeometryLoadObject: geometryLoadObject.cancel must be a function");const r={loaded:!1,geometryId:e,geometryLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._geometryCache.set(e,r),n.promise.then(i=>{try{this._putGeometryCommon(e,i,r)}catch(a){throw console.debug(`Error in _putGeometryCommon for geometry ${e}:`,a),a}}).catch(i=>{throw console.debug(`Error caching geometry ${e}:`,i),this._geometryCache.delete(e),i})},this.getGeometry=e=>{if(e===void 0)throw new Error("getGeometry: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometry},this.removeGeometryLoadObject=e=>{if(e===void 0)throw new Error("removeGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(!n)throw new Error("removeGeometryLoadObject: geometryId was not present in geometryCache");this.decrementGeometryCacheSize(n.sizeInBytes);const r={geometry:n,geometryId:e};et(vt,Je.GEOMETRY_CACHE_GEOMETRY_REMOVED,r),this._decacheGeometry(e)},this._decacheGeometry=e=>{const n=this._geometryCache.get(e);if(!n)return;const{geometryLoadObject:r}=n;r.cancelFn&&r.cancelFn(),r.decache&&r.decache(),this._geometryCache.delete(e)},this.incrementGeometryCacheSize=e=>{this._geometryCacheSize+=e},this.decrementGeometryCacheSize=e=>{this._geometryCacheSize-=e},this.getImageByReferencedImageId=e=>{const n=this._referencedImageIdToImageIdCache.get(e);if(n)return this._imageCache.get(n)?.image},this.getImage=(e,n=jr.FAR_REPLICATE)=>{if(e===void 0)throw new Error("getImage: imageId must not be undefined");const r=this._imageCache.get(e);if(r&&(r.timeStamp=Date.now(),!(r.image?.imageQualityStatus<n)))return r.image},this.getVolume=(e,n=!1)=>{if(e===void 0)throw new Error("getVolume: volumeId must not be undefined");const r=this._volumeCache.get(e);return r?(r.timeStamp=Date.now(),r.volume):n?[...this._volumeCache.values()].find(i=>i.volumeId.includes(e))?.volume:void 0},this.getVolumes=()=>Array.from(this._volumeCache.values()).map(n=>n.volume),this.filterVolumesByReferenceId=e=>this.getVolumes().filter(r=>r.referencedVolumeId===e),this.removeImageLoadObject=(e,{force:n=!1}={})=>{if(e===void 0)throw new Error("removeImageLoadObject: imageId must not be undefined");const r=this._imageCache.get(e);if(!r)throw new Error("removeImageLoadObject: imageId was not present in imageCache");this._decacheImage(e,n),this.incrementImageCacheSize(-r.sizeInBytes);const i={image:r,imageId:e};et(vt,Je.IMAGE_CACHE_IMAGE_REMOVED,i)},this.removeVolumeLoadObject=e=>{if(e===void 0)throw new Error("removeVolumeLoadObject: volumeId must not be undefined");const n=this._volumeCache.get(e);if(!n)throw new Error("removeVolumeLoadObject: volumeId was not present in volumeCache");const r={volume:n,volumeId:e};et(vt,Je.VOLUME_CACHE_VOLUME_REMOVED,r),this._decacheVolume(e)},this.incrementImageCacheSize=e=>{this._imageCacheSize+=e},this.decrementImageCacheSize=e=>{this._imageCacheSize-=e},this.getGeometryLoadObject=e=>{if(e===void 0)throw new Error("getGeometryLoadObject: geometryId must not be undefined");const n=this._geometryCache.get(e);if(n)return n.timeStamp=Date.now(),n.geometryLoadObject}}generateVolumeId(e){const n=e.map(yi).sort();let r=2166136261;for(const i of n){const a=F4(i);for(let o=0;o<a.length;o++)r^=a.charCodeAt(o),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24)}return`volume-${(r>>>0).toString(36)}`}getImageIdsForVolumeId(e){return Array.from(this._imageIdsToVolumeIdCache.entries()).filter(([n,r])=>r===e).map(([n])=>n)}getBytesAvailable(){return this.getMaxCacheSize()-this.getCacheSize()}decacheIfNecessaryUntilBytesAvailable(e,n){let r=this.getBytesAvailable();if(r>=e)return r;const i=Array.from(this._imageCache.values()).filter(c=>!c.sharedCacheKey);function a(c,l){return c.timeStamp>l.timeStamp?1:c.timeStamp<l.timeStamp?-1:0}i.sort(a);const o=i.map(c=>c.imageId);let s=o;n&&(s=o.filter(c=>!n.includes(c)));for(const c of s)if(this.removeImageLoadObject(c),et(vt,Je.IMAGE_CACHE_IMAGE_REMOVED,{imageId:c}),r=this.getBytesAvailable(),r>=e)return r;for(const c of o)if(this.removeImageLoadObject(c),et(vt,Je.IMAGE_CACHE_IMAGE_REMOVED,{imageId:c}),r=this.getBytesAvailable(),r>=e)return r}_putImageCommon(e,n,r){if(!this._imageCache.has(e)){console.warn("The image was purged from the cache before it completed loading.");return}if(!n){console.warn("Image is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putImageCommon: image.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putImageCommon: image.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(Je.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.image=n,r.sizeInBytes=n.sizeInBytes,this.incrementImageCacheSize(r.sizeInBytes);const i={image:r};n.referencedImageId&&this._referencedImageIdToImageIdCache.set(n.referencedImageId,e),et(vt,Je.IMAGE_CACHE_IMAGE_ADDED,i),r.sharedCacheKey=n.sharedCacheKey}async putImageLoadObject(e,n){if(e===void 0)throw console.error("putImageLoadObject: imageId must not be undefined"),new Error("putImageLoadObject: imageId must not be undefined");if(n.promise===void 0)throw console.error("putImageLoadObject: imageLoadObject.promise must not be undefined"),new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");const r=this._imageCache.get(e);if(r?.imageLoadObject)throw console.warn(`putImageLoadObject: imageId ${e} already in cache`),new Error("putImageLoadObject: imageId already in cache");if(n.cancelFn&&typeof n.cancelFn!="function")throw console.error("putImageLoadObject: imageLoadObject.cancel must be a function"),new Error("putImageLoadObject: imageLoadObject.cancel must be a function");const i={...r,loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._imageCache.set(e,i),this._imageCache.set(e,i),n.promise.then(a=>{try{this._putImageCommon(e,a,i)}catch(o){throw console.debug(`Error in _putImageCommon for image ${e}:`,o),o}}).catch(a=>{throw console.debug(`Error caching image ${e}:`,a),this._imageCache.delete(e),a})}putImageSync(e,n){if(e===void 0)throw new Error("putImageSync: imageId must not be undefined");if(this._imageCache.has(e))throw new Error("putImageSync: imageId already in cache");const r={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._imageCache.set(e,r);try{this._putImageCommon(e,n,r)}catch(i){throw this._imageCache.delete(e),i}}getImageLoadObject(e){if(e===void 0)throw new Error("getImageLoadObject: imageId must not be undefined");const n=this._imageCache.get(e);if(n)return n.timeStamp=Date.now(),n.imageLoadObject}isLoaded(e){const n=this._imageCache.get(e);return n?n.loaded:!1}getVolumeContainingImageId(e){const n=Array.from(this._volumeCache.keys()),r=yi(e);for(const i of n){const a=this._volumeCache.get(i);if(!a)return;const{volume:o}=a;if(!o.imageIds.length)return;const s=o.getImageURIIndex(r);if(s>-1)return{volume:o,imageIdIndex:s}}}getCachedImageBasedOnImageURI(e){const n=yi(e),i=Array.from(this._imageCache.keys()).find(a=>yi(a)===n);if(i)return this._imageCache.get(i)}_putVolumeCommon(e,n,r){if(!this._volumeCache.get(e)){console.warn("The volume was purged from the cache before it completed loading.");return}r.loaded=!0,r.volume=n,n.imageIds?.forEach(a=>{const o=this._imageCache.get(a);o&&(o.sharedCacheKey=e)});const i={volume:r};et(vt,Je.VOLUME_CACHE_VOLUME_ADDED,i)}putVolumeSync(e,n){if(e===void 0)throw new Error("putVolumeSync: volumeId must not be undefined");if(this._volumeCache.has(e))throw new Error("putVolumeSync: volumeId already in cache");const r={loaded:!1,volumeId:e,volumeLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._volumeCache.set(e,r);try{this._putVolumeCommon(e,n,r)}catch(i){throw this._volumeCache.delete(e),i}}async putVolumeLoadObject(e,n){if(e===void 0)throw new Error("putVolumeLoadObject: volumeId must not be undefined");if(n.promise===void 0)throw new Error("putVolumeLoadObject: volumeLoadObject.promise must not be undefined");if(this._volumeCache.has(e))throw new Error(`putVolumeLoadObject: volumeId:${e} already in cache`);if(n.cancelFn&&typeof n.cancelFn!="function")throw new Error("putVolumeLoadObject: volumeLoadObject.cancel must be a function");const r={loaded:!1,volumeId:e,volumeLoadObject:n,timeStamp:Date.now(),sizeInBytes:0};return this._volumeCache.set(e,r),n.promise.then(i=>{try{this._putVolumeCommon(e,i,r)}catch(a){throw console.error(`Error in _putVolumeCommon for volume ${e}:`,a),this._volumeCache.delete(e),a}}).catch(i=>{throw this._volumeCache.delete(e),i})}_putGeometryCommon(e,n,r){if(!this._geometryCache.get(e)){console.warn("The geometry was purged from the cache before it completed loading.");return}if(!n){console.warn("Geometry is undefined");return}if(n.sizeInBytes===void 0||Number.isNaN(n.sizeInBytes))throw new Error("_putGeometryCommon: geometry.sizeInBytes must not be undefined");if(n.sizeInBytes.toFixed===void 0)throw new Error("_putGeometryCommon: geometry.sizeInBytes is not a number");if(!this.isCacheable(n.sizeInBytes))throw new Error(Je.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(n.sizeInBytes),r.loaded=!0,r.geometry=n,r.sizeInBytes=n.sizeInBytes,this.incrementGeometryCacheSize(r.sizeInBytes);const i={geometry:r};et(vt,Je.GEOMETRY_CACHE_GEOMETRY_ADDED,i)}putGeometrySync(e,n){if(e===void 0)throw new Error("putGeometrySync: geometryId must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometrySync: geometryId already in cache");const r={loaded:!1,geometryId:e,geometryLoadObject:{promise:Promise.resolve(n)},timeStamp:Date.now(),sizeInBytes:0};this._geometryCache.set(e,r);try{this._putGeometryCommon(e,n,r)}catch(i){throw this._geometryCache.delete(e),i}}setPartialImage(e,n){const r=this._imageCache.get(e);if(!r){n&&this._imageCache.set(e,{image:n,imageId:e,loaded:!1,timeStamp:Date.now(),sizeInBytes:0});return}r.loaded&&(r.loaded=!1,r.imageLoadObject=null,this.incrementImageCacheSize(-r.sizeInBytes),r.sizeInBytes=0),r.image=n||r.image}getImageQuality(e){const n=this._imageCache.get(e)?.image;return n?n.imageQualityStatus||jr.FULL_RESOLUTION:void 0}}const at=new OE;function I4(t,e,n){return Math.abs(t-e)<=n}function RE(t,e,n=1e-5){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!I4(t[r],e[r],n))return!1;return!0}function Ym(t){return typeof t=="number"}function Jm(t){return t&&typeof t=="object"&&"length"in t&&typeof t.length=="number"&&t.length>0&&typeof t[0]=="number"}function Un(t,e,n=1e-5){return typeof t!=typeof e||t===null||e===null?!1:Ym(t)&&Ym(e)?I4(t,e,n):Jm(t)&&Jm(e)?RE(t,e,n):!1}const P4=t=>typeof t=="number"?-t:t?.map?t.map(P4):!t,Vd=t=>typeof t=="number"?Math.abs(t):t?.map?t.map(Vd):t,V4=(t,e,n=void 0)=>Un(t,P4(e),n),ME=(t,e,n=void 0)=>Un(Vd(t),Vd(e),n);function k4(t){return Array.isArray(t)?k4(t[0]):isFinite(t)&&!isNaN(t)}function ki(t){return Hr(t,"vtkVolume")||Hr(t,"vtkImageSlice")}function Hr(t,e){const n="isA"in t?t:t.actor;return n?!!n.isA(e):!1}const l1=new Map;function NE(t){t.name=t.name||t.Name,l1.set(t.name,t)}function pl(t){return l1.get(t)}function U4(){return Array.from(l1.keys())}function f1(t,e){const n=fl.rgbPresetNames.map(s=>fl.getPresetByName(s)),r=U4().map(s=>pl(s)),a=n.concat(r).find(s=>{const{RGBPoints:c}=s;if(c.length!==t.length)return!1;for(let l=0;l<c.length;l+=4)if(!Un(c.slice(l+1,l+4),t.slice(l+1,l+4)))return!1;return!0});if(!a)return null;const o=[];if(Hr(e,"vtkVolume")){const s=e.getProperty().getScalarOpacity(0).getDataPointer();if(!s)return{name:a.Name};for(let c=0;c<s.length;c+=2)o.push({value:s[c],opacity:s[c+1]})}return{name:a.Name,opacity:o}}function LE(t){const{volumeActor:e,preset:n,opacity:r=.9,threshold:i=null,colorRange:a=[0,5]}=t;e.getMapper().setSampleDistance(1);const s=rs.newInstance(),c=n||fl.getPresetByName("hsv");s.applyColorMap(c),s.setMappingRange(a[0],a[1]),e.getProperty().setRGBTransferFunction(0,s),h1(e,r,i)}function B4(t,e){const n=p1(t);h1(t,e,n)}function G4(t,e){const n=d1(t);h1(t,n,e)}function h1(t,e,n){const r=t.getMapper().getInputData().get("voxelManager");if(!r?.voxelManager)throw new Error("No voxel manager was found for the volume actor, or you cannot yet update opacity with a threshold using stacked images");const i=r.voxelManager.getRange(),a=$c.newInstance();if(n!==null){const o=Math.abs(i[1]-i[0])*.001,s=Math.max(i[0],Math.min(i[1],n));a.addPoint(i[0],0),a.addPoint(s-o,0),a.addPoint(s,e),a.addPoint(i[1],e)}else a.addPoint(i[0],e),a.addPoint(i[1],e);t.getProperty().setScalarOpacity(0,a)}function p1(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return null;const n=e.getDataPointer();if(!n||n.length<=4)return null;for(let r=0;r<n.length-2;r+=2){n[r];const i=n[r+1],a=n[r+2],o=n[r+3];if(i===0&&o>0)return a}return null}function d1(t){const e=t.getProperty().getScalarOpacity(0);if(!e)return 1;const n=e.getDataPointer();if(!n||n.length===0)return 1;let r=0;for(let i=1;i<n.length;i+=2)n[i]>r&&(r=n[i]);return r}const AE=Object.freeze(Object.defineProperty({__proto__:null,findMatchingColormap:f1,getColormap:pl,getColormapNames:U4,getMaxOpacity:d1,getThresholdValue:p1,registerColormap:NE,setColorMapTransferFunctionForVolumeActor:LE,updateOpacity:B4,updateThreshold:G4},Symbol.toStringTag,{value:"Module"}));function Hu(t){if(!t)return;const e=t.getSize();for(let n=0;n<e;n++){const r=[];t.getNodeValue(n,r),r[1]=1-r[1],r[2]=1-r[2],r[3]=1-r[3],t.setNodeValue(n,r)}}const kd=(t,e,n)=>e-n/4*Math.log((1-t)/t);function _h(t,e){const n=Math.abs(e-t)+1,r=(t+e+1)/2;return{windowWidth:n,windowCenter:r}}function Ku(t,e,n=ar.LINEAR){if(n===ar.LINEAR)return{lower:e-.5-(t-1)/2,upper:e-.5+(t-1)/2};if(n===ar.LINEAR_EXACT)return{lower:e-t/2,upper:e+t/2};if(n===ar.SAMPLED_SIGMOID){const r=kd(.01,e,t),i=kd(.99,e,t);return{lower:r,upper:i}}else throw new Error("Invalid VOI LUT function")}const FE=Object.freeze(Object.defineProperty({__proto__:null,toLowHighRange:Ku,toWindowLevel:_h},Symbol.toStringTag,{value:"Module"}));function g1(t,e=1024){const{windowWidth:n,windowCenter:r}=_h(t.lower,t.upper),a=Array.from({length:e},(s,c)=>(c+1)/(e+2)).flatMap(s=>[kd(s,r,n),s,s,s,.5,0]),o=rs.newInstance();return o.buildFunctionFromArray(ft.newInstance({values:a,numberOfComponents:6})),o}function Sh(t,e){return t.worldToIndex(e).map(Math.round)}function X0(t,e){return t.worldToIndex(e)}function Mf(t){const e=t.getSize(),n=[];for(let r=0;r<e;r++){const i=[];t.getNodeValue(r,i),n.push(i)}return n}function bh(t,e){e?.length&&(t.removeAllPoints(),e.forEach(n=>{t.addRGBPoint(...n)}))}const IE=Object.freeze(Object.defineProperty({__proto__:null,getTransferFunctionNodes:Mf,setTransferFunctionNodes:bh},Symbol.toStringTag,{value:"Module"}));function PE(t,e){e.classHierarchy.push("vtkImplicitFunction"),t.functionValue=n=>{if(!e.transform)return t.evaluateFunction(n);const r=[];return e.transform.transformPoint(n,r),t.evaluateFunction(r)},t.evaluateFunction=n=>{J.vtkErrorMacro("not implemented")}}const VE={};function W4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VE,n),J.obj(t,e),J.setGet(t,e,["transform"]),PE(t,e)}const kE=J.newInstance(W4,"vtkImplicitFunction");var UE={newInstance:kE,extend:W4};const Ud=1e-6,z4="coincide",j4="disjoint";function BE(t,e,n){return t[0]*(n[0]-e[0])+t[1]*(n[1]-e[1])+t[2]*(n[2]-e[2])}function $4(t,e,n){const r=n[0]*(t[0]-e[0])+n[1]*(t[1]-e[1])+n[2]*(t[2]-e[2]);return Math.abs(r)}function H4(t,e,n,r){const i=[];Ja(t,e,i);const a=Et(n,i);r[0]=t[0]-a*n[0],r[1]=t[1]-a*n[1],r[2]=t[2]-a*n[2]}function K4(t,e,n){const r=Et(t,e);let i=Et(e,e);return i===0&&(i=1),n[0]=t[0]-r*e[0]/i,n[1]=t[1]-r*e[1]/i,n[2]=t[2]-r*e[2]/i,n}function q4(t,e,n,r){const i=[];Ja(t,e,i);const a=Et(n,i),o=Et(n,n);o!==0?(r[0]=t[0]-a*n[0]/o,r[1]=t[1]-a*n[1]/o,r[2]=t[2]-a*n[2]/o):(r[0]=t[0],r[1]=t[1],r[2]=t[2])}function X4(t,e,n,r){const i={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],o=[];Ja(e,t,a),Ja(n,t,o);const s=Et(r,o),c=Et(r,a);let l,f;return c<0?l=-c:l=c,s<0?f=-s*Ud:f=s*Ud,l<=f||(i.t=s/c,i.x[0]=t[0]+i.t*a[0],i.x[1]=t[1]+i.t*a[1],i.x[2]=t[2]+i.t*a[2],i.intersection=!0,i.betweenPoints=i.t>=0&&i.t<=1),i}function Y4(t,e,n,r){const i={intersection:!1,l0:[],l1:[],error:null},a=[];ga(e,r,a);const o=a.map(u=>Math.abs(u));if(o[0]+o[1]+o[2]<Ud){const u=[];return Ja(t,n,u),Et(e,u)===0?i.error=z4:i.error=j4,i}let s;o[0]>o[1]&&o[0]>o[2]?s="x":o[1]>o[2]?s="y":s="z";const c=[],l=-Et(e,t),f=-Et(r,n);switch(s){case"x":c[0]=0,c[1]=(f*e[2]-l*r[2])/a[0],c[2]=(l*r[1]-f*e[1])/a[0];break;case"y":c[0]=(l*r[2]-f*e[2])/a[1],c[1]=0,c[2]=(f*e[0]-l*r[0])/a[1];break;case"z":c[0]=(f*e[1]-l*r[1])/a[2],c[1]=(l*r[0]-f*e[0])/a[2],c[2]=0;break}return i.l0=c,_f(c,a,i.l1),i.intersection=!0,i}const GE={evaluate:BE,distanceToPlane:$4,projectPoint:H4,projectVector:K4,generalizedProjectPoint:q4,intersectWithLine:X4,intersectWithPlane:Y4,DISJOINT:j4,COINCIDE:z4};function WE(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=n=>$4(n,e.origin,e.normal),t.projectPoint=(n,r)=>{H4(n,e.origin,e.normal,r)},t.projectVector=(n,r)=>K4(n,e.normal,r),t.push=n=>{if(n!==0)for(let r=0;r<3;r++)e.origin[r]+=n*e.normal[r]},t.generalizedProjectPoint=(n,r)=>{q4(n,e.origin,e.normal,r)},t.evaluateFunction=(n,r,i)=>Array.isArray(n)?e.normal[0]*(n[0]-e.origin[0])+e.normal[1]*(n[1]-e.origin[1])+e.normal[2]*(n[2]-e.origin[2]):e.normal[0]*(n-e.origin[0])+e.normal[1]*(r-e.origin[1])+e.normal[2]*(i-e.origin[2]),t.evaluateGradient=n=>[e.normal[0],e.normal[1],e.normal[2]],t.intersectWithLine=(n,r)=>X4(n,r,e.origin,e.normal),t.intersectWithPlane=(n,r)=>Y4(n,r,e.origin,e.normal)}const zE={normal:[0,0,1],origin:[0,0,0]};function J4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zE,n),UE.extend(t,e,n),J.setGetArray(t,e,["normal","origin"],3),WE(t,e)}const jE=J.newInstance(J4,"vtkPlane");var hr={newInstance:jE,extend:J4,...GE};const Eh=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function Z4(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function no(t){return t?.length>=6&&t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function m1(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function v1(t){return m1(t,Eh)}function Nf(t,e,n,r){const[i,a,o,s,c,l]=t;return t[0]=i<e?i:e,t[1]=a>e?a:e,t[2]=o<n?o:n,t[3]=s>n?s:n,t[4]=c<r?c:r,t[5]=l>r?l:r,t}function y1(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(let n=0;n<e.length;++n)Nf(t,...e[n]);else for(let n=0;n<e.length;n+=3)Nf(t,...e.slice(n,n+3));return t}function Q4(t,e,n,r,i,a,o){const[s,c,l,f,u,h]=t;return o===void 0?(t[0]=Math.min(e[0],s),t[1]=Math.max(e[1],c),t[2]=Math.min(e[2],l),t[3]=Math.max(e[3],f),t[4]=Math.min(e[4],u),t[5]=Math.max(e[5],h)):(t[0]=Math.min(e,s),t[1]=Math.max(n,c),t[2]=Math.min(r,l),t[3]=Math.max(i,f),t[4]=Math.min(a,u),t[5]=Math.max(o,h)),t}function ex(t,e,n,r){const[i,a,o,s,c,l]=t;return t[0]=e,t[1]=e>a?e:a,t[2]=n,t[3]=n>s?n:s,t[4]=r,t[5]=r>l?r:l,i!==e||o!==n||c!==r}function tx(t,e,n,r){const[i,a,o,s,c,l]=t;return t[0]=e<i?e:i,t[1]=e,t[2]=n<o?n:o,t[3]=n,t[4]=r<c?r:c,t[5]=r,a!==e||s!==n||l!==r}function nx(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function x1(t,e,n,r){return no(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),n>=0?(t[2]*=n,t[3]*=n):(t[2]=n*t[3],t[3]=n*t[2]),r>=0?(t[4]*=r,t[5]*=r):(t[4]=r*t[5],t[5]=r*t[4]),!0):!1}function w1(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function $E(t,e,n,r){if(!no(t))return!1;const i=w1(t);return t[0]-=i[0],t[1]-=i[0],t[2]-=i[1],t[3]-=i[1],t[4]-=i[2],t[5]-=i[2],x1(t,e,n,r),t[0]+=i[0],t[1]+=i[0],t[2]+=i[1],t[3]+=i[1],t[4]+=i[2],t[5]+=i[2],!0}function qu(t,e){return t[e*2+1]-t[e*2]}function Dh(t){return[qu(t,0),qu(t,1),qu(t,2)]}function rx(t){return t.slice(0,2)}function ix(t){return t.slice(2,4)}function ax(t){return t.slice(4,6)}function ox(t){const e=Dh(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function sx(t){if(no(t)){const e=Dh(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function C1(t){return[t[0],t[2],t[4]]}function T1(t){return[t[1],t[3],t[5]]}function i0(t,e){return t<=0&&e>=0||t>=0&&e<=0}function _1(t,e){let n=0;for(let r=0;r<2;r++)for(let i=2;i<4;i++)for(let a=4;a<6;a++)e[n++]=[t[r],t[i],t[a]];return e}function cx(t,e,n){return e[0]=t[0],e[1]=t[2],e[2]=t[4],n[0]=t[1],n[1]=t[3],n[2]=t[5],e}function ux(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=_1(t,[]);for(let i=0;i<r.length;++i)Dt(r[i],r[i],e);return v1(n),y1(n,r)}function lx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function fx(t,e,n,r){const i=[].concat(Eh),a=t.getData();for(let o=0;o<a.length;o+=3){const s=[a[o],a[o+1],a[o+2]],c=Et(s,e);i[0]=Math.min(c,i[0]),i[1]=Math.max(c,i[1]);const l=Et(s,n);i[2]=Math.min(l,i[2]),i[3]=Math.max(l,i[3]);const f=Et(s,r);i[4]=Math.min(f,i[4]),i[5]=Math.max(f,i[5])}return i}function hx(t,e,n,r,i){let a=!0;const o=[];let s=0;const c=[],l=[0,0,0],f=0,u=1,h=2;for(let p=0;p<3;p++)e[p]<t[2*p]?(o[p]=u,l[p]=t[2*p],a=!1):e[p]>t[2*p+1]?(o[p]=f,l[p]=t[2*p+1],a=!1):o[p]=h;if(a)return r[0]=e[0],r[1]=e[1],r[2]=e[2],i[0]=0,1;for(let p=0;p<3;p++)o[p]!==h&&n[p]!==0?c[p]=(l[p]-e[p])/n[p]:c[p]=-1;for(let p=0;p<3;p++)c[s]<c[p]&&(s=p);if(c[s]>1||c[s]<0)return 0;i[0]=c[s];for(let p=0;p<3;p++)if(s!==p){if(r[p]=e[p]+c[s]*n[p],r[p]<t[2*p]||r[p]>t[2*p+1])return 0}else r[p]=l[p];return 1}function px(t,e,n){const r=[];let i=0,a=1,o=1;for(let s=4;s<=5;++s){r[2]=t[s];for(let c=2;c<=3;++c){r[1]=t[c];for(let l=0;l<=1;++l)if(r[0]=t[l],i=hr.evaluate(n,e,r),o&&(a=i>=0?1:-1,o=0),i===0||a>0&&i<0||a<0&&i>0)return 1}}return 0}function dx(t,e){if(!(no(t)&&no(e)))return!1;const n=[0,0,0,0,0,0];let r;for(let i=0;i<3;i++)if(r=!1,e[i*2]>=t[i*2]&&e[i*2]<=t[i*2+1]?(r=!0,n[i*2]=e[i*2]):t[i*2]>=e[i*2]&&t[i*2]<=e[i*2+1]&&(r=!0,n[i*2]=t[i*2]),e[i*2+1]>=t[i*2]&&e[i*2+1]<=t[i*2+1]?(r=!0,n[i*2+1]=e[2*i+1]):t[i*2+1]>=e[i*2]&&t[i*2+1]<=e[i*2+1]&&(r=!0,n[i*2+1]=t[i*2+1]),!r)return!1;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],!0}function Lf(t,e){if(!(no(t)&&no(e)))return!1;for(let n=0;n<3;n++)if(!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1]))return!1;return!0}function Af(t,e,n,r){return!(e<t[0]||e>t[1]||n<t[2]||n>t[3]||r<t[4]||r>t[5])}function HE(t,e){return!(!Lf(t,e)||!Af(t,...C1(e))||!Af(t,...T1(e)))}function gx(t,e,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],i=[0,0,0,0,0,0,0,0];let a=0;for(let u=0;u<2;u++)for(let h=2;h<4;h++)for(let p=4;p<6;p++){const d=[t[u],t[h],t[p]];i[a++]=hr.evaluate(n,e,d)}let o=2;for(;o--&&!(i0(i[r[o][0]],i[r[o][4]])&&i0(i[r[o][1]],i[r[o][5]])&&i0(i[r[o][2]],i[r[o][6]])&&i0(i[r[o][3]],i[r[o][7]])););if(o<0)return!1;const s=Math.sign(n[o]),c=Math.abs((t[o*2+1]-t[o*2])*n[o]);let l=s>0?1:0;for(let u=0;u<4;u++){if(c===0)continue;const h=Math.abs(i[r[o][u]])/c;s>0&&h<l&&(l=h),s<0&&h>l&&(l=h)}const f=(1-l)*t[o*2]+l*t[o*2+1];return s>0?t[o*2]=f:t[o*2+1]=f,!0}class KE{constructor(e){this.bounds=e,this.bounds||(this.bounds=new Float64Array(Eh))}getBounds(){return this.bounds}equals(e){return Z4(this.bounds,e)}isValid(){return no(this.bounds)}setBounds(e){return m1(this.bounds,e)}reset(){return v1(this.bounds)}addPoint(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Nf(this.bounds,...n)}addPoints(e){return y1(this.bounds,e)}addBounds(e,n,r,i,a,o){return Q4(this.bounds,e,n,r,i,a,o)}setMinPoint(e,n,r){return ex(this.bounds,e,n,r)}setMaxPoint(e,n,r){return tx(this.bounds,e,n,r)}inflate(e){return nx(this.bounds,e)}scale(e,n,r){return x1(this.bounds,e,n,r)}getCenter(){return w1(this.bounds)}getLength(e){return qu(this.bounds,e)}getLengths(){return Dh(this.bounds)}getMaxLength(){return ox(this.bounds)}getDiagonalLength(){return sx(this.bounds)}getMinPoint(){return C1(this.bounds)}getMaxPoint(){return T1(this.bounds)}getXRange(){return rx(this.bounds)}getYRange(){return ix(this.bounds)}getZRange(){return ax(this.bounds)}getCorners(e){return _1(this.bounds,e)}computeCornerPoints(e,n){return cx(this.bounds,e,n)}computeLocalBounds(e,n,r){return fx(this.bounds,e,n,r)}transformBounds(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ux(this.bounds,e,n)}computeScale3(e){return lx(this.bounds,e)}cutWithPlane(e,n){return gx(this.bounds,e,n)}intersectBox(e,n,r,i){return hx(this.bounds,e,n,r,i)}intersectPlane(e,n){return px(this.bounds,e,n)}intersect(e){return dx(this.bounds,e)}intersects(e){return Lf(this.bounds,e)}containsPoint(e,n,r){return Af(this.bounds,e,n,r)}contains(e){return Lf(this.bounds,e)}}function qE(t){const e=t&&t.bounds;return new KE(e)}const XE={equals:Z4,isValid:no,setBounds:m1,reset:v1,addPoint:Nf,addPoints:y1,addBounds:Q4,setMinPoint:ex,setMaxPoint:tx,inflate:nx,scale:x1,scaleAboutCenter:$E,getCenter:w1,getLength:qu,getLengths:Dh,getMaxLength:ox,getDiagonalLength:sx,getMinPoint:C1,getMaxPoint:T1,getXRange:rx,getYRange:ix,getZRange:ax,getCorners:_1,computeCornerPoints:cx,computeLocalBounds:fx,transformBounds:ux,computeScale3:lx,cutWithPlane:gx,intersectBox:hx,intersectPlane:px,intersect:dx,intersects:Lf,containsPoint:Af,contains:HE,INIT_BOUNDS:Eh};var Kt={newInstance:qE,...XE};const YE={DISPLAY:0,WORLD:1};var mx={CoordinateSystem:YE};const{CoordinateSystem:Bd}=mx;function Zm(t){return()=>J.vtkErrorMacro(`vtkProp::${t} - NOT IMPLEMENTED`)}function JE(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=()=>{let n=e.mtime;for(let r=0;r<e.textures.length;++r){const i=e.textures[r].getMTime();i>n&&(n=i)}return n},t.processSelectorPixelBuffers=(n,r)=>{},t.getNestedProps=()=>null,t.getActors=()=>[],t.getActors2D=()=>[],t.getVolumes=()=>[],t.pick=Zm("pick"),t.hasKey=Zm("hasKey"),t.getNestedVisibility=()=>e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility()),t.getNestedPickable=()=>e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable()),t.getNestedDragable=()=>e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable()),t.getRedrawMTime=()=>e.mtime,t.setEstimatedRenderTime=n=>{e.estimatedRenderTime=n,e.savedEstimatedRenderTime=n},t.restoreEstimatedRenderTime=()=>{e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=n=>{e.estimatedRenderTime+=n},t.setAllocatedRenderTime=n=>{e.allocatedRenderTime=n,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=()=>!1,t.getTextures=()=>e.textures,t.hasTexture=n=>e.textures.indexOf(n)!==-1,t.addTexture=n=>{n&&!t.hasTexture(n)&&(e.textures=e.textures.concat(n),t.modified())},t.removeTexture=n=>{const r=e.textures.filter(i=>i!==n);e.textures.length!==r.length&&(e.textures=r,t.modified())},t.removeAllTextures=()=>{e.textures=[],t.modified()},t.setCoordinateSystemToWorld=()=>t.setCoordinateSystem(Bd.WORLD),t.setCoordinateSystemToDisplay=()=>t.setCoordinateSystem(Bd.DISPLAY)}const ZE={allocatedRenderTime:10,coordinateSystem:Bd.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function vx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZE,n),J.obj(t,e),J.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),J.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),J.moveToProtected(t,e,["parentProp"]),JE(t,e)}const QE=J.newInstance(vx,"vtkProp");var kl={newInstance:QE,extend:vx,...mx};const eD=1e-6;function tD(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=r=>{e.position=e.position.map((i,a)=>i+r[a]),t.modified()},t.getOrientationWXYZ=()=>{const r=sc();Pd(r,e.rotation);const i=new Float64Array(3),a=SE(i,r);return[Tf(a),i[0],i[1],i[2]]},t.getOrientationQuaternion=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Pd(r,e.rotation)},t.rotateX=r=>{r!==0&&(n1(e.rotation,e.rotation,Cn(r)),t.modified())},t.rotateY=r=>{r!==0&&(r1(e.rotation,e.rotation,Cn(r)),t.modified())},t.rotateZ=r=>{r!==0&&(i1(e.rotation,e.rotation,Cn(r)),t.modified())},t.rotateWXYZ=(r,i,a,o)=>{if(r===0||i===0&&a===0&&o===0)return;const s=Cn(r),c=sc();c1(c,[i,a,o],s);const l=new Float64Array(16);Ef(l,c),It(e.rotation,e.rotation,l),t.modified()},t.rotateQuaternion=r=>{if(Math.abs(r[3])>=1-eD)return;const i=Ef(new Float64Array(16),r);It(e.rotation,e.rotation,i),t.modified()},t.setOrientation=(r,i,a)=>r===e.orientation[0]&&i===e.orientation[1]&&a===e.orientation[2]?!1:(e.orientation=[r,i,a],ut(e.rotation),t.rotateZ(a),t.rotateX(r),t.rotateY(i),t.modified(),!0),t.setUserMatrix=r=>Fl(e.userMatrix,r)?!1:(pn(e.userMatrix,r),t.modified(),!0),t.getMatrix=()=>(t.computeMatrix(),e.matrix),t.computeMatrix=()=>{if(t.getMTime()>e.matrixMTime.getMTime()){ut(e.matrix),e.userMatrix&&It(e.matrix,e.matrix,e.userMatrix),hn(e.matrix,e.matrix,e.origin),hn(e.matrix,e.matrix,e.position),It(e.matrix,e.matrix,e.rotation),va(e.matrix,e.matrix,e.scale),hn(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),Rt(e.matrix,e.matrix),e.isIdentity=!0;for(let r=0;r<4;++r)for(let i=0;i<4;++i)(r===i?1:0)!==e.matrix[r+i*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=()=>Kt.getCenter(e.bounds),t.getLength=()=>Kt.getLength(e.bounds),t.getXRange=()=>Kt.getXRange(e.bounds),t.getYRange=()=>Kt.getYRange(e.bounds),t.getZRange=()=>Kt.getZRange(e.bounds),t.getUserMatrix=()=>e.userMatrix;function n(){t.computeMatrix()}t.onModified(n)}const nD={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function yx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nD,n),kl.extend(t,e,n),e.matrixMTime={},J.obj(e.matrixMTime),J.get(t,e,["bounds","isIdentity"]),J.getArray(t,e,["orientation"]),J.setGetArray(t,e,["origin","position","scale"],3),e.matrix=ut(new Float64Array(16)),e.rotation=ut(new Float64Array(16)),e.userMatrix=ut(new Float64Array(16)),e.transform=null,tD(t,e)}const rD=J.newInstance(yx,"vtkProp3D");var S1={newInstance:rD,extend:yx};const Gd={NEAREST:0,LINEAR:1,FAST_LINEAR:2},xx={FRACTIONAL:0,PROPORTIONAL:1},Y0={CUSTOM:0,ADDITIVE:1,COLORIZE:2};var wx={InterpolationType:Gd,OpacityMode:xx,ColorMixPreset:Y0};const{InterpolationType:Ru,OpacityMode:iD}=wx,{vtkErrorMacro:xp}=J,J0=4;function aD(t,e){e.classHierarchy.push("vtkVolumeProperty"),t.getMTime=()=>{let i=e.mtime,a;for(let o=0;o<J0;o++)e.componentData[o].colorChannels===1?e.componentData[o].grayTransferFunction&&(a=e.componentData[o].grayTransferFunction.getMTime(),i=i>a?i:a):e.componentData[o].colorChannels===3&&e.componentData[o].rGBTransferFunction&&(a=e.componentData[o].rGBTransferFunction.getMTime(),i=i>a?i:a),e.componentData[o].scalarOpacity&&(a=e.componentData[o].scalarOpacity.getMTime(),i=i>a?i:a),e.componentData[o].gradientOpacity&&(e.componentData[o].disableGradientOpacity||(a=e.componentData[o].gradientOpacity.getMTime(),i=i>a?i:a));return i},t.getColorChannels=i=>i<0||i>3?(xp("Bad index - must be between 0 and 3"),0):e.componentData[i].colorChannels,t.setGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].grayTransferFunction!==a&&(e.componentData[i].grayTransferFunction=a,o=!0),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1,o=!0),o&&t.modified(),o},t.getGrayTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].grayTransferFunction===null&&(e.componentData[i].grayTransferFunction=$c.newInstance(),e.componentData[i].grayTransferFunction.addPoint(0,0),e.componentData[i].grayTransferFunction.addPoint(1024,1),e.componentData[i].colorChannels!==1&&(e.componentData[i].colorChannels=1),t.modified()),e.componentData[i].grayTransferFunction},t.setRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=!1;return e.componentData[i].rGBTransferFunction!==a&&(e.componentData[i].rGBTransferFunction=a,o=!0),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3,o=!0),o&&t.modified(),o},t.getRGBTransferFunction=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].rGBTransferFunction===null&&(e.componentData[i].rGBTransferFunction=rs.newInstance(),e.componentData[i].rGBTransferFunction.addRGBPoint(0,0,0,0),e.componentData[i].rGBTransferFunction.addRGBPoint(1024,1,1,1),e.componentData[i].colorChannels!==3&&(e.componentData[i].colorChannels=3),t.modified()),e.componentData[i].rGBTransferFunction},t.setScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return e.componentData[i].scalarOpacity!==a?(e.componentData[i].scalarOpacity=a,t.modified(),!0):!1},t.getScalarOpacity=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[i].scalarOpacity===null&&(e.componentData[i].scalarOpacity=$c.newInstance(),e.componentData[i].scalarOpacity.addPoint(0,1),e.componentData[i].scalarOpacity.addPoint(1024,1),t.modified()),e.componentData[i].scalarOpacity},t.setComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(i<0||i>=J0)return xp("Invalid index"),!1;const o=Math.min(1,Math.max(0,a));return e.componentData[i].componentWeight!==o?(e.componentData[i].componentWeight=o,t.modified(),!0):!1},t.getComponentWeight=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return i<0||i>=J0?(xp("Invalid index"),0):e.componentData[i].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(Ru.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(Ru.LINEAR),t.setInterpolationTypeToFastLinear=()=>t.setInterpolationType(Ru.FAST_LINEAR),t.getInterpolationTypeAsString=()=>J.enumToString(Ru,e.interpolationType),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=J.capitalize(i);t[`set${a}`]=(o,s)=>e.componentData[o][`${i}`]!==s?(e.componentData[o][`${i}`]=s,t.modified(),!0):!1}),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach(i=>{const a=J.capitalize(i);t[`get${a}`]=o=>e.componentData[o][`${i}`]})}const oD={colorMixPreset:null,independentComponents:!0,interpolationType:Ru.FAST_LINEAR,shade:!1,ambient:.1,diffuse:.7,specular:.2,specularPower:10,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function sD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,oD,n),J.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<J0;++r)e.componentData.push({colorChannels:1,grayTransferFunction:null,rGBTransferFunction:null,scalarOpacity:null,scalarOpacityUnitDistance:1,opacityMode:iD.FRACTIONAL,gradientOpacityMinimumValue:0,gradientOpacityMinimumOpacity:0,gradientOpacityMaximumValue:1,gradientOpacityMaximumOpacity:1,useGradientOpacity:!1,componentWeight:1,forceNearestInterpolation:!1})}J.setGet(t,e,["colorMixPreset","independentComponents","interpolationType","shade","ambient","diffuse","specular","specularPower","useLabelOutline","labelOutlineOpacity"]),J.setGetArray(t,e,["labelOutlineThickness"]),aD(t,e)}const cD=J.newInstance(sD,"vtkVolumeProperty");var uD={newInstance:cD,...wx};const{vtkDebugMacro:lD}=J;function fD(t,e){e.classHierarchy.push("vtkVolume"),t.getVolumes=()=>t,t.makeProperty=uD.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){lD("Recomputing bounds..."),e.mapperBounds=n.map(o=>o);const i=[];Kt.getCorners(n,i),t.computeMatrix();const a=new Float64Array(16);Rt(a,e.matrix),i.forEach(o=>Dt(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((c,l)=>c>l[s/2]?l[s/2]:c,o):i.reduce((c,l)=>c<l[(s-1)/2]?l[(s-1)/2]:c,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}return n}}const hD={mapper:null,property:null,bounds:[1,-1,1,-1,1,-1]};function Cx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hD,n),S1.extend(t,e,n),e.boundsMTime={},J.obj(e.boundsMTime),J.set(t,e,["property"]),J.setGet(t,e,["mapper"]),J.getArray(t,e,["bounds"],6),fD(t,e)}const pD=J.newInstance(Cx,"vtkVolume");var dD={newInstance:pD,extend:Cx};const{vtkErrorMacro:gD}=J,mD=["Build","Render"];function vD(t,e){e.classHierarchy.push("vtkViewNode"),t.build=r=>{},t.render=r=>{},t.traverse=r=>{const i=r.getTraverseOperation(),a=t[i];if(a){a(r);return}t.apply(r,!0);for(let o=0;o<e.children.length;o++)e.children[o].traverse(r);t.apply(r,!1)},t.apply=(r,i)=>{const a=t[r.getOperation()];a&&a(i,r)},t.getViewNodeFor=r=>{if(e.renderable===r)return t;for(let i=0;i<e.children.length;++i){const o=e.children[i].getViewNodeFor(r);if(o)return o}},t.getFirstAncestorOfType=r=>e._parent?e._parent.isA(r)?e._parent:e._parent.getFirstAncestorOfType(r):null,t.getLastAncestorOfType=r=>{if(!e._parent)return null;const i=e._parent.getLastAncestorOfType(r);return i||(e._parent.isA(r)?e._parent:null)},t.addMissingNode=r=>{if(!r)return;const i=e._renderableChildMap.get(r);if(i!==void 0)return i.setVisited(!0),i;const a=t.createViewNode(r);if(a)return a.setParent(t),a.setVisited(!0),e._renderableChildMap.set(r,a),e.children.push(a),a},t.addMissingNodes=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];t.addMissingNode(a)}},t.addMissingChildren=r=>{if(!(!r||!r.length))for(let i=0;i<r.length;++i){const a=r[i];if(e.children.indexOf(a)===-1){a.setParent(t),e.children.push(a);const s=a.getRenderable();s&&e._renderableChildMap.set(s,a)}a.setVisited(!0)}},t.removeNode=r=>{const i=e.children.findIndex(o=>o===r);if(i<0)return!1;const a=r.getRenderable();return a&&e._renderableChildMap.delete(a),r.delete(),e.children.splice(i,1),!0},t.prepareNodes=()=>{for(let r=0;r<e.children.length;++r)e.children[r].setVisited(!1)},t.setVisited=r=>{e.visited=r},t.removeUnusedNodes=()=>{let r=0;for(let i=0;i<e.children.length;++i){const a=e.children[i];if(a.getVisited())e.children[r++]=a,a.setVisited(!1);else{const s=a.getRenderable();s&&e._renderableChildMap.delete(s),a.delete()}}e.children.length=r},t.createViewNode=r=>{if(!e.myFactory)return gD("Cannot create view nodes without my own factory"),null;const i=e.myFactory.createNode(r);return i&&i.setRenderable(r),i};const n=t.delete;t.delete=()=>{for(let r=0;r<e.children.length;r++)e.children[r].delete();n()}}const yD={renderable:null,myFactory:null,children:[],visited:!1};function Tx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yD,n),J.obj(t,e),J.event(t,e,"event"),e._renderableChildMap=new Map,J.get(t,e,["visited"]),J.setGet(t,e,["_parent","renderable","myFactory"]),J.getArray(t,e,["children"]),J.moveToProtected(t,e,["parent"]),vD(t,e)}const xD=J.newInstance(Tx,"vtkViewNode");var en={newInstance:xD,extend:Tx,PASS_TYPES:mD};function wD(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.indexOf(i)!==-1?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.overrides[i]();return s.setMyFactory(t),s}}const CD={};function _x(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CD,n),J.obj(t,e),wD(t,e)}const TD=J.newInstance(_x,"vtkViewNodeFactory");var b1={newInstance:TD,extend:_x};const Sx=Object.create(null);function An(t,e){Sx[t]=e}function _D(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}const SD={};function bx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SD,n),e.overrides=Sx,b1.extend(t,e,n),_D(t,e)}const bD=J.newInstance(bx,"vtkOpenGLViewNodeFactory");var ED={newInstance:bD,extend:bx};function DD(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=n=>{if(n){const r=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize),e.context.scissor(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=n=>{if(n!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||n.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){pn(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Th(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Pl(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Rt(e.keyMatrices.wcvc,e.keyMatrices.wcvc);const r=e._openGLRenderer.getAspectRatio();pn(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(r,-1,1)),Rt(e.keyMatrices.vcpc,e.keyMatrices.vcpc),It(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=n}return e.keyMatrices}}const OD={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function RD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OD,n),en.extend(t,e,n),e.keyMatrixTime={},an(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},bn(t,e,["context","keyMatrixTime"]),DD(t,e)}const Ex=kt(RD);var MD={newInstance:Ex};An("vtkCamera",Ex);const{vtkDebugMacro:ND}=sr;function LD(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(ND("No lights are on, creating one."),e.renderable.createLight()),n},t.zBufferPass=n=>{if(n){let r=0;const i=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),r|=i.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(i.clearDepth(1),r|=i.DEPTH_BUFFER_BIT,e.context.depthMask(!0));const a=t.getTiledSizeAndOrigin();i.enable(i.SCISSOR_TEST),i.scissor(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.viewport(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),i.colorMask(!0,!0,!0,!0),r&&i.clear(r),i.enable(i.DEPTH_TEST)}},t.opaqueZBufferPass=n=>t.zBufferPass(n),t.cameraPass=n=>{n&&t.clear()},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),c=Math.round(o[1]),l=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(l,f);let h=Math.round(u[0])-s,p=Math.round(u[1])-c;return h<0&&(h=0),p<0&&(p=0),{usize:h,vsize:p,lowerLeftU:s,lowerLeftV:c}},t.clear=()=>{let n=0;const r=e.context;if(!e.renderable.getTransparent()){const a=e.renderable.getBackgroundByReference();r.clearColor(a[0],a[1],a[2],a[3]),n|=r.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const i=t.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources(),e.renderable&&e.renderable.getViewProps().forEach(n=>{n.modified()})},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const AD={context:null,_openGLRenderWindow:null,selector:null};function FD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AD,n),en.extend(t,e,n),mr(t,e,["shaderCache"]),bn(t,e,["selector"]),Nl(t,e,["openGLRenderWindow"]),LD(t,e)}const Dx=kt(FD,"vtkOpenGLRenderer");var ID={newInstance:Dx};An("vtkRenderer",Dx);function Ox(t){let e=0;return t.filter((n,r)=>r===e?(e+=n+1,!0):!1)}function Rx(t){let e=0;for(let n=0;n<t.length;)n+=t[n]+1,e++;return e}const PD={extractCellSizes:Ox,getNumberOfCells:Rx};function VD(t,e){e.classHierarchy.push("vtkCellArray");const n={...t};t.getNumberOfCells=r=>(e.numberOfCells!==void 0&&!r||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=Rx(t.getData())),e.numberOfCells),t.getCellSizes=r=>(e.cellSizes!==void 0&&!r||(e.cellSizes=Ox(t.getData())),e.cellSizes),t.resize=r=>{const i=t.getNumberOfTuples();n.resize(r);const a=t.getNumberOfTuples();a<i&&(a===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=r=>{n.setData(r,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=r=>{let i=r;const a=e.values[i++];return e.values.subarray(i,i+a)},t.insertNextCell=r=>{const i=t.getNumberOfCells();return t.insertNextTuples([r.length,...r]),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(r.length),i}}function kD(t){return{empty:!0,numberOfComponents:1,dataType:Ot.UNSIGNED_INT,...t}}function Mx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ft.extend(t,e,kD(n)),VD(t,e)}const UD=J.newInstance(Mx,"vtkCellArray");var dl={newInstance:UD,extend:Mx,...PD};const{vtkErrorMacro:BD}=J,GD=[1,-1,1,-1,1,-1];function WD(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==n&&(e.size=n*r,e.values=J.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(r),t.modified())},t.setPoint=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];t.setTuple(n,i)},t.getPoint=t.getTuple,t.findPoint=t.findTuple,t.insertNextPoint=(n,r,i)=>t.insertNextTuple([n,r,i]),t.getBounds=()=>{if(t.getNumberOfComponents()===3){const i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];const a=t.getRange(1);e.bounds[2]=a[0],e.bounds[3]=a[1];const o=t.getRange(2);return e.bounds[4]=o[0],e.bounds[5]=o[1],e.bounds}if(t.getNumberOfComponents()!==2)return BD(`getBounds called on an array with components of
        ${t.getNumberOfComponents()}`),GD;const n=t.getRange(0);e.bounds[0]=n[0],e.bounds[1]=n[1];const r=t.getRange(1);return e.bounds[2]=r[0],e.bounds[3]=r[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}const zD={empty:!0,numberOfComponents:3,dataType:Ot.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Nx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zD,n),ft.extend(t,e,n),WD(t,e)}const jD=J.newInstance(Nx,"vtkPoints");var Ff={newInstance:jD,extend:Nx};function $D(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){e.pointsIds=r;let i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=J.newTypedArray(n.getDataType(),3*e.pointsIds.length));const a=n.getData();e.pointsIds.forEach((o,s)=>{let c=3*o,l=3*s;i[l]=a[c],i[++l]=a[++c],i[++l]=a[++c]}),e.points.setData(i)}else{e.points=n,e.pointsIds=new Array(n.getNumberOfPoints());for(let i=n.getNumberOfPoints()-1;i>=0;--i)e.pointsIds[i]=i}},t.getBounds=()=>{const n=e.points.getNumberOfPoints(),r=[];if(n){e.points.getPoint(0,r),e.bounds[0]=r[0],e.bounds[1]=r[0],e.bounds[2]=r[1],e.bounds[3]=r[1],e.bounds[4]=r[2],e.bounds[5]=r[2];for(let i=1;i<n;i++)e.points.getPoint(i,r),e.bounds[0]=r[0]<e.bounds[0]?r[0]:e.bounds[0],e.bounds[1]=r[0]>e.bounds[1]?r[0]:e.bounds[1],e.bounds[2]=r[1]<e.bounds[2]?r[1]:e.bounds[2],e.bounds[3]=r[1]>e.bounds[3]?r[1]:e.bounds[3],e.bounds[4]=r[2]<e.bounds[4]?r[2]:e.bounds[4],e.bounds[5]=r[2]>e.bounds[5]?r[2]:e.bounds[5]}else tu(e.bounds);return e.bounds},t.getLength2=()=>{t.getBounds();let n=0,r=0;for(let i=0;i<3;i++)r=e.bounds[2*i+1]-e.bounds[2*i],n+=r*r;return n},t.getParametricDistance=n=>{let r,i=0;for(let a=0;a<3;a++)n[a]<0?r=-n[a]:n[a]>1?r=n[a]-1:r=0,r>i&&(i=r);return i},t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.deepCopy=n=>{n.initialize(e.points,e.pointsIds)},t.getCellDimension=()=>{},t.intersectWithLine=(n,r,i,a,o,s,c)=>{},t.evaluatePosition=(n,r,i,a,o,s)=>{J.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const HD={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function Lx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HD,n),J.obj(t,e),e.points||(e.points=Ff.newInstance()),J.get(t,e,["points","pointsIds"]),$D(t,e)}const KD=J.newInstance(Lx,"vtkCell");var If={newInstance:KD,extend:Lx};function qD(t,e){let n=e;for(e>=t.array.length&&(n+=t.array.length);n>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=n}function XD(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),i=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(c=>{t.incrementLinkCount(c)})}t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o){const{cellPointIds:s}=n.getCellPoints(o);s.forEach(c=>{t.insertCellReference(c,a[c]++,o)})}}else{for(let o=0;o<i;o++)If.newInstance().getPointsIds().forEach(c=>{t.incrementLinkCount(c)});t.allocateLinks(r),e.maxId=r-1;for(let o=0;o<i;++o)If.newInstance().getPointsIds().forEach(c=>{t.insertCellReference(c,a[c]++,o)})}},t.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(n).fill().map(()=>({ncells:0,cells:null})),e.extend=r,e.maxId=-1},t.initialize=()=>{e.array=null},t.getLink=n=>e.array[n],t.getNcells=n=>e.array[n].ncells,t.getCells=n=>e.array[n].cells,t.insertNextPoint=n=>{e.array.push({ncells:n,cells:Array(n)}),++e.maxId},t.insertNextCellReference=(n,r)=>{e.array[n].cells[e.array[n].ncells++]=r},t.deletePoint=n=>{e.array[n].ncells=0,e.array[n].cells=null},t.removeCellReference=(n,r)=>{e.array[r].cells=e.array[r].cells.filter(i=>i!==n),e.array[r].ncells=e.array[r].cells.length},t.addCellReference=(n,r)=>{e.array[r].cells[e.array[r].ncells++]=n},t.resizeCellList=(n,r)=>{e.array[n].cells.length=r},t.squeeze=()=>{qD(e,e.maxId+1)},t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{e.array=[...n.array],e.extend=n.extend,e.maxId=n.maxId},t.incrementLinkCount=n=>{++e.array[n].ncells},t.allocateLinks=n=>{for(let r=0;r<n;++r)e.array[r].cells=new Array(e.array[r].ncells)},t.insertCellReference=(n,r,i)=>{e.array[n].cells[r]=i}}const YD={array:null,maxId:0,extend:0};function Ax(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YD,n),J.obj(t,e),XD(t,e)}const JD=J.newInstance(Ax,"vtkCellLinks");var ZD={newInstance:JD,extend:Ax};const sn={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},Wd=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function QD(t){return t<Wd.length?Wd[t]:"UnknownClass"}function eO(t){return Wd.findIndex(t)}function tO(t){return t<sn.VTK_QUADRATIC_EDGE||t===sn.VTK_CONVEX_POINT_SET||t===sn.VTK_POLYHEDRON}function nO(t){return t===sn.VTK_TRIANGLE_STRIP||t===sn.VTK_POLY_LINE||t===sn.VTK_POLY_VERTEX}const rO={getClassNameFromTypeId:QD,getTypeIdFromClassName:eO,isLinear:tO,hasSubCells:nO};function iO(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=n>0?n:1,e.extend=r>0?r:1,e.maxId=-1,e.typeArray=new Uint8Array(n),e.locationArray=new Uint32Array(n)},t.insertCell=(n,r,i)=>{e.typeArray[n]=r,e.locationArray[n]=i,n>e.maxId&&(e.maxId=n)},t.insertNextCell=(n,r)=>(t.insertCell(++e.maxId,n,r),e.maxId),t.setCellTypes=(n,r,i)=>{e.size=n,e.typeArray=r,e.locationArray=i,e.maxId=n-1},t.getCellLocation=n=>e.locationArray[n],t.deleteCell=n=>{e.typeArray[n]=sn.VTK_EMPTY_CELL},t.getNumberOfTypes=()=>e.maxId+1,t.isType=n=>{const r=t.getNumberOfTypes();for(let i=0;i<r;++i)if(n===t.getCellType(i))return!0;return!1},t.insertNextType=n=>t.insertNextCell(n,-1),t.getCellType=n=>e.typeArray[n],t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{t.allocate(n.getSize(),n.getExtend()),e.typeArray.set(n.getTypeArray()),e.locationArray.set(n.getLocationArray()),e.maxId=n.getMaxId()}}const aO={size:0,maxId:-1,extend:1e3};function Fx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aO,n),J.obj(t,e),J.get(t,e,["size","maxId","extend"]),J.getArray(t,e,["typeArray","locationArray"]),iO(t,e)}const oO=J.newInstance(Fx,"vtkCellTypes");var sO={newInstance:oO,extend:Fx,...rO};const cO={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var Ix={IntersectionState:cO};const{IntersectionState:Z0}=Ix;function _c(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const i={t:Number.MIN_VALUE,distance:0},a=[];let o;a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2];const s=a[0]*(t[0]-e[0])+a[1]*(t[1]-e[1])+a[2]*(t[2]-e[2]),c=Et(a,a);let l=1e-5*s;return c!==0&&(i.t=s/c),l<0&&(l=-l),-l<c&&c<l||c<=0||i.t<0?o=e:i.t>1?o=n:(o=a,a[0]=e[0]+i.t*a[0],a[1]=e[1]+i.t*a[1],a[2]=e[2]+i.t*a[2]),r&&(r[0]=o[0],r[1]=o[1],r[2]=o[2]),i.distance=ia(o,t),i}function Px(t,e,n,r,i,a){const o=[],s=[],c=[];i[0]=0,a[0]=0,Ja(e,t,o),Ja(r,n,s),Ja(n,t,c);const l=[Et(o,o),-Et(o,s),-Et(o,s),Et(s,s)],f=[];if(f[0]=Et(o,c),f[1]=-Et(s,c),Q3(l,f,2)===0){let u=Number.MAX_VALUE;const h=[t,e,n,r],p=[n,n,t,t],d=[r,r,e,e];a[0],a[0],i[0],i[0],i[0],i[0],a[0],a[0];let g;for(let y=0;y<4;y++)g=_c(h[y],p[y],d[y]),g.distance<u&&(u=g.distance,g.t);return Z0.ON_LINE}return i[0]=f[0],a[0]=f[1],i[0]>=0&&i[0]<=1&&a[0]>=0&&a[0]<=1?Z0.YES_INTERSECTION:Z0.NO_INTERSECTION}const uO={distanceToLine:_c,intersection:Px};function lO(t,e){e.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}t.getCellDimension=()=>1,t.intersectWithLine=(r,i,a,o,s)=>{const c={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};s[1]=0,s[2]=0;const l=[],f=[],u=[];e.points.getPoint(0,f),e.points.getPoint(1,u);const h=[],p=[],d=Px(r,i,f,u,h,p);if(c.t=h[0],c.betweenPoints=n(c.t),s[0]=p[0],d===Z0.YES_INTERSECTION){for(let g=0;g<3;g++)o[g]=f[g]+s[0]*(u[g]-f[g]),l[g]=r[g]+c.t*(i[g]-r[g]);if(ia(o,l)<=a*a)return c.intersect=1,c}else{let g;if(c.t<0)return g=_c(r,f,u,o),g.distance<=a*a&&(c.t=0,c.intersect=1,c.betweenPoints=!0),c;if(c.t>1)return g=_c(i,f,u,o),g.distance<=a*a&&(c.t=1,c.intersect=1,c.betweenPoints=!0),c;if(s[0]<0)return s[0]=0,g=_c(f,r,i,o),c.t=g.t,g.distance<=a*a&&(c.intersect=1),c;if(s[0]>1)return s[0]=1,g=_c(u,r,i,o),c.t=g.t,g.distance<=a*a&&(c.intersect=1),c}return c},t.evaluateLocation=(r,i,a)=>{const o=[],s=[];e.points.getPoint(0,o),e.points.getPoint(1,s);for(let c=0;c<3;c++)i[c]=o[c]+r[0]*(s[c]-o[c]);a[0]=1-r[0],a[1]=r[0]},t.evaluateOrientation=(r,i,a)=>e.orientations?(q0(i,e.orientations[0],e.orientations[1],r[0]),a[0]=1-r[0],a[1]=r[0],!0):!1}const fO={orientations:null};function Vx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fO,n),If.extend(t,e,n),J.setGet(t,e,["orientations"]),lO(t,e)}const hO=J.newInstance(Vx,"vtkLine");var di={newInstance:hO,extend:Vx,...uO,...Ix};const{vtkErrorMacro:Qm,vtkWarningMacro:pO}=J;function dO(t,e){e.classHierarchy.push("vtkFieldData");const n=t.getState;e.arrays&&(e.arrays=e.arrays.map(r=>({data:Bi(r.data)}))),t.initialize=()=>{t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=()=>{e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=r=>{t.initializeFields(),e.copyFieldFlags=r.getCopyFieldFlags().map(i=>i),e.arrays=r.arrays().map(i=>({array:i}))},t.getNumberOfArrays=()=>e.arrays.length,t.getNumberOfActiveArrays=()=>e.arrays.length,t.addArray=r=>{const i=r.getName(),{array:a,index:o}=t.getArrayWithIndex(i);return a!=null?(e.arrays[o]={data:r},o):(e.arrays=[].concat(e.arrays,{data:r}),e.arrays.length-1)},t.removeAllArrays=()=>{e.arrays=[]},t.removeArray=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return t.removeArrayByIndex(i)},t.removeArrayByIndex=r=>r!==-1&&r<e.arrays.length?(e.arrays.splice(r,1),!0):!1,t.getArrays=()=>e.arrays.map(r=>r.data),t.getArray=r=>typeof r=="number"?t.getArrayByIndex(r):t.getArrayByName(r),t.getArrayByName=r=>e.arrays.reduce((i,a,o)=>a.data.getName()===r?a.data:i,null),t.getArrayWithIndex=r=>{const i=e.arrays.findIndex(a=>a.data.getName()===r);return{array:i!==-1?e.arrays[i].data:null,index:i}},t.getArrayByIndex=r=>r>=0&&r<e.arrays.length?e.arrays[r].data:null,t.hasArray=r=>t.getArrayWithIndex(r).index>=0,t.getArrayName=r=>{const i=e.arrays[r];return i?i.data.getName():""},t.getCopyFieldFlags=()=>e.copyFieldFlags,t.getFlag=r=>e.copyFieldFlags[r],t.passData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(o=>{const s=t.getFlag(o.getName());if(s!==!1&&!(e.doCopyAllOff&&s!==!0)&&o){let c=t.getArrayByName(o.getName());if(c)if(o.getNumberOfComponents()===c.getNumberOfComponents())if(i>-1&&i<o.getNumberOfTuples()){const l=a>-1?a:i;c.insertTuple(l,o.getTuple(i))}else c.insertTuples(0,o.getTuples());else Qm("Unhandled case in passData");else if(i<0||i>o.getNumberOfTuples())t.addArray(o),r.getAttributes(o).forEach(l=>{t.setAttribute(o,l)});else{const l=o.getNumberOfComponents();let f=o.getNumberOfValues();const u=a>-1?a:i;f<=u*l&&(f=(u+1)*l),c=ft.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:l,values:J.newTypedArray(o.getDataType(),f),size:0}),c.insertTuple(u,o.getTuple(i)),t.addArray(c),r.getAttributes(o).forEach(h=>{t.setAttribute(c,h)})}}})},t.interpolateData=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(c=>{const l=t.getFlag(c.getName());if(l!==!1&&!(e.doCopyAllOff&&l!==!0)&&c){let f=t.getArrayByName(c.getName());if(f)if(c.getNumberOfComponents()===f.getNumberOfComponents())if(i>-1&&i<c.getNumberOfTuples()){const u=o>-1?o:i;f.interpolateTuple(u,c,i,c,a,s),pO("Unexpected case in interpolateData")}else f.insertTuples(c.getTuples());else Qm("Unhandled case in interpolateData");else if(i<0||a<0||i>c.getNumberOfTuples())t.addArray(c),r.getAttributes(c).forEach(u=>{t.setAttribute(c,u)});else{const u=c.getNumberOfComponents();let h=c.getNumberOfValues();const p=o>-1?o:i;h<=p*u&&(h=(p+1)*u),f=ft.newInstance({name:c.getName(),dataType:c.getDataType(),numberOfComponents:u,values:J.newTypedArray(c.getDataType(),h),size:0}),f.interpolateTuple(p,c,i,c,a,s),t.addArray(f),r.getAttributes(c).forEach(d=>{t.setAttribute(f,d)})}}})},t.copyFieldOn=r=>{e.copyFieldFlags[r]=!0},t.copyFieldOff=r=>{e.copyFieldFlags[r]=!1},t.copyAllOn=()=>{(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=()=>{(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=()=>{e.copyFieldFlags={}},t.deepCopy=r=>{e.arrays=r.getArrays().map(i=>{const a=i.newClone();return a.deepCopy(i),{data:a}})},t.copyFlags=r=>r.getCopyFieldFlags().map(i=>i),t.reset=()=>e.arrays.forEach(r=>r.data.reset()),t.getMTime=()=>e.arrays.reduce((r,i)=>i.data.getMTime()>r?i.data.getMTime():r,e.mtime),t.getNumberOfComponents=()=>e.arrays.reduce((r,i)=>r+i.data.getNumberOfComponents(),0),t.getNumberOfTuples=()=>e.arrays.length>0?e.arrays[0].getNumberOfTuples():0,t.getState=()=>{const r=n();return r&&(r.arrays=e.arrays.map(i=>({data:i.data.getState()}))),r}}const gO={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function kx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gO,n),J.obj(t,e),dO(t,e)}const mO=J.newInstance(kx,"vtkFieldData");var vO={newInstance:mO,extend:kx};const yO={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},xO={MAX:0,EXACT:1,NOLIMIT:2},wO={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},CO={DUPLICATEPOINT:1,HIDDENPOINT:2},TO={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},_O="vtkGhostType",SO={DEFAULT:0,SINGLE:1,DOUBLE:2};var Ux={AttributeCopyOperations:TO,AttributeLimitTypes:xO,AttributeTypes:yO,CellGhostTypes:wO,DesiredOutputPrecision:SO,PointGhostTypes:CO,ghostArrayName:_O};const{AttributeTypes:Mo,AttributeCopyOperations:Ms}=Ux,{vtkWarningMacro:a0}=J;function bO(t,e){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(o){let s=n.find(c=>Mo[c.toUpperCase()]===o||typeof o!="number"&&c.toLowerCase()===o.toLowerCase());return typeof s>"u"&&(s=null),s}e.classHierarchy.push("vtkDataSetAttributes");const i={...t};t.checkNumberOfComponents=o=>!0,t.setAttribute=(o,s)=>{const c=r(s);if(o&&c.toUpperCase()==="PEDIGREEIDS"&&!o.isA("vtkDataArray"))return a0(`Cannot set attribute ${c}. The attribute must be a vtkDataArray.`),-1;if(o&&!t.checkNumberOfComponents(o,c))return a0(`Cannot set attribute ${c}. Incorrect number of components.`),-1;let l=e[`active${c}`];if(l>=0&&l<e.arrays.length){if(e.arrays[l]===o)return l;t.removeArrayByIndex(l)}return o?(l=t.addArray(o),e[`active${c}`]=l):e[`active${c}`]=-1,t.modified(),e[`active${c}`]},t.getAttributes=o=>n.filter(s=>t[`get${s}`]()===o),t.setActiveAttributeByName=(o,s)=>t.setActiveAttributeByIndex(t.getArrayWithIndex(o).index,s),t.setActiveAttributeByIndex=(o,s)=>{const c=r(s);if(o>=0&&o<e.arrays.length){if(c.toUpperCase()!=="PEDIGREEIDS"){const l=t.getArrayByIndex(o);if(!l.isA("vtkDataArray"))return a0(`Cannot set attribute ${c}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!t.checkNumberOfComponents(l,c))return a0(`Cannot set attribute ${c}. Incorrect number of components.`),-1}return e[`active${c}`]=o,t.modified(),o}return o===-1&&(e[`active${c}`]=o,t.modified()),-1},t.getActiveAttribute=o=>{const s=r(o);return t[`get${s}`]()},t.removeAllArrays=()=>{n.forEach(o=>{e[`active${o}`]=-1}),i.removeAllArrays()},t.removeArrayByIndex=o=>(o!==-1&&n.forEach(s=>{o===e[`active${s}`]?e[`active${s}`]=-1:o<e[`active${s}`]&&(e[`active${s}`]-=1)}),i.removeArrayByIndex(o)),n.forEach(o=>{const s=`active${o}`;t[`get${o}`]=()=>t.getArrayByIndex(e[s]),t[`set${o}`]=c=>t.setAttribute(c,o),t[`setActive${o}`]=c=>t.setActiveAttributeByIndex(t.getArrayWithIndex(c).index,o),t[`copy${o}Off`]=()=>{const c=o.toUpperCase();e.copyAttributeFlags[Ms.PASSDATA][Mo[c]]=!1},t[`copy${o}On`]=()=>{const c=o.toUpperCase();e.copyAttributeFlags[Ms.PASSDATA][Mo[c]]=!0}}),t.initializeAttributeCopyFlags=()=>{e.copyAttributeFlags=[],Object.keys(Ms).filter(o=>o!=="ALLCOPY").forEach(o=>{e.copyAttributeFlags[Ms[o]]=Object.keys(Mo).filter(s=>s!=="NUM_ATTRIBUTES").reduce((s,c)=>(s[Mo[c]]=!0,s),[])}),e.copyAttributeFlags[Ms.COPYTUPLE][Mo.GLOBALIDS]=!1,e.copyAttributeFlags[Ms.INTERPOLATE][Mo.GLOBALIDS]=!1,e.copyAttributeFlags[Ms.COPYTUPLE][Mo.PEDIGREEIDS]=!1},t.initialize=J.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(o=>{!e.dataArrays[o].ref&&e.dataArrays[o].type==="vtkDataArray"&&t.addArray(ft.newInstance(e.dataArrays[o]))});const a=t.shallowCopy;t.shallowCopy=(o,s)=>{a(o,s),e.arrays=o.getArrays().map(c=>{const l=c.newClone();return l.shallowCopy(c,s),{data:l}})},t.initializeAttributeCopyFlags()}const EO={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Bx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EO,n),vO.extend(t,e,n),J.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),bO(t,e)}const DO=J.newInstance(Bx,"vtkDataSetAttributes");var ev={newInstance:DO,extend:Bx,...Ux};const OO={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},RO={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var MO={FieldDataTypes:OO,FieldAssociations:RO};const zd=["pointData","cellData","fieldData"];function NO(t,e){e.classHierarchy.push("vtkDataSet"),zd.forEach(r=>{e[r]?e[r]=Bi(e[r]):e[r]=ev.newInstance()});const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),zd.forEach(a=>{e[a]=ev.newInstance(),e[a].shallowCopy(r.getReferenceByName(a))})}}const LO={};function Gx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LO,n),J.obj(t,e),J.setGet(t,e,zd),NO(t,e)}const AO=J.newInstance(Gx,"vtkDataSet");var nu={newInstance:AO,extend:Gx,...MO};function FO(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=Bi(e.points):e.points=Ff.newInstance(),t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.getBounds=()=>e.points.getBounds(),t.computeBounds=()=>{t.getBounds()};const n=t.shallowCopy;t.shallowCopy=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,i),e.points=Ff.newInstance(),e.points.shallowCopy(r.getPoints())}}const IO={};function Wx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IO,n),nu.extend(t,e,n),J.setGet(t,e,["points"]),FO(t,e)}const PO=J.newInstance(Wx,"vtkPointSet");var VO={newInstance:PO,extend:Wx};function E1(t,e,n,r){const i=n[0]-e[0],a=n[1]-e[1],o=n[2]-e[2],s=t[0]-e[0],c=t[1]-e[1],l=t[2]-e[2];r[0]=a*l-o*c,r[1]=o*s-i*l,r[2]=i*c-a*s}function Pf(t,e,n,r){E1(t,e,n,r);const i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);i!==0&&(r[0]/=i,r[1]/=i,r[2]/=i)}function kO(t,e,n,r,i,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,s=!1;const c=[],l=[],f=[],u=[],h=[];Pf(t,e,n,u),Pf(r,i,a,h);const p=-Et(u,t),d=-Et(h,r),g=[Et(h,t)+d,Et(h,e)+d,Et(h,n)+d];if(g[0]*g[1]>o&&g[0]*g[2]>o)return{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f};const y=[Et(u,r)+p,Et(u,i)+p,Et(u,a)+p];if(y[0]*y[1]>o&&y[0]*y[2]>o)return{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f};if(Math.abs(u[0]-h[0])<1e-9&&Math.abs(u[1]-h[1])<1e-9&&Math.abs(u[2]-h[2])<1e-9&&Math.abs(p-d)<1e-9)return s=!0,{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f};const x=[t,e,n],m=[r,i,a],v=Et(u,h),w=(p-d*v)/(v*v-1),C=(d-p*v)/(v*v-1),T=[w*u[0]+C*h[0],w*u[1]+C*h[1],w*u[2]+C*h[2]],_=ga(u,h,[]);oc(_);let S=0,b=0;const D=[],E=[];let R=50,F=50;for(let z=0;z<3;z++){const Y=z,W=(z+1)%3,B=hr.intersectWithLine(x[Y],x[W],r,h);B.intersection&&B.t>0-o&&B.t<1+o&&(B.t<1+o&&B.t>1-o&&(R=S),D[S++]=Et(B.x,_)-Et(T,_));const j=hr.intersectWithLine(m[Y],m[W],t,u);j.intersection&&j.t>0-o&&j.t<1+o&&(j.t<1+o&&j.t>1-o&&(F=b),E[b++]=Et(j.x,_)-Et(T,_))}if(S>2){S--;const z=D[2];D[2]=D[R],D[R]=z}if(b>2){b--;const z=E[2];E[2]=E[F],E[F]=z}if(S!==2||b!==2)return{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f};if(Number.isNaN(D[0])||Number.isNaN(D[1])||Number.isNaN(E[0])||Number.isNaN(E[1]))return{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f};if(D[0]>D[1]){const z=D[1];D[1]=D[0],D[0]=z}if(E[0]>E[1]){const z=E[1];E[1]=E[0],E[0]=z}let M,U;return D[1]<E[0]||E[1]<D[0]?{intersect:!1,coplanar:s,pt1:c,pt2:l,surfaceId:f}:(D[0]<E[0]?D[1]<E[1]?(f[0]=2,f[1]=1,M=E[0],U=D[1]):(f[0]=2,f[1]=2,M=E[0],U=E[1]):D[1]<E[1]?(f[0]=1,f[1]=1,M=D[0],U=D[1]):(f[0]=1,f[1]=2,M=D[0],U=E[1]),Dd(T,_,M,c),Dd(T,_,U,l),{intersect:!0,coplanar:s,pt1:c,pt2:l,surfaceId:f})}const UO={computeNormalDirection:E1,computeNormal:Pf,intersectWithTriangle:kO};function BO(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=()=>2,t.intersectWithLine=(n,r,i,a,o)=>{const s={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};o[2]=0;const c=[],l=i*i,f=[],u=[],h=[];e.points.getPoint(0,f),e.points.getPoint(1,u),e.points.getPoint(2,h);const p=[],d=[];if(Pf(f,u,h,p),p[0]!==0||p[1]!==0||p[2]!==0){const v=hr.intersectWithLine(n,r,f,p);if(s.betweenPoints=v.betweenPoints,s.t=v.t,a[0]=v.x[0],a[1]=v.x[1],a[2]=v.x[2],!v.intersection)return o[0]=0,o[1]=0,s.intersect=0,s;const w=t.evaluatePosition(a,c,o,d);if(w.evaluation>=0)return w.dist2<=l?(s.intersect=1,s):(s.intersect=w.evaluation,s)}const g=ia(f,u),y=ia(u,h),x=ia(h,f);e.line||(e.line=di.newInstance()),g>y&&g>x?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,u)):y>x&&y>g?(e.line.getPoints().setPoint(0,u),e.line.getPoints().setPoint(1,h)):(e.line.getPoints().setPoint(0,h),e.line.getPoints().setPoint(1,f));const m=e.line.intersectWithLine(n,r,i,a,o);if(s.betweenPoints=m.betweenPoints,s.t=m.t,m.intersect){const v=[],w=[],C=[];for(let T=0;T<3;T++)v[T]=f[T]-h[T],w[T]=u[T]-h[T],C[T]=a[T]-h[T];return o[0]=Et(C,v)/x,o[1]=Et(C,w)/y,s.intersect=1,s}return o[0]=0,o[1]=0,s.intersect=0,s},t.evaluatePosition=(n,r,i,a)=>{const o={subId:0,dist2:0,evaluation:-1};let s,c;const l=[],f=[],u=[],h=[];let p;const d=[],g=[],y=[];let x=0,m=0;const v=[];let w,C,T,_=[];const S=[],b=[],D=[];o.subId=0,i[2]=0,e.points.getPoint(1,l),e.points.getPoint(2,f),e.points.getPoint(0,u),E1(l,f,u,h),hr.generalizedProjectPoint(n,l,h,D);let E=0;for(s=0;s<3;s++)h[s]<0?p=-h[s]:p=h[s],p>E&&(E=p,m=s);for(c=0,s=0;s<3;s++)s!==m&&(v[c++]=s);for(s=0;s<2;s++)d[s]=D[v[s]]-u[v[s]],g[s]=l[v[s]]-u[v[s]],y[s]=f[v[s]]-u[v[s]];if(x=_n(g,y),x===0)return i[0]=0,i[1]=0,o.evaluation=-1,o;if(i[0]=_n(d,y)/x,i[1]=_n(g,d)/x,a[0]=1-(i[0]+i[1]),a[1]=i[0],a[2]=i[1],a[0]>=0&&a[0]<=1&&a[1]>=0&&a[1]<=1&&a[2]>=0&&a[2]<=1)r&&(o.dist2=ia(D,n),r[0]=D[0],r[1]=D[1],r[2]=D[2]),o.evaluation=1;else{let R;if(r){if(a[1]<0&&a[2]<0)for(w=ia(n,u),C=di.distanceToLine(n,l,u,R,S),T=di.distanceToLine(n,u,f,R,b),w<C?(o.dist2=w,_=u):(o.dist2=C,_=S),T<o.dist2&&(o.dist2=T,_=b),s=0;s<3;s++)r[s]=_[s];else if(a[2]<0&&a[0]<0)for(w=ia(n,l),C=di.distanceToLine(n,l,u,R,S),T=di.distanceToLine(n,l,f,R,b),w<C?(o.dist2=w,_=l):(o.dist2=C,_=S),T<o.dist2&&(o.dist2=T,_=b),s=0;s<3;s++)r[s]=_[s];else if(a[1]<0&&a[0]<0)for(w=ia(n,f),C=di.distanceToLine(n,f,u,R,S),T=di.distanceToLine(n,l,f,R,b),w<C?(o.dist2=w,_=f):(o.dist2=C,_=S),T<o.dist2&&(o.dist2=T,_=b),s=0;s<3;s++)r[s]=_[s];else if(a[0]<0){const F=di.distanceToLine(n,l,f,r);o.dist2=F.distance}else if(a[1]<0){const F=di.distanceToLine(n,f,u,r);o.dist2=F.distance}else if(a[2]<0){const F=di.distanceToLine(n,l,u,r);o.dist2=F.distance}}o.evaluation=0}return o},t.evaluateLocation=(n,r,i)=>{const a=[],o=[],s=[];e.points.getPoint(0,a),e.points.getPoint(1,o),e.points.getPoint(2,s);const c=1-n[0]-n[1];for(let l=0;l<3;l++)r[l]=a[l]*c+o[l]*n[0]+s[l]*n[1];i[0]=c,i[1]=n[0],i[2]=n[1]},t.getParametricDistance=n=>{let r,i=0;const a=[];a[0]=n[0],a[1]=n[1],a[2]=1-n[0]-n[1];for(let o=0;o<3;o++)a[o]<0?r=-a[o]:a[o]>1?r=a[o]-1:r=0,r>i&&(i=r);return i}}const GO={};function zx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GO,n),If.extend(t,e,n),BO(t,e)}const WO=J.newInstance(zx,"vtkTriangle");var jx={newInstance:WO,extend:zx,...UO};const wp=["verts","lines","polys","strips"],{vtkWarningMacro:tv}=J,zO={[sn.VTK_LINE]:di,[sn.VTK_POLY_LINE]:di,[sn.VTK_TRIANGLE]:jx};function jO(t,e){e.classHierarchy.push("vtkPolyData");function n(i){return i.replace(/(?:^\w|[A-Z]|\b\w)/g,a=>a.toUpperCase()).replace(/\s+/g,"")}wp.forEach(i=>{t[`getNumberOf${n(i)}`]=()=>e[i].getNumberOfCells(),e[i]?e[i]=Bi(e[i]):e[i]=dl.newInstance()}),t.getNumberOfCells=()=>wp.reduce((i,a)=>i+e[a].getNumberOfCells(),0);const r=t.shallowCopy;t.shallowCopy=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(i,a),wp.forEach(o=>{e[o]=dl.newInstance(),e[o].shallowCopy(i.getReferenceByName(o))})},t.buildCells=()=>{const i=t.getNumberOfVerts(),a=t.getNumberOfLines(),o=t.getNumberOfPolys(),s=t.getNumberOfStrips(),c=i+a+o+s,l=new Uint8Array(c);let f=l;const u=new Uint32Array(c);let h=u;if(i){let p=0;e.verts.getCellSizes().forEach((d,g)=>{h[g]=p,f[g]=d>1?sn.VTK_POLY_VERTEX:sn.VTK_VERTEX,p+=d+1}),h=h.subarray(i),f=f.subarray(i)}if(a){let p=0;e.lines.getCellSizes().forEach((d,g)=>{h[g]=p,f[g]=d>2?sn.VTK_POLY_LINE:sn.VTK_LINE,d===1&&tv("Building VTK_LINE ",g," with only one point, but VTK_LINE needs at least two points. Check the input."),p+=d+1}),h=h.subarray(a),f=f.subarray(a)}if(o){let p=0;e.polys.getCellSizes().forEach((d,g)=>{switch(h[g]=p,d){case 3:f[g]=sn.VTK_TRIANGLE;break;case 4:f[g]=sn.VTK_QUAD;break;default:f[g]=sn.VTK_POLYGON;break}d<3&&tv("Building VTK_TRIANGLE ",g," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),p+=d+1}),h+=h.subarray(o),f+=f.subarray(o)}if(s){let p=0;f.fill(sn.VTK_TRIANGLE_STRIP,0,s),e.strips.getCellSizes().forEach((d,g)=>{h[g]=p,p+=d+1})}e.cells=sO.newInstance(),e.cells.setCellTypes(c,l,u)},t.buildLinks=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=ZD.newInstance(),i>0?e.links.allocate(i):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=i=>e.cells.getCellType(i),t.getCellPoints=i=>{const a=t.getCellType(i);let o=null;switch(a){case sn.VTK_VERTEX:case sn.VTK_POLY_VERTEX:o=e.verts;break;case sn.VTK_LINE:case sn.VTK_POLY_LINE:o=e.lines;break;case sn.VTK_TRIANGLE:case sn.VTK_QUAD:case sn.VTK_POLYGON:o=e.polys;break;case sn.VTK_TRIANGLE_STRIP:o=e.strips;break;default:return o=null,{type:0,cellPointIds:null}}const s=e.cells.getCellLocation(i),c=o.getCell(s);return{cellType:a,cellPointIds:c}},t.getPointCells=i=>e.links.getCells(i),t.getCellEdgeNeighbors=(i,a,o)=>{const s=e.links.getLink(a),c=e.links.getLink(o);return s.cells.filter(l=>l!==i&&c.cells.indexOf(l)!==-1)},t.getCell=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const o=t.getCellPoints(i),s=a||zO[o.cellType].newInstance();return s.initialize(t.getPoints(),o.cellPointIds),s}}const $O={};function $x(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$O,n),VO.extend(t,e,n),J.get(t,e,["cells","links"]),J.setGet(t,e,["verts","lines","polys","strips"]),jO(t,e)}const HO=J.newInstance($x,"vtkPolyData");var Kn={newInstance:HO,extend:$x};const{vtkErrorMacro:KO}=J;class qO{constructor(){this.segmentMapping={},this.segments=[null],this.faces=[]}addSegment(e){const n=e[0],r=e[e.length-1];if(n===r||e.length<2)return;const i=this.segmentMapping[n],a=this.segmentMapping[r];if(i!==void 0&&a!==void 0)if(Math.abs(i)===Math.abs(a)){const o=i<a?a:i,s=this.segments[o];if(i>0)for(let c=1;c<e.length-1;c++)s.push(e[c]);else for(let c=1;c<e.length-1;c++)s.unshift(e[e.length-1-c]);this.faces.push(s),this.segments[o]=null,this.segmentMapping[n]=void 0,this.segmentMapping[r]=void 0}else{const o=Math.abs(i),s=Math.abs(a),c=this.segments[o],l=this.segments[s];this.segments[o]=null,this.segments[s]=null,this.segmentMapping[c[0]]=void 0,this.segmentMapping[l[0]]=void 0,this.segmentMapping[c[c.length-1]]=void 0,this.segmentMapping[l[l.length-1]]=void 0,this.addSegment(e),this.addSegment(c),this.addSegment(l)}else if(i!==void 0){if(i>0){const o=this.segments[i];for(let s=1;s<e.length;s++)o.push(e[s]);this.segmentMapping[r]=i}else{const o=this.segments[-i];this.segmentMapping[r]=i;for(let s=1;s<e.length;s++)o.unshift(e[s])}this.segmentMapping[n]=void 0}else if(a!==void 0){if(a>0){const o=this.segments[a];for(let s=1;s<e.length;s++)o.push(e[e.length-1-s]);this.segmentMapping[n]=a}else{const o=this.segments[-a];this.segmentMapping[n]=a;for(let s=1;s<e.length;s++)o.unshift(e[e.length-s-1])}this.segmentMapping[r]=void 0}else{const o=this.segments.length;this.segments.push(e),this.segmentMapping[n]=-o,this.segmentMapping[r]=o}}}function XO(t,e){e.classHierarchy.push("vtkClosedPolyLineToSurfaceFilter"),t.requestData=(n,r)=>{const i=n[0];if(!i){KO("Invalid or missing input");return}const a=Kn.newInstance();a.shallowCopy(i);const o=new qO,s=i.getLines().getData();let c=0;for(;c<s.length;){const h=s[c++],p=[];for(let d=0;d<h;d++)p.push(s[c+d]);o.addSegment(p),c+=h}const{faces:l}=o;let f=l.length;for(let h=0;h<l.length;h++)f+=l[h].length;const u=new Uint16Array(f);c=0;for(let h=0;h<l.length;h++){const p=l[h];u[c++]=p.length;for(let d=0;d<p.length;d++)u[c++]=p[d]}a.setPolys(dl.newInstance({values:u,name:"faces"})),r[0]=a}}const YO={};function Hx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YO,n),J.obj(t,e),J.algo(t,e,1,1),XO(t,e)}const JO=J.newInstance(Hx,"vtkClosedPolyLineToSurfaceFilter");var ZO={newInstance:JO,extend:Hx};const{vtkErrorMacro:nv}=sr;function QO(t){const e=t.getPolys().getData(),n=t.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<e.length){r.cellSize=e[r.polyIdx];const i=r.polyIdx+1,a=i+r.cellSize;r.polyIdx=a;let o=0;for(let s=i;s<a;++s)r.cell[o++]=e[s]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const i=r.stripIdx-2,a=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let o=0;for(let s=i;s<a;++s)r.cell[o++]=n[s]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function eR(t,e){e.classHierarchy.push("vtkCutter");const n={...t};t.getMTime=()=>{let i=n.getMTime();return e.cutFunction&&(i=Math.max(i,e.cutFunction.getMTime())),i};function r(i,a){const o=i.getPoints(),s=o.getData(),c=o.getNumberOfPoints(),l=[],f=[],u=[];(!e.cutScalars||e.cutScalars.length<c)&&(e.cutScalars=new Float32Array(c));let h=0,p=0;for(;h<s.length;)e.cutScalars[p++]=e.cutFunction.evaluateFunction(s[h++],s[h++],s[h++]);const d=[],g=new Array(3),y=new Array(3),x=[];for(const v=QO(i);!v.done;v.next()){if(v.cellSize<=2)continue;for(let S=0;S<v.cellSize;)x[S]=e.cutScalars[v.cell[S++]];const w=x[0]>0;let C=!0;for(let S=1;S<v.cell.length;S++)if(x[S]>0!==w){C=!1;break}if(C)continue;const T=[];for(let S=0;S<v.cellSize;S++){const b=S+1===v.cellSize?0:S+1,D=x[S]>0;if(x[b]>0===D)continue;let R=S,F=b,M=x[F]-x[R];M<=0&&(R=b,F=S,M*=-1);let U=0;M!==0&&(U=(e.cutValue-x[R])/M);const z=v.cell[R],Y=v.cell[F];g[0]=s[z*3],g[1]=s[z*3+1],g[2]=s[z*3+2],y[0]=s[Y*3],y[1]=s[Y*3+1],y[2]=s[Y*3+2];const W=[g[0]+U*(y[0]-g[0]),g[1]+U*(y[1]-g[1]),g[2]+U*(y[2]-g[2])];T.push({pointEdge1:z,pointEdge2:Y,intersectedPoint:W,newPointID:-1})}for(let S=0;S<T.length;S++){const b=T[S];let D=!1;for(let E=0;E<d.length;E++){const R=d[E],F=b.pointEdge1===R.pointEdge1&&b.pointEdge2===R.pointEdge2,M=b.intersectedPoint[0]===R.intersectedPoint[0]&&b.intersectedPoint[1]===R.intersectedPoint[1]&&b.intersectedPoint[2]===R.intersectedPoint[2];if(F||M){D=!0,T[S].newPointID=d[E].newPointID;break}}D||(l.push(b.intersectedPoint[0]),l.push(b.intersectedPoint[1]),l.push(b.intersectedPoint[2]),T[S].newPointID=l.length/3-1,d.push(T[S]))}const _=T.length;_===2?f.push(_,T[0].newPointID,T[1].newPointID):_>2&&(u.push(_),T.forEach(S=>{u.push(S.newPointID)}))}a.getPoints().setData(vh(o.getDataType(),l),3),f.length!==0&&a.getLines().setData(Uint16Array.from(f)),u.length!==0&&a.getPolys().setData(Uint16Array.from(u))}t.requestData=(i,a)=>{const o=i[0];if(!o){nv("Invalid or missing input");return}if(!e.cutFunction){nv("Missing cut function");return}const s=Kn.newInstance();r(o,s),a[0]=s}}const tR={cutFunction:null,cutScalars:null,cutValue:0};function Kx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tR,n),an(t,e),Bg(t,e,1,1),bn(t,e,["cutFunction","cutValue"]),eR(t,e)}const nR=kt(Kx,"vtkCutter");var rR={newInstance:nR,extend:Kx};const Qa={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var qx={ObjectType:Qa};const{ObjectType:Q0}=qx,iR={};function aR(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function n(s){switch(s){case Q0.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case Q0.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case Q0.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}let r=null,i=null,a=!0,o="";t.getType=()=>r,t.setType=s=>{r=s},t.getHandle=()=>i,t.isReady=()=>a===!1,t.generateBuffer=s=>{const c=n(s);return i===null&&(i=e.context.createBuffer(),r=s),n(r)===c},t.upload=(s,c)=>t.generateBuffer(c)?(e.context.bindBuffer(n(r),i),e.context.bufferData(n(r),s,e.context.STATIC_DRAW),e.allocatedGPUMemoryInBytes=s.length*s.BYTES_PER_ELEMENT,a=!1,!0):(o="Trying to upload array buffer to incompatible buffer.",!1),t.bind=()=>i?(e.context.bindBuffer(n(r),i),!0):!1,t.release=()=>i?(e.context.bindBuffer(n(r),null),!0):!1,t.releaseGraphicsResources=()=>{i!==null&&(e.context.bindBuffer(n(r),null),e.context.deleteBuffer(i),i=null,e.allocatedGPUMemoryInBytes=0)},t.setOpenGLRenderWindow=s=>{e._openGLRenderWindow!==s&&(t.releaseGraphicsResources(),e._openGLRenderWindow=s,e.context=null,s&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=()=>o}const oR={objectType:Q0.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function Xx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oR,n),J.obj(t,e),J.get(t,e,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),J.moveToProtected(t,e,["openGLRenderWindow"]),aR(t,e)}const sR=J.newInstance(Xx);var qa={newInstance:sR,extend:Xx,...iR,...qx};const Yx={FLAT:0,GOURAUD:1,PHONG:2},or={POINTS:0,WIREFRAME:1,SURFACE:2},cR=Yx;var Jx={Shading:Yx,Representation:or,Interpolation:cR};const{vtkErrorMacro:rv}=J;function uR(t,e){const n=new Float64Array(3);R4(n,e);const r=new Float64Array(16);return T4(r,sc(),t,n),r}function lR(t,e){return t===null||e===null?!1:!(zm(t,[0,0,0])&&zm(e,[1,1,1]))}function fR(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(Qa.ARRAY_BUFFER),t.createVBO=function(n,r,i,a){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!n.getData()||!n.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];const s=a.points.getData();let c=null,l=null,f=null;const u=a.colors?a.colors.getNumberOfComponents():0,h=a.tcoords?a.tcoords.getNumberOfComponents():0;a.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,c=a.normals.getData()),a.customAttributes&&a.customAttributes.forEach(B=>{B&&(e.customData.push({data:B.getData(),offset:4*e.blockSize,components:B.getNumberOfComponents(),name:B.getName()}),e.blockSize+=B.getNumberOfComponents())}),a.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=h,e.blockSize+=h,l=a.tcoords.getData()),a.colors?(e.colorComponents=a.colors.getNumberOfComponents(),e.colorOffset=0,f=a.colors.getData(),e.colorBO||(e.colorBO=qa.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;let p=0,d=0,g=0,y=0,x=0,m=0,v;const w={anythingToPoints(B,j,ie,ae){for(let fe=0;fe<B;++fe)v(j[ie+fe],ae)},linesToWireframe(B,j,ie,ae){for(let fe=0;fe<B-1;++fe)v(j[ie+fe],ae),v(j[ie+fe+1],ae)},polysToWireframe(B,j,ie,ae){if(B>2)for(let fe=0;fe<B;++fe)v(j[ie+fe],ae),v(j[ie+(fe+1)%B],ae)},stripsToWireframe(B,j,ie,ae){if(B>2){for(let fe=0;fe<B-1;++fe)v(j[ie+fe],ae),v(j[ie+fe+1],ae);for(let fe=0;fe<B-2;fe++)v(j[ie+fe],ae),v(j[ie+fe+2],ae)}},polysToSurface(B,j,ie,ae){for(let fe=0;fe<B-2;fe++)v(j[ie+0],ae),v(j[ie+fe+1],ae),v(j[ie+fe+2],ae)},stripsToSurface(B,j,ie,ae){for(let fe=0;fe<B-2;fe++)v(j[ie+fe],ae),v(j[ie+fe+1+fe%2],ae),v(j[ie+fe+1+(fe+1)%2],ae)}},C={anythingToPoints(B,j){return B},linesToWireframe(B,j){return B>1?(B-1)*2:0},polysToWireframe(B,j){return B>2?B*2:0},stripsToWireframe(B,j){return B>2?B*4-6:0},polysToSurface(B,j){return B>2?(B-2)*3:0},stripsToSurface(B,j,ie){return B>2?(B-2)*3:0}};let T=null,_=null;i===or.POINTS||r==="verts"?(T=w.anythingToPoints,_=C.anythingToPoints):i===or.WIREFRAME||r==="lines"?(T=w[`${r}ToWireframe`],_=C[`${r}ToWireframe`]):(T=w[`${r}ToSurface`],_=C[`${r}ToSurface`]);const S=n.getData(),b=S.length;let D=0;for(let B=0;B<b;)D+=_(S[B],S),B+=S[B]+1;let E=null;const R=new Float32Array(D*e.blockSize);f&&(E=new Uint8Array(D*4));let F=0,M=0,U=0,z=0;for(let B=0;B<3;++B){const j=a.points.getRange(B),ie=j[1]-j[0];U+=ie*ie;const ae=.5*(j[1]+j[0]);z+=ae*ae}if(U>0&&(Math.abs(z)/U>1e6||Math.abs(Math.log10(U))>3||U===0&&z>1e6)){const B=new Float64Array(3),j=new Float64Array(3);for(let ie=0;ie<3;++ie){const ae=a.points.getRange(ie),fe=ae[1]-ae[0];B[ie]=.5*(ae[1]+ae[0]),j[ie]=fe>0?1/fe:1}t.setCoordShiftAndScale(B,j)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(o)if(!o.points&&!o.cells)o.points=new Int32Array(D),o.cells=new Int32Array(D);else{const B=new Int32Array(D+o.points.length);B.set(o.points),o.points=B;const j=new Int32Array(D+o.cells.length);j.set(o.cells),o.cells=j}let W=a.vertexOffset;v=function(j,ie){if(o&&(o.points[W]=j,o.cells[W]=m+a.cellOffset),++W,p=j*3,e.coordShiftAndScaleEnabled?(R[F++]=(s[p++]-e.coordShift[0])*e.coordScale[0],R[F++]=(s[p++]-e.coordShift[1])*e.coordScale[1],R[F++]=(s[p++]-e.coordShift[2])*e.coordScale[2]):(R[F++]=s[p++],R[F++]=s[p++],R[F++]=s[p++]),c!==null&&(a.haveCellNormals?d=(m+a.cellOffset)*3:d=j*3,R[F++]=c[d++],R[F++]=c[d++],R[F++]=c[d++]),e.customData.forEach(ae=>{x=j*ae.components;for(let fe=0;fe<ae.components;++fe)R[F++]=ae.data[x++]}),l!==null){a.useTCoordsPerCell?g=ie*h:g=j*h;for(let ae=0;ae<h;++ae)R[F++]=l[g++]}f!==null&&(a.haveCellScalars?y=(m+a.cellOffset)*u:y=j*u,E[M++]=f[y++],E[M++]=f[y++],E[M++]=f[y++],E[M++]=u===4?f[y++]:255)};for(let B=0;B<b;B+=S[B]+1,m++)T(S[B],S,B+1,m+a.cellOffset);return e.elementCount=D,t.upload(R,Qa.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(E,Qa.ARRAY_BUFFER)),m},t.setCoordShiftAndScale=(n,r)=>{if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){rv("Wrong type for coordShift, expected vec3 or null");return}if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){rv("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||n===null||!jm(n,e.coordShift))&&(e.coordShift=n),(e.coordScale===null||r===null||!jm(r,e.coordScale))&&(e.coordScale=r),e.coordShiftAndScaleEnabled=lR(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=uR(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}const hR={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function Zx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hR,n),qa.extend(t,e,n),J.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),J.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),fR(t,e)}const pR=J.newInstance(Zx);var dR={newInstance:pR,extend:Zx};const{vtkErrorMacro:gR}=J;function mR(t,e){e.classHierarchy.push("vtkShader"),t.compile=()=>{let n=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":n=e.context.FRAGMENT_SHADER;break;case"Vertex":default:n=e.context.VERTEX_SHADER;break}if(e.handle=e.context.createShader(n),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle),!e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS)){const i=e.context.getShaderInfoLog(e.handle);return gR(`Error compiling shader '${e.source}': ${i}`),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}const vR={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function Qx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vR,n),J.obj(t,e),J.setGet(t,e,["shaderType","source","error","handle","context"]),mR(t,e)}const yR=J.newInstance(Qx,"vtkShader");var Cp={newInstance:yR,extend:Qx};const{vtkErrorMacro:Qi}=J;function xR(t,e,n,r){const i=typeof n=="string"?n:n.join(`
`),a=r===!1?e:new RegExp(e,"g"),o=t.replace(a,i);return{replace:o!==i,result:o}}function wR(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=()=>e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Qi(e.error),0):t.link()?(t.setCompiled(!0),1):(Qi(`Links failed: ${e.error}`),0):(Qi(e.fragmentShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Qi(e.fragmentShader.getError()),0):(Qi(e.vertexShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),Qi(e.vertexShader.getError()),0),t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(t.release(),e.vertexShaderHandle!==0&&(e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=0),e.fragmentShaderHandle!==0&&(e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=0),e.context.deleteProgram(e.handle),e.handle=0,t.setCompiled(!1))},t.bind=()=>!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0),t.isBound=()=>!!e.bound,t.release=()=>{e.context.useProgram(null),t.setBound(!1)},t.setContext=n=>{e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.link=()=>{if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;if(e.uniformLocs={},e.context.linkProgram(e.handle),!e.context.getProgramParameter(e.handle,e.context.LINK_STATUS)){const r=e.context.getProgramInfoLog(e.handle);return Qi(`Error linking shader ${r}`),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix4fv(i,!1,a),!0},t.setUniformMatrix3x3=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const a=new Float32Array(r);return e.context.uniformMatrix3fv(i,!1,a),!0},t.setUniformf=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1f(i,r),!0)},t.setUniformfv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1fv(i,r),!0)},t.setUniformi=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1i(i,r),!0)},t.setUniformiv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1iv(i,r),!0)},t.setUniform2f=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(a,r,i),!0},t.setUniform2fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2fv(i,r),!0)},t.setUniform2i=(n,r,i)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(a,r,i),!0},t.setUniform2iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2iv(i,r),!0)},t.setUniform3f=(n,r,i,a)=>{const o=t.findUniform(n);if(o===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(o,r,i,a),!0},t.setUniform3fArray=(n,r)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||r.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(i,r[0],r[1],r[2]),!0},t.setUniform3fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3fv(i,r),!0)},t.setUniform3i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(r,s[0],s[1],s[2]),!0},t.setUniform3iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3iv(i,r),!0)},t.setUniform4f=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4fv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4fv(i,r),!0)},t.setUniform4i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];let s=a;if(s.length===1&&Array.isArray(s[0])&&(s=s[0]),s.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(r,s[0],s[1],s[2],s[3]),!0},t.setUniform4iv=(n,r)=>{const i=t.findUniform(n);return i===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4iv(i,r),!0)},t.findUniform=n=>{if(!n||!e.linked)return-1;let r=e.uniformLocs[n];return r!==void 0?r:(r=e.context.getUniformLocation(e.handle,n),r===null?(e.error=`Uniform ${n} not found in current shader program.`,e.uniformLocs[n]=-1,-1):(e.uniformLocs[n]=r,r))},t.isUniformUsed=n=>{if(!n)return!1;let r=e.uniformLocs[n];return r!==void 0?r!==null:e.linked?(r=e.context.getUniformLocation(e.handle,n),e.uniformLocs[n]=r,r!==null):(Qi("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=n=>{if(!n)return!1;if(n in e.attributeLocs)return!0;if(!e.linked)return Qi("attempt to find uniform when the shader program is not linked"),!1;const r=e.context.getAttribLocation(e.handle,n);return r===-1?!1:(e.attributeLocs[n]=r,!0)},t.attachShader=n=>{if(n.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){const r=e.context.createProgram();if(r===0)return e.error="Could not create shader program.",!1;e.handle=r,e.linked=!1}return n.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=n.getHandle()),n.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=n.getHandle()),e.context.attachShader(e.handle,n.getHandle()),t.setLinked(!1),!0},t.detachShader=n=>{if(n.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),n.getShaderType()){case"Vertex":return e.vertexShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=n=>{e.context=n,e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.setLastCameraMTime=n=>{e.lastCameraMTime=n}}const CR={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function e8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CR,n),e.attributesLocs={},e.uniformLocs={},e.vertexShader=Cp.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=Cp.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=Cp.newInstance(),e.geometryShader.setShaderType("Geometry"),J.obj(t,e),J.get(t,e,["lastCameraMTime"]),J.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),wR(t,e)}const TR=J.newInstance(e8,"vtkShaderProgram");var Te={newInstance:TR,extend:e8,substitute:xR};function _R(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=()=>{},t.initialize=()=>{e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=()=>e.handleVAO!==0||e.supported===!1,t.bind=()=>{if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let c=0;c<s;++c)n.enableVertexAttribArray(o.index+c),n.vertexAttribPointer(o.index+c,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*c/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+c,1):n.vertexAttribDivisor(o.index+c,1))}}}},t.release=()=>{if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,i.buffer);for(let a=0;a<i.attributes.length;++a){const o=i.attributes[a],s=o.isMatrix?o.size:1;for(let c=0;c<s;++c)n.enableVertexAttribArray(o.index+c),n.vertexAttribPointer(o.index+c,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*c/o.size),o.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(o.index+c,0):n.vertexAttribDivisor(o.index+c,0)),n.disableVertexAttribArray(o.index+c)}}}},t.shaderProgramChanged=()=>{t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=()=>{t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=(n,r,i,a,o,s,c,l)=>t.addAttributeArrayWithDivisor(n,r,i,a,o,s,c,l,0,!1),t.addAttributeArrayWithDivisor=(n,r,i,a,o,s,c,l,f,u)=>{if(!n||!n.isBound()||r.getHandle()===0||r.getType()!==Qa.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=n.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==n.getHandle()))return!1;const h=e.context,p={};if(p.name=i,p.index=h.getAttribLocation(e.handleProgram,i),p.offset=a,p.stride=o,p.type=s,p.size=c,p.normalize=l,p.isMatrix=u,p.divisor=f,p.Index===-1)return!1;if(r.bind(),h.enableVertexAttribArray(p.index),h.vertexAttribPointer(p.index,p.size,p.type,p.normalize,p.stride,p.offset),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p.index,1):h.vertexAttribDivisor(p.index,1)),p.buffer=r.getHandle(),!e.supported){let d=!1;for(let g=0;g<e.buffers.length;++g){const y=e.buffers[g];if(y.buffer===p.buffer){d=!0;let x=!1;for(let m=0;m<y.attributes.length;++m)y.attributes[m].name===i&&(x=!0,y.attributes[m]=p);x||y.attributes.push(p)}}d||e.buffers.push({buffer:p.buffer,attributes:[p]})}return!0},t.addAttributeMatrixWithDivisor=(n,r,i,a,o,s,c,l,f)=>{const u=t.addAttributeArrayWithDivisor(n,r,i,a,o,s,c,l,f,!0);if(!u)return u;const h=e.context,p=h.getAttribLocation(e.handleProgram,i);for(let d=1;d<c;d++)h.enableVertexAttribArray(p+d),h.vertexAttribPointer(p+d,c,s,l,o,a+o*d/c),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p+d,1):h.vertexAttribDivisor(p+d,1));return!0},t.removeAttributeArray=n=>{if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(let r=0;r<e.buffers.length;++r){const i=e.buffers[r];for(let a=0;a<i.attributes.length;++a)if(i.attributes[a].name===n)return i.attributes.splice(a,1),i.attributes.length||e.buffers.splice(r,1),!0}return!0},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const SR={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function t8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SR,n),e.buffers=[],J.obj(t,e),J.get(t,e,["supported"]),J.setGet(t,e,["forceEmulation"]),_R(t,e)}const bR=J.newInstance(t8,"vtkOpenGLVertexArrayObject");var D1={newInstance:bR,extend:t8};const Fo={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function ER(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=n=>{e.context=n.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(n),e.CABO.setOpenGLRenderWindow(n)},t.releaseGraphicsResources=n=>{e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=(n,r,i,a)=>{if(e.CABO.getElementCount()){const o=t.getOpenGLMode(i),s=t.haveWideLines(n,r),c=e.context,l=c.getParameter(c.DEPTH_WRITEMASK);e.pointPicking&&c.depthMask(!1),o===c.LINES&&s?(t.updateShaders(n,r,a),c.drawArraysInstanced(o,0,e.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(c.lineWidth(r.getProperty().getLineWidth()),t.updateShaders(n,r,a),c.drawArrays(o,0,e.CABO.getElementCount()),c.lineWidth(1));const u=(o===c.POINTS?1:0)||(o===c.LINES?2:3);return e.pointPicking&&c.depthMask(l),e.CABO.getElementCount()/u}return 0},t.getOpenGLMode=n=>{if(e.pointPicking)return e.context.POINTS;const r=e.primitiveType;return n===or.POINTS||r===Fo.Points?e.context.POINTS:n===or.WIREFRAME||r===Fo.Lines||r===Fo.TrisEdges||r===Fo.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=(n,r)=>r.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=r.getProperty().getLineWidth()):!1,t.getNeedToRebuildShaders=(n,r,i)=>!!(i.getNeedToRebuildShaders(t,n,r)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<i.getMTime()||t.getShaderSourceTime().getMTime()<r.getMTime()),t.updateShaders=(n,r,i)=>{if(t.getNeedToRebuildShaders(n,r,i)){const a={Vertex:null,Fragment:null,Geometry:null};i.buildShaders(a,n,r);const o=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);o!==t.getProgram()&&(t.setProgram(o),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),i.setMapperShaderParameters(t,n,r),i.setPropertyShaderParameters(t,n,r),i.setCameraShaderParameters(t,n,r),i.setLightingShaderParameters(t,n,r),i.invokeShaderCallbacks(t,n,r)},t.setMapperShaderParameters=(n,r,i)=>{if(t.haveWideLines(n,r)){t.getProgram().setUniform2f("viewportSize",i.usize,i.vsize);const a=parseFloat(r.getProperty().getLineWidth()),o=a/2;t.getProgram().setUniformf("lineWidthStepSize",a/Math.ceil(a)),t.getProgram().setUniformf("halfLineWidth",o)}e.primitiveType===Fo.Points||r.getProperty().getRepresentation()===or.POINTS?t.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=(n,r,i)=>{let a=n.Vertex;a=Te.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,a=Te.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(r,i)&&(a=Te.substitute(a,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,a=Te.substitute(a,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=a},t.getPointPickingPrimitiveSize=()=>e.primitiveType===Fo.Points?2:e.primitiveType===Fo.Lines?4:6,t.getAllocatedGPUMemoryInBytes=()=>t.getCABO().getAllocatedGPUMemoryInBytes()}const DR={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function n8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DR,n),J.obj(t,e),e.shaderSourceTime={},J.obj(e.shaderSourceTime),e.attributeUpdateTime={},J.obj(e.attributeUpdateTime),J.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=Te.newInstance(),e.VAO=D1.newInstance(),e.CABO=dR.newInstance(),ER(t,e)}const OR=J.newInstance(n8);var Ca={newInstance:OR,extend:n8,primTypes:Fo};const RR=t=>t,iv=1e-6;let r8=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.matrix=ut(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?Tb:RR}rotateFromDirections(e,n){const r=new Float64Array(3),i=new Float64Array(3),a=new Float64Array(16);$t(r,e[0],e[1],e[2]),$t(i,n[0],n[1],n[2]),gn(r,r),gn(i,i);const o=zt(r,i);return o>=1?this:(mn(this.tmp,r,i),Qo(this.tmp)<iv&&(mn(this.tmp,[1,0,0],e),Qo(this.tmp)<iv&&mn(this.tmp,[0,1,0],e)),o1(a,Math.acos(o),this.tmp),It(this.matrix,this.matrix,a),this)}rotate(e,n){return $t(this.tmp,...n),gn(this.tmp,this.tmp),Li(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return n1(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return r1(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return i1(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,n,r){return $t(this.tmp,e,n,r),hn(this.matrix,this.matrix,this.tmp),this}scale(e,n,r){return $t(this.tmp,e,n,r),va(this.matrix,this.matrix,this.tmp),this}multiply(e){return It(this.matrix,this.matrix,e),this}multiply3x3(e){return It(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return Sn(this.matrix,this.matrix),this}identity(){return ut(this.matrix),this}apply(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(Fl($g,this.matrix))return this;const i=r===-1?e.length:n+r*3;for(let a=n;a<i;a+=3)$t(this.tmp,e[a],e[a+1],e[a+2]),Dt(this.tmp,this.tmp,this.matrix),e[a]=this.tmp[0],e[a+1]=this.tmp[1],e[a+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&e.length===16&&pn(this.matrix,e),this}};function MR(){return new r8(!0)}function NR(){return new r8(!1)}var Ko={buildFromDegree:MR,buildFromRadian:NR};const LR=[2,0,1,2,2,3,2,4,5,2,6,7,2,0,2,2,1,3,2,4,6,2,5,7,2,0,4,2,1,5,2,2,6,2,3,7],AR=[4,0,1,3,2,4,4,6,7,5,4,8,10,11,9,4,12,13,15,14,4,16,18,19,17,4,20,21,23,22];function FR(t,e){e.classHierarchy.push("vtkCubeSource");function n(r,i){if(e.deleted)return;const a=Kn.newInstance();i[0]=a;const o=24,s=J.newTypedArray(e.pointType,o*3);a.getPoints().setData(s,3);const c=J.newTypedArray(e.pointType,o*3),l=ft.newInstance({name:"Normals",values:c,numberOfComponents:3});a.getPointData().setNormals(l);let f=2;e.generate3DTextureCoordinates===!0&&(f=3);const u=J.newTypedArray(e.pointType,o*f),h=ft.newInstance({name:"TextureCoordinates",values:u,numberOfComponents:f});a.getPointData().setTCoords(h);const p=[0,0,0],d=[0,0,0],g=[0,0];let y=0;p[0]=-e.xLength/2,d[0]=-1,d[1]=0,d[2]=0;for(let x=0;x<2;x++){p[1]=-e.yLength/2;for(let m=0;m<2;m++){g[1]=p[1]+.5,p[2]=-e.zLength/2;for(let v=0;v<2;v++)g[0]=(p[2]+.5)*(1-2*x),s[y*3]=p[0],s[y*3+1]=p[1],s[y*3+2]=p[2],c[y*3]=d[0],c[y*3+1]=d[1],c[y*3+2]=d[2],f===2?(u[y*f]=g[0],u[y*f+1]=g[1]):(u[y*f]=2*x-1,u[y*f+1]=2*m-1,u[y*f+2]=2*v-1),y++,p[2]+=e.zLength;p[1]+=e.yLength}p[0]+=e.xLength,d[0]+=2}p[1]=-e.yLength/2,d[1]=-1,d[0]=0,d[2]=0;for(let x=0;x<2;x++){p[0]=-e.xLength/2;for(let m=0;m<2;m++){g[0]=(p[0]+.5)*(2*x-1),p[2]=-e.zLength/2;for(let v=0;v<2;v++)g[1]=(p[2]+.5)*-1,s[y*3]=p[0],s[y*3+1]=p[1],s[y*3+2]=p[2],c[y*3]=d[0],c[y*3+1]=d[1],c[y*3+2]=d[2],f===2?(u[y*f]=g[0],u[y*f+1]=g[1]):(u[y*f]=2*m-1,u[y*f+1]=2*x-1,u[y*f+2]=2*v-1),y++,p[2]+=e.zLength;p[0]+=e.xLength}p[1]+=e.yLength,d[1]+=2}p[2]=-e.zLength/2,d[2]=-1,d[0]=0,d[1]=0;for(let x=0;x<2;x++){p[1]=-e.yLength/2;for(let m=0;m<2;m++){g[1]=p[1]+.5,p[0]=-e.xLength/2;for(let v=0;v<2;v++)g[0]=(p[0]+.5)*(2*x-1),s[y*3]=p[0],s[y*3+1]=p[1],s[y*3+2]=p[2],c[y*3]=d[0],c[y*3+1]=d[1],c[y*3+2]=d[2],f===2?(u[y*f]=g[0],u[y*f+1]=g[1]):(u[y*f]=2*v-1,u[y*f+1]=2*m-1,u[y*f+2]=2*x-1),y++,p[0]+=e.xLength;p[1]+=e.yLength}p[2]+=e.zLength,d[2]+=2}if(e.rotations&&Ko.buildFromDegree().rotateX(e.rotations[0]).rotateY(e.rotations[1]).rotateZ(e.rotations[2]).apply(s).apply(c),e.center&&Ko.buildFromRadian().translate(...e.center).apply(s),e.matrix){Ko.buildFromRadian().setMatrix(e.matrix).apply(s);const x=[e.matrix[0],e.matrix[1],e.matrix[2],0,e.matrix[4],e.matrix[5],e.matrix[6],0,e.matrix[8],e.matrix[9],e.matrix[10],0,0,0,0,1];Ko.buildFromRadian().setMatrix(x).apply(c)}e.generateFaces?a.getPolys().deepCopy(e._polys):a.getPolys().initialize(),e.generateLines?(a.getLines().deepCopy(e._lineCells),a.getPointData().setNormals(null)):a.getLines().initialize(),a.modified()}t.setBounds=function(){let r=[];if(Array.isArray(arguments.length<=0?void 0:arguments[0]))r=arguments.length<=0?void 0:arguments[0];else for(let i=0;i<arguments.length;i++)r.push(i<0||arguments.length<=i?void 0:arguments[i]);r.length===6&&(t.setXLength(r[1]-r[0]),t.setYLength(r[3]-r[2]),t.setZLength(r[5]-r[4]),t.setCenter([(r[0]+r[1])/2,(r[2]+r[3])/2,(r[4]+r[5])/2]))},t.requestData=n}const IR={xLength:1,yLength:1,zLength:1,pointType:"Float64Array",generate3DTextureCoordinates:!1,generateFaces:!0,generateLines:!1};function i8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IR,n),J.obj(t,e),J.setGet(t,e,["xLength","yLength","zLength","generate3DTextureCoordinates","generateFaces","generateLines"]),J.setGetArray(t,e,["center","rotations"],3),J.setGetArray(t,e,["matrix"],16),e._polys=dl.newInstance({values:Uint16Array.from(AR)}),e._lineCells=dl.newInstance({values:Uint16Array.from(LR)}),J.moveToProtected(t,e,["polys","lineCells"]),J.algo(t,e,0,1),FR(t,e)}const PR=J.newInstance(i8,"vtkCubeSource");var VR={newInstance:PR,extend:i8};const{vtkErrorMacro:av}=J;function kR(t,e){e.classHierarchy.push("vtkImageDataOutlineFilter");const n={...t};t.requestData=(r,i)=>{const a=r[0];if(!a||!a.isA("vtkImageData")){av("Invalid or missing input");return}const o=a.getSpatialExtent();if(!o){av("Unable to fetch spatial extents of input image.");return}e._cubeSource.setBounds(o),e._cubeSource.setMatrix(a.getIndexToWorld()),i[0]=e._cubeSource.getOutputData()},t.getMTime=()=>Math.max(n.getMTime(),e._cubeSource.getMTime()),t.setGenerateFaces=e._cubeSource.setGenerateFaces,t.setGenerateLines=e._cubeSource.setGenerateLines,t.getGenerateFaces=e._cubeSource.getGenerateFaces,t.getGenerateLines=e._cubeSource.getGenerateLines}const UR={};function a8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UR,n),J.obj(t,e),J.algo(t,e,1,1),e._cubeSource=VR.newInstance(),J.moveToProtected(t,e,["cubeSource","tmpOut"]),kR(t,e)}const BR=J.newInstance(a8,"vtkImageDataOutlineFilter");var GR={newInstance:BR,extend:a8};const gl={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},lt={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var o8={Wrap:gl,Filter:lt};const s8=new Float32Array(1),WR=new Int32Array(s8.buffer);function zR(t){s8[0]=t;const e=WR[0];let n=e>>16&32768,r=e>>12&2047;const i=e>>23&255;return i<103?n:i>142?(n|=31744,n|=(i===255?0:1)&&e&8388607,n):i<113?(r|=2048,n|=(r>>114-i)+(r>>113-i&1),n):(n|=i-112<<10|r>>1,n+=r&1,n)}function jR(t){const e=(t&32768)>>15,n=(t&31744)>>10,r=t&1023;return n===0?(e?-1:1)*2**-14*(r/2**10):n===31?r?NaN:(e?-1:1)*(1/0):(e?-1:1)*2**(n-15)*(1+r/2**10)}var Ks={fromHalf:jR,toHalf:zR};function $R(){try{const r=new Int16Array([0,32767]),i=[1,1],a=document.createElement("canvas");a.width=4,a.height=4;const o=a.getContext("webgl2");if(!o)return!1;const s=o.getExtension("EXT_texture_norm16");if(!s)return!1;const c=`#version 300 es
    void main() {
      gl_PointSize = ${4 .toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,l=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `,f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))return!1;const u=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(u,l),o.compileShader(u),!o.getShaderParameter(u,o.COMPILE_STATUS))return!1;const h=o.createProgram();if(o.attachShader(h,f),o.attachShader(h,u),o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))return!1;const p=o.createTexture();o.bindTexture(o.TEXTURE_2D,p),o.texImage2D(o.TEXTURE_2D,0,s.R16_SNORM_EXT,2,1,0,o.RED,o.SHORT,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.useProgram(h),o.drawArrays(o.POINTS,0,1);const d=new Uint8Array(4);o.readPixels(i[0],i[1],1,1,o.RGBA,o.UNSIGNED_BYTE,d);const[g,y,x]=d,m=o.getExtension("WEBGL_lose_context");return m&&m.loseContext(),g===y&&y===x&&g!==0}catch{return!1}}let Tp;function HR(){return Tp===void 0&&(Tp=$R()),Tp}const{Wrap:Wa,Filter:jn}=o8,{VtkDataTypes:Wt}=ft,{vtkDebugMacro:_p,vtkErrorMacro:gc,vtkWarningMacro:ov}=sr,{toHalf:KR}=Ks;function qR(t,e){e.classHierarchy.push("vtkOpenGLTexture");function n(){return{internalFormat:e.internalFormat,format:e.format,openGLDataType:e.openGLDataType,width:e.width,height:e.height}}t.render=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(d?e._openGLRenderWindow=d:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(jn.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(jn.LINEAR),t.setMagnificationFilter(jn.LINEAR)):(t.setMinificationFilter(jn.NEAREST),t.setMagnificationFilter(jn.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(Wa.REPEAT),t.setWrapS(Wa.REPEAT),t.setWrapT(Wa.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(jn.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(jn.LINEAR_MIPMAP_LINEAR));const y=e.renderable.getCanvas();t.create2DFromRaw(y.width,y.height,4,Wt.UNSIGNED_CHAR,y,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){const y=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(jn.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(y.width,y.height,4,Wt.UNSIGNED_CHAR,y.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}const g=e.renderable.getInputData(0);if(g&&g.getPointData().getScalars()){const y=g.getExtent(),x=g.getPointData().getScalars(),m=[];for(let v=0;v<e.renderable.getNumberOfInputPorts();++v){const w=e.renderable.getInputData(v),C=w?w.getPointData().getScalars().getData():null;C&&m.push(C)}e.renderable.getInterpolate()&&x.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(jn.LINEAR_MIPMAP_LINEAR)),m.length%6===0?t.createCubeFromRaw(y[1]-y[0]+1,y[3]-y[2]+1,x.getNumberOfComponents(),x.getDataType(),m):t.create2DFromRaw(y[1]-y[0]+1,y[3]-y[2]+1,x.getNumberOfComponents(),x.getDataType(),x.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()};const r=()=>{if(!((e.minificationFilter===jn.LINEAR||e.magnificationFilter===jn.LINEAR)&&!HR()))return e.oglNorm16Ext};t.destroyTexture=()=>{t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=()=>{e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=()=>e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1,t.activate=()=>{e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=()=>{e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=d=>{d&&e.handle&&(d.activateTexture(t),d.deactivateTexture(t),e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0,e.allocatedGPUMemoryInBytes=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(d),e.shaderProgram=null)},t.bind=()=>{e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=()=>{let d=!1;if(e.context&&e.handle){let g=0;switch(e.target){case e.context.TEXTURE_2D:g=e.context.TEXTURE_BINDING_2D;break;default:ov("impossible case");break}d=e.context.getIntegerv(g)===e.handle}return d},t.sendParameters=()=>{e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=(d,g)=>(e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(d,g)),e.internalFormat||_p(`Unable to find suitable internal format for T=${d} NC= ${g}`),[e.context.R32F,e.context.RG32F,e.context.RGB32F,e.context.RGBA32F].includes(e.internalFormat)&&!e.context.getExtension("OES_texture_float_linear")&&ov("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),e.internalFormat),t.getDefaultInternalFormat=(d,g)=>{let y=0;return y=e._openGLRenderWindow.getDefaultTextureInternalFormat(d,g,r(),t.useHalfFloat()),y||(y||(_p("Unsupported internal texture type!"),_p(`Unable to find suitable internal format for T=${d} NC= ${g}`)),y)},t.useHalfFloat=()=>e.enableUseHalfFloat&&e.canUseHalfFloat,t.setInternalFormat=d=>{e._forceInternalFormat=!0,d!==e.internalFormat&&(e.internalFormat=d,t.modified())},t.getFormat=(d,g)=>(e.format=t.getDefaultFormat(d,g),e.format),t.getDefaultFormat=(d,g)=>{if(e._openGLRenderWindow.getWebgl2())switch(g){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(g){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=()=>{e._prevTexParams=null,e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=d=>{const g=t.useHalfFloat();if(e._openGLRenderWindow.getWebgl2())switch(d){case Wt.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(r()&&!g&&Wt.SHORT):return e.context.SHORT;case(r()&&!g&&Wt.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(g&&Wt.SHORT):return e.context.HALF_FLOAT;case(g&&Wt.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case Wt.FLOAT:case Wt.VOID:default:return e.context.FLOAT}switch(d){case Wt.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case Wt.FLOAT:case Wt.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{const y=e.context.getExtension("OES_texture_half_float");if(y&&e.context.getExtension("OES_texture_half_float_linear"))return y.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||g)&&(e.openGLDataType=t.getDefaultDataType(d)),e.openGLDataType},t.getShiftAndScale=()=>{let d=0,g=1;switch(e.openGLDataType){case e.context.BYTE:g=127.5,d=g-128;break;case e.context.UNSIGNED_BYTE:g=255,d=0;break;case e.context.SHORT:g=32767.5,d=g-32768;break;case e.context.UNSIGNED_SHORT:g=65536,d=0;break;case e.context.INT:g=21474836475e-1,d=g-2147483648;break;case e.context.UNSIGNED_INT:g=4294967295,d=0;break;case e.context.FLOAT:}return{shift:d,scale:g}},t.getOpenGLFilterMode=d=>{switch(d){case jn.NEAREST:return e.context.NEAREST;case jn.LINEAR:return e.context.LINEAR;case jn.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case jn.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case jn.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case jn.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=d=>{switch(d){case Wa.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case Wa.REPEAT:return e.context.REPEAT;case Wa.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function i(d){const[g,y,x,m,v,w]=d;return[y-g+1,m-x+1,w-v+1]}function a(d){const[g,y,x]=i(d);return g*y*x}function o(d,g,y,x,m){const[v,w,C,T,_,S]=y,[b,D]=g,E=b*D;let R=m;for(let F=_;F<=S;F++){const M=F*E;for(let U=C;U<=T;U++){const z=M+U*b;for(let Y=z+v,W=z+w;Y<=W;Y++,R++)x[R]=d[Y]}}}function s(d,g){const x=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:null)||d.constructor,m=g.reduce((T,_)=>T+a(_),0),v=new x(m),w=[e.width,e.height,e.depth];let C=0;return g.forEach(T=>{o(d,w,T,v,C),C+=a(T)}),v}t.updateArrayDataTypeForGL=function(d,g){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];const m=[];let v=e.width*e.height*e.components;y&&(v*=e.depth);const w=!!x.length;if(d!==Wt.FLOAT&&e.openGLDataType===e.context.FLOAT)for(let T=0;T<g.length;T++)if(g[T])if(w)m.push(s(g[T],x,Float32Array));else{const _=g[T].length>v?g[T].subarray(0,v):g[T];m.push(new Float32Array(_))}else m.push(null);if(d!==Wt.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(let T=0;T<g.length;T++)if(g[T])if(w)m.push(s(g[T],x,Uint8Array));else{const _=g[T].length>v?g[T].subarray(0,v):g[T];m.push(new Uint8Array(_))}else m.push(null);let C=!1;if(e._openGLRenderWindow.getWebgl2())C=e.openGLDataType===e.context.HALF_FLOAT;else{const T=e.context.getExtension("OES_texture_half_float");C=T&&e.openGLDataType===T.HALF_FLOAT_OES}if(C)for(let T=0;T<g.length;T++)if(g[T]){const _=w?s(g[T],x):g[T],S=new Uint16Array(w?_.length:v),b=S.length;for(let D=0;D<b;D++)S[D]=KR(_[D]);m.push(S)}else m.push(null);if(m.length===0)for(let T=0;T<g.length;T++)m.push(w&&g[T]?s(g[T],x):g[T]);return m};function c(d){if(e._openGLRenderWindow.getWebgl2())return d;const g=[],y=e.width,x=e.height,m=e.components;if(d&&(!Eu(y)||!Eu(x))){const v=e.context.getExtension("OES_texture_half_float"),w=gi(y),C=gi(x),T=w*C*e.components;for(let _=0;_<d.length;_++)if(d[_]!==null){let S=null;const b=x/C,D=y/w;let E=!1;e.openGLDataType===e.context.FLOAT?S=new Float32Array(T):v&&e.openGLDataType===v.HALF_FLOAT_OES?(S=new Uint16Array(T),E=!0):S=new Uint8Array(T);for(let R=0;R<C;R++){const F=R*w*m,M=R*b;let U=Math.floor(M),z=Math.ceil(M);z>=x&&(z=x-1);const Y=M-U,W=1-Y;U=U*y*m,z=z*y*m;for(let B=0;B<w;B++){const j=B*m,ie=B*D;let ae=Math.floor(ie),fe=Math.ceil(ie);fe>=y&&(fe=y-1);const Ee=ie-ae;ae*=m,fe*=m;for(let ge=0;ge<m;ge++)E?S[F+j+ge]=Ks.toHalf(Ks.fromHalf(d[_][U+ae+ge])*W*(1-Ee)+Ks.fromHalf(d[_][U+fe+ge])*W*Ee+Ks.fromHalf(d[_][z+ae+ge])*Y*(1-Ee)+Ks.fromHalf(d[_][z+fe+ge])*Y*Ee):S[F+j+ge]=d[_][U+ae+ge]*W*(1-Ee)+d[_][U+fe+ge]*W*Ee+d[_][z+ae+ge]*Y*(1-Ee)+d[_][z+fe+ge]*Y*Ee}}g.push(S),e.width=w,e.height=C}else g.push(null)}if(g.length===0)for(let v=0;v<d.length;v++)g.push(d[v]);return g}function l(d){return e._openGLRenderWindow?e.resizable||e.renderable?.getResizable()?!1:e._openGLRenderWindow.getWebgl2()?!(e._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r()&&(d===Wt.UNSIGNED_SHORT||d===Wt.SHORT)):!1:!1}t.create2DFromRaw=function(d,g,y,x,m){let v=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(x,!0),t.getInternalFormat(x,y),t.getFormat(x,y),!e.internalFormat||!e.format||!e.openGLDataType)return gc("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=y,e.width=d,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const w=[m],C=t.updateArrayDataTypeForGL(x,w),T=c(C);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,v),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),l(x)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),T[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,T[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),v&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*y*e._openGLRenderWindow.getDefaultTextureByteSize(x,r(),t.useHalfFloat()),t.deactivate(),!0},t.createCubeFromRaw=(d,g,y,x,m)=>{if(t.getOpenGLDataType(x),t.getInternalFormat(x,y),t.getFormat(x,y),!e.internalFormat||!e.format||!e.openGLDataType)return gc("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=y,e.width=d,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=m.length/6-1,t.createTexture(),t.bind();const v=t.updateArrayDataTypeForGL(x,m),w=c(v),C=[];let T=e.width,_=e.height;for(let S=0;S<w.length;S++){S%6===0&&S!==0&&(T/=2,_/=2),C[S]=Qc(x,_*T*e.components);for(let b=0;b<_;++b){const D=b*T*e.components,E=(_-b-1)*T*e.components;C[S].set(w[S].slice(E,E+T*e.components),D)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),l(x)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(let S=0;S<6;S++){let b=0,D=e.width,E=e.height;for(;D>=1&&E>=1;){let R=null;b<=e.maxLevel&&(R=C[6*b+S]),l(x)?R!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+S,b,0,0,D,E,e.format,e.openGLDataType,R):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+S,b,e.internalFormat,D,E,0,e.format,e.openGLDataType,R),b++,D/=2,E/=2}}return e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*y*e._openGLRenderWindow.getDefaultTextureByteSize(x,r(),t.useHalfFloat()),t.deactivate(),!0},t.createDepthFromRaw=(d,g,y,x)=>(t.getOpenGLDataType(y),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?y===Wt.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(gc("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=d,e.height=g,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),l(y)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),x!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,x)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,x),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0)),t.create2DFromImage=d=>{if(t.getOpenGLDataType(Wt.UNSIGNED_CHAR),t.getInternalFormat(Wt.UNSIGNED_CHAR,4),t.getFormat(Wt.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return gc("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);const g=!e._openGLRenderWindow.getWebgl2()&&(!Eu(d.width)||!Eu(d.height)),y=document.createElement("canvas");y.width=g?gi(d.width):d.width,y.height=g?gi(d.height):d.height,e.width=y.width,e.height=y.height;const x=y.getContext("2d");x.translate(0,y.height),x.scale(1,-1),x.drawImage(d,0,0,d.width,d.height,0,0,y.width,y.height);const m=y;return l(Wt.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),m!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,m)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,m),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(Wt.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0};function f(d,g,y){const x=new Array(y),m=new Array(y);for(let v=0;v<y;++v)x[v]=d[v],m[v]=g[v]-d[v]||1;return{scale:m,offset:x}}function u(d,g){for(let y=0;y<d.length;y++){const x=d[y],m=g[y]+x;if(x<-2048||x>2048||m<-2048||m>2048)return!1}return!0}function h(d,g,y,x){t.getOpenGLDataType(d);const m=u(g,y)||x;let v=!1;if(e._openGLRenderWindow.getWebgl2())v=e.openGLDataType===e.context.FLOAT&&e.context.getExtension("OES_texture_float_linear")===null&&m||e.openGLDataType===e.context.HALF_FLOAT;else{const w=e.context.getExtension("OES_texture_half_float");v=w&&e.openGLDataType===w.HALF_FLOAT_OES}e.canUseHalfFloat=v&&m}function p(d,g){const y=d.getNumberOfComponents(),x=d.getDataType(),m=d.getData(),v=new Array(y),w=new Array(y);for(let T=0;T<y;++T){const[_,S]=d.getRange(T);v[T]=_,w[T]=S}const C=f(v,w,y);return h(x,C.offset,C.scale,g),t.useHalfFloat()||t.getOpenGLDataType(x,!0),{numComps:y,dataType:x,data:m,scaleOffsets:C}}t.create2DFilterableFromRaw=function(d,g,y,x,m){let v=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0;return t.create2DFilterableFromDataArray(d,g,ft.newInstance({numberOfComponents:y,dataType:x,values:m,ranges:w}),v)},t.create2DFilterableFromDataArray=function(d,g,y){let x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const{numComps:m,dataType:v,data:w}=p(y,x);t.create2DFromRaw(d,g,m,v,w)},t.updateVolumeInfoForGL=(d,g)=>{let y=!1;const x=t.useHalfFloat();(!e.volumeInfo?.scale||!e.volumeInfo?.offset)&&(e.volumeInfo={scale:new Array(g),offset:new Array(g)});for(let m=0;m<g;++m)e.volumeInfo.scale[m]=1,e.volumeInfo.offset[m]=0;if(r()&&!x&&d===Wt.SHORT){for(let m=0;m<g;++m)e.volumeInfo.scale[m]=32767;y=!0}if(r()&&!x&&d===Wt.UNSIGNED_SHORT){for(let m=0;m<g;++m)e.volumeInfo.scale[m]=65535;y=!0}if(d===Wt.UNSIGNED_CHAR){for(let m=0;m<g;++m)e.volumeInfo.scale[m]=255;y=!0}return(d===Wt.FLOAT||x&&(d===Wt.SHORT||d===Wt.UNSIGNED_SHORT))&&(y=!0),y},t.create3DFromRaw=function(d,g,y,x,m,v){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[],C=m,T=v;if(!t.updateVolumeInfoForGL(C,x)&&T){const F=d*g*y,M=structuredClone(e.volumeInfo),U=new Float32Array(F*x);e.volumeInfo.offset=M.offset,e.volumeInfo.scale=M.scale;let z=0;const Y=M.scale.map(W=>1/W);for(let W=0;W<F;W++)for(let B=0;B<x;B++)U[z]=(T[z]-M.offset[B])*Y[B],z++;C=Wt.FLOAT,T=U}if(t.getOpenGLDataType(C),t.getInternalFormat(C,x),t.getFormat(C,x),!e.internalFormat||!e.format||!e.openGLDataType)return gc("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=x,e.width=d,e.height=g,e.depth=y,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const _=w.length>0,S=!_||!Pg(e._prevTexParams,n()),b=[T],E=t.updateArrayDataTypeForGL(C,b,!0,S?[]:w),R=c(E);if(e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),S)l(C)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),R[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,R[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,R[0]),e._prevTexParams=n();else if(_){const F=R[0];let M=0;for(let U=0;U<w.length;U++){const z=w[U],Y=i(z),W=a(z),B=new F.constructor(F.buffer,M,W);M+=B.byteLength,e.context.texSubImage3D(e.target,0,z[0],z[2],z[4],Y[0],Y[1],Y[2],e.format,e.openGLDataType,B)}}return e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(C,r(),t.useHalfFloat()),t.deactivate(),!0},t.create3DFilterableFromRaw=function(d,g,y,x,m,v){let w=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,C=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,T=arguments.length>8&&arguments[8]!==void 0?arguments[8]:[];return t.create3DFilterableFromDataArray(d,g,y,ft.newInstance({numberOfComponents:x,dataType:m,values:v,ranges:C}),w,T)},t.create3DFilterableFromDataArray=function(d,g,y,x){let m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,v=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];const{numComps:w,dataType:C,data:T,scaleOffsets:_}=p(x,m),S=[],b=[];for(let be=0;be<w;++be)S[be]=0,b[be]=1;if(e.volumeInfo={scale:b,offset:S,dataComputedScale:_.scale,dataComputedOffset:_.offset,width:d,height:g,depth:y},e._openGLRenderWindow.getWebgl2())return t.create3DFromRaw(d,g,y,w,C,T,v);const D=d*g*y,E=structuredClone(_);let R=(be,Re,Ne,Ce,P)=>{be[Re]=Ne},F=Wt.UNSIGNED_CHAR;if(C===Wt.UNSIGNED_CHAR)for(let be=0;be<w;++be)E.offset[be]=0,E.scale[be]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(F=Wt.FLOAT,R=(be,Re,Ne,Ce,P)=>{be[Re]=(Ne-Ce)/P}):(F=Wt.UNSIGNED_CHAR,R=(be,Re,Ne,Ce,P)=>{be[Re]=255*(Ne-Ce)/P});if(t.getOpenGLDataType(F),t.getInternalFormat(F,w),t.getFormat(F,w),!e.internalFormat||!e.format||!e.openGLDataType)return gc("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=w,e.depth=1,e.numberOfDimensions=2;let M=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);M>4096&&(F===Wt.FLOAT||w>=3)&&(M=4096);let U=1,z=1;D>M*M&&(U=Math.ceil(Math.sqrt(D/(M*M))),z=U);let Y=Math.sqrt(D)/U;Y=gi(Y);const W=Math.floor(Y*U/d),B=Math.ceil(y/W),j=gi(g*B/z);e.width=Y,e.height=j,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=W,e.volumeInfo.yreps=B,e.volumeInfo.xstride=U,e.volumeInfo.ystride=z,e.volumeInfo.offset=E.offset,e.volumeInfo.scale=E.scale;let ie;const ae=Y*j*w;F===Wt.FLOAT?ie=new Float32Array(ae):ie=new Uint8Array(ae);let fe=0;const Ee=Math.floor(d/U),ge=Math.floor(g/z);for(let be=0;be<B;be++){const Re=Math.min(W,y-be*W),Ne=w*(e.width-Re*Math.floor(d/U));for(let Ce=0;Ce<ge;Ce++){for(let P=0;P<Re;P++){const O=w*((be*W+P)*d*g+z*Ce*d);for(let A=0;A<Ee;A++)for(let L=0;L<w;L++)R(ie,fe,T[O+U*A*w+L],E.offset[L],E.scale[L]),fe++}fe+=Ne}}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),l(F)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),ie!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,ie)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,ie),t.deactivate(),!0},t.setOpenGLRenderWindow=d=>{e._openGLRenderWindow!==d&&(t.releaseGraphicsResources(),e._openGLRenderWindow=d,e.context=null,d&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=d=>d&&d.isCurrent()?d.getIntegerv(d.MAX_TEXTURE_SIZE):-1,t.enableUseHalfFloat=d=>{e.enableUseHalfFloat=d}}const XR={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:Wa.CLAMP_TO_EDGE,wrapT:Wa.CLAMP_TO_EDGE,wrapR:Wa.CLAMP_TO_EDGE,minificationFilter:jn.NEAREST,magnificationFilter:jn.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function c8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XR,n),en.extend(t,e,n),e.sendParametersTime={},an(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},an(e.textureBuildTime,{mtime:0}),Ml(t,e,["format","openGLDataType"]),bn(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),mr(t,e,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),Nl(t,e,["openGLRenderWindow"]),qR(t,e)}const u8=kt(c8,"vtkOpenGLTexture");var fn={newInstance:u8,extend:c8,...o8};An("vtkTexture",u8);function YR(t,e){t.replaceShaderCoincidentOffset=(n,r,i)=>{const a=t.getCoincidentParameters(r,i);if(a&&(a.factor!==0||a.offset!==0)){let o=n.Fragment;o=Te.substitute(o,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(a.factor!==0?(o=Te.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=Te.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=Te.substitute(o,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(a.factor!==0?(o=Te.substitute(o,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,o=Te.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):o=Te.substitute(o,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=o}}}function JR(t,e){t.applyShaderReplacements=(n,r,i)=>{let a=null;if(r&&(a=r.ShaderReplacements),a)for(let o=0;o<a.length;o++){const s=a[o];if(i&&s.replaceFirst||!i&&!s.replaceFirst){const c=s.shaderType,l=n[c],f=Te.substitute(l,s.originalValue,s.replacementValue,s.replaceAll);n[c]=f.result}}},t.buildShaders=(n,r,i)=>{t.getReplacedShaderTemplate(n,r,i),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);const a=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(n,a,!0),t.replaceShaderValues(n,r,i),t.applyShaderReplacements(n,a)},t.getReplacedShaderTemplate=(n,r,i)=>{const a=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(n,r,i);let o=n.Vertex;if(a){const l=a.VertexShaderCode;l!==void 0&&l!==""&&(o=l)}n.Vertex=o;let s=n.Fragment;if(a){const l=a.FragmentShaderCode;l!==void 0&&l!==""&&(s=l)}n.Fragment=s;let c=n.Geometry;if(a){const l=a.GeometryShaderCode;l!==void 0&&(c=l)}n.Geometry=c}}var ya={implementReplaceShaderCoincidentOffset:YR,implementBuildShadersWithReplacements:JR};let O1;function ZR(t,e){e.classHierarchy.push("vtkAbstractTransform","vtkHomogeneousTransform","vtkTransform"),t.transformPoint=(n,r)=>(Dt(r,n,e.matrix),r),t.transformPoints=(n,r)=>{const i=new Float64Array(3),a=new Float64Array(3);for(let o=0;o<n.length;o+=3)i[0]=n[o],i[1]=n[o+1],i[2]=n[o+2],Dt(a,i,e.matrix),r[o]=a[0],r[o+1]=a[1],r[o+2]=a[2];return r},t.preMultiply=()=>{t.setPreMultiplyFlag(!0)},t.postMultiply=()=>{t.setPreMultiplyFlag(!1)},t.transformMatrix=(n,r)=>(e.preMultiplyFlag?It(r,e.matrix,n):It(r,n,e.matrix),r),t.transformMatrices=(n,r)=>{const i=new Float64Array(16),a=new Float64Array(16),o=e.preMultiplyFlag?()=>It(a,e.matrix,i):()=>It(a,i,e.matrix);for(let s=0;s<n.length;s+=16){for(let c=0;c<16;++c)i[c]=n[s+c];o();for(let c=0;c<16;++c)r[s+c]=a[c]}return r},t.getInverse=()=>O1({matrix:mi.invertMatrix(Array.from(e.matrix),[],4),preMultiplyFlag:e.preMultiplyFlag})}const QR={preMultiplyFlag:!1,matrix:[...$g]};function l8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QR,n),J.obj(t,e),J.setGet(t,e,["preMultiplyFlag"]),J.setGetArray(t,e,["matrix"],16),ZR(t,e)}O1=J.newInstance(l8,"vtkTransform");var eM={newInstance:O1,extend:l8};function xa(t,e,n){return t?`${t.getMTime()}-${e}-${n}`:"0"}function R1(t,e){return`${t.getMTime()}A${e.getMTime()}`}var tM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model coordinates
// WC - World coordinates
// VC - View coordinates
// DC - Display coordinates
// TC - Texture coordinates

// frag position in VC
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// camera and actor matrix values
//VTK::Camera::Dec

void main()
{
  //VTK::PositionVC::Impl

  //VTK::TCoord::Impl

  //VTK::Picking::Impl
}
`,nM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkImageResliceMapperFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the gpu image mapper fragment shader

// VC position of this fragment
//VTK::PositionVC::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

// the output of this shader
//VTK::Output::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  //VTK::TCoord::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const tc={NEAREST:0,LINEAR:1};var rM={InterpolationType:tc};const ji={Off:0,PolygonOffset:1};let jd=ji.PolygonOffset,Vf=ji.Off;const iM=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function aM(){return jd}function oM(t){const e=jd===t;return jd=t,e}function sM(){return Vf}function Oh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const e=Vf===t;return Vf=t,e}function cM(){return Oh(ji.Off)}function uM(){return Oh(ji.Off)}function lM(){return Oh(ji.PolygonOffset)}function fM(){return iM[Vf]}var $d={Resolve:ji,getResolveCoincidentTopologyAsString:fM,getResolveCoincidentTopologyPolygonOffsetFaces:aM,getResolveCoincidentTopology:sM,setResolveCoincidentTopology:Oh,setResolveCoincidentTopologyPolygonOffsetFaces:oM,setResolveCoincidentTopologyToDefault:cM,setResolveCoincidentTopologyToOff:uM,setResolveCoincidentTopologyToPolygonOffset:lM};function f8(t,e,n){n.forEach(r=>{t[`get${r.method}`]=()=>e[r.key],t[`set${r.method}`]=J.objectSetterMap.object(t,e,{name:r.key,params:["factor","offset"]})})}const M1=["Polygon","Line","Point"],hM={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},pM=()=>{},qs={modified:pM};f8(qs,hM,M1.map(t=>({key:t,method:`ResolveCoincidentTopology${t}OffsetParameters`})));function dM(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),J.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys($d).forEach(n=>{t[n]=$d[n]}),Object.keys(qs).filter(n=>n!=="modified").forEach(n=>{t[n]=qs[n]}),f8(t,e.topologyOffset,M1.map(n=>({key:n,method:`RelativeCoincidentTopology${n}OffsetParameters`}))),t.getCoincidentTopologyPolygonOffsetParameters=()=>{const n=qs.getResolveCoincidentTopologyPolygonOffsetParameters(),r=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyLineOffsetParameters=()=>{const n=qs.getResolveCoincidentTopologyLineOffsetParameters(),r=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyPointOffsetParameter=()=>{const n=qs.getResolveCoincidentTopologyPointOffsetParameters(),r=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}}}var Rh={implementCoincidentTopologyMethods:dM,staticOffsetAPI:qs,otherStaticMethods:$d,CATEGORIES:M1,Resolve:ji};const{vtkErrorMacro:Ns}=sr;function sv(t,e,n){return e.identity(n),t.reduce((r,i,a)=>a===0?i?e.copy(r,i):e.identity(r):i?e.multiply(r,r,i):r,n)}function gM(t,e){e.classHierarchy.push("vtkOpenGLImageResliceMapper");function n(i){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=i=>{if(i){e.currentRenderPass=null,e._openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const a=e._openGLRenderer.getRenderable();e._openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera());const o=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.translucentPass=(i,a)=>{i&&(e.currentRenderPass=a,t.render())},t.zBufferPass=i=>{i&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=i=>t.zBufferPass(i),t.opaquePass=i=>{i&&t.render()},t.getCoincidentParameters=(i,a)=>e.renderable.getResolveCoincidentTopology()==ji.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const i=e._openGLImageSlice.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),!e.currentInput){Ns("No input!");return}t.updateResliceGeometry(),t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a),t.invokeEvent({type:"EndEvent"})},t.renderPieceStart=(i,a)=>{t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===tc.NEAREST?(e.openGLTexture.setMinificationFilter(lt.NEAREST),e.openGLTexture.setMagnificationFilter(lt.NEAREST),e.colorTexture.setMinificationFilter(lt.NEAREST),e.colorTexture.setMagnificationFilter(lt.NEAREST),e.pwfTexture.setMinificationFilter(lt.NEAREST),e.pwfTexture.setMagnificationFilter(lt.NEAREST)):(e.openGLTexture.setMinificationFilter(lt.LINEAR),e.openGLTexture.setMagnificationFilter(lt.LINEAR),e.colorTexture.setMinificationFilter(lt.LINEAR),e.colorTexture.setMagnificationFilter(lt.LINEAR),e.pwfTexture.setMinificationFilter(lt.LINEAR),e.pwfTexture.setMagnificationFilter(lt.LINEAR)),e.lastBoundBO=null},t.renderPieceDraw=(i,a)=>{const o=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(i,a)=>{},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.resliceGeom.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()?.getScalars();if(!s)return;const c=s.getNumberOfComponents();let l=R1(o,s);const f=e._openGLRenderWindow.getGraphicsResourceForObject(s),u=!f?.oglObject?.getHandle()||f?.hash!==l,h=e.renderable.getUpdatedExtents(),p=!!h.length;if(u&&!p){e.openGLTexture=fn.newInstance(),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.openGLTexture.resetFormatAndType();const b=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(b[0],b[1],b[2],s,!1,h),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.openGLTexture,l),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.openGLTexture=f.oglObject;if(p){e.renderable.setUpdatedExtents([]);const b=o.getDimensions();e.openGLTexture.create3DFilterableFromDataArray(b[0],b[1],b[2],s,!1,h)}const d=a.getProperty(),g=d.getIndependentComponents(),y=g?c:1,x=g?2*y:1,m=d.getRGBTransferFunction();l=xa(m,g,y);const v=e._openGLRenderWindow.getGraphicsResourceForObject(m);if(!v?.oglObject?.getHandle()||v?.hash!==l){const D=1024*x*3,E=new Uint8ClampedArray(D);if(e.colorTexture=fn.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),m){const R=new Float32Array(3072);for(let F=0;F<y;F++){const M=d.getRGBTransferFunction(F),U=M.getRange();if(M.getTable(U[0],U[1],1024,R,1),g)for(let z=0;z<1024*3;z++)E[F*1024*6+z]=255*R[z],E[F*1024*6+z+1024*3]=255*R[z];else for(let z=0;z<1024*3;z++)E[F*1024*6+z]=255*R[z]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,x,3,Ot.UNSIGNED_CHAR,E)}else{for(let R=0;R<1024*3;++R)E[R]=255*R/(1023*3),E[R+1]=255*R/(1023*3),E[R+2]=255*R/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Ot.UNSIGNED_CHAR,E)}m&&(e._openGLRenderWindow.setGraphicsResourceForObject(m,e.colorTexture,l),m!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(m,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=m)}else e.colorTexture=v.oglObject;const C=d.getPiecewiseFunction();l=xa(C,g,y);const T=e._openGLRenderWindow.getGraphicsResourceForObject(C);if(!T?.oglObject?.getHandle()||T?.hash!==l){const D=1024*x,E=new Uint8ClampedArray(D);if(e.pwfTexture=fn.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),C){const R=new Float32Array(D),F=new Float32Array(1024);for(let M=0;M<y;++M){const U=d.getPiecewiseFunction(M);if(U===null)R.fill(1);else{const z=U.getRange();if(U.getTable(z[0],z[1],1024,F,1),g)for(let Y=0;Y<1024;Y++)R[M*1024*2+Y]=F[Y],R[M*1024*2+Y+1024]=F[Y];else for(let Y=0;Y<1024;Y++)R[M*1024*2+Y]=F[Y]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,x,1,Ot.FLOAT,R)}else E.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Ot.UNSIGNED_CHAR,E);C&&(e._openGLRenderWindow.setGraphicsResourceForObject(C,e.pwfTexture,l),C!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(C,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=C)}else e.pwfTexture=T.oglObject;const S=`${e.resliceGeom.getMTime()}A${e.renderable.getSlabThickness()}`;if(!e.tris.getCABO().getElementCount()||e.VBOBuildString!==S){const b=ft.newInstance({numberOfComponents:3,values:e.resliceGeom.getPoints().getData()});b.setName("points");const D=ft.newInstance({numberOfComponents:1,values:e.resliceGeom.getPolys().getData()}),E={points:b,cellOffset:0};if(e.renderable.getSlabThickness()>0){const R=e.resliceGeom.getPointData().getNormals();R?E.normals=R:Ns("Slab mode requested without normals")}e.tris.getCABO().createVBO(D,"polys",or.SURFACE,E)}e.VBOBuildString=S,e.VBOBuildTime.modified()},t.updateShaders=(i,a,o)=>{if(e.lastBoundBO=i,t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const c=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);c!==i.getProgram()&&(i.setProgram(c),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();if(i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())){s.isUniformUsed("texture1")&&s.setUniformi("texture1",e.openGLTexture.getTextureUnit()),s.isAttributeUsed("vertexWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexWC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Ns("Error setting vertexWC in shader VAO.")),s.isAttributeUsed("normalWC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"normalWC",i.getCABO().getNormalOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Ns("Error setting normalWC in shader VAO.")),s.isUniformUsed("slabThickness")&&s.setUniformf("slabThickness",e.renderable.getSlabThickness()),s.isUniformUsed("spacing")&&s.setUniform3fv("spacing",e.currentInput.getSpacing()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabType")&&s.setUniformi("slabType",e.renderable.getSlabType()),s.isUniformUsed("slabTrapezoid")&&s.setUniformi("slabTrapezoid",e.renderable.getSlabTrapezoidIntegration());const l=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null;if(s.isUniformUsed("WCTCMatrix")){const f=e.currentInput,u=f.getDimensions();pn(e.tmpMat4,f.getIndexToWorld()),hn(e.tmpMat4,e.tmpMat4,[-.5,-.5,-.5]),va(e.tmpMat4,e.tmpMat4,u),Sn(e.tmpMat4,e.tmpMat4),l&&It(e.tmpMat4,e.tmpMat4,l),s.setUniformMatrix("WCTCMatrix",e.tmpMat4)}s.isUniformUsed("vboScaling")&&s.setUniform3fv("vboScaling",i.getCABO().getCoordScale()??[1,1,1]),i.getAttributeUpdateTime().modified()}if(e.haveSeenDepthRequest&&i.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),i.getProgram().isUniformUsed("coffset")){const c=t.getCoincidentParameters(a,o);i.getProgram().setUniformf("coffset",c.offset),i.getProgram().isUniformUsed("cfactor")&&i.getProgram().setUniformf("cfactor",c.factor)}},t.setCameraShaderParameters=(i,a,o)=>{const s=e._openGLCamera.getKeyMatrices(a),c=e._openGLImageSlice.getKeyMatrices(),f=i.getCABO().getCoordShiftAndScaleEnabled()?i.getCABO().getInverseShiftAndScaleMatrix():null,u=i.getProgram();u.isUniformUsed("MCPCMatrix")&&(ut(e.tmpMat4),u.setUniformMatrix("MCPCMatrix",sv([s.wcpc,c.mcwc,f],hl,e.tmpMat4))),u.isUniformUsed("MCVCMatrix")&&(ut(e.tmpMat4),u.setUniformMatrix("MCVCMatrix",sv([s.wcvc,c.mcwc,f],hl,e.tmpMat4)))},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram(),c=o.getProperty(),l=c.getOpacity();s.setUniformf("opacity",l);const f=e.openGLTexture.getComponents(),u=c.getIndependentComponents();if(u)for(let g=0;g<f;++g)s.setUniformf(`mix${g}`,c.getComponentWeight(g));const h=e.openGLTexture.getVolumeInfo();for(let g=0;g<f;g++){let y=c.getColorWindow(),x=c.getColorLevel();const m=u?g:0,v=c.getRGBTransferFunction(m);if(v&&c.getUseLookupTableScalarRange()){const T=v.getRange();y=T[1]-T[0],x=.5*(T[1]+T[0])}const w=h.scale[g]/y,C=(h.offset[g]-x)/y+.5;s.setUniformf(`cshift${g}`,C),s.setUniformf(`cscale${g}`,w)}const p=e.colorTexture.getTextureUnit();s.setUniformi("colorTexture1",p);for(let g=0;g<f;g++){let y=1,x=0;const m=u?g:0,v=c.getPiecewiseFunction(m);if(v){const w=v.getRange(),C=w[1]-w[0],T=.5*(w[0]+w[1]);y=h.scale[g]/C,x=(h.offset[g]-T)/C+.5}s.setUniformf(`pwfshift${g}`,x),s.setUniformf(`pwfscale${g}`,y)}const d=e.pwfTexture.getTextureUnit();s.setUniformi("pwfTexture1",d),s.setUniform4fv("backgroundColor",e.renderable.getBackgroundColor())},t.getNeedToRebuildShaders=(i,a,o)=>{const s=e.openGLTexture.getComponents(),c=o.getProperty().getIndependentComponents(),l=e.renderable.getSlabThickness(),f=e.renderable.getSlabType(),u=e.renderable.getSlabTrapezoidIntegration();let h=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(h=!0),h||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||i.getProgram()?.getHandle()===0||e.lastTextureComponents!==s||e.lastIndependentComponents!==c||e.lastSlabThickness!==l||e.lastSlabType!==f||e.lastSlabTrapezoidIntegration!==u?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=s,e.lastIndependentComponents=c,e.lastSlabThickness=l,e.lastSlabType=f,e.lastSlabTrapezoidIntegration=u,!0):!1},t.getShaderTemplate=(i,a,o)=>{i.Vertex=tM,i.Fragment=nM,i.Geometry=""},t.replaceShaderValues=(i,a,o)=>{if(t.replaceShaderTCoord(i,a,o),t.replaceShaderPositionVC(i,a,o),e.haveSeenDepthRequest){let s=i.Fragment;s=Te.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Te.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,i.Fragment=s}t.replaceShaderCoincidentOffset(i,a,o)},t.replaceShaderTCoord=(i,a,o)=>{let s=i.Vertex;const c=i.Geometry;let l=i.Fragment;const f=["uniform mat4 WCTCMatrix;","out vec3 fragTexCoord;"],u=e.renderable.getSlabThickness();s=Te.substitute(s,"//VTK::TCoord::Dec",f).result;const h=["fragTexCoord = (WCTCMatrix * vertexWC).xyz;"];s=Te.substitute(s,"//VTK::TCoord::Impl",h).result;const p=e.openGLTexture.getComponents(),d=o.getProperty().getIndependentComponents();let g=["in vec3 fragTexCoord;","uniform highp sampler3D texture1;","uniform mat4 WCTCMatrix;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;"];if(d){for(let x=1;x<p;x++)g=g.concat([`uniform float cshift${x};`,`uniform float cscale${x};`,`uniform float pwfshift${x};`,`uniform float pwfscale${x};`]);switch(p){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:Ns("Unsupported number of independent coordinates.")}}u>0&&(g=g.concat(["uniform vec3 spacing;","uniform float slabThickness;","uniform int slabType;","uniform int slabTrapezoid;","uniform vec3 vboScaling;"]),g=g.concat(["vec4 compositeValue(vec4 currVal, vec4 valToComp, int trapezoid)","{","  vec4 retVal = vec4(1.0);","  if (slabType == 0) // min","  {","    retVal = min(currVal, valToComp);","  }","  else if (slabType == 1) // max","  {","    retVal = max(currVal, valToComp);","  }","  else if (slabType == 3) // sum","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  else // mean","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  return retVal;","}"])),l=Te.substitute(l,"//VTK::TCoord::Dec",g).result;let y=["if (any(greaterThan(fragTexCoord, vec3(1.0))) || any(lessThan(fragTexCoord, vec3(0.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}","vec4 tvalue = texture(texture1, fragTexCoord);"];if(u>0&&(y=y.concat(["// Get the first and last samples","int numSlices = 1;","float scaling = min(min(spacing.x, spacing.y), spacing.z) * 0.5;","vec3 normalxspacing = scaling * normalWCVSOutput;","float distTraveled = length(normalxspacing);","int trapezoid = 0;","while (distTraveled < slabThickness * 0.5)","{","  distTraveled += length(normalxspacing);","  float fnumSlices = float(numSlices);","  if (distTraveled > slabThickness * 0.5)","  {","    // Before stepping outside the slab, sample at the boundaries","    normalxspacing = normalWCVSOutput * slabThickness * 0.5 / fnumSlices;","    trapezoid = slabTrapezoid;","  }","  vec3 fragTCoordNeg = (WCTCMatrix * vec4(vertexWCVSOutput.xyz - fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordNeg);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","  vec3 fragTCoordPos = (WCTCMatrix * vec4(vertexWCVSOutput.xyz + fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordPos);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","}","// Finally, if slab type is *mean*, divide the sum by the numSlices","if (slabType == 2)","{","  tvalue = tvalue / float(numSlices);","}"])),d){const x=["r","g","b","a"];for(let m=0;m<p;++m)y=y.concat([`vec3 tcolor${m} = mix${m} * texture2D(colorTexture1, vec2(tvalue.${x[m]} * cscale${m} + cshift${m}, height${m})).rgb;`,`float compWeight${m} = mix${m} * texture2D(pwfTexture1, vec2(tvalue.${x[m]} * pwfscale${m} + pwfshift${m}, height${m})).r;`]);switch(p){case 1:y=y.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:y=y.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:Ns("Unsupported number of independent coordinates.")}}else switch(p){case 1:y=y.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:y=y.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}l=Te.substitute(l,"//VTK::TCoord::Impl",y).result,i.Vertex=s,i.Fragment=l,i.Geometry=c},t.replaceShaderPositionVC=(i,a,o)=>{let s=i.Vertex;const c=i.Geometry;let l=i.Fragment;const f=e.renderable.getSlabThickness();let u=["attribute vec4 vertexWC;"];u=u.concat([`//${t.getMTime()}${e.resliceGeomUpdateString}`]),f>0&&(u=u.concat(["attribute vec3 normalWC;","varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),s=Te.substitute(s,"//VTK::PositionVC::Dec",u).result;let h=["gl_Position = MCPCMatrix * vertexWC;"];f>0&&(h=h.concat(["normalWCVSOutput = normalWC;","vertexWCVSOutput = vertexWC;"])),s=Te.substitute(s,"//VTK::PositionVC::Impl",h).result,s=Te.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result;let p=[];f>0&&(p=p.concat(["varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),l=Te.substitute(l,"//VTK::PositionVC::Dec",p).result,i.Vertex=s,i.Geometry=c,i.Fragment=l};function r(i){mi.normalize(i);const a=[0,0,0];for(let o=0;o<3;++o){xE(a),a[o]=1;const s=mi.dot(i,a);if(s<-.999999||s>.999999)return[!0,o]}return[!1,2]}t.updateResliceGeometry=()=>{let i="";const a=e.currentInput,o=a?.getBounds();let s=!0,c=2;const l=e.renderable.getSlicePolyData(),f=e.renderable.getSlicePlane();if(l)i=i.concat(`PolyData${l.getMTime()}`);else if(f){i=i.concat(`Plane${f.getMTime()}`);const u=e1();a&&(i=i.concat(`Image${a.getMTime()}`),v4(u,...a.getDirection()),Pl(u,u));const h=[...f.getNormal()];K0(h,h,u),[s,c]=r(h)}else{const u=hr.newInstance();u.setNormal(0,0,1);let h=[0,1,0,1,0,1];a&&(h=o),u.setOrigin(h[0],h[2],.5*(h[5]+h[4])),e.renderable.setSlicePlane(u),i=i.concat(`Plane${f?.getMTime()}`),a&&(i=i.concat(`Image${a.getMTime()}`))}if(!e.resliceGeom||e.resliceGeomUpdateString!==i){if(l)e.resliceGeom||(e.resliceGeom=Kn.newInstance()),e.resliceGeom.getPoints().setData(l.getPoints().getData(),3),e.resliceGeom.getPolys().setData(l.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(l.getPointData().getNormals());else if(f)if(s){const u=new Float32Array(12),h=a.worldToIndex(f.getOrigin(),[0,0,0]),p=[(c+1)%3,(c+2)%3].sort(),d=a.getSpatialExtent();let g=0;for(let w=0;w<2;++w)for(let C=0;C<2;++C)u[g+c]=h[c],u[g+p[0]]=d[2*p[0]+C],u[g+p[1]]=d[2*p[1]+w],g+=3;e.transform.setMatrix(a.getIndexToWorld()),e.transform.transformPoints(u,u);const y=new Uint16Array(8);y[0]=3,y[1]=0,y[2]=1,y[3]=3,y[4]=3,y[5]=0,y[6]=3,y[7]=2;const x=f.getNormal();mi.normalize(x);const m=new Float32Array(12);for(let w=0;w<4;++w)m[3*w]=x[0],m[3*w+1]=x[1],m[3*w+2]=x[2];e.resliceGeom||(e.resliceGeom=Kn.newInstance()),e.resliceGeom.getPoints().setData(u,3),e.resliceGeom.getPolys().setData(y,1);const v=ft.newInstance({numberOfComponents:3,values:m,name:"Normals"});e.resliceGeom.getPointData().setNormals(v)}else{e.outlineFilter.setInputData(a),e.cutter.setInputConnection(e.outlineFilter.getOutputPort()),e.cutter.setCutFunction(f),e.lineToSurfaceFilter.setInputConnection(e.cutter.getOutputPort()),e.lineToSurfaceFilter.update(),e.resliceGeom||(e.resliceGeom=Kn.newInstance());const u=e.lineToSurfaceFilter.getOutputData();e.resliceGeom.getPoints().setData(u.getPoints().getData(),3),e.resliceGeom.getPolys().setData(u.getPolys().getData(),1),e.resliceGeom.getPointData().setNormals(u.getPointData().getNormals());const h=f.getNormal(),p=e.resliceGeom.getNumberOfPoints();mi.normalize(h);const d=new Float32Array(p*3);for(let y=0;y<p;++y)d[3*y]=h[0],d[3*y+1]=h[1],d[3*y+2]=h[2];const g=ft.newInstance({numberOfComponents:3,values:d,name:"Normals"});e.resliceGeom.getPointData().setNormals(g)}else Ns("Something went wrong.","A default slice plane should have been created in the beginning of","updateResliceGeometry.");e.resliceGeomUpdateString=i,e.resliceGeom?.modified()}},t.setOpenGLTexture=i=>{i&&(e.openGLTexture=i,e._externalOpenGLTexture=!0)},t.delete=Ll(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const mM={VBOBuildTime:{},VBOBuildString:null,haveSeenDepthRequest:!1,lastHaveSeenDepthRequest:!1,lastIndependentComponents:!1,lastTextureComponents:0,lastSlabThickness:0,lastSlabTrapezoidIntegration:0,lastSlabType:-1,openGLTexture:null,colorTextureString:null,pwfTextureString:null,resliceGeom:null,resliceGeomUpdateString:null,tris:null,colorTexture:null,pwfTexture:null,_externalOpenGLTexture:!1};function vM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mM,n),en.extend(t,e,n),ya.implementReplaceShaderCoincidentOffset(t,e,n),ya.implementBuildShadersWithReplacements(t,e,n),e.tris=Ca.newInstance(),e.openGLTexture=null,e.colorTexture=null,e.pwfTexture=null,e.VBOBuildTime={},an(e.VBOBuildTime),e.tmpMat4=ut(new Float64Array(16)),e.outlineFilter=GR.newInstance(),e.outlineFilter.setGenerateFaces(!0),e.outlineFilter.setGenerateLines(!1),e.cubePolyData=Kn.newInstance(),e.cutter=rR.newInstance(),e.lineToSurfaceFilter=ZO.newInstance(),e.transform=eM.newInstance(),mr(t,e,["openGLTexture"]),gM(t,e)}const yM=kt(vM,"vtkOpenGLImageResliceMapper");An("vtkImageResliceMapper",yM);const xM={NONE:-1,I:0,J:1,K:2,X:3,Y:4,Z:5};var Mh={SlicingMode:xM},N1=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,Ul=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// label outline
//VTK::LabelOutline::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

//VTK::LabelOutlineHelperFunction

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;const{vtkErrorMacro:mc}=sr,{SlicingMode:Jr}=Mh;function wM(t){const e=t.split(`
`),n=[];for(let r=0;r<e.length;++r){const i=e[r].trim();i.length>0&&n.push(i)}return n}function CM(t,e){e.classHierarchy.push("vtkOpenGLImageMapper");function n(r){e.openGLTexture.releaseGraphicsResources(r),[e._colorTransferFunc,e._pwFunc,e._labelOutlineThicknessArray].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow);const a=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(a.getActiveCamera()),e.renderable.isA("vtkImageMapper")&&e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()==ji.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=N1,r.Fragment=Ul,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Te.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Te.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result,o=Te.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result,o=Te.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result;const c=e.openGLTexture.getComponents(),l=a.getProperty().getIndependentComponents();let f=["varying vec2 tcoordVCVSOutput;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D texture1;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform sampler2D labelOutlineTexture1;","uniform float opacity;","uniform float outlineOpacity;"];if(l){for(let h=1;h<c;h++)f=f.concat([`uniform float cshift${h};`,`uniform float cscale${h};`,`uniform float pwfshift${h};`,`uniform float pwfscale${h};`]);switch(c){case 1:f=f.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:f=f.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:f=f.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:mc("Unsupported number of independent coordinates.")}}if(s=Te.substitute(s,"//VTK::TCoord::Dec",f).result,a.getProperty().getUseLabelOutline()===!0&&(s=Te.substitute(s,"//VTK::LabelOutline::Dec",["uniform int outlineThickness;","uniform float vpWidth;","uniform float vpHeight;","uniform float vpOffsetX;","uniform float vpOffsetY;","uniform mat4 PCWCMatrix;","uniform mat4 vWCtoIDX;","uniform ivec3 imageDimensions;","uniform int sliceAxis;"]).result,s=Te.substitute(s,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result,s=Te.substitute(s,"//VTK::LabelOutlineHelperFunction",["#ifdef vtkImageLabelOutlineOn","vec3 fragCoordToIndexSpace(vec4 fragCoord) {","  vec4 pcPos = vec4(","    (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,","    (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,","    (fragCoord.z - 0.5) * 2.0,","    1.0);","","  vec4 worldCoord = PCWCMatrix * pcPos;","  vec4 vertex = (worldCoord/worldCoord.w);","","  vec3 index = (vWCtoIDX * vertex).xyz;","","  // half voxel fix for labelmapOutline","  return (index + vec3(0.5)) / vec3(imageDimensions);","}","vec2 getSliceCoords(vec3 coord, int axis) {","  if (axis == 0) return coord.yz;","  if (axis == 1) return coord.xz;","  if (axis == 2) return coord.xy;","}","#endif"]).result),l){const h=["r","g","b","a"];let p=["vec4 tvalue = texture2D(texture1, tcoordVCVSOutput);"];for(let d=0;d<c;d++)p=p.concat([`vec3 tcolor${d} = mix${d} * texture2D(colorTexture1, vec2(tvalue.${h[d]} * cscale${d} + cshift${d}, height${d})).rgb;`,`float compWeight${d} = mix${d} * texture2D(pwfTexture1, vec2(tvalue.${h[d]} * pwfscale${d} + pwfshift${d}, height${d})).r;`]);switch(c){case 1:p=p.concat(["gl_FragData[0] = vec4(tcolor0.rgb, opacity);"]);break;case 2:p=p.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:p=p.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:p=p.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:mc("Unsupported number of independent coordinates.")}s=Te.substitute(s,"//VTK::TCoord::Impl",p).result}else switch(c){case 1:s=Te.substitute(s,"//VTK::TCoord::Impl",[...wM(`
                #ifdef vtkImageLabelOutlineOn
                  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord);
                  float centerValue = texture2D(texture1, getSliceCoords(centerPosIS, sliceAxis)).r;
                  bool pixelOnBorder = false;
                  vec3 tColor = texture2D(colorTexture1, vec2(centerValue * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(centerValue * pwfscale0 + pwfshift0, 0.5)).r;
                  float opacityToUse = scalarOpacity * opacity;
                  int segmentIndex = int(centerValue * 255.0);
                  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
                  float textureValue = texture2D(labelOutlineTexture1, vec2(textureCoordinate, 0.5)).r;
                  int actualThickness = int(textureValue * 255.0);

                  if (segmentIndex == 0){
                    gl_FragData[0] = vec4(0.0, 0.0, 0.0, 0.0);
                    return;
                  }

                  for (int i = -actualThickness; i <= actualThickness; i++) {
                    for (int j = -actualThickness; j <= actualThickness; j++) {
                      if (i == 0 || j == 0) {
                        continue;
                      }
                      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
                        gl_FragCoord.y + float(j),
                        gl_FragCoord.z, gl_FragCoord.w);
                      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
                      float value = texture2D(texture1, getSliceCoords(neighborPosIS, sliceAxis)).r;
                      if (value != centerValue) {
                        pixelOnBorder = true;
                        break;
                      }
                    }
                    if (pixelOnBorder == true) {
                      break;
                    }
                  }
                  if (pixelOnBorder == true) {
                    gl_FragData[0] = vec4(tColor, outlineOpacity);
                  }
                  else {
                    gl_FragData[0] = vec4(tColor, opacityToUse);
                  }
                #else
                  float intensity = texture2D(texture1, tcoordVCVSOutput).r;
                  vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;
                  float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;
                  gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);
                #endif
                `)]).result;break;case 2:s=Te.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","float intensity = tcolor.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tcolor.g + pwfshift0);"]).result;break;case 3:s=Te.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]).result;break;default:s=Te.substitute(s,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"]).result}e.haveSeenDepthRequest&&(s=Te.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Te.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let c=e.renderable.getNumberOfClippingPlanes();c>6&&(At("OpenGL has a limit of 6 clipping planes"),c=6),o=Te.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=Te.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Te.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=Te.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.openGLTexture.getComponents(),s=a.getProperty().getIndependentComponents();let c=!1;return(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(c=!0),c||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getProgram()?.getHandle()===0||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.updateShaders=(r,i,a)=>{if(e.lastBoundBO=r,t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||mc("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),e.context.FALSE)||mc("Error setting tcoordMC in shader VAO.")),r.getAttributeUpdateTime().modified());const o=e.openGLTexture.getTextureUnit();r.getProgram().setUniformi("texture1",o);const s=e.openGLTexture.getComponents(),c=a.getProperty().getIndependentComponents();if(c)for(let d=0;d<s;d++)r.getProgram().setUniformf(`mix${d}`,a.getProperty().getComponentWeight(d));const l=e.openGLTexture.getShiftAndScale();for(let d=0;d<s;d++){let g=a.getProperty().getColorWindow(),y=a.getProperty().getColorLevel();const x=c?d:0,m=a.getProperty().getRGBTransferFunction(x);if(m&&a.getProperty().getUseLookupTableScalarRange()){const C=m.getRange();g=C[1]-C[0],y=.5*(C[1]+C[0])}const v=l.scale/g,w=(l.shift-y)/g+.5;r.getProgram().setUniformf(`cshift${d}`,w),r.getProgram().setUniformf(`cscale${d}`,v)}for(let d=0;d<s;d++){let g=1,y=0;const x=c?d:0,m=a.getProperty().getPiecewiseFunction(x);if(m){const v=m.getRange(),w=v[1]-v[0],C=.5*(v[0]+v[1]);g=l.scale/w,y=(l.shift-C)/w+.5}r.getProgram().setUniformf(`pwfshift${d}`,y),r.getProgram().setUniformf(`pwfscale${d}`,g)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const d=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",d.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",d.factor)}const f=e.colorTexture.getTextureUnit();r.getProgram().setUniformi("colorTexture1",f);const u=e.pwfTexture.getTextureUnit();r.getProgram().setUniformi("pwfTexture1",u);const h=e.labelOutlineThicknessTexture.getTextureUnit();if(r.getProgram().setUniformi("labelOutlineTexture1",h),e.renderable.getNumberOfClippingPlanes()){let d=e.renderable.getNumberOfClippingPlanes();d>6&&(At("OpenGL has a limit of 6 clipping planes"),d=6);const y=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,x=y?pn(e.imagematinv,a.getMatrix()):a.getMatrix();y&&(Rt(x,x),It(x,x,y),Rt(x,x)),Rt(e.imagemat,e.currentInput.getIndexToWorld()),It(e.imagematinv,x,e.imagemat);const m=[];for(let v=0;v<d;v++){const w=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,v,w);for(let C=0;C<4;C++)m.push(w[C])}r.getProgram().setUniformi("numClipPlanes",d),r.getProgram().setUniform4fv("clipPlanes",m)}if(a.getProperty().getUseLabelOutline()===!0){const d=a.getProperty().getLabelOutlineOpacity();r.getProgram().setUniformf("outlineOpacity",d)}},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLImageSlice.getKeyMatrices(),c=e.currentInput,l=c.getIndexToWorld();It(e.imagemat,s.mcwc,l);const f=e.openGLCamera.getKeyMatrices(i);if(It(e.imagemat,f.wcpc,e.imagemat),r.getCABO().getCoordShiftAndScaleEnabled()){const h=r.getCABO().getInverseShiftAndScaleMatrix();It(e.imagemat,e.imagemat,h)}if(o.setUniformMatrix("MCPCMatrix",e.imagemat),a.getProperty().getUseLabelOutline()===!0){const h=c.getWorldToIndex(),p=c.getDimensions();let d=e.renderable.getClosestIJKAxis().ijkMode;d===Jr.NONE&&(d=Jr.K),o.setUniform3i("imageDimensions",p[0],p[1],p[2]),o.setUniformi("sliceAxis",d),o.setUniformMatrix("vWCtoIDX",h);const g=e.openGLCamera.getKeyMatrices(i);Sn(e.projectionToWorld,g.wcpc),e.openGLCamera.getKeyMatrices(i),o.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const y=t.getRenderTargetSize();o.setUniformf("vpWidth",y[0]),o.setUniformf("vpHeight",y[1]);const x=t.getRenderTargetOffset();o.setUniformf("vpOffsetX",x[0]/y[0]),o.setUniformf("vpOffsetY",x[1]/y[1])}},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),c=a.getProperty().getOpacity();o.setUniformf("opacity",c)},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=e.context;e.openGLTexture.activate(),e.colorTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.openGLTexture.deactivate(),e.colorTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.renderPiece=(r,i)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getCurrentImage(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){mc("No input!");return}t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){tu(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<i.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<i.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.openGLTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()||!e.pwfTexture?.getHandle(),t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(!a)return;const o=a.getPointData()&&a.getPointData().getScalars();if(!o)return;const s=o.getDataType(),c=o.getNumberOfComponents(),l=i.getProperty(),f=l.getInterpolationType(),u=l.getIndependentComponents(),h=u?c:1,p=u?2*h:1,d=l.getRGBTransferFunction(),g=xa(d,u,h),y=e._openGLRenderWindow.getGraphicsResourceForObject(d);if(!y?.oglObject?.getHandle()||y?.hash!==g){e.colorTexture=fn.newInstance({resizable:!0}),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const R=1024,F=R*p*3,M=new Uint8ClampedArray(F);if(f===tc.NEAREST?(e.colorTexture.setMinificationFilter(lt.NEAREST),e.colorTexture.setMagnificationFilter(lt.NEAREST)):(e.colorTexture.setMinificationFilter(lt.LINEAR),e.colorTexture.setMagnificationFilter(lt.LINEAR)),d){const U=new Float32Array(R*3);for(let z=0;z<h;z++){const Y=l.getRGBTransferFunction(z),W=Y.getRange();if(Y.getTable(W[0],W[1],R,U,1),u)for(let B=0;B<R*3;B++)M[z*R*6+B]=255*U[B],M[z*R*6+B+R*3]=255*U[B];else for(let B=0;B<R*3;B++)M[z*R*6+B]=255*U[B]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(R,p,3,Ot.UNSIGNED_CHAR,M)}else{for(let U=0;U<R*3;++U)M[U]=255*U/((R-1)*3),M[U+1]=255*U/((R-1)*3),M[U+2]=255*U/((R-1)*3);e.colorTexture.create2DFromRaw(R,1,3,Ot.UNSIGNED_CHAR,M)}d&&(e._openGLRenderWindow.setGraphicsResourceForObject(d,e.colorTexture,g),d!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(d,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=d)}else e.colorTexture=y.oglObject;const m=l.getPiecewiseFunction(),v=xa(m,u,h),w=e._openGLRenderWindow.getGraphicsResourceForObject(m);if(!w?.oglObject?.getHandle()||w?.hash!==v){const F=1024*p,M=new Uint8ClampedArray(F);if(e.pwfTexture=fn.newInstance({resizable:!0}),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),f===tc.NEAREST?(e.pwfTexture.setMinificationFilter(lt.NEAREST),e.pwfTexture.setMagnificationFilter(lt.NEAREST)):(e.pwfTexture.setMinificationFilter(lt.LINEAR),e.pwfTexture.setMagnificationFilter(lt.LINEAR)),m){const U=new Float32Array(F),z=new Float32Array(1024);for(let Y=0;Y<h;++Y){const W=l.getPiecewiseFunction(Y);if(W===null)U.fill(1);else{const B=W.getRange();if(W.getTable(B[0],B[1],1024,z,1),u)for(let j=0;j<1024;j++)U[Y*1024*2+j]=z[j],U[Y*1024*2+j+1024]=z[j];else for(let j=0;j<1024;j++)U[Y*1024*2+j]=z[j]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,p,1,Ot.FLOAT,U)}else M.fill(255),e.pwfTexture.create2DFromRaw(1024,1,1,Ot.UNSIGNED_CHAR,M);m&&(e._openGLRenderWindow.setGraphicsResourceForObject(m,e.pwfTexture,v),m!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(m,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=m)}else e.pwfTexture=w.oglObject;t.updatelabelOutlineThicknessTexture(i);const{ijkMode:T}=e.renderable.getClosestIJKAxis();let _=e.renderable.getSlice();T!==e.renderable.getSlicingMode()&&(_=e.renderable.getSliceAtPosition(_));const S=e.renderable.isA("vtkImageArrayMapper")?e.renderable.getSubSlice():Math.round(_),b=a.getExtent();let D;T===Jr.I&&(D=S-b[0]),T===Jr.J&&(D=S-b[2]),(T===Jr.K||T===Jr.NONE)&&(D=S-b[4]);const E=`${_}A${a.getMTime()}A${o.getMTime()}B${t.getMTime()}C${e.renderable.getSlicingMode()}D${i.getProperty().getInterpolationType()}`;if(e.VBOBuildString!==E){const R=a.getDimensions();e.openGLTexture||(e.openGLTexture=fn.newInstance({resizable:!0})),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),f===tc.NEAREST?(new Set([1,3,4]).has(c)&&s===Ot.UNSIGNED_CHAR&&!u&&e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(lt.NEAREST),e.openGLTexture.setMagnificationFilter(lt.NEAREST)):(c===4&&s===Ot.UNSIGNED_CHAR&&!u?(e.openGLTexture.setGenerateMipmap(!0),e.openGLTexture.setMinificationFilter(lt.LINEAR_MIPMAP_LINEAR)):e.openGLTexture.setMinificationFilter(lt.LINEAR),e.openGLTexture.setMagnificationFilter(lt.LINEAR)),e.openGLTexture.setWrapS(gl.CLAMP_TO_EDGE),e.openGLTexture.setWrapT(gl.CLAMP_TO_EDGE);const F=R[0]*R[1]*c,M=new Float32Array(12),U=new Float32Array(8);for(let ge=0;ge<4;ge++)U[ge*2]=ge%2?1:0,U[ge*2+1]=ge>1?1:0;const z=[Jr.X,Jr.Y,Jr.Z].includes(e.renderable.getSlicingMode())?_:S,Y=a.getSpatialExtent(),W=o.getData();let B=null;if(T===Jr.I){B=new W.constructor(R[2]*R[1]*c);let ge=0;for(let be=0;be<R[2];be++)for(let Re=0;Re<R[1];Re++){let Ne=(D+Re*R[0]+be*R[0]*R[1])*c;ge=(be*R[1]+Re)*c;const Ce=Ne+c;for(;Ne<Ce;)B[ge++]=W[Ne++]}R[0]=R[1],R[1]=R[2],M[0]=z,M[1]=Y[2],M[2]=Y[4],M[3]=z,M[4]=Y[3],M[5]=Y[4],M[6]=z,M[7]=Y[2],M[8]=Y[5],M[9]=z,M[10]=Y[3],M[11]=Y[5]}else if(T===Jr.J){B=new W.constructor(R[2]*R[0]*c);let ge=0;for(let be=0;be<R[2];be++)for(let Re=0;Re<R[0];Re++){let Ne=(Re+D*R[0]+be*R[0]*R[1])*c;ge=(be*R[0]+Re)*c;const Ce=Ne+c;for(;Ne<Ce;)B[ge++]=W[Ne++]}R[1]=R[2],M[0]=Y[0],M[1]=z,M[2]=Y[4],M[3]=Y[1],M[4]=z,M[5]=Y[4],M[6]=Y[0],M[7]=z,M[8]=Y[5],M[9]=Y[1],M[10]=z,M[11]=Y[5]}else T===Jr.K||T===Jr.NONE?(B=W.subarray(D*F,(D+1)*F),M[0]=Y[0],M[1]=Y[2],M[2]=z,M[3]=Y[1],M[4]=Y[2],M[5]=z,M[6]=Y[0],M[7]=Y[3],M[8]=z,M[9]=Y[1],M[10]=Y[3],M[11]=z):mc("Reformat slicing not yet supported.");const j=o.getRanges();e.openGLTexture.resetFormatAndType(),e.openGLTexture.create2DFilterableFromRaw(R[0],R[1],c,o.getDataType(),B,e.renderable.getPreferSizeOverAccuracy?.(),j),e.openGLTexture.activate(),e.openGLTexture.sendParameters(),e.openGLTexture.deactivate();const ie=ft.newInstance({numberOfComponents:3,values:M});ie.setName("points");const ae=ft.newInstance({numberOfComponents:2,values:U});ae.setName("tcoords");const fe=new Uint16Array(8);fe[0]=3,fe[1]=0,fe[2]=1,fe[3]=3,fe[4]=3,fe[5]=0,fe[6]=3,fe[7]=2;const Ee=ft.newInstance({numberOfComponents:1,values:fe});e.tris.getCABO().createVBO(Ee,"polys",or.SURFACE,{points:ie,tcoords:ae,cellOffset:0}),e.VBOBuildTime.modified(),e.VBOBuildString=E}},t.updatelabelOutlineThicknessTexture=r=>{const i=r.getProperty().getLabelOutlineThicknessByReference(),a=e._openGLRenderWindow.getGraphicsResourceForObject(i),o=`${i.join("-")}`;if(!a?.oglObject?.getHandle()||a?.hash!==o){const u=new Uint8Array(1024);for(let h=0;h<1024;++h){const p=typeof i[h]<"u"?i[h]:i[0];u[h]=p}e.labelOutlineThicknessTexture=fn.newInstance({resizable:!1}),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(lt.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(lt.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(1024,1,1,Ot.UNSIGNED_CHAR,u),i&&(e._openGLRenderWindow.setGraphicsResourceForObject(i,e.labelOutlineThicknessTexture,o),i!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(i,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=i)}else e.labelOutlineThicknessTexture=a.oglObject},t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:r,vsize:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.getRenderTargetOffset=()=>{const{lowerLeftU:r,lowerLeftV:i}=e._openGLRenderer.getTiledSizeAndOrigin();return[r,i]},t.delete=Ll(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const TM={VBOBuildTime:0,VBOBuildString:null,openGLTexture:null,tris:null,imagemat:null,imagematinv:null,colorTexture:null,pwfTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0};function _M(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TM,n),en.extend(t,e,n),ya.implementReplaceShaderCoincidentOffset(t,e,n),ya.implementBuildShadersWithReplacements(t,e,n),e.tris=Ca.newInstance(),e.imagemat=ut(new Float64Array(16)),e.imagematinv=ut(new Float64Array(16)),e.projectionToWorld=ut(new Float64Array(16)),e.idxToView=ut(new Float64Array(16)),e.idxNormalMatrix=wi(new Float64Array(9)),e.modelToView=ut(new Float64Array(16)),e.projectionToView=ut(new Float64Array(16)),bn(t,e,[]),e.VBOBuildTime={},an(e.VBOBuildTime),CM(t,e)}const h8=kt(_M,"vtkOpenGLImageMapper");var SM={newInstance:h8};An("vtkAbstractImageMapper",h8);const Ls={MAX:0,MIN:1,AVERAGE:2},{vtkErrorMacro:o0}=J;function bM(t,e){e.classHierarchy.push("vtkOpenGLImageCPRMapper");function n(r){[e._scalars,e._colorTransferFunc,e._pwFunc].forEach(i=>r.unregisterGraphicsResourceUser(i,t))}t.buildPass=r=>{if(r){e.currentRenderPass=null,e.openGLImageSlice=t.getFirstAncestorOfType("vtkOpenGLImageSlice"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const i=e._openGLRenderWindow;e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==e._openGLRenderWindow&&n(i),e.context=e._openGLRenderWindow.getContext(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow)}},t.opaquePass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.opaqueZBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.getCoincidentParameters=(r,i)=>e.renderable.getResolveCoincidentTopology()===ji.PolygonOffset?e.renderable.getCoincidentTopologyPolygonOffsetParameters():null,t.render=()=>{const r=e.openGLImageSlice.getRenderable(),i=e._openGLRenderer.getRenderable();t.renderPiece(i,r)},t.renderPiece=(r,i)=>{t.invokeEvent({type:"StartEvent"}),e.renderable.update(),t.invokeEvent({type:"EndEvent"}),e.renderable.preRenderCheck()&&(e.currentImageDataInput=e.renderable.getInputData(0),e.currentCenterlineInput=e.renderable.getOrientedCenterline(),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{t.updateBufferObjects(r,i)},t.renderPieceDraw=(r,i)=>{const a=e.context;e.volumeTexture.activate(),e.colorTexture.activate(),e.pwfTexture.activate(),e.tris.getCABO().getElementCount()&&(t.updateShaders(e.tris,r,i),a.drawArrays(a.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release()),e.volumeTexture.deactivate(),e.colorTexture.deactivate(),e.pwfTexture.deactivate()},t.renderPieceFinish=(r,i)=>{},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),i.getProperty().getInterpolationType()===tc.NEAREST?(e.volumeTexture.setMinificationFilter(lt.NEAREST),e.volumeTexture.setMagnificationFilter(lt.NEAREST),e.colorTexture.setMinificationFilter(lt.NEAREST),e.colorTexture.setMagnificationFilter(lt.NEAREST),e.pwfTexture.setMinificationFilter(lt.NEAREST),e.pwfTexture.setMagnificationFilter(lt.NEAREST)):(e.volumeTexture.setMinificationFilter(lt.LINEAR),e.volumeTexture.setMagnificationFilter(lt.LINEAR),e.colorTexture.setMinificationFilter(lt.LINEAR),e.colorTexture.setMagnificationFilter(lt.LINEAR),e.pwfTexture.setMinificationFilter(lt.LINEAR),e.pwfTexture.setMagnificationFilter(lt.LINEAR))},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentImageDataInput.getMTime()||a<e.currentCenterlineInput.getMTime()||!e.volumeTexture?.getHandle()},t.buildBufferObjects=(r,i)=>{const a=e.currentImageDataInput,o=e.currentCenterlineInput,s=a?.getPointData()?.getScalars();if(!s)return;const c=e._openGLRenderWindow.getGraphicsResourceForObject(s),l=R1(a,s),f=!c?.oglObject?.getHandle()||c?.hash!==l,u=e.renderable.getUpdatedExtents(),h=!!u.length;if(f){e.volumeTexture=fn.newInstance(),e.volumeTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const D=a.getDimensions();e.volumeTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.volumeTexture.resetFormatAndType(),e.volumeTexture.create3DFilterableFromDataArray(D[0],D[1],D[2],s,e.renderable.getPreferSizeOverAccuracy()),e._openGLRenderWindow.setGraphicsResourceForObject(s,e.volumeTexture,l),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s}else e.volumeTexture=c.oglObject;if(h){e.renderable.setUpdatedExtents([]);const D=a.getDimensions();e.volumeTexture.create3DFilterableFromDataArray(D[0],D[1],D[2],s,!1,u)}const p=s.getNumberOfComponents(),d=i.getProperty(),g=d.getIndependentComponents(),y=g?p:1,x=g?2*y:1,m=d.getRGBTransferFunction(),v=xa(m,g,y),w=e._openGLRenderWindow.getGraphicsResourceForObject(m);if(!w?.oglObject?.getHandle()||w?.hash!==v){const E=1024*x*3,R=new Uint8ClampedArray(E);if(e.colorTexture=fn.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow),m){const F=new Float32Array(3072);for(let M=0;M<y;M++){const U=d.getRGBTransferFunction(M),z=U.getRange();if(U.getTable(z[0],z[1],1024,F,1),g)for(let Y=0;Y<1024*3;Y++)R[M*1024*6+Y]=255*F[Y],R[M*1024*6+Y+1024*3]=255*F[Y];else for(let Y=0;Y<1024*3;Y++)R[M*1024*6+Y]=255*F[Y]}e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,x,3,Ot.UNSIGNED_CHAR,R)}else{for(let F=0;F<1024*3;++F)R[F]=255*F/(1023*3),R[F+1]=255*F/(1023*3),R[F+2]=255*F/(1023*3);e.colorTexture.resetFormatAndType(),e.colorTexture.create2DFromRaw(1024,1,3,Ot.UNSIGNED_CHAR,R)}m&&(e._openGLRenderWindow.setGraphicsResourceForObject(m,e.colorTexture,v),m!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(m,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=m)}else e.colorTexture=w.oglObject;const T=d.getPiecewiseFunction(),_=xa(T,g,y),S=e._openGLRenderWindow.getGraphicsResourceForObject(T);if(!S?.oglObject?.getHandle()||S?.hash!==_){const E=1024*x,R=new Uint8ClampedArray(E);if(e.pwfTexture=fn.newInstance(),e.pwfTexture.setOpenGLRenderWindow(e._openGLRenderWindow),T){const F=new Float32Array(E),M=new Float32Array(1024);for(let U=0;U<y;++U){const z=d.getPiecewiseFunction(U);if(z===null)F.fill(1);else{const Y=z.getRange();if(z.getTable(Y[0],Y[1],1024,M,1),g)for(let W=0;W<1024;W++)F[U*1024*2+W]=M[W],F[U*1024*2+W+1024]=M[W];else for(let W=0;W<1024;W++)F[U*1024*2+W]=M[W]}}e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,x,1,Ot.FLOAT,F)}else R.fill(255),e.pwfTexture.resetFormatAndType(),e.pwfTexture.create2DFromRaw(1024,1,1,Ot.UNSIGNED_CHAR,R);T&&(e._openGLRenderWindow.setGraphicsResourceForObject(T,e.pwfTexture,_),T!==e._pwFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(T,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._pwFunc,t)),e._pwFunc=T)}else e.pwfTexture=S.oglObject;if(e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<o.getMTime()){const D=o.getNumberOfPoints(),E=D<=1?0:D-1,R=o.getDistancesToFirstPoint(),F=e.renderable.getHeight(),M=4*E,U=new Float32Array(3*M),z=e.renderable.getWidth();for(let Ne=0,Ce=0;Ne<E;++Ne)U.set([0,F-R[Ne],0],Ce),Ce+=3,U.set([z,F-R[Ne],0],Ce),Ce+=3,U.set([z,F-R[Ne+1],0],Ce),Ce+=3,U.set([0,F-R[Ne+1],0],Ce),Ce+=3;const Y=ft.newInstance({numberOfComponents:3,values:U});Y.setName("points");const W=new Uint16Array(5*E);for(let Ne=0,Ce=0,P=0;Ne<E;++Ne)W.set([4,P+3,P+2,P+1,P],Ce),Ce+=5,P+=4;const B=ft.newInstance({numberOfComponents:1,values:W}),j=o.getPoints(),ie=new Float32Array(3*M),ae=new Array(3),fe=new Array(3);for(let Ne=0,Ce=0;Ne<E;++Ne)j.getPoint(Ne,ae),j.getPoint(Ne+1,fe),ie.set(ae,Ce),Ce+=3,ie.set(ae,Ce),Ce+=3,ie.set(fe,Ce),Ce+=3,ie.set(fe,Ce),Ce+=3;const Ee=ft.newInstance({numberOfComponents:3,values:ie,name:"centerlinePosition"}),ge=new Float32Array(M);for(let Ne=0,Ce=0;Ne<E;++Ne)ge.set([0,1,3,2],Ce),Ce+=4;const be=ft.newInstance({numberOfComponents:1,values:ge,name:"quadIndex"}),Re=[Ee,be];if(!e.renderable.getUseUniformOrientation()){const Ne=e.renderable.getOrientedCenterline().getOrientations()??[],Ce=new Float32Array(4*M),P=new Float32Array(4*M);for(let L=0;L<E;++L){const k=Ne[L],$=Ne[L+1];for(let H=0;H<4;++H){const me=4*(H+4*L);Ce.set(k,me),P.set($,me)}}const O=ft.newInstance({numberOfComponents:4,values:Ce,name:"centerlineTopOrientation"}),A=ft.newInstance({numberOfComponents:4,values:P,name:"centerlineBotOrientation"});Re.push(O,A)}e.tris.getCABO().createVBO(B,"polys",or.SURFACE,{points:Y,customAttributes:Re}),e.VBOBuildTime.modified()}},t.getNeedToRebuildShaders=(r,i,a)=>{const o=e.volumeTexture.getComponents(),s=a.getProperty().getIndependentComponents(),c=!!e.renderable.getCenterPoint(),l=e.renderable.getUseUniformOrientation(),f=e.renderable.isProjectionEnabled()&&e.renderable.getProjectionMode();return r.getProgram()===0||e.lastUseCenterPoint!==c||e.lastUseUniformOrientation!==l||e.lastProjectionMode!==f||e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||e.lastTextureComponents!==o||e.lastIndependentComponents!==s?(e.lastUseCenterPoint=c,e.lastUseUniformOrientation=l,e.lastProjectionMode=f,e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,e.lastTextureComponents=o,e.lastIndependentComponents=s,!0):!1},t.buildShaders=(r,i,a)=>{t.getShaderTemplate(r,i,a),t.replaceShaderValues(r,i,a)},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;const c=["vec3 applyQuaternionToVec(vec4 q, vec3 v) {","  float uvx = q.y * v.z - q.z * v.y;","  float uvy = q.z * v.x - q.x * v.z;","  float uvz = q.x * v.y - q.y * v.x;","  float uuvx = q.y * uvz - q.z * uvy;","  float uuvy = q.z * uvx - q.x * uvz;","  float uuvz = q.x * uvy - q.y * uvx;","  float w2 = q.w * 2.0;","  uvx *= w2;","  uvy *= w2;","  uvz *= w2;","  uuvx *= 2.0;","  uuvy *= 2.0;","  uuvz *= 2.0;","  return vec3(v.x + uvx + uuvx, v.y + uvy + uuvy, v.z + uvz + uuvz);","}"];o=Te.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Te.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result;const l=["attribute vec3 centerlinePosition;","attribute float quadIndex;","uniform float width;","out vec2 quadOffsetVSOutput;","out vec3 centerlinePosVSOutput;"],f=e.renderable.isProjectionEnabled(),u=e.renderable.getUseUniformOrientation();u?(l.push("out vec3 samplingDirVSOutput;","uniform vec4 centerlineOrientation;","uniform vec3 tangentDirection;",...c),f&&l.push("out vec3 projectionDirVSOutput;","uniform vec3 bitangentDirection;")):l.push("out vec4 centerlineTopOrientationVSOutput;","out vec4 centerlineBotOrientationVSOutput;","attribute vec4 centerlineTopOrientation;","attribute vec4 centerlineBotOrientation;"),o=Te.substitute(o,"//VTK::Color::Dec",l).result;const h=["quadOffsetVSOutput = vec2(width * (mod(quadIndex, 2.0) == 0.0 ? -0.5 : 0.5), quadIndex > 1.0 ? 0.0 : 1.0);","centerlinePosVSOutput = centerlinePosition;"];u?(h.push("samplingDirVSOutput = applyQuaternionToVec(centerlineOrientation, tangentDirection);"),f&&h.push("projectionDirVSOutput = applyQuaternionToVec(centerlineOrientation, bitangentDirection);")):h.push("centerlineTopOrientationVSOutput = centerlineTopOrientation;","centerlineBotOrientationVSOutput = centerlineBotOrientation;"),o=Te.substitute(o,"//VTK::Color::Impl",h).result;const p=e.volumeTexture.getComponents(),d=a.getProperty().getIndependentComponents();let g=["uniform mat4 MCTCMatrix; // Model coordinates to texture coordinates","in vec2 quadOffsetVSOutput;","in vec3 centerlinePosVSOutput;","uniform highp sampler3D volumeTexture;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;"];f&&g.push("uniform vec3 volumeSizeMC;","uniform int projectionSlabNumberOfSamples;","uniform float projectionConstantOffset;","uniform float projectionStepLength;"),u?(g.push("in vec3 samplingDirVSOutput;"),f&&g.push("in vec3 projectionDirVSOutput;")):(g.push("uniform vec3 tangentDirection;","in vec4 centerlineTopOrientationVSOutput;","in vec4 centerlineBotOrientationVSOutput;",...c),f&&g.push("uniform vec3 bitangentDirection;"));const y=e.renderable.getCenterPoint();if(y&&g.push("uniform vec3 globalCenterPoint;"),d){for(let m=1;m<p;m++)g=g.concat([`uniform float cshift${m};`,`uniform float cscale${m};`,`uniform float pwfshift${m};`,`uniform float pwfscale${m};`]);switch(p){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:o0("Unsupported number of independent coordinates.")}}s=Te.substitute(s,"//VTK::TCoord::Dec",g).result;let x=[];if(u?(x.push("vec3 samplingDirection = samplingDirVSOutput;"),f&&x.push("vec3 projectionDirection = projectionDirVSOutput;")):(x.push("vec4 q0 = centerlineBotOrientationVSOutput;","vec4 q1 = centerlineTopOrientationVSOutput;","float qCosAngle = dot(q0, q1);","vec4 interpolatedOrientation;","if (qCosAngle > 0.999 || qCosAngle < -0.999) {","  // Use LERP instead of SLERP when the two quaternions are close or opposite","  interpolatedOrientation = normalize(mix(q0, q1, quadOffsetVSOutput.y));","} else {","  float omega = acos(qCosAngle);","  interpolatedOrientation = normalize(sin((1.0 - quadOffsetVSOutput.y) * omega) * q0 + sin(quadOffsetVSOutput.y * omega) * q1);","}","vec3 samplingDirection = applyQuaternionToVec(interpolatedOrientation, tangentDirection);"),f&&x.push("vec3 projectionDirection = applyQuaternionToVec(interpolatedOrientation, bitangentDirection);")),y?x.push("float baseOffset = dot(samplingDirection, globalCenterPoint - centerlinePosVSOutput);","float horizontalOffset = quadOffsetVSOutput.x + baseOffset;"):x.push("float horizontalOffset = quadOffsetVSOutput.x;"),x.push("vec3 volumePosMC = centerlinePosVSOutput + horizontalOffset * samplingDirection;","vec3 volumePosTC = (MCTCMatrix * vec4(volumePosMC, 1.0)).xyz;","if (any(lessThan(volumePosTC, vec3(0.0))) || any(greaterThan(volumePosTC, vec3(1.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}"),f){const m=e.renderable.getProjectionMode();switch(m){case Ls.MIN:x.push("const vec4 initialProjectionTextureValue = vec4(1.0);");break;case Ls.MAX:case Ls.AVERAGE:default:x.push("const vec4 initialProjectionTextureValue = vec4(0.0);");break}switch(x.push("vec3 projectionScaledDirection = projectionDirection / volumeSizeMC;","vec3 projectionStep = projectionStepLength * projectionScaledDirection;","vec3 projectionStartPosition = volumePosTC + projectionConstantOffset * projectionScaledDirection;","vec4 tvalue = initialProjectionTextureValue;","for (int projectionSampleIdx = 0; projectionSampleIdx < projectionSlabNumberOfSamples; ++projectionSampleIdx) {","  vec3 projectionSamplePosition = projectionStartPosition + float(projectionSampleIdx) * projectionStep;","  vec4 sampledTextureValue = texture(volumeTexture, projectionSamplePosition);"),m){case Ls.MAX:x.push("  tvalue = max(tvalue, sampledTextureValue);");break;case Ls.MIN:x.push("  tvalue = min(tvalue, sampledTextureValue);");break;case Ls.AVERAGE:default:x.push("  tvalue = tvalue + sampledTextureValue;");break}x.push("}"),m===Ls.AVERAGE&&x.push("tvalue = tvalue / float(projectionSlabNumberOfSamples);")}else x.push("vec4 tvalue = texture(volumeTexture, volumePosTC);");if(d){const m=["r","g","b","a"];for(let v=0;v<p;++v)x=x.concat([`vec3 tcolor${v} = mix${v} * texture2D(colorTexture1, vec2(tvalue.${m[v]} * cscale${v} + cshift${v}, height${v})).rgb;`,`float compWeight${v} = mix${v} * texture2D(pwfTexture1, vec2(tvalue.${m[v]} * pwfscale${v} + pwfshift${v}, height${v})).r;`]);switch(p){case 1:x=x.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:x=x.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:x=x.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:x=x.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:o0("Unsupported number of independent coordinates.")}}else switch(p){case 1:x=x.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:x=x.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:x=x.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:x=x.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}s=Te.substitute(s,"//VTK::TCoord::Impl",x).result,e.haveSeenDepthRequest&&(s=Te.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=Te.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a)},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){let c=e.renderable.getNumberOfClippingPlanes();c>6&&(J.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),c=6),o=Te.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=Te.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Te.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,s=Te.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getShaderTemplate=(r,i,a)=>{r.Vertex=N1,r.Fragment=Ul,r.Geometry=""},t.setMapperShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=r.getCABO();s.getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(o.isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(o,s,"vertexMC",s.getVertexOffset(),s.getStride(),e.context.FLOAT,3,e.context.FALSE)||o0("Error setting vertexMC in shader VAO.")),r.getCABO().getCustomData().forEach(p=>{p&&o.isAttributeUsed(p.name)&&!r.getVAO().addAttributeArray(o,s,p.name,p.offset,s.getStride(),e.context.FLOAT,p.components,e.context.FALSE)&&o0(`Error setting ${p.name} in shader VAO.`)}),r.getAttributeUpdateTime().modified());const c=e.volumeTexture.getTextureUnit();if(o.setUniformi("volumeTexture",c),o.setUniformf("width",e.renderable.getWidth()),r.getProgram().setUniform4fv("backgroundColor",e.renderable.getBackgroundColor()),o.isUniformUsed("tangentDirection")){const p=e.renderable.getTangentDirection();r.getProgram().setUniform3fArray("tangentDirection",p)}if(o.isUniformUsed("bitangentDirection")){const p=e.renderable.getBitangentDirection();r.getProgram().setUniform3fArray("bitangentDirection",p)}if(o.isUniformUsed("centerlineOrientation")){const p=e.renderable.getUniformOrientation();r.getProgram().setUniform4fv("centerlineOrientation",p)}if(o.isUniformUsed("globalCenterPoint")){const p=e.renderable.getCenterPoint();o.setUniform3fArray("globalCenterPoint",p)}if(e.renderable.isProjectionEnabled()){const p=e.currentImageDataInput,d=p.getSpacing(),g=p.getDimensions(),y=e.renderable.getProjectionSlabThickness(),x=e.renderable.getProjectionSlabNumberOfSamples(),m=wE([],d,g);o.setUniform3fArray("volumeSizeMC",m),o.setUniformi("projectionSlabNumberOfSamples",x);const v=-.5*y;o.setUniformf("projectionConstantOffset",v);const w=y/(x-1);o.setUniformf("projectionStepLength",w)}const l=e.currentImageDataInput,f=l.getWorldToIndex(),u=a1(new Float32Array(16),R4([],l.getDimensions())),h=Df(u,u,f);if(o.setUniformMatrix("MCTCMatrix",h),e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),e.renderable.getNumberOfClippingPlanes()){let p=e.renderable.getNumberOfClippingPlanes();p>6&&(J.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),p=6);const g=s.getCoordShiftAndScaleEnabled()?s.getInverseShiftAndScaleMatrix():null,y=g?pn(e.imagematinv,a.getMatrix()):a.getMatrix();g&&(Rt(y,y),It(y,y,g),Rt(y,y)),Rt(e.imagemat,e.currentImageDataInput.getIndexToWorld()),It(e.imagematinv,y,e.imagemat);const x=[];for(let m=0;m<p;m++){const v=[];e.renderable.getClippingPlaneInDataCoords(e.imagematinv,m,v);for(let w=0;w<4;w++)x.push(v[w])}o.setUniformi("numClipPlanes",p),o.setUniform4fv("clipPlanes",x)}if(o.isUniformUsed("coffset")){const p=t.getCoincidentParameters(i,a);o.setUniformf("coffset",p.offset),o.isUniformUsed("cfactor")&&o.setUniformf("cfactor",p.factor)}},t.setCameraShaderParameters=(r,i,a)=>{const o=e.openGLImageSlice.getKeyMatrices().mcwc,s=e.openGLCamera.getKeyMatrices(i).wcpc;if(It(e.imagemat,s,o),r.getCABO().getCoordShiftAndScaleEnabled()){const c=r.getCABO().getInverseShiftAndScaleMatrix();It(e.imagemat,e.imagemat,c)}r.getProgram().setUniformMatrix("MCPCMatrix",e.imagemat)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=a.getProperty(),c=s.getOpacity();o.setUniformf("opacity",c);const l=e.volumeTexture.getComponents(),f=s.getIndependentComponents();if(f)for(let d=0;d<l;++d)o.setUniformf(`mix${d}`,s.getComponentWeight(d));const u=e.volumeTexture.getVolumeInfo();for(let d=0;d<l;d++){let g=s.getColorWindow(),y=s.getColorLevel();const x=f?d:0,m=s.getRGBTransferFunction(x);if(m&&s.getUseLookupTableScalarRange()){const C=m.getRange();g=C[1]-C[0],y=.5*(C[1]+C[0])}const v=u.scale[d]/g,w=(u.offset[d]-y)/g+.5;o.setUniformf(`cshift${d}`,w),o.setUniformf(`cscale${d}`,v)}const h=e.colorTexture.getTextureUnit();o.setUniformi("colorTexture1",h);for(let d=0;d<l;d++){let g=1,y=0;const x=f?d:0,m=s.getPiecewiseFunction(x);if(m){const v=m.getRange(),w=v[1]-v[0],C=.5*(v[0]+v[1]);g=u.scale[d]/w,y=(u.offset[d]-C)/w+.5}o.setUniformf(`pwfshift${d}`,y),o.setUniformf(`pwfscale${d}`,g)}const p=e.pwfTexture.getTextureUnit();o.setUniformi("pwfTexture1",p)},t.updateShaders=(r,i,a)=>{if(t.getNeedToRebuildShaders(r,i,a)){const o={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(o,i,a);const s=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);s!==r.getProgram()&&(r.setProgram(s),r.getVAO().releaseGraphicsResources()),r.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(r.getProgram());r.getVAO().bind(),t.setMapperShaderParameters(r,i,a),t.setCameraShaderParameters(r,i,a),t.setPropertyShaderParameters(r,i,a)},t.delete=J.chain(()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete)}const EM={currentRenderPass:null,volumeTexture:null,colorTexture:null,pwfTexture:null,tris:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0,lastIndependentComponents:0,imagemat:null,imagematinv:null};function DM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EM,n),en.extend(t,e,n),ya.implementReplaceShaderCoincidentOffset(t,e,n),J.algo(t,e,2,0),e.tris=Ca.newInstance(),e.volumeTexture=null,e.colorTexture=null,e.pwfTexture=null,e.imagemat=ut(new Float64Array(16)),e.imagematinv=ut(new Float64Array(16)),e.VBOBuildTime={},J.obj(e.VBOBuildTime,{mtime:0}),bM(t,e)}const p8=J.newInstance(DM,"vtkOpenGLImageCPRMapper"),OM={};var RM={newInstance:p8,...OM};An("vtkImageCPRMapper",p8);function MM(t,e){e.classHierarchy.push("vtkOpenGLImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{n&&e.context.depthMask(!0)},t.translucentPass=(n,r)=>{e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(pn(e.keyMatrices.mcwc,e.renderable.getMatrix()),Rt(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.keyMatrixTime.modified()),e.keyMatrices)}const NM={context:null,keyMatrixTime:null,keyMatrices:null};function LM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NM,n),en.extend(t,e,n),e.keyMatrixTime={},an(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:ut(new Float64Array(16))},bn(t,e,["context"]),MM(t,e)}const d8=kt(LM,"vtkOpenGLImageSlice");var AM={newInstance:d8};An("vtkImageSlice",d8);function FM(t,e){e.classHierarchy.push("vtkOpenGLVolume"),t.buildPass=n=>{!e.renderable||!e.renderable.getVisibility()||n&&(e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementVolumeCount()}},t.traverseVolumePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0].traverse(n),t.apply(n,!1))},t.volumePass=n=>{!e.renderable||!e.renderable.getVisibility()||e.context.depthMask(!n)},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),pn(e.MCWCMatrix,e.renderable.getMatrix()),Rt(e.MCWCMatrix,e.MCWCMatrix),e.renderable.getIsIdentity()?wi(e.normalMatrix):(Th(e.normalMatrix,e.MCWCMatrix),Pl(e.normalMatrix,e.normalMatrix),t1(e.normalMatrix,e.normalMatrix)),e.keyMatrixTime.modified()),{mcwc:e.MCWCMatrix,normalMatrix:e.normalMatrix})}const IM={};function PM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IM,n),en.extend(t,e,n),e.keyMatrixTime={},an(e.keyMatrixTime,{mtime:0}),e.normalMatrix=new Float64Array(9),e.MCWCMatrix=new Float64Array(16),bn(t,e,["context"]),FM(t,e)}const g8=kt(PM,"vtkOpenGLVolume");var VM={newInstance:g8};An("vtkVolume",g8);function kM(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=()=>e.context.FRAMEBUFFER,t.saveCurrentBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.saveCurrentBindings(r),t.saveCurrentBuffers(r)},t.saveCurrentBindings=n=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}const r=e.context;e.previousDrawBinding=r.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=n=>{},t.restorePreviousBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.restorePreviousBindings(r),t.restorePreviousBuffers(r)},t.restorePreviousBindings=n=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}const r=e.context;r.bindFramebuffer(r.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=n=>{},t.bind=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r===null&&(r=e.context.FRAMEBUFFER),e.context.bindFramebuffer(r,e.glFramebuffer);for(let i=0;i<e.colorBuffers.length;i++)e.colorBuffers[i].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=(n,r)=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=n,e.glFramebuffer.height=r},t.setColorBuffer=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=e.context;if(!i){At("you must set the OpenGLRenderWindow before calling setColorBuffer");return}let a=i.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{At("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[r]=n,i.framebufferTexture2D(i.FRAMEBUFFER,a,i.TEXTURE_2D,n.getHandle(),0)},t.removeColorBuffer=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=e.context;if(!r){At("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}let i=r.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{At("Using multiple framebuffer attachments requires WebGL 2");return}r.framebufferTexture2D(r.FRAMEBUFFER,i,r.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(n,1)},t.setDepthBuffer=n=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n.getHandle(),0)}else At("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=()=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,null,0)}else At("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=()=>e.glFramebuffer,t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=()=>{e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=()=>e.glFramebuffer==null?null:[e.glFramebuffer.width,e.glFramebuffer.height],t.populateFramebuffer=()=>{if(!e.context){At("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();const n=e.context,r=fn.newInstance();r.setOpenGLRenderWindow(e._openGLRenderWindow),r.setMinificationFilter(lt.LINEAR),r.setMagnificationFilter(lt.LINEAR),r.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,Ot.UNSIGNED_CHAR,null),t.setColorBuffer(r),e.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,e.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e.depthTexture)},t.getColorTexture=()=>e.colorBuffers[0]}const UM={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function m8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UM,n),an(t,e),e.colorBuffers&&At("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],eu(t,e,["colorBuffers"]),kM(t,e)}const BM=kt(m8,"vtkFramebuffer");var Nh={newInstance:BM,extend:m8},GM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexDC;

varying vec3 vertexVCVSOutput;
uniform mat4 PCVCMatrix;

uniform float dcxmin;
uniform float dcxmax;
uniform float dcymin;
uniform float dcymax;

void main()
{
  // dcsmall is the device coords reduced to the
  // x y area covered by the volume
  vec4 dcsmall = vec4(
    dcxmin + 0.5 * (vertexDC.x + 1.0) * (dcxmax - dcxmin),
    dcymin + 0.5 * (vertexDC.y + 1.0) * (dcymax - dcymin),
    vertexDC.z,
    vertexDC.w);
  vec4 vcpos = PCVCMatrix * dcsmall;
  vertexVCVSOutput = vcpos.xyz/vcpos.w;
  gl_Position = dcsmall;
}
`,WM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkVolumeFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the volume mappers fragment shader

// the output of this shader
//VTK::Output::Dec

varying vec3 vertexVCVSOutput;

// first declare the settings from the mapper
// that impact the code paths in here

// always set vtkNumComponents 1,2,3,4
//VTK::NumComponents

// possibly define vtkTrilinearOn
//VTK::TrilinearOn

// possibly define UseIndependentComponents
//VTK::IndependentComponentsOn

// possibly define vtkCustomComponentsColorMix
//VTK::CustomComponentsColorMixOn

// possibly define any "proportional" components
//VTK::vtkProportionalComponents

// possibly define any components that are forced to nearest interpolation
//VTK::vtkForceNearestComponents

// Define the blend mode to use
#define vtkBlendMode //VTK::BlendMode

// Possibly define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Possibly define vtkLabelEdgeProjectionOn
//VTK::LabelEdgeProjectionOn


#ifdef vtkImageLabelOutlineOn
  uniform float outlineOpacity;
  uniform float vpWidth;
  uniform float vpHeight;
  uniform float vpOffsetX;
  uniform float vpOffsetY;
  uniform mat4 PCWCMatrix;
  uniform mat4 vWCtoIDX;

  const int MAX_SEGMENT_INDEX = 256; // Define as per expected maximum
  // bool seenSegmentsByOriginalPos[MAX_SEGMENT_INDEX];
  #define MAX_SEGMENTS 256
  #define UINT_SIZE 32
  #define BITMASK_SIZE ((MAX_SEGMENTS + UINT_SIZE - 1) / UINT_SIZE)

  uint bitmask[BITMASK_SIZE];

  // Set the corresponding bit in the bitmask
  void setBit(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    bitmask[index] |= 1u << bitIndex;
  }

  // Check if a bit is set in the bitmask
  bool isBitSet(int segmentIndex) {
    int index = segmentIndex / UINT_SIZE;
    int bitIndex = segmentIndex % UINT_SIZE;
    return ((bitmask[index] & (1u << bitIndex)) != 0u);
  }
#endif

// define vtkLightComplexity
//VTK::LightComplexity
#if vtkLightComplexity > 0
uniform float vSpecularPower;
uniform float vAmbient;
uniform float vDiffuse;
uniform float vSpecular;
//VTK::Light::Dec
#endif

//VTK::VolumeShadowOn
//VTK::SurfaceShadowOn
//VTK::localAmbientOcclusionOn
//VTK::LAO::Dec
//VTK::VolumeShadow::Dec

// define vtkComputeNormalFromOpacity
//VTK::vtkComputeNormalFromOpacity

// possibly define vtkGradientOpacityOn
//VTK::GradientOpacityOn
#ifdef vtkGradientOpacityOn
uniform float goscale0;
uniform float goshift0;
uniform float gomin0;
uniform float gomax0;
#ifdef UseIndependentComponents
#if vtkNumComponents > 1
uniform float goscale1;
uniform float goshift1;
uniform float gomin1;
uniform float gomax1;
#if vtkNumComponents > 2
uniform float goscale2;
uniform float goshift2;
uniform float gomin2;
uniform float gomax2;
#if vtkNumComponents > 3
uniform float goscale3;
uniform float goshift3;
uniform float gomin3;
uniform float gomax3;
#endif
#endif
#endif
#endif
#endif

// if you want to see the raw tiled
// data in webgl1 uncomment the following line
// #define debugtile

// camera values
uniform float camThick;
uniform float camNear;
uniform float camFar;
uniform int cameraParallel;

// values describing the volume geometry
uniform vec3 vOriginVC;
uniform vec3 vSpacing;
uniform ivec3 volumeDimensions; // 3d texture dimensions
uniform vec3 vPlaneNormal0;
uniform float vPlaneDistance0;
uniform vec3 vPlaneNormal1;
uniform float vPlaneDistance1;
uniform vec3 vPlaneNormal2;
uniform float vPlaneDistance2;
uniform vec3 vPlaneNormal3;
uniform float vPlaneDistance3;
uniform vec3 vPlaneNormal4;
uniform float vPlaneDistance4;
uniform vec3 vPlaneNormal5;
uniform float vPlaneDistance5;

//VTK::ClipPlane::Dec

// opacity and color textures
uniform sampler2D otexture;
uniform float oshift0;
uniform float oscale0;
uniform sampler2D ctexture;
uniform float cshift0;
uniform float cscale0;

#if vtkNumComponents >= 2
uniform float oshift1;
uniform float oscale1;
uniform float cshift1;
uniform float cscale1;
#endif
#if vtkNumComponents >= 3
uniform float oshift2;
uniform float oscale2;
uniform float cshift2;
uniform float cscale2;
#endif
#if vtkNumComponents >= 4
uniform float oshift3;
uniform float oscale3;
uniform float cshift3;
uniform float cscale3;
#endif

// jitter texture
uniform sampler2D jtexture;
uniform sampler2D ttexture;


// some 3D texture values
uniform float sampleDistance;
uniform vec3 vVCToIJK;
uniform vec3 volumeSpacings; // spacing in the world coorindates


// the heights defined below are the locations
// for the up to four components of the tfuns
// the tfuns have a height of 2XnumComps pixels so the
// values are computed to hit the middle of the two rows
// for that component
#ifdef UseIndependentComponents
#if vtkNumComponents == 1
uniform float mix0;
#define height0 0.5
#endif
#if vtkNumComponents == 2
uniform float mix0;
uniform float mix1;
#define height0 0.25
#define height1 0.75
#endif
#if vtkNumComponents == 3
uniform float mix0;
uniform float mix1;
uniform float mix2;
#define height0 0.17
#define height1 0.5
#define height2 0.83
#endif
#if vtkNumComponents == 4
uniform float mix0;
uniform float mix1;
uniform float mix2;
uniform float mix3;
#define height0 0.125
#define height1 0.375
#define height2 0.625
#define height3 0.875
#endif
#endif

uniform vec4 ipScalarRangeMin;
uniform vec4 ipScalarRangeMax;

// declaration for intermixed geometry
//VTK::ZBuffer::Dec

//=======================================================================
// global and custom variables (a temporary section before photorealistics rendering module is complete)
vec3 rayDirVC;
float sampleDistanceISVS;
float sampleDistanceIS;

#define SQRT3    1.7321
#define INV4PI   0.0796
#define EPSILON  0.001
#define PI       3.1415
#define PI2      9.8696

//=======================================================================
// Webgl2 specific version of functions
#if __VERSION__ == 300

uniform highp sampler3D texture1;

vec4 getTextureValue(vec3 pos)
{
  vec4 tmp = texture(texture1, pos);

  #if defined(vtkComponent0ForceNearest) || \\
      defined(vtkComponent1ForceNearest) || \\
      defined(vtkComponent2ForceNearest) || \\
      defined(vtkComponent3ForceNearest)
    vec3 nearestPos = (floor(pos * vec3(volumeDimensions)) + 0.5) / vec3(volumeDimensions);
    vec4 nearestValue = texture(texture1, nearestPos);
    #ifdef vtkComponent0ForceNearest
      tmp[0] = nearestValue[0];
    #endif
    #ifdef vtkComponent1ForceNearest
      tmp[1] = nearestValue[1];
    #endif
    #ifdef vtkComponent2ForceNearest
      tmp[2] = nearestValue[2];
    #endif
    #ifdef vtkComponent3ForceNearest
      tmp[3] = nearestValue[3];
    #endif
  #endif

  #ifndef UseIndependentComponents
    #if vtkNumComponents == 1
      tmp.a = tmp.r;
    #endif
    #if vtkNumComponents == 2
      tmp.a = tmp.g;
    #endif
    #if vtkNumComponents == 3
      tmp.a = length(tmp.rgb);
    #endif
  #endif

  return tmp;
}

//=======================================================================
// WebGL1 specific version of functions
#else

uniform sampler2D texture1;

uniform float texWidth;
uniform float texHeight;
uniform int xreps;
uniform int xstride;
uniform int ystride;

// if computing trilinear values from multiple z slices
#ifdef vtkTrilinearOn
vec4 getTextureValue(vec3 ijk)
{
  float zoff = 1.0/float(volumeDimensions.z);
  vec4 val1 = getOneTextureValue(ijk);
  vec4 val2 = getOneTextureValue(vec3(ijk.xy, ijk.z + zoff));

  float indexZ = float(volumeDimensions)*ijk.z;
  float zmix =  indexZ - floor(indexZ);

  return mix(val1, val2, zmix);
}

vec4 getOneTextureValue(vec3 ijk)
#else // nearest or fast linear
vec4 getTextureValue(vec3 ijk)
#endif
{
  vec3 tdims = vec3(volumeDimensions);

#ifdef debugtile
  vec2 tpos = vec2(ijk.x, ijk.y);
  vec4 tmp = texture2D(texture1, tpos);
  tmp.a = 1.0;

#else
  int z = int(ijk.z * tdims.z);
  int yz = z / xreps;
  int xz = z - yz*xreps;

  int tileWidth = volumeDimensions.x/xstride;
  int tileHeight = volumeDimensions.y/ystride;

  xz *= tileWidth;
  yz *= tileHeight;

  float ni = float(xz) + (ijk.x*float(tileWidth));
  float nj = float(yz) + (ijk.y*float(tileHeight));

  vec2 tpos = vec2(ni/texWidth, nj/texHeight);

  vec4 tmp = texture2D(texture1, tpos);

#if vtkNumComponents == 1
  tmp.a = tmp.r;
#endif
#if vtkNumComponents == 2
  tmp.g = tmp.a;
#endif
#if vtkNumComponents == 3
  tmp.a = length(tmp.rgb);
#endif
#endif

  return tmp;
}

// End of Webgl1 specific code
//=======================================================================
#endif

//=======================================================================
// transformation between VC and IS space

// convert vector position from idx to vc
#if (vtkLightComplexity > 0) || (defined vtkClippingPlanesOn)
vec3 IStoVC(vec3 posIS){
  vec3 posVC = posIS / vVCToIJK;
  return posVC.x * vPlaneNormal0 +
         posVC.y * vPlaneNormal2 +
         posVC.z * vPlaneNormal4 +
         vOriginVC;
}

// convert vector position from vc to idx
vec3 VCtoIS(vec3 posVC){
  posVC = posVC - vOriginVC;
  posVC = vec3(
    dot(posVC, vPlaneNormal0),
    dot(posVC, vPlaneNormal2),
    dot(posVC, vPlaneNormal4));
  return posVC * vVCToIJK;
}
#endif

//Rotate vector to view coordinate
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
void rotateToViewCoord(inout vec3 dirIS){
  dirIS.xyz =
    dirIS.x * vPlaneNormal0 +
    dirIS.y * vPlaneNormal2 +
    dirIS.z * vPlaneNormal4;
}

//Rotate vector to idx coordinate
vec3 rotateToIDX(vec3 dirVC){
  vec3 dirIS;
  dirIS.xyz = vec3(
    dot(dirVC, vPlaneNormal0),
    dot(dirVC, vPlaneNormal2),
    dot(dirVC, vPlaneNormal4));
  return dirIS;
}
#endif

//=======================================================================
// Given a normal compute the gradient opacity factors
float computeGradientOpacityFactor(
  float normalMag, float goscale, float goshift, float gomin, float gomax)
{
  return clamp(normalMag * goscale + goshift, gomin, gomax);
}

//=======================================================================
// compute the normal and gradient magnitude for a position, uses forward difference
#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)
  #ifdef vtkClippingPlanesOn
    void adjustClippedVoxelValues(vec3 pos, vec3 texPos[3], inout vec3 g1)
    {
      vec3 g1VC[3];
      for (int i = 0; i < 3; ++i)
      {
        g1VC[i] = IStoVC(texPos[i]);
      }
      vec3 posVC = IStoVC(pos);
      for (int i = 0; i < clip_numPlanes; ++i)
      {
        for (int j = 0; j < 3; ++j)
        {
          if(dot(vec3(vClipPlaneOrigins[i] - g1VC[j].xyz), vClipPlaneNormals[i]) > 0.0)
          {
            g1[j] = 0.0;
          }
        }
      }
    }
  #endif

  #ifdef vtkComputeNormalFromOpacity
    vec4 computeDensityNormal(vec3 opacityUCoords[2], float opactityTextureHeight, float gradientOpacity) {
      vec3 opacityG1, opacityG2;
      opacityG1.x = texture2D(otexture, vec2(opacityUCoords[0].x, opactityTextureHeight)).r;
      opacityG1.y = texture2D(otexture, vec2(opacityUCoords[0].y, opactityTextureHeight)).r;
      opacityG1.z = texture2D(otexture, vec2(opacityUCoords[0].z, opactityTextureHeight)).r;
      opacityG2.x = texture2D(otexture, vec2(opacityUCoords[1].x, opactityTextureHeight)).r;
      opacityG2.y = texture2D(otexture, vec2(opacityUCoords[1].y, opactityTextureHeight)).r;
      opacityG2.z = texture2D(otexture, vec2(opacityUCoords[1].z, opactityTextureHeight)).r;
      opacityG1.xyz *= gradientOpacity;
      opacityG2.xyz *= gradientOpacity;

      vec4 opacityG = vec4(opacityG1 - opacityG2, 1.0f);
      // divide by spacing
      opacityG.xyz /= vSpacing;
      opacityG.w = length(opacityG.xyz);
      // rotate to View Coords
      rotateToViewCoord(opacityG.xyz);
      if (!all(equal(opacityG.xyz, vec3(0.0)))) {
        return vec4(normalize(opacityG.xyz),opacityG.w);
      } else {
        return vec4(0.0);
      }
    }

    vec4 computeNormalForDensity(vec3 pos, vec3 tstep, out vec3 scalarInterp[2], const int opacityComponent)
    {
      vec3 xvec = vec3(tstep.x, 0.0, 0.0);
      vec3 yvec = vec3(0.0, tstep.y, 0.0);
      vec3 zvec = vec3(0.0, 0.0, tstep.z);
      vec3 texPosPVec[3];
      texPosPVec[0] = pos + xvec;
      texPosPVec[1] = pos + yvec;
      texPosPVec[2] = pos + zvec;
      vec3 texPosNVec[3];
      texPosNVec[0] = pos - xvec;
      texPosNVec[1] = pos - yvec;
      texPosNVec[2] = pos - zvec;
      vec3 g1, g2;

      scalarInterp[0].x = getTextureValue(texPosPVec[0])[opacityComponent];
      scalarInterp[0].y = getTextureValue(texPosPVec[1])[opacityComponent];
      scalarInterp[0].z = getTextureValue(texPosPVec[2])[opacityComponent];
      scalarInterp[1].x = getTextureValue(texPosNVec[0])[opacityComponent];
      scalarInterp[1].y = getTextureValue(texPosNVec[1])[opacityComponent];
      scalarInterp[1].z = getTextureValue(texPosNVec[2])[opacityComponent];

      #ifdef vtkClippingPlanesOn
        adjustClippedVoxelValues(pos, texPosPVec, scalarInterp[0]);
        adjustClippedVoxelValues(pos, texPosNVec, scalarInterp[1]);
      #endif
      vec4 result;
      result.x = scalarInterp[0].x - scalarInterp[1].x;
      result.y = scalarInterp[0].y - scalarInterp[1].y;
      result.z = scalarInterp[0].z - scalarInterp[1].z;
      // divide by spacing
      result.xyz /= vSpacing;
      result.w = length(result.xyz);
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      if (length(result.xyz) > 0.0) {
        return vec4(normalize(result.xyz),result.w);
      } else {
        return vec4(0.0);
      }
    }
  #endif

  // only works with dependent components
  vec4 computeNormal(vec3 pos, vec3 tstep)
  {
    vec3 xvec = vec3(tstep.x, 0.0, 0.0);
    vec3 yvec = vec3(0.0, tstep.y, 0.0);
    vec3 zvec = vec3(0.0, 0.0, tstep.z);
    vec3 texPosPVec[3];
    texPosPVec[0] = pos + xvec;
    texPosPVec[1] = pos + yvec;
    texPosPVec[2] = pos + zvec;
    vec3 texPosNVec[3];
    texPosNVec[0] = pos - xvec;
    texPosNVec[1] = pos - yvec;
    texPosNVec[2] = pos - zvec;
    vec3 g1, g2;
    g1.x = getTextureValue(texPosPVec[0]).a;
    g1.y = getTextureValue(texPosPVec[1]).a;
    g1.z = getTextureValue(texPosPVec[2]).a;
    g2.x = getTextureValue(texPosNVec[0]).a;
    g2.y = getTextureValue(texPosNVec[1]).a;
    g2.z = getTextureValue(texPosNVec[2]).a;
    #ifdef vtkClippingPlanesOn
      adjustClippedVoxelValues(pos, texPosPVec, g1);
      adjustClippedVoxelValues(pos, texPosNVec, g2);
    #endif
    vec4 result;
    result = vec4(g1 - g2, -1.0);
    // divide by spacing
    result.xyz /= vSpacing;
    result.w = length(result.xyz);
    if (result.w > 0.0){
      // rotate to View Coords
      rotateToViewCoord(result.xyz);
      return vec4(normalize(result.xyz),result.w);
    } else {
      return vec4(0.0);
    }
  }
#endif


#ifdef vtkImageLabelOutlineOn
  vec4 fragCoordToPCPos(vec4 fragCoord) {
    return vec4(
      (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,
      (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,
      (fragCoord.z - 0.5) * 2.0,
      1.0);
  }

  vec4 pcPosToWorldCoord(vec4 pcPos) {
    return PCWCMatrix * pcPos;
  }

  vec3 fragCoordToIndexSpace(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    vec4 vertex = (worldCoord / worldCoord.w);

    vec3 index = (vWCtoIDX * vertex).xyz;

    // half voxel fix for labelmapOutline
    return (index + vec3(0.5)) / vec3(volumeDimensions);
  }

  vec3 fragCoordToWorld(vec4 fragCoord) {
    vec4 pcPos = fragCoordToPCPos(fragCoord);
    vec4 worldCoord = pcPosToWorldCoord(pcPos);
    return worldCoord.xyz;
  }
#endif

//=======================================================================
// compute the normals and gradient magnitudes for a position
// for independent components
mat4 computeMat4Normal(vec3 pos, vec4 tValue, vec3 tstep)
{
  mat4 result;
  vec4 distX = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)) - tValue;
  vec4 distY = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)) - tValue;
  vec4 distZ = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)) - tValue;

  // divide by spacing
  distX /= vSpacing.x;
  distY /= vSpacing.y;
  distZ /= vSpacing.z;

  mat3 rot;
  rot[0] = vPlaneNormal0;
  rot[1] = vPlaneNormal2;
  rot[2] = vPlaneNormal4;

#if !defined(vtkComponent0Proportional)
  result[0].xyz = vec3(distX.r, distY.r, distZ.r);
  result[0].a = length(result[0].xyz);
  result[0].xyz *= rot;
  if (result[0].w > 0.0)
  {
    result[0].xyz /= result[0].w;
  }
#endif

// optionally compute the 2nd component
#if vtkNumComponents >= 2 && !defined(vtkComponent1Proportional)
  result[1].xyz = vec3(distX.g, distY.g, distZ.g);
  result[1].a = length(result[1].xyz);
  result[1].xyz *= rot;
  if (result[1].w > 0.0)
  {
    result[1].xyz /= result[1].w;
  }
#endif

// optionally compute the 3rd component
#if vtkNumComponents >= 3 && !defined(vtkComponent2Proportional)
  result[2].xyz = vec3(distX.b, distY.b, distZ.b);
  result[2].a = length(result[2].xyz);
  result[2].xyz *= rot;
  if (result[2].w > 0.0)
  {
    result[2].xyz /= result[2].w;
  }
#endif

// optionally compute the 4th component
#if vtkNumComponents >= 4 && !defined(vtkComponent3Proportional)
  result[3].xyz = vec3(distX.a, distY.a, distZ.a);
  result[3].a = length(result[3].xyz);
  result[3].xyz *= rot;
  if (result[3].w > 0.0)
  {
    result[3].xyz /= result[3].w;
  }
#endif

  return result;
}

//=======================================================================
// global shadow - secondary ray
#if defined(VolumeShadowOn) || defined(localAmbientOcclusionOn)
float random()
{
  float rand = fract(sin(dot(gl_FragCoord.xy,vec2(12.9898,78.233)))*43758.5453123);
  float jitter=texture2D(jtexture,gl_FragCoord.xy/32.).r;
  uint pcg_state = floatBitsToUint(jitter);
  uint state = pcg_state;
  pcg_state = pcg_state * uint(747796405) + uint(2891336453);
  uint word = ((state >> ((state >> uint(28)) + uint(4))) ^ state) * uint(277803737);
  return (float((((word >> uint(22)) ^ word) >> 1 ))/float(2147483647) + rand)/2.0;
}
#endif

#ifdef VolumeShadowOn
// henyey greenstein phase function
float phase_function(float cos_angle)
{
  // divide by 2.0 instead of 4pi to increase intensity
  return ((1.0-anisotropy2)/pow(1.0+anisotropy2-2.0*anisotropy*cos_angle, 1.5))/2.0;
}

// Computes the intersection between a ray and a box
struct Hit
{
  float tmin;
  float tmax;
};

struct Ray
{
  vec3 origin;
  vec3 dir;
  vec3 invDir;
};

bool BBoxIntersect(vec3 boundMin, vec3 boundMax, const Ray r, out Hit hit)
{
  vec3 tbot = r.invDir * (boundMin - r.origin);
  vec3 ttop = r.invDir * (boundMax - r.origin);
  vec3 tmin = min(ttop, tbot);
  vec3 tmax = max(ttop, tbot);
  vec2 t = max(tmin.xx, tmin.yz);
  float t0 = max(t.x, t.y);
  t = min(tmax.xx, tmax.yz);
  float t1 = min(t.x, t.y);
  hit.tmin = t0;
  hit.tmax = t1;
  return t1 > max(t0,0.0);
}

// As BBoxIntersect requires the inverse of the ray coords,
// this function is used to avoid numerical issues
void safe_0_vector(inout Ray ray)
{
  if(abs(ray.dir.x) < EPSILON) ray.dir.x = sign(ray.dir.x) * EPSILON;
  if(abs(ray.dir.y) < EPSILON) ray.dir.y = sign(ray.dir.y) * EPSILON;
  if(abs(ray.dir.z) < EPSILON) ray.dir.z = sign(ray.dir.z) * EPSILON;
}

float volume_shadow(vec3 posIS, vec3 lightDirNormIS)
{
  float shadow = 1.0;
  float opacity = 0.0;

  // modify sample distance with a random number between 1.5 and 3.0
  float sampleDistanceISVS_jitter = sampleDistanceISVS * mix(1.5, 3.0, random());
  float opacityPrev = texture2D(otexture, vec2(getTextureValue(posIS).r * oscale0 + oshift0, 0.5)).r;

  // in case the first sample near surface has a very tiled light ray, we need to offset start position
  posIS += sampleDistanceISVS_jitter * lightDirNormIS;

  // compute the start and end points for the ray
  Ray ray;
  Hit hit;
  ray.origin = posIS;
  ray.dir = lightDirNormIS;
  safe_0_vector(ray);
  ray.invDir = 1.0/ray.dir;

  if(!BBoxIntersect(vec3(0.0),vec3(1.0), ray, hit))
  {
    return 1.0;
  }
  float maxdist = hit.tmax;

  // interpolate shadow ray length between: 1 unit of sample distance in IS to SQRT3, based on globalIlluminationReach
  float maxgi = mix(sampleDistanceISVS_jitter,SQRT3,giReach);
  maxdist = min(maxdist,maxgi);
  if(maxdist < EPSILON) {
    return 1.0;
  }

  float current_dist = 0.0;
  float current_step = length(sampleDistanceISVS_jitter * lightDirNormIS);
  float clamped_step = 0.0;

  vec4 scalar = vec4(0.0);
  while(current_dist < maxdist)
  {
#ifdef vtkClippingPlanesOn
    vec3 posVC = IStoVC(posIS);
    for (int i = 0; i < clip_numPlanes; ++i)
    {
      if (dot(vec3(vClipPlaneOrigins[i] - posVC), vClipPlaneNormals[i]) > 0.0)
      {
        current_dist = maxdist;
      }
    }
#endif
    scalar = getTextureValue(posIS);
    opacity = texture2D(otexture, vec2(scalar.r * oscale0 + oshift0, 0.5)).r;
    #if defined(vtkGradientOpacityOn) && !defined(UseIndependentComponents)
      vec4 normal = computeNormal(posIS, vec3(1.0/vec3(volumeDimensions)));
      opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
    #endif
    shadow *= 1.0 - opacity;

    // optimization: early termination
    if (shadow < EPSILON){
      return 0.0;
    }

    clamped_step = min(maxdist - current_dist, current_step);
    posIS += clamped_step * lightDirNormIS;
    current_dist += current_step;
  }

  return shadow;
}

vec3 applyShadowRay(vec3 tColor, vec3 posIS, vec3 viewDirectionVC)
{
  vec3 vertLight = vec3(0.0);
  vec3 secondary_contrib = vec3(0.0);
  // here we assume only positional light, no effect of cones
  for (int i = 0; i < lightNum; i++)
  {
    #if(vtkLightComplexity==3)
      if (lightPositional[i] == 1){
        vertLight = lightPositionVC[i] - IStoVC(posIS);
      }else{
        vertLight = - lightDirectionVC[i];
      }
    #else
      vertLight = - lightDirectionVC[i];
    #endif
    // here we assume achromatic light, only intensity
    float dDotL = dot(viewDirectionVC, normalize(vertLight));
    // isotropic scatter returns 0.5 instead of 1/4pi to increase intensity
    float phase_attenuation = 0.5;
    if (abs(anisotropy) > EPSILON){
      phase_attenuation = phase_function(dDotL);
    }
    float vol_shadow = volume_shadow(posIS, normalize(rotateToIDX(vertLight)));
    secondary_contrib += tColor * vDiffuse * lightColor[i] * vol_shadow * phase_attenuation;
    secondary_contrib += tColor * vAmbient;
  }
  return secondary_contrib;
}
#endif

//=======================================================================
// local ambient occlusion
#ifdef localAmbientOcclusionOn
vec3 sample_direction_uniform(int i)
{
  float rand = random() * 0.5;
  float theta = PI2 * (kernelSample[i][0] + rand);
  float phi = acos(2.0 * (kernelSample[i][1] + rand) -1.0) / 2.5;
  return normalize(vec3(cos(theta)*sin(phi), sin(theta)*sin(phi), cos(phi)));
}

// return a matrix that transform startDir into z axis; startDir should be normalized
mat3 zBaseRotationalMatrix(vec3 startDir){
  vec3 axis = cross(startDir, vec3(0.0,0.0,1.0));
  float cosA = startDir.z;
  float k = 1.0 / (1.0 + cosA);
  mat3 matrix = mat3((axis.x * axis.x * k) + cosA, (axis.y * axis.x * k) - axis.z, (axis.z * axis.x * k) + axis.y,
              (axis.x * axis.y * k) + axis.z, (axis.y * axis.y * k) + cosA, (axis.z * axis.y * k) - axis.x,
              (axis.x * axis.z * k) - axis.y, (axis.y * axis.z * k) + axis.x, (axis.z * axis.z * k) + cosA);
  return matrix;
}

float computeLAO(vec3 posIS, float op, vec3 lightDir, vec4 normal){
  // apply LAO only at selected locations, otherwise return full brightness
  if (normal.w > 0.0 && op > 0.05){
    float total_transmittance = 0.0;
    mat3 inverseRotateBasis = inverse(zBaseRotationalMatrix(normalize(-normal.xyz)));
    vec3 currPos, randomDirStep;
    float weight, transmittance, opacity;
    for (int i = 0; i < kernelSize; i++)
    {
      randomDirStep = inverseRotateBasis * sample_direction_uniform(i) * sampleDistanceIS;
      weight = 1.0 - dot(normalize(lightDir), normalize(randomDirStep));
      currPos = posIS;
      transmittance = 1.0;
      for (int j = 0; j < kernelRadius ; j++){
        currPos += randomDirStep;
        // check if it's at clipping plane, if so return full brightness
        if (all(greaterThan(currPos, vec3(EPSILON))) && all(lessThan(currPos,vec3(1.0-EPSILON)))){
          opacity = texture2D(otexture, vec2(getTextureValue(currPos).r * oscale0 + oshift0, 0.5)).r;
          #ifdef vtkGradientOpacityOn
             opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);
          #endif
          transmittance *= 1.0 - opacity;
        }
        else{
          break;
        }
      }
      total_transmittance += transmittance / float(kernelRadius) * weight;

      // early termination if fully translucent
      if (total_transmittance > 1.0 - EPSILON){
        return 1.0;
      }
    }
    // average transmittance and reduce variance
    return clamp(total_transmittance / float(kernelSize), 0.3, 1.0);
  } else {
    return 1.0;
  }
}
#endif

//=======================================================================
// surface light contribution
#if vtkLightComplexity > 0
  void applyLighting(inout vec3 tColor, vec4 normal)
  {
    vec3 diffuse = vec3(0.0, 0.0, 0.0);
    vec3 specular = vec3(0.0, 0.0, 0.0);
    float df, sf = 0.0;
    for (int i = 0; i < lightNum; i++){
        df = abs(dot(normal.rgb, -lightDirectionVC[i]));
        diffuse += df * lightColor[i];
        sf = pow( abs(dot(lightHalfAngleVC[i],normal.rgb)), vSpecularPower);
        specular += sf * lightColor[i];
    }
    tColor.rgb = tColor.rgb*(diffuse*vDiffuse + vAmbient) + specular*vSpecular;
  }
  #ifdef SurfaceShadowOn
  #if vtkLightComplexity < 3
    vec3 applyLightingDirectional(vec3 posIS, vec4 tColor, vec4 normal)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float ndotL,vdotR;
        vertLightDirection = lightDirectionVC[i];
        ndotL = dot(normal.xyz, vertLightDirection);
        if (ndotL < 0.0 && twoSidedLighting)
        {
          ndotL = -ndotL;
        }
        if (ndotL > 0.0)
        {
          diffuse += ndotL * lightColor[i];
          //specular
          vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
          if (vdotR > 0.0)
          {
            specular += pow(vdotR, vSpecularPower) * lightColor[i];
          }
        }
        #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
        #endif
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #else
    vec3 applyLightingPositional(vec3 posIS, vec4 tColor, vec4 normal, vec3 posVC)
    {
      // everything in VC
      vec3 diffuse = vec3(0.0);
      vec3 specular = vec3(0.0);
      #ifdef localAmbientOcclusionOn
        vec3 ambient = vec3(0.0);
      #endif
      vec3 vertLightDirection;
      for (int i = 0; i < lightNum; i++){
        float distance,attenuation,ndotL,vdotR;
        vec3 lightDir;
        if (lightPositional[i] == 1){
          lightDir = lightDirectionVC[i];
          vertLightDirection = posVC - lightPositionVC[i];
          distance = length(vertLightDirection);
          vertLightDirection = normalize(vertLightDirection);
          attenuation = 1.0 / (lightAttenuation[i].x
                              + lightAttenuation[i].y * distance
                              + lightAttenuation[i].z * distance * distance);
          // per OpenGL standard cone angle is 90 or less for a spot light
          if (lightConeAngle[i] <= 90.0){
            float coneDot = dot(vertLightDirection, lightDir);
            if (coneDot >= cos(radians(lightConeAngle[i]))){  // if inside cone
              attenuation = attenuation * pow(coneDot, lightExponent[i]);
            }
            else {
              attenuation = 0.0;
            }
          }
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * attenuation * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * attenuation * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        } else {
          vertLightDirection = lightDirectionVC[i];
          ndotL = dot(normal.xyz, vertLightDirection);
          if (ndotL < 0.0 && twoSidedLighting)
          {
            ndotL = -ndotL;
          }
          if (ndotL > 0.0)
          {
            diffuse += ndotL * lightColor[i];
            //specular
            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));
            if (vdotR > 0.0)
            {
              specular += pow(vdotR, vSpecularPower) * lightColor[i];
            }
          }
          #ifdef localAmbientOcclusionOn
            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);
          #endif
        }
      }
      #ifdef localAmbientOcclusionOn
        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;
      #else
        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;
      #endif
    }
  #endif
  #endif
#endif

// LAO of surface shadows and volume shadows only work with dependent components
vec3 applyAllLightning(vec3 tColor, float alpha, vec3 posIS, vec4 normalLight) {
  #if vtkLightComplexity > 0
    // surface shadows if needed
    #ifdef SurfaceShadowOn
      #if vtkLightComplexity < 3
        vec3 tColorS = applyLightingDirectional(posIS, vec4(tColor, alpha), normalLight);
      #else
        vec3 tColorS = applyLightingPositional(posIS, vec4(tColor, alpha), normalLight, IStoVC(posIS));
      #endif
    #endif

    // volume shadows if needed
    #ifdef VolumeShadowOn
      vec3 tColorVS = applyShadowRay(tColor, posIS, rayDirVC);
    #endif

    // merge
    #ifdef VolumeShadowOn
      #ifdef SurfaceShadowOn
        // surface shadows + volumetric shadows
        float vol_coef = volumetricScatteringBlending * (1.0 - alpha / 2.0) * (1.0 - atan(normalLight.w) * INV4PI);
        tColor = (1.0-vol_coef) * tColorS + vol_coef * tColorVS;
      #else
        // volumetric shadows only
        tColor = tColorVS;
      #endif
    #else
      #ifdef SurfaceShadowOn
        // surface shadows only
        tColor = tColorS;
      #else
        // no shadows
        applyLighting(tColor, normal3);
      #endif
    #endif
  #endif
  return tColor;
}


vec4 getColorForValue(vec4 tValue, vec3 posIS, vec3 tstep)
{

// If labeloutline and not the edge labelmap, since in the edge labelmap blend
// we need the underlying data to sample through
#if defined(vtkImageLabelOutlineOn) && !defined(vtkLabelEdgeProjectionOn)
  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord); // pos in texture space
  vec4 centerValue = getTextureValue(centerPosIS);
  bool pixelOnBorder = false;
  vec4 tColor = texture2D(ctexture, vec2(centerValue.r * cscale0 + cshift0, 0.5));

  // Get alpha of segment from opacity function.
  tColor.a = texture2D(otexture, vec2(centerValue.r * oscale0 + oshift0, 0.5)).r;

  int segmentIndex = int(centerValue.r * 255.0);

  // Use texture sampling for outlineThickness
  float textureCoordinate = float(segmentIndex - 1) / 1024.0;
  float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

  int actualThickness = int(textureValue * 255.0);


  // If it is the background (segment index 0), we should quickly bail out.
  // Previously, this was determined by tColor.a, which was incorrect as it
  // prevented the outline from appearing when the fill is 0.
  if (segmentIndex == 0){
    return vec4(0, 0, 0, 0);
  }

  // Only perform outline check on fragments rendering voxels that aren't invisible.
  // Saves a bunch of needless checks on the background.
  // TODO define epsilon when building shader?
  for (int i = -actualThickness; i <= actualThickness; i++) {
    for (int j = -actualThickness; j <= actualThickness; j++) {
      if (i == 0 || j == 0) {
        continue;
      }

      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),
        gl_FragCoord.y + float(j),
        gl_FragCoord.z, gl_FragCoord.w);

      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);
      vec4 value = getTextureValue(neighborPosIS);

      // If any of my neighbours are not the same value as I
      // am, this means I am on the border of the segment.
      // We can break the loops
      if (any(notEqual(value, centerValue))) {
        pixelOnBorder = true;
        break;
      }
    }

    if (pixelOnBorder == true) {
      break;
    }
  }

  // If I am on the border, I am displayed at full opacity
  if (pixelOnBorder == true) {
    tColor.a = outlineOpacity;
  }

  return tColor;

#else
  // compute the normal and gradient magnitude if needed
  // We compute it as a vec4 if possible otherwise a mat4

  #ifdef UseIndependentComponents

    // sample textures
    vec3 tColor0 = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;

    #if vtkNumComponents > 1
      vec3 tColor1 = texture2D(ctexture, vec2(tValue.g * cscale1 + cshift1, height1)).rgb;
      float pwfValue1 = texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;

      #if vtkNumComponents > 2
        vec3 tColor2 = texture2D(ctexture, vec2(tValue.b * cscale2 + cshift2, height2)).rgb;
        float pwfValue2 = texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;

        #if vtkNumComponents > 3
          vec3 tColor3 = texture2D(ctexture, vec2(tValue.a * cscale3 + cshift3, height3)).rgb;
          float pwfValue3 = texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;
        #endif
      #endif
    #endif

    #if !defined(vtkCustomComponentsColorMix)
      // default path for component color mix

      // compute the normal vectors as needed
      #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
      #endif

      // compute gradient opacity factors as needed
      vec4 goFactor = vec4(1.0, 1.0 ,1.0 ,1.0);
      #if defined(vtkGradientOpacityOn)
        #if !defined(vtkComponent0Proportional)
          goFactor.x =
            computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
        #endif
        #if vtkNumComponents > 1
          #if !defined(vtkComponent1Proportional)
            goFactor.y =
              computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          #endif
          #if vtkNumComponents > 2
            #if !defined(vtkComponent2Proportional)
              goFactor.z =
                computeGradientOpacityFactor(normalMat[2].a, goscale2, goshift2, gomin2, gomax2);
            #endif
            #if vtkNumComponents > 3
              #if !defined(vtkComponent3Proportional)
                goFactor.w =
                  computeGradientOpacityFactor(normalMat[3].a, goscale3, goshift3, gomin3, gomax3);
              #endif
            #endif
          #endif
        #endif
      #endif

      // process color and opacity for each component
      #if !defined(vtkComponent0Proportional)
        float alpha = goFactor.x*mix0*pwfValue0;
        #if vtkLightComplexity > 0
          applyLighting(tColor0, normalMat[0]);
        #endif
      #else
        tColor0 *= pwfValue0;
        float alpha = mix(pwfValue0, 1.0, (1.0 - mix0));
      #endif

      #if vtkNumComponents > 1
        #if !defined(vtkComponent1Proportional)
          alpha += goFactor.y*mix1*pwfValue1;
          #if vtkLightComplexity > 0
            applyLighting(tColor1, normalMat[1]);
          #endif
        #else
          tColor1 *= pwfValue1;
          alpha *= mix(pwfValue1, 1.0, (1.0 - mix1));
        #endif

        #if vtkNumComponents > 2
          #if !defined(vtkComponent2Proportional)
            alpha += goFactor.z*mix2*pwfValue2;
            #if vtkLightComplexity > 0
              applyLighting(tColor2, normalMat[2]);
            #endif
          #else
            tColor2 *= pwfValue2;
            alpha *= mix(pwfValue2, 1.0, (1.0 - mix2));
          #endif
        #endif

        #if vtkNumComponents > 3
          #if !defined(vtkComponent3Proportional)
            alpha += goFactor.w*mix3*pwfValue3;
            #if vtkLightComplexity > 0
              applyLighting(tColor3, normalMat[3]);
            #endif
          #else
            tColor3 *= pwfValue3;
            alpha *= mix(pwfValue3, 1.0, (1.0 - mix3));
          #endif
        #endif
      #endif

      // perform final independent blend
      vec3 tColor = mix0 * tColor0;
      #if vtkNumComponents > 1
        tColor += mix1 * tColor1;
        #if vtkNumComponents > 2
          tColor += mix2 * tColor2;
          #if vtkNumComponents > 3
            tColor += mix3 * tColor3;
          #endif
        #endif
      #endif

      return vec4(tColor, alpha);
    #else
      /*
       * Mix the color information from all the independent components to get a single rgba output
       * Gradient opactity factors and normals are not computed
       *
       * You can compute these using:
       * - computeMat4Normal: always available, compute normal only for non proportional components, used by default independent component mix
       * - computeDensityNormal & computeNormalForDensity: available if ((LightComplexity > 0) || GradientOpacityOn) && ComputeNormalFromOpacity),
       *                                                   used by dependent component color mix, see code for Additive preset in OpenGl/VolumeMapper
       * - computeGradientOpacityFactor: always available, used in a lot of places
       *
       * Using applyAllLightning() is advised for shading but some features don't work well with it (volume shadows, LAO)
       * mix0, mix1, ... are defined for each component that is used and correspond to the componentWeight
       */
      //VTK::CustomComponentsColorMix::Impl
    #endif
  #else
    // dependent components

    // compute normal if needed
    #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)
      // use component 3 of the opacity texture as getTextureValue() sets alpha to the opacity value
      #ifdef vtkComputeNormalFromOpacity
        vec3 scalarInterp[2];
        vec4 normal0 = computeNormalForDensity(posIS, tstep, scalarInterp, 3);
      #else
        vec4 normal0 = computeNormal(posIS, tstep);
      #endif
    #endif

    // compute gradient opacity factor enabled
    #if defined(vtkGradientOpacityOn)
      float gradientOpacity = computeGradientOpacityFactor(normal0.a, goscale0, goshift0, gomin0, gomax0);
    #else
      const float gradientOpacity = 1.0;
    #endif

    // get color and opacity
    #if vtkNumComponents == 1
      vec3 tColor = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, 0.5)).rgb;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      if (alpha < EPSILON){
        return vec4(0.0);
      }
    #endif
    #if vtkNumComponents == 2
      vec3 tColor = vec3(tValue.r * cscale0 + cshift0);
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale1 + oshift1, 0.5)).r;
    #endif
    #if vtkNumComponents == 3
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale0 + oshift0, 0.5)).r;
    #endif
    #if vtkNumComponents == 4
      vec3 tColor;
      tColor.r = tValue.r * cscale0 + cshift0;
      tColor.g = tValue.g * cscale1 + cshift1;
      tColor.b = tValue.b * cscale2 + cshift2;
      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, 0.5)).r;
    #endif

    // lighting
    #if (vtkLightComplexity > 0)
      #ifdef vtkComputeNormalFromOpacity
        vec4 normalLight;
        if (!all(equal(normal0, vec4(0.0)))) {
          scalarInterp[0] = scalarInterp[0] * oscale0 + oshift0;
          scalarInterp[1] = scalarInterp[1] * oscale0 + oshift0;
          normalLight = computeDensityNormal(scalarInterp, 0.5, gradientOpacity);
          if (all(equal(normalLight, vec4(0.0)))) {
            normalLight = normal0;
          }
        }
      #else
        vec4 normalLight = normal0;
      #endif
      tColor = applyAllLightning(tColor, alpha, posIS, normalLight);
    #endif

    return vec4(tColor, alpha);
  #endif // dependent
#endif
}

bool valueWithinScalarRange(vec4 val, vec4 min, vec4 max) {
  bool withinRange = false;
  #if vtkNumComponents == 1
    if (val.r >= min.r && val.r <= max.r) {
      withinRange = true;
    }
  #else
    #ifdef UseIndependentComponents
      #if vtkNumComponents == 2
        if (val.r >= min.r && val.r <= max.r &&
            val.g >= min.g && val.g <= max.g) {
          withinRange = true;
        }
      #else
        if (all(greaterThanEqual(val, ipScalarRangeMin)) &&
            all(lessThanEqual(val, ipScalarRangeMax))) {
          withinRange = true;
        }
      #endif
    #endif
  #endif
  return withinRange;
}

#if vtkBlendMode == 6
bool checkOnEdgeForNeighbor(int i, int j, int s, vec3 stepIS) {
    vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i), gl_FragCoord.y + float(j), gl_FragCoord.z, gl_FragCoord.w);
    vec3 originalNeighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);

    bool justSawIt = false;

    vec3 neighborPosIS = originalNeighborPosIS;

    float stepsTraveled = 0.0;


    // float neighborValue;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS += stepIS;
    }

    if (justSawIt){
      return false;
    }


    neighborPosIS = originalNeighborPosIS;
    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {
        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));
        vec4 texValue = texelFetch(texture1, texCoord, 0);

        if (int(texValue.g) == s) {
            justSawIt = true;
            break;
        }
        neighborPosIS -= stepIS;
    }


    if (!justSawIt) {
        // onedge
        vec3 tColorSegment = texture2D(ctexture, vec2(float(s) * cscale1 + cshift1, height1)).rgb;
        float pwfValueSegment = texture2D(otexture, vec2(float(s) * oscale1 + oshift1, height1)).r;
        gl_FragData[0] = vec4(tColorSegment, pwfValueSegment);
        return true;
    }

    // not on edge
    return false;
}

#endif


//=======================================================================
// Apply the specified blend mode operation along the ray's path.
//
void applyBlend(vec3 posIS, vec3 endIS, vec3 tdims)
{
  vec3 tstep = 1.0/tdims;

  // start slightly inside and apply some jitter
  vec3 delta = endIS - posIS;
  vec3 stepIS = normalize(delta)*sampleDistanceIS;
  float raySteps = length(delta)/sampleDistanceIS;

  // Initialize arrays to false
  // avoid 0.0 jitter
  float jitter = 0.01 + 0.99*texture2D(jtexture, gl_FragCoord.xy/32.0).r;
  float stepsTraveled = jitter;

  // local vars for the loop
  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);
  vec4 tValue;
  vec4 tColor;

  // if we have less than one step then pick the middle point
  // as our value
  // if (raySteps <= 1.0)
  // {
  //   posIS = (posIS + endIS)*0.5;
  // }

  // Perform initial step at the volume boundary
  // compute the scalar
  tValue = getTextureValue(posIS);

  #if vtkBlendMode == 6
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);
    vec3 maxPosIS = posIS; // Store the position of the max value
    int segmentIndex = int(value.g);
    bool originalPosHasSeenNonZero = false;

    uint bitmask = 0u;

    if (segmentIndex != 0) {
      // Tried using the segment index in an boolean array but reading
      // from the array by dynamic indexing was horrondously slow
      // so use bit masking instead and assign 1 to the bit corresponding to the segment index
      // and later check if the bit is set via bit operations
      setBit(segmentIndex);
    }

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);
      segmentIndex = int(tValue.g);

      if (segmentIndex != 0) {
        originalPosHasSeenNonZero = true;
        setBit(segmentIndex);
      }

      if (tValue.r > value.r) {
        value =  tValue; // Update the max value
        maxPosIS = posIS; // Update the position where max occurred
      }

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);

    if (tValue.r > value.r) {
      value = tValue; // Update the max value
      maxPosIS = posIS; // Update the position where max occurred
    }

    // If we have not seen any non-zero segments, we can return early
    // and grab color from the actual center value first component (image)
    if (!originalPosHasSeenNonZero) {
      gl_FragData[0] = getColorForValue(value, maxPosIS, tstep);
      return;
    }

    // probably we can make this configurable but for now we will use the same
    // sample distance as the original sample distance
    float neighborSampleDistanceIS = sampleDistanceIS;

    vec3 neighborRayStepsIS = stepIS;
    float neighborRaySteps = raySteps;
    bool shouldLookInAllNeighbors = false;

    float minVoxelSpacing = min(volumeSpacings[0], min(volumeSpacings[1], volumeSpacings[2]));
    vec4 base = vec4(gl_FragCoord.x, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);

    vec4 baseXPlus = vec4(gl_FragCoord.x + 1.0, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);
    vec4 baseYPlus = vec4(gl_FragCoord.x, gl_FragCoord.y + 1.0, gl_FragCoord.z, gl_FragCoord.w);

    vec3 baseWorld = fragCoordToWorld(base);
    vec3 baseXPlusWorld = fragCoordToWorld(baseXPlus);
    vec3 baseYPlusWorld = fragCoordToWorld(baseYPlus);

    float XPlusDiff = length(baseXPlusWorld - baseWorld);
    float YPlusDiff = length(baseYPlusWorld - baseWorld);

    float minFragSpacingWorld = min(XPlusDiff, YPlusDiff);

    for (int s = 1; s < MAX_SEGMENT_INDEX; s++) {
      // bail out quickly if the segment index has not
      // been seen by the center segment
      if (!isBitSet(s)) {
       continue;
      }

      // Use texture sampling for outlineThickness so that we can have
      // per segment thickness
      float textureCoordinate = float(s - 1) / 1024.0;
      float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;

      int actualThickness = int(textureValue * 255.0);

      // check the extreme points in the neighborhood since there is a better
      // chance of finding the edge there, so that we can bail out
      // faster if we find the edge
      bool onEdge =
          checkOnEdgeForNeighbor(-actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(actualThickness, -actualThickness, s, stepIS) ||
          checkOnEdgeForNeighbor(-actualThickness, +actualThickness, s, stepIS);

      if (onEdge) {
        return;
      }

      // since the next step is computationally expensive, we need to perform
      // some optimizations to avoid it if possible. One of the optimizations
      // is to check the whether the minimum of the voxel spacing is greater than
      // the 2 * the thickness of the outline segment. If that is the case
      // then we can safely skip the next step since we can be sure that the
      // the previous 4 checks on the extreme points would caught the entirety
      // of the all the fragments inside. i.e., this happens when we zoom out,
      if (minVoxelSpacing > (2.0 * float(actualThickness) - 1.0) * minFragSpacingWorld) {
        continue;
      }

      // Loop through the rest, skipping the processed extremes and the center
      for (int i = -actualThickness; i <= actualThickness; i++) {
            for (int j = -actualThickness; j <= actualThickness; j++) {
                if (i == 0 && j == 0) continue; // Skip the center
                if (abs(i) == actualThickness && abs(j) == actualThickness) continue; // Skip corners
                if (checkOnEdgeForNeighbor(i, j, s, stepIS )) {
                    return;
                }
          }
      }
    }

    vec3 tColor0 = texture2D(ctexture, vec2(value.r * cscale0 + cshift0, height0)).rgb;
    float pwfValue0 = texture2D(otexture, vec2(value.r * oscale0 + oshift0, height0)).r;
    gl_FragData[0] = vec4(tColor0, pwfValue0);
  #endif
  #if vtkBlendMode == 0 // COMPOSITE_BLEND
    // now map through opacity and color
    tColor = getColorForValue(tValue, posIS, tstep);

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps);
      gl_FragData[0] = tColor;
      return;
    }

    tColor.a = 1.0 - pow(1.0 - tColor.a, jitter);
    color = vec4(tColor.rgb*tColor.a, tColor.a);
    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);

      float mix = (1.0 - color.a);

      // this line should not be needed but nvidia seems to not handle
      // the break correctly on windows/chrome 58 angle
      //mix = mix * sign(max(raySteps - stepsTraveled - 1.0, 0.0));

      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
      stepsTraveled++;
      posIS += stepIS;
      if (color.a > 0.99) { color.a = 1.0; break; }
    }

    if (color.a < 0.99 && (raySteps - stepsTraveled) > 0.0)
    {
      posIS = endIS;

      // compute the scalar
      tValue = getTextureValue(posIS);

      // now map through opacity and color
      tColor = getColorForValue(tValue, posIS, tstep);
      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps - stepsTraveled);

      float mix = (1.0 - color.a);
      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;
    }

    gl_FragData[0] = vec4(color.rgb/color.a, color.a);
  #endif
  #if vtkBlendMode == 1 || vtkBlendMode == 2
    // MAXIMUM_INTENSITY_BLEND || MINIMUM_INTENSITY_BLEND
    // Find maximum/minimum intensity along the ray.

    // Define the operation we will use (min or max)
    #if vtkBlendMode == 1
    #define OP max
    #else
    #define OP min
    #endif

    // If the clipping range is shorter than the sample distance
    // we can skip the sampling loop along the ray.
    if (raySteps <= 1.0)
    {
      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);
      return;
    }

    vec4 value = tValue;
    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // Update the maximum value if necessary
      value = OP(tValue, value);

      // Otherwise, continue along the ray
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;
    tValue = getTextureValue(posIS);
    value = OP(tValue, value);

    // Now map through opacity and color
    gl_FragData[0] = getColorForValue(value, posIS, tstep);
  #endif
  #if vtkBlendMode == 3 || vtkBlendMode == 4 //AVERAGE_INTENSITY_BLEND || ADDITIVE_BLEND
    vec4 sum = vec4(0.);

    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;
    }

    if (raySteps <= 1.0) {
      gl_FragData[0] = getColorForValue(sum, posIS, tstep);
      return;
    }

    posIS += (jitter*stepIS);

    // Sample along the ray until MaximumSamplesValue,
    // ending slightly inside the total distance
    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      // If we have reached the last step, break
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar
      tValue = getTextureValue(posIS);

      // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation.
      // Notes:
      // - We are comparing all values in the texture to see if any of them
      //   are outside of the scalar range. In the future we might want to allow
      //   scalar ranges for each component.
      if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
        // Sum the values across each step in the path
        sum += tValue;
      }
      stepsTraveled++;
      posIS += stepIS;
    }

    // Perform the last step along the ray using the
    // residual distance
    posIS = endIS;

    // compute the scalar
    tValue = getTextureValue(posIS);

    // One can control the scalar range by setting the IPScalarRange to disregard scalar values, not in the range of interest, from the average computation
    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {
      sum += tValue;

      stepsTraveled++;
    }

    #if vtkBlendMode == 3 // Average
      sum /= vec4(stepsTraveled, stepsTraveled, stepsTraveled, 1.0);
    #endif

    gl_FragData[0] = getColorForValue(sum, posIS, tstep);
  #endif
  #if vtkBlendMode == 5 // RADON
    float normalizedRayIntensity = 1.0;

    // handle very thin volumes
    if (raySteps <= 1.0)
    {
      tValue = getTextureValue(posIS);
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;
      gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity, 0.5));
      return;
    }

    posIS += (jitter*stepIS);

    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)
    {
      if (stepsTraveled + 1.0 >= raySteps) { break; }

      // compute the scalar value
      tValue = getTextureValue(posIS);

      // Convert scalar value to normalizedRayIntensity coefficient and accumulate normalizedRayIntensity
      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;

      posIS += stepIS;
      stepsTraveled++;
    }

    // map normalizedRayIntensity to color
    gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity , 0.5));

  #endif
}

//=======================================================================
// Compute a new start and end point for a given ray based
// on the provided bounded clipping plane (aka a rectangle)
void getRayPointIntersectionBounds(
  vec3 rayPos, vec3 rayDir,
  vec3 planeDir, float planeDist,
  inout vec2 tbounds, vec3 vPlaneX, vec3 vPlaneY,
  float vSize1, float vSize2)
{
  float result = dot(rayDir, planeDir);
  if (abs(result) < 1e-6)
  {
    return;
  }
  result = -1.0 * (dot(rayPos, planeDir) + planeDist) / result;
  vec3 xposVC = rayPos + rayDir*result;
  vec3 vxpos = xposVC - vOriginVC;
  vec2 vpos = vec2(
    dot(vxpos, vPlaneX),
    dot(vxpos, vPlaneY));

  // on some apple nvidia systems this does not work
  // if (vpos.x < 0.0 || vpos.x > vSize1 ||
  //     vpos.y < 0.0 || vpos.y > vSize2)
  // even just
  // if (vpos.x < 0.0 || vpos.y < 0.0)
  // fails
  // so instead we compute a value that represents in and out
  //and then compute the return using this value
  float xcheck = max(0.0, vpos.x * (vpos.x - vSize1)); //  0 means in bounds
  float check = sign(max(xcheck, vpos.y * (vpos.y - vSize2))); //  0 means in bounds, 1 = out

  tbounds = mix(
   vec2(min(tbounds.x, result), max(tbounds.y, result)), // in value
   tbounds, // out value
   check);  // 0 in 1 out
}

//=======================================================================
// given a
// - ray direction (rayDir)
// - starting point (vertexVCVSOutput)
// - bounding planes of the volume
// - optionally depth buffer values
// - far clipping plane
// compute the start/end distances of the ray we need to cast
vec2 computeRayDistances(vec3 rayDir, vec3 tdims)
{
  vec2 dists = vec2(100.0*camFar, -1.0);

  vec3 vSize = vSpacing*tdims;

  // all this is in View Coordinates
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal0, vPlaneDistance0, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal1, vPlaneDistance1, dists, vPlaneNormal2, vPlaneNormal4,
    vSize.y, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal2, vPlaneDistance2, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal3, vPlaneDistance3, dists, vPlaneNormal0, vPlaneNormal4,
    vSize.x, vSize.z);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal4, vPlaneDistance4, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);
  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,
    vPlaneNormal5, vPlaneDistance5, dists, vPlaneNormal0, vPlaneNormal2,
    vSize.x, vSize.y);

  //VTK::ClipPlane::Impl

  // do not go behind front clipping plane
  dists.x = max(0.0,dists.x);

  // do not go PAST far clipping plane
  float farDist = -camThick/rayDir.z;
  dists.y = min(farDist,dists.y);

  // Do not go past the zbuffer value if set
  // This is used for intermixing opaque geometry
  //VTK::ZBuffer::Impl

  return dists;
}

//=======================================================================
// Compute the index space starting position (pos) and end
// position
//
void computeIndexSpaceValues(out vec3 pos, out vec3 endPos, vec3 rayDir, vec2 dists)
{
  // compute starting and ending values in volume space
  pos = vertexVCVSOutput + dists.x*rayDir;
  pos = pos - vOriginVC;
  // convert to volume basis and origin
  pos = vec3(
    dot(pos, vPlaneNormal0),
    dot(pos, vPlaneNormal2),
    dot(pos, vPlaneNormal4));

  endPos = vertexVCVSOutput + dists.y*rayDir;
  endPos = endPos - vOriginVC;
  endPos = vec3(
    dot(endPos, vPlaneNormal0),
    dot(endPos, vPlaneNormal2),
    dot(endPos, vPlaneNormal4));

  float delta = length(endPos - pos);

  pos *= vVCToIJK;
  endPos *= vVCToIJK;

  float delta2 = length(endPos - pos);
  sampleDistanceIS = sampleDistance*delta2/delta;
  #ifdef VolumeShadowOn
    sampleDistanceISVS = sampleDistanceIS * volumeShadowSamplingDistFactor;
  #endif
}

void main()
{

  if (cameraParallel == 1)
  {
    // Camera is parallel, so the rayDir is just the direction of the camera.
    rayDirVC = vec3(0.0, 0.0, -1.0);
  } else {
    // camera is at 0,0,0 so rayDir for perspective is just the vc coord
    rayDirVC = normalize(vertexVCVSOutput);
  }

  vec3 tdims = vec3(volumeDimensions);

  // compute the start and end points for the ray
  vec2 rayStartEndDistancesVC = computeRayDistances(rayDirVC, tdims);

  // do we need to composite? aka does the ray have any length
  // If not, bail out early
  if (rayStartEndDistancesVC.y <= rayStartEndDistancesVC.x)
  {
    discard;
  }

  // IS = Index Space
  vec3 posIS;
  vec3 endIS;
  computeIndexSpaceValues(posIS, endIS, rayDirVC, rayStartEndDistancesVC);

  // Perform the blending operation along the ray
  applyBlend(posIS, endIS, tdims);
}
`;const{vtkWarningMacro:zM,vtkErrorMacro:Sp}=sr;function jM(t){switch(t){case Y0.CUSTOM:return"//VTK::CustomColorMix";case Y0.ADDITIVE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);

          vec3 scalarInterp1[2];
          vec4 normalLight1 = computeNormalForDensity(posIS, tstep, scalarInterp1, 1);
          scalarInterp1[0] = scalarInterp1[0] * oscale1 + oshift1;
          scalarInterp1[1] = scalarInterp1[1] * oscale1 + oshift1;
          normalLight1 = computeDensityNormal(scalarInterp1, height1, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
          vec4 normalLight1 = normalMat[1];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        float opacity1 = pwfValue1;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
          float gof1 = computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);
          opacity1 *= gof1;
        #endif
        float opacitySum = opacity0 + opacity1;
        if (opacitySum <= 0.0) {
          return vec4(0.0);
        }

        // mix the colors and opacities
        tColor0 = applyAllLightning(tColor0, opacity0, posIS, normalLight0);
        tColor1 = applyAllLightning(tColor1, opacity1, posIS, normalLight1);
        vec3 mixedColor = (opacity0 * tColor0 + opacity1 * tColor1) / opacitySum;
        return vec4(mixedColor, min(1.0, opacitySum));
`;case Y0.COLORIZE:return`
        // compute normals
        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);
        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)
          vec3 scalarInterp0[2];
          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);
          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;
          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;
          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);
        #else
          vec4 normalLight0 = normalMat[0];
        #endif

        // compute opacities
        float opacity0 = pwfValue0;
        #ifdef vtkGradientOpacityOn
          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);
          opacity0 *= gof0;
        #endif

        // mix the colors and opacities
        vec3 color = tColor0 * mix(vec3(1.0), tColor1, pwfValue1);
        color = applyAllLightning(color, opacity0, posIS, normalLight0);
        return vec4(color, opacity0);
`;default:return null}}function $M(t,e){e.classHierarchy.push("vtkOpenGLVolumeMapper");function n(i){[e._scalars,e._scalarOpacityFunc,e._colorTransferFunc,e._labelOutlineThicknessArray].forEach(a=>i.unregisterGraphicsResourceUser(a,t))}t.buildPass=()=>{e.zBufferTexture=null},t.zBufferPass=(i,a)=>{if(i){const o=a.getZBufferTexture();o!==e.zBufferTexture&&(e.zBufferTexture=o)}},t.opaqueZBufferPass=(i,a)=>t.zBufferPass(i,a),t.volumePass=(i,a)=>{if(i){const o=e._openGLRenderWindow;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),o&&!o.isDeleted()&&o!==e._openGLRenderWindow&&n(o),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.jitterTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLVolume=t.getFirstAncestorOfType("vtkOpenGLVolume");const s=e.openGLVolume.getRenderable();e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer");const c=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(c.getActiveCamera()),t.renderPiece(c,s)}},t.getShaderTemplate=(i,a,o)=>{i.Vertex=GM,i.Fragment=WM,i.Geometry=""},t.useIndependentComponents=i=>{const a=i.getIndependentComponents(),s=e.currentInput?.getPointData()?.getScalars()?.getNumberOfComponents(),c=i.getColorMixPreset();return a&&s>=2||!!c},t.replaceShaderValues=(i,a,o)=>{const s=o.getProperty();let c=i.Fragment;s.getInterpolationType()===Gd.LINEAR&&(c=Te.substitute(c,"//VTK::TrilinearOn","#define vtkTrilinearOn").result),t.isLabelmapOutlineRequired(o)===!0&&(c=Te.substitute(c,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result),e.renderable.getBlendMode()===I0.LABELMAP_EDGE_PROJECTION_BLEND&&(c=Te.substitute(c,"//VTK::LabelEdgeProjectionOn","#define vtkLabelEdgeProjectionOn").result);const h=e.scalarTexture.getComponents();c=Te.substitute(c,"//VTK::NumComponents",`#define vtkNumComponents ${h}`).result;const p=t.useIndependentComponents(s);p&&(c=Te.substitute(c,"//VTK::IndependentComponentsOn","#define UseIndependentComponents").result);const d=[],g=[];for(let _=0;_<h;_++)s.getOpacityMode(_)===xx.PROPORTIONAL&&d.push(`#define vtkComponent${_}Proportional`),s.getForceNearestInterpolation(_)&&g.push(`#define vtkComponent${_}ForceNearest`);c=Te.substitute(c,"//VTK::vtkProportionalComponents",d.join(`
`)).result,c=Te.substitute(c,"//VTK::vtkForceNearestComponents",g.join(`
`)).result;const y=s.getColorMixPreset(),x=jM(y);x&&(c=Te.substitute(c,"//VTK::CustomComponentsColorMixOn","#define vtkCustomComponentsColorMix").result,c=Te.substitute(c,"//VTK::CustomComponentsColorMix::Impl",x).result);const m=e.currentInput.getSpatialExtent(),v=e.currentInput.getSpacing(),w=new Float64Array(3);$t(w,(m[1]-m[0])*v[0],(m[3]-m[2])*v[1],(m[5]-m[4])*v[2]);const C=Qo(w)/t.getCurrentSampleDistance(a);c=Te.substitute(c,"//VTK::MaximumSamplesValue",`${Math.ceil(C)}`).result,c=Te.substitute(c,"//VTK::LightComplexity",`#define vtkLightComplexity ${e.lightComplexity}`).result,e.lightComplexity>0&&(e.renderable.getVolumetricScatteringBlending()>0&&(c=Te.substitute(c,"//VTK::VolumeShadowOn","#define VolumeShadowOn").result),e.renderable.getVolumetricScatteringBlending()<1&&(c=Te.substitute(c,"//VTK::SurfaceShadowOn","#define SurfaceShadowOn").result),e.renderable.getLocalAmbientOcclusion()&&s.getAmbient()>0&&(c=Te.substitute(c,"//VTK::localAmbientOcclusionOn","#define localAmbientOcclusionOn").result));const T=p?h:1;e.gopacity=!1;for(let _=0;!e.gopacity&&_<T;++_)e.gopacity||=s.getUseGradientOpacity(_);e.gopacity&&(c=Te.substitute(c,"//VTK::GradientOpacityOn","#define vtkGradientOpacityOn").result),e.renderable.getComputeNormalFromOpacity()&&(c=Te.substitute(c,"//VTK::vtkComputeNormalFromOpacity","#define vtkComputeNormalFromOpacity").result),e.zBufferTexture!==null&&(c=Te.substitute(c,"//VTK::ZBuffer::Dec",["uniform sampler2D zBufferTexture;","uniform float vpZWidth;","uniform float vpZHeight;"]).result,c=Te.substitute(c,"//VTK::ZBuffer::Impl",["vec4 depthVec = texture2D(zBufferTexture, vec2(gl_FragCoord.x / vpZWidth, gl_FragCoord.y/vpZHeight));","float zdepth = (depthVec.r*256.0 + depthVec.g)/257.0;","zdepth = zdepth * 2.0 - 1.0;","if (cameraParallel == 0) {","zdepth = -2.0 * camFar * camNear / (zdepth*(camFar-camNear)-(camFar+camNear)) - camNear;}","else {",`zdepth = (zdepth + 1.0) * 0.5 * (camFar - camNear);}
`,"zdepth = -zdepth/rayDir.z;","dists.y = min(zdepth,dists.y);"]).result),c=Te.substitute(c,"//VTK::BlendMode",`${e.renderable.getBlendMode()}`).result,i.Fragment=c,t.replaceShaderLight(i,a,o),t.replaceShaderClippingPlane(i,a,o)},t.replaceShaderLight=(i,a,o)=>{if(e.lightComplexity===0)return;let s=i.Fragment,c=0;a.getLights().forEach(l=>{l.getSwitch()&&(c+=1)}),s=Te.substitute(s,"//VTK::Light::Dec",["uniform int lightNum;","uniform bool twoSidedLighting;",`uniform vec3 lightColor[${c}];`,`uniform vec3 lightDirectionVC[${c}]; // normalized`,`uniform vec3 lightHalfAngleVC[${c}];`,"//VTK::Light::Dec"],!1).result,e.lightComplexity===3&&(s=Te.substitute(s,"//VTK::Light::Dec",[`uniform vec3 lightPositionVC[${c}];`,`uniform vec3 lightAttenuation[${c}];`,`uniform float lightConeAngle[${c}];`,`uniform float lightExponent[${c}];`,`uniform int lightPositional[${c}];`],!1).result),e.renderable.getVolumetricScatteringBlending()>0&&(s=Te.substitute(s,"//VTK::VolumeShadow::Dec",["uniform float volumetricScatteringBlending;","uniform float giReach;","uniform float volumeShadowSamplingDistFactor;","uniform float anisotropy;","uniform float anisotropy2;"],!1).result),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0&&(s=Te.substitute(s,"//VTK::LAO::Dec",["uniform int kernelRadius;",`uniform vec2 kernelSample[${e.renderable.getLAOKernelRadius()}];`,"uniform int kernelSize;"],!1).result),i.Fragment=s},t.replaceShaderClippingPlane=(i,a,o)=>{let s=i.Fragment;if(e.renderable.getClippingPlanes().length>0){const c=e.renderable.getClippingPlanes().length;s=Te.substitute(s,"//VTK::ClipPlane::Dec",["uniform vec3 vClipPlaneNormals[6];","uniform float vClipPlaneDistances[6];","uniform vec3 vClipPlaneOrigins[6];","uniform int clip_numPlanes;","//VTK::ClipPlane::Dec","#define vtkClippingPlanesOn"],!1).result,s=Te.substitute(s,"//VTK::ClipPlane::Impl",[`for(int i = 0; i < ${c}; i++) {`,"  float rayDirRatio = dot(rayDir, vClipPlaneNormals[i]);","  float equationResult = dot(vertexVCVSOutput, vClipPlaneNormals[i]) + vClipPlaneDistances[i];","  if (rayDirRatio == 0.0)","  {","    if (equationResult < 0.0) dists.x = dists.y;","    continue;","  }","  float result = -1.0 * equationResult / rayDirRatio;","  if (rayDirRatio < 0.0) dists.y = min(dists.y, result);","  else dists.x = max(dists.x, result);","}","//VTK::ClipPlane::Impl"],!1).result}i.Fragment=s};const r=(i,a)=>{let o=0;i.getProperty().getShade()&&e.renderable.getBlendMode()===I0.COMPOSITE_BLEND&&(o=0,e.numberOfLights=0,a.forEach(s=>{s.getSwitch()>0&&(e.numberOfLights++,o===0&&(o=1)),o===1&&(e.numberOfLights>1||s.getIntensity()!==1||!s.lightTypeIsHeadLight())&&(o=2),o<3&&s.getPositional()&&(o=3)})),o!==e.lightComplexity&&(e.lightComplexity=o,t.modified())};t.getNeedToRebuildShaders=(i,a,o)=>{const s=o.getProperty();r(o,a.getLights());const c=e.scalarTexture.getComponents(),l=[],f=[];for(let x=0;x<c;x++)l.push(s.getOpacityMode(x)),f.push(s.getForceNearestInterpolation(x));const u=e.currentInput.getSpatialExtent(),h=e.currentInput.getSpacing(),p=new Float64Array(3);$t(p,(u[1]-u[0])*h[0],(u[3]-u[2])*h[1],(u[5]-u[4])*h[2]);const d=Qo(p)/t.getCurrentSampleDistance(a),g=!!e.zBufferTexture,y={iComps:s.getIndependentComponents(),colorMixPreset:s.getColorMixPreset(),interpolationType:s.getInterpolationType(),useLabelOutline:t.isLabelmapOutlineRequired(o),numComp:c,maxSamples:d,useGradientOpacity:s.getUseGradientOpacity(0),blendMode:e.renderable.getBlendMode(),hasZBufferTexture:g,opacityModes:l,forceNearestInterps:f};return i.getProgram()?.getHandle()===0||i.getShaderSourceTime().getMTime()<t.getMTime()||i.getShaderSourceTime().getMTime()<e.renderable.getMTime()||!e.previousState||!Pg(e.previousState,y)?(e.previousState=y,!0):!1},t.updateShaders=(i,a,o)=>{if(t.getNeedToRebuildShaders(i,a,o)){const s={Vertex:null,Fragment:null,Geometry:null};t.buildShaders(s,a,o);const c=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);c!==i.getProgram()&&(i.setProgram(c),i.getVAO().releaseGraphicsResources()),i.getShaderSourceTime().modified()}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(i.getProgram());i.getVAO().bind(),t.setMapperShaderParameters(i,a,o),t.setCameraShaderParameters(i,a,o),t.setPropertyShaderParameters(i,a,o),t.getClippingPlaneShaderParameters(i,a,o)},t.setMapperShaderParameters=(i,a,o)=>{const s=i.getProgram();i.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>i.getAttributeUpdateTime().getMTime()||i.getShaderSourceTime().getMTime()>i.getAttributeUpdateTime().getMTime())&&(s.isAttributeUsed("vertexDC")&&(i.getVAO().addAttributeArray(s,i.getCABO(),"vertexDC",i.getCABO().getVertexOffset(),i.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Sp("Error setting vertexDC in shader VAO.")),i.getAttributeUpdateTime().modified()),s.setUniformi("texture1",e.scalarTexture.getTextureUnit()),s.setUniformf("sampleDistance",t.getCurrentSampleDistance(a));const c=e.scalarTexture.getVolumeInfo(),l=e.renderable.getIpScalarRange();if(c?.dataComputedScale?.length){const f=[],u=[];for(let h=0;h<4;h++)f[h]=l[0]*c.dataComputedScale[h]+c.dataComputedOffset[h],u[h]=l[1]*c.dataComputedScale[h]+c.dataComputedOffset[h],f[h]=(f[h]-c.offset[h])/c.scale[h],u[h]=(u[h]-c.offset[h])/c.scale[h];s.setUniform4f("ipScalarRangeMin",f[0],f[1],f[2],f[3]),s.setUniform4f("ipScalarRangeMax",u[0],u[1],u[2],u[3])}if(e.zBufferTexture!==null){s.setUniformi("zBufferTexture",e.zBufferTexture.getTextureUnit());const f=e._useSmallViewport?[e._smallViewportWidth,e._smallViewportHeight]:e._openGLRenderWindow.getFramebufferSize();s.setUniformf("vpZWidth",f[0]),s.setUniformf("vpZHeight",f[1])}},t.setCameraShaderParameters=(i,a,o)=>{const s=e.openGLCamera.getKeyMatrices(a),c=e.openGLVolume.getKeyMatrices();It(e.modelToView,s.wcvc,c.mcwc);const l=i.getProgram(),f=e.openGLCamera.getRenderable(),u=f.getClippingRange();l.setUniformf("camThick",u[1]-u[0]),l.setUniformf("camNear",u[0]),l.setUniformf("camFar",u[1]);const h=e.currentInput.getBounds(),p=e.currentInput.getDimensions(),d=new Float64Array(3),g=new Float64Array(3);let y=1,x=-1,m=1,v=-1;for(let z=0;z<8;++z){if($t(d,h[z%2],h[2+Math.floor(z/2)%2],h[4+Math.floor(z/4)]),Dt(d,d,e.modelToView),!f.getParallelProjection()){gn(g,d);const Y=-u[0]/d[2];lr(d,g,Y)}Dt(d,d,s.vcpc),y=Math.min(d[0],y),x=Math.max(d[0],x),m=Math.min(d[1],m),v=Math.max(d[1],v)}l.setUniformf("dcxmin",y),l.setUniformf("dcxmax",x),l.setUniformf("dcymin",m),l.setUniformf("dcymax",v),l.isUniformUsed("cameraParallel")&&l.setUniformi("cameraParallel",f.getParallelProjection());const w=e.currentInput.getSpatialExtent(),C=e.currentInput.getSpacing(),T=new Float64Array(3);$t(T,(w[1]-w[0])*C[0],(w[3]-w[2])*C[1],(w[5]-w[4])*C[2]),l.setUniform3f("vSpacing",C[0],C[1],C[2]),$t(d,w[0],w[2],w[4]),e.currentInput.indexToWorldVec3(d,d),Dt(d,d,e.modelToView),l.setUniform3f("vOriginVC",d[0],d[1],d[2]);const _=e.currentInput.getIndexToWorld();It(e.idxToView,e.modelToView,_),Hc(e.idxNormalMatrix,s.normalMatrix,c.normalMatrix),Hc(e.idxNormalMatrix,e.idxNormalMatrix,e.currentInput.getDirectionByReference());const S=Qo(T)/t.getCurrentSampleDistance(a);S>e.renderable.getMaximumSamplesPerRay()&&zM(`The number of steps required ${Math.ceil(S)} is larger than the
        specified maximum number of steps ${e.renderable.getMaximumSamplesPerRay()}.
        Please either change the
        volumeMapper sampleDistance or its maximum number of samples.`);const b=new Float64Array(3);if($t(b,1,1,1),yE(b,b,T),l.setUniform3f("vVCToIJK",b[0],b[1],b[2]),l.setUniform3i("volumeDimensions",p[0],p[1],p[2]),l.setUniform3f("volumeSpacings",C[0],C[1],C[2]),!e._openGLRenderWindow.getWebgl2()){const z=e.scalarTexture.getVolumeInfo();l.setUniformf("texWidth",e.scalarTexture.getWidth()),l.setUniformf("texHeight",e.scalarTexture.getHeight()),l.setUniformi("xreps",z.xreps),l.setUniformi("xstride",z.xstride),l.setUniformi("ystride",z.ystride)}const D=new Float64Array(3),E=new Float64Array(3);for(let z=0;z<6;++z){switch(z){case 1:$t(D,-1,0,0),$t(E,w[0],w[2],w[4]);break;case 2:$t(D,0,1,0),$t(E,w[1],w[3],w[5]);break;case 3:$t(D,0,-1,0),$t(E,w[0],w[2],w[4]);break;case 4:$t(D,0,0,1),$t(E,w[1],w[3],w[5]);break;case 5:$t(D,0,0,-1),$t(E,w[0],w[2],w[4]);break;case 0:default:$t(D,1,0,0),$t(E,w[1],w[3],w[5]);break}K0(D,D,e.idxNormalMatrix),Dt(E,E,e.idxToView);const Y=-1*zt(E,D);l.setUniform3f(`vPlaneNormal${z}`,D[0],D[1],D[2]),l.setUniformf(`vPlaneDistance${z}`,Y)}if(t.isLabelmapOutlineRequired(o)){const Y=e.currentInput.getWorldToIndex();l.setUniformMatrix("vWCtoIDX",Y);const W=a.getActiveCamera(),[B,j]=W.getClippingRange(),ie=W.getDistance();W.setClippingRange(ie,ie+.1);const ae=e.openGLCamera.getKeyMatrices(a);Sn(e.projectionToWorld,ae.wcpc),W.setClippingRange(B,j),e.openGLCamera.getKeyMatrices(a),l.setUniformMatrix("PCWCMatrix",e.projectionToWorld);const fe=t.getRenderTargetSize();l.setUniformf("vpWidth",fe[0]),l.setUniformf("vpHeight",fe[1]);const Ee=t.getRenderTargetOffset();l.setUniformf("vpOffsetX",Ee[0]/fe[0]),l.setUniformf("vpOffsetY",Ee[1]/fe[1])}if(Sn(e.projectionToView,s.vcpc),l.setUniformMatrix("PCVCMatrix",e.projectionToView),e.lightComplexity===0)return;let R=0;const F=[],M=[],U=[];if(a.getLights().forEach(z=>{if(z.getSwitch()>0){const W=z.getColor(),B=z.getIntensity();F[0+R*3]=W[0]*B,F[1+R*3]=W[1]*B,F[2+R*3]=W[2]*B;const j=z.getDirection();$t(D,j[0],j[1],j[2]),K0(D,D,s.normalMatrix),gn(D,D),M[0+R*3]=D[0],M[1+R*3]=D[1],M[2+R*3]=D[2],U[0+R*3]=-.5*D[0],U[1+R*3]=-.5*D[1],U[2+R*3]=-.5*(D[2]-1),R++}}),l.setUniformi("twoSidedLighting",a.getTwoSidedLighting()),l.setUniformi("lightNum",R),l.setUniform3fv("lightColor",F),l.setUniform3fv("lightDirectionVC",M),l.setUniform3fv("lightHalfAngleVC",U),e.lightComplexity===3){R=0;const z=[],Y=[],W=[],B=[],j=[];a.getLights().forEach(ie=>{if(ie.getSwitch()>0){const fe=ie.getAttenuationValues();Y[0+R*3]=fe[0],Y[1+R*3]=fe[1],Y[2+R*3]=fe[2],B[R]=ie.getExponent(),W[R]=ie.getConeAngle(),j[R]=ie.getPositional();const Ee=ie.getTransformedPosition();Dt(Ee,Ee,e.modelToView),z[0+R*3]=Ee[0],z[1+R*3]=Ee[1],z[2+R*3]=Ee[2],R+=1}}),l.setUniform3fv("lightPositionVC",z),l.setUniform3fv("lightAttenuation",Y),l.setUniformfv("lightConeAngle",W),l.setUniformfv("lightExponent",B),l.setUniformiv("lightPositional",j)}if(e.renderable.getVolumetricScatteringBlending()>0&&(l.setUniformf("giReach",e.renderable.getGlobalIlluminationReach()),l.setUniformf("volumetricScatteringBlending",e.renderable.getVolumetricScatteringBlending()),l.setUniformf("volumeShadowSamplingDistFactor",e.renderable.getVolumeShadowSamplingDistFactor()),l.setUniformf("anisotropy",e.renderable.getAnisotropy()),l.setUniformf("anisotropy2",e.renderable.getAnisotropy()**2)),e.renderable.getLocalAmbientOcclusion()&&o.getProperty().getAmbient()>0){const z=e.renderable.getLAOKernelSize();l.setUniformi("kernelSize",z);const Y=[];for(let W=0;W<z;W++)Y[W*2]=Math.random()*.5,Y[W*2+1]=Math.random()*.5;l.setUniform2fv("kernelSample",Y),l.setUniformi("kernelRadius",e.renderable.getLAOKernelRadius())}},t.setPropertyShaderParameters=(i,a,o)=>{const s=i.getProgram();s.setUniformi("ctexture",e.colorTexture.getTextureUnit()),s.setUniformi("otexture",e.opacityTexture.getTextureUnit()),s.setUniformi("jtexture",e.jitterTexture.getTextureUnit()),s.setUniformi("ttexture",e.labelOutlineThicknessTexture.getTextureUnit());const c=e.scalarTexture.getVolumeInfo(),l=o.getProperty(),f=e.scalarTexture.getComponents(),u=t.useIndependentComponents(l);if(u)for(let p=0;p<f;p++)s.setUniformf(`mix${p}`,o.getProperty().getComponentWeight(p));for(let p=0;p<f;p++){const d=u?p:0,g=c.scale[p],x=l.getScalarOpacity(d).getRange(),m=g/(x[1]-x[0]),v=(c.offset[p]-x[0])/(x[1]-x[0]);s.setUniformf(`oshift${p}`,v),s.setUniformf(`oscale${p}`,m);const C=l.getRGBTransferFunction(d).getRange(),T=(c.offset[p]-C[0])/(C[1]-C[0]),_=g/(C[1]-C[0]);s.setUniformf(`cshift${p}`,T),s.setUniformf(`cscale${p}`,_)}if(e.gopacity)if(u)for(let p=0;p<f;++p){const d=c.scale[p];if(l.getUseGradientOpacity(p)){const y=l.getGradientOpacityMinimumOpacity(p),x=l.getGradientOpacityMaximumOpacity(p);s.setUniformf(`gomin${p}`,y),s.setUniformf(`gomax${p}`,x);const m=[l.getGradientOpacityMinimumValue(p),l.getGradientOpacityMaximumValue(p)];s.setUniformf(`goscale${p}`,d*(x-y)/(m[1]-m[0])),s.setUniformf(`goshift${p}`,-m[0]*(x-y)/(m[1]-m[0])+y)}else s.setUniformf(`gomin${p}`,1),s.setUniformf(`gomax${p}`,1),s.setUniformf(`goscale${p}`,0),s.setUniformf(`goshift${p}`,1)}else{const p=c.scale[f-1],d=l.getGradientOpacityMinimumOpacity(0),g=l.getGradientOpacityMaximumOpacity(0);s.setUniformf("gomin0",d),s.setUniformf("gomax0",g);const y=[l.getGradientOpacityMinimumValue(0),l.getGradientOpacityMaximumValue(0)];s.setUniformf("goscale0",p*(g-d)/(y[1]-y[0])),s.setUniformf("goshift0",-y[0]*(g-d)/(y[1]-y[0])+d)}if(t.isLabelmapOutlineRequired(o)===!0){const p=o.getProperty().getLabelOutlineOpacity();s.setUniformf("outlineOpacity",p)}e.lightComplexity>0&&(s.setUniformf("vAmbient",l.getAmbient()),s.setUniformf("vDiffuse",l.getDiffuse()),s.setUniformf("vSpecular",l.getSpecular()),s.setUniformf("vSpecularPower",l.getSpecularPower()))},t.getClippingPlaneShaderParameters=(i,a,o)=>{if(e.renderable.getClippingPlanes().length>0){const s=e.openGLCamera.getKeyMatrices(a),c=[],l=[],f=[],u=e.renderable.getClippingPlanes(),h=u.length;for(let d=0;d<h;++d){const g=u[d].getNormal(),y=u[d].getOrigin();K0(g,g,s.normalMatrix),Dt(y,y,s.wcvc);const x=-1*zt(y,g);c.push(g[0]),c.push(g[1]),c.push(g[2]),l.push(x),f.push(y[0]),f.push(y[1]),f.push(y[2])}const p=i.getProgram();p.setUniform3fv("vClipPlaneNormals",c),p.setUniformfv("vClipPlaneDistances",l),p.setUniform3fv("vClipPlaneOrigins",f),p.setUniformi("clip_numPlanes",h)}},t.delete=Ll(()=>{e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},()=>{e._openGLRenderWindow&&n(e._openGLRenderWindow)},t.delete),t.getRenderTargetSize=()=>{if(e._useSmallViewport)return[e._smallViewportWidth,e._smallViewportHeight];const{usize:i,vsize:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getRenderTargetOffset=()=>{const{lowerLeftU:i,lowerLeftV:a}=e._openGLRenderer.getTiledSizeAndOrigin();return[i,a]},t.getCurrentSampleDistance=i=>{const a=i.getVTKWindow().getInteractor(),o=e.renderable.getSampleDistance();if(a.isAnimating()){const s=e.renderable.getInteractionSampleDistanceFactor();return o*s}return o},t.renderPieceStart=(i,a)=>{const o=i.getVTKWindow().getInteractor();if(e._lastScale||(e._lastScale=e.renderable.getInitialInteractionScale()),e._useSmallViewport=!1,o.isAnimating()&&e._lastScale>1.5&&(e._useSmallViewport=!0),e._animationRateSubscription||(e._animationRateSubscription=o.onAnimationFrameRateUpdate(()=>{if(e.renderable.getAutoAdjustSampleDistances()){const c=o.getRecentAnimationFrameRate(),l=o.getDesiredUpdateRate()/c;(l>1.15||l<.85)&&(e._lastScale*=l),e._lastScale>400&&(e._lastScale=400),e._lastScale<1.5&&(e._lastScale=1.5)}else e._lastScale=e.renderable.getImageSampleDistance()*e.renderable.getImageSampleDistance()})),e._useSmallViewport){const c=e._openGLRenderWindow.getFramebufferSize(),l=1/Math.sqrt(e._lastScale);if(e._smallViewportWidth=Math.ceil(l*c[0]),e._smallViewportHeight=Math.ceil(l*c[1]),e._smallViewportHeight>c[1]&&(e._smallViewportHeight=c[1]),e._smallViewportWidth>c[0]&&(e._smallViewportWidth=c[0]),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.getGLFramebuffer()===null)e.framebuffer.create(c[0],c[1]),e.framebuffer.populateFramebuffer();else{const u=e.framebuffer.getSize();(!u||u[0]!==c[0]||u[1]!==c[1])&&(e.framebuffer.create(c[0],c[1]),e.framebuffer.populateFramebuffer())}e.framebuffer.bind();const f=e.context;f.clearColor(0,0,0,0),f.colorMask(!0,!0,!0,!0),f.clear(f.COLOR_BUFFER_BIT),f.viewport(0,0,e._smallViewportWidth,e._smallViewportHeight),e.fvp=[e._smallViewportWidth/c[0],e._smallViewportHeight/c[1]]}e.context.disable(e.context.DEPTH_TEST),t.updateBufferObjects(i,a),a.getProperty().getInterpolationType()===Gd.NEAREST?(e.scalarTexture.setMinificationFilter(lt.NEAREST),e.scalarTexture.setMagnificationFilter(lt.NEAREST)):(e.scalarTexture.setMinificationFilter(lt.LINEAR),e.scalarTexture.setMagnificationFilter(lt.LINEAR)),e.zBufferTexture!==null&&e.zBufferTexture.activate()},t.renderPieceDraw=(i,a)=>{const o=e.context;e.scalarTexture.activate(),e.opacityTexture.activate(),e.labelOutlineThicknessTexture.activate(),e.colorTexture.activate(),e.jitterTexture.activate(),t.updateShaders(e.tris,i,a),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.scalarTexture.deactivate(),e.colorTexture.deactivate(),e.opacityTexture.deactivate(),e.labelOutlineThicknessTexture.deactivate(),e.jitterTexture.deactivate()},t.renderPieceFinish=(i,a)=>{if(e.zBufferTexture!==null&&e.zBufferTexture.deactivate(),e._useSmallViewport){if(e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null){e.copyShader=e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","uniform vec2 tfactor;","varying vec2 tcoord;","void main() { tcoord = vec2(vertexDC.x*0.5 + 0.5, vertexDC.y*0.5 + 0.5) * tfactor; gl_Position = vertexDC; }"].join(`
`),["//VTK::System::Dec","//VTK::Output::Dec","uniform sampler2D texture1;","varying vec2 tcoord;","void main() { gl_FragData[0] = texture2D(texture1,tcoord); }"].join(`
`),"");const l=e.copyShader;e.copyVAO=D1.newInstance(),e.copyVAO.setOpenGLRenderWindow(e._openGLRenderWindow),e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(l,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Sp("Error setting vertexDC in copy shader VAO.")}else e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.copyShader);const o=e._openGLRenderWindow.getFramebufferSize();e.context.viewport(0,0,o[0],o[1]);const s=e.framebuffer.getColorTexture();s.activate(),e.copyShader.setUniformi("texture",s.getTextureUnit()),e.copyShader.setUniform2f("tfactor",e.fvp[0],e.fvp[1]);const c=e.context;c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.deactivate(),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)}},t.renderPiece=(i,a)=>{if(t.invokeEvent({type:"StartEvent"}),e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent({type:"EndEvent"}),!e.currentInput){Sp("No input!");return}t.renderPieceStart(i,a),t.renderPieceDraw(i,a),t.renderPieceFinish(i,a)},t.computeBounds=(i,a)=>{if(!t.getInput()){tu(e.Bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(i,a)=>{t.getNeedToRebuildBufferObjects(i,a)&&t.buildBufferObjects(i,a)},t.getNeedToRebuildBufferObjects=(i,a)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<a.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<a.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle(),t.buildBufferObjects=(i,a)=>{const o=e.currentInput;if(!o)return;const s=o.getPointData()&&o.getPointData().getScalars();if(!s)return;const c=a.getProperty();if(!e.jitterTexture.getHandle()){const _=new Uint8Array(1024);for(let S=0;S<32*32;++S)_[S]=255*Math.random();e.jitterTexture.setMinificationFilter(lt.LINEAR),e.jitterTexture.setMagnificationFilter(lt.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Ot.UNSIGNED_CHAR,_)}const l=s.getNumberOfComponents(),f=t.useIndependentComponents(c),u=f?l:1,h=c.getScalarOpacity(),p=e._openGLRenderWindow.getGraphicsResourceForObject(h);let d=xa(h,f,u);if(!p?.oglObject||p.hash!==d){e.opacityTexture=fn.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,S=_*2*u,b=new Float32Array(S),D=new Float32Array(_);for(let E=0;E<u;++E){const R=c.getScalarOpacity(E),F=t.getCurrentSampleDistance(i)/c.getScalarOpacityUnitDistance(E),M=R.getRange();R.getTable(M[0],M[1],_,D,1);for(let U=0;U<_;++U)b[E*_*2+U]=1-(1-D[U])**F,b[E*_*2+U+_]=b[E*_*2+U]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(lt.LINEAR),e.opacityTexture.setMagnificationFilter(lt.LINEAR),e._openGLRenderWindow.getWebgl2()||e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(_,2*u,1,Ot.FLOAT,b);else{const E=new Uint8ClampedArray(S);for(let R=0;R<S;++R)E[R]=255*b[R];e.opacityTexture.create2DFromRaw(_,2*u,1,Ot.UNSIGNED_CHAR,E)}h&&(e._openGLRenderWindow.setGraphicsResourceForObject(h,e.opacityTexture,d),h!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(h,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=h)}else e.opacityTexture=p.oglObject;const y=c.getRGBTransferFunction();d=xa(y,f,u);const x=e._openGLRenderWindow.getGraphicsResourceForObject(y);if(!x?.oglObject?.getHandle()||x?.hash!==d){e.colorTexture=fn.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=1024,S=_*2*u*3,b=new Uint8ClampedArray(S),D=new Float32Array(_*3);for(let E=0;E<u;++E){const R=c.getRGBTransferFunction(E),F=R.getRange();R.getTable(F[0],F[1],_,D,1);for(let M=0;M<_*3;++M)b[E*_*6+M]=255*D[M],b[E*_*6+M+_*3]=255*D[M]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(lt.LINEAR),e.colorTexture.setMagnificationFilter(lt.LINEAR),e.colorTexture.create2DFromRaw(_,2*u,3,Ot.UNSIGNED_CHAR,b),y&&(e._openGLRenderWindow.setGraphicsResourceForObject(y,e.colorTexture,d),y!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(y,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=y)}else e.colorTexture=x.oglObject;t.updateLabelOutlineThicknessTexture(a);const v=e._openGLRenderWindow.getGraphicsResourceForObject(s);d=R1(o,s);const w=!v?.oglObject?.getHandle()||v?.hash!==d,C=e.renderable.getUpdatedExtents(),T=!!C.length;if(w&&!T){e.scalarTexture=fn.newInstance(),e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const _=o.getDimensions();e.scalarTexture.setOglNorm16Ext(e.context.getExtension("EXT_texture_norm16")),e.scalarTexture.resetFormatAndType(),e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s),s&&(e._openGLRenderWindow.setGraphicsResourceForObject(s,e.scalarTexture,d),s!==e._scalars&&(e._openGLRenderWindow.registerGraphicsResourceUser(s,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalars,t)),e._scalars=s)}else e.scalarTexture=v.oglObject;if(T){e.renderable.setUpdatedExtents([]);const _=o.getDimensions();e.scalarTexture.create3DFilterableFromDataArray(_[0],_[1],_[2],s,!1,C)}if(!e.tris.getCABO().getElementCount()){const _=new Float32Array(12);for(let E=0;E<4;E++)_[E*3]=E%2*2-1,_[E*3+1]=E>1?1:-1,_[E*3+2]=-1;const S=new Uint16Array(8);S[0]=3,S[1]=0,S[2]=1,S[3]=3,S[4]=3,S[5]=0,S[6]=3,S[7]=2;const b=ft.newInstance({numberOfComponents:3,values:_});b.setName("points");const D=ft.newInstance({numberOfComponents:1,values:S});e.tris.getCABO().createVBO(D,"polys",or.SURFACE,{points:b,cellOffset:0})}e.VBOBuildTime.modified()},t.updateLabelOutlineThicknessTexture=i=>{const a=i.getProperty().getLabelOutlineThickness(),o=e._openGLRenderWindow.getGraphicsResourceForObject(a),s=`${a.join("-")}`;if(!o?.oglObject?.getHandle()||o?.hash!==s){e.labelOutlineThicknessTexture=fn.newInstance(),e.labelOutlineThicknessTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const l=1024,f=1,u=l*f,h=new Uint8Array(u);for(let p=0;p<l;++p){const d=typeof a[p]<"u"?a[p]:a[0];h[p]=d}e.labelOutlineThicknessTexture.resetFormatAndType(),e.labelOutlineThicknessTexture.setMinificationFilter(lt.NEAREST),e.labelOutlineThicknessTexture.setMagnificationFilter(lt.NEAREST),e.labelOutlineThicknessTexture.create2DFromRaw(l,f,1,Ot.UNSIGNED_CHAR,h),a&&(e._openGLRenderWindow.setGraphicsResourceForObject(a,e.labelOutlineThicknessTexture,s),a!==e._labelOutlineThicknessArray&&(e._openGLRenderWindow.registerGraphicsResourceUser(a,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._labelOutlineThicknessArray,t)),e._labelOutlineThicknessArray=a)}else e.labelOutlineThicknessTexture=o.oglObject},t.isLabelmapOutlineRequired=i=>{const a=i.getProperty(),o=e.renderable;return a.getUseLabelOutline()||o.getBlendMode()===I0.LABELMAP_EDGE_PROJECTION_BLEND}}const HM={context:null,VBOBuildTime:null,scalarTexture:null,opacityTexture:null,opacityTextureString:null,colorTexture:null,colorTextureString:null,jitterTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,tris:null,framebuffer:null,copyShader:null,copyVAO:null,lastXYF:1,targetXYF:1,zBufferTexture:null,lastZBufferTexture:null,lightComplexity:0,fullViewportTime:1,idxToView:null,idxNormalMatrix:null,modelToView:null,projectionToView:null,avgWindowArea:0,avgFrameTime:0};function v8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HM,n),en.extend(t,e,n),ya.implementBuildShadersWithReplacements(t,e,n),e.VBOBuildTime={},an(e.VBOBuildTime,{mtime:0}),e.tris=Ca.newInstance(),e.jitterTexture=fn.newInstance(),e.jitterTexture.setWrapS(gl.REPEAT),e.jitterTexture.setWrapT(gl.REPEAT),e.framebuffer=Nh.newInstance(),e.idxToView=ut(new Float64Array(16)),e.idxNormalMatrix=wi(new Float64Array(9)),e.modelToView=ut(new Float64Array(16)),e.projectionToView=ut(new Float64Array(16)),e.projectionToWorld=ut(new Float64Array(16)),bn(t,e,["context"]),$M(t,e)}const y8=kt(v8,"vtkOpenGLVolumeMapper");var x8={newInstance:y8,extend:v8};An("vtkVolumeMapper",y8);const{vtkDebugMacro:KM}=sr;function qM(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const i=e._openGLRenderer.getAspectRatio(),a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,o=e._openGLRenderer.getTiledSizeAndOrigin();let s=null;if(e.renderable.getUseZValues()){const c=r.getZBufferTexture(),l=Math.floor(c.getWidth()),f=Math.floor(c.getHeight()),u=e._openGLRenderWindow.getContext();c.bind();const h=r.getFramebuffer();h?h.saveCurrentBindingsAndBuffers():KM("No framebuffer to save/restore");const p=u.createFramebuffer();u.bindFramebuffer(u.FRAMEBUFFER,p),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,c.getHandle(),0),u.checkFramebufferStatus(u.FRAMEBUFFER)===u.FRAMEBUFFER_COMPLETE&&(s=new Uint8Array(l*f*4),u.viewport(0,0,l,f),u.readPixels(0,0,l,f,u.RGBA,u.UNSIGNED_BYTE,s)),h&&h.restorePreviousBindingsAndBuffers(),u.deleteFramebuffer(p)}e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)},t.queryPass=(n,r)=>{n&&e.renderable.getUseZValues()&&r.requestDepth()}}const XM={};function YM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XM,n),en.extend(t,e,n),qM(t,e)}const w8=kt(YM,"vtkOpenGLPixelSpaceCallbackMapper");var JM={newInstance:w8};An("vtkPixelSpaceCallbackMapper",w8);const C8=Object.create(null);function Ci(t,e){C8[t]=e}function ZM(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}const QM={};function eN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QM,n),e.overrides=C8,b1.extend(t,e,n),ZM(t,e)}J.newInstance(eN,"vtkWebGPUViewNodeFactory");function tN(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=(n,r,i,a)=>{if(ut(n),e.renderable.getParallelProjection()){const o=e.renderable.getParallelScale(),s=o*r,c=o,l=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*c,h=(a[1]+1)*c,p=1/(f-l),d=1/(h-u);n[0]=2*p,n[5]=2*d,n[10]=1/(i[1]-i[0]),n[12]=(f+l)*p,n[13]=(h+u)*d,n[14]=i[1]/(i[1]-i[0])}else{const o=Math.tan(Math.PI*e.renderable.getViewAngle()/360);let s,c;e.renderable.getUseHorizontalViewAngle()===!0?(s=i[0]*o,c=i[0]*o/r):(s=i[0]*o*r,c=i[0]*o);const l=(a[0]-1)*s,f=(a[0]+1)*s,u=(a[1]-1)*c,h=(a[1]+1)*c;n[0]=2*i[0]/(f-l),n[5]=2*i[0]/(h-u),n[12]=(l+f)/(f-l),n[13]=(u+h)/(h-u),n[10]=0,n[14]=i[0],n[11]=-1,n[15]=0}},t.convertToOpenGLDepth=n=>{if(e.renderable.getParallelProjection())return 1-n;const r=e.renderable.getClippingRangeByReference();let i=-r[0]/n;return i=(r[0]+r[1])/(r[1]-r[0])+2*r[0]*r[1]/(i*(r[1]-r[0])),.5*i+.5},t.getKeyMatrices=n=>{const r=n.getRenderable(),i=n.getParent();if(Math.max(i.getMTime(),t.getMTime(),r.getMTime(),e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatrixTime.getMTime()){const a=e.renderable.getViewMatrix();pn(e.keyMatrices.normalMatrix,a),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Sn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Rt(e.keyMatrices.wcvc,a);const o=n.getStabilizedCenterByReference();hn(e.keyMatrices.scvc,e.keyMatrices.wcvc,o);const s=n.getAspectRatio(),c=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,s,c,e.renderable.getWindowCenterByReference()),It(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),Sn(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}const nN={keyMatrixTime:null,keyMatrices:null};function rN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nN,n),en.extend(t,e,n),e.keyMatrixTime={},J.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},J.setGet(t,e,["keyMatrixTime"]),tN(t,e)}const iN=J.newInstance(rN);Ci("vtkCamera",iN);function aN(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=n=>{if(e.bindables.length===n.length){let r=!0;for(let i=0;i<e.bindables.length;i++)e.bindables[i]!==n[i]&&(r=!1);if(r)return}e.bindables=n,t.modified()},t.getBindGroupLayout=n=>{const r=[];for(let i=0;i<e.bindables.length;i++){const a=e.bindables[i].getBindGroupLayoutEntry();a.binding=i,r.push(a)}return n.getBindGroupLayout({entries:r})},t.getBindGroup=n=>{let r=t.getMTime();for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupTime().getMTime();r=o>r?o:r}if(r<e.bindGroupTime.getMTime())return e.bindGroup;const i=[];for(let a=0;a<e.bindables.length;a++){const o=e.bindables[a].getBindGroupEntry();o.binding=a,i.push(o)}return e.bindGroup=n.getHandle().createBindGroup({layout:t.getBindGroupLayout(n),entries:i,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=n=>{const r=[],i=n.getBindGroupLayoutCount(e.label);for(let a=0;a<e.bindables.length;a++)r.push(e.bindables[a].getShaderCode(a,i));return r.join(`
`)}}const oN={device:null,handle:null,label:null};function T8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oN,n),J.obj(t,e),e.bindables=[],e.bindGroupTime={},J.obj(e.bindGroupTime,{mtime:0}),J.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),J.setGet(t,e,["label","device","arrayInformation"]),aN(t,e)}const sN=J.newInstance(T8);var _8={newInstance:sN,extend:T8};function cN(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=(n,r)=>{e.device=n,e.handle=e.device.getHandle().createShaderModule({code:r.getCode()})}}const uN={device:null,handle:null};function S8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uN,n),J.obj(t,e),J.get(t,e,["lastCameraMTime"]),J.setGet(t,e,["device","handle"]),cN(t,e)}const lN=J.newInstance(S8,"vtkWebGPUShaderModule");var fN={newInstance:lN,extend:S8};function hN(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const i=Array.isArray(n)?n.join(`
`):n;let a=!1;t.search(e)!==-1&&(a=!0);let o="";r&&(o="g");const s=new RegExp(e,o),c=t.replace(s,i);return{replace:a,result:c}}function pN(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=n=>{const r=n.getType(),i=n.getHash(),a=e._shaderModules.keys();for(let s=0;s<a.length;s++){const c=a[s];if(c.getHash()===i&&c.getType()===r)return e._shaderModules.get(c)}const o=fN.newInstance();return o.initialize(e.device,n),e._shaderModules.set(n,o),o}}const dN={shaderModules:null,device:null,window:null};function b8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dN,n),e._shaderModules=new Map,J.obj(t,e),J.setGet(t,e,["device","window"]),pN(t,e)}const gN=J.newInstance(b8,"vtkWebGPUShaderCache");var Yt={newInstance:gN,extend:b8,substitute:hN};function mN(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=()=>e.shaderDescriptions,t.initialize=(n,r)=>{e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=r;const i=[];for(let a=0;a<e.layouts.length;a++)i.push(e.layouts[a].layout);e.pipelineLayout=n.getHandle().createPipelineLayout({bindGroupLayouts:i}),e.pipelineDescription.layout=e.pipelineLayout;for(let a=0;a<e.shaderDescriptions.length;a++){const o=e.shaderDescriptions[a],s=n.getShaderModule(o);o.getType()==="vertex"&&(e.pipelineDescription.vertex.module=s.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),o.getType()==="fragment"&&(e.pipelineDescription.fragment.module=s.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=n.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=n=>{for(let r=0;r<e.shaderDescriptions.length;r++)if(e.shaderDescriptions[r].getType()===n)return e.shaderDescriptions[r];return null},t.addBindGroupLayout=n=>{n&&e.layouts.push({layout:n.getBindGroupLayout(e.device),label:n.getLabel()})},t.getBindGroupLayout=n=>e.layouts[n].layout,t.getBindGroupLayoutCount=n=>{for(let r=0;r<e.layouts.length;r++)if(e.layouts[r].label===n)return r;return 0},t.bindVertexInput=(n,r)=>{r.bindBuffers(n)}}const vN={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function E8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vN,n),an(t,e),e.layouts=[],e.shaderDescriptions=[],mr(t,e,["handle","pipelineDescription"]),bn(t,e,["device","renderEncoder","topology","vertexState"]),mN(t,e)}const yN=kt(E8,"vtkWebGPUPipeline");var xN={newInstance:yN,extend:E8};function wN(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=n=>e.outputNames.includes(n),t.addOutput=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(n),e.outputNames.push(r),e.outputInterpolations.push(i)},t.addBuiltinOutput=(n,r)=>{e.builtinOutputTypes.push(n),e.builtinOutputNames.push(r)},t.addBuiltinInput=(n,r)=>{e.builtinInputTypes.push(n),e.builtinInputNames.push(r)},t.replaceShaderCode=(n,r)=>{const i=[];let a=[];if(r&&i.push(r.getShaderCode()),n||e.builtinInputNames.length){const o=[];if(o.push(`struct ${e.type}Input
{`),n){const s=n.getOutputNamesByReference(),c=n.getOutputTypesByReference(),l=n.getOutputInterpolationsByReference();for(let f=0;f<s.length;f++)l[f]!==void 0?o.push(`  @location(${f}) @interpolate(${l[f]}) ${s[f]} : ${c[f]},`):o.push(`  @location(${f}) ${s[f]} : ${c[f]},`)}for(let s=0;s<e.builtinInputNames.length;s++)o.push(`  ${e.builtinInputNames[s]} : ${e.builtinInputTypes[s]},`);o.length>1&&(o.push("};"),a=o,i[i.length-1]+=",",i.push(`input: ${e.type}Input`))}if(i.length&&(e.code=Yt.substitute(e.code,"//VTK::IOStructs::Input",i).result),e.outputNames.length+e.builtinOutputNames.length){const o=[`struct ${e.type}Output
{`];for(let s=0;s<e.outputNames.length;s++)e.outputInterpolations[s]!==void 0?o.push(`  @location(${s}) @interpolate(${e.outputInterpolations[s]}) ${e.outputNames[s]} : ${e.outputTypes[s]},`):o.push(`  @location(${s}) ${e.outputNames[s]} : ${e.outputTypes[s]},`);for(let s=0;s<e.builtinOutputNames.length;s++)o.push(`  ${e.builtinOutputNames[s]} : ${e.builtinOutputTypes[s]},`);o.push("};"),a=a.concat(o),e.code=Yt.substitute(e.code,"//VTK::IOStructs::Output",[`-> ${e.type}Output`]).result}e.code=Yt.substitute(e.code,"//VTK::IOStructs::Dec",a).result}}const CN={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function D8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CN,n),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],J.obj(t,e),J.setGet(t,e,["type","hash","code"]),J.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),wN(t,e)}const TN=J.newInstance(D8,"vtkWebGPUShaderDescription");var cv={newInstance:TN,extend:D8};const uv={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function _N(t){return!t||t.length<6?0:t in uv?uv[t]:(At(`unknown format ${t}`),null)}function SN(t){if(!t||t.length<5)return 0;let e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));const n=e===1?t.length-1:t.length-3,r=Number(t[n]);if(Number.isNaN(r))return At(`unknown format ${t}`),0;const i=5-r/2;return e*i}function bN(t){if(!t||t.length<5)return 0;let e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function EN(t){if(!t||t.length<5)return 0;let e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{At(`unknown format ${t}`);return}const n=t.split("x")[0],r=Number(n[n.length-1]);if(Number.isNaN(r)){At(`unknown format ${t}`);return}return e+=8*(5-r/2),e+="Array",e}function DN(t){let e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{At(`unknown format ${t}`);return}let n=1;return t[t.length-2]==="x"&&(n=Number(t[t.length-1])),n===4?`vec4<${e}>`:n===3?`vec3<${e}>`:n===2?`vec2<${e}>`:e}function ON(t){if(!t)return 0;let e=1;return t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]),e*4}function RN(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";At(`unknown format ${t}`)}}var ir={getDetailsFromTextureFormat:_N,getByteStrideFromBufferFormat:SN,getNumberOfComponentsFromBufferFormat:bN,getNativeTypeFromBufferFormat:EN,getShaderTypeFromBufferFormat:DN,getByteStrideFromShaderFormat:ON,getNativeTypeFromShaderFormat:RN};function MN(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!e.includes(t[n]))return!1;return!0}function NN(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",a=r;Array.isArray(a)||(a=[a]);for(let o=0;o<e.inputs.length;o++)if(MN(e.inputs[o].names,a)){if(e.inputs[o].buffer===n)return;e.inputs[o].buffer=n;return}e.inputs.push({buffer:n,stepMode:i,names:a}),e.inputs=e.inputs.sort((o,s)=>o.names[0]<s.names[0]?-1:o.names[0]>s.names[0]?1:0)},t.removeBufferIfPresent=n=>{for(let r=0;r<e.inputs.length;r++)e.inputs[r].names.includes(n)&&e.inputs.splice(r,1)},t.getBuffer=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer;return null},t.hasAttribute=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return!0;return!1},t.getAttributeTime=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer.getSourceTime();return 0},t.getShaderCode=()=>{let n="",r=0;for(let i=0;i<e.inputs.length;i++)for(let a=0;a<e.inputs[i].names.length;a++){const o=e.inputs[i].buffer.getArrayInformation()[a],s=ir.getShaderTypeFromBufferFormat(o.format);r>0&&(n+=`,
`),n=`${n}  @location(${r}) ${e.inputs[i].names[a]} : ${s}`,r++}return n},t.getVertexInputInformation=()=>{const n={};if(e.inputs.length){const r=[];let i=0;for(let a=0;a<e.inputs.length;a++){const o=e.inputs[a].buffer,s={arrayStride:o.getStrideInBytes(),stepMode:e.inputs[a].stepMode,attributes:[]},c=o.getArrayInformation();for(let l=0;l<e.inputs[a].names.length;l++)s.attributes.push({shaderLocation:i,offset:c[l].offset,format:c[l].format}),i++;r.push(s)}n.buffers=r}return n},t.bindBuffers=n=>{for(let r=0;r<e.inputs.length;r++)n.setVertexBuffer(r,e.inputs[r].buffer.getHandle());e.indexBuffer&&n.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=()=>{},t.releaseGraphicsResources=()=>{e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}const LN={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function O8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LN,n),an(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],bn(t,e,["created","device","handle","indexBuffer"]),NN(t,e)}const AN=kt(O8,"vtkWebGPUVertexInput");var FN={newInstance:AN,extend:O8};const IN=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,PN=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function VN(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=(n,r,i)=>{const a=cv.newInstance({type:"vertex",hash:n,code:e.vertexShaderTemplate}),o=cv.newInstance({type:"fragment",hash:n,code:e.fragmentShaderTemplate}),s=r.getShaderDescriptions();s.push(a),s.push(o);const c=e.vertexShaderTemplate+e.fragmentShaderTemplate,l=new RegExp("//VTK::[^:]*::","g"),u=c.match(l).filter((h,p,d)=>d.indexOf(h)===p).map(h=>`replaceShader${h.substring(7,h.length-2)}`);for(let h=0;h<u.length;h++){const p=u[h];p!=="replaceShaderIOStructs"&&e.shaderReplacements.has(p)&&e.shaderReplacements.get(p)(n,r,i)}t.replaceShaderIOStructs(n,r,i)},t.replaceShaderIOStructs=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.replaceShaderCode(null,i),r.getShaderDescription("fragment").replaceShaderCode(a)},t.replaceShaderRenderEncoder=(n,r,i)=>{e.renderEncoder.replaceShaderCode(r)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=(n,r,i)=>{if(!e.WebGPURenderer)return;const a=e.WebGPURenderer.getBindGroup().getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=Yt.substitute(s,"//VTK::Renderer::Dec",[a]).result,o.setCode(s);const c=r.getShaderDescription("fragment");s=c.getCode(),s=Yt.substitute(s,"//VTK::Renderer::Dec",[a]).result,c.setCode(s)},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=(n,r,i)=>{const a=e.bindGroup.getShaderCode(r),o=r.getShaderDescription("vertex");let s=o.getCode();s=Yt.substitute(s,"//VTK::Mapper::Dec",[a]).result,o.setCode(s);const c=r.getShaderDescription("fragment");c.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),s=c.getCode(),s=Yt.substitute(s,"//VTK::Mapper::Dec",[a]).result,c.setCode(s)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let o=a.getCode();o=Yt.substitute(o,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(n,r,i)=>{r.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=n=>{e.textureViews.includes(n)||e.textureViews.push(n)},t.prepareToDraw=n=>{e.renderEncoder=n,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=()=>{},t.updateBuffers=()=>{},t.updateBindings=()=>{e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=()=>{},t.registerDrawCallback=n=>{n.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=n=>{t.prepareToDraw(n),n.setPipeline(e.pipeline),t.draw(n)},t.draw=n=>{const r=n.getBoundPipeline();n.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(n),r.bindVertexInput(n,e.vertexInput);const i=e.vertexInput.getIndexBuffer();i?n.drawIndexed(i.getIndexCount(),e.numberOfInstances,0,0,0):n.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=()=>{const n=[...e.additionalBindables];e.UBO&&n.push(e.UBO),e.SSBO&&n.push(e.SSBO);for(let r=0;r<e.textureViews.length;r++){n.push(e.textureViews[r]);const i=e.textureViews[r].getSampler();i&&n.push(i)}return n},t.updatePipeline=()=>{t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=xN.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}const kN={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function R8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kN,n),en.extend(t,e,n),e.textureViews=[],e.vertexInput=FN.newInstance(),e.bindGroup=_8.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||PN,e.vertexShaderTemplate=e.vertexShaderTemplate||IN,e.shaderReplacements=new Map,J.get(t,e,["pipeline","vertexInput"]),J.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),VN(t,e)}const UN=J.newInstance(R8,"vtkWebGPUSimpleMapper");var M8={newInstance:UN,extend:R8};function BN(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();o=Yt.substitute(o,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=()=>{const n=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(n,["vertexBC"]),e.numberOfVertices=6}}const GN={};function N8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GN,n),M8.extend(t,e,n),BN(t,e)}const WN=J.newInstance(N8,"vtkWebGPUFullScreenQuad");var Hd={newInstance:WN,extend:N8};const zN={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},jN={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6};var Bl={BufferUsage:zN,PrimitiveTypes:jN};const bp=["getMappedRange","mapAsync","unmap"];function $N(t,e,n,r){const i=r.byteLength,a=t.createBuffer({size:i,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),o=a.getMappedRange(0,i);new Uint8Array(o).set(new Uint8Array(r)),a.unmap();const s=t.createCommandEncoder();s.copyBufferToBuffer(a,0,e,n,i);const c=s.finish();t.queue.submit([c]),a.destroy()}function HN(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n,usage:r,label:e.label}),e.sizeInBytes=n,e.usage=r},t.write=n=>{$N(e.device.getHandle(),e.handle,0,n.buffer)},t.createAndWrite=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n.byteLength,usage:r,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=n.byteLength,e.usage=r,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(n.buffer)),e.handle.unmap()};for(let n=0;n<bp.length;n++)t[bp[n]]=function(){return e.handle[bp[n]](...arguments)}}const KN={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function L8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KN,n),J.obj(t,e),J.get(t,e,["handle","sizeInBytes","usage"]),J.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),HN(t,e)}const qN=J.newInstance(L8);var Kd={newInstance:qN,extend:L8,...Bl};const{Representation:Mu,Interpolation:Nu}=Jx;function lv(t){return()=>J.vtkErrorMacro(`vtkProperty::${t} - NOT IMPLEMENTED`)}function XN(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=(n,r,i)=>{Array.isArray(n)?(e.color[0]!==n[0]||e.color[1]!==n[1]||e.color[2]!==n[2])&&(e.color[0]=n[0],e.color[1]=n[1],e.color[2]=n[2],t.modified()):(e.color[0]!==n||e.color[1]!==r||e.color[2]!==i)&&(e.color[0]=n,e.color[1]=r,e.color[2]=i,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=lv("ComputeCompositeColor"),t.getColor=()=>{let n=0;e.ambient+e.diffuse+e.specular>0&&(n=1/(e.ambient+e.diffuse+e.specular));for(let r=0;r<3;r++)e.color[r]=n*(e.ambient*e.ambientColor[r]+e.diffuse*e.diffuseColor[r]+e.specular*e.specularColor[r]);return[].concat(e.color)},t.setSpecularPower=n=>{const r=1/Math.max(1,n);(e.roughness!==r||e.specularPower!==n)&&(e.specularPower=n,e.roughness=r,t.modified())},t.addShaderVariable=lv("AddShaderVariable"),t.setInterpolationToFlat=()=>t.setInterpolation(Nu.FLAT),t.setInterpolationToGouraud=()=>t.setInterpolation(Nu.GOURAUD),t.setInterpolationToPhong=()=>t.setInterpolation(Nu.PHONG),t.getInterpolationAsString=()=>J.enumToString(Nu,e.interpolation),t.setRepresentationToWireframe=()=>t.setRepresentation(Mu.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(Mu.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(Mu.POINTS),t.getRepresentationAsString=()=>J.enumToString(Mu,e.representation)}const YN={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:Nu.GOURAUD,representation:Mu.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function A8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YN,n),J.obj(t,e),J.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),J.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),XN(t,e)}const JN=J.newInstance(A8,"vtkProperty");var pc={newInstance:JN,extend:A8,...Jx};const{Representation:fv}=pc,{PrimitiveTypes:Uo}=Bl;class ZN{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return!0}get(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return this.values[n]}set(e,n){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=n)}}function QN(t){switch(t){case Uo.Points:return"points";case Uo.Lines:return"lines";case Uo.Triangles:case Uo.TriangleEdges:return"polys";case Uo.TriangleStripEdges:case Uo.TriangleStrips:return"strips";default:return""}}function s0(t,e,n){let r=t.pointIdToFlatId[e];return r<0&&(r=t.flatId,t.pointIdToFlatId[e]=r,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=n,t.flatId++),r}function eL(t,e,n){const r=t.length;for(let o=0;o<r;o++){let s=t[o];if(n.cellProvokedMap.has(s)){n.ibo[n.iboId++]=n.cellProvokedMap.get(s);for(let c=o+1;c<o+r;c++){s=t[c%r];const l=s0(n,s,e);n.ibo[n.iboId++]=l}return}}for(let o=0;o<r;o++){let s=t[o];if(!n.provokedPointIds[s]){let c=s0(n,s,e);n.provokedPointIds[s]=1,n.cellProvokedMap.set(s,c),n.flatIdToCellId[c]=e,n.ibo[n.iboId++]=c;for(let l=o+1;l<o+r;l++)s=t[l%r],c=s0(n,s,e),n.ibo[n.iboId++]=c;return}}let i=t[0],a=n.flatId;n.cellProvokedMap.set(i,a),n.flatIdToPointId[n.flatId]=i,n.flatIdToCellId[n.flatId]=e,n.flatId++,n.ibo[n.iboId++]=a;for(let o=1;o<r;o++)i=t[o],a=s0(n,i,e),n.ibo[n.iboId++]=a}function tL(t,e,n){const r=t.length;n.iboSize+=r;for(let i=0;i<r;i++){const a=t[i];if(n.cellProvokedMap.has(a))return}for(let i=0;i<r;i++){const a=t[i];if(!n.provokedPointIds[a]){n.provokedPointIds[a]=1,n.cellProvokedMap.set(a,1);return}}n.cellProvokedMap.set(t[0],1),n.extraPoints++}let Ba;const hv=new Uint32Array(1),hi=new Uint32Array(2),No=new Uint32Array(3),Ep={anythingToPoints(t,e,n,r,i){for(let a=0;a<t;++a)hv[0]=e[n+a],Ba(hv,r,i)},linesToWireframe(t,e,n,r,i){for(let a=0;a<t-1;++a)hi[0]=e[n+a],hi[1]=e[n+a+1],Ba(hi,r,i)},polysToWireframe(t,e,n,r,i){if(t>2)for(let a=0;a<t;++a)hi[0]=e[n+a],hi[1]=e[n+(a+1)%t],Ba(hi,r,i)},stripsToWireframe(t,e,n,r,i){if(t>2){for(let a=0;a<t-1;++a)hi[0]=e[n+a],hi[1]=e[n+a+1],Ba(hi,r,i);for(let a=0;a<t-2;a++)hi[0]=e[n+a],hi[1]=e[n+a+2],Ba(hi,r,i)}},polysToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)No[0]=e[n],No[1]=e[n+a+1],No[2]=e[n+a+2],Ba(No,r,i)},stripsToSurface(t,e,n,r,i){for(let a=0;a<t-2;a++)No[0]=e[n+a],No[1]=e[n+a+1+a%2],No[2]=e[n+a+1+(a+1)%2],Ba(No,r,i)}};function nL(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=n=>{const r=n.cells,i=n.primitiveType,a=n.representation,o=n.cellOffset,s=r.getData(),c=s.length,l=QN(i),f=n.numberOfPoints,u={provokedPointIds:new Uint8Array(f),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new ZN};let h=null;a===fv.POINTS||i===Uo.Points?h=Ep.anythingToPoints:a===fv.WIREFRAME||i===Uo.Lines?h=Ep[`${l}ToWireframe`]:h=Ep[`${l}ToSurface`],Ba=tL;let p=o||0;for(let d=0;d<c;)u.cellProvokedMap.clear(),h(s[d],s,d+1,p,u),d+=s[d]+1,p++;f<=65535?u.flatIdToPointId=new Uint16Array(f+u.extraPoints):u.flatIdToPointId=new Uint32Array(f+u.extraPoints),f+u.extraPoints<36863?u.pointIdToFlatId=new Int16Array(f):u.pointIdToFlatId=new Int32Array(f),f+u.extraPoints<=65535?(u.ibo=new Uint16Array(u.iboSize),n.format="uint16"):(u.ibo=new Uint32Array(u.iboSize),n.format="uint32"),p<=65535?u.flatIdToCellId=new Uint16Array(f+u.extraPoints):u.flatIdToCellId=new Uint32Array(f+u.extraPoints),u.pointIdToFlatId.fill(-1),u.provokedPointIds.fill(0),Ba=eL,p=o||0;for(let d=0;d<c;)u.cellProvokedMap.clear(),h(s[d],s,d+1,p,u),d+=s[d]+1,p++;delete u.provokedPointIds,delete u.pointIdToFlatId,n.nativeArray=u.ibo,e.flatIdToPointId=u.flatIdToPointId,e.flatIdToCellId=u.flatIdToCellId,e.flatSize=u.flatId,e.indexCount=u.iboId}}const rL={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function F8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rL,n),Kd.extend(t,e,n),J.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),nL(t,e)}const iL=J.newInstance(F8);var aL={newInstance:iL,extend:F8,...Bl};const{BufferUsage:Lo}=Bl,{vtkErrorMacro:oL}=sr,{VtkDataTypes:As}=ft,sL={};function cL(t){let e;switch(t.getDataType()){case As.UNSIGNED_CHAR:e="uint8";break;case As.FLOAT:e="float32";break;case As.UNSIGNED_INT:e="uint32";break;case As.INT:e="sint32";break;case As.DOUBLE:e="float32";break;case As.UNSIGNED_SHORT:e="uint16";break;case As.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||oL(`unsupported x3 type for ${e}`),e+="x3";break;case 4:e+="x4";break}return e}function pv(t,e,n,r,i){const a={},o=t.getFlatSize();if(!o)return a;let s=[0,0,0,0];i.shift&&(i.shift.length?s=i.shift:s.fill(i.shift));let c=[1,1,1,1];i.scale&&(i.scale.length?c=i.scale:c.fill(i.scale));const l=Object.prototype.hasOwnProperty.call(i,"packExtra")?i.packExtra:!1;let f,u=0;const h=n+(l?1:0),p=Qc(r,o*h);let d=t.getFlatIdToPointId();i.cellData&&(d=t.getFlatIdToCellId()),n===1?f=function(y){p[u++]=c[0]*e[y]+s[0]}:n===2?f=function(y){p[u++]=c[0]*e[y]+s[0],p[u++]=c[1]*e[y+1]+s[1]}:n===3&&!l?f=function(y){p[u++]=c[0]*e[y]+s[0],p[u++]=c[1]*e[y+1]+s[1],p[u++]=c[2]*e[y+2]+s[2]}:n===3&&l?f=function(y){p[u++]=c[0]*e[y]+s[0],p[u++]=c[1]*e[y+1]+s[1],p[u++]=c[2]*e[y+2]+s[2],p[u++]=c[3]*1+s[3]}:n===4&&(f=function(y){p[u++]=c[0]*e[y]+s[0],p[u++]=c[1]*e[y+1]+s[1],p[u++]=c[2]*e[y+2]+s[2],p[u++]=c[3]*e[y+3]+s[3]});for(let g=0;g<o;g++){const y=n*d[g];f(y)}return a.nativeArray=p,a}function uL(t,e,n,r){const i=[t[r*3]-t[n*3],t[r*3+1]-t[n*3+1],t[r*3+2]-t[n*3+2]],a=[t[e*3]-t[n*3],t[e*3+1]-t[n*3+1],t[e*3+2]-t[n*3+2]],o=[];return ga(i,a,o),oc(o),o}function lL(t,e){const n=e.getData(),r=t.getData();if(!r||!n)return null;const i=new Int8Array(t.getNumberOfCells()*4),a=r.length;let o=0;for(let s=0;s<a;){const c=uL(n,r[s+1],r[s+2],r[s+3]);i[o++]=127*c[0],i[o++]=127*c[1],i[o++]=127*c[2],i[o++]=127,s+=r[s]+1}return i}function fL(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function n(r){r.dataArray&&!r.nativeArray&&(r.nativeArray=r.dataArray.getData());let i,a;if(r.usage===Lo.Index&&(i=aL.newInstance({label:r.label}),i.setDevice(e.device),a=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,i.buildIndexBuffer(r),i.createAndWrite(r.nativeArray,a),i.setArrayInformation([{format:r.format}])),i||(i=Kd.newInstance({label:r.label}),i.setDevice(e.device)),r.usage===Lo.UniformArray&&(a=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===Lo.Storage&&(a=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,i.createAndWrite(r.nativeArray,a)),r.usage===Lo.Texture&&(a=GPUBufferUsage.COPY_SRC,i.createAndWrite(r.nativeArray,a)),r.usage===Lo.PointArray){a=GPUBufferUsage.VERTEX;const o=ir.getNativeTypeFromBufferFormat(r.format),s=pv(r.indexBuffer,r.dataArray.getData(),r.dataArray.getNumberOfComponents(),o,{packExtra:r.packExtra,shift:r.shift,scale:r.scale,cellData:r.cellData,cellOffset:r.cellOffset});i.createAndWrite(s.nativeArray,a),i.setStrideInBytes(ir.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:r.cellData?"flat":"perspective"}])}if(r.usage===Lo.NormalsFromPoints){a=GPUBufferUsage.VERTEX;const o=ir.getNativeTypeFromBufferFormat(r.format),s=lL(r.cells,r.dataArray),c=pv(r.indexBuffer,s,4,o,{cellData:!0});i.createAndWrite(c.nativeArray,a),i.setStrideInBytes(ir.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format,interpolation:"flat"}])}return r.usage===Lo.RawVertex&&(a=GPUBufferUsage.VERTEX,i.createAndWrite(r.nativeArray,a),i.setStrideInBytes(ir.getByteStrideFromBufferFormat(r.format)),i.setArrayInformation([{offset:0,format:r.format}])),i.setSourceTime(r.time),i}t.hasBuffer=r=>e.device.hasCachedObject(r),t.getBuffer=r=>r.hash?e.device.getCachedObject(r.hash,n,r):n(r),t.getBufferForPointArray=(r,i)=>{const a=cL(r),o={hash:`${r.getMTime()}I${i.getMTime()}${a}`,usage:Lo.PointArray,format:a,dataArray:r,indexBuffer:i};return t.getBuffer(o)},t.getFullScreenQuadBuffer=()=>{if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=Kd.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);const r=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(r,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}const hL={device:null,fullScreenQuadBuffer:null};function pL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hL,n),an(t,e),bn(t,e,["device"]),fL(t,e)}kt(pL);var ru={...sL,...Bl};const{BufferUsage:dL}=ru,{vtkErrorMacro:vc}=J;function gL(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){vc(`entry named ${n} already exists`);return}e._bufferEntryNames.set(n,e.bufferEntries.length);const i=ir.getByteStrideFromShaderFormat(r);e.bufferEntries.push({name:n,type:r,sizeInBytes:i,offset:e.sizeInBytes,nativeType:ir.getNativeTypeFromShaderFormat(r)}),e.sizeInBytes+=i},t.send=n=>{if(!e._buffer){const r={nativeArray:e.Float32Array,usage:dL.Storage,label:e.label};e._buffer=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e._sendTime.modified();return}n.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[n]=J.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){vc(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType];s[(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT]=i},t.setArray=(n,r,i)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){vc(`entry named ${n} not found in UBO`);return}const o=e.bufferEntries[a];t.createView(o.nativeType);const s=e[o.nativeType],c=(o.offset+r*e.sizeInBytes)/s.BYTES_PER_ELEMENT;for(let l=0;l<i.length;l++)s[c+l]=i[l]},t.setAllInstancesFromArray=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){vc(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const l=(a.offset+c*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[l+f]=r[c*s+f]}},t.setAllInstancesFromArrayColorToFloat=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){vc(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const l=(a.offset+c*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<s;f++)o[l+f]=r[c*s+f]/255}},t.setAllInstancesFromArray3x3To4x4=(n,r)=>{const i=e._bufferEntryNames.get(n);if(i===void 0){vc(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType],s=9;for(let c=0;c<e.numberOfInstances;c++){const l=(a.offset+c*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let f=0;f<3;f++)for(let u=0;u<3;u++)o[l+f*4+u]=r[c*s+f*3+u]}},t.getSendTime=()=>e._sendTime.getMTime(),t.getShaderCode=(n,r)=>{const i=[`struct ${e.label}StructEntry
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`
};
struct ${e.label}Struct
{
  values: array<${e.label}StructEntry>,
};
@binding(${n}) @group(${r}) var<storage, read> ${e.label}: ${e.label}Struct;
`),i.join(`
`)},t.getBindGroupEntry=()=>({resource:{buffer:e._buffer.getHandle()}}),t.clearData=()=>{e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}const mL={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function I8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mL,n),J.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},J.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},J.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},J.get(t,e,["bindGroupTime"]),J.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),gL(t,e)}const vL=J.newInstance(I8,"vtkWebGPUStorageBuffer");var yL={newInstance:vL,extend:I8};const{BufferUsage:xL}=ru,{vtkErrorMacro:Dp}=J;function wL(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){Dp(`entry named ${n} already exists`);return}e.sortDirty=!0,e._bufferEntryNames.set(n,e.bufferEntries.length),e.bufferEntries.push({name:n,type:r,sizeInBytes:ir.getByteStrideFromShaderFormat(r),offset:-1,nativeType:ir.getNativeTypeFromShaderFormat(r),packed:!1})},t.sortBufferEntries=()=>{if(!e.sortDirty)return;let n=0;const r=[];let i=4;for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.sizeInBytes%16===0&&(i=Math.max(16,i)),o.sizeInBytes%8===0&&(i=Math.max(8,i))}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(o.packed===!1&&o.sizeInBytes===12)for(let s=0;s<e.bufferEntries.length;s++){const c=e.bufferEntries[s];if(c.packed===!1&&c.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0)for(let s=a+1;s<e.bufferEntries.length;s++){const c=e.bufferEntries[s];if(!c.packed&&c.sizeInBytes%8===0){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];if(!o.packed&&o.sizeInBytes%8===0){let s=!1;for(let c=0;!s&&c<e.bufferEntries.length;c++){const l=e.bufferEntries[c];if(!l.packed&&l.sizeInBytes===4)for(let f=c+1;f<e.bufferEntries.length;f++){const u=e.bufferEntries[f];if(!u.packed&&u.sizeInBytes===4){o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes,l.packed=!0,l.offset=n,r.push(l),n+=l.sizeInBytes,u.packed=!0,u.offset=n,r.push(u),n+=u.sizeInBytes,s=!0;break}}}}}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];!o.packed&&o.sizeInBytes>4&&(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];o.packed||(o.packed=!0,o.offset=n,r.push(o),n+=o.sizeInBytes)}e.bufferEntries=r,e._bufferEntryNames.clear();for(let a=0;a<e.bufferEntries.length;a++)e._bufferEntryNames.set(e.bufferEntries[a].name,a);e.sizeInBytes=n,e.sizeInBytes=i*Math.ceil(e.sizeInBytes/i),e.sortDirty=!1},t.sendIfNeeded=n=>{if(!e.UBO){const r={nativeArray:e.Float32Array,usage:xL.UniformArray,label:e.label};e.UBO=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(n.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[n]=J.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){Dp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];a.lastValue!==r&&(o[a.offset/o.BYTES_PER_ELEMENT]=r,e.sendDirty=!0),a.lastValue=r},t.setArray=(n,r)=>{t.sortBufferEntries();const i=e._bufferEntryNames.get(n);if(i===void 0){Dp(`entry named ${n} not found in UBO`);return}const a=e.bufferEntries[i];t.createView(a.nativeType);const o=e[a.nativeType];let s=!1;for(let c=0;c<r.length;c++)(!a.lastValue||a.lastValue[c]!==r[c])&&(o[a.offset/o.BYTES_PER_ELEMENT+c]=r[c],s=!0);s&&(e.sendDirty=!0,a.lastValue=[...r])},t.getBindGroupEntry=()=>({resource:{buffer:e.UBO.getHandle()}}),t.getSendTime=()=>e.sendTime.getMTime(),t.getShaderCode=(n,r)=>{t.sortBufferEntries();const i=[`struct ${e.label}Struct
{`];for(let a=0;a<e.bufferEntries.length;a++){const o=e.bufferEntries[a];i.push(`  ${o.name}: ${o.type},`)}return i.push(`};
@binding(${n}) @group(${r}) var<uniform> ${e.label}: ${e.label}Struct;`),i.join(`
`)}}const CL={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function P8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CL,n),J.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},J.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},J.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,J.get(t,e,["binding","bindGroupTime"]),J.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),wL(t,e)}const TL=J.newInstance(P8,"vtkWebGPUUniformBuffer");var Ic={newInstance:TL,extend:P8};const{vtkDebugMacro:_L}=sr,dv=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,SL=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,c0=new Float64Array(16),gv=new Float64Array(16);function bL(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function EL(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=()=>{const n=e.camera.getClippingRange(),r=e.camera.getPositionByReference(),i=e.camera.getDirectionOfProjectionByReference(),a=[],o=[];lr(o,i,.5*(n[0]+n[1])),vi(a,r,o),Bn(o,a,e.stabilizedCenter),N4(o)/(n[1]-n[0])>e.recenterThreshold&&(e.stabilizedCenter=a,e.stabilizedTime.modified())},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let i=0;i<r.length;++i)r[i].getSwitch()>0&&n++;return n||(_L("No lights are on, creating one."),e.renderable.createLight()),n},t.updateUBO=()=>{const n=e.UBO.getSendTime();if(e._parent.getMTime()>n||t.getMTime()>n||e.camera.getMTime()>n||e.renderable.getMTime()>n){const r=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",r.wcvc),e.UBO.setArray("SCPCMatrix",r.scpc),e.UBO.setArray("PCSCMatrix",r.pcsc),e.UBO.setArray("SCVCMatrix",r.scvc),e.UBO.setArray("VCPCMatrix",r.vcpc),e.UBO.setArray("WCVCNormals",r.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",e.renderable.getEnvironmentTexture()?.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());const i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());const a=e._parent.getDevice();e.UBO.sendIfNeeded(a)}},t.updateSSBO=()=>{const n=e.renderable.getLights(),r=e.webgpuCamera.getKeyMatrices(t);let i=`${e.renderable.getMTime()}`;for(let a=0;a<n.length;a++)i+=n[a].getMTime();if(i!==e.lightTimeString){const a=new Float32Array(n.length*4),o=new Float32Array(n.length*4),s=new Float32Array(n.length*4),c=new Float32Array(n.length*4);for(let f=0;f<n.length;f++){const u=f*4,h=n[f].getPosition();Dt(h,h,r.wcvc),a[u]=h[0],a[u+1]=h[1],a[u+2]=h[2],a[u+3]=0,o[u]=-n[f].getDirection()[0],o[u+1]=-n[f].getDirection()[1],o[u+2]=-n[f].getDirection()[2],o[u+3]=0,s[u]=n[f].getColor()[0],s[u+1]=n[f].getColor()[1],s[u+2]=n[f].getColor()[2],s[u+3]=n[f].getIntensity()*5,c[u]=bL(n[f]),c[u+1]=Math.cos(Cn(n[f].getConeAngle())),c[u+2]=Math.cos(Cn(n[f].getConeAngle()+n[f].getConeFalloff())),c[u+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(n.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",a),e.SSBO.setAllInstancesFromArray("LightDir",o),e.SSBO.setAllInstancesFromArray("LightColor",s),e.SSBO.setAllInstancesFromArray("LightData",c);const l=e._parent.getDevice();e.SSBO.send(l)}e.lightTimeString=i},t.scissorAndViewport=n=>{const r=t.getYInvertedTiledSizeAndOrigin();n.getHandle().setViewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize,0,1),n.getHandle().setScissorRect(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)},t.bindUBO=n=>{n.activateBindGroup(e.bindGroup)},t.opaquePass=n=>{n?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=()=>{if(e.renderable.getTransparent()||e.suppressClear)return;const n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=Hd.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(dv);const a=Ic.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&e.backgroundTex?.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(SL);const a=Ic.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a);const o=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(o.getReady()){const s=o.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([s]),e.backgroundTexLoaded=!0;const c=e.backgroundTex.getInterpolate()?"linear":"nearest";s.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:c,magFilter:c,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=Hd.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(dv);const a=Ic.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a)}const r=e.webgpuCamera.getKeyMatrices(t),i=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",i),Rt(gv,r.normalMatrix),Df(c0,r.scvc,r.pcsc),Df(c0,gv,c0),e.clearFSQ.getUBO().setArray("FSQMatrix",c0),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)},t.translucentPass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.convertToOpenGLDepth=n=>e.webgpuCamera.convertToOpenGLDepth(n),t.getYInvertedTiledSizeAndOrigin=()=>{const n=t.getTiledSizeAndOrigin(),r=e._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],i=n[0]-r[0],a=n[1]-r[1],o=e._parent.normalizedDisplayToDisplay(i,a),s=Math.round(o[0]),c=Math.round(o[1]),l=n[2]-r[0],f=n[3]-r[1],u=e._parent.normalizedDisplayToDisplay(l,f);let h=Math.round(u[0])-s,p=Math.round(u[1])-c;return h<0&&(h=0),p<0&&(p=0),{usize:h,vsize:p,lowerLeftU:s,lowerLeftV:c}},t.getPropFromID=n=>{for(let r=0;r<e.children.length;r++)if((e.children[r].getPropID?e.children[r].getPropID():-1)===n)return e.children[r];return null},t.getStabilizedTime=()=>e.stabilizedTime.getMTime(),t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources()}}const DL={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function OL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DL,n),en.extend(t,e,n),e.UBO=Ic.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=yL.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=_8.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=ut(new Float64Array(16)),e.stabilizedTime={},an(e.stabilizedTime,{mtime:0}),mr(t,e,["bindGroup","stabilizedTime"]),eu(t,e,["stabilizedCenter"]),bn(t,e,["renderEncoder","selector","suppressClear","UBO"]),EL(t,e)}const RL=kt(OL,"vtkWebGPURenderer");Ci("vtkRenderer",RL);function ML(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=n,e.options.addressModeU=r.addressModeU?r.addressModeU:"clamp-to-edge",e.options.addressModeV=r.addressModeV?r.addressModeV:"clamp-to-edge",e.options.addressModeW=r.addressModeW?r.addressModeW:"clamp-to-edge",e.options.magFilter=r.magFilter?r.magFilter:"nearest",e.options.minFilter=r.minFilter?r.minFilter:"nearest",e.options.mipmapFilter=r.mipmapFilter?r.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=(n,r)=>`@binding(${n}) @group(${r}) var ${e.label}: sampler;`,t.getBindGroupEntry=()=>({resource:e.handle})}const NL={device:null,handle:null,label:null,options:null};function V8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NL,n),J.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},J.obj(e.bindGroupTime,{mtime:0}),J.get(t,e,["bindGroupTime","handle","options"]),J.setGet(t,e,["bindGroupLayoutEntry","device","label"]),ML(t,e)}const LL=J.newInstance(V8);var k8={newInstance:LL,extend:V8};const{SlicingMode:mv}=Mh,AL=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Image::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  //VTK::Image::Sample

  // var computedColor: vec4<f32> = vec4<f32>(1.0,0.7, 0.5, 1.0);

//VTK::RenderEncoder::Impl

  return output;
}
`;function FL(t,e,n){if(e.apply(t)){const i=t.getIndependentComponents();return`${t.getMTime()}-${i}-${n}`}return"0"}const Zr=new Float64Array(16),ea=new Float64Array(16),u0=new Float64Array(16),Pa=new Float64Array(4),kn=new Float64Array(4);function IL(t,e){e.classHierarchy.push("vtkWebGPUImageMapper"),t.buildPass=i=>{if(i){e.WebGPUImageSlice=t.getFirstAncestorOfType("vtkWebGPUImageSlice"),e.WebGPURenderer=e.WebGPUImageSlice.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice();const a=e.WebGPURenderer.getRenderable();e.renderable.getSliceAtFocalPoint()&&e.renderable.setSliceFromCamera(a.getActiveCamera())}},t.translucentPass=i=>{i&&t.render()},t.opaquePass=i=>{i&&t.render()},t.render=()=>{e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw)},t.computePipelineHash=()=>{const i=e.currentInput.getExtent();i[0]===i[1]||i[2]===i[3]||i[4]===i[5]?(e.dimensions=2,e.pipelineHash="img2"):(e.dimensions=3,e.pipelineHash="img3")},t.updateUBO=()=>{const i=e.UBO.getSendTime(),a=e.WebGPUImageSlice.getRenderable(),o=a.getMapper();if(t.getMTime()>i||e.renderable.getMTime()>i||a.getProperty().getMTime()>i){const s=o.getInputData(),c=e.WebGPURenderer.getStabilizedCenterByReference();ut(Zr),hn(Zr,Zr,c);const l=a.getMatrix();Rt(ea,l),Sn(ea,ea),It(Zr,ea,Zr);const f=s.getWorldToIndex();It(Zr,f,Zr),Sn(u0,Zr),Vl(ea,[.5,.5,.5]),It(Zr,ea,Zr);const u=s.getDimensions();ut(ea),va(ea,ea,[1/u[0],1/u[1],1/u[2]]),It(Zr,ea,Zr),e.UBO.setArray("SCTCMatrix",Zr);const h=e.currentInput.getExtent(),{ijkMode:p}=e.renderable.getClosestIJKAxis();let d=e.renderable.getSlice();p!==e.renderable.getSlicingMode()&&(d=e.renderable.getSliceAtPosition(d));let g=2,y=0,x=1;p===mv.I?(g=0,y=1,x=2):p===mv.J&&(g=1,y=2,x=0),Pa[g]=d,Pa[y]=h[y*2]-.5,Pa[x]=h[x*2]-.5,Pa[3]=1,Js(Pa,Pa,u0),e.UBO.setArray("Origin",Pa),kn[g]=d,kn[y]=h[y*2+1]+.5,kn[x]=h[x*2]-.5,kn[3]=1,Js(kn,kn,u0),$m(kn,kn,Pa),kn[3]=1,e.UBO.setArray("Axis1",kn),kn[g]=d,kn[y]=h[y*2]-.5,kn[x]=h[x*2+1]+.5,kn[3]=1,Js(kn,kn,u0),$m(kn,kn,Pa),kn[3]=1,e.UBO.setArray("Axis2",kn);const m=[1,1,1,1],v=[0,0,0,0],w=e.textureViews[0],C=w.getTexture().getScale(),T=w.getTexture().getNumberOfComponents();for(let _=0;_<T;_++){let S=a.getProperty().getColorWindow(),b=a.getProperty().getColorLevel();const E=a.getProperty().getRGBTransferFunction(0);if(E){const R=E.getRange();S=R[1]-R[0],b=.5*(R[1]+R[0])}m[_]=C/S,v[_]=-b/S+.5}e.UBO.setArray("cScale",m),e.UBO.setArray("cShift",v),e.UBO.sendIfNeeded(e.device)}},t.updateLUTImage=()=>{const i=e.WebGPUImageSlice.getRenderable().getProperty();t.getTextureViews()[0].getTexture().getNumberOfComponents();const o=1,s=FL(i,i.getRGBTransferFunction,o);if(e.colorTextureString!==s){e.numRows=o;const c=new Uint8ClampedArray(e.numRows*2*e.rowLength*4);let l=i.getRGBTransferFunction();if(l){const f=new Float32Array(e.rowLength*3);for(let u=0;u<o;u++){l=i.getRGBTransferFunction(u);const h=l.getRange();l.getTable(h[0],h[1],e.rowLength,f,1);for(let p=0;p<e.rowLength;p++){const d=u*e.rowLength*8+p*4;c[d]=255*f[p*3],c[d+1]=255*f[p*3+1],c[d+2]=255*f[p*3+2],c[d+3]=255;for(let g=0;g<4;g++)c[d+e.rowLength*4+g]=c[d+g]}}}else for(let f=0;f<e.rowLength;++f){const u=255*f/(e.rowLength-1);c[f*4]=u,c[f*4+1]=u,c[f*4+2]=u,c[f*4+3]=255;for(let h=0;h<4;h++)c[f*4+e.rowLength*4+h]=c[f*4+h]}{const f={nativeArray:c,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},h=e.device.getTextureManager().getTexture(f).createView("tfunTexture");e.textureViews[1]=h}e.colorTextureString=s}};const n=t.updateBuffers;t.updateBuffers=()=>{n();const i=e.device.getTextureManager().getTextureForImageData(e.currentInput),a=e.textureViews;if(!a[0]||a[0].getTexture()!==i){const c=i.createView("imgTexture");a[0]=c}t.updateLUTImage(),t.updateUBO();const s=e.WebGPUImageSlice.getRenderable().getProperty().getInterpolationType()===tc.NEAREST?"nearest":"linear";(!e.clampSampler||s!==e.clampSampler.getOptions().minFilter)&&(e.clampSampler=k8.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:s,magFilter:s}),e.additionalBindables=[e.clampSampler])};const r=t.getShaderReplacements();t.replaceShaderPosition=(i,a,o)=>{const s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let c=s.getCode();const l=["var pos: vec4<f32> = mapperUBO.Origin +","   (vertexBC.x * 0.5 + 0.5) * mapperUBO.Axis1 + (vertexBC.y * 0.5 + 0.5) * mapperUBO.Axis2;","pos.w = 1.0;"];e.dimensions===2?l.push("var tcoord : vec2<f32> = (mapperUBO.SCTCMatrix * pos).xy;"):l.push("var tcoord : vec3<f32> = (mapperUBO.SCTCMatrix * pos).xyz;"),l.push("output.tcoordVS = tcoord;","output.Position = rendererUBO.SCPCMatrix * pos;"),c=Yt.substitute(c,"//VTK::Position::Impl",l).result,s.setCode(c)},r.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(i,a,o)=>{const s=a.getShaderDescription("vertex");e.dimensions===2?s.addOutput("vec2<f32>","tcoordVS"):s.addOutput("vec3<f32>","tcoordVS")},r.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderImage=(i,a,o)=>{const s=a.getShaderDescription("fragment");let c=s.getCode();e.dimensions===3?c=Yt.substitute(c,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result:c=Yt.substitute(c,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result,c=Yt.substitute(c,"//VTK::Image::Sample",["    var coord: vec2<f32> =","      vec2<f32>(computedColor.r * mapperUBO.cScale.r + mapperUBO.cShift.r, 0.5);","    computedColor = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);"]).result,s.setCode(c)},r.set("replaceShaderImage",t.replaceShaderImage)}const PL={rowLength:1024};function VL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PL,n),Hd.extend(t,e,n),t.setFragmentShaderTemplate(AL),e.UBO=Ic.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.UBO.addEntry("Origin","vec4<f32>"),e.UBO.addEntry("Axis2","vec4<f32>"),e.UBO.addEntry("Axis1","vec4<f32>"),e.UBO.addEntry("cScale","vec4<f32>"),e.UBO.addEntry("cShift","vec4<f32>"),e.lutBuildTime={},an(e.lutBuildTime,{mtime:0}),e.imagemat=ut(new Float64Array(16)),e.imagematinv=ut(new Float64Array(16)),e.VBOBuildTime={},an(e.VBOBuildTime),IL(t,e)}const kL=kt(VL,"vtkWebGPUImageMapper");Ci("vtkImageMapper",kL);function UL(t,e){e.classHierarchy.push("vtkWebGPUImageSlice"),t.buildPass=n=>{if(!(!e.renderable||!e.renderable.getVisibility())&&n){if(!e.renderable)return;e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes()}},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children.forEach(r=>{r.traverse(n)}),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix(),i=n.getStabilizedCenterByReference();e.bufferShift[0]=r[3]-i[0],e.bufferShift[1]=r[7]-i[1],e.bufferShift[2]=r[11]-i[2],Rt(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?ut(e.keyMatrices.normalMatrix):(pn(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Sn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Rt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),hn(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),hn(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const BL={bufferShift:void 0,keyMatrixTime:null,keyMatrices:null,propID:void 0};function GL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,BL,n),en.extend(t,e,n),e.keyMatricesTime={},an(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},e.keyMatrixTime={},an(e.keyMatrixTime,{mtime:0}),e.keyMatrices={mcwc:ut(new Float64Array(16))},e.bufferShift=[0,0,0,0],mr(t,e,["propID","keyMatricesTime"]),UL(t,e)}const WL=kt(GL,"vtkWebGPUImageSlice");Ci("vtkImageSlice",WL);function zL(t,e){e.classHierarchy.push("vtkWebGPUVolume"),t.buildPass=i=>{!e.renderable||!e.renderable.getVisibility()||i&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),e.renderable.getMapper().update())},t.queryPass=(i,a)=>{if(i){if(!e.renderable||!e.renderable.getVisibility())return;const o=e.renderable.getMapper().getBounds();if(!o||o.length!==6||o[0]>o[1])return;a.addVolume(t)}};const n=new Float64Array(3),r=new Float64Array(3);t.getBoundingCubePoints=(i,a)=>{const o=e.renderable.getMapper().getInputData();if(!o)return;const s=o.getExtent(),c=e.renderable.getMatrix();let l=0;for(let f=4;f<6;f++){n[2]=s[f];for(let u=2;u<4;u++){n[1]=s[u];for(let h=0;h<2;h++){n[0]=s[h],o.indexToWorld(n,r);let p=a+l*3;i[p++]=c[0]*r[0]+c[1]*r[1]+c[2]*r[2]+c[3],i[p++]=c[4]*r[0]+c[5]*r[1]+c[6]*r[2]+c[7],i[p++]=c[8]*r[0]+c[9]*r[1]+c[10]*r[2]+c[11],l++}}}},t.getKeyMatrices=i=>{if(Math.max(e.renderable.getMTime(),i.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const a=e.renderable.getMatrix(),o=i.getStabilizedCenterByReference();Rt(e.keyMatrices.bcwc,a),hn(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-o[0],-o[1],-o[2]]),e.keyMatricesTime.modified()}return e.keyMatrices}}const jL={propID:void 0,keyMatricesTime:null};function $L(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jL,n),en.extend(t,e,n),e.keyMatricesTime={},J.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={bcwc:new Float64Array(16),bcsc:new Float64Array(16)},J.get(t,e,["propID","keyMatricesTime"]),zL(t,e)}const HL=J.newInstance($L,"vtkWebGPUVolume");Ci("vtkVolume",HL);function KL(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();const i=e.WebGPURenderer.getAspectRatio(),a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,o=e.WebGPURenderer.getTiledSizeAndOrigin(),s=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),a,i,o,s)}}const qL={};function XL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qL,n),en.extend(t,e,n),KL(t,e)}const YL=J.newInstance(XL,"vtkWebGPUPixelSpaceCallbackMapper");Ci("vtkPixelSpaceCallbackMapper",YL);const Ai={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var U8={StructuredType:Ai};const{StructuredType:Va}=U8;function JL(t){let e=0;for(let n=0;n<3;++n)t[n*2]<t[n*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?Va.EMPTY:e===3?Va.XYZ_GRID:e===2?t[0]===t[1]?Va.YZ_PLANE:t[2]===t[3]?Va.XZ_PLANE:Va.XY_PLANE:e===1?t[0]<t[1]?Va.X_LINE:t[2]<t[3]?Va.Y_LINE:Va.Z_LINE:Va.SINGLE_POINT}var ZL={getDataDescriptionFromExtent:JL,...U8};const{vtkErrorMacro:Fs}=J;function QL(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return Fs("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const a=r.length===1?r[0]:r;if(a.length!==6)return!1;const o=e.extent.some((s,c)=>s!==a[c]);return o&&(e.extent=a.slice(),e.dataDescription=ZL.getDataDescriptionFromExtent(e.extent),t.modified()),o},t.setDimensions=function(){let n,r,i;if(e.deleted){Fs("instance deleted - cannot call any method");return}if(arguments.length===1){const a=arguments.length<=0?void 0:arguments[0];n=a[0],r=a[1],i=a[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2];else{Fs("Bad dimension specification");return}t.setExtent(0,n-1,0,r-1,0,i-1)},t.getDimensions=()=>[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1],t.getNumberOfCells=()=>{const n=t.getDimensions();let r=1;for(let i=0;i<3;i++){if(n[i]===0)return 0;n[i]>1&&(r*=n[i]-1)}return r},t.getNumberOfPoints=()=>{const n=t.getDimensions();return n[0]*n[1]*n[2]},t.getPoint=n=>{const r=t.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return Fs("Requesting a point from an empty image."),null;const i=new Float64Array(3);switch(e.dataDescription){case Ai.EMPTY:return null;case Ai.SINGLE_POINT:break;case Ai.X_LINE:i[0]=n;break;case Ai.Y_LINE:i[1]=n;break;case Ai.Z_LINE:i[2]=n;break;case Ai.XY_PLANE:i[0]=n%r[0],i[1]=n/r[0];break;case Ai.YZ_PLANE:i[1]=n%r[1],i[2]=n/r[1];break;case Ai.XZ_PLANE:i[0]=n%r[0],i[2]=n/r[0];break;case Ai.XYZ_GRID:i[0]=n%r[0],i[1]=n/r[0]%r[1],i[2]=n/(r[0]*r[1]);break;default:Fs("Invalid dataDescription");break}const a=[0,0,0];return t.indexToWorld(i,a),a},t.getBounds=()=>t.extentToBounds(t.getSpatialExtent()),t.extentToBounds=n=>Kt.transformBounds(n,e.indexToWorld),t.getSpatialExtent=()=>Kt.inflate([...e.extent],.5),t.computeTransforms=()=>{Vl(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],va(e.indexToWorld,e.indexToWorld,e.spacing),Sn(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Dt(r,n,e.indexToWorld),r},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Dt(r,n,e.worldToIndex),r},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Kt.transformBounds(n,e.indexToWorld,r)},t.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Kt.transformBounds(n,e.worldToIndex,r)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=()=>Kt.getCenter(t.getBounds()),t.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=[0,0,0,0,0,0];t.worldToIndexBounds(n,i);const a=[0,0,0],o=[0,0,0];Kt.computeCornerPoints(i,a,o),Md(a,a),Md(o,o);const s=t.getDimensions();Ld(a,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],a),Ld(o,[0,0,0],[s[0]-1,s[1]-1,s[2]-1],o);const c=s[0],l=s[0]*s[1],f=t.getPointData().getScalars().getData();let u=-1/0,h=1/0,p=0,d=0,g=0;for(let v=a[2];v<=o[2];v++)for(let w=a[1];w<=o[1];w++){let C=a[0]+w*c+v*l;for(let T=a[0];T<=o[0];T++){if(!r||r([T,w,v],i)){const _=f[C];_>u&&(u=_),_<h&&(h=_),p+=_*_,d+=_,g+=1}++C}}const y=g>0?d/g:0,x=g?Math.abs(p/g-y*y):0,m=Math.sqrt(x);return{minimum:h,maximum:u,average:y,variance:x,sigma:m,count:g}},t.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let a=r;for(let o=0;o<3;++o)i[o]=a,a*=n[o*2+1]-n[o*2]+1;return i},t.computeOffsetIndex=n=>{let[r,i,a]=n;const o=t.getExtent(),s=t.getPointData().getScalars().getNumberOfComponents(),c=t.computeIncrements(o,s);return Math.floor((Math.round(r)-o[0])*c[0]+(Math.round(i)-o[2])*c[1]+(Math.round(a)-o[4])*c[2])},t.getOffsetIndexFromWorld=n=>{const r=t.getExtent(),i=t.worldToIndex(n);for(let a=0;a<3;++a)if(i[a]<r[a*2]||i[a]>r[a*2+1])return Fs(`GetScalarPointer: Pixel ${i} is not in memory. Current extent = ${r}`),NaN;return t.computeOffsetIndex(i)},t.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=t.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=i)return Fs(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${i}`),NaN;const a=t.getOffsetIndexFromWorld(n);return Number.isNaN(a)?a:t.getPointData().getScalars().getComponent(a,r)}}const eA={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Ai.EMPTY};function B8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eA,n),nu.extend(t,e,n),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=wi(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),J.get(t,e,["indexToWorld","worldToIndex"]),J.setGetArray(t,e,["origin","spacing"],3),J.setGetArray(t,e,["direction"],9),J.getArray(t,e,["extent"],6),QL(t,e)}const tA=J.newInstance(B8,"vtkImageData");var L1={newInstance:tA,extend:B8};const vv=[[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],yv=[[0,-1,0],[0,1,0]],nA=[[0,-1,0],[0,1,0],[0,0,-1]],rA=[[0,-1,0],[0,1,0],[0,0,1]],S2=class S2{static copyMap(e,n){for(const[r,i]of n.rows)e.rows.set(r,structuredClone(i))}constructor(e,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.pixelDataConstructor=Uint8Array,this.updateScalarData=function(i){i.fill(0);const a=(o,s,c)=>{const{start:l,end:f,value:u}=s;for(let h=l;h<f;h++)i[o+h]=u};this.forEach(a)},this.get=i=>{const a=i%this.jMultiple,o=(i-a)/this.jMultiple;return this.getRLE(a,o)?.value??this.defaultValue},this.getRun=(i,a)=>{const o=i+a*this.height;return this.rows.get(o)},this.set=(i,a)=>{if(a===void 0)return;const o=i%this.width,s=(i-o)/this.width,c=this.rows.get(s);if(!c){this.rows.set(s,[{start:o,end:o+1,value:a}]);return}const l=this.findIndex(c,o),f=c[l],u=c[l-1];if(!f){if(!u||u.value!==a||u.end!==o){c[l]={start:o,end:o+1,value:a};return}u.end++;return}const{start:h,end:p,value:d}=f;if(a===d&&o>=h)return;const g={start:o,end:o+1,value:a},y=o>h,x=y?l+1:l,m=y?f:u;let v=y?c[l+1]:f;if(m?.value===a&&m?.end===o){m.end++,v?.value===a&&v.start===o+1?(m.end=v.end,c.splice(l,1)):v?.start===o&&(v.start++,v.start===v.end&&(c.splice(l,1),v=c[l],v?.start===o+1&&v.value===a&&(m.end=v.end,c.splice(l,1))));return}if(v?.value===a&&v.start===o+1){v.start--,m?.end>o&&(m.end=o,m.end===m.start&&c.splice(l,1));return}if(v?.start===o&&v.end===o+1){v.value=a;const w=c[l+1];w?.start==o+1&&w.value===a&&(c.splice(l+1,1),v.end=w.end);return}o===v?.start&&v.start++,y&&p>o+1?c.splice(x,0,g,{start:o+1,end:m.end,value:m.value}):c.splice(x,0,g),m?.end>o&&(m.end=o)},this.width=e,this.height=n,this.depth=r,this.jMultiple=e,this.kMultiple=this.jMultiple*n}toIJK(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple%this.height,i=Math.floor(e/this.kMultiple);return[n,r,i]}toIndex([e,n,r]){return e+r*this.kMultiple+n*this.jMultiple}getRLE(e,n,r=0){const i=this.rows.get(n+r*this.height);if(!i)return;const a=this.findIndex(i,e),o=i[a];return e>=o?.start?o:void 0}has(e){const n=e%this.jMultiple,r=(e-n)/this.jMultiple;return this.getRLE(n,r)?.value!==void 0}delete(e){const n=e%this.width,r=(e-n)/this.width,i=this.rows.get(r);if(!i)return;const a=this.findIndex(i,n),o=i[a];if(!o||o.start>n)return;if(o.end===n+1){o.end--,o.start>=o.end&&(i.splice(a,1),i.length||this.rows.delete(r));return}if(o.start===n){o.start++;return}const s={value:o.value,start:n+1,end:o.end};o.end=n,i.splice(a+1,0,s)}findIndex(e,n){for(let r=0;r<e.length;r++){const{end:i}=e[r];if(n<i)return r}return e.length}forEach(e,n){const r=n?.rowModified;for(const[i,a]of this.rows){const o=r?[...a]:a;for(const s of o)e(i*this.width,s,a)}}forEachRow(e){for(const[n,r]of this.rows)e(n*this.width,r)}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(e=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:i,numComps:a}=this;for(let o=0;o<i;o++){const s=this.getRun(o,e);if(s)if(a===1)for(const c of s){const l=o*r,{start:f,end:u,value:h}=c;for(let p=f;p<u;p++)n[l+p]=h}else for(const c of s){const l=o*r*a,{start:f,end:u,value:h}=c;for(let p=f;p<u;p+=a)for(let d=0;d<a;d++)n[l+p+d]=h[d]}}return n}floodFill(e,n,r,i,a){const o=this.getRLE(e,n,r);if(!o)throw new Error(`Initial point ${e},${n},${r} isn't in the RLE`);const s=[[o,n,r]],c=o.value;if(c===i)throw new Error(`source (${c}) and destination (${i}) are identical`);return this.flood(s,c,i,a)}flood(e,n,r,i){let a=0;const{planar:o=!0,diagonals:s=!0,singlePlane:c=!1}=i||{},l={planar:o,diagonals:s,singlePlane:c};for(;e.length;){const f=e.pop(),[u]=f;if(u.value!==n)continue;u.value=r,a+=u.end-u.start;const h=this.findAdjacents(f,l).filter(p=>p&&p[0].value===n);e.push(...h)}return a}fillFrom(e,n){for(let r=n[2][0];r<=n[2][1];r++)for(let i=n[1][0];i<=n[1][1];i++){let a,o;for(let s=n[0][0];s<=n[0][1];s++){const c=e(s,i,r);if(c===void 0){a=void 0;continue}o||(o=[],this.rows.set(i+r*this.height,o)),a&&a.value!==c&&(a=void 0),a||(a={start:s,end:s,value:c},o.push(a)),a.end++}}}findAdjacents(e,{diagonals:n=!0,planar:r=!0,singlePlane:i=!1}){const[a,o,s,c]=e,{start:l,end:f}=a,u=l>0&&this.getRLE(l-1,o,s),h=f<this.width&&this.getRLE(f,o,s),p=n?[l>0?l-1:l,f<this.width?f+1:f]:[l,f],d=[];u&&d.push([u,o,s]),h&&d.push([h,o,s]);for(const g of c||(i?yv:vv)){const[,y,x]=g,m=y+o,v=x+s;if(m<0||m>=this.height||v<0||v>=this.depth)continue;const w=this.getRun(m,v);if(w)for(const C of w){const T=c||i&&yv||r&&x>0&&rA||r&&x<0&&nA||vv;C.end<=p[0]||C.start>=p[1]||d.push([C,m,v,T])}}return d}};S2.getScalarData=function(e=Uint8ClampedArray){const n=new e(this.frameSize);return this.map.updateScalarData(n),n};let Go=S2;class Xa{constructor(e={}){this._dimensions=3,this._length=0,this._byteSize=4,this.growSize=128;const{initialSize:n=1024,dimensions:r=3,growSize:i=128}=e,a=n*r;this.growSize=i,this.array=new ArrayBuffer(a*this._byteSize),this.data=new Float32Array(this.array),this._dimensions=r}forEach(e){for(let n=0;n<this._length;n++)e(this.getPoint(n),n)}get length(){return this._length}get dimensions(){return this._dimensions}get dimensionLength(){return this._length*this._dimensions}getPoint(e){if(e<0&&(e+=this._length),e<0||e>=this._length)return;const n=this._dimensions*e;return this.data.subarray(n,n+this._dimensions)}getPointArray(e){const n=[];if(e<0&&(e+=this._length),e<0||e>=this._length)return;const r=this._dimensions*e;for(let i=0;i<this._dimensions;i++)n.push(this.data[i+r]);return n}grow(e=1,n=this.growSize){if(this.dimensionLength+e*this._dimensions<=this.data.length)return;const r=this.data.length+n,i=new ArrayBuffer(r*this._dimensions*this._byteSize),a=new Float32Array(i);a.set(this.data),this.data=a,this.array=i}reverse(){const e=Math.floor(this._length/2);for(let n=0;n<e;n++){const r=n*this._dimensions,i=(this._length-1-n)*this._dimensions;for(let a=0;a<this._dimensions;a++){const o=this.data[r+a];this.data[r+a]=this.data[i+a],this.data[i+a]=o}}}getTypedArray(){return this.data}push(e){this.grow(1);const n=this.length*this._dimensions;for(let r=0;r<this._dimensions;r++)this.data[r+n]=e[r];this._length++}map(e){const n=[];for(let r=0;r<this._length;r++)n.push(e(this.getPoint(r),r));return n}get points(){return this.map(e=>e)}toXYZ(){const e={x:[],y:[]};this._dimensions>=3&&(e.z=[]);const{x:n,y:r,z:i}=e;return this.forEach(a=>{n.push(a[0]),r.push(a[1]),i&&i.push(a[2])}),e}static fromXYZ({x:e,y:n,z:r}){const i=Xa.create3(e.length);let a=0;for(let o=0;o<e.length;o++)i.data[a++]=e[o],i.data[a++]=n[o],i.data[a++]=r?r[o]:0;return i._length=e.length,i}subselect(e=10,n=0){const r=new Xa({initialSize:e,dimensions:this._dimensions});for(let i=0;i<e;i++){const a=(n+Math.floor(this.length*i/e))%this.length;r.push(this.getPoint(a))}return r}static create3(e=128,n){e=Math.max(e,n?.length||0);const r=new Xa({initialSize:e,dimensions:3});return n&&n.forEach(i=>r.push(i)),r}static create2(e=128){return new Xa({initialSize:e,dimensions:2})}}function G8(t){const e=it(),n=t.getDimensions(),r=Xa.create3(n[0]),i=Xa.create3(n[1]),a=Xa.create3(n[2]),o=t.getDirection(),s=o.slice(0,3),c=o.slice(3,6),l=o.slice(6,9),f=t.getSpacing(),[u,h,p]=f,d=t.indexToWorld([0,0,0]),g=Qt(s[0]*u,s[1]*u,s[2]*u),y=Qt(c[0]*h,c[1]*h,c[2]*h),x=Qt(l[0]*p,l[1]*p,l[2]*p),m=it();for(let T=0;T<n[0];T++)r.push(vi(m,d,lr(m,g,T)));for(let T=0;T<n[1];T++)i.push(lr(m,y,T));for(let T=0;T<n[2];T++)a.push(lr(m,x,T));const v=r.getTypedArray(),w=i.getTypedArray(),C=a.getTypedArray();return(T,_=e)=>{const[S,b,D]=T,E=S*3,R=b*3,F=D*3;return _[0]=v[E]+w[R]+C[F],_[1]=v[E+1]+w[R+1]+C[F+1],_[2]=v[E+2]+w[R+2]+C[F+2],_}}function W8(t,e){const{pointInShapeFn:n,callback:r,boundsIJK:i,returnPoints:a=!1}=e;let o;if(t.getScalarData)o=t.getScalarData();else{const u=t.getPointData().getScalars();if(u)o=u.getData();else{const{voxelManager:h}=t.get("voxelManager")||{};h&&(o=h.getCompleteScalarDataArray())}}const s=t.getDimensions(),c=[[0,s[0]],[0,s[1]],[0,s[2]]],f=iA({imageData:t,bounds:i||c,scalarData:o,pointInShapeFn:n,callback:r});return a?f:void 0}function iA({imageData:t,bounds:e,scalarData:n,pointInShapeFn:r,callback:i}){const[[a,o],[s,c],[l,f]]=e,{numComps:u}=t,h=t.getDimensions(),p=G8(t),d=[0,0,0],g=u||n.length/h[2]/h[1]/h[0],y=h[0]*g,x=h[1]*y,m=[];for(let v=l;v<=f;v++){d[2]=v;const w=v*x;for(let C=s;C<=c;C++){d[1]=C;const T=w+C*y;for(let _=a;_<=o;_++){d[0]=_;const S=p(d);if(r(S,d)){const b=T+_*g;let D;g>2?D=[n[b],n[b+1],n[b+2]]:D=n[b],m.push({value:D,index:b,pointIJK:d,pointLPS:S.slice()}),i({value:D,index:b,pointIJK:d,pointLPS:S})}}}}return m}function aA({voxelManager:t,bounds:e,imageData:n,pointInShapeFn:r,callback:i,returnPoints:a}){const[[o,s],[c,l],[f,u]]=e,h=G8(n),p=[0,0,0],d=[];for(let g=f;g<=u;g++){p[2]=g;for(let y=c;y<=l;y++){p[1]=y;for(let x=o;x<=s;x++){p[0]=x;const m=h(p);if(r(m,p)){const v=t.toIndex(p),w=t.getAtIndex(v);a&&d.push({value:w,index:v,pointIJK:[...p],pointLPS:m.slice()}),i?.({value:w,index:v,pointIJK:p,pointLPS:m})}}}}return d}const oA=5*1024;class rn{get id(){return this._id}constructor(e,n){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.scalarData=null,this._sliceDataCache=null,this.getAtIJK=(r,i,a)=>{const o=this.toIndex([r,i,a]);return this._get(o)},this.setAtIJK=(r,i,a,o)=>{const s=this.toIndex([r,i,a]),c=this._set(s,o);return c!==!1&&(this.modifiedSlices.add(a),rn.addBounds(this.boundsIJK,[r,i,a])),c},this.getAtIJKPoint=([r,i,a])=>this.getAtIJK(r,i,a),this.setAtIJKPoint=([r,i,a],o)=>{this.setAtIJK(r,i,a,o)},this.getAtIndex=r=>this._get(r),this.setAtIndex=(r,i)=>{const a=this._set(r,i);if(a!==!1){const o=this.toIJK(r);this.modifiedSlices.add(o[2]),rn.addBounds(this.boundsIJK,o)}return a},this.getMiddleSliceData=()=>{const r=Math.floor(this.dimensions[2]/2);return this.getSliceData({sliceIndex:r,slicePlane:2})},this.forEach=(r,i={})=>{const a=i.boundsIJK||this.getBoundsIJK(),o=i.isInObject||this.isInObject||(()=>!0),s=i.returnPoints||!1,c=i.imageData,l=Math.min(a[0][0],a[0][1]),f=Math.max(a[0][0],a[0][1]),u=Math.min(a[1][0],a[1][1]),h=Math.max(a[1][0],a[1][1]),p=Math.min(a[2][0],a[2][1]),d=Math.max(a[2][0],a[2][1]),g=[];if(c)return aA({voxelManager:this,imageData:i.imageData,bounds:[[l,f],[u,h],[p,d]],pointInShapeFn:o,callback:r,returnPoints:s});if(this.map){if(this.map instanceof Go)return this.rleForEach(r,i);for(const y of this.map.keys()){const x=this.toIJK(y);if(!o(null,x))continue;const m=this._get(y);s&&g.push({value:m,index:y,pointIJK:x,pointLPS:null}),r({value:m,index:y,pointIJK:x,pointLPS:null})}return g}else{for(let y=p;y<=d;y++){const x=y*this.frameSize;for(let m=u;m<=h;m++){const v=x+m*this.width;for(let w=l,C=v+w;w<=f;w++,C++){const T=this.getAtIndex(C),_=[w,m,y];o(null,_)&&(s&&g.push({value:T,index:C,pointIJK:_,pointLPS:null}),r({value:T,index:C,pointIJK:[w,m,y],pointLPS:null}))}}}return g}},this.getSliceData=({sliceIndex:r,slicePlane:i})=>{const[a,o,s]=this.dimensions,c=a*o,l=r*c;let f;const u=this.getConstructor();function h(d){return typeof d=="function"}if(!h(u))return new Uint8Array(0);let p;switch(i){case 0:f=o*s,p=new u(f);for(let d=0;d<o;d++)for(let g=0;g<s;g++){const y=r+d*a+g*c;this.setSliceDataValue(p,d*s+g,this._get(y))}break;case 1:f=a*s,p=new u(f);for(let d=0;d<a;d++)for(let g=0;g<s;g++){const y=d+r*a+g*c;this.setSliceDataValue(p,d+g*a,this._get(y))}break;case 2:f=a*o,p=new u(f);for(let d=0;d<f;d++)this.setSliceDataValue(p,d,this._get(l+d));break;default:throw new Error("Oblique plane - todo - implement as ortho normal vector")}return p},this.dimensions=e,this.width=e[0],this.frameSize=this.width*e[1],this._get=n._get,this._set=n._set,this._id=n._id||"",this._getConstructor=n._getConstructor,this.numberOfComponents=this.numberOfComponents||1,this.scalarData=n.scalarData,this._getScalarData=n._getScalarData,this._updateScalarData=n._updateScalarData}getMinMax(){let e,n;const r=({value:i})=>{const a=Array.isArray(i);if(e===void 0&&(e=a?[...i]:i,n=a?[...i]:i),a)for(let o=0;o<i.length;o++)e[o]=Math.min(e[o],i[o]),n[o]=Math.max(n[o],i[o]);else e=Math.min(e,i),n=Math.max(n,i)};return this.forEach(r,{boundsIJK:this.getDefaultBounds()}),{min:e,max:n}}toIJK(e){return[e%this.width,Math.floor(e%this.frameSize/this.width),Math.floor(e/this.frameSize)]}toIndex(e){return e[0]+e[1]*this.width+e[2]*this.frameSize}getDefaultBounds(){return this.dimensions.map(e=>[0,e-1])}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.getDefaultBounds()}rleForEach(e,n){const r=n?.boundsIJK||this.getBoundsIJK(),{isWithinObject:i}=n||{},a=this.map;if(!a){console.warn("No map found, you need to use a map voxel manager to use rleForEach");return}a.defaultValue=void 0;for(let o=r[2][0];o<=r[2][1];o++)for(let s=r[1][0];s<=r[1][1];s++){const c=a.getRun(s,o);if(c)for(const l of c){const{start:f,end:u,value:h}=l,p=this.toIndex([0,s,o]);for(let d=f;d<u;d++){const g={value:h,index:p+d,pointIJK:[d,s,o]};i?.(g)!==!1&&e(g)}}}}getScalarData(e=!1){if(this.scalarData)return this._updateScalarData?.(this.scalarData),this.scalarData;if(this._getScalarData){const n=this._getScalarData();return e&&console.log("Not transient, should store value",n),n}throw new Error("No scalar data available")}setScalarData(e){this.scalarData=e}getScalarDataLength(){if(this.scalarData)return this.scalarData.length;if(this._getScalarDataLength)return this._getScalarDataLength();throw new Error("No scalar data available")}get sizeInBytes(){return this.getScalarDataLength()*this.bytePerVoxel}get bytePerVoxel(){return this.scalarData?this.scalarData.BYTES_PER_ELEMENT:this._get(0).BYTES_PER_ELEMENT}clearBounds(){this.boundsIJK.map(e=>{e[0]=1/0,e[1]=-1/0})}clear(){this.map?.clear(),this.clearBounds(),this.modifiedSlices.clear(),this.points?.clear()}getConstructor(){return this.scalarData?this.scalarData.constructor:this._getConstructor?this._getConstructor():(console.warn("No scalar data available or can be used to get the constructor"),Float32Array)}getArrayOfModifiedSlices(){return Array.from(this.modifiedSlices)}resetModifiedSlices(){this.modifiedSlices.clear()}setBounds(e){this.boundsIJK=e}static addBounds(e,n){e||(e=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),e[0][0]=Math.min(n[0],e[0][0]),e[0][1]=Math.max(n[0],e[0][1]),e[1][0]=Math.min(n[1],e[1][0]),e[1][1]=Math.max(n[1],e[1][1]),e[2][0]=Math.min(n[2],e[2][0]),e[2][1]=Math.max(n[2],e[2][1])}addPoint(e){const n=Array.isArray(e)?e[0]+this.width*e[1]+this.frameSize*e[2]:e;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(e=>this.toIJK(e)):[]}setSliceDataValue(e,n,r){if(Array.isArray(r))for(let i=0;i<r.length;i++)e[n*r.length+i]=this.toNumber(r[i]);else e[n]=this.toNumber(r)}toNumber(e){return typeof e=="number"?e:Array.isArray(e)&&e[0]||0}static _createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r=3,id:i}){const a=new rn(e,{_get:o=>(o*=r,[n[o++],n[o++],n[o++]]),_id:i||"_createRGBScalarVolumeVoxelManager",_set:(o,s)=>{o*=3;const c=!Un(n[o],s);return n[o++]=s[0],n[o++]=s[1],n[o++]=s[2],c},numberOfComponents:r,scalarData:n});return a.clear=()=>{n.fill(0)},a}static createImageVolumeVoxelManager({dimensions:e,imageIds:n,numberOfComponents:r=1,id:i}){const a=e[0]*e[1];function o(u){const h=Math.floor(u/a);if(h<0||h>=e[2])return{};const p=n[h];if(!p)return console.warn(`ImageId not found for sliceIndex: ${h}`),{pixelData:null,pixelIndex:null};const d=at.getImage(p);if(!d)return console.warn(`Image not found for imageId: ${p}`),{pixelData:null,pixelIndex:null};const g=d.voxelManager,y=u%a;return{voxelManager:g,pixelIndex:y}}function s(u){const{voxelManager:h,pixelIndex:p}=o(u);return!h||p===null?null:h.getAtIndex(p)}function c(u,h){const{voxelManager:p,pixelIndex:d}=o(u);if(!p||d===null)return!1;const g=p.getAtIndex(d),y=!Un(h,g);return y&&(p.setAtIndex(d,h),!0)}const l=()=>{const{voxelManager:u,pixelIndex:h}=o(0);return!u||h===null?null:u.getConstructor()},f=new rn(e,{_get:s,_set:c,numberOfComponents:r,_getConstructor:l,_id:i||"createImageVolumeVoxelManager"});return f.getMiddleSliceData=()=>{const u=Math.floor(e[2]/2);return f.getSliceData({sliceIndex:u,slicePlane:2})},f.clear=()=>{for(const u of n)at.getImage(u).voxelManager.clear()},f.getRange=()=>{let u=1/0,h=-1/0;for(const p of n){const d=at.getImage(p);d&&(d.minPixelValue<u&&(u=d.minPixelValue),d.maxPixelValue>h&&(h=d.maxPixelValue))}return u===1/0&&h===-1/0?[0,0]:[u,h]},f._getScalarDataLength=()=>{const{voxelManager:u,pixelIndex:h}=o(0);return!u||h===null?0:u.getScalarDataLength()*e[2]},f.getCompleteScalarDataArray=()=>{const u=f._getConstructor();if(!u)return new Uint8Array(0);const h=f.getScalarDataLength(),p=new u(h),d=e[0]*e[1]*r;for(let g=0;g<e[2];g++){const{voxelManager:y,pixelIndex:x}=o(g*d/r);if(y&&x!==null){const m=g*d,v=y.getScalarData();if(r===1)p.set(v,m);else for(let w=0;w<v.length;w+=r)for(let C=0;C<r;C++)p[m+w+C]=v[w+C]}}return p},f.setCompleteScalarDataArray=u=>{const h=e[0]*e[1]*r,p=f._getConstructor();let d=1/0,g=-1/0;for(let y=0;y<e[2];y++){const{voxelManager:x}=o(y*h/r);if(x&&p){const m=y*h,v=m+h,w=new p(h);if(w.set(u.subarray(m,v)),x.scalarData)x.scalarData.set(w),x.modifiedSlices.add(y);else for(let _=0;_<h;_++)x.setAtIndex(_,w[_]);for(let _=0;_<w.length;_++){const S=w[_];d=Math.min(d,S),g=Math.max(g,S)}const C=n[y],T=at.getImage(C);T&&(T.minPixelValue=d,T.maxPixelValue=g)}}for(let y=0;y<e[2];y++)f.modifiedSlices.add(y);f.boundsIJK=[[0,e[0]-1],[0,e[1]-1],[0,e[2]-1]]},f}static createScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}){if(e.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/e[0]/e[1]/e[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?rn._createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:n,numberOfComponents:r,id:i}):rn._createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:i})}static createScalarDynamicVolumeVoxelManager({imageIdGroups:e,dimensions:n,dimensionGroupNumber:r=1,timePoint:i=0,numberOfComponents:a=1,id:o}){let s=0;if(r!==void 0?s=r-1:i!==void 0&&(console.warn("Warning: timePoint parameter is deprecated. Please use dimensionGroupNumber instead. timePoint is zero-based while dimensionGroupNumber starts at 1."),s=i),!a){const f=at.getImage(e[0][0]);if(!f)throw new Error("Unable to determine number of components: No image found");if(a=f.getPixelData().length/(n[0]*n[1]),a>4||a<1||a===2)throw new Error(`Number of components ${a} must be 1, 3 or 4`)}const c=e.map(f=>rn.createImageVolumeVoxelManager({dimensions:n,imageIds:f,numberOfComponents:a,id:o})),l=new rn(n,{_get:f=>c[s]._get(f),_set:(f,u)=>c[s]._set(f,u),numberOfComponents:a,_id:o||"createScalarDynamicVolumeVoxelManager"});return l.getScalarDataLength=()=>c[s].getScalarDataLength(),l.getConstructor=()=>c[s].getConstructor(),l.getRange=()=>c[s].getRange(),l.getMiddleSliceData=()=>c[s].getMiddleSliceData(),l.setTimePoint=f=>{console.warn("Warning: setTimePoint is deprecated. Please use setDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),l.setDimensionGroupNumber(f+1)},l.setDimensionGroupNumber=f=>{s=f-1,l._get=u=>c[s]._get(u),l._set=(u,h)=>c[s]._set(u,h)},l.getAtIndexAndTimePoint=(f,u)=>(console.warn("Warning: getAtIndexAndTimePoint is deprecated. Please use getAtIndexAndDimensionGroup instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),l.getAtIndexAndDimensionGroup(f,u+1)),l.getAtIndexAndDimensionGroup=(f,u)=>c[u-1]._get(f),l.getTimePointScalarData=f=>(console.warn("Warning: getTimePointScalarData is deprecated. Please use getDimensionGroupScalarData instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),l.getDimensionGroupScalarData(f+1)),l.getDimensionGroupScalarData=f=>c[f-1].getCompleteScalarDataArray(),l.getCurrentTimePointScalarData=()=>(console.warn("Warning: getCurrentTimePointScalarData is deprecated. Please use getCurrentDimensionGroupScalarData instead."),l.getCurrentDimensionGroupScalarData()),l.getCurrentDimensionGroupScalarData=()=>c[s].getCompleteScalarDataArray(),l.getCurrentTimePoint=()=>(console.warn("Warning: getCurrentTimePoint is deprecated. Please use getCurrentDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),s),l.getCurrentDimensionGroupNumber=()=>s+1,l}static createImageVoxelManager({width:e,height:n,scalarData:r,numberOfComponents:i=1,id:a}){const o=[e,n,1];if(!i&&(i=r.length/e/n,i>4||i<1||i===2))throw new Error(`Number of components ${i} must be 1, 3 or 4`);return i>1?rn._createRGBScalarVolumeVoxelManager({dimensions:o,scalarData:r,numberOfComponents:i,id:a}):rn._createNumberVolumeVoxelManager({dimensions:o,scalarData:r,id:a})}static _createNumberVolumeVoxelManager({dimensions:e,scalarData:n,id:r}){const i=new rn(e,{_get:a=>n[a],_set:(a,o)=>{const s=n[a]!==o;return n[a]=o,s},_getConstructor:()=>n.constructor,_id:r||"_createNumberVolumeVoxelManager"});return i.scalarData=n,i.clear=()=>{i.scalarData.fill(0)},i.getMiddleSliceData=()=>{const a=Math.floor(e[2]/2);return i.getSliceData({sliceIndex:a,slicePlane:2})},i}static createMapVoxelManager({dimension:e,id:n}){const r=new Map,i=new rn(e,{_get:r.get.bind(r),_set:(a,o)=>r.set(a,o)&&!0,_id:n||"createMapVoxelManager"});return i.map=r,i}static createHistoryVoxelManager(e,n){const r=new Map,{dimensions:i}=e,a=new rn(i,{_get:o=>r.get(o),_set:function(o,s){if(r.has(o))s===r.get(o)&&r.delete(o);else{const c=this.sourceVoxelManager.getAtIndex(o);if(c===s)return!1;r.set(o,c)}this.sourceVoxelManager.setAtIndex(o,s)},_id:n||"createHistoryVoxelManager"});return a.map=r,a.scalarData=e.scalarData,a.sourceVoxelManager=e,a}static createRLEHistoryVoxelManager(e,n){const{dimensions:r}=e,i=new Go(r[0],r[1],r[2]),a=new rn(r,{_get:o=>i.get(o),_set:function(o,s){const c=i.get(o);if(c===void 0){const l=this.sourceVoxelManager.getAtIndex(o);if(l===s||l===void 0&&s===0||s===null)return!1;i.set(o,l??0)}else(s===c||s===null)&&(i.delete(o),s=c);this.sourceVoxelManager.setAtIndex(o,s)},_getScalarData:Go.getScalarData,_updateScalarData:o=>(i.updateScalarData(o),o),_id:n||"createRLEHistoryVoxelManager"});return a.map=i,a.sourceVoxelManager=e,a}static createLazyVoxelManager({dimensions:e,planeFactory:n,id:r}){const i=new Map,[a,o]=e,s=a*o,c=new rn(e,{_get:l=>i.get(Math.floor(l/s))[l%s],_set:(l,f)=>{const u=Math.floor(l/s);let h=i.get(u);return h||(h=n(a,o),i.set(u,h)),h[l%s]=f,!0},_id:r||"createLazyVoxelManager"});return c.map=i,c}static createRLEVolumeVoxelManager({dimensions:e,id:n}){const[r,i,a]=e,o=new Go(r,i,a),s=new rn(e,{_get:c=>o.get(c),_set:(c,l)=>(o.set(c,l),!0),_getScalarData:Go.getScalarData,_updateScalarData:c=>(o.updateScalarData(c),c),_id:n||"createRLEVolumeVoxelManager"});return s.map=o,s.getPixelData=o.getPixelData.bind(o),s}static createRLEImageVoxelManager({dimensions:e,id:n}){const[r,i]=e;return rn.createRLEVolumeVoxelManager({dimensions:[r,i,1],id:n})}static addInstanceToImage(e){const{width:n,height:r}=e,i=e.voxelManager.getScalarData();if(i.length>=n*r){e.voxelManager=rn.createScalarVolumeVoxelManager({dimensions:[n,r,1],scalarData:i});return}e.voxelManager=rn.createRLEVolumeVoxelManager({dimensions:[n,r,1]}),e.getPixelData=e.voxelManager.getPixelData,e.sizeInBytes=oA}}const sA="WebGL",kf=Object.create(null);function z8(t,e){kf[t]=e}function cA(){return Object.keys(kf)}function j8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return kf[t]&&kf[t](e)}function uA(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=n=>{t.hasRenderer(n)||(n.setRenderWindow(t),e.renderers.push(n),t.modified())},t.removeRenderer=n=>{e.renderers=e.renderers.filter(r=>r!==n),t.modified()},t.hasRenderer=n=>e.renderers.indexOf(n)!==-1,t.newAPISpecificView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return j8(n||e.defaultViewAPI,r)},t.addView=n=>{t.hasView(n)||(n.setRenderable(t),e._views.push(n),t.modified())},t.removeView=n=>{e._views=e._views.filter(r=>r!==n),t.modified()},t.hasView=n=>e._views.indexOf(n)!==-1,t.preRender=()=>{e.renderers.forEach(n=>{n.isActiveCameraCreated()||n.resetCamera()})},t.render=()=>{t.preRender(),e.interactor?e.interactor.render():e._views.forEach(n=>n.traverseAllPasses())},t.getStatistics=()=>{const n={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return e._views.forEach(r=>{r.getGraphicsMemoryInfo&&(n.gpuMemoryMB+=r.getGraphicsMemoryInfo()/1e6)}),e.renderers.forEach(r=>{const i=r.getViewProps(),a=e._views[0].getViewNodeFor(r);i.forEach(o=>{if(o.getVisibility()){n.propCount+=1;const s=o.getMapper&&o.getMapper();if(s&&s.getPrimitiveCount){const c=a.getViewNodeFor(s);if(c){c.getAllocatedGPUMemoryInBytes&&(n.gpuMemoryMB+=c.getAllocatedGPUMemoryInBytes()/1e6);const l=s.getPrimitiveCount();Object.keys(l).forEach(f=>{n[f]||(n[f]=0),n[f]+=l[f]})}}}else n.invisiblePropCount+=1})}),n.str=Object.keys(n).map(r=>`${r}: ${n[r]}`).join(`
`),n},t.captureImages=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return J.setImmediate(t.render),e._views.map(i=>i.captureNextImage?i.captureNextImage(n,r):void 0).filter(i=>!!i)},t.addRenderWindow=n=>e.childRenderWindows.includes(n)?!1:(e.childRenderWindows.push(n),t.modified(),!0),t.removeRenderWindow=n=>{const r=e.childRenderWindows.findIndex(i=>i===n);return r<0?!1:(e.childRenderWindows.splice(r,1),t.modified(),!0)}}const lA={defaultViewAPI:sA,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function $8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lA,n),J.obj(t,e),J.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),J.get(t,e,["neverRendered"]),J.getArray(t,e,["renderers","childRenderWindows"]),J.moveToProtected(t,e,["views"]),J.event(t,e,"completion"),uA(t,e)}const fA=J.newInstance($8,"vtkRenderWindow");var hA={newInstance:fA,extend:$8,registerViewConstructor:z8,listViewAPIs:cA,newAPISpecificView:j8};function pA(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=()=>e.currentOperation,t.setCurrentOperation=n=>{e.currentOperation=n,e.currentTraverseOperation=`traverse${J.capitalize(e.currentOperation)}`},t.getTraverseOperation=()=>e.currentTraverseOperation,t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=r,e.preDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}),e.delegates.forEach(i=>{i.traverse(n,t)}),e.postDelegateOperations.forEach(i=>{t.setCurrentOperation(i),n.traverse(t)}))}}const dA={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function H8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dA,n),J.obj(t,e),J.get(t,e,["currentOperation"]),J.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),J.moveToProtected(t,e,["currentParent"]),pA(t,e)}const gA=J.newInstance(H8,"vtkRenderPass");var A1={newInstance:gA,extend:H8};const{Representation:mA}=pc,{vtkErrorMacro:xv}=J;function vA(t){const e=Te.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}const yA=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function xA(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=()=>{const n=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),r=new Float32Array([0,0,1,0,0,1,1,1]),i=new Uint16Array([4,0,1,3,2]),a=ft.newInstance({numberOfComponents:3,values:n});a.setName("points");const o=ft.newInstance({numberOfComponents:2,values:r});o.setName("tcoords");const s=ft.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",mA.SURFACE,{points:a,tcoords:o,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=n=>{const r=n.getSize(),i=n.getContext();e.framebuffer=Nh.newInstance(),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.create(...r),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=fn.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(n),e.translucentRGBATexture.create2DFromRaw(r[0],r[1],4,"Float32Array",null),e.translucentRTexture=fn.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(n),e.translucentRTexture.create2DFromRaw(r[0],r[1],1,"Float32Array",null),e.translucentZTexture=fn.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(n),e.translucentZTexture.createDepthFromRaw(r[0],r[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=n=>{e.copyShader=n.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),yA,"")},t.createVBO=n=>{const r=n.getContext();e.tris.setOpenGLRenderWindow(n),t.createVertexBuffer();const i=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||xv("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(i,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||xv("Error setting vertexDC in copy shader VAO.")},t.traverse=(n,r,i)=>{if(e.deleted)return;const a=n.getSize(),o=n.getContext();if(e._supported=!1,r.getSelector()||!o||!n.getWebgl2()||!o.getExtension("EXT_color_buffer_half_float")&&!o.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),r.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(n);else{const c=e.framebuffer.getSize();c===null||c[0]!==a[0]||c[1]!==a[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRTexture.releaseGraphicsResources(n),e.translucentZTexture.releaseGraphicsResources(n),t.createFramebuffer(n)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}o.drawBuffers([o.COLOR_ATTACHMENT0]),o.clearBufferfv(o.COLOR,0,[0,0,0,0]),o.clearBufferfv(o.DEPTH,0,[1]),o.colorMask(!1,!1,!1,!1),i.getOpaqueActorCount()>0&&(i.setCurrentOperation("opaqueZBufferPass"),r.traverse(i)),o.colorMask(!0,!0,!0,!0),o.drawBuffers([o.COLOR_ATTACHMENT0,o.COLOR_ATTACHMENT1]),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),o.clearBufferfv(o.COLOR,0,[0,0,0,1]),o.clearBufferfv(o.COLOR,1,[0,0,0,0]),o.enable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFuncSeparate(o.ONE,o.ONE,o.ZERO,o.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),r.traverse(t),o.drawBuffers([o.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(n):n.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=D1.newInstance(),e.copyVAO.setOpenGLRenderWindow(n)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(n),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.depthMask(!1),o.depthFunc(o.ALWAYS),o.viewport(0,0,a[0],a[1]),o.scissor(0,0,a[0],a[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),o.drawArrays(o.TRIANGLES,0,e.tris.getCABO().getElementCount()),o.depthMask(!0),o.depthFunc(o.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate();const s=r.getTiledSizeAndOrigin();o.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),o.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize)},t.getShaderReplacement=()=>e._supported?vA:null,t.releaseGraphicsResources=n=>{e.framebuffer&&(e.framebuffer.releaseGraphicsResources(n),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(n),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(n),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(n),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(n),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(n),e.tris=null),t.modified()}}const wA={framebuffer:null,copyShader:null,tris:null};function K8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wA,n),A1.extend(t,e,n),e.VBOBuildTime={},J.obj(e.VBOBuildTime,{mtime:0}),e.tris=Ca.newInstance(),J.get(t,e,["framebuffer"]),xA(t,e)}const CA=J.newInstance(K8,"vtkOpenGLOrderIndependentTranslucentPass");var TA={newInstance:CA,extend:K8};function _A(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t);const i=n.getRenderable().getNumberOfLayers(),a=n.getRenderable().getRenderersByReference();for(let o=0;o<i;o++)for(let s=0;s<a.length;s++){const c=a[s],l=n.getViewNodeFor(c);if(c.getDraw()&&c.getLayer()===o){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),l.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){const f=n.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=Nh.newInstance()),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.saveCurrentBindingsAndBuffers();const u=e.framebuffer.getSize();(u===null||u[0]!==f[0]||u[1]!==f[1])&&(e.framebuffer.create(f[0],f[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),l.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),l.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),l.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=TA.newInstance()),e.translucentPass.traverse(n,l,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),l.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),l.traverse(t))}}},t.getZBufferTexture=()=>e.framebuffer?e.framebuffer.getColorTexture():null,t.requestDepth=()=>{e.depthRequested=!0},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.incrementVolumeCount=()=>e.volumeCount++,t.incrementOverlayActorCount=()=>e.overlayActorCount++}const SA={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function q8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SA,n),A1.extend(t,e,n),J.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),_A(t,e)}const bA=J.newInstance(q8,"vtkForwardPass");var EA={newInstance:bA,extend:q8};const Ar={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var X8={PassTypes:Ar};const{FieldAssociations:DA}=nu;function OA(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=async(n,r,i,a,o)=>{},t.selectAsync=async(n,r,i,a,o)=>{const s=await t.getSourceDataAsync(n,r,i,a,o);return s?s.generateSelection(r,i,a,o):[]}}const RA={fieldAssociation:DA.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function Y8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RA,n),J.obj(t,e),J.setGet(t,e,["fieldAssociation","captureZValues"]),OA(t,e)}const MA=J.newInstance(Y8,"vtkHardwareSelector");var NA={newInstance:MA,extend:Y8};const LA={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},AA={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5};var FA={SelectionContent:LA,SelectionField:AA};function IA(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=()=>e.points.getBounds()}const PA={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function J8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PA,n),J.obj(t,e),e.properties={},J.setGet(t,e,["contentType","fieldType","properties","selectionList"]),IA(t,e)}const VA=J.newInstance(J8,"vtkSelectionNode");var Z8={newInstance:VA,extend:J8,...FA};const{PassTypes:Nn}=X8,{SelectionContent:kA,SelectionField:wv}=Z8,{FieldAssociations:Xu}=nu,{vtkErrorMacro:Q8}=J,Wo=1;function e6(t){return`${t.propID} ${t.compositeID}`}function t6(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4;return n[i+3]}function $a(t,e,n,r){if(!n)return 0;const i=(e*(r[2]-r[0]+1)+t)*4,a=n[i],o=n[i+1];return(n[i+2]*256+o)*256+a}function n6(t,e){let n=e;return n<<=24,n|=t,n}function UA(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;const i=[e[0]-t.area[0],e[1]-t.area[1]],a=$a(i[0],i[1],t.pixBuffer[Nn.ACTOR_PASS],t.area);if(a<=0||a-Wo>=t.props.length)return null;const o={};o.valid=!0,o.propID=a-Wo,o.prop=t.props[o.propID];let s=$a(i[0],i[1],t.pixBuffer[Nn.COMPOSITE_INDEX_PASS],t.area);if((s<0||s>16777215)&&(s=0),o.compositeID=s-Wo,t.captureZValues){const f=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;o.zValue=(256*t.zBuffer[f]+t.zBuffer[f+1])/65535,o.displayPosition=e}if(t.pixBuffer[Nn.ID_LOW24]&&t6(i[0],i[1],t.pixBuffer[Nn.ID_LOW24],t.area)===0)return o;const c=$a(i[0],i[1],t.pixBuffer[Nn.ID_LOW24],t.area),l=$a(i[0],i[1],t.pixBuffer[Nn.ID_HIGH24],t.area);return o.attributeID=n6(c,l),o}}function r6(t,e,n,r,i){const a=[];let o=0;return e.forEach((s,c)=>{const l=Z8.newInstance();switch(l.setContentType(kA.INDICES),t){case Xu.FIELD_ASSOCIATION_CELLS:l.setFieldType(wv.CELL);break;case Xu.FIELD_ASSOCIATION_POINTS:l.setFieldType(wv.POINT);break;default:Q8("Unknown field association")}l.getProperties().propID=s.info.propID,l.getProperties().prop=s.info.prop,l.getProperties().compositeID=s.info.compositeID,l.getProperties().attributeID=s.info.attributeID,l.getProperties().pixelCount=s.pixelCount,n&&(l.getProperties().displayPosition=[s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue],l.getProperties().worldPosition=i.displayToWorld(s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue,r)),l.setSelectionList(s.attributeIDs),a[o]=l,o++}),a}function BA(t,e,n,r,i){const a=Math.floor(e),o=Math.floor(n),s=Math.floor(r),c=Math.floor(i),l=new Map,f=[0,0];for(let u=o;u<=c;u++)for(let h=a;h<=s;h++){const d=UA(t,[h,u],0,f);if(d&&d.valid){const g=e6(d);if(!l.has(g))l.set(g,{info:d,pixelCount:1,attributeIDs:[d.attributeID]});else{const y=l.get(g);y.pixelCount++,t.captureZValues&&d.zValue<y.info.zValue&&(y.info=d),y.attributeIDs.indexOf(d.attributeID)===-1&&y.attributeIDs.push(d.attributeID)}}}return r6(t.fieldAssociation,l,t.captureZValues,t.renderer,t.openGLRenderWindow)}function GA(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=()=>{e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=()=>{e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;const r=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=Nh.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();const i=e.framebuffer.getSize();!i||i[0]!==r[0]||i[1]!==r[1]?(e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===Xu.FIELD_ASSOCIATION_POINTS){const i=e._openGLRenderWindow.getContext(),a=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),a&&i.enable(i.BLEND)}},t.endSelection=()=>{e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending=r.isEnabled(r.BLEND),r.disable(r.BLEND)},t.postCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending&&r.enable(r.BLEND)},t.select=()=>{let r=null;return t.captureBuffers()&&(r=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),r},t.getSourceDataAsync=async(r,i,a,o,s)=>{if(e._renderer=r,i===void 0){const l=e._openGLRenderWindow.getSize();t.setArea(0,0,l[0]-1,l[1]-1)}else t.setArea(i,a,o,s);if(!t.captureBuffers())return!1;const c={area:[...e.area],pixBuffer:[...e.pixBuffer],captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:[...e.props],fieldAssociation:e.fieldAssociation,renderer:r,openGLRenderWindow:e._openGLRenderWindow};return c.generateSelection=function(){for(var l=arguments.length,f=new Array(l),u=0;u<l;u++)f[u]=arguments[u];return BA(c,...f)},c},t.captureBuffers=()=>{if(!e._renderer||!e._openGLRenderWindow)return Q8("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);const r=e._openGLRenderWindow.getRenderPasses();t.beginSelection();const i=[];for(e.currentPass=Nn.MIN_KNOWN_PASS;e.currentPass<=Nn.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===Nn.ACTOR_PASS&&typeof r[0].requestDepth=="function"&&typeof r[0].getFramebuffer=="function"&&r[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),i.push(e.currentPass));return i.forEach(a=>{e.currentPass=a,t.processPixelBuffers()}),e.currentPass=Nn.MAX_KNOWN_PASS,t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=()=>{e.props.forEach((r,i)=>{t.isPropHit(i)&&r.processSelectorPixelBuffers(t,e.propPixels[i])})},t.passRequired=r=>{if(r===Nn.ID_HIGH24){if(e.fieldAssociation===Xu.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===Xu.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=r=>{if(e.pixBuffer[r]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[r]){const i=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[r]=new Uint8Array(i),e.rawPixBuffer[r].set(e.pixBuffer[r])}if(r===Nn.ACTOR_PASS){if(e.captureZValues){const i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){const a=i[0].getFramebuffer();a.saveCurrentBindingsAndBuffers(),a.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),a.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[r])}},t.buildPropHitList=r=>{let i=0;for(let a=0;a<=e.area[3]-e.area[1];a++)for(let o=0;o<=e.area[2]-e.area[0];o++){let s=$a(o,a,r,e.area);s>0&&(s--,s in e.hitProps||(e.hitProps[s]=!0,e.propPixels[s]=[]),e.propPixels[s].push(i*4)),++i}},t.renderProp=r=>{e.currentPass===Nn.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Wo),e.props.push(r))},t.renderCompositeIndex=r=>{e.currentPass===Nn.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(r+Wo)},t.renderAttributeId=r=>{r<0||(e.maxAttributeId=r>e.maxAttributeId?r:e.maxAttributeId)},t.passTypeToString=r=>J.enumToString(Nn,r),t.isPropHit=r=>!!e.hitProps[r],t.setPropColorValueFromInt=r=>{e.propColorValue[0]=r%256/255,e.propColorValue[1]=Math.floor(r/256)%256/255,e.propColorValue[2]=Math.floor(r/65536)%256/255},t.getPixelInformation=(r,i,a)=>{const o=i<0?0:i;if(o===0){if(a[0]=r[0],a[1]=r[1],r[0]<e.area[0]||r[0]>e.area[2]||r[1]<e.area[1]||r[1]>e.area[3])return null;const f=[r[0]-e.area[0],r[1]-e.area[1]],u=$a(f[0],f[1],e.pixBuffer[Nn.ACTOR_PASS],e.area);if(u<=0||u-Wo>=e.props.length)return null;const h={};h.valid=!0,h.propID=u-Wo,h.prop=e.props[h.propID];let p=$a(f[0],f[1],e.pixBuffer[Nn.COMPOSITE_INDEX_PASS],e.area);if((p<0||p>16777215)&&(p=0),h.compositeID=p-Wo,e.captureZValues){const y=(f[1]*(e.area[2]-e.area[0]+1)+f[0])*4;h.zValue=(256*e.zBuffer[y]+e.zBuffer[y+1])/65535,h.displayPosition=r}if(e.pixBuffer[Nn.ID_LOW24]&&t6(f[0],f[1],e.pixBuffer[Nn.ID_LOW24],e.area)===0)return h;const d=$a(f[0],f[1],e.pixBuffer[Nn.ID_LOW24],e.area),g=$a(f[0],f[1],e.pixBuffer[Nn.ID_HIGH24],e.area);return h.attributeID=n6(d,g),h}const s=[r[0],r[1]],c=[0,0];let l=t.getPixelInformation(r,0,a);if(l&&l.valid)return l;for(let f=1;f<o;++f){for(let u=s[1]>f?s[1]-f:0;u<=s[1]+f;++u)if(c[1]=u,s[0]>=f&&(c[0]=s[0]-f,l=t.getPixelInformation(c,0,a),l&&l.valid)||(c[0]=s[0]+f,l=t.getPixelInformation(c,0,a),l&&l.valid))return l;for(let u=s[0]>=f?s[0]-(f-1):0;u<=s[0]+(f-1);++u)if(c[0]=u,s[1]>=f&&(c[1]=s[1]-f,l=t.getPixelInformation(c,0,a),l&&l.valid)||(c[1]=s[1]+f,l=t.getPixelInformation(c,0,a),l&&l.valid))return l}return a[0]=r[0],a[1]=r[1],null},t.generateSelection=(r,i,a,o)=>{const s=Math.floor(r),c=Math.floor(i),l=Math.floor(a),f=Math.floor(o),u=new Map,h=[0,0];for(let p=c;p<=f;p++)for(let d=s;d<=l;d++){const g=[d,p],y=t.getPixelInformation(g,0,h);if(y&&y.valid){const x=e6(y);if(!u.has(x))u.set(x,{info:y,pixelCount:1,attributeIDs:[y.attributeID]});else{const m=u.get(x);m.pixelCount++,e.captureZValues&&y.zValue<m.info.zValue&&(m.info=y),m.attributeIDs.indexOf(y.attributeID)===-1&&m.attributeIDs.push(y.attributeID)}}}return r6(e.fieldAssociation,u,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=r=>e.rawPixBuffer[r],t.getPixelBuffer=r=>e.pixBuffer[r],t.attach=(r,i)=>{e._openGLRenderWindow=r,e._renderer=i};const n=t.setArea;t.setArea=function(){return n(...arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}const WA={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function i6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WA,n),NA.extend(t,e,n),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),J.setGetArray(t,e,["area"],4),J.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),J.setGetArray(t,e,["propColorValue"],3),J.moveToProtected(t,e,["renderer","openGLRenderWindow"]),J.event(t,e,"event"),GA(t,e)}const zA=J.newInstance(i6,"vtkOpenGLHardwareSelector");var F1={newInstance:zA,extend:i6,...X8},Op={exports:{}},Cv;function jA(){return Cv||(Cv=1,function(t,e){(function(n){t.exports=n()})(function(n){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function i(x,m){var v=x[0],w=x[1],C=x[2],T=x[3];v+=(w&C|~w&T)+m[0]-680876936|0,v=(v<<7|v>>>25)+w|0,T+=(v&w|~v&C)+m[1]-389564586|0,T=(T<<12|T>>>20)+v|0,C+=(T&v|~T&w)+m[2]+606105819|0,C=(C<<17|C>>>15)+T|0,w+=(C&T|~C&v)+m[3]-1044525330|0,w=(w<<22|w>>>10)+C|0,v+=(w&C|~w&T)+m[4]-176418897|0,v=(v<<7|v>>>25)+w|0,T+=(v&w|~v&C)+m[5]+1200080426|0,T=(T<<12|T>>>20)+v|0,C+=(T&v|~T&w)+m[6]-1473231341|0,C=(C<<17|C>>>15)+T|0,w+=(C&T|~C&v)+m[7]-45705983|0,w=(w<<22|w>>>10)+C|0,v+=(w&C|~w&T)+m[8]+1770035416|0,v=(v<<7|v>>>25)+w|0,T+=(v&w|~v&C)+m[9]-1958414417|0,T=(T<<12|T>>>20)+v|0,C+=(T&v|~T&w)+m[10]-42063|0,C=(C<<17|C>>>15)+T|0,w+=(C&T|~C&v)+m[11]-1990404162|0,w=(w<<22|w>>>10)+C|0,v+=(w&C|~w&T)+m[12]+1804603682|0,v=(v<<7|v>>>25)+w|0,T+=(v&w|~v&C)+m[13]-40341101|0,T=(T<<12|T>>>20)+v|0,C+=(T&v|~T&w)+m[14]-1502002290|0,C=(C<<17|C>>>15)+T|0,w+=(C&T|~C&v)+m[15]+1236535329|0,w=(w<<22|w>>>10)+C|0,v+=(w&T|C&~T)+m[1]-165796510|0,v=(v<<5|v>>>27)+w|0,T+=(v&C|w&~C)+m[6]-1069501632|0,T=(T<<9|T>>>23)+v|0,C+=(T&w|v&~w)+m[11]+643717713|0,C=(C<<14|C>>>18)+T|0,w+=(C&v|T&~v)+m[0]-373897302|0,w=(w<<20|w>>>12)+C|0,v+=(w&T|C&~T)+m[5]-701558691|0,v=(v<<5|v>>>27)+w|0,T+=(v&C|w&~C)+m[10]+38016083|0,T=(T<<9|T>>>23)+v|0,C+=(T&w|v&~w)+m[15]-660478335|0,C=(C<<14|C>>>18)+T|0,w+=(C&v|T&~v)+m[4]-405537848|0,w=(w<<20|w>>>12)+C|0,v+=(w&T|C&~T)+m[9]+568446438|0,v=(v<<5|v>>>27)+w|0,T+=(v&C|w&~C)+m[14]-1019803690|0,T=(T<<9|T>>>23)+v|0,C+=(T&w|v&~w)+m[3]-187363961|0,C=(C<<14|C>>>18)+T|0,w+=(C&v|T&~v)+m[8]+1163531501|0,w=(w<<20|w>>>12)+C|0,v+=(w&T|C&~T)+m[13]-1444681467|0,v=(v<<5|v>>>27)+w|0,T+=(v&C|w&~C)+m[2]-51403784|0,T=(T<<9|T>>>23)+v|0,C+=(T&w|v&~w)+m[7]+1735328473|0,C=(C<<14|C>>>18)+T|0,w+=(C&v|T&~v)+m[12]-1926607734|0,w=(w<<20|w>>>12)+C|0,v+=(w^C^T)+m[5]-378558|0,v=(v<<4|v>>>28)+w|0,T+=(v^w^C)+m[8]-2022574463|0,T=(T<<11|T>>>21)+v|0,C+=(T^v^w)+m[11]+1839030562|0,C=(C<<16|C>>>16)+T|0,w+=(C^T^v)+m[14]-35309556|0,w=(w<<23|w>>>9)+C|0,v+=(w^C^T)+m[1]-1530992060|0,v=(v<<4|v>>>28)+w|0,T+=(v^w^C)+m[4]+1272893353|0,T=(T<<11|T>>>21)+v|0,C+=(T^v^w)+m[7]-155497632|0,C=(C<<16|C>>>16)+T|0,w+=(C^T^v)+m[10]-1094730640|0,w=(w<<23|w>>>9)+C|0,v+=(w^C^T)+m[13]+681279174|0,v=(v<<4|v>>>28)+w|0,T+=(v^w^C)+m[0]-358537222|0,T=(T<<11|T>>>21)+v|0,C+=(T^v^w)+m[3]-722521979|0,C=(C<<16|C>>>16)+T|0,w+=(C^T^v)+m[6]+76029189|0,w=(w<<23|w>>>9)+C|0,v+=(w^C^T)+m[9]-640364487|0,v=(v<<4|v>>>28)+w|0,T+=(v^w^C)+m[12]-421815835|0,T=(T<<11|T>>>21)+v|0,C+=(T^v^w)+m[15]+530742520|0,C=(C<<16|C>>>16)+T|0,w+=(C^T^v)+m[2]-995338651|0,w=(w<<23|w>>>9)+C|0,v+=(C^(w|~T))+m[0]-198630844|0,v=(v<<6|v>>>26)+w|0,T+=(w^(v|~C))+m[7]+1126891415|0,T=(T<<10|T>>>22)+v|0,C+=(v^(T|~w))+m[14]-1416354905|0,C=(C<<15|C>>>17)+T|0,w+=(T^(C|~v))+m[5]-57434055|0,w=(w<<21|w>>>11)+C|0,v+=(C^(w|~T))+m[12]+1700485571|0,v=(v<<6|v>>>26)+w|0,T+=(w^(v|~C))+m[3]-1894986606|0,T=(T<<10|T>>>22)+v|0,C+=(v^(T|~w))+m[10]-1051523|0,C=(C<<15|C>>>17)+T|0,w+=(T^(C|~v))+m[1]-2054922799|0,w=(w<<21|w>>>11)+C|0,v+=(C^(w|~T))+m[8]+1873313359|0,v=(v<<6|v>>>26)+w|0,T+=(w^(v|~C))+m[15]-30611744|0,T=(T<<10|T>>>22)+v|0,C+=(v^(T|~w))+m[6]-1560198380|0,C=(C<<15|C>>>17)+T|0,w+=(T^(C|~v))+m[13]+1309151649|0,w=(w<<21|w>>>11)+C|0,v+=(C^(w|~T))+m[4]-145523070|0,v=(v<<6|v>>>26)+w|0,T+=(w^(v|~C))+m[11]-1120210379|0,T=(T<<10|T>>>22)+v|0,C+=(v^(T|~w))+m[2]+718787259|0,C=(C<<15|C>>>17)+T|0,w+=(T^(C|~v))+m[9]-343485551|0,w=(w<<21|w>>>11)+C|0,x[0]=v+x[0]|0,x[1]=w+x[1]|0,x[2]=C+x[2]|0,x[3]=T+x[3]|0}function a(x){var m=[],v;for(v=0;v<64;v+=4)m[v>>2]=x.charCodeAt(v)+(x.charCodeAt(v+1)<<8)+(x.charCodeAt(v+2)<<16)+(x.charCodeAt(v+3)<<24);return m}function o(x){var m=[],v;for(v=0;v<64;v+=4)m[v>>2]=x[v]+(x[v+1]<<8)+(x[v+2]<<16)+(x[v+3]<<24);return m}function s(x){var m=x.length,v=[1732584193,-271733879,-1732584194,271733878],w,C,T,_,S,b;for(w=64;w<=m;w+=64)i(v,a(x.substring(w-64,w)));for(x=x.substring(w-64),C=x.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<C;w+=1)T[w>>2]|=x.charCodeAt(w)<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(v,T),w=0;w<16;w+=1)T[w]=0;return _=m*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),S=parseInt(_[2],16),b=parseInt(_[1],16)||0,T[14]=S,T[15]=b,i(v,T),v}function c(x){var m=x.length,v=[1732584193,-271733879,-1732584194,271733878],w,C,T,_,S,b;for(w=64;w<=m;w+=64)i(v,o(x.subarray(w-64,w)));for(x=w-64<m?x.subarray(w-64):new Uint8Array(0),C=x.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=0;w<C;w+=1)T[w>>2]|=x[w]<<(w%4<<3);if(T[w>>2]|=128<<(w%4<<3),w>55)for(i(v,T),w=0;w<16;w+=1)T[w]=0;return _=m*8,_=_.toString(16).match(/(.*?)(.{0,8})$/),S=parseInt(_[2],16),b=parseInt(_[1],16)||0,T[14]=S,T[15]=b,i(v,T),v}function l(x){var m="",v;for(v=0;v<4;v+=1)m+=r[x>>v*8+4&15]+r[x>>v*8&15];return m}function f(x){var m;for(m=0;m<x.length;m+=1)x[m]=l(x[m]);return x.join("")}f(s("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function x(m,v){return m=m|0||0,m<0?Math.max(m+v,0):Math.min(m,v)}ArrayBuffer.prototype.slice=function(m,v){var w=this.byteLength,C=x(m,w),T=w,_,S,b,D;return v!==n&&(T=x(v,w)),C>T?new ArrayBuffer(0):(_=T-C,S=new ArrayBuffer(_),b=new Uint8Array(S),D=new Uint8Array(this,C,_),b.set(D),S)}}();function u(x){return/[\u0080-\uFFFF]/.test(x)&&(x=unescape(encodeURIComponent(x))),x}function h(x,m){var v=x.length,w=new ArrayBuffer(v),C=new Uint8Array(w),T;for(T=0;T<v;T+=1)C[T]=x.charCodeAt(T);return m?C:w}function p(x){return String.fromCharCode.apply(null,new Uint8Array(x))}function d(x,m,v){var w=new Uint8Array(x.byteLength+m.byteLength);return w.set(new Uint8Array(x)),w.set(new Uint8Array(m),x.byteLength),w}function g(x){var m=[],v=x.length,w;for(w=0;w<v-1;w+=2)m.push(parseInt(x.substr(w,2),16));return String.fromCharCode.apply(String,m)}function y(){this.reset()}return y.prototype.append=function(x){return this.appendBinary(u(x)),this},y.prototype.appendBinary=function(x){this._buff+=x,this._length+=x.length;var m=this._buff.length,v;for(v=64;v<=m;v+=64)i(this._hash,a(this._buff.substring(v-64,v)));return this._buff=this._buff.substring(v-64),this},y.prototype.end=function(x){var m=this._buff,v=m.length,w,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T;for(w=0;w<v;w+=1)C[w>>2]|=m.charCodeAt(w)<<(w%4<<3);return this._finish(C,v),T=f(this._hash),x&&(T=g(T)),this.reset(),T},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},y.prototype.setState=function(x){return this._buff=x.buff,this._length=x.length,this._hash=x.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(x,m){var v=m,w,C,T;if(x[v>>2]|=128<<(v%4<<3),v>55)for(i(this._hash,x),v=0;v<16;v+=1)x[v]=0;w=this._length*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),C=parseInt(w[2],16),T=parseInt(w[1],16)||0,x[14]=C,x[15]=T,i(this._hash,x)},y.hash=function(x,m){return y.hashBinary(u(x),m)},y.hashBinary=function(x,m){var v=s(x),w=f(v);return m?g(w):w},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(x){var m=d(this._buff.buffer,x),v=m.length,w;for(this._length+=x.byteLength,w=64;w<=v;w+=64)i(this._hash,o(m.subarray(w-64,w)));return this._buff=w-64<v?new Uint8Array(m.buffer.slice(w-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(x){var m=this._buff,v=m.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C,T;for(C=0;C<v;C+=1)w[C>>2]|=m[C]<<(C%4<<3);return this._finish(w,v),T=f(this._hash),x&&(T=g(T)),this.reset(),T},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var x=y.prototype.getState.call(this);return x.buff=p(x.buff),x},y.ArrayBuffer.prototype.setState=function(x){return x.buff=h(x.buff,!0),y.prototype.setState.call(this,x)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(x,m){var v=c(new Uint8Array(x)),w=f(v);return m?g(w):w},y})}(Op)),Op.exports}var $A=jA();const HA=wa($A),KA=["lastShaderProgramBound","context","_openGLRenderWindow"];function qA(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=(n,r,i)=>{let a=r;i.length>0&&(a=Te.substitute(a,"VSOut","GSOut").result);const o=e._openGLRenderWindow.getWebgl2();let s=`
`,c=`#version 100
`;o?c=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(s=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(s+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),a=Te.substitute(a,"//VTK::System::Dec",[`${c}
`,o?"":`#extension GL_OES_standard_derivatives : enable
`,s,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let l=Te.substitute(n,"//VTK::System::Dec",[`${c}
`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(o){l=Te.substitute(l,"varying","out").result,a=Te.substitute(a,"varying","in").result;let u="",h=0;for(;a.includes(`gl_FragData[${h}]`);)a=Te.substitute(a,`gl_FragData\\[${h}\\]`,`fragOutput${h}`).result,u+=`layout(location = ${h}) out vec4 fragOutput${h};
`,h++;a=Te.substitute(a,"//VTK::Output::Dec",u).result}const f=Te.substitute(i,"//VTK::System::Dec",c).result;return{VSSource:l,FSSource:a,GSSource:f}},t.readyShaderProgramArray=(n,r,i)=>{const a=t.replaceShaderValues(n,r,i),o=t.getShaderProgram(a.VSSource,a.FSSource,a.GSSource);return t.readyShaderProgram(o)},t.readyShaderProgram=n=>!n||!n.getCompiled()&&!n.compileShader()||!t.bindShaderProgram(n)?null:n,t.getShaderProgram=(n,r,i)=>{const a=`${n}${r}${i}`,o=HA.hash(a);if(!(o in e.shaderPrograms)){const s=Te.newInstance();return s.setContext(e.context),s.getVertexShader().setSource(n),s.getFragmentShader().setSource(r),i&&s.getGeometryShader().setSource(i),s.setMd5Hash(o),e.shaderPrograms[o]=s,s}return e.shaderPrograms[o]},t.releaseGraphicsResources=n=>{t.releaseCurrentShaderProgram(),Object.keys(e.shaderPrograms).map(r=>e.shaderPrograms[r]).forEach(r=>r.cleanup()),e.shaderPrograms={}},t.releaseCurrentShaderProgram=()=>{e.lastShaderProgramBound&&(e.lastShaderProgramBound.cleanup(),e.lastShaderProgramBound=null)},t.bindShaderProgram=n=>(e.lastShaderProgramBound===n||(e.lastShaderProgramBound&&e.lastShaderProgramBound.release(),n.bind(),e.lastShaderProgramBound=n),1)}const XA={lastShaderProgramBound:null,shaderPrograms:null,context:null};function a6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XA,n),e.shaderPrograms={},J.obj(t,e),J.setGet(t,e,KA),J.moveToProtected(t,e,["openGLRenderWindow"]),qA(t,e)}const YA=J.newInstance(a6,"vtkShaderCache");var JA={newInstance:YA,extend:a6};const{vtkErrorMacro:ZA}=J;function QA(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]===!0&&ZA("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=n=>{if(e.context!==n){if(e.context!==0&&t.deleteTable(),e.context=n,e.context){e.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]=!1}t.modified()}},t.allocate=()=>{for(let n=0;n<e.numberOfTextureUnits;n++)if(!t.isAllocated(n))return e.textureUnits[n]=!0,n;return-1},t.allocateUnit=n=>t.isAllocated(n)?-1:(e.textureUnits[n]=!0,n),t.isAllocated=n=>e.textureUnits[n],t.free=n=>{e.textureUnits[n]=!1},t.freeAll=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}}const eF={context:null,numberOfTextureUnits:0,textureUnits:0};function o6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eF,n),J.obj(t,e),e.textureUnits=[],J.get(t,e,["numberOfTextureUnits"]),J.setGet(t,e,["context"]),QA(t,e)}const tF=J.newInstance(o6,"vtkOpenGLTextureUnitManager");var nF={newInstance:tF,extend:o6};function rF(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=()=>null,t.getAspectRatio=()=>e.size[0]/e.size[1],t.getAspectRatioForRenderer=n=>{const r=n.getViewportByReference();return e.size[0]*(r[2]-r[0])/((r[3]-r[1])*e.size[1])},t.isInViewport=(n,r,i)=>{const a=i.getViewportByReference(),o=t.getFramebufferSize();return a[0]*o[0]<=n&&a[2]*o[0]>=n&&a[1]*o[1]<=r&&a[3]*o[1]>=r},t.getViewportSize=n=>{const r=n.getViewportByReference(),i=t.getFramebufferSize();return[(r[2]-r[0])*i[0],(r[3]-r[1])*i[1]]},t.getViewportCenter=n=>{const r=t.getViewportSize(n);return[r[0]*.5,r[1]*.5]},t.displayToNormalizedDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n/a[0],r/a[1],i]},t.normalizedDisplayToDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n*a[0],r*a[1],i]},t.worldToView=(n,r,i,a)=>a.worldToView(n,r,i),t.viewToWorld=(n,r,i,a)=>a.viewToWorld(n,r,i),t.worldToDisplay=(n,r,i,a)=>{const o=a.worldToView(n,r,i),s=t.getViewportSize(a),c=a.viewToProjection(o[0],o[1],o[2],s[0]/s[1]),l=a.projectionToNormalizedDisplay(c[0],c[1],c[2]);return t.normalizedDisplayToDisplay(l[0],l[1],l[2])},t.displayToWorld=(n,r,i,a)=>{const o=t.displayToNormalizedDisplay(n,r,i),s=a.normalizedDisplayToProjection(o[0],o[1],o[2]),c=t.getViewportSize(a),l=a.projectionToView(s[0],s[1],s[2],c[0]/c[1]);return a.viewToWorld(l[0],l[1],l[2])},t.normalizedDisplayToViewport=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=t.normalizedDisplayToDisplay(n,r,i);return[s[0]-o[0]-.5,s[1]-o[1]-.5,i]},t.viewportToNormalizedViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return o&&o[0]!==0&&o[1]!==0?[n/(o[0]-1),r/(o[1]-1),i]:[n,r,i]},t.normalizedViewportToViewport=(n,r,i,a)=>{const o=t.getViewportSize(a);return[n*(o[0]-1),r*(o[1]-1),i]},t.displayToLocalDisplay=(n,r,i)=>{const a=t.getFramebufferSize();return[n,a[1]-r-1,i]},t.viewportToNormalizedDisplay=(n,r,i,a)=>{let o=a.getViewportByReference();o=t.normalizedDisplayToDisplay(o[0],o[1],0);const s=n+o[0]+.5,c=r+o[1]+.5;return t.displayToNormalizedDisplay(s,c,i)},t.getComputedDevicePixelRatio=()=>e.size[0]/t.getContainerSize()[0],t.getContainerSize=()=>{J.vtkErrorMacro("not implemented")},t.getPixelData=(n,r,i,a)=>{J.vtkErrorMacro("not implemented")},t.createSelector=()=>{J.vtkErrorMacro("not implemented")}}const iF={size:void 0,selector:void 0};function s6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iF,n),e.size||(e.size=[300,300]),J.getArray(t,e,["size"],2),J.get(t,e,["selector"]),en.extend(t,e,n),rF(t,e)}const aF=J.newInstance(s6,"vtkRenderWindowViewNode");var oF={newInstance:aF,extend:s6};const sF="__getUnderlyingContext";function cF(){const t=new Map,e={apply(i,a,o){return t.has(o[0])?t.get(o[0]):i.apply(a,o)}};function n(i){return{apply(a,o,s){return t.set(i,s[0]),a.apply(o,s)}}}const r=Object.create(null);return r.getParameter=(i,a,o,s)=>new Proxy(s.bind(i),e),r.depthMask=(i,a,o,s)=>new Proxy(s.bind(i),n(i.DEPTH_WRITEMASK)),{get(i,a,o){if(a===sF)return()=>i;let s=Reflect.get(i,a,i);s instanceof Function&&(s=s.bind(i));const c=r[a];return c?c(i,a,o,s):s}}}const{vtkDebugMacro:Tv,vtkErrorMacro:_v}=J,uF={position:"absolute",top:0,left:0,width:"100%",height:"100%"},lF=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function Dr(t,e,n){const r=t.createFramebuffer(),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,n,null),t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),a===t.FRAMEBUFFER_COMPLETE}let Uf=0;const Lh=[];function fF(){Uf++,Lh.forEach(t=>t(Uf))}function hF(){Uf--,Lh.forEach(t=>t(Uf))}function pF(t){Lh.push(t)}function dF(t){return Lh.pop()}function Sv(t){t.preventDefault()}function gF(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");let n;function r(){return n||(n=cF()),n}t.getViewNodeFactory=()=>e.myFactory,e.canvas.addEventListener("webglcontextlost",Sv,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);const i=[0,0];function a(){e.renderable&&(e.size[0]!==i[0]||e.size[1]!==i[1])&&(i[0]=e.size[0],i[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(a),t.buildPass=u=>{if(u){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.addMissingNodes(e.renderable.getChildRenderWindowsByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(h=>{h.setOpenGLRenderWindow?.(t)})}},t.initialize=()=>{if(!e.initialized){if(e.rootOpenGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.rootOpenGLRenderWindow)e.context2D=t.get2DContext();else{e.context=t.get3DContext(),t.resizeFromChildRenderWindows(),e.context&&fF(),e.textureUnitManager=nF.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);const u=e.context;u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA),u.depthFunc(u.LEQUAL),u.enable(u.BLEND)}e.initialized=!0}},t.makeCurrent=()=>{e.context.makeCurrent()},t.setContainer=u=>{e.el&&e.el!==u&&(e.canvas.parentNode!==e.el&&_v("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==u&&(e.el=u,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:u,height:h}=e.el.getBoundingClientRect();e.containerSize=[u,h]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.activeFramebuffer?.getSize()||e.size,t.getPixelData=(u,h,p,d)=>{const g=new Uint8Array((p-u+1)*(d-h+1)*4);return e.context.readPixels(u,h,p-u+1,d-h+1,e.context.RGBA,e.context.UNSIGNED_BYTE,g),g},t.get3DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},h=null;const p=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&p&&(h=e.canvas.getContext("webgl2",u),h&&(e.webgl2=!0,Tv("using webgl2"))),h||(Tv("using webgl1"),h=e.canvas.getContext("webgl",u)||e.canvas.getContext("experimental-webgl",u)),new Proxy(h,r())},t.get2DContext=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.canvas.getContext("2d",u)},t.restoreContext=()=>{const u=A1.newInstance();u.setCurrentOperation("Release"),u.traverse(t,null)},t.activateTexture=u=>{const h=e._textureResourceIds.get(u);if(h!==void 0){e.context.activeTexture(e.context.TEXTURE0+h);return}const p=t.getTextureUnitManager().allocate();if(p<0){_v("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(u,p),e.context.activeTexture(e.context.TEXTURE0+p)},t.deactivateTexture=u=>{const h=e._textureResourceIds.get(u);h!==void 0&&(t.getTextureUnitManager().free(h),e._textureResourceIds.delete(u))},t.getTextureUnitForTexture=u=>{const h=e._textureResourceIds.get(u);return h!==void 0?h:-1},t.getDefaultTextureByteSize=function(u){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e.webgl2)switch(u){case Ot.CHAR:case Ot.SIGNED_CHAR:case Ot.UNSIGNED_CHAR:return 1;case h:case p:case Ot.UNSIGNED_SHORT:case Ot.SHORT:case Ot.VOID:return 2;default:return 4}return 1},t.getDefaultTextureInternalFormat=function(u,h){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(u){case Ot.UNSIGNED_CHAR:switch(h){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(p&&!d&&Ot.UNSIGNED_SHORT):switch(h){case 1:return p.R16_EXT;case 2:return p.RG16_EXT;case 3:return p.RGB16_EXT;case 4:default:return p.RGBA16_EXT}case(p&&!d&&Ot.SHORT):switch(h){case 1:return p.R16_SNORM_EXT;case 2:return p.RG16_SNORM_EXT;case 3:return p.RGB16_SNORM_EXT;case 4:default:return p.RGBA16_SNORM_EXT}case Ot.UNSIGNED_SHORT:case Ot.SHORT:case Ot.FLOAT:default:switch(h){case 1:return d?e.context.R16F:e.context.R32F;case 2:return d?e.context.RG16F:e.context.RG32F;case 3:return d?e.context.RGB16F:e.context.RGB32F;case 4:default:return d?e.context.RGBA16F:e.context.RGBA32F}}switch(h){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=u=>{e.bgImage.src=u.src},t.setUseBackgroundImage=u=>{e.useBackgroundImage=u,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function o(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const h=document.createElement("canvas"),p=h.getContext("2d");h.width=e.canvas.width,h.height=e.canvas.height,p.drawImage(e.canvas,0,0);const d=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(m=>{m.getViewProps().forEach(w=>{if(w.getContainer){const T=w.getContainer().getElementsByTagName("canvas");for(let _=0;_<T.length;_++){const S=T[_],b=S.getBoundingClientRect(),D=b.x-d.x,E=b.y-d.y;p.drawImage(S,D,E)}}})});const x=h.toDataURL(u);h.remove(),t.invokeImageReady(x)}t.captureNextImage=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:h=!1,size:p=null,scale:d=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=u;const g=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:p||d!==1?p||e.size.map(y=>y*d):null},new Promise((y,x)=>{const m=t.onImageReady(v=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=g,m.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(w=>{let{restoreParamsFn:C,arg:T}=w;return C(T)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),y(v);else{const w=document.createElement("img");if(w.style=uF,w.src=v,e._screenshot.placeHolder=e.el.appendChild(w),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),e._screenshot.size=null,t.modified(),h){const C=h!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(T=>{const _=T.getActiveCamera(),S=_.get("focalPoint","position","parallelScale");return{resetCameraArgs:C?{renderer:T}:void 0,resetCameraFn:C?h:T.resetCamera,restoreParamsFn:_.set,arg:JSON.parse(JSON.stringify(S))}}),e._screenshot.cameras.forEach(T=>{let{resetCameraFn:_,resetCameraArgs:S}=T;return _(S)})}t.traverseAllPasses()}})})};let s;t.getHardwareMaximumLineWidth=()=>{if(s!=null)return s;const u=t.get3DContext(),h=u.getParameter(u.ALIASED_LINE_WIDTH_RANGE);return s=h[1],h[1]},t.getGLInformations=()=>{if(e._glInformation)return e._glInformation;const u=t.get3DContext(),h=u.getExtension("OES_texture_float"),p=u.getExtension("OES_texture_half_float"),d=u.getExtension("WEBGL_debug_renderer_info"),g=u.getExtension("WEBGL_draw_buffers"),y=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),x=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",u.getParameter(u.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",u.getParameter(u.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",u.getParameter(u.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",y&&u.getParameter(y.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",u.getParameter(u.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",u.getParameter(u.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",u.getParameter(u.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",u.getParameter(u.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",u.getParameter(u.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",u.getParameter(u.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",u.getParameter(u.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",u.getParameter(u.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",u.getParameter(u.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",u.getParameter(u.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",u.getParameter(u.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",u.getParameter(u.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",u.getParameter(u.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[h&&Dr(u,u.RGBA,u.UNSIGNED_BYTE)?"RGBA":"",h&&Dr(u,u.RGB,u.UNSIGNED_BYTE)?"RGB":"",h&&Dr(u,u.LUMINANCE,u.UNSIGNED_BYTE)?"LUMINANCE":"",h&&Dr(u,u.ALPHA,u.UNSIGNED_BYTE)?"ALPHA":"",h&&Dr(u,u.LUMINANCE_ALPHA,u.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[p&&Dr(u,u.RGBA,p.HALF_FLOAT_OES)?"RGBA":"",p&&Dr(u,u.RGB,p.HALF_FLOAT_OES)?"RGB":"",p&&Dr(u,u.LUMINANCE,p.HALF_FLOAT_OES)?"LUMINANCE":"",p&&Dr(u,u.ALPHA,p.HALF_FLOAT_OES)?"ALPHA":"",p&&Dr(u,u.LUMINANCE_ALPHA,p.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[h&&Dr(u,u.RGBA,u.FLOAT)?"RGBA":"",h&&Dr(u,u.RGB,u.FLOAT)?"RGB":"",h&&Dr(u,u.LUMINANCE,u.FLOAT)?"LUMINANCE":"",h&&Dr(u,u.ALPHA,u.FLOAT)?"ALPHA":"",h&&Dr(u,u.LUMINANCE_ALPHA,u.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",g?u.getParameter(g.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).precision," (-2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMin,"</sup> - 2<sup>",u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",u.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",u.getParameter(u.RENDERER)],["WebGL Vendor","VENDOR",u.getParameter(u.VENDOR)],["WebGL Version","VERSION",u.getParameter(u.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",u.getParameter(u.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",d&&u.getParameter(d.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",d&&u.getParameter(d.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],m={};for(;x.length;){const[v,w,C]=x.pop();w&&(m[w]={label:v,value:C})}return e._glInformation=m,m},t.traverseAllPasses=()=>{if(e.renderPasses)for(let h=0;h<e.renderPasses.length;++h)e.renderPasses[h].traverse(t,null);t.copyParentContent(),e.notifyStartCaptureImage&&o();const u=e.renderable.getChildRenderWindowsByReference();for(let h=0;h<u.length;++h)t.getViewNodeFor(u[h])?.traverseAllPasses()},t.copyParentContent=()=>{const u=e.rootOpenGLRenderWindow;if(!u||!e.context2D||e.children.some(d=>!!d.getSelector?.()))return;const h=u.getCanvas(),p=e.canvas;e.context2D.drawImage(h,0,h.height-p.height,p.width,p.height,0,0,p.width,p.height)},t.resizeFromChildRenderWindows=()=>{const u=e.renderable.getChildRenderWindowsByReference();if(u.length>0){const h=[0,0];for(let p=0;p<u.length;++p){const d=t.getViewNodeFor(u[p])?.getSize();d&&(h[0]=d[0]>h[0]?d[0]:h[0],h[1]=d[1]>h[1]?d[1]:h[1])}t.setSize(...h)}},t.disableCullFace=()=>{e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=()=>{e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=u=>{if(e.viewStream===u)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=u,e.viewStream){const h=e.renderable.getRenderers()[0];h.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(p=>t.setBackgroundImage(p.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=()=>{const u=F1.newInstance();return u.setOpenGLRenderWindow(t),u};function c(){e.canvas.removeEventListener("webglcontextlost",Sv),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=J.chain(()=>{e.context&&hF(),t.setContainer(),t.setViewStream()},c,t.delete),t.setActiveFramebuffer=u=>{e.activeFramebuffer=u};const l=t.setSize;t.setSize=(u,h)=>{const p=l(u,h);return p&&t.invokeWindowResizeEvent({width:u,height:h}),p},t.registerGraphicsResourceUser=(u,h)=>{e._graphicsResources.has(u)||t.setGraphicsResourceForObject(u,null,null),e._graphicsResources.get(u)?.users.add(h)},t.unregisterGraphicsResourceUser=(u,h)=>{const p=e._graphicsResources.get(u);p&&(p.users.delete(h),p.users.size||(p.oglObject?.releaseGraphicsResources(t),e._graphicsResources.delete(u)))},t.getGraphicsResourceForObject=u=>e._graphicsResources.get(u),t.setGraphicsResourceForObject=(u,h,p)=>{if(!u)return;const d=e._graphicsResources.get(u);d?.oglObject?.releaseGraphicsResources(t),e._graphicsResources.set(u,{coreObject:u,oglObject:h,hash:p,users:d?.users??new Set})},t.getGraphicsMemoryInfo=()=>{let u=0;return e._graphicsResources.forEach(h=>{let{oglObject:p}=h;u+=p.getAllocatedGPUMemoryInBytes()}),u},t.releaseGraphicsResources=()=>{e.shaderCache!==null&&e.shaderCache.releaseGraphicsResources(t),e._graphicsResources.forEach(u=>{let{oglObject:h}=u;h.releaseGraphicsResources(t)}),e._graphicsResources.clear(),e.textureUnitManager!==null&&e.textureUnitManager.freeAll(),e.renderable.getRenderersByReference().forEach(u=>{t.getViewNodeFor(u)?.releaseGraphicsResources()})};const f={...t};lF.forEach(u=>{t[u]=function(){return e.rootOpenGLRenderWindow?e.rootOpenGLRenderWindow[u](...arguments):f[u](...arguments)}})}const mF={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function c6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mF,n),oF.extend(t,e,n),e.canvas||(e.canvas=document.createElement("canvas"),e.canvas.style.width="100%"),e.selector||(e.selector=F1.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e._graphicsResources=new Map,e._glInformation=null,e.myFactory=ED.newInstance(),e.shaderCache=JA.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=EA.newInstance(),J.get(t,e,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),J.setGet(t,e,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),J.setGetArray(t,e,["size"],2),J.event(t,e,"imageReady"),J.event(t,e,"windowResizeEvent"),gF(t,e)}const I1=J.newInstance(c6,"vtkOpenGLRenderWindow");z8("WebGL",I1);var vF={newInstance:I1,extend:c6,pushMonitorGLContextCount:pF,popMonitorGLContextCount:dF};An("vtkRenderWindow",I1);function yF(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=n=>{if(n){e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(e._openGLRenderer.getSelector()&&e.renderable.getNestedPickable()),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),pn(e.keyMatrices.mcwc,e.renderable.getMatrix()),Rt(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?wi(e.keyMatrices.normalMatrix):(Th(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Pl(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),t1(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices)}const xF={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function wF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xF,n),en.extend(t,e,n),e.keyMatrixTime={},an(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:wi(new Float64Array(9)),mcwc:ut(new Float64Array(16))},bn(t,e,["context"]),mr(t,e,["activeTextures"]),yF(t,e)}const u6=kt(wF);var CF={newInstance:u6};An("vtkActor",u6);function TF(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=n=>{if(n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(i)):e.oglmapper=i}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOverlayActorCount()}},t.traverseOpaquePass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOverlayPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()},t.overlayPass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let i=0;i<e.activeTextures.length;i++)e.activeTextures[i].deactivate()}}const _F={context:null,activeTextures:null};function SF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_F,n),en.extend(t,e,n),bn(t,e,["context"]),mr(t,e,["activeTextures"]),TF(t,e)}const l6=kt(SF);var bF={newInstance:l6};An("vtkActor2D",l6);function EF(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=()=>{t.getInputData()},t.addClippingPlane=n=>n.isA("vtkPlane")?e.clippingPlanes.includes(n)?!1:(e.clippingPlanes.push(n),t.modified(),!0):!1,t.getNumberOfClippingPlanes=()=>e.clippingPlanes.length,t.removeAllClippingPlanes=()=>e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0),t.removeClippingPlane=n=>{const r=e.clippingPlanes.indexOf(n);return r===-1?!1:(e.clippingPlanes.splice(r,1),t.modified(),!0)},t.getClippingPlanes=()=>e.clippingPlanes,t.setClippingPlanes=n=>{if(n)if(!Array.isArray(n))t.addClippingPlane(n);else{const r=n.length;for(let i=0;i<r&&i<6;i++)t.addClippingPlane(n[i])}},t.getClippingPlaneInDataCoords=(n,r,i)=>{const a=e.clippingPlanes,o=n;if(a){const s=a.length;if(r>=0&&r<s){const c=a[r],l=c.getNormal(),f=c.getOrigin(),u=l[0],h=l[1],p=l[2],d=-(u*f[0]+h*f[1]+p*f[2]);i[0]=u*o[0]+h*o[4]+p*o[8]+d*o[12],i[1]=u*o[1]+h*o[5]+p*o[9]+d*o[13],i[2]=u*o[2]+h*o[6]+p*o[10]+d*o[14],i[3]=u*o[3]+h*o[7]+p*o[11]+d*o[15];return}}J.vtkErrorMacro(`Clipping plane index ${r} is out of range.`)}}const DF={clippingPlanes:[]};function OF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DF,n),J.obj(t,e),J.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),EF(t,e)}var f6={extend:OF};function RF(t,e){t.getBounds=()=>(J.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),ns()),t.getCenter=()=>{const n=t.getBounds();return e.center=Kt.isValid(n)?Kt.getCenter(n):null,e.center?.slice()},t.getLength=()=>{const n=t.getBounds();return Kt.getDiagonalLength(n)}}const MF=t=>({bounds:[...Kt.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...t});function NF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MF(n)),f6.extend(t,e,n),J.setGet(t,e,["viewSpecificProperties"]),RF(t,e)}var P1={extend:NF};const{vtkErrorMacro:bv}=J,Ev=0,Dv=1,Rp=2;function LF(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=()=>{if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){let n=!0;e.nanColor[3]<1&&(n=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(n=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(n=0);for(let r=3;r<e.table.length&&n;r+=4)e.table[r]<255&&(n=!1);e.opaqueFlag=n,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>e.table.length/4-3,t.linearIndexLookup=(n,r)=>{let i=0;const a=Number(n);return a<r.range[0]?i=r.maxIndex+Ev+1.5:a>r.range[1]?i=r.maxIndex+Dv+1.5:(i=(a+r.shift)*r.scale,i=i<r.maxIndex?i:r.maxIndex),Math.floor(i)},t.linearLookup=(n,r,i)=>{let a=0;bf(n)?a=Math.floor(i.maxIndex+1.5+Rp):a=t.linearIndexLookup(n,i);const o=4*a;return r.slice(o,o+4)},t.indexedLookupFunction=(n,r,i)=>{let a=t.getAnnotatedValueIndexInternal(n);a===-1&&(a=e.numberOfColors+Rp);const o=4*a;return[r[o],r[o+1],r[o+2],r[o+3]]},t.lookupShiftAndScale=(n,r)=>{r.shift=-n[0],r.scale=Number.MAX_VALUE,n[1]>n[0]&&(r.scale=(r.maxIndex+1)/(n[1]-n[0]))},t.mapScalarsThroughTable=(n,r,i,a)=>{let o=t.linearLookup;e.indexedLookup&&(o=t.indexedLookupFunction);const s=t.getMappingRange(),c={maxIndex:t.getNumberOfColors()-1,range:s,shift:0,scale:0};t.lookupShiftAndScale(s,c);const l=t.getAlpha(),f=n.getNumberOfTuples(),u=n.getNumberOfComponents(),h=r.getData(),p=n.getData();if(l>=1){if(i===Id.RGBA)for(let d=0;d<f;d++){const g=o(p[d*u+a],e.table,c);h[d*4]=g[0],h[d*4+1]=g[1],h[d*4+2]=g[2],h[d*4+3]=g[3]}}else if(i===Id.RGBA)for(let d=0;d<f;d++){const g=o(p[d*u+a],e.table,c);h[d*4]=g[0],h[d*4+1]=g[1],h[d*4+2]=g[2],h[d*4+3]=Math.floor(g[3]*l+.5)}},t.forceBuild=()=>{let n=0,r=0,i=0,a=0;const o=e.numberOfColors-1;o&&(n=(e.hueRange[1]-e.hueRange[0])/o,r=(e.saturationRange[1]-e.saturationRange[0])/o,i=(e.valueRange[1]-e.valueRange[0])/o,a=(e.alphaRange[1]-e.alphaRange[0])/o),e.table.length=4*o+16;const s=[],c=[];for(let l=0;l<=o;l++)s[0]=e.hueRange[0]+l*n,s[1]=e.saturationRange[0]+l*r,s[2]=e.valueRange[0]+l*i,Hs(s,c),c[3]=e.alphaRange[0]+l*a,e.table[l*4]=c[0]*255+.5,e.table[l*4+1]=c[1]*255+.5,e.table[l*4+2]=c[2]*255+.5,e.table[l*4+3]=c[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=n=>{if(Array.isArray(n)){const i=n[0].length;e.numberOfColors=n.length;const a=4-i;let o=0;for(let s=0;s<e.numberOfColors;s++)e.table[s*4]=255,e.table[s*4+1]=255,e.table[s*4+2]=255,e.table[s*4+3]=255;for(let s=0;s<n.length;s++){const c=n[s];for(let l=0;l<i;l++)e.table[o++]=c[l];o+=a}return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0}if(n.getNumberOfComponents()!==4)return bv("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==Ot.UNSIGNED_CHAR)return bv("Expected unsigned char values for RGBA colors"),!1;e.numberOfColors=n.getNumberOfTuples();const r=n.getData();e.table.length=r.length;for(let i=0;i<r.length;i++)e.table[i]=r[i];return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0},t.buildSpecialColors=()=>{const{numberOfColors:n}=e,r=e.table;let i=(n+Ev)*4;e.useBelowRangeColor||n===0?(r[i]=e.belowRangeColor[0]*255+.5,r[i+1]=e.belowRangeColor[1]*255+.5,r[i+2]=e.belowRangeColor[2]*255+.5,r[i+3]=e.belowRangeColor[3]*255+.5):(r[i]=r[0],r[i+1]=r[1],r[i+2]=r[2],r[i+3]=r[3]),i=(n+Dv)*4,e.useAboveRangeColor||n===0?(r[i]=e.aboveRangeColor[0]*255+.5,r[i+1]=e.aboveRangeColor[1]*255+.5,r[i+2]=e.aboveRangeColor[2]*255+.5,r[i+3]=e.aboveRangeColor[3]*255+.5):(r[i]=r[4*(n-1)+0],r[i+1]=r[4*(n-1)+1],r[i+2]=r[4*(n-1)+2],r[i+3]=r[4*(n-1)+3]),i=(n+Rp)*4,r[i]=e.nanColor[0]*255+.5,r[i+1]=e.nanColor[1]*255+.5,r[i+2]=e.nanColor[2]*255+.5,r[i+3]=e.nanColor[3]*255+.5},t.build=()=>{(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&(t.buildSpecialColors(),e.insertTime.modified())}const AF={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function h6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AF,n),Ch.extend(t,e,n),e.table||(e.table=[]),e.buildTime={},J.obj(e.buildTime),e.opaqueFlagBuildTime={},J.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},J.obj(e.insertTime,{mtime:0}),J.get(t,e,["buildTime"]),J.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),J.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),J.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),J.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),LF(t,e)}const FF=J.newInstance(h6,"vtkLookupTable");var Bf={newInstance:FF,extend:h6};const{FieldAssociations:Ov}=nu,{staticOffsetAPI:IF,otherStaticMethods:PF}=Rh,{ColorMode:l0,ScalarMode:Is,GetArray:Mp}=wh,{VectorMode:VF}=Zg,{VtkDataTypes:kF}=ft;function mu(t){return()=>J.vtkErrorMacro(`vtkMapper::${t} - NOT IMPLEMENTED`)}function UF(t,e){const n=t[1]%2===0?1:-1;if(t[0]+=n,t[0]>=e[0]||t[0]<0){const r=t[2]%2===0?1:-1;t[0]-=n,t[1]+=r,(t[1]>=e[1]||t[1]<0)&&(t[1]-=r,t[2]++)}}function BF(t,e){return t[0]+e[0]*(t[1]+e[1]*t[2])}function Rv(t,e,n){const r=Math.floor(e),i=r%(2*n[0]);let a,o;i<n[0]?(t[0]=i,a=1,o=t[0]===n[0]-1):(t[0]=2*n[0]-1-i,a=-1,o=t[0]===0);const s=Math.floor(r/n[0]),c=s%(2*n[1]);let l,f;c<n[1]?(t[1]=c,l=1,f=t[1]===n[1]-1):(t[1]=2*n[1]-1-c,l=-1,f=t[1]===0),t[2]=Math.floor(s/n[1]);const u=e-r;o?f?t[2]+=u:t[1]+=l*u:t[0]+=a*u,t[0]=(t[0]+.5)/n[0],t[1]=(t[1]+.5)/n[1],t[2]=(t[2]+.5)/n[2]}const Mv=new WeakMap;function GF(t,e,n,r,i,a,o){const s=new Array(arguments.length);for(let R=0;R<arguments.length;++R){const F=arguments[R];s[R]=F.getMTime?.()??F}const c=s.join("/"),l=Mv.get(t);if(l&&l.stringHash===c)return l.textureCoordinates;const f=(n[1]-n[0])/(r-1),[u,h]=[n[0]-f,n[1]+f],p=u-.5*f,d=1/(h-u+f),g=u,y=(r+1)/(h-u),x=t.getData(),m=t.getNumberOfTuples(),v=t.getNumberOfComponents(),w=e<0||e>=v,C=i[2]<=1?2:3,T=ft.newInstance({numberOfComponents:C,values:new Float32Array(m*C)}),_=T.getData(),S=[0,0,0];Rv(S,r+2,i);let b=0,D=0;const E=[.5,.5,.5];for(let R=0;R<m;++R){let F;if(w){let M=0;for(let U=0;U<v;++U){const z=x[b+U];M+=z*z}F=Math.sqrt(M)}else F=x[b+e];if(b+=v,a&&(F=Bf.applyLogScale(F,n,n)),bf(F))E[0]=S[0],E[1]=S[1],E[2]=S[2];else if(o){let M=(F-g)*y;M<1?M=0:M>r&&(M=r+1),Rv(E,M,i)}else{E[1]=.49;const M=(F-p)*d;M>1e3?E[0]=1e3:M<-1e3?E[0]=-1e3:E[0]=M}for(let M=0;M<C;++M)_[D++]=E[M]}return Mv.set(t,{stringHash:c,textureCoordinates:T}),T}function WF(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=()=>{const n=t.getInputData();return n?(e.static||t.update(),e.bounds=n.getBounds()):e.bounds=ns(),e.bounds},t.setForceCompileOnly=n=>{e.forceCompileOnly=n},t.setSelectionWebGLIdsToVTKIds=n=>{e.selectionWebGLIdsToVTKIds=n},t.createDefaultLookupTable=()=>{e.lookupTable=Bf.newInstance()},t.getColorModeAsString=()=>J.enumToString(l0,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>J.enumToString(Is,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFlag:!1};let s=null,c=!1;if(r===Is.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),c=!0);else if(r===Is.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===Is.USE_CELL_DATA)s=n.getCellData().getScalars(),c=!0;else if(r===Is.USE_POINT_FIELD_DATA){const l=n.getPointData();i===Mp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}else if(r===Is.USE_CELL_FIELD_DATA){const l=n.getCellData();c=!0,i===Mp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}else if(r===Is.USE_FIELD_DATA){const l=n.getFieldData();i===Mp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}return{scalars:s,cellFlag:c}},t.mapScalars=(n,r)=>{const{scalars:i,cellFlag:a}=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName);if(e.areScalarsMappedFromCells=a,!i){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}const o=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString!==o){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(i,a))e.mapScalarsToTexture(i,a,r);else{e.colorCoordinates=null,e.colorTextureMap=null;const s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(i,e.colorMode,e.fieldDataTupleId))}e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`}},e.mapScalarsToTexture=(n,r,i)=>{const a=e.lookupTable.getRange(),o=e.lookupTable.usingLogScale();o&&Bf.getLogRange(a,a);const s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==i){e.lookupTable.setAlpha(i),e.colorTextureMap=null,e.lookupTable.build();const l=e.lookupTable.getNumberOfAvailableColors(),f=2048,u=f**3-3,p=4096-2,d=2,g=r?u:p;e.numberOfColorsInRange=Math.min(Math.max(l,d),g);const y=e.numberOfColorsInRange+3,x=e.numberOfColorsInRange+2,m=r?[Math.min(Math.ceil(y/f**0),f),Math.min(Math.ceil(y/f**1),f),Math.min(Math.ceil(y/f**2),f)]:[x,2,1],v=m[0]*m[1]*m[2],w=new Float64Array(v);w.fill(NaN);const C=e.numberOfColorsInRange,T=C+2,_=[0,0,0],S=a[0],b=a[1]-a[0];for(let R=0;R<T;++R){const F=BF(_,m),M=S+b*(R-1)/(C-1);w[F]=o?10**M:M,UF(_,m)}const D=ft.newInstance({numberOfComponents:1,values:w}),E=e.lookupTable.mapScalars(D,e.colorMode,0);e.colorTextureMap=L1.newInstance(),e.colorTextureMap.setDimensions(m),e.colorTextureMap.getPointData().setScalars(E),e.lookupTable.setAlpha(s)}const c=e.lookupTable.getVectorMode()===VF.MAGNITUDE&&n.getNumberOfComponents()>1?-1:e.lookupTable.getVectorComponent();e.colorCoordinates=GF(n,c,a,e.numberOfColorsInRange,e.colorTextureMap.getDimensions(),o,r)},t.getIsOpaque=()=>{const n=t.getInputData(),i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!e.scalarVisibility||i==null)return!0;const a=t.getLookupTable();return a?(a.build(),a.areScalarsOpaque(i,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=(n,r)=>r&&e.colorMode!==l0.DIRECT_SCALARS?!0:!(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup()||!n||e.colorMode===l0.DEFAULT&&n.getDataType()===kF.UNSIGNED_CHAR||e.colorMode===l0.DIRECT_SCALARS),t.clearColorArrays=()=>{e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}},t.acquireInvertibleLookupTable=mu("AcquireInvertibleLookupTable"),t.valueToColor=mu("ValueToColor"),t.colorToValue=mu("ColorToValue"),t.useInvertibleColorFor=mu("UseInvertibleColorFor"),t.clearInvertibleColor=mu("ClearInvertibleColor"),t.processSelectorPixelBuffers=(n,r)=>{if(!n||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)return;const i=n.getRawPixelBuffer(Ar.ID_LOW24),a=n.getRawPixelBuffer(Ar.ID_HIGH24),o=n.getCurrentPass(),s=n.getFieldAssociation();let c=null;s===Ov.FIELD_ASSOCIATION_POINTS?c=e.selectionWebGLIdsToVTKIds.points:s===Ov.FIELD_ASSOCIATION_CELLS&&(c=e.selectionWebGLIdsToVTKIds.cells),c&&r.forEach(l=>{if(o===Ar.ID_LOW24){let f=0;a&&(f+=a[l],f*=256),f+=i[l+2],f*=256,f+=i[l+1],f*=256,f+=i[l];const u=c[f],h=n.getPixelBuffer(Ar.ID_LOW24);h[l]=u&255,h[l+1]=(u&65280)>>8,h[l+2]=(u&16711680)>>16}else if(o===Ar.ID_HIGH24&&a){let f=0;f+=a[l],f*=256,f+=i[l+2],f*=256,f+=i[l+1],f*=256,f+=i[l];const u=c[f],h=n.getPixelBuffer(Ar.ID_HIGH24);h[l]=(u&4278190080)>>24}})}}const zF={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function p6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zF,n),P1.extend(t,e,n),J.get(t,e,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),J.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),J.setGetArray(t,e,["scalarRange"],2),Rh.implementCoincidentTopologyMethods(t,e),WF(t,e)}const jF=J.newInstance(p6,"vtkMapper");var ca={newInstance:jF,extend:p6,...IF,...PF,...wh};const{FieldAssociations:Np}=nu,{primTypes:$n}=Ca,{Representation:yc,Shading:Nv}=pc,{ScalarMode:f0}=ca,{Filter:Lv,Wrap:Av}=fn,{vtkErrorMacro:Ps}=sr,$F={type:"StartEvent"},HF={type:"EndEvent"},{CoordinateSystem:KF}=kl;function qF(t){const e=t.getSelector();return e?e.getCurrentPass():Ar.MIN_KNOWN_PASS-1}function XF(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=r=>{r&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=(r,i)=>{r&&(e.currentRenderPass=i,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=$n.Start;o<$n.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.getShaderTemplate=(r,i,a)=>{r.Vertex=N1,r.Fragment=Ul,r.Geometry=""},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,c=r.Fragment;const l=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];l&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];l&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),l&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=Te.substitute(o,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,o=Te.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,s=Te.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=Te.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?c=Te.substitute(c,"//VTK::Color::Impl",u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:(e.renderable.getAreScalarsMappedFromCells()||e.renderable.getInterpolateScalarsBeforeMapping())&&e.renderable.getColorCoordinates()&&!e.drawingEdges?c=Te.substitute(c,"//VTK::Color::Impl",u.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(a.getBackfaceProperty()&&!e.drawingEdges&&(f=f.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),l?(f=f.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):u=u.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(f=f.concat(["uniform samplerBuffer texture1;"])),c=Te.substitute(c,"//VTK::Color::Impl",u).result),c=Te.substitute(c,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=c},t.replaceShaderLight=(r,i,a)=>{let o=r.Fragment;const s="",c=e.lastBoundBO.getReferenceByName("lastLightComplexity"),l=e.lastBoundBO.getReferenceByName("lastLightCount");let f=[];switch(c){case 0:o=Te.substitute(o,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:o=Te.substitute(o,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let u=0;u<l;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`]);o=Te.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let u=0;u<l;++u)f=f.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${u}));`,`  diffuseL += ((df${s}) * lightColor${u});`,`  if (dot(normalVCVSOutput, lightDirectionVC${u}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,
                                              dot(reflect(lightDirectionVC${u},normalVCVSOutput),
                                                  normalize(-vertexVC.xyz))),
                                         specularPower);`,`    specularL += (sf${s} * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=Te.substitute(o,"//VTK::Light::Impl",f,!1).result;break;case 3:for(let u=0;u<l;++u)f=f.concat([`uniform vec3 lightColor${u};`,`uniform vec3 lightDirectionVC${u}; // normalized`,`uniform vec3 lightHalfAngleVC${u}; // normalized`,`uniform vec3 lightPositionVC${u};`,`uniform vec3 lightAttenuation${u};`,`uniform float lightConeAngle${u};`,`uniform float lightExponent${u};`,`uniform int lightPositional${u};`]);o=Te.substitute(o,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let u=0;u<l;++u)f=f.concat(["  attenuation = 1.0;",`  if (lightPositional${u} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${u};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${u};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${u}.x`,`       + lightAttenuation${u}.y * distanceVC`,`       + lightAttenuation${u}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${u} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${u});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${u})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${u});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df${s}) * lightColor${u});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,
                                                           dot(reflect(lightDirectionVC${u},
                                                                       normalVCVSOutput),
                                                               normalize(-vertexVC.xyz))),
                                                       specularPower);`,`    specularL += ((sf${s}) * lightColor${u});`,"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=Te.substitute(o,"//VTK::Light::Impl",f,!1).result;break;default:Ps("bad light complexity")}r.Fragment=o},t.replaceShaderNormal=(r,i,a)=>{if(e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex,c=r.Geometry,l=r.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(s=Te.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=Te.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,c=Te.substitute(c,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,c=Te.substitute(c,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,l=Te.substitute(l,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,l=Te.substitute(l,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(l=Te.substitute(l,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,l=Te.substitute(l,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES?(l=Te.substitute(l,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,l=Te.substitute(l,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(l=Te.substitute(l,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,l=Te.substitute(l,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,l=Te.substitute(l,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),r.Vertex=s,r.Geometry=c,r.Fragment=l}},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a);let o=r.Vertex,s=r.Geometry,c=r.Fragment;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=Te.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=Te.substitute(o,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,o=Te.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,s=Te.substitute(s,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,s=Te.substitute(s,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,c=Te.substitute(c,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,c=Te.substitute(c,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(o=Te.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=Te.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=c},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,c=r.Fragment;if(e.drawingEdges)return;o=Te.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const l=e.openGLActor.getActiveTextures();let f=2,u=2;if(l&&l.length>0&&(f=l[0].getComponents(),l[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(u=3)),e.renderable.getColorTextureMap()&&(f=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),u=2),u===2){if(o=Te.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,s=Te.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,s=Te.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=Te.substitute(c,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,l&&l.length>=1)switch(f){case 1:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(o=Te.substitute(o,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,s=Te.substitute(s,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,s=Te.substitute(s,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=Te.substitute(c,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,f){case 1:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=Te.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}r.Vertex=o,r.Geometry=s,r.Fragment=c}},t.replaceShaderClip=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes();o=Te.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${c}];`,`varying float clipDistancesVSOutput[${c}];`]).result,o=Te.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,s=Te.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${c}];`]).result,s=Te.substitute(s,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=o,r.Fragment=s},t.getCoincidentParameters=(r,i)=>{let a={factor:0,offset:0};const o=i.getProperty();if(e.renderable.getResolveCoincidentTopology()==ji.PolygonOffset||o.getEdgeVisibility()&&o.getRepresentation()===yc.SURFACE){const c=e.lastBoundBO.getPrimitiveType();c===$n.Points||o.getRepresentation()===yc.POINTS?a=e.renderable.getCoincidentTopologyPointOffsetParameter():c===$n.Lines||o.getRepresentation()===yc.WIREFRAME?a=e.renderable.getCoincidentTopologyLineOffsetParameters():(c===$n.Tris||c===$n.TriStrips)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(c===$n.TrisEdges||c===$n.TriStripsEdges)&&(a=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),a.factor/=2,a.offset/=2)}const s=e._openGLRenderer.getSelector();return s&&s.getFieldAssociation()===Np.FIELD_ASSOCIATION_POINTS&&(a.offset-=2),a},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment,s=r.Vertex;if(o=Te.substitute(o,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===Ar.ID_LOW24||e.lastSelectionState===Ar.ID_HIGH24)&&(s=Te.substitute(s,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,s=Te.substitute(s,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,o=Te.substitute(o,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,o=Te.substitute(o,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case Ar.ID_LOW24:o=Te.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case Ar.ID_HIGH24:o=Te.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:o=Te.substitute(o,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,o=Te.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}r.Fragment=o,r.Vertex=s}},t.replaceShaderValues=(r,i,a)=>{if(t.replaceShaderColor(r,i,a),t.replaceShaderNormal(r,i,a),t.replaceShaderLight(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderClip(r,i,a),t.replaceShaderCoincidentOffset(r,i,a),t.replaceShaderPositionVC(r,i,a),e.haveSeenDepthRequest){let o=r.Fragment;o=Te.substitute(o,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,o=Te.substitute(o,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,r.Fragment=o}},t.getNeedToRebuildShaders=(r,i,a)=>{let o=0,s=0;const c=r.getPrimitiveType(),l=e.currentInput;let f=!1;const u=l.getPointData().getNormals(),h=l.getCellData().getNormals(),p=a.getProperty().getInterpolation()===Nv.FLAT,d=a.getProperty().getRepresentation(),g=r.getOpenGLMode(d,c);if((g===e.context.TRIANGLES||h&&!u||!p&&u||!p&&g===e.context.LINES)&&(f=!0),a.getProperty().getLighting()&&f){o=0;const v=i.getLightsByReference();for(let w=0;w<v.length;++w){const C=v[w];C.getSwitch()>0&&(s++,o===0&&(o=1)),o===1&&(s>1||C.getIntensity()!==1||!C.lightTypeIsHeadLight())&&(o=2),o<3&&C.getPositional()&&(o=3)}}let y=!1;const x=e.lastBoundBO.getReferenceByName("lastLightComplexity"),m=e.lastBoundBO.getReferenceByName("lastLightCount");return(x!==o||m!==s)&&(e.lastBoundBO.set({lastLightComplexity:o},!0),e.lastBoundBO.set({lastLightCount:s},!0),y=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(y=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||r.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||y?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isUniformUsed("VertexIDOffset")&&r.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Ps("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("normalMC")&&r.getCABO().getNormalOffset()&&c>0?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"normalMC",r.getCABO().getNormalOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Ps("Error setting normalMC in shader VAO."):r.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach((l,f)=>{r.getProgram().isAttributeUsed(`${l}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${l}MC`,r.getCABO().getCustomData()[f].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[f].components,!1)||Ps(`Error setting ${l}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||Ps("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Ps("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),r.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes(),l=[],u=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,h=u?pn(e.tmpMat4,a.getMatrix()):a.getMatrix();u&&(Rt(h,h),It(h,h,u),Rt(h,h));for(let p=0;p<c;p++){const d=[];e.renderable.getClippingPlaneInDataCoords(h,p,d);for(let g=0;g<4;g++)l.push(d[g])}r.getProgram().setUniformi("numClipPlanes",c),r.getProgram().setUniform4fv("clipPlanes",l)}e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor.getActiveTextures();if(o)for(let c=0;c<o.length;++c){const f=o[c].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const c=t.getCoincidentParameters(i,a);r.getProgram().setUniformf("coffset",c.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",c.factor)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)},t.setLightingShaderParameters=(r,i,a)=>{const o=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(o<2)return;const s=r.getProgram();let c=0;const l=i.getLightsByReference();for(let h=0;h<l.length;++h){const p=l[h];if(p.getSwitch()>0){const g=p.getColorByReference(),y=p.getIntensity();e.lightColor[0]=g[0]*y,e.lightColor[1]=g[1]*y,e.lightColor[2]=g[2]*y;const x=p.getDirection(),m=i.getActiveCamera().getViewMatrix(),v=[...x];p.lightTypeIsSceneLight()&&(v[0]=m[0]*x[0]+m[1]*x[1]+m[2]*x[2],v[1]=m[4]*x[0]+m[5]*x[1]+m[6]*x[2],v[2]=m[8]*x[0]+m[9]*x[1]+m[10]*x[2],oc(v)),e.lightDirection[0]=v[0],e.lightDirection[1]=v[1],e.lightDirection[2]=v[2],oc(e.lightDirection),s.setUniform3fArray(`lightColor${c}`,e.lightColor),s.setUniform3fArray(`lightDirectionVC${c}`,e.lightDirection),c++}}if(o<3)return;const u=i.getActiveCamera().getViewMatrix();Rt(u,u),c=0;for(let h=0;h<l.length;++h){const p=l[h];if(p.getSwitch()>0){const g=p.getTransformedPosition(),y=new Float64Array(3);Dt(y,g,u),s.setUniform3fArray(`lightAttenuation${c}`,p.getAttenuationValuesByReference()),s.setUniformi(`lightPositional${c}`,p.getPositional()),s.setUniformf(`lightExponent${c}`,p.getExponent()),s.setUniformf(`lightConeAngle${c}`,p.getConeAngle()),s.setUniform3fArray(`lightPositionVC${c}`,[y[0],y[1],y[2]]),c++}}};function n(r,i,a){return i.identity(a),r.reduce((o,s,c)=>c===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=e.openGLCamera.getKeyMatrices(i),c=i.getActiveCamera(),l=e.openGLCamera.getKeyMatrixTime().getMTime(),f=o.getLastCameraMTime(),h=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,p=a.getIsIdentity(),d=p?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(a.getCoordinateSystem()===KF.DISPLAY){const g=e._openGLRenderer.getTiledSizeAndOrigin();ut(e.tmpMat4),e.tmpMat4[0]=2/g.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/g.vsize,e.tmpMat4[13]=-1,It(e.tmpMat4,e.tmpMat4,h),o.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else o.setUniformMatrix("MCPCMatrix",n([s.wcpc,d.mcwc,h],hl,e.tmpMat4));o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",n([s.wcvc,d.mcwc,h],hl,e.tmpMat4)),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",n([s.normalMatrix,d.normalMatrix],$b,e.tmpMat3)),f!==l&&(o.isUniformUsed("cameraParallel")&&o.setUniformi("cameraParallel",c.getParallelProjection()),o.setLastCameraMTime(l)),p||o.setLastCameraMTime(0)},t.setPropertyShaderParameters=(r,i,a)=>{const o=r.getProgram();let s=a.getProperty(),c=s.getOpacity(),l=e.drawingEdges?s.getEdgeColorByReference():s.getAmbientColorByReference(),f=e.drawingEdges?s.getEdgeColorByReference():s.getDiffuseColorByReference(),u=e.drawingEdges?1:s.getAmbient(),h=e.drawingEdges?0:s.getDiffuse(),p=e.drawingEdges?0:s.getSpecular();const d=s.getSpecularPower();o.setUniformf("opacityUniform",c),o.setUniform3fArray("ambientColorUniform",l),o.setUniform3fArray("diffuseColorUniform",f),o.setUniformf("ambient",u),o.setUniformf("diffuse",h);const g=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(g<1)return;let y=s.getSpecularColorByReference();if(o.setUniform3fArray("specularColorUniform",y),o.setUniformf("specularPowerUniform",d),o.setUniformf("specular",p),o.isUniformUsed("ambientIntensityBF")){if(s=a.getBackfaceProperty(),c=s.getOpacity(),l=s.getAmbientColor(),u=s.getAmbient(),f=s.getDiffuseColor(),h=s.getDiffuse(),y=s.getSpecularColor(),p=s.getSpecular(),o.setUniformf("ambientIntensityBF",u),o.setUniformf("diffuseIntensityBF",h),o.setUniformf("opacityUniformBF",c),o.setUniform3fArray("ambientColorUniformBF",l),o.setUniform3fArray("diffuseColorUniformBF",f),g<1)return;o.setUniformf("specularIntensityBF",p),o.setUniform3fArray("specularColorUniformBF",y),o.setUniformf("specularPowerUniformBF",d)}},t.updateMaximumPointCellIds=(r,i)=>{const a=e._openGLRenderer.getSelector();if(!a)return;if(e.selectionWebGLIdsToVTKIds?.points?.length){const s=e.selectionWebGLIdsToVTKIds.points.length;a.setMaximumPointId(s-1)}if(e.selectionWebGLIdsToVTKIds?.cells?.length){const s=e.selectionWebGLIdsToVTKIds.cells.length;a.setMaximumCellId(s-1)}a.getFieldAssociation()===Np.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)},t.renderPieceStart=(r,i)=>{e.primitiveIDOffset=0,e.vertexIDOffset=0;const a=qF(e._openGLRenderer);e.lastSelectionState!==a&&(e.selectionStateChanged.modified(),e.lastSelectionState=a),e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().renderProp(i),t.updateBufferObjects(r,i),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=i.getProperty().getEdgeVisibility()&&a===yc.SURFACE,s=e._openGLRenderer.getSelector(),c=s&&s.getFieldAssociation()===Np.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===Ar.ID_LOW24||e.lastSelectionState===Ar.ID_HIGH24);for(let l=$n.Start;l<$n.End;l++)e.primitives[l].setPointPicking(c),e.primitives[l].getCABO().getElementCount()&&(e.drawingEdges=o&&(l===$n.TrisEdges||l===$n.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[l],e.primitiveIDOffset+=e.primitives[l].drawArrays(r,i,a,t),e.vertexIDOffset+=e.primitives[l].getCABO().getElementCount()))},t.renderPieceFinish=(r,i)=>{e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=(r,i)=>{if(t.invokeEvent($F),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(HF),!e.currentInput){Ps("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context,o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.computeBounds=(r,i)=>{if(!t.getInput()){tu(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i),t.updateMaximumPointCellIds()},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return a<t.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===f0.USE_CELL_DATA||s===f0.USE_CELL_FIELD_DATA||s===f0.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==f0.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);let c=i.getProperty().getInterpolation()!==Nv.FLAT?a.getPointData().getNormals():null;c===null&&a.getCellData().getNormals()&&(e.haveCellNormals=!0,c=a.getCellData().getNormals());const l=i.getProperty().getRepresentation();let f=a.getPointData().getTCoords();e.openGLActor.getActiveTextures()||(f=null);let u=!1;if(e.renderable.getColorCoordinates()){f=e.renderable.getColorCoordinates(),u=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=fn.newInstance({resizable:!0}));const p=e.internalColorTexture;p.setMinificationFilter(Lv.NEAREST),p.setMagnificationFilter(Lv.NEAREST),p.setWrapS(Av.CLAMP_TO_EDGE),p.setWrapT(Av.CLAMP_TO_EDGE),p.setOpenGLRenderWindow(e._openGLRenderWindow);const d=e.renderable.getColorTextureMap(),g=d.getExtent(),y=d.getPointData().getScalars();p.create2DFromRaw(g[1]-g[0]+1,g[3]-g[2]+1,y.getNumberOfComponents(),y.getDataType(),y.getData()),p.activate(),p.sendParameters(),p.deactivate()}const h=`${a.getMTime()}A${l}B${a.getMTime()}C${c?c.getMTime():1}D${o?o.getMTime():1}E${i.getProperty().getEdgeVisibility()}F${f?f.getMTime():1}`;if(e.VBOBuildString!==h){const d={points:a.getPoints(),normals:c,tcoords:f,colors:o,cellOffset:0,vertexOffset:0,useTCoordsPerCell:u,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(x=>a.getPointData().getArrayByName(x))};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});const g=[{inRep:"verts",cells:a.getVerts()},{inRep:"lines",cells:a.getLines()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()},{inRep:"polys",cells:a.getPolys()},{inRep:"strips",cells:a.getStrips()}],y=i.getProperty().getEdgeVisibility()&&l===yc.SURFACE;for(let x=$n.Start;x<$n.End;x++)x!==$n.TrisEdges&&x!==$n.TriStripsEdges?(d.cellOffset+=e.primitives[x].getCABO().createVBO(g[x].cells,g[x].inRep,l,d,e.selectionWebGLIdsToVTKIds),d.vertexOffset+=e.primitives[x].getCABO().getElementCount()):y?e.primitives[x].getCABO().createVBO(g[x].cells,g[x].inRep,yc.WIREFRAME,{...d,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[x].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),e.VBOBuildString=h}e.VBOBuildTime.modified()},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const YF={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:Ar.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function d6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YF,n),en.extend(t,e,n),ya.implementReplaceShaderCoincidentOffset(t,e,n),ya.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=$n,e.tmpMat3=wi(new Float64Array(9)),e.tmpMat4=ut(new Float64Array(16));for(let r=$n.Start;r<$n.End;r++)e.primitives[r]=Ca.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);bn(t,e,["context"]),e.VBOBuildTime={},an(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},an(e.selectionStateChanged,{mtime:0}),XF(t,e)}const g6=kt(d6,"vtkOpenGLPolyDataMapper");var Ah={newInstance:g6,extend:d6};An("vtkMapper",g6);const{vtkErrorMacro:vu}=sr,{Representation:JF}=pc,{ObjectType:h0}=qa,{PassTypes:ZF}=F1,QF={type:"StartEvent"},eI={type:"EndEvent"};function tI(t,e){e.classHierarchy.push("vtkOpenGLGlyph3DMapper");const n={...t};t.renderPiece=(r,i)=>{if(t.invokeEvent(QF),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(1),t.invokeEvent(eI),!e.currentInput){vu("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const a=e.context;e._openGLRenderWindow.getWebgl2()?(e.hardwareSupport=!0,e.extension=null):e.extension||(e.extension=e.context.getExtension("ANGLE_instanced_arrays"),e.hardwareSupport=!!e.extension);const o=i.getProperty().getBackfaceCulling(),s=i.getProperty().getFrontfaceCulling();!o&&!s?e._openGLRenderWindow.disableCullFace():s?(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.FRONT)):(e._openGLRenderWindow.enableCullFace(),a.cullFace(a.BACK)),t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i)},t.multiply4x4WithOffset=(r,i,a,o)=>{const s=i[0],c=i[1],l=i[2],f=i[3],u=i[4],h=i[5],p=i[6],d=i[7],g=i[8],y=i[9],x=i[10],m=i[11],v=i[12],w=i[13],C=i[14],T=i[15];let _=a[o],S=a[o+1],b=a[o+2],D=a[o+3];r[0]=_*s+S*u+b*g+D*v,r[1]=_*c+S*h+b*y+D*w,r[2]=_*l+S*p+b*x+D*C,r[3]=_*f+S*d+b*m+D*T,_=a[o+4],S=a[o+5],b=a[o+6],D=a[o+7],r[4]=_*s+S*u+b*g+D*v,r[5]=_*c+S*h+b*y+D*w,r[6]=_*l+S*p+b*x+D*C,r[7]=_*f+S*d+b*m+D*T,_=a[o+8],S=a[o+9],b=a[o+10],D=a[o+11],r[8]=_*s+S*u+b*g+D*v,r[9]=_*c+S*h+b*y+D*w,r[10]=_*l+S*p+b*x+D*C,r[11]=_*f+S*d+b*m+D*T,_=a[o+12],S=a[o+13],b=a[o+14],D=a[o+15],r[12]=_*s+S*u+b*g+D*v,r[13]=_*c+S*h+b*y+D*w,r[14]=_*l+S*p+b*x+D*C,r[15]=_*f+S*d+b*m+D*T},t.replaceShaderNormal=(r,i,a)=>{if(e.hardwareSupport&&e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let s=r.Vertex;e.lastBoundBO.getCABO().getNormalOffset()&&(s=Te.substitute(s,"//VTK::Normal::Dec",["attribute vec3 normalMC;","attribute mat3 gNormal;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,s=Te.substitute(s,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * gNormal * normalMC;"]).result),r.Vertex=s}n.replaceShaderNormal(r,i,a)},t.replaceShaderColor=(r,i,a)=>{if(e.hardwareSupport&&e.renderable.getColorArray()){let o=r.Vertex,s=r.Geometry,c=r.Fragment;const l=e.lastBoundBO.getReferenceByName("lastLightComplexity");let f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity"];l&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let u=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];l&&(u=u.concat(["  vec3 specularColor;","  float specularPower;"])),u=u.concat(["  opacity = opacityUniform;"]),l&&(u=u.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.drawingEdges||(f=f.concat(["varying vec4 vertexColorVSOutput;"]),o=Te.substitute(o,"//VTK::Color::Dec",["attribute vec4 gColor;","varying vec4 vertexColorVSOutput;"]).result,o=Te.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput = gColor;"]).result,s=Te.substitute(s,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,s=Te.substitute(s,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,u=u.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])),c=Te.substitute(c,"//VTK::Color::Impl",u).result,c=Te.substitute(c,"//VTK::Color::Dec",f).result,r.Vertex=o,r.Geometry=s,r.Fragment=c}n.replaceShaderColor(r,i,a)},t.replaceShaderPositionVC=(r,i,a)=>{if(e.hardwareSupport){let o=r.Vertex;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=Te.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","vertexVCVSOutput = MCVCMatrix * gVertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result,o=Te.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result):(o=Te.substitute(o,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;"]).result,o=Te.substitute(o,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result),r.Vertex=o}n.replaceShaderPositionVC(r,i,a)},t.replaceShaderPicking=(r,i,a)=>{if(e.hardwareSupport){let o=r.Fragment,s=r.Vertex;s=Te.substitute(s,"//VTK::Picking::Dec",["attribute vec3 mapperIndexVS;","varying vec3 mapperIndexVSOutput;"]).result,s=Te.substitute(s,"//VTK::Picking::Impl","  mapperIndexVSOutput = mapperIndexVS;").result,r.Vertex=s,o=Te.substitute(o,"//VTK::Picking::Dec",["varying vec3 mapperIndexVSOutput;","uniform vec3 mapperIndex;","uniform int picking;"]).result,o=Te.substitute(o,"//VTK::Picking::Impl",["  vec4 pickColor = picking == 2 ? vec4(mapperIndexVSOutput,1.0) : vec4(mapperIndex,1.0);","  gl_FragData[0] = picking != 0 ? pickColor : gl_FragData[0];"]).result,r.Fragment=o}else n.replaceShaderPicking(r,i,a)},t.updateGlyphShaderParameters=(r,i,a,o,s,c,l,f)=>{const u=a.getProgram();if(r){const h=e.normalMatrix,p=c,d=l*9,g=e.tmpMat3,y=h[0],x=h[1],m=h[2],v=h[3],w=h[4],C=h[5],T=h[6],_=h[7],S=h[8],b=p[d],D=p[d+1],E=p[d+2],R=p[d+3],F=p[d+4],M=p[d+5],U=p[d+6],z=p[d+7],Y=p[d+8];g[0]=b*y+D*v+E*T,g[1]=b*x+D*w+E*_,g[2]=b*m+D*C+E*S,g[3]=R*y+F*v+M*T,g[4]=R*x+F*w+M*_,g[5]=R*m+F*C+M*S,g[6]=U*y+z*v+Y*T,g[7]=U*x+z*w+Y*_,g[8]=U*m+z*C+Y*S,u.setUniformMatrix3x3("normalMatrix",e.tmpMat3)}if(t.multiply4x4WithOffset(e.tmpMat4,e.mcpcMatrix,s,l*16),u.setUniformMatrix("MCPCMatrix",e.tmpMat4),i&&(t.multiply4x4WithOffset(e.tmpMat4,e.mcvcMatrix,s,l*16),u.setUniformMatrix("MCVCMatrix",e.tmpMat4)),o){const h=o.getData();e.tmpColor[0]=h[l*4]/255,e.tmpColor[1]=h[l*4+1]/255,e.tmpColor[2]=h[l*4+2]/255,u.setUniform3fArray("ambientColorUniform",e.tmpColor),u.setUniform3fArray("diffuseColorUniform",e.tmpColor)}f&&u.setUniform3fArray("mapperIndex",f.getPropColorValue())},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation(),o=e.context,s=i.getProperty().getEdgeVisibility()&&a===JF.SURFACE,c=e.openGLCamera.getKeyMatrices(r),l=e.openGLActor.getKeyMatrices();Hc(e.normalMatrix,c.normalMatrix,l.normalMatrix),It(e.mcpcMatrix,c.wcpc,l.mcwc),It(e.mcvcMatrix,c.wcvc,l.mcwc);const f=e.renderable.getMatrixArray(),u=e.renderable.getNormalArray(),h=e.renderable.getColorArray(),p=f.length/16;let d=!1;e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().getCurrentPass()===ZF.COMPOSITE_INDEX_PASS&&(d=!0);for(let g=e.primTypes.Start;g<e.primTypes.End;g++){const y=e.primitives[g].getCABO();if(y.getElementCount()){e.drawingEdges=s&&(g===e.primTypes.TrisEdges||g===e.primTypes.TriStripsEdges),e.lastBoundBO=e.primitives[g],e.primitives[g].updateShaders(r,i,t);const x=e.primitives[g].getProgram(),m=e.primitives[g].getOpenGLMode(a),v=x.isUniformUsed("normalMatrix"),w=x.isUniformUsed("MCVCMatrix");if(e.hardwareSupport)e.extension?e.extension.drawArraysInstancedANGLE(m,0,y.getElementCount(),p):o.drawArraysInstanced(m,0,y.getElementCount(),p);else for(let C=0;C<p;++C)d&&e._openGLRenderer.getSelector().renderCompositeIndex(C),t.updateGlyphShaderParameters(v,w,e.primitives[g],h,f,u,C,d?e._openGLRenderer.getSelector():null),o.drawArrays(m,0,y.getElementCount())}}},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.glyphBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){r.getProgram().isAttributeUsed("gMatrix")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.matrixBuffer,"gMatrix",0,64,e.context.FLOAT,4,!1,1)||vu("Error setting gMatrix in shader VAO."):r.getVAO().removeAttributeArray("gMatrix"),r.getProgram().isAttributeUsed("gNormal")?r.getVAO().addAttributeMatrixWithDivisor(r.getProgram(),e.normalBuffer,"gNormal",0,36,e.context.FLOAT,3,!1,1)||vu("Error setting gNormal in shader VAO."):r.getVAO().removeAttributeArray("gNormal"),r.getProgram().isAttributeUsed("gColor")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.colorBuffer,"gColor",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||vu("Error setting gColor in shader VAO."):r.getVAO().removeAttributeArray("gColor"),r.getProgram().isAttributeUsed("mapperIndexVS")?r.getVAO().addAttributeArrayWithDivisor(r.getProgram(),e.pickBuffer,"mapperIndexVS",0,4,e.context.UNSIGNED_BYTE,4,!0,1,!1)||vu("Error setting mapperIndexVS in shader VAO."):r.getVAO().removeAttributeArray("mapperIndexVS"),n.setMapperShaderParameters(r,i,a),r.getAttributeUpdateTime().modified();return}n.setMapperShaderParameters(r,i,a)},t.getNeedToRebuildBufferObjects=(r,i)=>(e.renderable.buildArrays(),e.VBOBuildTime.getMTime()<e.renderable.getBuildTime().getMTime()?!0:n.getNeedToRebuildBufferObjects(r,i)),t.getNeedToRebuildShaders=(r,i,a)=>!!(n.getNeedToRebuildShaders(r,i,a)||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()),t.buildBufferObjects=(r,i)=>{if(e.hardwareSupport){const a=e.renderable.getMatrixArray(),o=e.renderable.getNormalArray(),s=e.renderable.getColorArray();if(e.matrixBuffer||(e.matrixBuffer=qa.newInstance(),e.matrixBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.normalBuffer=qa.newInstance(),e.normalBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.colorBuffer=qa.newInstance(),e.colorBuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.pickBuffer=qa.newInstance(),e.pickBuffer.setOpenGLRenderWindow(e._openGLRenderWindow)),e.renderable.getBuildTime().getMTime()>e.glyphBOBuildTime.getMTime()){e.matrixBuffer.upload(a,h0.ARRAY_BUFFER),e.normalBuffer.upload(o,h0.ARRAY_BUFFER),s?e.colorBuffer.upload(s.getData(),h0.ARRAY_BUFFER):e.colorBuffer.releaseGraphicsResources();const c=a.length/16,l=new Uint8Array(4*c);for(let f=0;f<c;++f){let u=f+1;const h=f*4;l[h]=u%256,u-=l[h],u/=256,l[h+1]=u%256,u-=l[h+1],u/=256,l[h+2]=u%256,l[h+3]=255}e.pickBuffer.upload(l,h0.ARRAY_BUFFER),e.glyphBOBuildTime.modified()}}return n.buildBufferObjects(r,i)}}const nI={normalMatrix:null,mcpcMatrix:null,mcwcMatrix:null};function rI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nI,n),Ah.extend(t,e,n),e.tmpMat3=wi(new Float64Array(9)),e.normalMatrix=wi(new Float64Array(9)),e.mcpcMatrix=ut(new Float64Array(16)),e.mcvcMatrix=ut(new Float64Array(16)),e.tmpColor=[],e.glyphBOBuildTime={},an(e.glyphBOBuildTime,{mtime:0}),tI(t,e)}const m6=kt(rI,"vtkOpenGLGlyph3DMapper");var iI={newInstance:m6};An("vtkGlyph3DMapper",m6);const{vtkErrorMacro:Fv}=sr;function aI(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=n=>{if(n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const r=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(r.getActiveCamera())}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOpaqueActorCount()}},t.opaquePass=(n,r)=>{if(n&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);const i=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",i);const a=e._openGLRenderer.getRenderable(),o=e.openGLCamera.getKeyMatrices(a),s=new Float64Array(16);if(Sn(s,o.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",s),e.lastFormat==="box"){const c=a.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",c[0],c[1],c[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=()=>{if(!e.tris.getCABO().getElementCount()){const r=new Float32Array(12);for(let s=0;s<4;s++)r[s*3]=s%2*2-1,r[s*3+1]=s>1?1:-1,r[s*3+2]=1;const i=ft.newInstance({numberOfComponents:3,values:r});i.setName("points");const a=new Uint16Array(8);a[0]=3,a[1]=0,a[2]=1,a[3]=3,a[4]=3,a[5]=0,a[6]=3,a[7]=2;const o=ft.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",or.SURFACE,{points:i,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Fv("Error setting vertexMC in shader VAO."));const n=e.renderable.getTextures();n.length||Fv("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==n[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(n[0]))}}const oI={context:null};function sI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oI,n),en.extend(t,e,n),e.openGLTexture=fn.newInstance(),e.tris=Ca.newInstance(),e.keyMatrixTime={},an(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:wi(new Float64Array(9)),mcwc:ut(new Float64Array(16))},bn(t,e,["context"]),mr(t,e,["activeTextures"]),aI(t,e)}const v6=kt(sI);var cI={newInstance:v6};An("vtkSkybox",v6);var uI=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;
uniform float scaleFactor;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vec2 scaledOffsetMC = scaleFactor * offsetMC;
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(scaledOffsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + scaledOffsetMC.x*base1 + scaledOffsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + scaledOffsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:lI}=sr;function fI(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=uI,r.Fragment=Ul,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Te.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=Te.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=Te.substitute(s,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;const c=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=Te.substitute(s,"//VTK::Normal::Dec",c).result;let l="";e.context.getExtension("EXT_frag_depth")&&(l=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(l=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=Te.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,l]).result,s=Te.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=Te.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{if(r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"offsetMC",12,r.getCABO().getStride(),e.context.FLOAT,2,!1)||lI("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isUniformUsed("invertedDepth")&&r.getProgram().setUniformf("invertedDepth",e.invert?-1:1),r.getProgram().isUniformUsed("scaleFactor")){const s=e.currentInput.getPointData();e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())?r.getProgram().setUniformf("scaleFactor",e.renderable.getScaleFactor()):r.getProgram().setUniformf("scaleFactor",1)}n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),c=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",c.vcpc),o.isUniformUsed("MCVCMatrix"))if(a.getIsIdentity())o.setUniformMatrix("MCVCMatrix",c.wcvc);else{const l=e.openGLActor.getKeyMatrices(),f=new Float64Array(16);It(f,c.wcvc,l.mcwc),o.setUniformMatrix("MCVCMatrix",f)}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),c=a.getPointData(),l=a.getPoints(),f=l.getNumberOfPoints(),u=l.getData(),h=5;let p=null;e.renderable.getScaleArray()!=null&&c.hasArray(e.renderable.getScaleArray())&&(p=c.getArray(e.renderable.getScaleArray()).getData());let d=null,g=0,y=null;o?(g=o.getNumberOfComponents(),s.setColorOffset(0),s.setColorBOStride(4),d=o.getData(),y=new Uint8Array(3*f*4),s.getColorBO()||s.setColorBO(qa.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):s.getColorBO()&&s.setColorBO(null),s.setColorComponents(g);const x=new Float32Array(h*f*3);s.setStride(h*4);const m=Math.cos(Cn(30));let v=0,w=0,C=0,T=0;for(let _=0;_<f;++_){let S=e.renderable.getRadius();p&&(S=p[_]),v=_*3,x[C++]=u[v++],x[C++]=u[v++],x[C++]=u[v++],x[C++]=-2*S*m,x[C++]=-S,d&&(w=_*g,y[T++]=d[w],y[T++]=d[w+1],y[T++]=d[w+2],y[T++]=d[w+3]),v=_*3,x[C++]=u[v++],x[C++]=u[v++],x[C++]=u[v++],x[C++]=2*S*m,x[C++]=-S,d&&(y[T++]=d[w],y[T++]=d[w+1],y[T++]=d[w+2],y[T++]=d[w+3]),v=_*3,x[C++]=u[v++],x[C++]=u[v++],x[C++]=u[v++],x[C++]=0,x[C++]=2*S,d&&(y[T++]=d[w],y[T++]=d[w+1],y[T++]=d[w+2],y[T++]=d[w+3])}s.setElementCount(C/h),s.upload(x,Qa.ARRAY_BUFFER),o&&s.getColorBO().upload(y,Qa.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const hI={};function pI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hI,n),Ah.extend(t,e,n),fI(t,e)}const y6=kt(pI,"vtkOpenGLSphereMapper");var dI={newInstance:y6};An("vtkSphereMapper",y6);var gI=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;const{vtkErrorMacro:p0}=sr;function mI(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");const n={...t};t.getShaderTemplate=(r,i,a)=>{r.Vertex=gI,r.Fragment=Ul,r.Geometry=""},t.replaceShaderValues=(r,i,a)=>{let o=r.Vertex,s=r.Fragment;o=Te.substitute(o,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,s=Te.substitute(s,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,s=Te.substitute(s,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;const c=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];s=Te.substitute(s,"//VTK::Normal::Dec",c).result;let l="";e.context.getExtension("EXT_frag_depth")&&(l=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(l=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),s=Te.substitute(s,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,l]).result,s=Te.substitute(s,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(s=Te.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),r.Vertex=o,r.Fragment=s,n.replaceShaderValues(r,i,a)},t.setMapperShaderParameters=(r,i,a)=>{r.getCABO().getElementCount()&&(e.VBOBuildTime>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())&&(r.getProgram().isAttributeUsed("orientMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"orientMC",12,r.getCABO().getStride(),e.context.FLOAT,3,!1)||p0("Error setting 'orientMC' in shader VAO.")),r.getProgram().isAttributeUsed("offsetMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"offsetMC",0,r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||p0("Error setting 'offsetMC' in shader VAO.")),r.getProgram().isAttributeUsed("radiusMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"radiusMC",24,r.getCABO().getStride(),e.context.FLOAT,1,!1)||p0("Error setting 'radiusMC' in shader VAO."))),n.setMapperShaderParameters(r,i,a)},t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),s=i.getActiveCamera(),c=e.openGLCamera.getKeyMatrices(i);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",c.vcpc),a.getIsIdentity())o.isUniformUsed("MCVCMatrix")&&o.setUniformMatrix("MCVCMatrix",c.wcvc),o.isUniformUsed("normalMatrix")&&o.setUniformMatrix3x3("normalMatrix",c.normalMatrix);else{const l=e.openGLActor.getKeyMatrices();if(o.isUniformUsed("MCVCMatrix")){const f=new Float64Array(16);It(f,c.wcvc,l.mcwc),o.setUniformMatrix("MCVCMatrix",f)}if(o.isUniformUsed("normalMatrix")){const f=new Float64Array(9);Hc(f,c.normalMatrix,l.normalMatrix),o.setUniformMatrix3x3("normalMatrix",f)}}o.isUniformUsed("cameraParallel")&&r.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},t.getOpenGLMode=(r,i)=>e.context.TRIANGLES,t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,1);const o=e.renderable.getColorMapColors(),s=e.primitives[e.primTypes.Tris].getCABO(),c=a.getPointData(),l=a.getPoints(),f=l.getNumberOfPoints(),u=l.getData();let h=3;h+=4;let p=null,d=0;s.setColorBOStride(4),s.getColorBO()||s.setColorBO(qa.newInstance()),s.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),o&&(d=o.getNumberOfComponents(),s.setColorOffset(4),p=o.getData(),s.setColorBOStride(8)),s.setColorComponents(d),s.setStride(h*4);const g=new Float32Array(h*f*12),y=new Uint8Array(12*f*(p?8:4));let x=null,m=null;e.renderable.getScaleArray()!=null&&c.hasArray(e.renderable.getScaleArray())&&(x=c.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&c.hasArray(e.renderable.getOrientationArray())?m=c.getArray(e.renderable.getOrientationArray()).getData():p0([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);const v=[0,1,3,0,3,2,2,3,5,2,5,4];let w=0,C=0,T=0,_=0;for(let S=0;S<f;++S){let b=e.renderable.getLength(),D=e.renderable.getRadius();x&&(b=x[S*2],D=x[S*2+1]);for(let E=0;E<v.length;++E)w=S*3,g[T++]=u[w++],g[T++]=u[w++],g[T++]=u[w++],w=S*3,g[T++]=m[w++]*b,g[T++]=m[w++]*b,g[T++]=m[w++]*b,g[T++]=D,y[_++]=255*(v[E]%2),y[_++]=v[E]>=4?255:0,y[_++]=v[E]>=2?255:0,y[_++]=255,C=S*d,p&&(y[_++]=p[C],y[_++]=p[C+1],y[_++]=p[C+2],y[_++]=p[C+3])}s.setElementCount(T/h),s.upload(g,Qa.ARRAY_BUFFER),s.getColorBO().upload(y,Qa.ARRAY_BUFFER),e.VBOBuildTime.modified()}}const vI={};function yI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vI,n),Ah.extend(t,e,n),mI(t,e)}const x6=kt(yI,"vtkOpenGLStickMapper");var xI={newInstance:x6};An("vtkStickMapper",x6);function V1(t,e){switch(t){case"Float32Array":return Float32Array;case"Uint8Array":return Uint8Array;case"Uint32Array":return Uint32Array;case"Uint16Array":case"Int16Array":return e?(console.debug(`${t} is not supported for volume rendering, switching back to Float32Array`),Float32Array):t==="Uint16Array"?Uint16Array:Int16Array;default:if(t)throw new Error("TargetBuffer should be Float32Array, Uint8Array, Uint16Array, Int16Array, or Uint32Array");return Float32Array}}function k1(t,e,n={}){const{isVolumeBuffer:r=!1}=n,i=V1(t,r),a=i.BYTES_PER_ELEMENT;return{numBytes:e*a,TypedArrayConstructor:i}}function wI(t,e){e.classHierarchy.push("vtkStreamingOpenGLVolumeMapper"),t.buildBufferObjects=(n,r)=>{const i=e.currentInput;if(!i)return;const a=r.getProperty();if(!e.jitterTexture.getHandle()){const g=new Uint8Array(1024);for(let y=0;y<32*32;++y)g[y]=255*Math.random();e.jitterTexture.setMinificationFilter(lt.LINEAR),e.jitterTexture.setMagnificationFilter(lt.LINEAR),e.jitterTexture.create2DFromRaw(32,32,1,Ot.UNSIGNED_CHAR,g)}const{numberOfComponents:o}=i.get("numberOfComponents"),s=t.useIndependentComponents(a),c=a.getScalarOpacity(),l=e._openGLRenderWindow.getGraphicsResourceForObject(c);let f=xa(c,s,o);if(!l?.oglObject||l.hash!==f){e.opacityTexture=fn.newInstance(),e.opacityTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,y=g*2*o,x=new Float32Array(y),m=new Float32Array(g);for(let v=0;v<o;++v){const w=a.getScalarOpacity(v),C=t.getCurrentSampleDistance(n)/a.getScalarOpacityUnitDistance(v),T=w.getRange();w.getTable(T[0],T[1],g,m,1);for(let _=0;_<g;++_)x[v*g*2+_]=1-(1-m[_])**C,x[v*g*2+_+g]=x[v*g*2+_]}if(e.opacityTexture.resetFormatAndType(),e.opacityTexture.setMinificationFilter(lt.LINEAR),e.opacityTexture.setMagnificationFilter(lt.LINEAR),e._openGLRenderWindow.getWebgl2()&&e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))e.opacityTexture.create2DFromRaw(g,2*o,1,Ot.FLOAT,x);else{const v=new Uint8ClampedArray(y);for(let w=0;w<y;++w)v[w]=255*x[w];e.opacityTexture.create2DFromRaw(g,2*o,1,Ot.UNSIGNED_CHAR,v)}c&&(e._openGLRenderWindow.setGraphicsResourceForObject(c,e.opacityTexture,f),c!==e._scalarOpacityFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(c,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._scalarOpacityFunc,t)),e._scalarOpacityFunc=c)}else e.opacityTexture=l.oglObject;const h=a.getRGBTransferFunction();f=xa(h,s,o);const p=e._openGLRenderWindow.getGraphicsResourceForObject(h);if(!p?.oglObject?.getHandle()||p?.hash!==f){e.colorTexture=fn.newInstance(),e.colorTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const g=1024,y=g*2*o*3,x=new Uint8ClampedArray(y),m=new Float32Array(g*3);for(let v=0;v<o;++v){const w=a.getRGBTransferFunction(v),C=w.getRange();w.getTable(C[0],C[1],g,m,1);for(let T=0;T<g*3;++T)x[v*g*6+T]=255*m[T],x[v*g*6+T+g*3]=255*m[T]}e.colorTexture.resetFormatAndType(),e.colorTexture.setMinificationFilter(lt.LINEAR),e.colorTexture.setMagnificationFilter(lt.LINEAR),e.colorTexture.create2DFromRaw(g,2*o,3,Ot.UNSIGNED_CHAR,x),h&&(e._openGLRenderWindow.setGraphicsResourceForObject(h,e.colorTexture,f),h!==e._colorTransferFunc&&(e._openGLRenderWindow.registerGraphicsResourceUser(h,t),e._openGLRenderWindow.unregisterGraphicsResourceUser(e._colorTransferFunc,t)),e._colorTransferFunc=h)}else e.colorTexture=p.oglObject;if(t.updateLabelOutlineThicknessTexture(r),f=`${i.getMTime()}-${e.scalarTexture.getMTime()}`,e.scalarTextureString!==f){const g=i.getDimensions();e.scalarTexture.setOpenGLRenderWindow(e._openGLRenderWindow),e.scalarTexture.enableUseHalfFloat(!1);const y=e.scalarTexture.getTextureParameters(),x=i.get("dataType").dataType;let m=!0;if(y?.dataType===x&&y?.width===g[0]&&y?.height===g[1]&&y?.depth===g[2]&&(m=!1),m){const v=e.context.getExtension("EXT_texture_norm16");e.scalarTexture.setOglNorm16Ext(K7()?v:null),e.scalarTexture.resetFormatAndType(),e.scalarTexture.setTextureParameters({width:g[0],height:g[1],depth:g[2],numberOfComponents:o,dataType:x}),e.scalarTexture.create3DFromRaw(g[0],g[1],g[2],o,x,null),e.scalarTexture.update3DFromRaw()}else e.scalarTexture.deactivate(),e.scalarTexture.update3DFromRaw();e.scalarTextureString=f}if(!e.tris.getCABO().getElementCount()){const g=new Float32Array(12);for(let v=0;v<4;v++)g[v*3]=v%2*2-1,g[v*3+1]=v>1?1:-1,g[v*3+2]=-1;const y=new Uint16Array(8);y[0]=3,y[1]=0,y[2]=1,y[3]=3,y[4]=3,y[5]=0,y[6]=3,y[7]=2;const x=ft.newInstance({numberOfComponents:3,values:g});x.setName("points");const m=ft.newInstance({numberOfComponents:1,values:y});e.tris.getCABO().createVBO(m,"polys",or.SURFACE,{points:x,cellOffset:0})}e.VBOBuildTime.modified()},t.getNeedToRebuildBufferObjects=(n,r)=>e.VBOBuildTime.getMTime()<t.getMTime()||e.VBOBuildTime.getMTime()<r.getMTime()||e.VBOBuildTime.getMTime()<e.renderable.getMTime()||e.VBOBuildTime.getMTime()<r.getProperty().getMTime()||e.VBOBuildTime.getMTime()<e.currentInput.getMTime()||e.VBOBuildTime.getMTime()<e.scalarTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.colorTexture?.getMTime()||e.VBOBuildTime.getMTime()<e.labelOutlineThicknessTexture?.getMTime()||!e.scalarTexture?.getHandle()||!e.colorTexture?.getHandle()||!e.labelOutlineThicknessTexture?.getHandle()}const CI={};function TI(t,e,n={}){Object.assign(e,CI,n),x8.extend(t,e,n),e.scalarTexture=n.scalarTexture,e.previousState={},wI(t,e)}const _I=J.newInstance(TI,"vtkStreamingOpenGLVolumeMapper"),SI={newInstance:_I},w6=Object.create(null);function Jn(t,e){w6[t]=e}function bI(t,e){e.classHierarchy.push("vtkStreamingOpenGLViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),a=!1;const o=Object.keys(e.overrides);for(;i&&!a;)o.includes(i)?a=!0:i=n.getClassName(r++);if(!a)return null;const s=e.getModelInitialValues(n),c=e.overrides[i](s);return c.setMyFactory(t),c},e.overrides=w6,e.getModelInitialValues=n=>{const r={};return n.getClassName()==="vtkSharedVolumeMapper"&&(r.scalarTexture=n.getScalarTexture()),r}}const EI={};function C6(t,e,n={}){Object.assign(e,EI,n),b1.extend(t,e,n),bI(t,e),Jn("vtkActor",CF.newInstance),Jn("vtkActor2D",bF.newInstance),Jn("vtkCamera",MD.newInstance),Jn("vtkGlyph3DMapper",iI.newInstance),Jn("vtkImageMapper",SM.newInstance),Jn("vtkImageCPRMapper",RM.newInstance),Jn("vtkImageSlice",AM.newInstance),Jn("vtkMapper",Ah.newInstance),Jn("vtkPixelSpaceCallbackMapper",JM.newInstance),Jn("vtkRenderer",ID.newInstance),Jn("vtkSkybox",cI.newInstance),Jn("vtkSphereMapper",dI.newInstance),Jn("vtkStickMapper",xI.newInstance),Jn("vtkTexture",fn.newInstance),Jn("vtkVolume",VM.newInstance),Jn("vtkVolumeMapper",x8.newInstance),Jn("vtkSharedVolumeMapper",SI.newInstance)}const DI=J.newInstance(C6,"vtkStreamingOpenGLViewNodeFactory"),OI={newInstance:DI,extend:C6};function RI(t,e){e.classHierarchy.push("vtkStreamingOpenGLRenderWindow")}function T6(t,e,n={}){Object.assign(e,n),vF.extend(t,e,n),e.myFactory=OI.newInstance(),Jn("vtkRenderWindow",_6),RI(t,e)}const _6=J.newInstance(T6,"vtkStreamingOpenGLRenderWindow"),MI={newInstance:_6,extend:T6},{vtkDebugMacro:d0}=J;function NI(t,e){e.classHierarchy.push("vtkCamera");const n=new Float64Array(3),r=new Float64Array([0,0,-1]),i=new Float64Array([0,1,0]),a=ut(new Float64Array(16)),o=ut(new Float64Array(16)),s=new Float64Array(3),c=new Float64Array(3),l=new Float64Array(3),f=ut(new Float64Array(16)),u=ut(new Float64Array(16)),h=new Float64Array(3),p=new Float64Array(3);function d(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=()=>{const g=t.getViewMatrix();e.viewUp[0]=g[4],e.viewUp[1]=g[5],e.viewUp[2]=g[6],t.modified()},t.setPosition=(g,y,x)=>{g===e.position[0]&&y===e.position[1]&&x===e.position[2]||(e.position[0]=g,e.position[1]=y,e.position[2]=x,t.computeDistance(),t.modified())},t.setFocalPoint=(g,y,x)=>{g===e.focalPoint[0]&&y===e.focalPoint[1]&&x===e.focalPoint[2]||(e.focalPoint[0]=g,e.focalPoint[1]=y,e.focalPoint[2]=x,t.computeDistance(),t.modified())},t.setDistance=g=>{if(e.distance===g)return;e.distance=g,e.distance<1e-20&&(e.distance=1e-20,d0("Distance is set to minimum."));const y=e.directionOfProjection;e.focalPoint[0]=e.position[0]+y[0]*e.distance,e.focalPoint[1]=e.position[1]+y[1]*e.distance,e.focalPoint[2]=e.position[2]+y[2]*e.distance,t.modified()},t.computeDistance=()=>{const g=e.focalPoint[0]-e.position[0],y=e.focalPoint[1]-e.position[1],x=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(g*g+y*y+x*x),e.distance<1e-20){e.distance=1e-20,d0("Distance is set to minimum.");const m=e.directionOfProjection;e.focalPoint[0]=e.position[0]+m[0]*e.distance,e.focalPoint[1]=e.position[1]+m[1]*e.distance,e.focalPoint[2]=e.position[2]+m[2]*e.distance}e.directionOfProjection[0]=g/e.distance,e.directionOfProjection[1]=y/e.distance,e.directionOfProjection[2]=x/e.distance,d()},t.dolly=g=>{if(g<=0)return;const y=e.distance/g;t.setPosition(e.focalPoint[0]-y*e.directionOfProjection[0],e.focalPoint[1]-y*e.directionOfProjection[1],e.focalPoint[2]-y*e.directionOfProjection[2])},t.roll=g=>{const y=e.position,x=e.focalPoint,m=e.viewUp,v=new Float64Array([m[0],m[1],m[2],0]);ut(f);const w=new Float64Array([x[0]-y[0],x[1]-y[1],x[2]-y[2]]);Li(f,f,Cn(g),w),Js(v,v,f),e.viewUp[0]=v[0],e.viewUp[1]=v[1],e.viewUp[2]=v[2],t.modified()},t.azimuth=g=>{const y=e.focalPoint;ut(u),hn(u,u,y),Li(u,u,Cn(g),e.viewUp),hn(u,u,[-y[0],-y[1],-y[2]]),Dt(h,e.position,u),t.setPosition(h[0],h[1],h[2])},t.yaw=g=>{const y=e.position;ut(u),hn(u,u,y),Li(u,u,Cn(g),e.viewUp),hn(u,u,[-y[0],-y[1],-y[2]]),Dt(p,e.focalPoint,u),t.setFocalPoint(p[0],p[1],p[2])},t.elevation=g=>{const y=e.focalPoint,x=t.getViewMatrix(),m=[-x[0],-x[1],-x[2]];ut(u),hn(u,u,y),Li(u,u,Cn(g),m),hn(u,u,[-y[0],-y[1],-y[2]]),Dt(h,e.position,u),t.setPosition(h[0],h[1],h[2])},t.pitch=g=>{const y=e.position,x=t.getViewMatrix(),m=[x[0],x[1],x[2]];ut(u),hn(u,u,y),Li(u,u,Cn(g),m),hn(u,u,[-y[0],-y[1],-y[2]]),Dt(p,e.focalPoint,u),t.setFocalPoint(...p)},t.zoom=g=>{g<=0||(e.parallelProjection?e.parallelScale/=g:e.viewAngle/=g,t.modified())},t.translate=(g,y,x)=>{const m=[g,y,x];_f(e.position,m,e.position),_f(e.focalPoint,m,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=g=>{const y=[...e.viewUp,1],x=[],m=[],v=[];y[0]+=e.position[0],y[1]+=e.position[1],y[2]+=e.position[2],Js(x,[...e.position,1],g),Js(m,[...e.focalPoint,1],g),Js(v,y,g),v[0]-=x[0],v[1]-=x[1],v[2]-=x[2],t.setPosition(...x.slice(0,3)),t.setFocalPoint(...m.slice(0,3)),t.setViewUp(...v.slice(0,3))},t.getThickness=()=>e.clippingRange[1]-e.clippingRange[0],t.setThickness=g=>{let y=g;y<1e-20&&(y=1e-20,d0("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+y)},t.setThicknessFromFocalPoint=g=>{let y=g;y<1e-20&&(y=1e-20,d0("Thickness is set to minimum.")),t.setClippingRange(e.distance-y/2,e.distance+y/2)},t.setRoll=g=>{},t.getRoll=()=>{},t.setObliqueAngles=(g,y)=>{},t.getOrientation=()=>{},t.getOrientationWXYZ=()=>{},t.getFrustumPlanes=g=>{},t.getCameraLightTransformMatrix=g=>(pn(g,e.cameraLightTransform),g),t.computeCameraLightTransform=()=>{pn(a,t.getViewMatrix()),Sn(a,a),a1(o,[e.distance,e.distance,e.distance]),It(a,a,o),ut(e.cameraLightTransform),hn(e.cameraLightTransform,a,[0,0,-1])},t.deepCopy=g=>{},t.physicalOrientationToWorldDirection=g=>{const y=Km(g[0],g[1],g[2],g[3]),x=sc(),m=Km(0,0,1,0);return bE(x,y),Hm(m,y,m),Hm(m,m,x),[m[0],m[1],m[2]]},t.getPhysicalToWorldMatrix=g=>{t.getWorldToPhysicalMatrix(g),Sn(g,g)},t.getWorldToPhysicalMatrix=g=>{ut(g);const y=[3];ga(e.physicalViewNorth,e.physicalViewUp,y),g[0]=y[0],g[1]=y[1],g[2]=y[2],g[4]=e.physicalViewUp[0],g[5]=e.physicalViewUp[1],g[6]=e.physicalViewUp[2],g[8]=-e.physicalViewNorth[0],g[9]=-e.physicalViewNorth[1],g[10]=-e.physicalViewNorth[2],Rt(g,g),$t(s,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),va(g,g,s),hn(g,g,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=g=>{Sn(a,g),Dt(s,n,a),t.computeDistance();const y=e.distance;t.setPosition(s[0],s[1],s[2]),Dt(c,r,a),Ln(c,c,s),gn(c,c),t.setDirectionOfProjection(c[0],c[1],c[2]),Dt(l,i,a),Ln(l,l,s),gn(l,l),t.setViewUp(l[0],l[1],l[2]),t.setDistance(y)},t.computeViewParametersFromPhysicalMatrix=g=>{t.getWorldToPhysicalMatrix(a),It(a,g,a),t.computeViewParametersFromViewMatrix(a)},t.setViewMatrix=g=>{e.viewMatrix=g,e.viewMatrix&&(pn(a,e.viewMatrix),t.computeViewParametersFromViewMatrix(a),Rt(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=()=>{if(e.viewMatrix)return e.viewMatrix;b4(a,e.position,e.focalPoint,e.viewUp),Rt(a,a);const g=new Float64Array(16);return pn(g,a),g},t.setProjectionMatrix=g=>{e.projectionMatrix=g},t.getProjectionMatrix=(g,y,x)=>{const m=new Float64Array(16);if(ut(m),e.projectionMatrix){const C=1/e.physicalScale;return $t(s,C,C,C),pn(m,e.projectionMatrix),va(m,m,s),Rt(m,m),m}ut(a);const v=e.clippingRange[1]-e.clippingRange[0],w=[e.clippingRange[0]+(y+1)*v/2,e.clippingRange[0]+(x+1)*v/2];if(e.parallelProjection){const C=e.parallelScale*g,T=e.parallelScale,_=(e.windowCenter[0]-1)*C,S=(e.windowCenter[0]+1)*C,b=(e.windowCenter[1]-1)*T,D=(e.windowCenter[1]+1)*T;s1(a,_,S,b,D,w[0],w[1]),Rt(a,a)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const C=Math.tan(Cn(e.viewAngle)/2);let T,_;e.useHorizontalViewAngle===!0?(T=e.clippingRange[0]*C,_=e.clippingRange[0]*C/g):(T=e.clippingRange[0]*C*g,_=e.clippingRange[0]*C);const S=(e.windowCenter[0]-1)*T,b=(e.windowCenter[0]+1)*T,D=(e.windowCenter[1]-1)*_,E=(e.windowCenter[1]+1)*_,R=w[0],F=w[1];a[0]=2*R/(b-S),a[5]=2*R/(E-D),a[2]=(S+b)/(b-S),a[6]=(D+E)/(E-D),a[10]=-(R+F)/(F-R),a[14]=-1,a[11]=-2*R*F/(F-R),a[15]=0}}return pn(m,a),m},t.getCompositeProjectionMatrix=(g,y,x)=>{const m=t.getViewMatrix(),v=t.getProjectionMatrix(g,y,x);return It(v,m,v),v},t.setDirectionOfProjection=(g,y,x)=>{if(e.directionOfProjection[0]===g&&e.directionOfProjection[1]===y&&e.directionOfProjection[2]===x)return;e.directionOfProjection[0]=g,e.directionOfProjection[1]=y,e.directionOfProjection[2]=x;const m=e.directionOfProjection;e.focalPoint[0]=e.position[0]+m[0]*e.distance,e.focalPoint[1]=e.position[1]+m[1]*e.distance,e.focalPoint[2]=e.position[2]+m[2]*e.distance,d()},t.setDeviceAngles=(g,y,x,m)=>{const v=[3];ga(e.physicalViewNorth,e.physicalViewUp,v);const w=ut(new Float64Array(16));Li(w,w,Cn(g),e.physicalViewUp),Li(w,w,Cn(y),v),Li(w,w,Cn(x),e.physicalViewNorth),Li(w,w,Cn(-m),e.physicalViewUp);const C=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),T=new Float64Array(e.physicalViewNorth);Dt(C,C,w),Dt(T,T,w),t.setDirectionOfProjection(C[0],C[1],C[2]),t.setViewUp(T[0],T[1],T[2]),t.modified()},t.setOrientationWXYZ=(g,y,x,m)=>{const v=ut(new Float64Array(16));if(g!==0&&(y!==0||x!==0||m!==0)){const T=Cn(g),_=sc();c1(_,[y,x,m],T),Ef(v,_)}const w=new Float64Array(3);Dt(w,[0,0,-1],v);const C=new Float64Array(3);Dt(C,[0,1,0],v),t.setDirectionOfProjection(...w),t.setViewUp(...C),t.modified()},t.computeClippingRange=g=>{let y=null,x=null;y=e.viewPlaneNormal,x=e.position;const m=-y[0],v=-y[1],w=-y[2],C=-(m*x[0]+v*x[1]+w*x[2]),T=[m*g[0]+v*g[2]+w*g[4]+C,1e-18];for(let _=0;_<2;_++)for(let S=0;S<2;S++)for(let b=0;b<2;b++){const D=m*g[b]+v*g[2+S]+w*g[4+_]+C;T[0]=D<T[0]?D:T[0],T[1]=D>T[1]?D:T[1]}return T}}const LI={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:ma(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function S6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LI,n),J.obj(t,e),J.get(t,e,["distance"]),J.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),J.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),J.setGetArray(t,e,["clippingRange","windowCenter"],2),J.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),NI(t,e)}const AI=J.newInstance(S6,"vtkCamera");var U1={newInstance:AI,extend:S6};function FI(t,e){e.classHierarchy.push("vtkLight");const n=new Float64Array(3);t.getTransformedPosition=()=>(e.transformMatrix?Dt(n,e.position,e.transformMatrix):$t(n,e.position[0],e.position[1],e.position[2]),n),t.getTransformedFocalPoint=()=>(e.transformMatrix?Dt(n,e.focalPoint,e.transformMatrix):$t(n,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),n),t.getDirection=()=>(e.directionMTime<e.mtime&&(Bn(e.direction,e.focalPoint,e.position),oc(e.direction),e.directionMTime=e.mtime),e.direction),t.setDirection=r=>{const i=new Float64Array(3);Bn(i,e.position,r),e.focalPoint=i},t.setDirectionAngle=(r,i)=>{const a=Cn(r),o=Cn(i);t.setPosition(Math.cos(a)*Math.sin(o),Math.sin(a),Math.cos(a)*Math.cos(o)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=()=>{t.setLightType("HeadLight")},t.setLightTypeToCameraLight=()=>{t.setLightType("CameraLight")},t.setLightTypeToSceneLight=()=>{t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=()=>e.lightType==="HeadLight",t.lightTypeIsSceneLight=()=>e.lightType==="SceneLight",t.lightTypeIsCameraLight=()=>e.lightType==="CameraLight"}const II={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function PI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,II,n),J.obj(t,e),J.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),J.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),FI(t,e)}const VI=J.newInstance(PI,"vtkLight");var kI={newInstance:VI};const{vtkErrorMacro:ef}=J;function UI(t){return()=>ef(`vtkViewport::${t} - NOT IMPLEMENTED`)}function BI(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=()=>e.props,t.hasViewProp=r=>e.props.includes(r),t.addViewProp=r=>{r&&!t.hasViewProp(r)&&e.props.push(r)},t.removeViewProp=r=>{const i=e.props.filter(a=>a!==r);e.props.length!==i.length&&(e.props=i)},t.removeAllViewProps=()=>{e.props=[]};function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.push(r);const a=r.getNestedProps();if(a&&a.length)for(let o=0;o<a.length;o++)n(a[o],i);return i}t.getViewPropsWithNestedProps=()=>{const r=[];for(let i=0;i<e.props.length;i++)n(e.props[i],r);return r},t.addActor2D=t.addViewProp,t.removeActor2D=r=>{t.removeViewProp(r)},t.getActors2D=()=>(e.actors2D=[],e.props.forEach(r=>{e.actors2D=e.actors2D.concat(r.getActors2D())}),e.actors2D),t.displayToView=()=>ef("call displayToView on your view instead"),t.viewToDisplay=()=>ef("callviewtodisplay on your view instead"),t.getSize=()=>ef("call getSize on your View instead"),t.normalizedDisplayToProjection=(r,i,a)=>{const o=t.normalizedDisplayToNormalizedViewport(r,i,a);return t.normalizedViewportToProjection(o[0],o[1],o[2])},t.normalizedDisplayToNormalizedViewport=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(r-e.viewport[0])/o[0],(i-e.viewport[1])/o[1],a]},t.normalizedViewportToProjection=(r,i,a)=>[r*2-1,i*2-1,a*2-1],t.projectionToNormalizedDisplay=(r,i,a)=>{const o=t.projectionToNormalizedViewport(r,i,a);return t.normalizedViewportToNormalizedDisplay(o[0],o[1],o[2])},t.normalizedViewportToNormalizedDisplay=(r,i,a)=>{const o=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[r*o[0]+e.viewport[0],i*o[1]+e.viewport[1],a]},t.projectionToNormalizedViewport=(r,i,a)=>[(r+1)*.5,(i+1)*.5,(a+1)*.5],t.PickPropFrom=UI("PickPropFrom")}const GI={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function b6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GI,n),J.obj(t,e),J.event(t,e,"event"),J.setGetArray(t,e,["viewport"],4),J.setGetArray(t,e,["background","background2"],3),BI(t,e)}const WI=J.newInstance(b6,"vtkViewport");var zI={newInstance:WI,extend:b6};const{vtkDebugMacro:yu,vtkErrorMacro:Io,vtkWarningMacro:jI}=sr;function Iv(t){return()=>Io(`vtkRenderer::${t} - NOT IMPLEMENTED`)}function $I(t,e){e.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:t},r={type:"ResetCameraClippingRangeEvent",renderer:t},i={type:"ResetCameraEvent",renderer:t};t.updateCamera=()=>(e.activeCamera||(yu("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0),t.updateLightsGeometryToFollowCamera=()=>{const a=t.getActiveCameraAndResetIfCreated();e.lights.forEach(o=>{o.lightTypeIsSceneLight()||(o.lightTypeIsHeadLight()?(o.setPositionFrom(a.getPositionByReference()),o.setFocalPointFrom(a.getFocalPointByReference()),o.modified(a.getMTime())):o.lightTypeIsCameraLight()?o.setTransformMatrix(a.getCameraLightTransformMatrix(ma())):Io("light has unknown light type",o.get()))})},t.updateLightGeometry=()=>e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0,t.allocateTime=Iv("allocateTime"),t.updateGeometry=Iv("updateGeometry"),t.getVTKWindow=()=>e._renderWindow,t.setLayer=a=>{yu(t.getClassName(),t,"setting Layer to ",a),e.layer!==a&&(e.layer=a,t.modified()),t.setPreserveColorBuffer(!!a)},t.setActiveCamera=a=>e.activeCamera===a?!1:(e.activeCamera=a,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:a}),!0),t.makeCamera=()=>{const a=U1.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:a}),a},t.getActiveCamera=()=>(e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera),t.getActiveCameraAndResetIfCreated=()=>(e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera),t.getActors=()=>(e.actors=[],e.props.forEach(a=>{e.actors=e.actors.concat(a.getActors())}),e.actors),t.addActor=t.addViewProp,t.removeActor=a=>{e.actors=e.actors.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllActors=()=>{t.getActors().forEach(o=>{t.removeViewProp(o)}),e.actors=[],t.modified()},t.getVolumes=()=>(e.volumes=[],e.props.forEach(a=>{e.volumes=e.volumes.concat(a.getVolumes())}),e.volumes),t.addVolume=t.addViewProp,t.removeVolume=a=>{e.volumes=e.volumes.filter(o=>o!==a),t.removeViewProp(a),t.modified()},t.removeAllVolumes=()=>{t.getVolumes().forEach(o=>{t.removeViewProp(o)}),e.volumes=[],t.modified()},t.hasLight=a=>e.lights.includes(a),t.addLight=a=>{a&&!t.hasLight(a)&&(e.lights.push(a),t.modified())},t.removeLight=a=>{e.lights=e.lights.filter(o=>o!==a),t.modified()},t.removeAllLights=()=>{e.lights=[],t.modified()},t.setLightCollection=a=>{e.lights=a,t.modified()},t.makeLight=kI.newInstance,t.createLight=()=>{e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=(a,o,s,c)=>{let l=t.normalizedDisplayToProjection(a,o,s);return l=t.projectionToView(l[0],l[1],l[2],c),t.viewToWorld(l[0],l[1],l[2])},t.worldToNormalizedDisplay=(a,o,s,c)=>{let l=t.worldToView(a,o,s);return l=t.viewToProjection(l[0],l[1],l[2],c),t.projectionToNormalizedDisplay(l[0],l[1],l[2])},t.viewToWorld=(a,o,s)=>{if(e.activeCamera===null)return Io("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();Sn(c,c),Rt(c,c);const l=new Float64Array([a,o,s]);return Dt(l,l,c),l},t.projectionToView=(a,o,s,c)=>{if(e.activeCamera===null)return Io("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getProjectionMatrix(c,-1,1);Sn(l,l),Rt(l,l);const f=new Float64Array([a,o,s]);return Dt(f,f,l),f},t.worldToView=(a,o,s)=>{if(e.activeCamera===null)return Io("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();Rt(c,c);const l=new Float64Array([a,o,s]);return Dt(l,l,c),l},t.viewToProjection=(a,o,s,c)=>{if(e.activeCamera===null)return Io("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const l=e.activeCamera.getProjectionMatrix(c,-1,1);Rt(l,l);const f=new Float64Array([a,o,s]);return Dt(f,f,l),f},t.computeVisiblePropBounds=()=>{e.allBounds[0]=Kt.INIT_BOUNDS[0],e.allBounds[1]=Kt.INIT_BOUNDS[1],e.allBounds[2]=Kt.INIT_BOUNDS[2],e.allBounds[3]=Kt.INIT_BOUNDS[3],e.allBounds[4]=Kt.INIT_BOUNDS[4],e.allBounds[5]=Kt.INIT_BOUNDS[5];let a=!0;t.invokeEvent(n);for(let o=0;o<e.props.length;++o){const s=e.props[o];if(s.getVisibility()&&s.getUseBounds()){const c=s.getBounds();c&&H0(c)&&(a=!1,c[0]<e.allBounds[0]&&(e.allBounds[0]=c[0]),c[1]>e.allBounds[1]&&(e.allBounds[1]=c[1]),c[2]<e.allBounds[2]&&(e.allBounds[2]=c[2]),c[3]>e.allBounds[3]&&(e.allBounds[3]=c[3]),c[4]<e.allBounds[4]&&(e.allBounds[4]=c[4]),c[5]>e.allBounds[5]&&(e.allBounds[5]=c[5]))}}return a&&(tu(e.allBounds),yu("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds(),s=[0,0,0];if(!H0(o))return yu("Cannot reset camera!"),!1;let c=null;if(t.getActiveCamera())c=e.activeCamera.getViewPlaneNormal();else return Io("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),s[0]=(o[0]+o[1])/2,s[1]=(o[2]+o[3])/2,s[2]=(o[4]+o[5])/2;let l=o[1]-o[0],f=o[3]-o[2],u=o[5]-o[4];l*=l,f*=f,u*=u;let h=l+f+u;h=h===0?1:h,h=Math.sqrt(h)*.5;const p=Cn(e.activeCamera.getViewAngle()),d=h,g=h/Math.sin(p*.5),y=e.activeCamera.getViewUp();return Math.abs(Et(y,c))>.999&&(jI("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-y[2],y[0],y[1])),e.activeCamera.setFocalPoint(s[0],s[1],s[2]),e.activeCamera.setPosition(s[0]+g*c[0],s[1]+g*c[1],s[2]+g*c[2]),t.resetCameraClippingRange(o),e.activeCamera.setParallelScale(d),e.activeCamera.setPhysicalScale(h),e.activeCamera.setPhysicalTranslation(-s[0],-s[1],-s[2]),t.invokeEvent(i),!0},t.resetCameraClippingRange=function(){const o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds();if(!H0(o))return yu("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return Io("Trying to reset clipping range of non-existent camera"),!1;const s=e.activeCamera.computeClippingRange(o);let c=0;if(e.activeCamera.getParallelProjection())c=.2*e.activeCamera.getParallelScale();else{const l=Cn(e.activeCamera.getViewAngle());c=.2*Math.tan(l/2)*s[1]}return s[1]-s[0]<c&&(c=c-s[1]+s[0],s[1]+=c/2,s[0]-=c/2),s[0]<0&&(s[0]=0),s[0]=.99*s[0]-(s[1]-s[0])*e.clippingRangeExpansion,s[1]=1.01*s[1]+(s[1]-s[0])*e.clippingRangeExpansion,s[0]=s[0]>=s[1]?.01*s[1]:s[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),s[0]<e.nearClippingPlaneTolerance*s[1]&&(s[0]=e.nearClippingPlaneTolerance*s[1]),e.activeCamera.setClippingRange(s[0],s[1]),t.invokeEvent(r),!1},t.setRenderWindow=a=>{a!==e._renderWindow&&(e._vtkWindow=a,e._renderWindow=a)},t.visibleActorCount=()=>e.props.filter(a=>a.getVisibility()).length,t.visibleVolumeCount=t.visibleActorCount,t.getMTime=()=>{let a=e.mtime;const o=e.activeCamera?e.activeCamera.getMTime():0;o>a&&(a=o);const s=e._createdLight?e._createdLight.getMTime():0;return s>a&&(a=s),a},t.getTransparent=()=>!!e.preserveColorBuffer,t.isActiveCameraCreated=()=>!!e.activeCamera}const HI={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:ns(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function E6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,HI,n),zI.extend(t,e,n),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),mr(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),bn(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),eu(t,e,["actors","volumes","lights"]),Ug(t,e,["background"],4,1),Nl(t,e,["renderWindow"]),$I(t,e)}const KI=kt(E6,"vtkRenderer");var qI={newInstance:KI,extend:E6};const XI={Unknown:0,LeftController:1,RightController:2},YI={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},JI={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4};var D6={Device:XI,Input:YI,Axis:JI};const{Device:g0,Input:Ws}=D6,{vtkWarningMacro:m0,vtkErrorMacro:v0,normalizeWheel:ZI,vtkOnceErrorMacro:QI}=J,xc={ctrlKey:!1,altKey:!1,shiftKey:!1},Lp={"xr-standard":[Ws.Trigger,Ws.Grip,Ws.TrackPad,Ws.Thumbstick,Ws.A,Ws.B]},B1=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function xu(t){t.cancelable&&t.preventDefault()}function y0(t){const e=Object.create(null);return t.forEach(n=>{let{pointerId:r,position:i}=n;e[r]=i}),e}function eP(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");const n={...t},r=new Set,i=new Map;let a=1;t.start=()=>{!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=g=>{v0("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=g=>{e.interactorStyle!==g&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=g,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=()=>{e.initialized=!0,t.enable(),t.render()},t.enable=()=>t.setEnabled(!0),t.disable=()=>t.setEnabled(!1),t.startEventLoop=()=>m0("empty event loop");function o(g,y){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(g,y))}t.getCurrentRenderer=()=>(e.currentRenderer||o(0,0),e.currentRenderer);function s(g){const y=e._view.getCanvas(),x=y.getBoundingClientRect(),m=y.width/x.width,v=y.height/x.height,w={x:m*(g.clientX-x.left),y:v*(x.height-g.clientY+x.top),z:0};return(i.size<=1||!e.currentRenderer)&&o(w.x,w.y),w}const c=e._getScreenEventPositionFor||s;function l(g){return{controlKey:g.ctrlKey,altKey:g.altKey,shiftKey:g.shiftKey}}function f(g){const y=l(g);return{key:g.key,keyCode:g.charCode,...y}}function u(g){return g.pointerType||""}const h=()=>{if(e.container===null)return;const{container:g}=e;g.addEventListener("contextmenu",xu),g.addEventListener("wheel",t.handleWheel),g.addEventListener("DOMMouseScroll",t.handleWheel),g.addEventListener("pointerenter",t.handlePointerEnter),g.addEventListener("pointerleave",t.handlePointerLeave),g.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.addEventListener("pointerup",t.handlePointerUp),g.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),g.style.touchAction="none",g.style.userSelect="none",g.style.webkitTapHighlightColor="rgba(0,0,0,0)"};t.bindEvents=g=>{if(g===null)return;n.setContainer(g)&&h()};const p=()=>{clearTimeout(e.moveTimeoutID),clearTimeout(e.wheelTimeoutID),e.moveTimeoutID=0,e.wheelTimeoutID=0,a=1;const{container:g}=e;g&&(g.removeEventListener("contextmenu",xu),g.removeEventListener("wheel",t.handleWheel),g.removeEventListener("DOMMouseScroll",t.handleWheel),g.removeEventListener("pointerenter",t.handlePointerEnter),g.removeEventListener("pointerleave",t.handlePointerLeave),g.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),g.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),g.removeEventListener("pointerup",t.handlePointerUp),g.removeEventListener("pointercancel",t.handlePointerCancel)),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),i.clear()};t.unbindEvents=()=>{p(),n.setContainer(null)},t.handleKeyPress=g=>{const y=f(g);t.keyPressEvent(y)},t.handleKeyDown=g=>{const y=f(g);t.keyDownEvent(y)},t.handleKeyUp=g=>{const y=f(g);t.keyUpEvent(y)},t.handlePointerEnter=g=>{const y={...l(g),position:c(g),deviceType:u(g)};t.pointerEnterEvent(y),y.deviceType==="mouse"&&t.mouseEnterEvent(y)},t.handlePointerLeave=g=>{const y={...l(g),position:c(g),deviceType:u(g)};t.pointerLeaveEvent(y),y.deviceType==="mouse"&&t.mouseLeaveEvent(y)},t.handlePointerDown=g=>{if(!(g.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&xu(g),g.target.hasPointerCapture(g.pointerId)&&g.target.releasePointerCapture(g.pointerId),e.container.setPointerCapture(g.pointerId),i.has(g.pointerId)&&m0("[RenderWindowInteractor] duplicate pointerId detected"),i.set(g.pointerId,{pointerId:g.pointerId,position:c(g)}),g.pointerType){case"pen":case"touch":t.handleTouchStart(g);break;case"mouse":default:t.handleMouseDown(g);break}},t.handlePointerUp=g=>{if(i.has(g.pointerId))switch(e.preventDefaultOnPointerUp&&xu(g),i.delete(g.pointerId),e.container.releasePointerCapture(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerCancel=g=>{if(i.has(g.pointerId))switch(i.delete(g.pointerId),g.pointerType){case"pen":case"touch":t.handleTouchEnd(g);break;case"mouse":default:t.handleMouseUp(g);break}},t.handlePointerMove=g=>{if(i.has(g.pointerId)){const y=i.get(g.pointerId);y.position=c(g)}switch(g.pointerType){case"pen":case"touch":t.handleTouchMove(g);break;case"mouse":default:t.handleMouseMove(g);break}},t.handleMouseDown=g=>{const y={...l(g),position:c(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonPressEvent(y);break;case 1:t.middleButtonPressEvent(y);break;case 2:t.rightButtonPressEvent(y);break;default:v0(`Unknown mouse button pressed: ${g.button}`);break}},t.requestPointerLock=()=>{e.container&&e.container.requestPointerLock()},t.exitPointerLock=()=>document.exitPointerLock?.(),t.isPointerLocked=()=>!!e.container&&document.pointerLockElement===e.container,t.handlePointerLockChange=()=>{t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function d(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=g=>{if(g===void 0){v0("undefined requester, can not start animating");return}if(r.has(g)){m0("requester is already registered for animating");return}r.add(g),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=g=>{const y=Date.now()+g;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,y),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=()=>e.xrAnimation||e.animationRequest!==null,t.cancelAnimation=function(g){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(g)){if(!y){const x=g&&g.getClassName?g.getClassName():g;m0(`${x} did not request an animation`)}return}r.delete(g),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=()=>{e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=()=>{e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=(g,y,x)=>{g.inputSources.forEach(m=>{const v=m.gripSpace==null?null:y.getPose(m.gripSpace,x),w=m.gripSpace==null?null:y.getPose(m.targetRaySpace,x),C=m.gamepad,T=m.handedness;if(C){C.index in e.lastGamepadValues||(e.lastGamepadValues[C.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let _=0;_<C.buttons.length;++_)_ in e.lastGamepadValues[C.index][T].buttons||(e.lastGamepadValues[C.index][T].buttons[_]=!1),e.lastGamepadValues[C.index][T].buttons[_]!==C.buttons[_].pressed&&v!=null&&(t.button3DEvent({gamepad:C,position:v.transform.position,orientation:v.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,pressed:C.buttons[_].pressed,device:m.handedness==="left"?g0.LeftController:g0.RightController,input:Lp[C.mapping]&&Lp[C.mapping][_]?Lp[C.mapping][_]:Ws.Trigger}),e.lastGamepadValues[C.index][T].buttons[_]=C.buttons[_].pressed),e.lastGamepadValues[C.index][T].buttons[_]&&v!=null&&t.move3DEvent({gamepad:C,position:v.transform.position,orientation:v.transform.orientation,targetPosition:w.transform.position,targetOrientation:w.transform.orientation,device:m.handedness==="left"?g0.LeftController:g0.RightController})}})},t.handleMouseMove=g=>{const y={...l(g),position:c(g),deviceType:u(g)};e.moveTimeoutID===0?t.startMouseMoveEvent(y):(t.mouseMoveEvent(y),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(()=>{t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=()=>{const g=Date.now();e._animationFrameCount++,g-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(g-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=g,e._animationFrameCount=1),t.animationEvent(),d(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=g=>{xu(g);const y={...ZI(g),...l(g),position:c(g),deviceType:u(g)};e.wheelTimeoutID===0&&(Math.abs(y.spinY)>=.3?a=Math.abs(y.spinY):a=1),y.spinY/=a,e.wheelTimeoutID===0?(t.startMouseWheelEvent(y),t.mouseWheelEvent(y)):(t.mouseWheelEvent(y),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(()=>{t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=g=>{const y={...l(g),position:c(g),deviceType:u(g)};switch(g.button){case 0:t.leftButtonReleaseEvent(y);break;case 1:t.middleButtonReleaseEvent(y);break;case 2:t.rightButtonReleaseEvent(y);break;default:v0(`Unknown mouse button released: ${g.button}`);break}},t.handleTouchStart=g=>{const y=[...i.values()];if(e.recognizeGestures&&y.length>1){const x=y0(i);if(y.length===2){const m={...l(xc),position:y[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(m)}t.recognizeGesture("TouchStart",x)}else if(y.length===1){const x={...l(xc),position:c(g),deviceType:u(g)};t.leftButtonPressEvent(x)}},t.handleTouchMove=g=>{const y=[...i.values()];if(e.recognizeGestures&&y.length>1){const x=y0(i);t.recognizeGesture("TouchMove",x)}else if(y.length===1){const x={...l(xc),position:y[0].position,deviceType:u(g)};t.mouseMoveEvent(x)}},t.handleTouchEnd=g=>{const y=[...i.values()];if(e.recognizeGestures)if(y.length===0){const x={...l(xc),position:c(g),deviceType:u(g)};t.leftButtonReleaseEvent(x)}else if(y.length===1){const x=y0(i);t.recognizeGesture("TouchEnd",x);const m={...l(xc),position:y[0].position,deviceType:u(g)};t.leftButtonPressEvent(m)}else{const x=y0(i);t.recognizeGesture("TouchMove",x)}else if(y.length===1){const x={...l(xc),position:y[0].position,deviceType:u(g)};t.leftButtonReleaseEvent(x)}},t.setView=g=>{e._view!==g&&(e._view=g,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=()=>e._view?.getRenderable()?.getRenderersByReference()?.[0],t.findPokedRenderer=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;const x=e._view?.getRenderable()?.getRenderers();if(!x||x.length===0)return null;x.sort((T,_)=>T.getLayer()-_.getLayer());let m=null,v=null,w=null,C=x.length;for(;C--;){const T=x[C];if(e._view.isInViewport(g,y,T)&&T.getInteractive()){w=T;break}m===null&&T.getInteractive()&&(m=T),v===null&&e._view.isInViewport(g,y,T)&&(v=T)}return w===null&&(w=m),w===null&&(w=v),w==null&&(w=x[0]),w},t.render=()=>{!t.isAnimating()&&!e.inRender&&d()},B1.forEach(g=>{const y=g.charAt(0).toLowerCase()+g.slice(1);t[`${y}Event`]=x=>{if(!e.enabled)return;if(!t.getCurrentRenderer()){QI(`
          Can not forward events without a current renderer on the interactor.
        `);return}const v={type:g,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer(),...x};t[`invoke${g}`](v)}}),t.recognizeGesture=(g,y)=>{if(Object.keys(y).length>2)return;if(e.startingEventPositions||(e.startingEventPositions={}),g==="TouchStart"){Object.keys(y).forEach(D=>{e.startingEventPositions[D]=y[D]}),e.currentGesture="Start";return}if(g==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}let x=0;const m=[],v=[];Object.keys(y).forEach(D=>{m[x]=y[D],v[x]=e.startingEventPositions[D],x++});const w=Math.sqrt((v[0].x-v[1].x)*(v[0].x-v[1].x)+(v[0].y-v[1].y)*(v[0].y-v[1].y)),C=Math.sqrt((m[0].x-m[1].x)*(m[0].x-m[1].x)+(m[0].y-m[1].y)*(m[0].y-m[1].y));let T=Tf(Math.atan2(v[1].y-v[0].y,v[1].x-v[0].x)),_=Tf(Math.atan2(m[1].y-m[0].y,m[1].x-m[0].x)),S=_-T;_=_+180>=360?_-180:_+180,T=T+180>=360?T-180:T+180,Math.abs(_-T)<Math.abs(S)&&(S=_-T);const b=[];if(b[0]=(m[0].x-v[0].x+m[1].x-v[1].x)/2,b[1]=(m[0].y-v[0].y+m[1].y-v[1].y)/2,g==="TouchMove")if(e.currentGesture==="Start"){let D=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);D<15&&(D=15);const E=Math.abs(C-w),R=C*3.1415926*Math.abs(S)/360,F=Math.sqrt(b[0]*b[0]+b[1]*b[1]);if(E>D&&E>R&&E>F){e.currentGesture="Pinch";const M={scale:1,touches:y};t.startPinchEvent(M)}else if(R>D&&R>F){e.currentGesture="Rotate";const M={rotation:0,touches:y};t.startRotateEvent(M)}else if(F>D){e.currentGesture="Pan";const M={translation:[0,0],touches:y};t.startPanEvent(M)}}else{if(e.currentGesture==="Rotate"){const D={rotation:S,touches:y};t.rotateEvent(D)}if(e.currentGesture==="Pinch"){const D={scale:C/w,touches:y};t.pinchEvent(D)}if(e.currentGesture==="Pan"){const D={translation:b,touches:y};t.panEvent(D)}}},t.handleVisibilityChange=()=>{e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=g=>{e._forcedRenderer=!!g,e.currentRenderer=g},t.setContainer=g=>{p();const y=n.setContainer(g??null);return y&&h(),y},t.delete=()=>{for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.setContainer(null),n.delete()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}const tP={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function O6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tP,n),J.obj(t,e),e._animationExtendedEnd=0,J.event(t,e,"RenderEvent"),B1.forEach(r=>J.event(t,e,r)),J.get(t,e,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),J.setGet(t,e,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),J.moveToProtected(t,e,["view"]),eP(t,e)}const nP=J.newInstance(O6,"vtkRenderWindowInteractor");var rP={newInstance:nP,extend:O6,handledEvents:B1,...D6};const{vtkDebugMacro:iP}=J;function aP(t,e){e.classHierarchy.push("vtkActor");const n={...t};t.getActors=()=>[t],t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let r=e.property.getOpacity()>=1;return r=r&&(!e.texture||!e.texture.isTranslucent()),r=r&&(!e.mapper||e.mapper.getIsOpaque()),r},t.hasTranslucentPolygonalGeometry=()=>e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque()),t.makeProperty=pc.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const r=e.mapper.getBounds();if(!r||r.length!==6)return r;if(r[0]>r[1])return e.mapperBounds=r.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),r;if(!e.mapperBounds||r[0]!==e.mapperBounds[0]||r[1]!==e.mapperBounds[1]||r[2]!==e.mapperBounds[2]||r[3]!==e.mapperBounds[3]||r[4]!==e.mapperBounds[4]||r[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){iP("Recomputing bounds..."),e.mapperBounds=r.concat();const i=[];Kt.getCorners(r,i),t.computeMatrix();const a=new Float64Array(16);Rt(a,e.matrix),i.forEach(o=>Dt(o,o,a)),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map((o,s)=>s%2===0?i.reduce((c,l)=>c>l[s/2]?l[s/2]:c,o):i.reduce((c,l)=>c<l[(s-1)/2]?l[(s-1)/2]:c,o)),e.boundsMTime.modified()}return e.bounds},t.getMTime=()=>{let r=n.getMTime();if(e.property!==null){const i=e.property.getMTime();r=i>r?i:r}if(e.backfaceProperty!==null){const i=e.backfaceProperty.getMTime();r=i>r?i:r}return r},t.getRedrawMTime=()=>{let r=e.mtime;if(e.mapper!==null){let i=e.mapper.getMTime();r=i>r?i:r,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),i=e.mapper.getInput().getMTime(),r=i>r?i:r)}return r},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1,t.processSelectorPixelBuffers=(r,i)=>{e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(r,i)}}const oP={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function R6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oP,n),S1.extend(t,e,n),e.boundsMTime={},J.obj(e.boundsMTime),J.set(t,e,["property"]),J.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),aP(t,e)}const sP=J.newInstance(R6,"vtkActor");var cc={newInstance:sP,extend:R6};function cP(t,e){const n=t.invokeResize;delete t.invokeResize,e.renderWindow=hA.newInstance(),e.rendererMap={},e.openGLRenderWindow=MI.newInstance(),e.renderWindow.addView(e.openGLRenderWindow),e.interactor=rP.newInstance(),e.interactor.setView(e.openGLRenderWindow),e.interactor.initialize(),t.addRenderer=({viewport:r,id:i,background:a})=>{const o=qI.newInstance({viewport:r,background:a||e.background});e.renderWindow.addRenderer(o),e.rendererMap[i]=o},t.destroy=()=>{e.renderWindow.getInteractor().delete()},t.removeRenderer=r=>{const i=t.getRenderer(r);e.renderWindow.removeRenderer(i),i.delete(),delete e.rendererMap[r]},t.getRenderer=r=>e.rendererMap[r],t.getRenderers=()=>{const{rendererMap:r}=e;return Object.keys(r).map(a=>({id:a,renderer:r[a]}))},t.resize=()=>{if(e.container){const{width:r,height:i}=e.container;e.openGLRenderWindow.setSize(Math.floor(r),Math.floor(i)),n(),e.renderWindow.render()}},t.setContainer=r=>{e.container=r,e.openGLRenderWindow.setContainer(e.container)},t.delete=J.chain(t.setContainer,t.destroy,e.openGLRenderWindow.delete,t.delete),t.resize()}const uP={background:[0,0,0],container:null};function M6(t,e,n={}){Object.assign(e,uP,n),J.obj(t,e),J.get(t,e,["renderWindow","openGLRenderWindow","interactor","container"]),J.event(t,e,"resize"),cP(t,e)}const lP=J.newInstance(M6),N6={newInstance:lP,extend:M6},{BlendMode:Po,FilterMode:Lu}=Y5;function fP(t,e,n,r,i){let a=null;return i?(a=i,a.removeAllPoints()):a=$c.newInstance(),a.addPointLong(-1024,0,1,1),a.addPoint(t,e),a.addPoint(n,r),a}const hP={createRadonTransferFunction:fP};function pP(t,e){e.classHierarchy.push("vtkVolumeMapper");const n={...t};t.getBounds=()=>{const r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=ns(),e.bounds},t.update=()=>{t.getInputData()},t.setBlendModeToComposite=()=>{t.setBlendMode(Po.COMPOSITE_BLEND)},t.setBlendModeToMaximumIntensity=()=>{t.setBlendMode(Po.MAXIMUM_INTENSITY_BLEND)},t.setBlendModeToMinimumIntensity=()=>{t.setBlendMode(Po.MINIMUM_INTENSITY_BLEND)},t.setBlendModeToAverageIntensity=()=>{t.setBlendMode(Po.AVERAGE_INTENSITY_BLEND)},t.setBlendModeToAdditiveIntensity=()=>{t.setBlendMode(Po.ADDITIVE_INTENSITY_BLEND)},t.setBlendModeToRadonTransform=()=>{t.setBlendMode(Po.RADON_TRANSFORM_BLEND)},t.getBlendModeAsString=()=>J.enumToString(Po,e.blendMode),t.setAverageIPScalarRange=(r,i)=>{console.warn("setAverageIPScalarRange is deprecated use setIpScalarRange"),t.setIpScalarRange(r,i)},t.getFilterModeAsString=()=>J.enumToString(Lu,e.filterMode),t.setFilterModeToOff=()=>{t.setFilterMode(Lu.OFF)},t.setFilterModeToNormalized=()=>{t.setFilterMode(Lu.NORMALIZED)},t.setFilterModeToRaw=()=>{t.setFilterMode(Lu.RAW)},t.setGlobalIlluminationReach=r=>n.setGlobalIlluminationReach(Gi(r,0,1)),t.setVolumetricScatteringBlending=r=>n.setVolumetricScatteringBlending(Gi(r,0,1)),t.setVolumeShadowSamplingDistFactor=r=>n.setVolumeShadowSamplingDistFactor(r>=1?r:1),t.setAnisotropy=r=>n.setAnisotropy(Gi(r,-.99,.99)),t.setLAOKernelSize=r=>n.setLAOKernelSize(qg(Gi(r,1,32))),t.setLAOKernelRadius=r=>n.setLAOKernelRadius(r>=1?r:1)}const dP=t=>({bounds:[1,-1,1,-1,1,-1],sampleDistance:1,imageSampleDistance:1,maximumSamplesPerRay:1e3,autoAdjustSampleDistances:!0,initialInteractionScale:1,interactionSampleDistanceFactor:1,blendMode:Po.COMPOSITE_BLEND,ipScalarRange:[-1e6,1e6],filterMode:Lu.OFF,preferSizeOverAccuracy:!1,computeNormalFromOpacity:!1,volumetricScatteringBlending:0,globalIlluminationReach:0,volumeShadowSamplingDistFactor:5,anisotropy:0,localAmbientOcclusion:!1,LAOKernelSize:15,LAOKernelRadius:7,updatedExtents:[],...t});function L6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dP(n)),P1.extend(t,e,n),J.setGet(t,e,["sampleDistance","imageSampleDistance","maximumSamplesPerRay","autoAdjustSampleDistances","initialInteractionScale","interactionSampleDistanceFactor","blendMode","filterMode","preferSizeOverAccuracy","computeNormalFromOpacity","volumetricScatteringBlending","globalIlluminationReach","volumeShadowSamplingDistFactor","anisotropy","localAmbientOcclusion","LAOKernelSize","LAOKernelRadius","updatedExtents"]),J.setGetArray(t,e,["ipScalarRange"],2),J.event(t,e,"lightingActivated"),pP(t,e)}const gP=J.newInstance(L6,"vtkVolumeMapper");var A6={newInstance:gP,extend:L6,...hP};function mP(t,e){e.classHierarchy.push("vtkSharedVolumeMapper");const n=t.delete;t.delete=()=>{e.scalarTexture=null,n()}}const vP={scalarTexture:null};function F6(t,e,n={}){Object.assign(e,vP,n),A6.extend(t,e,n),J.setGet(t,e,["scalarTexture"]),mP(t,e)}const yP=J.newInstance(F6,"vtkSharedVolumeMapper"),xP={newInstance:yP,extend:F6};function Pv(t,e){const n=V1(e),r=new n(t.length);return r.set(t),r}function wP(t,e){e.classHierarchy.push("vtkStreamingOpenGLTexture"),e.updatedFrames=[],e.volumeId=null;const n=t.create3DFilterableFromRaw;t.create3DFilterableFromRaw=(s,c,l,f,u,h,p)=>{e.inputDataType=u,e.inputNumComps=f,n(s,c,l,f,u,h,p)};const r=t.updateVolumeInfoForGL;t.updateVolumeInfoForGL=(s,c)=>{const l=r(s,c);return e.volumeInfo.dataComputedScale=[1],e.volumeInfo.dataComputedOffset=[0],l},t.update3DFromRaw=()=>{const{volumeId:s}=e;if(!s)return;const c=at.getVolume(s);if(e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),c.isDynamicVolume()){o();return}return t.hasUpdatedFrames()&&a()};const i=t.modified;t.setUpdatedFrame=s=>{e.updatedFrames[s]=!0,i()},t.modified=()=>{i();const s=at.getVolume(e.volumeId);if(!s)return;const c=s.imageIds;for(let l=0;l<c.length;l++)e.updatedFrames[l]=!0};function a(){const s=at.getVolume(e.volumeId),c=s.imageIds;for(let l=0;l<e.updatedFrames.length;l++)if(e.updatedFrames[l]){const f=at.getImage(c[l]);if(!f)continue;let u=f.voxelManager.getScalarData();const h=e.context;s.dataType!==u.constructor.name&&(u=Pv(u,s.dataType));const[p]=t.updateArrayDataTypeForGL(s.dataType,[u]);t.bind();const d=l;h.texSubImage3D(e.target,0,0,0,d,e.width,e.height,1,e.format,e.openGLDataType,p),t.deactivate(),e.updatedFrames[l]=null}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}function o(){const s=at.getVolume(e.volumeId),c=s.getCurrentDimensionGroupImageIds();if(!c.length)return!1;let l;for(let f=0;f<c.length;f++){const u=c[f],h=at.getImage(u);let p;h?(p=h.voxelManager.getScalarData(),l=p.constructor):(l=V1(s.dataType,!0),p=new l(e.width*e.height));const d=e.context;s.dataType!==p.constructor.name&&(p=Pv(p,s.dataType));const[g]=t.updateArrayDataTypeForGL(s.dataType,[p]);t.bind();let y=f;d.texSubImage3D(e.target,0,0,0,y,e.width,e.height,1,e.format,e.openGLDataType,g),t.deactivate()}return e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0}t.hasUpdatedFrames=()=>!e.updatedFrames.length||e.updatedFrames.some(s=>s),t.getUpdatedFrames=()=>e.updatedFrames,t.setVolumeId=s=>{e.volumeId=s},t.getVolumeId=()=>e.volumeId,t.setTextureParameters=({width:s,height:c,depth:l,numberOfComponents:f,dataType:u})=>{e.width??=s,e.height??=c,e.depth??=l,e.inputNumComps??=f,e.inputDataType??=u},t.getTextureParameters=()=>({width:e.width,height:e.height,depth:e.depth,numberOfComponents:e.inputNumComps,dataType:e.inputDataType})}const CP={updatedFrames:[]};function I6(t,e,n={}){Object.assign(e,CP,n),fn.extend(t,e,n),wP(t,e)}const TP=J.newInstance(I6,"vtkStreamingOpenGLTexture"),_P={newInstance:TP,extend:I6},SP={isPerformingCoordinateTransformation:!1};function P6(t,e,n={}){Object.assign(e,SP,n),U1.extend(t,e,n),J.setGet(t,e,["isPerformingCoordinateTransformation"]),EP(t,e)}const bP=J.newInstance(P6,"vtkSlabCamera");function EP(t,e){e.classHierarchy.push("vtkSlabCamera");const n=ut(new Float64Array(16)),r=new Float64Array(3);t.getProjectionMatrix=(i,a,o)=>{const s=ma();if(e.projectionMatrix){const h=1/e.physicalScale;return $t(r,h,h,h),pn(s,e.projectionMatrix),va(s,s,r),Rt(s,s),s}ut(n);let c=e.clippingRange[0],l=e.clippingRange[1];e.isPerformingCoordinateTransformation&&(c=e.distance,l=e.distance+.1);const f=l-c,u=[c+(a+1)*f/2,c+(o+1)*f/2];if(e.parallelProjection){const h=e.parallelScale*i,p=e.parallelScale,d=(e.windowCenter[0]-1)*h,g=(e.windowCenter[0]+1)*h,y=(e.windowCenter[1]-1)*p,x=(e.windowCenter[1]+1)*p;s1(n,d,g,y,x,u[0],u[1]),Rt(n,n)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const h=Math.tan(mi.radiansFromDegrees(e.viewAngle)/2);let p,d;e.useHorizontalViewAngle===!0?(p=c*h,d=c*h/i):(p=c*h*i,d=c*h);const g=(e.windowCenter[0]-1)*p,y=(e.windowCenter[0]+1)*p,x=(e.windowCenter[1]-1)*d,m=(e.windowCenter[1]+1)*d,v=u[0],w=u[1];n[0]=2*v/(y-g),n[5]=2*v/(m-x),n[2]=(g+y)/(y-g),n[6]=(x+m)/(m-x),n[10]=-(v+w)/(w-v),n[14]=-1,n[11]=-2*v*w/(w-v),n[15]=0}}return pn(s,n),s}}const DP={newInstance:bP,extend:P6};class iu{constructor(e){this._imageIdsIndexMap=new Map,this._imageURIsIndexMap=new Map,this.cornerstoneImageMetaData=null,this.isPreScaled=!1,this.numTimePoints=null,this.numFrames=null;const{imageIds:n,scaling:r,dimensions:i,spacing:a,origin:o,direction:s,dataType:c,volumeId:l,referencedVolumeId:f,metadata:u,referencedImageIds:h,additionalDetails:p,voxelManager:d,numberOfComponents:g}=e;if(!c)throw new Error('Data type is required, please provide a data type as string such as "Uint8Array", "Float32Array", etc.');let{imageData:y}=e;this.suppressWarnings=!0,this.imageIds=n,this.volumeId=l,this.metadata=u,this.dimensions=i,this.spacing=a,this.origin=o,this.direction=s,this.dataType=c,this.vtkOpenGLTexture=_P.newInstance(),this.vtkOpenGLTexture.setVolumeId(l),this.voxelManager=d??rn.createImageVolumeVoxelManager({dimensions:i,imageIds:n,numberOfComponents:g}),this.numVoxels=this.dimensions[0]*this.dimensions[1]*this.dimensions[2],y||(y=L1.newInstance(),y.setDimensions(i),y.setSpacing(a),y.setDirection(s),y.setOrigin(o)),y.set({dataType:c,voxelManager:this.voxelManager,id:l,numberOfComponents:g||1},this.suppressWarnings),y.set({hasScalarVolume:!1},this.suppressWarnings),this.imageData=y,this.numFrames=this._getNumFrames(),this._reprocessImageIds(),r&&(this.scaling=r),f&&(this.referencedVolumeId=f),h&&(this.referencedImageIds=h),p&&(this.additionalDetails=p)}get sizeInBytes(){return this.voxelManager.sizeInBytes}get imageIds(){return this._imageIds}set imageIds(e){this._imageIds=e,this._reprocessImageIds()}_reprocessImageIds(){this._imageIdsIndexMap.clear(),this._imageURIsIndexMap.clear(),this._imageIds.forEach((e,n)=>{const r=yi(e);this._imageIdsIndexMap.set(e,n),this._imageURIsIndexMap.set(r,n)})}isDynamicVolume(){return this.numTimePoints>1}getImageIdIndex(e){return this._imageIdsIndexMap.get(e)}getImageIdByIndex(e){return this._imageIds[e]}getImageURIIndex(e){return this._imageURIsIndexMap.get(e)}load(e){}destroy(){this.imageData.delete(),this.imageData=null,this.voxelManager.clear(),this.vtkOpenGLTexture.releaseGraphicsResources(),this.vtkOpenGLTexture.delete()}invalidate(){for(let e=0;e<this.imageIds.length;e++)this.vtkOpenGLTexture.setUpdatedFrame(e);this.imageData.modified()}modified(){this.imageData.modified(),this.vtkOpenGLTexture.modified(),this.numFrames=this._getNumFrames()}removeFromCache(){at.removeVolumeLoadObject(this.volumeId)}getScalarDataLength(){return this.voxelManager.getScalarDataLength()}_getNumFrames(){return this.isDynamicVolume()?this.numTimePoints:this.imageIds.length}imageIdIndexToFrameIndex(e){return e%this.numFrames}getCornerstoneImages(){const{imageIds:e}=this;return e.map(n=>at.getImage(n))}}const fa=[];function Fh(t,e=0){let n;for(n=0;n<fa.length&&!(fa[n].priority<=e);n++);fa.splice(n,0,{priority:e,provider:t})}function OP(t){for(let e=0;e<fa.length;e++)if(fa[e].provider===t){fa.splice(e,1);break}}function RP(){for(;fa.length>0;)fa.pop()}function nt(t,...e){for(let n=0;n<fa.length;n++){const r=fa[n].provider(t,...e);if(r!==void 0)return r}}const V6=Object.freeze(Object.defineProperty({__proto__:null,addProvider:Fh,get:nt,removeAllProviders:RP,removeProvider:OP},Symbol.toStringTag,{value:"Module"}));let wu={};const qo={add:(t,e)=>{qo.addRaw(t,{...e,metadata:structuredClone(e.metadata)})},addRaw:(t,e)=>{const n=e.type;wu[t]||(wu[t]={}),wu[t][n]=e.metadata},get:(t,e)=>wu[e]?.[t],clear:()=>{wu={}}};Fh(qo.get);const Pr=new Ig("imageLoadPool");Pr.grabDelay=0;Pr.setMaxSimultaneousRequests(St.Interaction,1e3);Pr.setMaxSimultaneousRequests(St.Thumbnail,1e3);Pr.setMaxSimultaneousRequests(St.Prefetch,1e3);const Gf={};let Wf;function k6(t,e){const n=at.getImageLoadObject(t);if(n)return Vv(n.promise,t),n;const r=t.split(":")[0],i=Gf[r]||Wf;if(!i)throw new Error(`loadImageFromImageLoader: No image loader found for scheme '${r}'`);const a=i(t,e);return Vv(a.promise,t),a}function Vv(t,e){Promise.resolve(t).then(n=>{MP(n),et(vt,Je.IMAGE_LOADED,{image:n})}).catch(n=>{const r={imageId:e,error:n};et(vt,Je.IMAGE_LOAD_FAILED,r)})}function MP(t){if(!t.voxelManager){const{width:e,height:n,numberOfComponents:r}=t,i=rn.createImageVoxelManager({scalarData:t.getPixelData(),width:e,height:n,numberOfComponents:r});t.voxelManager=i,t.getPixelData=()=>i.getScalarData(),delete t.imageFrame.pixelData}}function U6(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadImage: parameter imageId must not be undefined");return k6(t,e).promise}function ro(t,e={priority:0,requestType:"prefetch"}){if(t===void 0)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");const n=k6(t,e);return at.getImageLoadObject(t)||at.putImageLoadObject(t,n),n.promise}function NP(t,e={priority:0,requestType:"prefetch"}){if(!t||t.length===0)throw new Error("loadAndCacheImages: parameter imageIds must be list of image Ids");return t.map(r=>ro(r,e))}function G1(t,e={}){if(t===void 0)throw new Error("createAndCacheDerivedImage: parameter imageId must not be undefined");e.imageId===void 0&&(e.imageId=`derived:${si()}`);const{imageId:n,skipCreateBuffer:r,onCacheAdd:i,voxelRepresentation:a}=e,o=nt("imagePlaneModule",t),s=o.rows*o.columns,{TypedArrayConstructor:c}=k1(e.targetBuffer?.type,s),l=new c(r?1:s),f=n,u=nt("imagePlaneModule",t);qo.add(f,{type:"imagePlaneModule",metadata:u});const h=nt("generalSeriesModule",t);qo.add(f,{type:"generalSeriesModule",metadata:h}),qo.add(f,{type:"generalImageModule",metadata:{instanceNumber:e.instanceNumber}});const p=nt("imagePixelModule",t);qo.add(f,{type:"imagePixelModule",metadata:{...p,bitsAllocated:8,bitsStored:8,highBit:7,samplesPerPixel:1,pixelRepresentation:0}});const d=z1(n,{scalarData:l,onCacheAdd:i,skipCreateBuffer:r,targetBuffer:{type:l.constructor.name},voxelRepresentation:a,dimensions:[o.columns,o.rows],spacing:[o.columnPixelSpacing,o.rowPixelSpacing],origin:o.imagePositionPatient,direction:o.imageOrientationPatient,frameOfReferenceUID:o.frameOfReferenceUID,referencedImageId:t});return d.referencedImageId=t,at.getImageLoadObject(n)||at.putImageSync(n,d),d}function W1(t,e={}){if(t.length===0)throw new Error("createAndCacheDerivedImages: parameter imageIds must be list of image Ids");return t.map((r,i)=>{const a={imageId:e?.getDerivedImageId?.(r)||`derived:${si()}`,...e};return G1(r,{...a,instanceNumber:i+1})})}function z1(t,e){const{scalarData:n,origin:r,direction:i,targetBuffer:a,skipCreateBuffer:o,onCacheAdd:s,frameOfReferenceUID:c,voxelRepresentation:l,referencedImageId:f}=e,u=e.dimensions,h=e.spacing;if(!u||!h)throw new Error("createAndCacheLocalImage: dimensions and spacing are required");const p=u[0],d=u[1],g=h[0],y=h[1],x={frameOfReferenceUID:c,rows:d,columns:p,imageOrientationPatient:i??[1,0,0,0,1,0],rowCosines:i?i.slice(0,3):[1,0,0],columnCosines:i?i.slice(3,6):[0,1,0],imagePositionPatient:r??[0,0,0],pixelSpacing:[y,g],rowPixelSpacing:y,columnPixelSpacing:g},m=p*d,v=n.length/m;let w;if(n){if(!(n instanceof Uint8Array||n instanceof Float32Array||n instanceof Uint16Array||n instanceof Int16Array))throw new Error("createAndCacheLocalImage: scalarData must be of type Uint8Array, Uint16Array, Int16Array or Float32Array");w=n}else if(!o){const{TypedArrayConstructor:U}=k1(a?.type,m);w=new U(m)}let C,T,_;if(w instanceof Uint8Array)C=8,T=8,_=7;else if(w instanceof Uint16Array)C=16,T=16,_=15;else if(w instanceof Int16Array)C=16,T=16,_=15;else if(w instanceof Float32Array)C=32,T=32,_=31;else throw new Error("Unsupported scalarData type");const S={samplesPerPixel:1,photometricInterpretation:w.length>u[0]*u[1]?"RGB":"MONOCHROME2",rows:d,columns:p,bitsAllocated:C,bitsStored:T,highBit:_},b={imagePlaneModule:x,imagePixelModule:S};["imagePlaneModule","imagePixelModule"].forEach(U=>{qo.add(t,{type:U,metadata:b[U]||{}})});const D=t,E=l===gf.RLE&&rn.createRLEImageVoxelManager({dimensions:u,id:D})||rn.createImageVoxelManager({height:d,width:p,numberOfComponents:v,scalarData:w,id:D});let R=w[0],F=w[0];for(let U=1;U<w.length;U++)w[U]<R&&(R=w[U]),w[U]>F&&(F=w[U]);const M={imageId:t,intercept:0,windowCenter:0,windowWidth:0,color:S.photometricInterpretation==="RGB",numberOfComponents:S.samplesPerPixel,dataType:a?.type,slope:1,minPixelValue:R,maxPixelValue:F,rows:S.rows,columns:S.columns,getCanvas:void 0,height:S.rows,width:S.columns,rgba:void 0,columnPixelSpacing:x.columnPixelSpacing,rowPixelSpacing:x.rowPixelSpacing,FrameOfReferenceUID:x.frameOfReferenceUID,invert:!1,getPixelData:()=>E.getScalarData(),voxelManager:E,sizeInBytes:n.byteLength,referencedImageId:f};return s?.(M),at.putImageSync(M.imageId,M),M}function B6(t){const e=({additionalDetails:r})=>r.imageId?r.imageId!==t:!0;Pr.filterRequests(e);const n=at.getImageLoadObject(t);n&&n.cancelFn()}function LP(t){t.forEach(e=>{B6(e)})}function AP(){const t=Pr.getRequestPool();Object.keys(t).forEach(e=>{const n=t[e];Object.keys(n).forEach(r=>{const i=n[r].pop();if(!i)return;const a=i.additionalDetails,{imageId:o,volumeId:s}=a;let c;o?c=at.getImageLoadObject(o):s&&(c=at.getVolumeLoadObject(s)),c&&c.cancel()}),Pr.clearRequestStack(e)})}function j1(t,e){Gf[t]=e}function FP(t){const e=Wf;return Wf=t,e}function IP(){Object.keys(Gf).forEach(t=>delete Gf[t]),Wf=void 0}function PP(t,e={}){return W1(t,{...e,targetBuffer:{type:"Uint8Array"}})}function VP(t,e={}){return G1(t,{...e,targetBuffer:{type:"Uint8Array"}})}const kP=Object.freeze(Object.defineProperty({__proto__:null,cancelLoadAll:AP,cancelLoadImage:B6,cancelLoadImages:LP,createAndCacheDerivedImage:G1,createAndCacheDerivedImages:W1,createAndCacheDerivedLabelmapImage:VP,createAndCacheDerivedLabelmapImages:PP,createAndCacheLocalImage:z1,loadAndCacheImage:ro,loadAndCacheImages:NP,loadImage:U6,registerImageLoader:j1,registerUnknownImageLoader:FP,unregisterAllImageLoaders:IP},Symbol.toStringTag,{value:"Module"}));function G6(t){const e=t[0],{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=nt("imagePixelModule",e),c=[],l=nt("voiLutModule",e);let f;if(l){const{windowWidth:m,windowCenter:v}=l;if(f=l?.voiLUTFunction,Array.isArray(m))for(let w=0;w<m.length;w++)c.push({windowWidth:m[w],windowCenter:v[w]});else c.push({windowWidth:m,windowCenter:v})}else c.push({windowWidth:void 0,windowCenter:void 0});const{modality:u,seriesInstanceUID:h}=nt("generalSeriesModule",e),{imageOrientationPatient:p,pixelSpacing:d,frameOfReferenceUID:g,columns:y,rows:x}=nt("imagePlaneModule",e);return{BitsAllocated:r,BitsStored:i,SamplesPerPixel:s,HighBit:a,PhotometricInterpretation:o,PixelRepresentation:n,Modality:u,ImageOrientationPatient:p,PixelSpacing:d,FrameOfReferenceUID:g,Columns:y,Rows:x,voiLut:c,VOILUTFunction:f,SeriesInstanceUID:h}}function W6(t){const{imagePositionPatient:e,imageOrientationPatient:n}=nt("imagePlaneModule",t[0]),r=Qt(n[0],n[1],n[2]),i=Qt(n[3],n[4],n[5]),a=it();mn(a,r,i);const o=Qt(e[0],e[1],e[2]),s=t[0].split(":")[0]==="wadouri";let c;function l(p){const{imagePositionPatient:d}=nt("imagePlaneModule",p),g=it(),y=Qt(d[0],d[1],d[2]);return Bn(g,o,y),zt(g,a)}if(s){const p=[t[0],t[Math.floor(t.length/2)]];l(p[0]),l(p[1]);const d=nt("imagePlaneModule",p[1]);if(!d)throw new Error("Incomplete metadata required for volume construction.");const g=it(),y=Qt(d.imagePositionPatient[0],d.imagePositionPatient[1],d.imagePositionPatient[2]);Bn(g,o,y);const x=zt(g,a);c=Math.abs(x)/Math.floor(t.length/2)}else{const p=t.map(g=>({distance:l(g),imageId:g}));p.sort((g,y)=>y.distance-g.distance);const d=p.length;c=Math.abs(p[d-1].distance-p[0].distance)/(d-1)}const{sliceThickness:f,spacingBetweenSlices:u}=nt("imagePlaneModule",t[0]),{strictZSpacingForVolumeViewport:h}=hc().rendering;return(c===0||isNaN(c))&&!h&&(u?(console.debug("Could not calculate spacing. Using spacingBetweenSlices"),c=u):f?(console.debug("Could not calculate spacing and no spacingBetweenSlices. Using sliceThickness"),c=f):(console.debug("Could not calculate spacing. The VolumeViewport visualization is compromised. Setting spacing to 1 to render"),c=1)),c}function $1(t,e){const{imagePositionPatient:n,imageOrientationPatient:r}=nt("imagePlaneModule",t[0]);if(!e){const f=Qt(r[0],r[1],r[2]),u=Qt(r[3],r[4],r[5]);e=it(),mn(e,f,u)}const i=t[0].split(":")[0]==="wadouri",a=W6(t);let o;function s(f){const{imagePositionPatient:u}=nt("imagePlaneModule",f),h=it();return Bn(h,n,u),zt(h,e)}if(i){const f=[t[0],t[Math.floor(t.length/2)]];o=t;const u=s(f[0]),h=s(f[1]);u-h<0&&o.reverse()}else{const f=t.map(u=>({distance:s(u),imageId:u}));f.sort((u,h)=>h.distance-u.distance),o=f.map(u=>u.imageId)}const{imagePositionPatient:c}=nt("imagePlaneModule",o[0]);return{zSpacing:a,origin:c,sortedImageIds:o}}function z6(t){const e=nt("modalityLutModule",t)||{},n=nt("generalSeriesModule",t)||{},{modality:r}=n,i={rescaleSlope:e.rescaleSlope||1,rescaleIntercept:e.rescaleIntercept??0,modality:r},a=nt("scalingModule",t)||{};return{...i,...r==="PT"&&{suvbw:a.suvbw,suvbsa:a.suvbsa,suvlbm:a.suvlbm},...r==="RTDOSE"&&{doseGridScaling:a.DoseGridScaling,doseSummation:a.DoseSummation,doseType:a.DoseType,doseUnit:a.DoseUnit}}}const H1=t=>Object.values(t).some(n=>typeof n=="number"&&!Number.isInteger(n)),kv={Uint8Array:"Uint8Array",Int16Array:"Int16Array",Uint16Array:"Uint16Array",Float32Array:"Float32Array"};function Ih(t,e){const n=G6(t),{ImageOrientationPatient:r,PixelSpacing:i,Columns:a,Rows:o}=n,s=Qt(r[0],r[1],r[2]),c=Qt(r[3],r[4],r[5]),l=it();mn(l,s,c);const{zSpacing:f,origin:u,sortedImageIds:h}=$1(t,l),p=t.length,d=[i[1],i[0],f],g=[a,o,p].map(x=>Math.floor(x)),y=[...s,...c,...l];return{dimensions:g,spacing:d,origin:u,dataType:UP(h,n),direction:y,metadata:n,imageIds:h,volumeId:e,voxelManager:null,numberOfComponents:n.PhotometricInterpretation==="RGB"?3:1}}function UP(t,e){const{BitsAllocated:n,PixelRepresentation:r}=e,i=r===1,a=BP(t);if(a)return a;const[o,s,c]=[0,Math.floor(t.length/2),t.length-1],l=[o,s,c].map(p=>z6(t[p])),f=l.some(p=>p.rescaleIntercept<0||p.rescaleSlope<0),u=l.some(p=>H1(p)),h=dh();switch(n){case 8:return"Uint8Array";case 16:return h&&u?"Float32Array":i||f?"Int16Array":!i&&!f?"Uint16Array":"Float32Array";case 24:return"Uint8Array";case 32:return"Float32Array";default:throw new Error(`Bits allocated of ${n} is not defined to generate scalarData for the volume.`)}}function BP(t){const n=[0,Math.floor(t.length/2),t.length-1].map(i=>at.getImage(t[i]));if(!n.every(Boolean))return null;const r=n[0].getPixelData().constructor.name;return n.every(i=>i.getPixelData().constructor.name===r)&&r in kv?kv[r]:null}class Kc{constructor(e){this.name=e||"unknown"}static as(e){if(e.iterator)return e.iterator;const n=new Kc("as iterator");return e.then(r=>{try{n.add(r,!0)}catch(i){n.reject(i)}},r=>{n.reject(r)}),n}add(e,n=!1){this.nextValue=e,this.done||=n,this.waiting&&(this.waiting.resolve(e),this.waiting=void 0)}resolve(){this.done=!0,this.waiting&&(this.waiting.resolve(this.nextValue),this.waiting=void 0)}reject(e){this.rejectReason=e,this.waiting?.reject(e)}getRecent(){if(this.rejectReason)throw this.rejectReason;return this.nextValue}async*[Symbol.asyncIterator](){for(;!this.done;){if(this.rejectReason)throw this.rejectReason;if(this.nextValue!==void 0&&(yield this.nextValue,this.done))break;this.waiting||(this.waiting={},this.waiting.promise=new Promise((e,n)=>{this.waiting.resolve=e,this.waiting.reject=n})),await this.waiting.promise}yield this.nextValue}async forEach(e,n){let r=0;try{for await(const i of this){const{done:a}=this;try{await e(i,a,r),r++}catch(o){if(!a){console.warn("Caught exception in intermediate value",o);continue}if(n)n(o,a);else throw o}}}catch(i){if(n)n(i,!0);else throw i}}generate(e,n){return e(this,this.reject.bind(this)).then(()=>{this.done||this.resolve()},r=>{this.reject(r),n?n(r):console.warn("Couldn't process because",r)})}async nextPromise(){for await(const e of this)if(e)return e;return this.nextValue}async donePromise(){for await(const e of this);return this.nextValue}getNextPromise(){const e=this.nextPromise();return e.iterator=this,e}getDonePromise(){const e=this.donePromise();return e.iterator=this,e}}const wc=new Map,Uv="imageRetrieveConfiguration",qc={IMAGE_RETRIEVE_CONFIGURATION:Uv,clear:()=>{wc.clear()},add:(t,e)=>{wc.set(t,e)},clone:()=>new Map(wc),restore:t=>{wc.clear(),t.forEach((e,n)=>{wc.set(n,e)})},get:(t,...e)=>{if(t===Uv)return e.map(n=>wc.get(n)).find(n=>n!==void 0)}};Fh(qc.get.bind(qc));function j6(t){const e=is(),n=[];return e.forEach(r=>{const a=r.getVolumeViewports().filter(o=>o.hasVolumeId(t));n.push(...a)}),n}const qd=t=>{const e=GP(t);e?.length&&e.forEach(({renderingEngine:n,viewportIds:r})=>{n.hasBeenDestroyed||n.renderViewports(r)})};function GP(t){const e=is(),n=[];return e.forEach(r=>{const i=j6(t);i.length&&n.push({renderingEngine:r,viewportIds:i.map(a=>a.id)})}),n}const Bv=[{id:"initialImages",retrieveType:"single"}],WP=[{id:"lossySequential",retrieveType:"singleFast"},{id:"finalSequential",retrieveType:"singleFinal"}],Ap=[{offset:-1,imageQualityStatus:jr.ADJACENT_REPLICATE},{offset:1,imageQualityStatus:jr.ADJACENT_REPLICATE},{offset:2,imageQualityStatus:jr.FAR_REPLICATE}],zP=[{id:"initialImages",positions:[.5,0,-1],retrieveType:"default",requestType:St.Thumbnail,priority:5,nearbyFrames:Ap},{id:"quarterThumb",decimate:4,offset:3,requestType:St.Thumbnail,retrieveType:"multipleFast",priority:6,nearbyFrames:Ap},{id:"halfThumb",decimate:4,offset:1,priority:7,requestType:St.Thumbnail,retrieveType:"multipleFast",nearbyFrames:Ap},{id:"quarterFull",decimate:4,offset:2,priority:8,requestType:St.Thumbnail,retrieveType:"multipleFinal"},{id:"halfFull",decimate:4,offset:0,priority:9,requestType:St.Thumbnail,retrieveType:"multipleFinal"},{id:"threeQuarterFull",decimate:4,offset:1,priority:10,requestType:St.Thumbnail,retrieveType:"multipleFinal"},{id:"finalFull",decimate:4,offset:3,priority:11,requestType:St.Thumbnail,retrieveType:"multipleFinal"},{id:"errorRetrieve"}];function $6(t,e,n=0){const r=[];for(let i=n;i<t.length;i+=e)r.push(i);return r}function jP(t,e,n){if(e?.nearbyRequests?.length)for(const r of e.nearbyRequests)try{const{itemId:i,imageQualityStatus:a}=r,o=at.getImageQuality(i);if(o!==void 0&&o>=a)continue;const s={...n,imageId:i,imageQualityStatus:a};at.setPartialImage(i,s),t.successCallback(i,s)}catch(i){console.warn("Couldn't fill nearby item ",r.itemId,i)}}const Oc=class Oc{constructor(e){this.stages=e.stages||Bv,this.retrieveOptions=e.retrieveOptions||{}}loadImages(e,n){return new $P(this,e,n).loadImages()}};Oc.createProgressive=H6,Oc.interleavedRetrieveStages={stages:zP},Oc.singleRetrieveStages={stages:Bv},Oc.sequentialRetrieveStages={stages:WP};let ml=Oc;class $P{constructor(e,n,r){this.outstandingRequests=0,this.stageStatusMap=new Map,this.displayedIterator=new Kc("displayed"),this.stages=e.stages,this.retrieveOptions=e.retrieveOptions,this.imageIds=n,this.listener=r}async loadImages(){const e=this.createStageRequests();this.outstandingRequests=e.length;for(const n of e)this.addRequest(n);return this.outstandingRequests===0?Promise.resolve(null):this.displayedIterator.getDonePromise()}sendRequest(e,n){const{imageId:r,next:i}=e,a=(f,u)=>{this.listener.errorCallback(r,c||!i,f),u&&this.updateStageStatus(e.stage,f)},o=(n.loader||ro)(r,n),s=Kc.as(o);let c=!1;return s.forEach(async(f,u)=>{const h=at.getImageQuality(r);if(!f){console.warn("No image retrieved",r);return}const{imageQualityStatus:p}=f;if(c||=p===jr.FULL_RESOLUTION,h!==void 0&&h>p){this.updateStageStatus(e.stage,null,!0);return}this.listener.successCallback(r,f),this.displayedIterator.add(f),u&&this.updateStageStatus(e.stage),jP(this.listener,e,f)},a).finally(()=>{if(!c&&i)at.setPartialImage(r),this.addRequest(i,n.streamingData);else{c||this.listener.errorCallback(r,!0,"Couldn't decode"),this.outstandingRequests--;for(let f=i;f;f=f.next)this.updateStageStatus(f.stage,null,!0)}this.outstandingRequests<=0&&this.displayedIterator.resolve()}),s.getDonePromise().catch(f=>null)}addRequest(e,n={}){const{imageId:r,stage:i}=e,a=this.listener.getLoaderImageOptions(r);if(!a)return;const{retrieveType:o="default"}=i,{retrieveOptions:s}=this,c=s[o]||s.default,l={...a,retrieveType:o,retrieveOptions:c,streamingData:n},f=i.priority??-5,u=i.requestType||St.Interaction,h={imageId:r};Pr.addRequest(this.sendRequest.bind(this,e,l),u,h,f)}updateStageStatus(e,n,r=!1){const{id:i}=e,a=this.stageStatusMap.get(i);if(a&&(a.imageLoadPendingCount--,n?a.imageLoadFailedCount++:r||a.totalImageCount++,!r&&!a.stageStartTime&&(a.stageStartTime=Date.now()),!a.imageLoadPendingCount)){const{imageLoadFailedCount:o,totalImageCount:s,stageStartTime:c=Date.now(),startTime:l}=a,f={stageId:i,numberOfFailures:o,numberOfImages:s,stageDurationInMS:c?Date.now()-c:null,startDurationInMS:Date.now()-l};et(vt,Je.IMAGE_RETRIEVAL_STAGE,f),this.stageStatusMap.delete(i)}}createStageRequests(){const e=new Array,n=new Map,r=(i,a)=>{const o=a<0?this.imageIds.length+a:a<1?Math.floor((this.imageIds.length-1)*a):a,s=this.imageIds[o];if(!s)throw new Error(`No value found to add to requests at ${a}`);const c={imageId:s,stage:i,index:o,nearbyRequests:this.findNearbyRequests(o,i)};this.addStageStatus(i);const l=n.get(s);l?l.next=c:e.push(c),n.set(s,c)};for(const i of this.stages)(i.positions||$6(this.imageIds,i.decimate||1,i.offset??0)).forEach(o=>{r(i,o)});return e}findNearbyRequests(e,n){const r=new Array;if(!n.nearbyFrames)return r;for(const i of n.nearbyFrames){const a=e+i.offset;a<0||a>=this.imageIds.length||r.push({itemId:this.imageIds[a],imageQualityStatus:i.imageQualityStatus,index:a})}return r}addStageStatus(e){const{id:n}=e,r=this.stageStatusMap.get(n)||{stageId:n,startTime:Date.now(),stageStartTime:null,totalImageCount:0,imageLoadFailedCount:0,imageLoadPendingCount:0};return r.imageLoadPendingCount++,this.stageStatusMap.set(n,r),r}}function H6(t){return new ml(t)}const Gv=St.Prefetch;class K6 extends iu{constructor(e,n){super(e),this.framesLoaded=0,this.framesProcessed=0,this.framesUpdated=0,this.autoRenderOnLoad=!0,this.cachedFrames=[],this.reRenderTarget=0,this.reRenderFraction=2,this.imagesLoader=this,this.cancelLoading=()=>{const{loadStatus:r}=this;if(!r||!r.loading)return;r.loading=!1,r.cancelled=!0,this.clearLoadCallbacks();const i=({additionalDetails:a})=>a.volumeId!==this.volumeId;Pr.filterRequests(i)},this.loadStatus=n.loadStatus}invalidateVolume(e){const{vtkOpenGLTexture:n}=this,{numFrames:r}=this;for(let i=0;i<r;i++)n.setUpdatedFrame(i);this.modified(),e&&qd(this.volumeId)}clearLoadCallbacks(){this.loadStatus.callbacks=[]}callLoadStatusCallback(e){const{framesUpdated:n,framesProcessed:r,totalNumFrames:i}=e,{volumeId:a,reRenderFraction:o,loadStatus:s,metadata:c}=this,{FrameOfReferenceUID:l}=c;if(this.autoRenderOnLoad&&(n>this.reRenderTarget||r===i)&&(this.reRenderTarget+=o,qd(a)),r===i){s.callbacks.forEach(u=>u(e));const f={FrameOfReferenceUID:l,volumeId:a};et(vt,Je.IMAGE_VOLUME_LOADING_COMPLETED,f)}}updateTextureAndTriggerEvents(e,n,r=jr.FULL_RESOLUTION){const i=this.imageIdIndexToFrameIndex(e),{cachedFrames:a,numFrames:o,totalNumFrames:s}=this,{FrameOfReferenceUID:c}=this.metadata;if(a[i]>r||a[i]===jr.FULL_RESOLUTION)return;const f=r===jr.FULL_RESOLUTION;a[e]=r,this.framesUpdated++,f&&(this.framesLoaded++,this.framesProcessed++);const u={FrameOfReferenceUID:c,volumeId:this.volumeId,numberOfFrames:o,framesProcessed:this.framesProcessed};et(vt,Je.IMAGE_VOLUME_MODIFIED,u),f&&this.framesProcessed===this.totalNumFrames&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!0,imageIdIndex:e,imageId:n,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:o,totalNumFrames:s,complete:f,imageQualityStatus:r}),this.vtkOpenGLTexture.setUpdatedFrame(i),this.loadStatus.loaded&&(this.loadStatus.callbacks=[])}successCallback(e,n){const r=this.getImageIdIndex(e),{imageQualityStatus:i}=n;if(this.loadStatus.cancelled){console.warn("volume load cancelled, returning for imageIdIndex: ",r);return}this.updateTextureAndTriggerEvents(r,e,i),this.isDynamicVolume()&&this.checkDimensionGroupCompletion(r)}errorCallback(e,n,r){if(!n)return;const{totalNumFrames:i,numFrames:a}=this,o=this.getImageIdIndex(e);this.framesProcessed++,this.framesProcessed===i&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!1,imageId:e,imageIdIndex:o,error:r,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:a,totalNumFrames:i}),this.loadStatus.loaded&&(this.loadStatus.callbacks=[]);const s={error:r,imageIdIndex:o,imageId:e};et(vt,Je.IMAGE_LOAD_ERROR,s)}load(e){const{imageIds:n,loadStatus:r,numFrames:i}=this,{transferSyntaxUID:a}=nt("transferSyntax",n[0])||{},o=nt(qc.IMAGE_RETRIEVE_CONFIGURATION,this.volumeId,a,"volume");if(this.imagesLoader=this.isDynamicVolume()?this:o?(o.create||ml.createProgressive)(o):this,r.loading===!0)return;const{loaded:s}=this.loadStatus,c=n.length;if(s){e&&e({success:!0,framesLoaded:c,framesProcessed:c,numFrames:i,totalNumFrames:c});return}e&&this.loadStatus.callbacks.push(e),this._prefetchImageIds()}getLoaderImageOptions(e){const{transferSyntaxUID:n}=nt("transferSyntax",e)||{},r=nt("imagePlaneModule",e)||{},{rows:i,columns:a}=r,o=this.getImageIdIndex(e),s=nt("modalityLutModule",e)||{},c=nt("generalSeriesModule",e)||{},l={rescaleSlope:s.rescaleSlope,rescaleIntercept:s.rescaleIntercept,modality:c.modality},f=l.modality;if(f==="PT"||f==="RTDOSE"){const d=nt("scalingModule",e);d&&(this._addScalingToVolume(d),Object.assign(l,d))}const u=H1(l),h=dh();if(this.isPreScaled=!0,l&&l.rescaleSlope!==void 0&&l.rescaleIntercept!==void 0){const{rescaleSlope:d,rescaleIntercept:g}=l;this.isPreScaled=typeof d=="number"&&typeof g=="number"}return!h&&u&&(this.isPreScaled=!1),{targetBuffer:{type:this.dataType,rows:i,columns:a},allowFloatRendering:h,preScale:{enabled:this.isPreScaled,scalingParameters:l},transferPixelData:!0,requestType:Gv,transferSyntaxUID:n,additionalDetails:{imageId:e,imageIdIndex:o,volumeId:this.volumeId},retrieveOptions:void 0}}callLoadImage(e,n,r){const{cachedFrames:i}=this;if(i[n]===jr.FULL_RESOLUTION)return;const a=s=>{const{image:c}=s.detail;c.imageId===e&&(this.vtkOpenGLTexture.setUpdatedFrame(n),vt.removeEventListener(Je.IMAGE_CACHE_IMAGE_ADDED,a))};return vt.addEventListener(Je.IMAGE_CACHE_IMAGE_ADDED,a),Kc.as(ro(e,r)).forEach(s=>{this.successCallback(e,s)},this.errorCallback.bind(this,n,e))}getImageIdsRequests(e,n){this.totalNumFrames=this.imageIds.length;const r=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(r/100),this.reRenderTarget=this.reRenderFraction),e.map(a=>{const o=this.getImageIdIndex(a),s=Gv,c=n,l=this.getLoaderImageOptions(a),{retrieveOptions:f={}}=nt(qc.IMAGE_RETRIEVE_CONFIGURATION,a,"volume")||{};return l.retrieveOptions={...l.retrieveOptions,...f.default||Object.values(f)?.[0]||{}},{callLoadImage:this.callLoadImage.bind(this),imageId:a,imageIdIndex:o,options:l,priority:c,requestType:s,additionalDetails:{volumeId:this.volumeId}}})}getImageLoadRequests(e){throw new Error("Abstract method")}getImageIdsToLoad(){throw new Error("Abstract method")}loadImages(){return this.loadStatus.loading=!0,this.getImageLoadRequests(5).reverse().forEach(n=>{if(!n)return;const{callLoadImage:r,imageId:i,imageIdIndex:a,options:o,priority:s,requestType:c,additionalDetails:l}=n;Pr.addRequest(r.bind(this,i,a,o),c,l,s)}),Promise.resolve(!0)}_prefetchImageIds(){this.loadStatus.loading=!0;const e=[...this.getImageIdsToLoad()];this.totalNumFrames=this.imageIds.length;const n=2;return this.autoRenderOnLoad&&(this.reRenderFraction=this.totalNumFrames*(n/100),this.reRenderTarget=this.reRenderFraction),this.imagesLoader.loadImages(e,this).catch(r=>{console.debug("progressive loading failed to complete",r)})}_addScalingToVolume(e){if(this.scaling)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),n&&(a.suvbw=n),this.scaling={PT:a}}checkDimensionGroupCompletion(e){}}class q6 extends K6{constructor(e,n){e.imageIds||(e.imageIds=n.imageIds),super(e,n),this.getImageIdsToLoad=()=>{const{imageIds:r}=this;return this.numFrames=r.length,r}}getScalarData(){return this.voxelManager.getScalarData()}getImageLoadRequests(e){const{imageIds:n}=this;return this.getImageIdsRequests(n,e)}}function X6(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a streaming image volume");async function n(){if(e.imageIds[0].split(":")[0]==="wadouri"){const[d,g]=[Math.floor(e.imageIds.length/2),e.imageIds.length-1],y=[0,d,g];await Promise.all(y.map(x=>at.isLoaded(e.imageIds[x])?Promise.resolve(!0):new Promise((m,v)=>{const w=e.imageIds[x];Pr.addRequest(async()=>{U6(w).then(()=>{console.log(`Prefetched imageId: ${w}`),m(!0)}).catch(C=>{v(C)})},St.Prefetch,{volumeId:t},1)}))).catch(console.error)}const i=Ih(e.imageIds,t),{dimensions:a,spacing:o,origin:s,direction:c,metadata:l,imageIds:f,dataType:u,numberOfComponents:h}=i;return new q6({volumeId:t,metadata:l,dimensions:a,spacing:o,origin:s,direction:c,imageIds:f,dataType:u,numberOfComponents:h},{imageIds:f,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}})}const r=n();return{promise:r,decache:()=>{r.then(i=>{i.destroy(),i=null})},cancel:()=>{r.then(i=>{i.cancelLoading()})}}}const K1={};let Pc=X6;function Y6(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=K1[r];if(i==null){if(Pc==null||typeof Pc!="function")throw new Error(`No volume loader for scheme ${r} has been registered`);i=Pc}const a=i(t,e);return a.promise.then(function(o){et(vt,Je.VOLUME_LOADED,{volume:o})},function(o){const s={volumeId:t,error:o};et(vt,Je.VOLUME_LOADED_FAILED,s)}),a}function J6(t,e={imageIds:[]}){if(t===void 0)throw new Error("loadVolume: parameter volumeId must not be undefined");let n=at.getVolumeLoadObject(t);return n!==void 0?n.promise:(n=Y6(t,e),n.promise.then(r=>r))}async function q1(t,e){if(t===void 0)throw new Error("createAndCacheVolume: parameter volumeId must not be undefined");let n=at.getVolumeLoadObject(t);return n!==void 0||(n=Y6(t,e),at.putVolumeLoadObject(t,n)),n.promise}function Z6(t,e){const n=at.getVolume(t);if(!n)throw new Error(`Cannot created derived volume: Referenced volume with id ${t} does not exist.`);let{volumeId:r}=e;const{voxelRepresentation:i}=e;r===void 0&&(r=si());const{metadata:a,dimensions:o,spacing:s,origin:c,direction:l}=n,f=n.isDynamicVolume()?n.getCurrentDimensionGroupImageIds():n.imageIds??[],u=W1(f,{targetBuffer:e.targetBuffer,voxelRepresentation:i}),h=u[0].dataType,p=u.map(g=>g.imageId),d=new iu({volumeId:r,dataType:h,metadata:structuredClone(a),dimensions:[o[0],o[1],o[2]],spacing:s,origin:c,direction:l,referencedVolumeId:t,imageIds:p,referencedImageIds:n.imageIds??[]});return at.putVolumeSync(r,d),d}async function HP(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImages: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImages: parameter volumeId must not be undefined");const n=at.getVolume(t);return n||(e.filter(a=>!at.getImage(a)).length===0?Q6(t,e):await q1(t,{imageIds:e}))}function Q6(t,e){if(e===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter imageIds must not be undefined");if(t===void 0)throw new Error("createAndCacheVolumeFromImagesSync: parameter volumeId must not be undefined");const n=at.getVolume(t);if(n)return n;const r=Ih(e,t),i=new iu({volumeId:t,dataType:r.dataType,metadata:structuredClone(r.metadata),dimensions:r.dimensions,spacing:r.spacing,origin:r.origin,direction:r.direction,referencedVolumeId:r.referencedVolumeId,imageIds:r.imageIds,referencedImageIds:r.referencedImageIds});return at.putVolumeSync(t,i),i}function X1(t,e={}){const{metadata:n,dimensions:r,spacing:i,origin:a,direction:o,scalarData:s,targetBuffer:c,preventCache:l=!1}=e,f=at.getVolume(t);if(f)return f;const u=r[0]*r[1],h=s?s.constructor.name:c?.type??"Float32Array",p=u*r[2];let d;switch(h){case"Uint8Array":case"Int8Array":d=p;break;case"Uint16Array":case"Int16Array":d=p*2;break;case"Float32Array":d=p*4;break}if(!at.isCacheable(d))throw new Error(`Cannot created derived volume: Volume with id ${t} is not cacheable.`);const y=[];for(let v=0;v<r[2];v++){const w=`${t}_slice_${v}`;y.push(w);const C=s.subarray(v*u,(v+1)*u);z1(w,{scalarData:C,dimensions:[r[0],r[1]],spacing:[i[0],i[1]],origin:a,direction:o,targetBuffer:{type:h}})}const x=new iu({volumeId:t,metadata:structuredClone(n),dimensions:[r[0],r[1],r[2]],spacing:i,origin:a,direction:o,imageIds:y,dataType:h}),m=rn.createImageVolumeVoxelManager({imageIds:y,dimensions:r,numberOfComponents:1,id:t});return x.voxelManager=m,l||at.putVolumeSync(t,x),x}function KP(t,e){K1[t]=e}function e9(){return Object.keys(K1)}function qP(t){const e=Pc;return Pc=t,e}function t9(){return Pc.name}function XP(t,e={}){return Z6(t,{...e,targetBuffer:{type:"Uint8Array",...e?.targetBuffer}})}function YP(t,e,n=!1){return t.scalarData||(t.scalarData=new Uint8Array(t.dimensions[0]*t.dimensions[1]*t.dimensions[2])),X1(e,{...t,preventCache:n})}const JP=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheDerivedLabelmapVolume:XP,createAndCacheDerivedVolume:Z6,createAndCacheVolume:q1,createAndCacheVolumeFromImages:HP,createAndCacheVolumeFromImagesSync:Q6,createLocalLabelmapVolume:YP,createLocalVolume:X1,getUnknownVolumeLoaderSchema:t9,getVolumeLoaderSchemes:e9,loadVolume:J6,registerUnknownVolumeLoader:qP,registerVolumeLoader:KP},Symbol.toStringTag,{value:"Module"}));function n9(t,e){const n=xP.newInstance();hc().rendering.preferSizeOverAccuracy&&n.setPreferSizeOverAccuracy(!0),n.setInputData(t);const r=t.getSpacing(),i=(r[0]+r[1]+r[2])/6;return n.setMaximumSamplesPerRay(4e3),n.setSampleDistance(i),n.setScalarTexture(e),n}function ZP(t){const e=A6.newInstance();e.setBlendMode(t.getBlendMode());const n=t.getInputData(),{voxelManager:r}=n.get("voxelManager"),i=r.getCompleteScalarDataArray(),a=ft.newInstance({name:"Pixels",values:i});return n.getPointData().setScalars(a),e.setInputData(n),e.setMaximumSamplesPerRay(t.getMaximumSamplesPerRay()),e.setSampleDistance(t.getSampleDistance()),e}const QP=0,eV=St.Prefetch;async function Y1(t,e){let n=nV(e);!n&&e.imageIds.length&&(n=await rV(e),n=tV(e,n)),!(n.lower===0&&n.upper===0||n.lower===void 0||n.upper===void 0)&&t.getProperty().getRGBTransferFunction(0).setMappingRange(n.lower,n.upper)}function tV(t,e){const n=t.imageIds,r=Math.floor(n.length/2),i=n[r],a=nt("generalSeriesModule",i)||{};return iV(a.modality,t)?{lower:0,upper:5}:e}function nV(t){const{imageIds:e,metadata:n}=t;let r;if(e?.length){const i=Math.floor(e.length/2),a=e[i],o=nt("voiLutModule",a);if(o&&o.windowWidth&&o.windowCenter){o?.voiLUTFunction&&(r={},r.voiLUTFunction=o?.voiLUTFunction);const{windowWidth:s,windowCenter:c}=o,l=Array.isArray(s)?s[0]:s,f=Array.isArray(c)?c[0]:c;l!==0&&(r={windowWidth:l,windowCenter:f})}}else r=n.voiLut[0];if(r&&(r.windowWidth!==0||r.windowCenter!==0)){const{lower:i,upper:a}=Ku(Number(r.windowWidth),Number(r.windowCenter),r.voiLUTFunction);return{lower:i,upper:a}}}async function rV(t){const{imageIds:e}=t,n=Math.floor(e.length/2),r=t.imageIds[n],i=nt("generalSeriesModule",r)||{},{modality:a}=i,o=nt("modalityLutModule",r)||{},s={rescaleSlope:o.rescaleSlope,rescaleIntercept:o.rescaleIntercept,modality:a};let c;if(a==="PT"){const p=nt("scalingModule",r);p&&(c={...s,suvbw:p.suvbw})}const l={priority:QP,requestType:eV,preScale:{scalingParameters:c}};let f=at.getImage(r);t.referencedImageIds?.length||(f=await ro(r,{...l,ignoreCache:!0}));let{min:u,max:h}=f.voxelManager.getMinMax();return u?.length>1&&(u=Math.min(...u),h=Math.max(...h)),{lower:u,upper:h}}function iV(t,e){return!(t!=="PT"||!e.isPreScaled||!e.scaling?.PT.suvbw)}async function Xd(t,e,n,r=!1){const{volumeId:i,callback:a,blendMode:o}=t,s=await J6(i);if(!s)throw new Error(`imageVolume with id: ${s.volumeId} does not exist`);const{imageData:c,vtkOpenGLTexture:l}=s,f=n9(c,l);o&&f.setBlendMode(o);const u=dD.newInstance();u.setMapper(f);const{numberOfComponents:h}=c.get("numberOfComponents");return u.getProperty().set({viewportId:n},!0),h===3&&u.getProperty().setIndependentComponents(!1),await Y1(u,s),a&&a({volumeActor:u,volumeId:i}),r||aV(e,n,u,i),u}function aV(t,e,n,r){const i=n.getProperty().getRGBTransferFunction(0).getRange(),a={viewportId:e,range:{lower:i[0],upper:i[1]},volumeId:r};et(t,Je.VOI_MODIFIED,a)}function r9(t){const e=t.getMapper().getInputData(),n=e.extentToBounds(e.getExtent());return[[n[0],n[2],n[4]],[n[0],n[2],n[5]],[n[0],n[3],n[4]],[n[0],n[3],n[5]],[n[1],n[2],n[4]],[n[1],n[2],n[5]],[n[1],n[3],n[4]],[n[1],n[3],n[5]]]}const oV=xi*xi,Fp=t=>Math.abs(Math.abs(t)-1)<oV,Ip=(t,e)=>Fp(t[e])||Fp(t[e+1])||Fp(t[e+2]),sV=t=>Ip(t,0)&&Ip(t,3)&&Ip(t,6);function Ph(t,e,n){const r=t.getMapper().getInputData();let i;const a=r.getDirection();if(sV(a))i=r9(t);else{const[u,h,p]=r.getDimensions();i=[[0,0,0],[u-1,0,0],[0,h-1,0],[u-1,h-1,0],[0,0,p-1],[u-1,0,p-1],[0,h-1,p-1],[u-1,h-1,p-1]].map(g=>r.indexToWorld(g))}const o=Ko.buildFromDegree().identity().rotateFromDirections(e,[1,0,0]);i.forEach(u=>o.apply(u));const s=[...n];o.apply(s);const c=s[0];let l=1/0,f=-1/0;for(let u=0;u<8;u++){const h=i[u][0];h>f&&(f=h),h<l&&(l=h)}return{min:l,max:f,current:c,actor:t,viewPlaneNormal:e,focalPoint:n}}function Gl(t,e){const{direction:n,spacing:r}=t,i=n.slice(0,3),a=n.slice(3,6),o=n.slice(6,9),s=[zt(i,e),zt(a,e),zt(o,e)],c=it();return $t(c,s[0]*r[0],s[1]*r[1],s[2]*r[2]),Qo(c)}const i9=t=>{const e="volumeId:",n=t.includes(e)?t.substring(e.length):t,r=n.indexOf("sliceIndex=");return r===-1?n:n.substring(0,r-1)},cV=1+xi,uV=(t,e)=>e===t.substring(0,Math.min(t.length,e.length)),Wv=t=>!!e9().find(e=>uV(t.volumeId,e));function J1(t,e,n,r=!1){const{viewPlaneNormal:i}=e,a=t.getActors();if(!a.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const o=a.map(l=>{const f=l.referencedId??l.uid;return at.getVolume(f)}).filter(l=>!!l);if(n){const l=i9(n),f=o.findIndex(d=>l.includes(d.volumeId)),u=o[f],{uid:h}=a[f],p=zv(u,i,t,r);return{imageVolume:u,spacingInNormalDirection:p,actorUID:h}}if(!o.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const s={spacingInNormalDirection:1/0,imageVolume:null,actorUID:null},c=o.find(Wv);for(let l=0;l<o.length;l++){const f=o[l];if(c&&!Wv(f))continue;const u=zv(f,i,t);u*cV<s.spacingInNormalDirection&&(s.spacingInNormalDirection=u,s.imageVolume=f,s.actorUID=a[l].uid)}return s}function zv(t,e,n,r=!1){const{slabThickness:i}=n.getProperties();let a=i;return(!i||!r)&&(a=Gl(t,e)),a}function zf(t){const e=t.getCamera(),{spacingInNormalDirection:n,imageVolume:r}=J1(t,e);if(!r)return;const{viewPlaneNormal:i,focalPoint:a}=e,o=t.getActors().find(d=>d.referencedId===r.volumeId||d.uid===r.volumeId);o||console.warn("No actor found for with actorUID of",r.volumeId);const s=o.actor,c=Ph(s,i,a),{min:l,max:f,current:u}=c,h=Math.round((f-l)/n)+1;let p=(u-l)/(f-l)*h;return p=Math.floor(p),p>h-1?p=h-1:p<0&&(p=0),{numberOfSlices:h,imageIndex:p}}const Sc={};function lV(t){Sc[t]!==void 0&&delete Sc[t]}function fV(t){const{renderingEngineId:e,viewportId:n}=t.detail,i=Ol(e).getViewport(n);if(!("setVolumes"in i))throw new Error("volumeNewImageEventDispatcher: viewport does not have setVolumes method");Sc[i.id]===void 0&&(Sc[i.id]=0);const a=zf(i);if(!a){console.warn(`volumeNewImageEventDispatcher: sliceData is undefined for viewport ${i.id}`);return}const{numberOfSlices:o,imageIndex:s}=a;if(Sc[i.id]===s)return;Sc[i.id]=s;const c={imageIndex:s,viewportId:n,renderingEngineId:e,numberOfSlices:o};et(i.element,Je.VOLUME_NEW_IMAGE,c)}function a9(t,e,n){const[r,i,a]=t,[o,s,c]=e,[l,f,u,h]=n,p=o-r,d=s-i,g=c-a,y=-1*(l*r+f*i+u*a-h)/(l*p+f*d+u*g),x=p*y+r,m=d*y+i,v=g*y+a;return[x,m,v]}function o9(t,e,n=!1){const[r,i,a]=t,o=r*e[0]+i*e[1]+a*e[2];if(n){const s=Math.sqrt(r*r+i*i+a*a);return[r/s,i/s,a/s,o/s]}return[r,i,a,o]}function hV(t,e,n){const[r,i,a,o]=t,[s,c,l,f]=e,[u,h,p,d]=n,g=Ou(r,s,u,i,c,h,a,l,p),y=Ou(o,f,d,i,c,h,a,l,p),x=Ou(r,s,u,o,f,d,a,l,p),m=Ou(r,s,u,i,c,h,o,f,d),v=Gs(y)/Gs(g),w=Gs(x)/Gs(g),C=Gs(m)/Gs(g);return[v,w,C]}function Z1(t,e,n=!1){const[r,i,a,o]=t,[s,c,l]=e,f=r*s+i*c+a*l-o,u=Math.abs(f)/Math.sqrt(r*r+i*i+a*a);return(n?Math.sign(f):1)*u}function pV(t,e,n=xi){return Z1(e,t)<n}const dV=Object.freeze(Object.defineProperty({__proto__:null,isPointOnPlane:pV,linePlaneIntersection:a9,planeDistanceToPoint:Z1,planeEquation:o9,threePlaneIntersection:hV},Symbol.toStringTag,{value:"Module"}));function Yd(t){return Array.isArray(t)?t.some(e=>Number.isNaN(e)):Number.isNaN(t)}function vl(t){if(t===null||typeof t!="object"||typeof t=="function"||typeof structuredClone=="function")return t;if(Array.isArray(t))return t.map(vl);{const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=vl(t[n]));return e}}const tl=class tl{constructor(e){this.insetImageMultiplier=1.1,this.flipHorizontal=!1,this.flipVertical=!1,this.viewportStatus=Mr.NO_DATA,this._suppressCameraModifiedEvents=!1,this.hasPixelSpacing=!0,this.getProperties=()=>({}),this.setRotation=n=>{},this.viewportWidgets=new Map,this.addWidget=(n,r)=>{this.viewportWidgets.set(n,r)},this.getWidget=n=>this.viewportWidgets.get(n),this.getWidgets=()=>Array.from(this.viewportWidgets.values()),this.removeWidgets=()=>{this.getWidgets().forEach(r=>{if(r.getEnabled()&&r.setEnabled(!1),r.getActor&&r.getRenderer){const i=r.getActor(),a=r.getRenderer();a&&i&&a.removeActor(i)}})},this.id=e.id,this.renderingEngineId=e.renderingEngineId,this.type=e.type,this.element=e.element,this.canvas=e.canvas,this.sx=e.sx,this.sy=e.sy,this.sWidth=e.sWidth,this.sHeight=e.sHeight,this._actors=new Map,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.defaultOptions=vl(e.defaultOptions),this.suppressEvents=e.defaultOptions.suppressEvents?e.defaultOptions.suppressEvents:!1,this.options=vl(e.defaultOptions),this.isDisabled=!1}static get useCustomRenderingPipeline(){return!1}setRendered(){this.viewportStatus===Mr.NO_DATA||this.viewportStatus===Mr.LOADING||(this.viewportStatus=Mr.RENDERED)}setColorTransform(e,n){let r=null;if(!e&&!n)return;const i=n||[255,255,255],a=Math.max(...i),o=i.map(u=>a/u),{lower:s=0,upper:c=255}=e||{},l=(c-s+1)/255,f=s/255;return r=`url('data:image/svg+xml,      <svg xmlns="http://www.w3.org/2000/svg">        <filter id="colour" color-interpolation-filters="linearRGB">        <feColorMatrix type="matrix"         values="          ${o[0]*l} 0 0 0 ${f}           0 ${o[1]*l} 0 0 ${f}           0 0 ${o[2]*l} 0 ${f}           0 0 0 1 0" />        </filter>      </svg>#colour')`,r}getRenderingEngine(){return ul.get(this.renderingEngineId)}getRenderer(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}render(){this.getRenderingEngine().renderViewport(this.id)}setOptions(e,n=!1){this.options=structuredClone(e),this.options?.displayArea&&this.setDisplayArea(this.options?.displayArea),n&&this.render()}reset(e=!1){this.options=structuredClone(this.defaultOptions),e&&this.render()}getSliceViewInfo(){throw new Error("Method not implemented.")}flip({flipHorizontal:e,flipVertical:n}){const r=this.getDefaultImageData();if(!r)return;const i=this.getCamera(),{viewPlaneNormal:a,viewUp:o,focalPoint:s,position:c}=i,l=mn(it(),a,o);let f=mE(it(),o);const u=Za(it(),a),h=O4(c,s),d=r.getDimensions().map(C=>Math.floor(C/2)),g=[d[0],d[1],d[2]],y=r.indexToWorld(g,it()),x=this._getFocalPointForResetCamera(y,i,{resetPan:!0,resetToCenter:!1}),m=Ln(it(),s,x),v=Qo(m),w=C=>{const T=lr(it(),C,2*zt(m,C));return Ln(T,T,m),gn(T,T),T};if(e){const C=w(f),T=zr(it(),x,C,v),_=zr(it(),T,u,h);this.setCamera({viewPlaneNormal:u,position:_,focalPoint:T}),this.flipHorizontal=!this.flipHorizontal}if(n){f=Za(f,o);const C=w(l),T=zr(it(),x,C,v),_=zr(it(),T,u,h);this.setCamera({focalPoint:T,viewPlaneNormal:u,viewUp:f,position:_}),this.flipVertical=!this.flipVertical}this.render()}getDefaultImageData(){const e=this.getDefaultActor();if(e&&ki(e))return e.actor.getMapper().getInputData()}getDefaultActor(){return this.getActors()[0]}getActors(){return Array.from(this._actors.values())}getActorUIDs(){return Array.from(this._actors.keys())}getActor(e){return this._actors.get(e)}getImageActor(e){const n=this.getActors();let r=n[0];return e&&(r=n.find(a=>a.referencedId===e)),!r||!ki(r)?null:r.actor}getActorUIDByIndex(e){const n=this.getActors()[e];if(n)return n.uid}getActorByIndex(e){return this.getActors()[e]}setActors(e){const n=this.getActors();this.removeAllActors(),this.addActors(e,{resetCamera:!0}),et(this.element,Je.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:e,currentActors:e})}_removeActor(e){const n=this.getActor(e);if(!n){console.warn(`Actor ${e} does not exist in ${this.id}, can't remove`);return}return this.getRenderer().removeActor(n.actor),this._actors.delete(e),n}removeActors(e){const n=[];e.forEach(i=>{const a=this._removeActor(i);a&&n.push(a)});const r=this.getActors();et(this.element,Je.ACTORS_CHANGED,{viewportId:this.id,removedActors:n,addedActors:[],currentActors:r})}addActors(e,n={}){const{resetCamera:r=!1}=n,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn("Viewport::addActors::Rendering engine has not been initialized or has been destroyed");return}e.forEach(s=>{this.addActor(s)});const a=this.getViewPresentation(),o=this.getViewReference();this.resetCamera(),r||(this.setViewReference(o),this.setViewPresentation(a)),et(this.element,Je.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:e,currentActors:this.getActors()})}addActor(e){const{uid:n,actor:r}=e,i=this.getRenderingEngine();if(!i||i.hasBeenDestroyed){console.warn(`Cannot add actor UID of ${n} Rendering Engine has been destroyed`);return}if(!n||!r)throw new Error("Actors should have uid and vtk Actor properties");if(this.getActor(n)){console.warn(`Actor ${n} already exists for this viewport`);return}this.getRenderer()?.addActor(r),this._actors.set(n,Object.assign({},e)),this.updateCameraClippingPlanesAndRange(),et(this.element,Je.ACTORS_CHANGED,{viewportId:this.id,removedActors:[],addedActors:[e],currentActors:this.getActors()})}removeAllActors(){const e=this.getActors();this.getRenderer()?.removeAllViewProps(),this._actors=new Map,et(this.element,Je.ACTORS_CHANGED,{viewportId:this.id,removedActors:e,addedActors:[],currentActors:[]})}resetCameraNoEvent(){const e=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.resetCamera(),this._suppressCameraModifiedEvents=e}setCameraNoEvent(e){const n=this._suppressCameraModifiedEvents;this._suppressCameraModifiedEvents=!0,this.setCamera(e),this._suppressCameraModifiedEvents=n}_getViewImageDataIntersections(e,n,r){const i=r[0],a=r[1],o=r[2],s=i*n[0]+a*n[1]+o*n[2],c=e.getBounds(),l=this._getEdges(c),f=[];for(const u of l){const[[h,p,d],[g,y,x]]=u;if(i*(g-h)+a*(y-p)+o*(x-d)===0)continue;const m=a9([h,p,d],[g,y,x],[i,a,o,s]);this._isInBounds(m,c)&&f.push(m)}return f}setInterpolationType(e,n){}setDisplayArea(e,n=!1){if(!e)return;const{storeAsInitialCamera:r,type:i}=e;r&&(this.options.displayArea=e);const{_suppressCameraModifiedEvents:a}=this;if(this._suppressCameraModifiedEvents=!0,this.setCamera(this.fitToCanvasCamera),i==="SCALE"?this.setDisplayAreaScale(e):(this.setInterpolationType(this.getProperties()?.interpolationType??Ka.LINEAR),this.setDisplayAreaFit(e)),r&&(this.initialCamera=this.getCamera()),this._suppressCameraModifiedEvents=a,!n&&!a){const o={viewportId:this.id,displayArea:e,storeAsInitialCamera:r};et(this.element,Je.DISPLAY_AREA_MODIFIED,o),this.setCamera(this.getCamera())}}setDisplayAreaScale(e){const{scale:n=1}=e,r=this.canvas,i=r.height,a=r.width;if(i<8||a<8)return;const c=this.getDefaultImageData().getSpacing()[1];this.setInterpolationType(Ka.NEAREST),this.setCamera({parallelScale:i*c/(2*n)}),delete e.imageArea,this.setDisplayAreaFit(e);const{focalPoint:l,position:f,viewUp:u,viewPlaneNormal:h}=this.getCamera(),p=it();if(r.height%2&&zr(p,p,u,n*.5*c),r.width%2){const d=mn(it(),u,h);zr(p,p,d,n*.5*c)}!p[0]&&!p[1]&&!p[2]||this.setCamera({focalPoint:vi(it(),l,p),position:vi(it(),f,p)})}setDisplayAreaFit(e){const{imageArea:n,imageCanvasPoint:r}=e,i=window?.devicePixelRatio||1,a=this.getDefaultImageData();if(!a)return;const o=this.sWidth/i,s=this.sHeight/i,c=a.getDimensions(),l=this.worldToCanvas(a.indexToWorld([0,0,0])),f=this.worldToCanvas(a.indexToWorld([c[0],c[1],c[2]])),u=[Math.abs(f[0]-l[0]),Math.abs(f[1]-l[1])],[h,p]=u;let d=this.getZoom()/this.insetImageMultiplier;if(n){const[g,y]=n,x=Math.max(Math.abs(h/o),Math.abs(p/s)),m=Math.abs(g*h/o),v=Math.abs(y*p/s),w=this.getZoom(),C=this.getZoom(this.fitToCanvasCamera);d=(m>v?x/m:x/v)*w/C,this.setZoom(this.insetImageMultiplier*d,!1)}if(r){const{imagePoint:g,canvasPoint:y=g||[.5,.5]}=r,[x,m]=y,v=o*(x-.5),w=s*(m-.5),[C,T]=g||y,_=d,S=this.insetImageMultiplier*_*h*(.5-C),b=this.insetImageMultiplier*_*p*(.5-T),D=S+v,E=b+w,R=[D,E];u1(R,R,this.getPan()),this.setPan(R,!1)}}getDisplayArea(){return this.options?.displayArea}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetToCenter:i=!0,storeAsInitialCamera:a=!0}=e||{},o=this.getRenderer();this.setCameraNoEvent({flipHorizontal:!1,flipVertical:!1});const s=this.getCamera();let c;const l=this.getDefaultActor();l&&ki(l)?c=l.actor.getMapper().getInputData().getBounds():c=o.computeVisiblePropBounds();const f=[0,0,0],u=this.getDefaultImageData();if(u){const M=u.getSpacing();c[0]=c[0]+M[0]/2,c[1]=c[1]-M[0]/2,c[2]=c[2]+M[1]/2,c[3]=c[3]-M[1]/2,c[4]=c[4]+M[2]/2,c[5]=c[5]-M[2]/2}const h=this.getVtkActiveCamera(),p=h.getViewPlaneNormal(),d=h.getViewUp();if(f[0]=(c[0]+c[1])/2,f[1]=(c[2]+c[3])/2,f[2]=(c[4]+c[5])/2,u){const U=u.getDimensions().map(Y=>Math.floor(Y/2)),z=[U[0],U[1],U[2]];u.indexToWorld(z,f)}const{widthWorld:g,heightWorld:y}=this._getWorldDistanceViewUpAndViewRight(c,d,p),x=[this.sWidth,this.sHeight],m=g/y,v=x[0]/x[1],w=m/v,C=w<1?this.insetImageMultiplier*y/2:this.insetImageMultiplier*y*w/2,T=tl.boundsRadius(c)*(this.type===tn.VOLUME_3D?10:1),_=this.insetImageMultiplier*T,S=Math.abs(mi.dot(d,p))>.999?[-d[2],d[0],d[1]]:d,b=this._getFocalPointForResetCamera(f,s,{resetPan:n,resetToCenter:i}),D=[b[0]+_*p[0],b[1]+_*p[1],b[2]+_*p[2]];o.resetCameraClippingRange(c);const E=[-Tn.MAXIMUM_RAY_DISTANCE,Tn.MAXIMUM_RAY_DISTANCE];h.setPhysicalScale(T),h.setPhysicalTranslation(-b[0],-b[1],-b[2]),this.setCamera({parallelScale:r?C:s.parallelScale,focalPoint:b,position:D,viewAngle:90,viewUp:S,clippingRange:E});const R=this.getCamera();this.setFitToCanvasCamera(this.getCamera()),a&&this.setInitialCamera(R),r&&this.setZoom(1,a);const F={type:"ResetCameraEvent",renderer:o};return o.invokeEvent(F),this.triggerCameraModifiedEventIfNecessary(s,R),u&&this.options.displayArea&&r&&n&&i&&this.setDisplayArea(this.options.displayArea),!0}setInitialCamera(e){this.initialCamera=e}setFitToCanvasCamera(e){this.fitToCanvasCamera=e}getPan(e=this.initialCamera){if(!e)return[0,0];const r=this.getVtkActiveCamera().getFocalPoint(),i=this.canvasToWorld([0,0]),a=this.worldToCanvas(Ln([0,0,0],e.focalPoint,i)),o=this.worldToCanvas(Ln([0,0,0],r,i));return Of([0,0],a,o)}getCurrentImageIdIndex(){throw new Error("Not implemented")}getSliceIndex(){throw new Error("Not implemented")}getImageData(){throw new Error("Not implemented")}getViewReferenceId(e){return null}setPan(e,n=!1){const r=this.getCamera(),{focalPoint:i,position:a}=r,o=this.canvasToWorld([0,0]),s=Of([0,0],e,this.getPan());if(Math.abs(s[0])<1&&Math.abs(s[1])<1&&!n)return;const c=Ln(it(),this.canvasToWorld(s),o),l=Ln(it(),i,c),f=Ln(it(),a,c);this.setCamera({...r,focalPoint:l,position:f},n)}getZoom(e=this.initialCamera){if(!e)return 1;const n=this.getVtkActiveCamera(),{parallelScale:r}=e;return r/n.getParallelScale()}setZoom(e,n=!1){const r=this.getCamera(),{parallelScale:i}=this.initialCamera,a=i/e;r.parallelScale===a&&!n||this.setCamera({...r,parallelScale:a},n)}_getFocalPointForViewPlaneReset(e){const{focalPoint:n,viewPlaneNormal:r}=this.getCamera(),i=this._getViewImageDataIntersections(e,n,r);let a=0,o=0,s=0;return i.forEach(([l,f,u])=>{a+=l,o+=f,s+=u}),[a/i.length,o/i.length,s/i.length]}getCanvas(){return this.canvas}getVtkActiveCamera(){const e=this.getRenderer();return e?e.getActiveCamera():(console.warn("No renderer found for the viewport"),null)}getCameraNoRotation(){const e=this.getVtkActiveCamera(),n=(s,c)=>s.some(l=>isNaN(l))?c:s,r=n([...e.getViewUp()],[0,1,0]),i=n([...e.getViewPlaneNormal()],[0,0,-1]),a=n([...e.getPosition()],[0,0,1]),o=n([...e.getFocalPoint()],[0,0,0]);return{viewUp:r,viewPlaneNormal:i,position:a,focalPoint:o,parallelProjection:e.getParallelProjection(),parallelScale:e.getParallelScale(),viewAngle:e.getViewAngle(),flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}getCamera(){return{...this.getCameraNoRotation(),rotation:this.getRotation()}}setCamera(e,n=!1){const r=this.getVtkActiveCamera(),i=this.getCamera(),a=Object.assign({},i,e),{viewUp:o,viewPlaneNormal:s,position:c,focalPoint:l,parallelScale:f,viewAngle:u,flipHorizontal:h,flipVertical:p,clippingRange:d}=e;if(h!==void 0){const x=h&&!this.flipHorizontal||!h&&this.flipHorizontal;x&&this.flip({flipHorizontal:x})}if(p!==void 0){const x=p&&!this.flipVertical||!p&&this.flipVertical;x&&this.flip({flipVertical:x})}o!==void 0&&r.setViewUp(o),s!==void 0&&r.setDirectionOfProjection(-s[0],-s[1],-s[2]),c!==void 0&&r.setPosition(...c),l!==void 0&&r.setFocalPoint(...l),f!==void 0&&r.setParallelScale(f),u!==void 0&&r.setViewAngle(u),d!==void 0&&r.setClippingRange(d);const g=i.focalPoint,y=i.viewUp;if(g&&l||y&&o){const x=r.getViewPlaneNormal(),m=r.getViewUp();let v=!1,w=!1;if(l){const C=[l[0]-g[0],l[1]-g[1],l[2]-g[2]];v=Math.abs(mi.dot(C,x))>0}if(o&&(w=!Un(m,y)),v||w){const C=this.getDefaultActor();if(!C?.actor)return;Hr(C,"vtkActor")||this.updateClippingPlanesForActors(a),(Hr(C,"vtkImageSlice")||this.type===tn.VOLUME_3D)&&this.getRenderer().resetCameraClippingRange()}}n&&this.setInitialCamera(a),this.triggerCameraModifiedEventIfNecessary(i,this.getCamera())}triggerCameraModifiedEventIfNecessary(e,n){if(!this._suppressCameraModifiedEvents&&!this.suppressEvents){const r={previousCamera:e,camera:n,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.CAMERA_MODIFIED,r)}}updateCameraClippingPlanesAndRange(){const e=this.getCamera();this.updateClippingPlanesForActors(e),this.getRenderer().resetCameraClippingRange()}async updateClippingPlanesForActors(e){this.getActors().map(r=>{if(!r.actor)return;const i=r.actor.getMapper();let a=r?.clippingFilter?r?.clippingFilter.getClippingPlanes():i.getClippingPlanes();a.length===0&&r?.clippingFilter&&(a=[hr.newInstance(),hr.newInstance()]);let o=Tn.MINIMUM_SLAB_THICKNESS;r.slabThickness&&(o=r.slabThickness);const{viewPlaneNormal:s,focalPoint:c}=e;this.setOrientationOfClippingPlanes(a,o,s,c),et(this.element,Je.CLIPPING_PLANES_UPDATED,{actorEntry:r,focalPoint:c,vtkPlanes:a,viewport:this})})}setOrientationOfClippingPlanes(e,n,r,i){if(e.length<2)return;const a=[r[0],r[1],r[2]];mi.multiplyScalar(a,n),e[0].setNormal(r);const o=[0,0,0];mi.subtract(i,a,o),e[0].setOrigin(o),e[1].setNormal(-r[0],-r[1],-r[2]);const s=[0,0,0];mi.add(i,a,s),e[1].setOrigin(s)}getClippingPlanesForActor(e){if(e||(e=this.getDefaultActor()),!e.actor)throw new Error("Invalid actor entry: Actor is undefined");const n=e.actor.getMapper();let r=e?.clippingFilter?e?.clippingFilter.getClippingPlanes():n.getClippingPlanes();return r.length===0&&e?.clippingFilter&&(r=[hr.newInstance(),hr.newInstance()]),r}_getWorldDistanceViewUpAndViewRight(e,n,r){const i=this._getCorners(e),a=this._getCorners(e),o=mn(it(),n,r);let s=Ko.buildFromDegree().identity().rotateFromDirections(n,[1,0,0]);i.forEach(h=>s.apply(h));let c=1/0,l=-1/0;for(let h=0;h<8;h++){const p=i[h][0];p>l&&(l=p),p<c&&(c=p)}s=Ko.buildFromDegree().identity().rotateFromDirections([o[0],o[1],o[2]],[1,0,0]),a.forEach(h=>s.apply(h));let f=1/0,u=-1/0;for(let h=0;h<8;h++){const p=a[h][0];p>u&&(u=p),p<f&&(f=p)}return{widthWorld:u-f,heightWorld:l-c}}getViewReference(e){const{focalPoint:n,viewPlaneNormal:r,viewUp:i}=this.getCamera();return{FrameOfReferenceUID:this.getFrameOfReferenceUID(),cameraFocalPoint:n,viewPlaneNormal:r,viewUp:i,sliceIndex:e?.sliceIndex??this.getSliceIndex()}}isReferenceViewable(e,n){if(e.FrameOfReferenceUID&&e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{viewPlaneNormal:r}=e,i=this.getCamera();return r&&!Un(r,i.viewPlaneNormal)&&!Un(Za(i.viewPlaneNormal,i.viewPlaneNormal),r)?n?.withOrientation:!0}getViewPresentation(e={rotation:!0,displayArea:!0,zoom:!0,pan:!0,flipHorizontal:!0,flipVertical:!0}){const n={},{rotation:r,displayArea:i,zoom:a,pan:o,flipHorizontal:s,flipVertical:c}=e;r&&(n.rotation=this.getRotation()),i&&(n.displayArea=this.getDisplayArea());const l=this.getZoom();return a&&(n.zoom=l),o&&(n.pan=this.getPan(),Xm(n.pan,n.pan,1/l)),s&&(n.flipHorizontal=this.flipHorizontal),c&&(n.flipVertical=this.flipVertical),n}setViewReference(e){}setViewPresentation(e){if(!e)return;const{displayArea:n,zoom:r=this.getZoom(),pan:i,rotation:a,flipHorizontal:o=this.flipHorizontal,flipVertical:s=this.flipVertical}=e;n!==this.getDisplayArea()&&this.setDisplayArea(n),this.setZoom(r),i&&this.setPan(Xm([0,0],i,r)),o!==void 0&&o!==this.flipHorizontal&&this.flip({flipHorizontal:o}),s!==void 0&&s!==this.flipVertical&&this.flip({flipVertical:s}),a>=0&&this.setRotation(a)}_getCorners(e){return[[e[0],e[2],e[4]],[e[0],e[2],e[5]],[e[0],e[3],e[4]],[e[0],e[3],e[5]],[e[1],e[2],e[4]],[e[1],e[2],e[5]],[e[1],e[3],e[4]],[e[1],e[3],e[5]]]}_getFocalPointForResetCamera(e,n,{resetPan:r=!0,resetToCenter:i=!0}){if(i&&r)return e;if(i&&!r)return Yd(n.focalPoint)?e:n.focalPoint;if(!i&&r){const a=n,o=a.focalPoint,s=a.viewPlaneNormal,c=Ln(it(),e,o),l=zt(c,s),f=zr(it(),e,s,-1*l);return[f[0],f[1],f[2]]}if(!r&&!i)return Yd(n.focalPoint)?e:n.focalPoint}_isInBounds(e,n){const[r,i,a,o,s,c]=n,[l,f,u]=e;return!(l<r||l>i||f<a||f>o||u<s||u>c)}_getEdges(e){const[n,r,i,a,o,s,c,l]=this._getCorners(e);return[[n,r],[n,o],[n,i],[r,a],[r,s],[i,a],[i,c],[a,l],[o,c],[o,s],[s,l],[c,l]]}static boundsRadius(e){const n=(e[1]-e[0])**2,r=(e[3]-e[2])**2,i=(e[5]-e[4])**2;return Math.sqrt(n+r+i||1)*.5}setDataIds(e,n){throw new Error("Unsupported operatoin setDataIds")}};tl.CameraViewPresentation={rotation:!0,pan:!0,zoom:!0,displayArea:!0},tl.TransferViewPresentation={windowLevel:!0,paletteLut:!0};let uc=tl;function s9(t,e,n=!1){const r=t.getCamera(),{focalPoint:i,viewPlaneNormal:a}=r,{spacingInNormalDirection:o,actorUID:s}=J1(t,r,e,n);if(!s)throw new Error(`Could not find image volume with id ${e} in the viewport`);const c=t.getActor(s);if(!c)return console.warn("No actor found for with actorUID of",s),null;const l=c.actor;return{sliceRange:Ph(l,a,i),spacingInNormalDirection:o,camera:r}}function Vc(t,e,n=!1){const{sliceRange:r,spacingInNormalDirection:i,camera:a}=s9(t,e,n),{min:o,max:s,current:c}=r,l=Math.round((s-o)/i),u=(c-o)/(s-o)*l,h=Math.round(u);return{numScrollSteps:l,currentStepIndex:h,sliceRangeInfo:{sliceRange:r,spacingInNormalDirection:i,camera:a}}}function kc(t,e,n,r,i,a){const{min:o,max:s,current:c}=n,l=it();Bn(l,e,t);const f=Math.round((s-o)/i),h=(c-o)/(s-o)*f;let p=Math.round(h),d=[t[0]-r[0]*h*i,t[1]-r[1]*h*i,t[2]-r[2]*h*i];p+=a,p>f?p=f:p<0&&(p=0);const g=p*i;d=[d[0]+r[0]*g,d[1]+r[1]*g,d[2]+r[2]*g];const y=[d[0]+l[0],d[1]+l[1],d[2]+l[2]];return{newFocalPoint:d,newPosition:y}}function c9(t){let e=[];const[n,r]=t.getRange();t.getTable(n,r,1024,e),e=e.filter((p,d)=>d%3===0);const i=[...Array(1024).keys()].map((p,d)=>n+(r-n)/1023*d),a=e[256],o=Math.log((1-a)/a),s=i[256],c=e[256*3],l=Math.log((1-c)/c),f=i[256*3],u=Math.round(4*(f-s)/(o-l)),h=Math.round(s+u*o/4);return[Math.round(h-u/2),Math.round(h+u/2)]}function u9(t,e){const n=e.colorTransfer.split(" ").splice(1).map(parseFloat),{shiftRange:r}=gV(n),i=r[0],a=r[1]-r[0],o=rs.newInstance(),s=[];for(let w=0;w<n.length;w+=4){let C=n[w];const T=n[w+1],_=n[w+2],S=n[w+3];C=(C-i)/a,s.push([C,T,_,S])}mV(s,r,o),t.getProperty().setRGBTransferFunction(0,o);const c=e.scalarOpacity.split(" ").splice(1).map(parseFloat),l=$c.newInstance(),f=[];for(let w=0;w<c.length;w+=2){let C=c[w];const T=c[w+1];C=(C-i)/a,f.push([C,T])}vV(f,r,l);const u=t.getProperty();u.setScalarOpacity(0,l);const[h,p,d,g]=e.gradientOpacity.split(" ").splice(1).map(parseFloat);u.setUseGradientOpacity(0,!0),u.setGradientOpacityMinimumValue(0,h),u.setGradientOpacityMinimumOpacity(0,p),u.setGradientOpacityMaximumValue(0,d),u.setGradientOpacityMaximumOpacity(0,g),e.interpolation==="1"&&u.setInterpolationTypeToFastLinear(),u.setShade(e.shade==="1");const y=parseFloat(e.ambient),x=parseFloat(e.diffuse),m=parseFloat(e.specular),v=parseFloat(e.specularPower);u.setAmbient(y),u.setDiffuse(x),u.setSpecular(m),u.setSpecularPower(v)}function gV(t){let e=1/0,n=-1/0;for(let i=0;i<t.length;i+=4)e=Math.min(e,t[i]),n=Math.max(n,t[i]);const r=(n-e)/2;return{shiftRange:[-r,r],min:e,max:n}}function mV(t,e,n){const r=e[1]-e[0],i=t.map(([a,o,s,c])=>[a*r+e[0],o,s,c]);return n.removeAllPoints(),i.forEach(([a,o,s,c])=>n.addRGBPoint(a,o,s,c)),i}function vV(t,e,n){const r=e[1]-e[0],i=t.map(([a,o])=>[a*r+e[0],o]);return n.removeAllPoints(),i.forEach(([a,o])=>n.addPoint(a,o)),i}const{MPR_CAMERA_VALUES:ei}=Q5,{OrientationAxis:za}=ph;function l9(t,e,n,r){let i;switch(r){case za.AXIAL:case za.AXIAL_REFORMAT:i=ei.axial;break;case za.SAGITTAL:case za.SAGITTAL_REFORMAT:i=ei.sagittal;break;case za.CORONAL:case za.CORONAL_REFORMAT:i=ei.coronal;break;default:i=ei.axial;break}const a=gn(it(),t),o=gn(it(),e),s=gn(it(),n),c=[a,o,s],l=[Qt(i.viewRight[0],i.viewRight[1],i.viewRight[2]),Qt(i.viewUp[0],i.viewUp[1],i.viewUp[2]),Qt(i.viewPlaneNormal[0],i.viewPlaneNormal[1],i.viewPlaneNormal[2])],f=new Set,u=g=>{let y=0,x=-2,m=!1;c.forEach((w,C)=>{if(f.has(C))return;const T=zt(g,w),_=Math.abs(T);_>x&&(x=_,y=C,m=T<0)}),f.add(y);const v=D4(c[y]);return m&&Za(v,v),v},h=u(l[0]),p=u(l[1]),d=u(l[2]);return{viewPlaneNormal:[d[0],d[1],d[2]],viewUp:[p[0],p[1],p[2]],viewRight:[h[0],h[1],h[2]]}}function f9(t,e){if(!t.getActors()?.length)return;t.type!==tn.ORTHOGRAPHIC&&console.warn("Viewport should be a volume viewport");let n=t.getCurrentImageId();if(n||(n=t.getImageIds()?.[0]),!n)return;const{imageOrientationPatient:r}=nt("imagePlaneModule",n),i=Qt(r[0],r[1],r[2]),a=Qt(r[3],r[4],r[5]),o=mn(it(),i,a);let{orientation:s}=e||{};const{useViewportNormal:c}=e||{};let l=o;return c&&(l=t.getCamera().viewPlaneNormal),s||(s=yV(l)),l9(i,a,o,s)}function yV(t){const e=gn(it(),t),n=Qt(ei.axial.viewPlaneNormal[0],ei.axial.viewPlaneNormal[1],ei.axial.viewPlaneNormal[2]),r=Qt(ei.sagittal.viewPlaneNormal[0],ei.sagittal.viewPlaneNormal[1],ei.sagittal.viewPlaneNormal[2]),i=Qt(ei.coronal.viewPlaneNormal[0],ei.coronal.viewPlaneNormal[1],ei.coronal.viewPlaneNormal[2]),a=Math.abs(zt(e,n)),o=Math.abs(zt(e,r)),s=Math.abs(zt(e,i));return a>=o&&a>=s?za.AXIAL:o>=s?za.SAGITTAL:za.CORONAL}function h9(){return hc()?.rendering?.renderingEngineMode===ic.ContextPool}class au extends uc{constructor(e){if(super(e),this.useCPURendering=!1,this.perVolumeIdDefaultProperties=new Map,this.viewportProperties={},this.volumeIds=new Set,this.setRotation=i=>{const a=this.getPan(this.fitToCanvasCamera),o=this.getPan(),s=this.getCamera(),c=Rf([0,0],a,o);this.setPan(c,!1);const{flipVertical:l}=this.getCamera(),f=l?Za([0,0,0],this.initialViewUp):this.initialViewUp;this.setCameraNoEvent({viewUp:f}),this.rotateCamera(i);const u=this.getPan(),h=this.getPan(this.fitToCanvasCamera),p=Rf([0,0],u,h),d=u1([0,0],a,p);if(this.setPan(d,!1),this._suppressCameraModifiedEvents)return;const g=this.getCamera(),y={previousCamera:s,camera:g,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.CAMERA_MODIFIED,y)},this.getDefaultProperties=i=>{let a;return i!==void 0&&(a=this.perVolumeIdDefaultProperties.get(i)),a!==void 0?a:{...this.globalDefaultProperties}},this.getProperties=i=>{if(!this._getApplicableVolumeActor(i))return;const{colormap:o,VOILUTFunction:s,interpolationType:c,invert:l,slabThickness:f,preset:u}=this.viewportProperties;if(i||=this.getVolumeId(),!at.getVolume(i))return null;const p=this.getActors().find(C=>C.referencedId===i);if(!p)return;const g=p.actor.getProperty().getRGBTransferFunction(0),[y,x]=this.viewportProperties?.VOILUTFunction==="SIGMOID"?c9(g):g.getRange(),m={lower:y,upper:x},v=this.getColormap(i);return{colormap:i&&v?v:o,voiRange:m,VOILUTFunction:s,interpolationType:c,invert:l,slabThickness:f,preset:u}},this.getColormap=i=>{const a=this._getApplicableVolumeActor(i);if(!a)return;const{volumeActor:o}=a,s=this._getOrCreateColorTransferFunction(i),{nodes:c}=s.getState(),l=c.reduce((p,d)=>(p.push(d.x,d.r,d.g,d.b),p),[]),f=f1(l,o)||{},u=p1(o),h=d1(o);return f.threshold=u,f.opacity=h,f},this.getRotation=()=>{const{viewUp:i,viewPlaneNormal:a,flipVertical:o}=this.getCameraNoRotation(),s=o?Za([0,0,0],this.initialViewUp):this.initialViewUp;if(!s)return 0;const c=M4(s,i)*180/Math.PI,l=mn([0,0,0],s,i);return zt(l,a)>=0?c:(360-c)%360},this.getFrameOfReferenceUID=()=>this._FrameOfReferenceUID,this.canvasToWorldTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=this.getVtkDisplayCoordsTiled(i),f=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().displayToWorld(s[0],s[1],s[2],o);return a.setIsPerformingCoordinateTransformation?.(!1),[f[0],f[1],f[2]]},this.canvasToWorldContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),s=window.devicePixelRatio||1,{width:c,height:l}=this.canvas,f=c/l,u=[i[0]*s,i[1]*s],h=[u[0]/c,1-u[1]/l,0],p=o.normalizedDisplayToProjection(h[0],h[1],h[2]),d=o.projectionToView(p[0],p[1],p[2],f),g=o.viewToWorld(d[0],d[1],d[2]);return a.setIsPerformingCoordinateTransformation?.(!1),[g[0],g[1],g[2]]},this.getVtkDisplayCoordsTiled=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],l=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().getSize(),f=[o[0]+this.sx,o[1]+this.sy];return f[1]=l[1]-f[1],[f[0],f[1],0]},this.getVtkDisplayCoordsContextPool=i=>{const a=window.devicePixelRatio||1,o=[i[0]*a,i[1]*a],{height:s}=this.canvas,c=[o[0],s-o[1]];return[c[0],c[1],0]},this.worldToCanvasTiled=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),c=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),l=c.getSize(),f=c.worldToDisplay(...i,o);f[1]=l[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy],h=window.devicePixelRatio||1,p=[u[0]/h,u[1]/h];return a.setIsPerformingCoordinateTransformation(!1),p},this.worldToCanvasContextPool=i=>{const a=this.getVtkActiveCamera();a.setIsPerformingCoordinateTransformation?.(!0);const o=this.getRenderer(),{width:s,height:c}=this.canvas,l=s/c,f=o.worldToView(i[0],i[1],i[2]),u=o.viewToProjection(f[0],f[1],f[2],l),h=o.projectionToNormalizedDisplay(u[0],u[1],u[2]),p=h[0]*s,d=(1-h[1])*c,g=window.devicePixelRatio||1,y=[p/g,d/g];return a.setIsPerformingCoordinateTransformation(!1),y},this.hasImageURI=i=>this.getActors().filter(o=>Hr(o,"vtkVolume")).some(({uid:o,referencedId:s})=>{const c=at.getVolume(s||o);return c?.imageIds?c.imageIds.map(yi).includes(i):!1}),this.getImageIds=i=>{const a=this._getApplicableVolumeActor(i);if(!a)throw new Error(`No actor found for the given volumeId: ${i}`);const o=a.volumeId,s=at.getVolume(o);if(!s)throw new Error(`imageVolume with id: ${o} does not exist in cache`);return s.imageIds},this.renderingPipelineFunctions={worldToCanvas:{tiled:this.worldToCanvasTiled,contextPool:this.worldToCanvasContextPool},canvasToWorld:{tiled:this.canvasToWorldTiled,contextPool:this.canvasToWorldContextPool},getVtkDisplayCoords:{tiled:this.getVtkDisplayCoordsTiled,contextPool:this.getVtkDisplayCoordsContextPool},getRenderer:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},this.useCPURendering=Ac(),this.useCPURendering)throw new Error("VolumeViewports cannot be used whilst CPU Fallback Rendering is enabled.");this._configureRenderingPipeline();const n=this.getRenderer(),r=DP.newInstance();switch(n.setActiveCamera(r),this.type){case tn.ORTHOGRAPHIC:r.setParallelProjection(!0);break;case tn.VOLUME_3D:r.setParallelProjection(!0);break;case tn.PERSPECTIVE:r.setParallelProjection(!1);break;default:throw new Error(`Unrecognized viewport type: ${this.type}`)}this.initializeVolumeNewImageEventDispatcher()}static get useCustomRenderingPipeline(){return!1}getSliceViewInfo(){throw new Error("Method not implemented.")}applyViewOrientation(e,n=!0){const{viewPlaneNormal:r,viewUp:i}=this._getOrientationVectors(e)||{};if(!r||!i)return;const a=this.getVtkActiveCamera();a.setDirectionOfProjection(-r[0],-r[1],-r[2]),a.setViewUpFrom(i),this.initialViewUp=i,n&&this.resetCamera({resetOrientation:!1,resetRotation:!1})}initializeVolumeNewImageEventDispatcher(){const e=r.bind(this),n=i.bind(this);function r(a){const{viewportId:o}=a.detail;o!==this.id||this.isDisabled||!this.getImageData()||fV(a)}function i(a){const{viewportId:o}=a.detail;o===this.id&&(this.element.removeEventListener(Je.CAMERA_MODIFIED,e),vt.removeEventListener(Je.ELEMENT_DISABLED,n),lV(o))}this.element.removeEventListener(Je.CAMERA_MODIFIED,e),this.element.addEventListener(Je.CAMERA_MODIFIED,e),vt.addEventListener(Je.ELEMENT_DISABLED,n)}setVOILUTFunction(e,n,r){Object.values(ar).includes(e)||(e=ar.LINEAR);const{voiRange:i}=this.getProperties();this.setVOI(i,n,r),this.viewportProperties.VOILUTFunction=e}setColormap(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=rs.newInstance();let s=pl(e.name);const{name:c}=e;if(s||(s=fl.getPresetByName(c)),!s)throw new Error(`Colormap ${e} not found`);const l=a.getProperty().getRGBTransferFunction(0).getRange();if(o.applyColorMap(s),o.setMappingRange(l[0],l[1]),a.getProperty().setRGBTransferFunction(0,o),this.viewportProperties.colormap=e,!r){const f=this.getColormap(n),u={viewportId:this.id,colormap:f,volumeId:n};et(this.element,Je.VOI_MODIFIED,u),et(this.element,Je.COLORMAP_MODIFIED,u)}}setOpacity(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r,a=$c.newInstance();typeof e.opacity=="number"?B4(i,e.opacity):(e.opacity.forEach(({opacity:c,value:l})=>{a.addPoint(l,c)}),i.getProperty().setScalarOpacity(0,a)),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.opacity=e.opacity;const o=this.getColormap(n),s={viewportId:this.id,colormap:o,volumeId:n};et(this.element,Je.COLORMAP_MODIFIED,s)}setInvert(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const a=i.volumeId,o=this._getOrCreateColorTransferFunction(a);if(Hu(o),this.viewportProperties.invert=e,!r){const s={...this.getVOIModifiedEventDetail(a),invertStateChanged:!0};et(this.element,Je.VOI_MODIFIED,s)}}getVOIModifiedEventDetail(e){const n=this._getApplicableVolumeActor(e);if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);const a=n.volumeActor.getProperty().getRGBTransferFunction(0).getMappingRange(),o=this.getColormap(e),{VOILUTFunction:s,invert:c}=this.getProperties(e);return{viewportId:this.id,range:{lower:a[0],upper:a[1]},volumeId:n.volumeId,VOILUTFunction:s,colormap:o,invert:c}}_getOrCreateColorTransferFunction(e){const n=this._getApplicableVolumeActor(e);if(!n)return null;const{volumeActor:r}=n,i=r.getProperty().getRGBTransferFunction(0);if(i)return i;const a=rs.newInstance();return r.getProperty().setRGBTransferFunction(0,a),a}setInterpolationType(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;i.getProperty().setInterpolationType(e),this.viewportProperties.interpolationType=e}setVOI(e,n,r=!1){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i,o=i.volumeId,s=e;if(typeof s>"u")throw new Error("voiRangeToUse is undefined, need to implement this in the new volume model");const{VOILUTFunction:c}=this.getProperties(o);if(c===ar.SAMPLED_SIGMOID){const l=g1(s);a.getProperty().setRGBTransferFunction(0,l)}else{const{lower:l,upper:f}=s;a.getProperty().getRGBTransferFunction(0).setRange(l,f)}if(!r){const l={...this.getVOIModifiedEventDetail(o)};et(this.element,Je.VOI_MODIFIED,l)}this.viewportProperties.voiRange=s}rotateCamera(e){const n=e-this.getRotation();this.getVtkActiveCamera().roll(-n)}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:this.perVolumeIdDefaultProperties.set(n,e)}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perVolumeIdDefaultProperties.delete(e),this.resetToDefaultProperties(e))}getViewReference(e={}){const n=super.getViewReference(e),r=this.getVolumeId(e);if(e?.forFrameOfReference!==!1&&(n.volumeId=r),typeof e?.sliceIndex!="number")return n;const{viewPlaneNormal:i}=n,a=e?.sliceIndex-this.getSliceIndex(),{sliceRangeInfo:o}=Vc(this,r,!0),{sliceRange:s,spacingInNormalDirection:c,camera:l}=o,{focalPoint:f,position:u}=l,{newFocalPoint:h}=kc(f,u,s,i,c,a);return n.cameraFocalPoint=h,n}isReferenceViewable(e,n){if(!e.FrameOfReferenceUID||!super.isReferenceViewable(e,n))return!1;if(n?.withNavigation)return!0;const r=this.getSliceIndex(),{sliceIndex:i}=e;return Array.isArray(i)?i[0]<=r&&r<=i[1]:i===void 0||i===r}scroll(e=1){const n=this.getVolumeId(),{sliceRangeInfo:r}=Vc(this,n,!0);if(!r)return;const{sliceRange:i,spacingInNormalDirection:a,camera:o}=r,{focalPoint:s,viewPlaneNormal:c,position:l}=o,{newFocalPoint:f,newPosition:u}=kc(s,l,i,c,a,e);this.setCamera({focalPoint:f,position:u}),this.render()}setViewReference(e){if(!e)return;const n=this.getVolumeId(),{viewPlaneNormal:r,FrameOfReferenceUID:i,cameraFocalPoint:a,referencedImageId:o,viewUp:s}=e;let{sliceIndex:c}=e;const{focalPoint:l,viewPlaneNormal:f,position:u}=this.getCamera(),h=V4(f,r),p=Un(f,r);if(typeof c=="number"&&n!==void 0&&e.volumeId===n&&(h||p)){const{currentStepIndex:d,sliceRangeInfo:g,numScrollSteps:y}=Vc(this,n,!0),{sliceRange:x,spacingInNormalDirection:m}=g;h&&(c=y-c-1);const v=c-d,{newFocalPoint:w,newPosition:C}=kc(l,u,x,f,m,v);this.setCamera({focalPoint:w,position:C})}else if(i===this.getFrameOfReferenceUID()){if(r&&!h&&!p){this.setOrientation({viewPlaneNormal:r,viewUp:s}),this.setViewReference(e);return}if(o&&this.isInAcquisitionPlane()){const d=nt(Ir.IMAGE_PLANE,o),{imagePositionPatient:g}=d,{focalPoint:y}=this.getCamera(),x=Ln(it(),y,g),m=zt(x,f),v=zr(it(),y,[-f[0],-f[1],-f[2]],m);this.setCamera({focalPoint:v}),this.render();return}if(a){const d=Ln([0,0,0],a,l),g=r??f,y=zt(d,g);Un(y,0)||lr(d,g,y);const x=vi([0,0,0],l,d),m=vi([0,0,0],u,d);this.setCamera({focalPoint:x,position:m})}}else throw new Error(`Incompatible view refs: ${i}!==${this.getFrameOfReferenceUID()}`)}setThreshold(e,n){const r=this._getApplicableVolumeActor(n);if(!r)return;const{volumeActor:i}=r;G4(i,e.threshold),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.threshold=e.threshold;const a=this.getColormap(n),o={viewportId:this.id,colormap:a,volumeId:n};et(this.element,Je.COLORMAP_MODIFIED,o)}setProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,interpolationType:o,slabThickness:s}={},c,l=!1){this.globalDefaultProperties==null&&this.setDefaultProperties({voiRange:e,VOILUTFunction:n,invert:r,colormap:i,preset:a,slabThickness:s}),r!==void 0&&this.viewportProperties.invert!==r&&this.setInvert(r,c,l),i?.name&&this.setColormap(i,c,l),i?.opacity!=null&&this.setOpacity(i,c),i?.threshold!=null&&this.setThreshold(i,c),e!==void 0&&this.setVOI(e,c,l),typeof o<"u"&&this.setInterpolationType(o),n!==void 0&&this.setVOILUTFunction(n,c,l),a!==void 0&&this.setPreset(a,c,l),s!==void 0&&this.setSlabThickness(s)}resetToDefaultProperties(e){const n=this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap,e),n.colormap?.opacity!=null&&this.setOpacity(n.colormap,e),n.voiRange!==void 0&&this.setVOI(n.voiRange,e),n.VOILUTFunction!==void 0&&this.setVOILUTFunction(n.VOILUTFunction,e),n.invert!==void 0&&this.setInvert(n.invert,e),n.slabThickness!==void 0&&(this.setSlabThickness(n.slabThickness),this.viewportProperties.slabThickness=n.slabThickness),n.preset!==void 0&&this.setPreset(n.preset,e,!1),n.preset!==void 0&&this.setPreset(n.preset,e,!1),this.render()}setPreset(e,n,r){const i=this._getApplicableVolumeActor(n);if(!i)return;const{volumeActor:a}=i;let o=e;typeof o=="string"&&(o=Z5.find(s=>s.name===e)),o&&(u9(a,o),this.viewportProperties.preset=o,this.render(),r||et(this.element,Je.PRESET_MODIFIED,{viewportId:this.id,volumeId:i.volumeId,actor:a,presetName:o.name}))}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=at.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist, you need to create/allocate the volume first`);const o=a.metadata.FrameOfReferenceUID;this._isValidVolumeInputArray(e,o),this._FrameOfReferenceUID=o,e.forEach(c=>{this._addVolumeId(c.volumeId)});const s=[];for(let c=0;c<e.length;c++){const{volumeId:l,actorUID:f,slabThickness:u,...h}=e[c],p=await Xd(e[c],this.element,this.id,r),d=f||si();s.push({uid:d,actor:p,slabThickness:u,referencedId:l,...h})}this._setVolumeActors(s),this.viewportStatus=Mr.PRE_RENDER,this.initializeColorTransferFunction(e),et(this.element,Je.VOLUME_VIEWPORT_NEW_VOLUME,{viewportId:this.id,volumeActors:s}),n&&this.render()}async addVolumes(e,n=!1,r=!1){const i=at.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);const a=[];this._isValidVolumeInputArray(e,this._FrameOfReferenceUID),e.forEach(o=>{this._addVolumeId(o.volumeId)});for(let o=0;o<e.length;o++){const{volumeId:s,visibility:c,actorUID:l,slabThickness:f,...u}=e[o],h=await Xd(e[o],this.element,this.id,r);c||h.setVisibility(!1);const p=l||si();a.push({uid:p,actor:h,slabThickness:f,referencedId:s,...u})}this.addActors(a),this.initializeColorTransferFunction(e),n&&this.render()}removeVolumeActors(e,n=!1){this.removeActors(e),n&&this.render()}setOrientation(e,n=!0){console.warn('Method "setOrientation" needs implementation')}initializeColorTransferFunction(e){const n=e[0].volumeId,r=this._getOrCreateColorTransferFunction(n);!this.initialTransferFunctionNodes&&r&&(this.initialTransferFunctionNodes=Mf(r))}_getApplicableVolumeActor(e){const n=this.getActors();if(!n?.length)return;if(e){const i=n.find(a=>a.referencedId===e);return i?{volumeActor:i.actor,volumeId:e,actorUID:i.uid}:void 0}const r=n[0];return{volumeActor:r.actor,volumeId:r.referencedId,actorUID:r.uid}}async _isValidVolumeInputArray(e,n){const r=e.length;for(let i=1;i<r;i++){const a=at.getVolume(e[i].volumeId);if(n!==a.metadata.FrameOfReferenceUID)throw new Error(`Volumes being added to viewport ${this.id} do not share the same FrameOfReferenceUID. This is not yet supported`)}return!0}getBounds(){return this.getRenderer().computeVisiblePropBounds()}flip(e){super.flip(e)}hasVolumeId(e){return this.volumeIds.has(e)}hasVolumeURI(e){for(const n of this.volumeIds)if(n.includes(e))return!0;return!1}getImageData(e){if(!this.getDefaultActor())return;e||=this.getVolumeId();const r=this.getActors()?.find(s=>s.referencedId===e);if(!Hr(r,"vtkVolume"))return;const i=r.actor,a=at.getVolume(e),o=i.getMapper().getInputData();return{dimensions:o.getDimensions(),spacing:o.getSpacing(),origin:o.getOrigin(),direction:o.getDirection(),imageData:i.getMapper().getInputData(),metadata:{Modality:a?.metadata?.Modality,FrameOfReferenceUID:a?.metadata?.FrameOfReferenceUID},get scalarData(){return a?.voxelManager?.getScalarData()},scaling:a?.scaling,hasPixelSpacing:!0,voxelManager:a?.voxelManager}}setCameraClippingRange(){throw new Error("Method not implemented.")}getSliceIndex(){throw new Error("Method not implemented.")}setCamera(e,n){super.setCamera(e,n),this.setCameraClippingRange()}_setVolumeActors(e){for(let n=0;n<e.length;n++)this.viewportProperties.invert=!1;this.setActors(e)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getOrientationVectors(e){if(typeof e=="object"){if(e.viewPlaneNormal&&e.viewUp)return e;throw new Error("Invalid orientation object. It must contain viewPlaneNormal and viewUp")}else if(typeof e=="string"){if(e==="acquisition")return this._getAcquisitionPlaneOrientation();if(e==="reformat"||e.includes("_reformat"))return f9(this,{useViewportNormal:!0});if(jo[e])return this.viewportProperties.orientation=e,jo[e]}throw new Error(`Invalid orientation: ${e}. Valid orientations are: ${Object.keys(jo).join(", ")}`)}_getAcquisitionPlaneOrientation(){if(!this.getDefaultActor())return;const n=this.getVolumeId(),r=at.getVolume(n);if(!r)throw new Error(`imageVolume with id: ${n} does not exist in cache`);const{direction:i}=r,a=i.slice(6,9).map(s=>-s),o=i.slice(3,6).map(s=>-s);return{viewPlaneNormal:a,viewUp:o}}getSlabThickness(){const e=this.getActors();let n=Tn.MINIMUM_SLAB_THICKNESS;return e.forEach(r=>{r.slabThickness>n&&(n=r.slabThickness)}),n}getIntensityFromWorld(e){const n=this.getDefaultActor();if(!Hr(n,"vtkVolume"))return;const{actor:r}=n,i=r.getMapper().getInputData(),a=at.getVolume(this.getVolumeId()),o=Sh(i,e);return a.voxelManager.getAtIJKPoint(o)}getVolumeId(e){const n=this.getActors();if(!n)return;if(!e?.volumeId){const i=n.find(a=>a.actor.getClassName()==="vtkVolume");return i?.referencedId||i?.uid}const r=n.find(i=>i.actor.getClassName()==="vtkVolume"&&i.referencedId===e?.volumeId);return r?.referencedId||r?.uid}getViewReferenceId(e={}){let{volumeId:n,sliceIndex:r}=e;if(!n){const c=this.getActors();if(!c)return;n=c.find(l=>l.actor.getClassName()==="vtkVolume")?.referencedId}const i=this.getSliceIndex();r??=i;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera(),s=n.includes("?")?"&":"?";return`volumeId:${n}${s}sliceIndex=${r}&viewPlaneNormal=${a.join(",")}`}_addVolumeId(e){this.volumeIds.add(e)}getAllVolumeIds(){return Array.from(this.volumeIds)}_configureRenderingPipeline(){const e=h9();for(const n in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,n)){const r=this.renderingPipelineFunctions[n];this[n]=e?r.contextPool:r.tiled}}}function xV(t,e){e.classHierarchy.push("vtkAbstractImageMapper"),t.getIsOpaque=()=>!0,t.getCurrentImage=()=>null,t.getBoundsForSlice=()=>(J.vtkErrorMacro("vtkAbstractImageMapper.getBoundsForSlice - NOT IMPLEMENTED"),ns())}const wV={slice:0,customDisplayExtent:[0,0,0,0,0,0],useCustomExtents:!1,backgroundColor:[0,0,0,1]};function CV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wV,n),P1.extend(t,e,n),J.setGet(t,e,["slice","useCustomExtents"]),J.setGetArray(t,e,["customDisplayExtent"],6),J.setGetArray(t,e,["backgroundColor"],4),xV(t,e)}var TV={extend:CV};function p9(t,e,n){const r=n.getCurrentImage(),i=r.getExtent(),a=[i[0],i[2],i[4]],{ijkMode:o}=n.getClosestIJKAxis();let s=n.isA("vtkImageArrayMapper")?n.getSubSlice():n.getSlice();o!==n.getSlicingMode()&&(s=n.getSliceAtPosition(s)),a[o]+=s;const c=[0,0,0];r.indexToWorld(a,c),a[o]+=1;const l=[0,0,0];r.indexToWorld(a,l),l[0]-=c[0],l[1]-=c[1],l[2]-=c[2],gn(l,l);const f=hr.intersectWithLine(t,e,c,l);if(f.intersection){const u=f.x,h=[0,0,0];return r.worldToIndex(u,h),{t:f.t,absoluteIJK:h}}return null}function _V(t,e,n){const r=p9(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=[Math.round(r.absoluteIJK[0]),Math.round(r.absoluteIJK[1]),Math.round(r.absoluteIJK[2])];return o[0]<a[0]||o[0]>a[1]||o[1]<a[2]||o[1]>a[3]||o[2]<a[4]||o[2]>a[5]?null:{t:r.t,ijk:o}}return null}function SV(t,e,n){const r=p9(t,e,n);if(r){const a=n.getCurrentImage().getExtent(),o=r.absoluteIJK,s=[Math.floor(o[0]),Math.floor(o[1]),Math.floor(o[2])];if(s[0]<a[0]||s[0]>a[1]-1||s[1]<a[2]||s[1]>a[3]-1||s[2]<a[4]||s[2]>(a[5]?a[5]-1:a[5]))return null;const c=[o[0]-s[0],o[1]-s[1],o[2]-s[2]];return{t:r.t,ijk:s,pCoords:c}}return null}const{staticOffsetAPI:bV,otherStaticMethods:EV}=Rh,{SlicingMode:Bt}=Mh;function DV(t,e){e.classHierarchy.push("vtkImageMapper"),t.getSliceAtPosition=r=>{const i=t.getCurrentImage();let a;if(r.length===3)a=r;else if(Number.isFinite(r)){const f=i.getBounds();switch(e.slicingMode){case Bt.X:a=[r,(f[3]+f[2])/2,(f[5]+f[4])/2];break;case Bt.Y:a=[(f[1]+f[0])/2,r,(f[5]+f[4])/2];break;case Bt.Z:a=[(f[1]+f[0])/2,(f[3]+f[2])/2,r];break}}const o=[0,0,0];i.worldToIndex(a,o);const s=i.getExtent(),{ijkMode:c}=t.getClosestIJKAxis();let l=0;switch(c){case Bt.I:l=Gi(o[0],s[0],s[1]);break;case Bt.J:l=Gi(o[1],s[2],s[3]);break;case Bt.K:l=Gi(o[2],s[4],s[5]);break;default:return 0}return l},t.setSliceFromCamera=r=>{const i=r.getFocalPoint();switch(e.slicingMode){case Bt.I:case Bt.J:case Bt.K:{const a=t.getSliceAtPosition(i);t.setSlice(a)}break;case Bt.X:t.setSlice(i[0]);break;case Bt.Y:t.setSlice(i[1]);break;case Bt.Z:t.setSlice(i[2]);break}},t.setXSlice=r=>{t.setSlicingMode(Bt.X),t.setSlice(r)},t.setYSlice=r=>{t.setSlicingMode(Bt.Y),t.setSlice(r)},t.setZSlice=r=>{t.setSlicingMode(Bt.Z),t.setSlice(r)},t.setISlice=r=>{t.setSlicingMode(Bt.I),t.setSlice(r)},t.setJSlice=r=>{t.setSlicingMode(Bt.J),t.setSlice(r)},t.setKSlice=r=>{t.setSlicingMode(Bt.K),t.setSlice(r)},t.getSlicingModeNormal=()=>{const r=[0,0,0],i=t.getCurrentImage().getDirection();switch(e.slicingMode){case Bt.X:r[0]=1;break;case Bt.Y:r[1]=1;break;case Bt.Z:r[2]=1;break;case Bt.I:j0(i,[1,0,0],r);break;case Bt.J:j0(i,[0,1,0],r);break;case Bt.K:j0(i,[0,0,1],r);break}return r};function n(){let r;switch(e.slicingMode){case Bt.X:r=0;break;case Bt.Y:r=1;break;case Bt.Z:r=2;break;default:e.closestIJKAxis={ijkMode:e.slicingMode,flip:!1};return}const i=t.getCurrentImage().getDirection(),a=o4(i);let o=0;for(;o<3&&a[r+3*o]===0;++o);const s=a[r+3*o]<0;e.closestIJKAxis={ijkMode:o,flip:s}}t.setSlicingMode=r=>{e.slicingMode!==r&&(e.slicingMode=r,t.getCurrentImage()&&n(),t.modified())},t.getClosestIJKAxis=()=>((e.closestIJKAxis===void 0||e.closestIJKAxis.ijkMode===Bt.NONE)&&t.getCurrentImage()&&n(),e.closestIJKAxis),t.getBounds=()=>{const r=t.getCurrentImage();if(!r)return ns();if(!e.useCustomExtents)return r.getBounds();const i=e.customDisplayExtent.slice(),{ijkMode:a}=t.getClosestIJKAxis();let o=e.slice;switch(a!==e.slicingMode&&(o=t.getSliceAtPosition(e.slice)),a){case Bt.I:i[0]=o,i[1]=o;break;case Bt.J:i[2]=o,i[3]=o;break;case Bt.K:i[4]=o,i[5]=o;break}return r.extentToBounds(i)},t.getBoundsForSlice=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.slice,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=t.getCurrentImage();if(!a)return ns();const o=a.getSpatialExtent(),{ijkMode:s}=t.getClosestIJKAxis();let c=r;switch(s!==e.slicingMode&&(c=t.getSliceAtPosition(r)),s){case Bt.I:o[0]=c-i,o[1]=c+i;break;case Bt.J:o[2]=c-i,o[3]=c+i;break;case Bt.K:o[4]=c-i,o[5]=c+i;break}return a.extentToBounds(o)},t.intersectWithLineForPointPicking=(r,i)=>_V(r,i,t),t.intersectWithLineForCellPicking=(r,i)=>SV(r,i,t),t.getCurrentImage=()=>t.getInputData()}const OV={slicingMode:Bt.NONE,closestIJKAxis:{ijkMode:Bt.NONE,flip:!1},renderToRectangle:!1,sliceAtFocalPoint:!1,preferSizeOverAccuracy:!1};function d9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OV,n),TV.extend(t,e,n),J.get(t,e,["slicingMode"]),J.setGet(t,e,["closestIJKAxis","renderToRectangle","sliceAtFocalPoint","preferSizeOverAccuracy"]),Rh.implementCoincidentTopologyMethods(t,e),DV(t,e)}const RV=J.newInstance(d9,"vtkImageMapper");var MV={newInstance:RV,extend:d9,...bV,...EV,...Mh};const{InterpolationType:tf}=rM,{vtkErrorMacro:jv}=J,nf=4;function NV(t,e){e.classHierarchy.push("vtkImageProperty"),t.getMTime=()=>{let n=e.mtime,r;for(let i=0;i<nf;i++)e.componentData[i].rGBTransferFunction&&(r=e.componentData[i].rGBTransferFunction.getMTime(),n=n>r?n:r),e.componentData[i].piecewiseFunction&&(r=e.componentData[i].piecewiseFunction.getMTime(),n=n>r?n:r);return n},t.setRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].rGBTransferFunction!==a?(e.componentData[i].rGBTransferFunction=a,t.modified(),!0):!1},t.getRGBTransferFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].rGBTransferFunction},t.setPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),e.componentData[i].piecewiseFunction!==a?(e.componentData[i].piecewiseFunction=a,t.modified(),!0):!1},t.getPiecewiseFunction=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.componentData[n].piecewiseFunction},t.setScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=n,a=r;return Number.isInteger(n)||(a=n,i=0),t.setPiecewiseFunction(i,a)},t.getScalarOpacity=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.getPiecewiseFunction(n)},t.setComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(n<0||n>=nf)return jv("Invalid index"),!1;const i=Math.min(1,Math.max(0,r));return e.componentData[n].componentWeight!==i?(e.componentData[n].componentWeight=i,t.modified(),!0):!1},t.getComponentWeight=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return n<0||n>=nf?(jv("Invalid index"),0):e.componentData[n].componentWeight},t.setInterpolationTypeToNearest=()=>t.setInterpolationType(tf.NEAREST),t.setInterpolationTypeToLinear=()=>t.setInterpolationType(tf.LINEAR),t.getInterpolationTypeAsString=()=>J.enumToString(tf,e.interpolationType)}const LV={independentComponents:!1,interpolationType:tf.LINEAR,colorWindow:255,colorLevel:127.5,ambient:1,diffuse:0,opacity:1,useLookupTableScalarRange:!1,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function AV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,LV,n),J.obj(t,e),!e.componentData){e.componentData=[];for(let r=0;r<nf;r++)e.componentData.push({rGBTransferFunction:null,piecewiseFunction:null,componentWeight:1})}J.setGet(t,e,["independentComponents","interpolationType","colorWindow","colorLevel","ambient","diffuse","opacity","useLookupTableScalarRange","useLabelOutline","labelOutlineOpacity"]),J.setGetArray(t,e,["labelOutlineThickness"]),NV(t,e)}const FV=J.newInstance(AV,"vtkImageProperty");var IV={newInstance:FV};const{vtkDebugMacro:PV}=J;function VV(t,e){e.classHierarchy.push("vtkImageSlice"),t.getActors=()=>t,t.getImages=()=>t,t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();let n=e.property.getOpacity()>=1;return n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=()=>!1,t.makeProperty=IV.newInstance,t.getProperty=()=>(e.property===null&&(e.property=t.makeProperty()),e.property),t.getBounds=()=>{if(e.mapper===null)return e.bounds;const n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;const r=i=>i[0].map((a,o)=>i.map(s=>s[o]));if(!e.mapperBounds||!r([n,e.mapperBounds]).reduce((i,a)=>i&&a[0]===a[1],!0)||t.getMTime()>e.boundsMTime.getMTime()){PV("Recomputing bounds..."),e.mapperBounds=n.map(a=>a),t.computeMatrix();const i=new Float64Array(16);Rt(i,e.matrix),Kt.transformBounds(n,i,e.bounds),e.boundsMTime.modified()}return e.bounds},t.getBoundsForSlice=(n,r)=>{const i=e.mapper.getBoundsForSlice(n,r);if(!Kt.isValid(i))return i;t.computeMatrix();const a=new Float64Array(16);return Rt(a,e.matrix),Kt.transformBounds(i,a)},t.getMinXBound=()=>t.getBounds()[0],t.getMaxXBound=()=>t.getBounds()[1],t.getMinYBound=()=>t.getBounds()[2],t.getMaxYBound=()=>t.getBounds()[3],t.getMinZBound=()=>t.getBounds()[4],t.getMaxZBound=()=>t.getBounds()[5],t.getMTime=()=>{let n=e.mtime;if(e.property!==null){const r=e.property.getMTime();n=r>n?r:n}return n},t.getRedrawMTime=()=>{let n=e.mtime;if(e.mapper!==null){let r=e.mapper.getMTime();n=r>n?r:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),r=e.mapper.getInput().getMTime(),n=r>n?r:n)}if(e.property!==null){let r=e.property.getMTime();n=r>n?r:n,e.property.getRGBTransferFunction()!==null&&(r=e.property.getRGBTransferFunction().getMTime(),n=r>n?r:n)}return n},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1}const kV={mapper:null,property:null,forceOpaque:!1,forceTranslucent:!1,bounds:[...Kt.INIT_BOUNDS]};function g9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kV,n),S1.extend(t,e,n),e.boundsMTime={},J.obj(e.boundsMTime),J.set(t,e,["property"]),J.setGet(t,e,["mapper","forceOpaque","forceTranslucent"]),J.getArray(t,e,["bounds"],6),VV(t,e)}const UV=J.newInstance(g9,"vtkImageSlice");var BV={newInstance:UV,extend:g9};function GV(t){return Object.values(ar).includes(t)?t:ar.LINEAR}function m9(t){const n={...nt(Ir.IMAGE_PLANE,t)};return n.columnPixelSpacing||(n.columnPixelSpacing=1),n.rowPixelSpacing||(n.rowPixelSpacing=1),n.columnCosines||(n.columnCosines=[0,1,0]),n.rowCosines||(n.rowCosines=[1,0,0]),n.imagePositionPatient||(n.imagePositionPatient=[0,0,0]),n.imageOrientationPatient||(n.imageOrientationPatient=new Float32Array([1,0,0,0,1,0])),n}function v9(t){const e=t.imageId,{pixelRepresentation:n,bitsAllocated:r,bitsStored:i,highBit:a,photometricInterpretation:o,samplesPerPixel:s}=nt("imagePixelModule",e),{windowWidth:c,windowCenter:l,voiLUTFunction:f}=t,{modality:u}=nt("generalSeriesModule",e),h=nt("scalingModule",e),p=nt(Ir.CALIBRATION,e),d=GV(f),g=m9(e);return{calibration:p,scalingFactor:h,voiLUTFunction:d,modality:u,imagePlaneModule:g,imagePixelModule:{bitsAllocated:r,bitsStored:i,samplesPerPixel:s,highBit:a,photometricInterpretation:o,pixelRepresentation:n,windowWidth:c,windowCenter:l,modality:u,voiLUTFunction:d}}}function y9(t){const{imagePlaneModule:e,imagePixelModule:n,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o}=v9(t);let{rowCosines:s,columnCosines:c}=e;(s==null||c==null)&&(s=[1,0,0],c=[0,1,0]);const l=Qt(s[0],s[1],s[2]),f=Qt(c[0],c[1],c[2]),u=it();mn(u,l,f);let h=e.imagePositionPatient;h==null&&(h=[0,0,0]);const p=e.columnPixelSpacing||t.columnPixelSpacing,d=e.rowPixelSpacing||t.rowPixelSpacing,g=t.columns,y=t.rows,x=xi,m=1;return!n.photometricInterpretation&&t.sizeInBytes===3*t.width*t.height&&(t.numberOfComponents=3),{numberOfComponents:t.numberOfComponents||WV(n.photometricInterpretation),origin:h,direction:[...l,...f,...u],dimensions:[g,y,m],spacing:[p,d,x],numVoxels:g*y*m,imagePlaneModule:e,imagePixelModule:n,bitsAllocated:n.bitsAllocated,voiLUTFunction:r,modality:i,scalingFactor:a,calibration:o,scanAxisNormal:u}}function WV(t){let e=1;return(t==="RGB"||t?.includes("YBR")||t==="PALETTE COLOR")&&(e=3),e}var rf={exports:{}},zV=rf.exports,$v;function jV(){return $v||($v=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(zV,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(g,y){var x=g[y];if(typeof x.bind=="function")return x.bind(g);try{return Function.prototype.bind.call(x,g)}catch{return function(){return Function.prototype.apply.apply(x,[g,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?c:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function f(){for(var g=this.getLevel(),y=0;y<i.length;y++){var x=i[y];this[x]=y<g?e:this.methodFactory(x,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function u(g){return function(){typeof console!==n&&(f.call(this),this[g].apply(this,arguments))}}function h(g,y,x){return l(g)||u.apply(this,arguments)}function p(g,y){var x=this,m,v,w,C="loglevel";typeof g=="string"?C+=":"+g:typeof g=="symbol"&&(C=void 0);function T(E){var R=(i[E]||"silent").toUpperCase();if(!(typeof window===n||!C)){try{window.localStorage[C]=R;return}catch{}try{window.document.cookie=encodeURIComponent(C)+"="+R+";"}catch{}}}function _(){var E;if(!(typeof window===n||!C)){try{E=window.localStorage[C]}catch{}if(typeof E===n)try{var R=window.document.cookie,F=encodeURIComponent(C),M=R.indexOf(F+"=");M!==-1&&(E=/^([^;]+)/.exec(R.slice(M+F.length+1))[1])}catch{}return x.levels[E]===void 0&&(E=void 0),E}}function S(){if(!(typeof window===n||!C)){try{window.localStorage.removeItem(C)}catch{}try{window.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function b(E){var R=E;if(typeof R=="string"&&x.levels[R.toUpperCase()]!==void 0&&(R=x.levels[R.toUpperCase()]),typeof R=="number"&&R>=0&&R<=x.levels.SILENT)return R;throw new TypeError("log.setLevel() called with invalid level: "+E)}x.name=g,x.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},x.methodFactory=y||h,x.getLevel=function(){return w??v??m},x.setLevel=function(E,R){return w=b(E),R!==!1&&T(w),f.call(x)},x.setDefaultLevel=function(E){v=b(E),_()||x.setLevel(E,!1)},x.resetLevel=function(){w=null,S(),f.call(x)},x.enableAll=function(E){x.setLevel(x.levels.TRACE,E)},x.disableAll=function(E){x.setLevel(x.levels.SILENT,E)},x.rebuild=function(){if(o!==x&&(m=b(o.getLevel())),f.call(x),o===x)for(var E in a)a[E].rebuild()},m=b(o?o.getLevel():"WARN");var D=_();D!=null&&(w=b(D)),f.call(x)}o=new p,o.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var x=a[y];return x||(x=a[y]=new p(y,o.methodFactory)),x};var d=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=d),o},o.getLoggers=function(){return a},o.default=o,o})}(rf)),rf.exports}var $V=jV();const HV=wa($V),x9=HV.noConflict();typeof window<"u"&&(window.log=x9);function Vh(t){const e=x9.getLogger(t[0]);return e.getLogger=(...n)=>Vh(`${t}.${n.join(".")}`),e}function Q1(...t){return Vh(t.join("."))}const ou=Vh("cs3d"),e2=ou.getLogger("core"),KV=ou.getLogger("tools"),qV=ou.getLogger("dicomImageLoader"),XV=ou.getLogger("ai"),YV=ou.getLogger("examples"),JV=Q1("consistency","dicom"),ZV=Q1("consistency","image"),QV=Object.freeze(Object.defineProperty({__proto__:null,aiLog:XV,coreLog:e2,cs3dLog:ou,dicomConsistencyLog:JV,examplesLog:YV,getLogger:Q1,getRootLogger:Vh,imageConsistencyLog:ZV,loaderLog:qV,toolsLog:KV},Symbol.toStringTag,{value:"Module"}));function w9(t){const e=rs.newInstance();let n=0,r=1024;return t.lower!==void 0&&t.upper!==void 0&&(n=t.lower,r=t.upper),e.addRGBPoint(n,0,0,0),e.addRGBPoint(r,1,1,1),e}function C9(t,e){const n=e.voxelManager.getScalarData();if(!t.getPointData)return;const r=t.getPointData().getScalars().getData();if(e.color&&e.rgba){const i=new Uint8Array(e.columns*e.rows*3);for(let a=0;a<e.columns*e.rows;a++)i[a*3]=n[a*4],i[a*3+1]=n[a*4+1],i[a*3+2]=n[a*4+2];e.rgba=!1,e.getPixelData=()=>i,r.set(i)}else r.set(n);t.modified()}function Mt(){return window.performance?performance.now():Date.now()}function ek(t,e){return function(n){const r=((n-(e-.5))/(t-1)+.5)*255;return Math.min(Math.max(r,0),255)}}function tk(t){const n=Math.max(...t.lut).toString(2).length-8,r=t.lut[0]>>n,i=t.lut[t.lut.length-1]>>n,a=t.firstValueMapped+t.lut.length-1;return function(o){return o<t.firstValueMapped?r:o>=a?i:t.lut[o-t.firstValueMapped]>>n}}function T9(t,e,n){return n?tk(n):ek(t,e)}function nk(t,e,n,r,i){const a=t.maxPixelValue,o=t.minPixelValue,s=Math.min(o,0);if(t.cachedLut===void 0){const f=a-s+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(f)}const c=t.cachedLut.lutArray,l=T9(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n,i);if(r)for(let f=o;f<=a;f++)c[f+-s]=255-l(f);else for(let f=o;f<=a;f++)c[f+-s]=l(f);return c}function rk(t,e,n){let r=Mt();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-r;const a=t.minPixelValue;let o=0,s=0;const c=i.length;if(r=Mt(),a<0)for(;s<c;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=255;else for(;s<c;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-r}function ik(t,e,n){let r=Mt();const i=t.getPixelData();t.stats.lastGetPixelDataTime=Mt()-r;const a=t.minPixelValue;let o=0,s=0;const c=i.length;if(r=Mt(),a<0)for(;s<c;)n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=e[i[s++]+-a],n[o++]=i[s++];else for(;s<c;)n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=e[i[s++]],n[o++]=i[s++];t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-r}class su{constructor(){this.reset()}getMatrix(){return this.m}reset(){this.m=[1,0,0,1,0,0]}clone(){const e=new su;return e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5],e}multiply(e){const n=this.m[0]*e[0]+this.m[2]*e[1],r=this.m[1]*e[0]+this.m[3]*e[1],i=this.m[0]*e[2]+this.m[2]*e[3],a=this.m[1]*e[2]+this.m[3]*e[3],o=this.m[0]*e[4]+this.m[2]*e[5]+this.m[4],s=this.m[1]*e[4]+this.m[3]*e[5]+this.m[5];this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,r=-this.m[1]*e,i=-this.m[2]*e,a=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=o,this.m[5]=s}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.m[0]*n+this.m[2]*r,a=this.m[1]*n+this.m[3]*r,o=this.m[0]*-r+this.m[2]*n,s=this.m[1]*-r+this.m[3]*n;this.m[0]=i,this.m[1]=a,this.m[2]=o,this.m[3]=s}translate(e,n){this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n}scale(e,n){this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n}transformPoint(e){const n=e[0],r=e[1];return[n*this.m[0]+r*this.m[2]+this.m[4],n*this.m[1]+r*this.m[3]+this.m[5]]}}function yl(t,e){const n=new su;if(!t.viewport.displayedArea)return n;n.translate(t.canvas.width/2,t.canvas.height/2);const r=t.viewport.rotation;r!==0&&n.rotate(r*Math.PI/180);let i=t.viewport.scale,a=t.viewport.scale;const o=t.viewport.displayedArea.brhc.x-(t.viewport.displayedArea.tlhc.x-1),s=t.viewport.displayedArea.brhc.y-(t.viewport.displayedArea.tlhc.y-1);if(t.viewport.displayedArea.presentationSizeMode==="NONE")t.image.rowPixelSpacing<t.image.columnPixelSpacing?i*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(a*=t.image.rowPixelSpacing/t.image.columnPixelSpacing);else if(i=t.viewport.displayedArea.columnPixelSpacing,a=t.viewport.displayedArea.rowPixelSpacing,t.viewport.displayedArea.presentationSizeMode==="SCALE TO FIT"){const c=t.canvas.height/(s*a),l=t.canvas.width/(o*i);i=a=Math.min(l,c),t.viewport.displayedArea.rowPixelSpacing<t.viewport.displayedArea.columnPixelSpacing?i*=t.viewport.displayedArea.columnPixelSpacing/t.viewport.displayedArea.rowPixelSpacing:t.viewport.displayedArea.columnPixelSpacing<t.viewport.displayedArea.rowPixelSpacing&&(a*=t.viewport.displayedArea.rowPixelSpacing/t.viewport.displayedArea.columnPixelSpacing)}return n.scale(i,a),r!==0&&n.rotate(-r*Math.PI/180),n.translate(t.viewport.translation.x,t.viewport.translation.y),r!==0&&n.rotate(r*Math.PI/180),t.viewport.hflip&&n.scale(-1,1),t.viewport.vflip&&n.scale(1,-1),n.translate(-o/2,-s/2),n}function t2(t,e,n){if(t===void 0)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(e===void 0)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");const i=yl(t).getMatrix();e.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])}function n2(t,e){const n=t.renderingTools.lastRenderedImageId,r=t.renderingTools.lastRenderedViewport;return e.imageId!==n||!r||r.windowCenter!==t.viewport.voi.windowCenter||r.windowWidth!==t.viewport.voi.windowWidth||r.invert!==t.viewport.invert||r.rotation!==t.viewport.rotation||r.hflip!==t.viewport.hflip||r.vflip!==t.viewport.vflip||r.modalityLUT!==t.viewport.modalityLUT||r.voiLUT!==t.viewport.voiLUT||r.colormap!==t.viewport.colormap}function jf(t,e){const n=t.renderingTools.renderCanvas;n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);const i=r.getImageData(0,0,e.width,e.height);t.renderingTools.renderCanvasContext=r,t.renderingTools.renderCanvasData=i}function r2(t){const e=t.image.imageId,n=t.viewport,r=t.image.color;return t.renderingTools.lastRenderedImageId=e,t.renderingTools.lastRenderedIsColor=r,t.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},t.renderingTools}const _9="viewport-element",S9="cornerstone-canvas",Jd=1e-4;let Zd;function Wl(t,e=512,n=512){const r=Zd?Zd(e,n):document.createElement("canvas");return t&&(r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.imageRendering="pixelated",r.classList.add(S9),t.appendChild(r)),r}function b9(t){const e=document.createElement("div");return e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.overflow="hidden",e.classList.add(_9),t.appendChild(e),e}function ak(t){Zd=t}function oi(t){const e=`canvas.${S9}`,n=`div.${_9}`,r=t.querySelector(n)||b9(t),i=r.querySelector(e);if(i)return i;const a=Wl(r),o=r.getBoundingClientRect(),s=window.devicePixelRatio||1,c=Math.ceil(o.width*s),l=Math.ceil(o.height*s);return a.width=c,a.height=l,a}function ok(t,e){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&t.cachedLut.invert===e.invert||(nk(t,e.voi.windowWidth,e.voi.windowCenter,e.invert),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert),t.cachedLut.lutArray}function sk(t,e,n){const r=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||!r)&&(t.renderingTools.renderCanvas=Wl(null,e.width,e.height));const i=t.renderingTools.renderCanvas,{windowWidth:a,windowCenter:o}=t.viewport.voi;if((a===256||a===255)&&(o===128||o===127)&&!t.viewport.invert&&e.getCanvas&&e.getCanvas())return e.getCanvas();if(!n2(t,e)&&!n)return i;(!t.renderingTools.renderCanvasContext||i.width!==e.width||i.height!==e.height)&&jf(t,e);let s=Mt();const c=ok(e,t.viewport);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Mt()-s;const l=t.renderingTools.renderCanvasData,f=t.renderingTools.renderCanvasContext;return e.rgba?ik(e,c,l.data):rk(e,c,l.data),s=Mt(),f.putImageData(l,0,0),e.stats.lastPutImageDataTime=Mt()-s,i}function ck(t,e){if(t===void 0)throw new Error("renderColorImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("renderColorImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,t2(t,r);const i=sk(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,c=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,c,0,0,s,c),t.renderingTools=r2(t)}function uk(t,e,n){let r=Mt();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-r;const a=i.length,o=t.minPixelValue;let s=3,c=0;if(r=Mt(),i instanceof Int16Array)if(o<0)for(;c<a;)n[s]=e[i[c++]+-o],s+=4;else for(;c<a;)n[s]=e[i[c++]],s+=4;else if(i instanceof Uint16Array)for(;c<a;)n[s]=e[i[c++]],s+=4;else if(o<0)for(;c<a;)n[s]=e[i[c++]+-o],s+=4;else for(;c<a;)n[s]=e[i[c++]],s+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-r}function lk(t,e,n){let r=Mt();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-r;const a=i.length;let o=3,s=0;for(r=Mt();s<a;)n[o]=e(i[s++]),o+=4;t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-r}function fk(t,e,n){let r=Mt();const i=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-r;const a=i.length,o=t.minPixelValue;let s=0,c=0,l;if(r=Mt(),i instanceof Int16Array)if(o<0)for(;c<a;)l=e[i[c++]+-o],n[s++]=l,n[s++]=l,n[s++]=l,n[s++]=255;else for(;c<a;)l=e[i[c++]],n[s++]=l,n[s++]=l,n[s++]=l,n[s++]=255;else if(i instanceof Uint16Array)for(;c<a;)l=e[i[c++]],n[s++]=l,n[s++]=l,n[s++]=l,n[s++]=255;else if(o<0)for(;c<a;)l=e[i[c++]+-o],n[s++]=l,n[s++]=l,n[s++]=l,n[s++]=255;else for(;c<a;)l=e[i[c++]],n[s++]=l,n[s++]=l,n[s++]=l,n[s++]=255;t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-r}function hk(t,e){if(pk(t))return;const n=e.maxPixelValue*e.slope+e.intercept,r=e.minPixelValue*e.slope+e.intercept,i=n-r,a=(n+r)/2;t.voi===void 0?t.voi={windowWidth:i,windowCenter:a,voiLUTFunction:e.voiLUTFunction}:(t.voi.windowWidth=i,t.voi.windowCenter=a)}function pk(t){return t.voiLUT&&t.voiLUT.lut&&t.voiLUT.lut.length>0||t.voi.windowWidth!==void 0&&t.voi.windowCenter!==void 0}function Hv(t,e){return!t&&!e?!0:!t||!e?!1:t.id===e.id}function dk(t,e){return n=>n*t+e}function gk(t){const e=t.lut[0],n=t.lut[t.lut.length-1],r=t.firstValueMapped+t.lut.length;return i=>i<t.firstValueMapped?e:i>=r?n:t.lut[i]}function mk(t,e,n){return n?gk(n):dk(t,e)}function vk(t,e,n,r,i,a){const o=t.maxPixelValue,s=t.minPixelValue,c=Math.min(s,0);if(t.cachedLut===void 0){const h=o-c+1;t.cachedLut={},t.cachedLut.lutArray=new Uint8ClampedArray(h)}const l=t.cachedLut.lutArray,f=mk(t.slope,t.intercept,i),u=T9(e,n,a);if(t.isPreScaled)if(r)for(let h=s;h<=o;h++)l[h+-c]=255-u(h);else for(let h=s;h<=o;h++)l[h+-c]=u(h);else if(r)for(let h=s;h<=o;h++)l[h+-c]=255-u(f(h));else for(let h=s;h<=o;h++)l[h+-c]=u(f(h));return l}function E9(t,e,n){return t.cachedLut!==void 0&&t.cachedLut.windowCenter===e.voi.windowCenter&&t.cachedLut.windowWidth===e.voi.windowWidth&&Hv(t.cachedLut.modalityLUT,e.modalityLUT)&&Hv(t.cachedLut.voiLUT,e.voiLUT)&&t.cachedLut.invert===e.invert&&!n||(hk(e,t),vk(t,e.voi.windowWidth,e.voi.windowCenter,e.invert,e.modalityLUT,e.voiLUT),t.cachedLut.windowWidth=e.voi.windowWidth,t.cachedLut.windowCenter=e.voi.windowCenter,t.cachedLut.invert=e.invert,t.cachedLut.voiLUT=e.voiLUT,t.cachedLut.modalityLUT=e.modalityLUT),t.cachedLut.lutArray}function yk(t,e,n,r=!0){const i=t.renderingTools.lastRenderedIsColor;(!t.renderingTools.renderCanvas||i)&&(t.renderingTools.renderCanvas=Wl(null,e.width,e.height),jf(t,e));const a=t.renderingTools.renderCanvas;if(!n2(t,e)&&!n)return a;(a.width!==e.width||a.height!==e.height)&&jf(t,e),e.stats=e.stats||{};const o=t.renderingTools.renderCanvasData,s=t.renderingTools.renderCanvasContext;let c=Mt();e.stats.lastLutGenerateTime=Mt()-c;const{viewport:l}=t;if(l.modality==="PT"&&e.isPreScaled){const{windowWidth:f,windowCenter:u}=l.voi,h=u-f/2,g=255/(u+f/2-h);let y;l.invert?y=x=>255-(x-h)*g:y=x=>(x-h)*g,lk(e,y,o.data)}else{const f=E9(e,l,n);r?uk(e,f,o.data):fk(e,f,o.data)}return c=Mt(),s.putImageData(o,0,0),e.stats.lastPutImageDataTime=Mt()-c,a}function xk(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,t2(t,r);const i=yk(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,c=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,c,0,0,s,c),t.renderingTools=r2(t)}const Qd=0,eg=1,wk=2;function Ck(t,e,n){if(t>1)throw new Error("HSVToRGB expects hue < 1");const r=[];if(e===0)return r[0]=n,r[1]=n,r[2]=n,r;const i=Math.floor(t*6),a=6*t-i,o=n*(1-e),s=n*(1-e*a),c=n*(1-e*(1-a));switch(i){case 0:case 6:r[0]=n,r[1]=c,r[2]=o;break;case 1:r[0]=s,r[1]=n,r[2]=o;break;case 2:r[0]=o,r[1]=n,r[2]=c;break;case 3:r[0]=o,r[1]=s,r[2]=n;break;case 4:r[0]=c,r[1]=o,r[2]=n;break;case 5:r[0]=n,r[1]=o,r[2]=s;break}return r}function Tk(t,e){let n;return t<e.Range[0]?n=e.MaxIndex+Qd+1.5:t>e.Range[1]?n=e.MaxIndex+eg+1.5:n=(t+e.Shift)*e.Scale,Math.floor(n)}class i2{constructor(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}setNumberOfTableValues(e){this.NumberOfColors=e}setRamp(e){this.Ramp=e}setTableRange(e,n){this.TableRange[0]=e,this.TableRange[1]=n}setHueRange(e,n){this.HueRange[0]=e,this.HueRange[1]=n}setSaturationRange(e,n){this.SaturationRange[0]=e,this.SaturationRange[1]=n}setValueRange(e,n){this.ValueRange[0]=e,this.ValueRange[1]=n}setRange(e,n){this.InputRange[0]=e,this.InputRange[1]=n}setAlphaRange(e,n){this.AlphaRange[0]=e,this.AlphaRange[1]=n}getColor(e){return this.mapValue(e)}build(e){if(this.Table.length>1&&!e)return;this.Table=[];const n=this.NumberOfColors-1;let r,i,a,o;n?(r=(this.HueRange[1]-this.HueRange[0])/n,i=(this.SaturationRange[1]-this.SaturationRange[0])/n,a=(this.ValueRange[1]-this.ValueRange[0])/n,o=(this.AlphaRange[1]-this.AlphaRange[0])/n):r=i=a=o=0;for(let s=0;s<=n;s++){const c=this.HueRange[0]+s*r,l=this.SaturationRange[0]+s*i,f=this.ValueRange[0]+s*a,u=this.AlphaRange[0]+s*o,h=Ck(c,l,f),p=[0,0,0,0];switch(this.Ramp){case"scurve":p[0]=Math.floor(127.5*(1+Math.cos((1-h[0])*Math.PI))),p[1]=Math.floor(127.5*(1+Math.cos((1-h[1])*Math.PI))),p[2]=Math.floor(127.5*(1+Math.cos((1-h[2])*Math.PI))),p[3]=Math.floor(u*255);break;case"linear":p[0]=Math.floor(h[0]*255+.5),p[1]=Math.floor(h[1]*255+.5),p[2]=Math.floor(h[2]*255+.5),p[3]=Math.floor(u*255+.5);break;case"sqrt":p[0]=Math.floor(Math.sqrt(h[0])*255+.5),p[1]=Math.floor(Math.sqrt(h[1])*255+.5),p[2]=Math.floor(Math.sqrt(h[2])*255+.5),p[3]=Math.floor(Math.sqrt(u)*255+.5);break;default:throw new Error(`Invalid Ramp value (${this.Ramp})`)}this.Table.push(p)}this.buildSpecialColors()}buildSpecialColors(){const e=this.NumberOfColors,n=e+Qd,r=e+eg,i=e+wk;this.UseBelowRangeColor||e===0?this.Table[n]=this.BelowRangeColor:this.Table[n]=this.Table[0],this.UseAboveRangeColor||e===0?this.Table[r]=this.AboveRangeColor:this.Table[r]=this.Table[e-1],this.Table[i]=this.NaNColor}mapValue(e){const n=this.getIndex(e);if(n<0)return this.NaNColor;if(n===0){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(n===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[n]}getIndex(e){const n={Range:[],MaxIndex:this.NumberOfColors-1,Shift:-this.TableRange[0],Scale:1};if(this.TableRange[1]<=this.TableRange[0]?n.Scale=Number.MAX_VALUE:n.Scale=n.MaxIndex/(this.TableRange[1]-this.TableRange[0]),n.Range[0]=this.TableRange[0],n.Range[1]=this.TableRange[1],isNaN(e))return-1;let r=Tk(e,n);return r===this.NumberOfColors+Qd?r=0:r===this.NumberOfColors+eg&&(r=this.NumberOfColors-1),r}setTableValue(e,n,r,i,a){let o;if(typeof n=="number"&&r!==void 0&&i!==void 0&&a!==void 0)o=[n,r,i,a];else if(Array.isArray(n))o=n;else throw new Error("Invalid arguments for setTableValue");if(e<0)throw new Error(`Can't set the table value for negative index (${e})`);if(e>=this.NumberOfColors)throw new Error(`Index ${e} is greater than the number of colors ${this.NumberOfColors}`);this.Table[e]=o,(e===0||e===this.NumberOfColors-1)&&this.buildSpecialColors()}}const Kv=[0,0,0,0];function _k(t,e,n){n=n===null?100:n;const r=(e-t)/(n-1),i=[];for(;n-- >0;)i.push(t),t+=r;return i[i.length-1]=e,i}function Sk(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),a=t[i];if(a===e)return i;e<a?r=i-1:n=i+1}return n}function bk(t,e){let n;const r=[],i=e.length;for(t.sort(function(a,o){return a-o}),n=0;n<i;n++)r[n]=Sk(t,e[n]);return r}function Pp(t,e,n){let r;const i=[],a=[],o=[],s=[];for(n=n===null?1:n,r=0;r<e.length;r++){const f=e[r];i.push((t-1)*f[0]),a.push(f[1]),o.push(f[1])}const c=_k(0,1,t);for(r=0;r<t;r++)c[r]=(t-1)*Math.pow(c[r],n);const l=bk(i,c);for(r=1;r<t-1;r++){const f=l[r],u=(c[r]-i[f-1])/(i[f]-i[f-1]),h=a[f]-o[f-1];s[r]=u*h+o[f-1]}return s[0]=o[0],s[t-1]=a[e.length-1],s}function Ek(t,e,n){let r;const i=[];e=e===null?256:e,n=n===null?1:n;const a=Pp(e,t.red,n),o=Pp(e,t.green,n),s=Pp(e,t.blue,n);for(r=0;r<e;r++){const c=Math.round(a[r]*255),l=Math.round(o[r]*255),f=Math.round(s[r]*255),u=[c,l,f,255];i.push(u)}return i}function Dk(t,e){let n=Td[t];return n||(n=Td[t]={name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=Ek(n.segmentedData,n.numColors,n.gamma)),{getId(){return t},getColorSchemeName(){return n.name},setColorSchemeName(i){n.name=i},getNumberOfColors(){return n.colors.length},setNumberOfColors(i){for(;n.colors.length<i;)n.colors.push(Kv);n.colors.length=i},getColor(i){return this.isValidIndex(i)?n.colors[i]:Kv},getColorRepeating(i){const a=n.colors.length;return i=a?i%a:0,this.getColor(i)},setColor(i,a){this.isValidIndex(i)&&(n.colors[i]=a)},addColor(i){n.colors.push(i)},insertColor(i,a){this.isValidIndex(i)&&n.colors.splice(i,1,a)},removeColor(i){this.isValidIndex(i)&&n.colors.splice(i,1)},clearColors(){n.colors=[]},buildLookupTable(i){if(!i)return;const a=n.colors.length;i.setNumberOfTableValues(a);for(let o=0;o<a;o++)i.setTableValue(o,n.colors[o])},createLookupTable(){const i=new i2;return this.buildLookupTable(i),i},isValidIndex(i){return i>=0&&i<n.colors.length}}}function Ok(t,e,n,r){let i=Mt();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-i;const o=a.length,s=t.minPixelValue;let c=0,l=0,f,u,h;if(i=Mt(),n instanceof i2?h=n.Table:h=n,s<0)for(;l<o;)f=e[a[l++]+-s],u=h[f],r[c++]=u[0],r[c++]=u[1],r[c++]=u[2],r[c++]=u[3];else for(;l<o;)f=e[a[l++]],u=h[f],r[c++]=u[0],r[c++]=u[1],r[c++]=u[2],r[c++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-i}function Rk(t,e,n,r){let i=Mt();const a=t.voxelManager.getScalarData();t.stats.lastGetPixelDataTime=Mt()-i;const o=a.length,s=t.minPixelValue;let c=0,l=0,f,u,h;if(i=Mt(),n instanceof i2?h=n.Table:h=n,s<0)for(;l<o;)f=e(a[l++]+-s),u=h[f],r[c++]=u[0],r[c++]=u[1],r[c++]=u[2],r[c++]=u[3];else for(;l<o;)f=e(a[l++]),u=h[f],r[c++]=u[0],r[c++]=u[1],r[c++]=u[2],r[c++]=u[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Mt()-i}function tg(t,e,n){return Math.max(e,Math.min(n,t))}function Mk(t,e,n){t.renderingTools.renderCanvas||(t.renderingTools.renderCanvas=Wl(null,e.width,e.height));const r=t.renderingTools.renderCanvas;let i=t.viewport.colormap||t.options.colormap;if(t.options&&t.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),i&&typeof i=="string"&&(i=Dk(i)),!i)throw new Error("renderPseudoColorImage: colormap not found.");const a=i.getId();if(!n2(t,e)&&!n&&t.renderingTools.colormapId===a)return r;(!t.renderingTools.renderCanvasContext||r.width!==e.width||r.height!==e.height)&&jf(t,e);let o=Mt();(!t.renderingTools.colorLUT||n||t.renderingTools.colormapId!==a)&&(i.setNumberOfColors(256),t.renderingTools.colorLUT=i.createLookupTable(),t.renderingTools.colormapId=a);const s=t.renderingTools.renderCanvasData,c=t.renderingTools.renderCanvasContext,{viewport:l}=t,f=t.renderingTools.colorLUT;if(l.modality==="PT"){const{windowWidth:u,windowCenter:h}=l.voi,p=h-u/2,y=255/(h+u/2-p);let x;l.invert?x=m=>tg(Math.floor(255-(m-p)*y),0,255):x=m=>tg(Math.floor((m-p)*y),0,255),Rk(e,x,f,s.data)}else{const u=E9(e,t.viewport,n);e.stats=e.stats||{},e.stats.lastLutGenerateTime=Mt()-o,Ok(e,u,f,s.data)}return o=Mt(),c.putImageData(s,0,0),e.stats.lastPutImageDataTime=Mt()-o,r}function Nk(t,e){if(t===void 0)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=t.image;if(n===void 0)throw new Error("drawImage: image must be loaded before it can be drawn");const r=t.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,t.canvas.width,t.canvas.height),r.imageSmoothingEnabled=!t.viewport.pixelReplication,t2(t,r);const i=Mk(t,n,e),a=t.viewport.displayedArea.tlhc.x-1,o=t.viewport.displayedArea.tlhc.y-1,s=t.viewport.displayedArea.brhc.x-a,c=t.viewport.displayedArea.brhc.y-o;r.drawImage(i,a,o,s,c,0,0,s,c),t.renderingTools=r2(t)}function D9(t,e){const n=t.image;if(!t.canvas||!t.image)return;const r=Mt();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},n){let a=n.render;a||(t.viewport.colormap?a=Nk:n.color?a=ck:a=xk),a(t,e)}const i=Mt()-r;n.stats.lastRenderTime=i,t.invalid=!1,t.needsRedraw=!1}function O9(t){return yl(t)}function x0(t,e){const n=O9(t);return n.invert(),n.transformPoint(e)}const Lk={viewport:{}};function Ak(){return{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}}function Fk(){const t=Ak(),e={scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0,voiLUTFunction:ar.LINEAR},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:t};return Object.assign({},e,Lk.viewport)}function Yu(t,e){if(t==null)throw new Error(e)}function Ik(t){return!(t==null||t===0||t===180)}function R9(t,e=null){return Yu(t,"getImageSize: parameter image must not be undefined"),Yu(t.width,"getImageSize: parameter image must have width"),Yu(t.height,"getImageSize: parameter image must have height"),Ik(e)?{height:t.width,width:t.height}:{width:t.width,height:t.height}}function a2(t,e,n=null){Yu(t,"getImageScale: parameter canvas must not be undefined"),Yu(e,"getImageScale: parameter image must not be undefined");const r=R9(e,n),i=e.rowPixelSpacing||1,a=e.columnPixelSpacing||1;let o=1,s=1;i<a?s=a/i:o=i/a;const c=t.height/r.height/o,l=t.width/r.width/s;return{verticalScale:c,horizontalScale:l,scaleFactor:Math.min(l,c)}}function M9(t,e,n,r){if(t===void 0)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(e===void 0)return Fk();const i=a2(t,e,0).scaleFactor;let a;return n==="PT"&&e.isPreScaled?a={windowWidth:5,windowCenter:2.5}:e.windowWidth!==void 0&&e.windowCenter!==void 0&&(a={windowWidth:Array.isArray(e.windowWidth)?e.windowWidth[0]:e.windowWidth,windowCenter:Array.isArray(e.windowCenter)?e.windowCenter[0]:e.windowCenter}),{scale:i,translation:{x:0,y:0},voi:a,invert:e.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:e.modalityLUT,modality:n,voiLUT:e.voiLUT,colormap:r!==void 0?r:e.colormap,displayedArea:{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:e.rowPixelSpacing===void 0?1:e.rowPixelSpacing,columnPixelSpacing:e.columnPixelSpacing===void 0?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}}function qv(t,e){return O9(t).transformPoint(e)}function Pk(t){const{image:e}=t;t.viewport.scale=a2(t.canvas,e,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0}function Vk(t){const{canvas:e}=t,{clientWidth:n,clientHeight:r}=e;(e.width!==n||e.height!==r)&&(e.width=n,e.height=r)}function kk(t,e,n){const r=t.viewport.scale,i=R9(t.image,t.viewport.rotation),a=Math.round(i.width*r),o=Math.round(i.height*r),s=t.viewport.translation.x,c=t.viewport.translation.y;return a===e&&o<=n||a<=e&&o===n&&s===0&&c===0}function Uk(t,e,n){const r=t.viewport.scale,i=t.canvas.width,a=t.canvas.height,o=i/e,s=a/n,c=Math.sqrt(o*s);t.viewport.scale=c*r}function Bk(t,e=!1){const n=t.canvas.width,r=t.canvas.height;Vk(t),t.image!==void 0&&(e||kk(t,n,r)?Pk(t):Uk(t,n,r))}function Gk(t,e){const{hflip:n,vflip:r,rotation:i}=e;if(t.x*=n?-1:1,t.y*=r?-1:1,i!==0){const a=i*Math.PI/180,o=Math.cos(a),s=Math.sin(a),c=t.x*o-t.y*s,l=t.x*s+t.y*o;t.x=c,t.y=l}return t}function Wk(t,e=!0,n=!0){const{canvas:r,image:i,viewport:a}=t,o=a2(r,i,0).scaleFactor;a.vflip=!1,a.hflip=!1,e&&(a.translation.x=0,a.translation.y=0),n&&(a.displayedArea.tlhc.x=1,a.displayedArea.tlhc.y=1,a.displayedArea.brhc.x=i.columns,a.displayedArea.brhc.y=i.rows,a.scale=o)}const Xv=e2.getLogger("utilities","getClosestImageId");function $f(t,e,n,r){const{direction:i,spacing:a,imageIds:o}=t,{ignoreSpacing:s=!1}=r||{};if(!o?.length)return;const c=i.slice(6,9),l=zt(c,n);if(Math.abs(l)<1-xi)return;let f;s||(f=Gl({direction:i,spacing:a},n)/2);let u,h=1/0;for(let p=0;p<o.length;p++){const d=o[p],g=nt("imagePlaneModule",d);if(!g?.imagePositionPatient){Xv.warn(`Missing imagePositionPatient for imageId: ${d}`);continue}const{imagePositionPatient:y}=g,x=it();Bn(x,e,y);const m=Math.abs(zt(x,n));s?m<h&&(h=m,u=d):m<f&&m<h&&(h=m,u=d)}return u===void 0&&Xv.warn("No imageId found within the specified criteria (half spacing or absolute closest)."),u}function zk(t,e){const n=zt(t,e),r=lr(it(),e,2*n);return Bn(it(),t,r)}function Yv(t,e,n,r){let i=D4(t);if(n&&Za(i,i),e){const a=mn(it(),r,i);gn(a,a),i=zk(i,a)}return i}const Jv=e2.getLogger("RenderingEngine","StackViewport");class io extends uc{constructor(e){super(e),this.imageIds=[],this.imageKeyToIndexMap=new Map,this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.imagesLoader=this,this.globalDefaultProperties={},this.perImageIdDefaultProperties=new Map,this.voiUpdatedWithSetProperties=!1,this.invert=!1,this.initialInvert=!1,this.initialTransferFunctionNodes=null,this.stackInvalidated=!1,this._publishCalibratedEvent=!1,this.updateRenderingPipeline=()=>{this._configureRenderingPipeline()},this.resize=()=>{this.useCPURendering&&this._resizeCPU()},this._resizeCPU=()=>{this._cpuFallbackEnabledElement.viewport&&Bk(this._cpuFallbackEnabledElement)},this.getFrameOfReferenceUID=n=>this.getImagePlaneReferenceData(n)?.FrameOfReferenceUID,this.getCornerstoneImage=()=>this.csImage,this.createActorMapper=n=>{const r=MV.newInstance();r.setInputData(n);const i=BV.newInstance();i.setMapper(r);const{preferSizeOverAccuracy:a}=hc().rendering;return a&&r.setPreferSizeOverAccuracy(!0),n.getPointData().getScalars().getNumberOfComponents()>1&&i.getProperty().setIndependentComponents(!1),i},this.getNumberOfSlices=()=>this.imageIds.length,this.getDefaultProperties=n=>{let r;return n!==void 0&&(r=this.perImageIdDefaultProperties.get(n)),r!==void 0?r:{...this.globalDefaultProperties}},this.getProperties=()=>{const{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,voiUpdatedWithSetProperties:s}=this;return{colormap:n,voiRange:r,VOILUTFunction:i,interpolationType:a,invert:o,isComputedVOI:!s}},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,suppressEvents:!0}),this.getRotationCPU=()=>{const{viewport:n}=this._cpuFallbackEnabledElement;return n.rotation},this.getRotationGPU=()=>{const{viewUp:n,viewPlaneNormal:r,flipVertical:i,flipHorizontal:a}=this.getCameraNoRotation(),o=Yv(this.initialViewUp,a,i,r),c=M4(o,n)*180/Math.PI,l=mn(it(),o,n);return zt(l,r)>=0?c:(360-c)%360},this.setRotation=n=>{const r=this.getCamera();if(this.useCPURendering?this.setRotationCPU(n):this.setRotationGPU(n),this._suppressCameraModifiedEvents)return;const i=this.getCamera(),a={previousCamera:r,camera:i,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.CAMERA_MODIFIED,a)},this.renderImageObject=n=>{this._setCSImage(n),(this.useCPURendering?this._updateToDisplayImageCPU:this._updateActorToDisplayImageId).call(this,n)},this._setCSImage=n=>{n.isPreScaled=n.preScale?.scaled,this.csImage=n},this.canvasToWorldCPU=(n,r=[0,0,0])=>{if(!this._cpuFallbackEnabledElement.image)return;const[i,a]=x0(this._cpuFallbackEnabledElement,n),{origin:o,spacing:s,direction:c}=this.getImageData(),l=c.slice(0,3),f=c.slice(3,6);return zr(r,o,l,i*s[0]),zr(r,r,f,a*s[1]),r},this.worldToCanvasCPU=n=>{const{spacing:r,direction:i,origin:a}=this.getImageData(),o=i.slice(0,3),s=i.slice(3,6),c=Ln(it(),n,a),l=[zt(c,o)/r[0],zt(c,s)/r[1]];return qv(this._cpuFallbackEnabledElement,l)},this.canvasToWorldGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:c,height:l}=this.canvas,f=c/l,u=[n[0]*s,n[1]*s],h=[u[0]/c,1-u[1]/l,0],p=r.normalizedDisplayToProjection(h[0],h[1],h[2]),d=r.projectionToView(p[0],p[1],p[2],f),g=r.viewToWorld(d[0],d[1],d[2]);return i.setClippingRange(a[0],a[1]),[g[0],g[1],g[2]]},this.canvasToWorldGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const c=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),l=c.getSize(),f=window.devicePixelRatio||1,u=[n[0]*f,n[1]*f],h=[u[0]+this.sx,u[1]+this.sy];h[1]=l[1]-h[1];const p=c.displayToWorld(h[0],h[1],0,r);return i.setClippingRange(a[0],a[1]),[p[0],p[1],p[2]]},this.worldToCanvasGPUContextPool=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const s=window.devicePixelRatio||1,{width:c,height:l}=this.canvas,f=c/l,u=r.worldToView(n[0],n[1],n[2]),h=r.viewToProjection(u[0],u[1],u[2],f),p=r.projectionToNormalizedDisplay(h[0],h[1],h[2]),d=p[0]*c,g=(1-p[1])*l;return i.setClippingRange(a[0],a[1]),[d/s,g/s]},this.worldToCanvasGPUTiled=n=>{const r=this.getRenderer(),i=this.getVtkActiveCamera(),a=i.getClippingRange(),o=i.getDistance();i.setClippingRange(o,o+.1);const c=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),l=c.getSize(),f=c.worldToDisplay(...n,r);f[1]=l[1]-f[1];const u=[f[0]-this.sx,f[1]-this.sy];i.setClippingRange(a[0],a[1]);const h=window.devicePixelRatio||1;return[u[0]/h,u[1]/h]},this.getCurrentImageIdIndex=()=>this.currentImageIdIndex,this.getSliceIndex=()=>this.currentImageIdIndex,this.getTargetImageIdIndex=()=>this.targetImageIdIndex,this.getImageIds=()=>this.imageIds,this.getCurrentImageId=(n=this.getCurrentImageIdIndex())=>this.imageIds[n],this.hasImageId=n=>this.imageKeyToIndexMap.has(n),this.hasImageURI=n=>this.imageKeyToIndexMap.has(n),this.customRenderViewportToCanvas=()=>{if(!this.useCPURendering)throw new Error("Custom cpu rendering pipeline should only be hit in CPU rendering mode");return this._cpuFallbackEnabledElement.image?(D9(this._cpuFallbackEnabledElement,this.cpuRenderingInvalidated),this.cpuRenderingInvalidated=!1):this.fillWithBackgroundColor(),{canvas:this.canvas,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,viewportStatus:this.viewportStatus}},this.renderingPipelineFunctions={getImageData:{cpu:this.getImageDataCPU,gpu:this.getImageDataGPU},setColormap:{cpu:this.setColormapCPU,gpu:this.setColormapGPU},getCamera:{cpu:this.getCameraCPU,gpu:super.getCamera},setCamera:{cpu:this.setCameraCPU,gpu:super.setCamera},getPan:{cpu:this.getPanCPU,gpu:super.getPan},setPan:{cpu:this.setPanCPU,gpu:super.setPan},getZoom:{cpu:this.getZoomCPU,gpu:super.getZoom},setZoom:{cpu:this.setZoomCPU,gpu:super.setZoom},setVOI:{cpu:this.setVOICPU,gpu:this.setVOIGPU},getRotation:{cpu:this.getRotationCPU,gpu:this.getRotationGPU},setInterpolationType:{cpu:this.setInterpolationTypeCPU,gpu:this.setInterpolationTypeGPU},setInvertColor:{cpu:this.setInvertColorCPU,gpu:this.setInvertColorGPU},resetCamera:{cpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraCPU({resetPan:r,resetZoom:i}),!0},gpu:(n={})=>{const{resetPan:r=!0,resetZoom:i=!0}=n;return this.resetCameraGPU({resetPan:r,resetZoom:i}),!0}},canvasToWorld:{cpu:this.canvasToWorldCPU,gpu:{tiled:this.canvasToWorldGPUTiled,contextPool:this.canvasToWorldGPUContextPool}},worldToCanvas:{cpu:this.worldToCanvasCPU,gpu:{tiled:this.worldToCanvasGPUTiled,contextPool:this.worldToCanvasGPUContextPool}},getRenderer:{cpu:()=>this.getCPUFallbackError("getRenderer"),gpu:{tiled:this.getRendererTiled,contextPool:this.getRendererContextPool}},getDefaultActor:{cpu:()=>this.getCPUFallbackError("getDefaultActor"),gpu:super.getDefaultActor},getActors:{cpu:()=>this.getCPUFallbackError("getActors"),gpu:super.getActors},getActor:{cpu:()=>this.getCPUFallbackError("getActor"),gpu:super.getActor},setActors:{cpu:()=>this.getCPUFallbackError("setActors"),gpu:super.setActors},addActors:{cpu:()=>this.getCPUFallbackError("addActors"),gpu:super.addActors},addActor:{cpu:()=>this.getCPUFallbackError("addActor"),gpu:super.addActor},removeAllActors:{cpu:()=>this.getCPUFallbackError("removeAllActors"),gpu:super.removeAllActors},unsetColormap:{cpu:this.unsetColormapCPU,gpu:this.unsetColormapGPU}},this.scaling={},this.modality=null,this.useCPURendering=Ac(),this._configureRenderingPipeline(),this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport(),this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.resetCamera(),this.initializeElementDisabledHandler()}setUseCPURendering(e){this.useCPURendering=e,this._configureRenderingPipeline(e)}static get useCustomRenderingPipeline(){return Ac()}_configureRenderingPipeline(e){const n=h9();this.useCPURendering=e??Ac();for(const r in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,r)){const i=this.renderingPipelineFunctions[r];this.useCPURendering?this[r]=i.cpu:typeof i.gpu=="object"&&i.gpu.tiled&&i.gpu.contextPool?this[r]=n?i.gpu.contextPool:i.gpu.tiled:this[r]=i.gpu}this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport()}_resetCPUFallbackElement(){this._cpuFallbackEnabledElement={canvas:this.canvas,renderingTools:{},transform:new su,viewport:{rotation:0}}}_resetGPUViewport(){const e=this.getRenderer(),n=U1.newInstance();e.setActiveCamera(n),this.initialViewUp=[0,-1,0],n.setDirectionOfProjection(-0,-0,1),n.setViewUp(...this.initialViewUp),n.setParallelProjection(!0),n.setThicknessFromFocalPoint(.1),n.setFreezeFocalPoint(!0)}initializeElementDisabledHandler(){vt.addEventListener(Je.ELEMENT_DISABLED,function e(){clearTimeout(this.debouncedTimeout),vt.removeEventListener(Je.ELEMENT_DISABLED,e)})}getImageDataGPU(){const e=this.getDefaultActor();if(!e||!ki(e))return;const{actor:n}=e,r=n.getMapper().getInputData(),i=this.csImage;return{dimensions:r.getDimensions(),spacing:r.getSpacing(),origin:r.getOrigin(),direction:r.getDirection(),get scalarData(){return i?.voxelManager.getScalarData()},imageData:n.getMapper().getInputData(),metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,hasPixelSpacing:this.hasPixelSpacing,calibration:{...i?.calibration,...this.calibration},preScale:{...i?.preScale},voxelManager:i?.voxelManager}}getImageDataCPU(){const{metadata:e}=this._cpuFallbackEnabledElement;if(!e)return;const n=e.spacing,r=this.csImage;return{dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,imageData:{getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getScalarData:()=>this.cpuImagePixelData,getSpacing:()=>n,worldToIndex:i=>{const a=this.worldToCanvasCPU(i),o=x0(this._cpuFallbackEnabledElement,a);return[o[0],o[1],0]},indexToWorld:(i,a)=>{const o=qv(this._cpuFallbackEnabledElement,[i[0],i[1]]);return this.canvasToWorldCPU(o,a)}},scalarData:this.cpuImagePixelData,hasPixelSpacing:this.hasPixelSpacing,calibration:{...r?.calibration,...this.calibration},preScale:{...r?.preScale},voxelManager:r?.voxelManager}}calibrateIfNecessary(e,n){const r=nt("calibratedPixelSpacing",e),i=this.calibration!==r,{scale:a}=r||{};return this.hasPixelSpacing=a>0||n.rowPixelSpacing>0,n.calibration=r,i&&(this.calibration=r,this._publishCalibratedEvent=!0,this._calibrationEvent={scale:a,calibration:r}),n}setDefaultProperties(e,n){n==null?this.globalDefaultProperties=e:(this.perImageIdDefaultProperties.set(n,e),this.getCurrentImageId()===n&&this.setProperties(e))}clearDefaultProperties(e){e==null?(this.globalDefaultProperties={},this.resetProperties()):(this.perImageIdDefaultProperties.delete(e),this.resetToDefaultProperties())}setProperties({colormap:e,voiRange:n,VOILUTFunction:r,invert:i,interpolationType:a}={},o=!1){this.viewportStatus=this.csImage?Mr.PRE_RENDER:Mr.LOADING,this.globalDefaultProperties={colormap:this.globalDefaultProperties.colormap??e,voiRange:this.globalDefaultProperties.voiRange??n,VOILUTFunction:this.globalDefaultProperties.VOILUTFunction??r,invert:this.globalDefaultProperties.invert??i,interpolationType:this.globalDefaultProperties.interpolationType??a},typeof e<"u"&&this.setColormap(e),typeof n<"u"&&this.setVOI(n,{suppressEvents:o,voiUpdatedWithSetProperties:!0}),typeof r<"u"&&this.setVOILUTFunction(r,o),typeof i<"u"&&this.setInvertColor(i),typeof a<"u"&&this.setInterpolationType(a)}resetProperties(){this.cpuRenderingInvalidated=!0,this.voiUpdatedWithSetProperties=!1,this.viewportStatus=Mr.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={}),this._resetProperties(),this.render()}_resetProperties(){let e;if(this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage(),this.setVOI(e),this.setInvertColor(this.initialInvert),this.setInterpolationType(Ka.LINEAR),!this.useCPURendering){const n=this.getTransferFunction();bh(n,this.initialTransferFunctionNodes);const i=Mf(n).reduce((s,c)=>(s.push(c[0],c[1],c[2],c[3]),s),[]),a=this.getDefaultActor(),o=f1(i,a.actor);this.setColormap(o)}}resetToDefaultProperties(){this.cpuRenderingInvalidated=!0,this.viewportStatus=Mr.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={});const e=this.getCurrentImageId(),n=this.perImageIdDefaultProperties.get(e)||this.globalDefaultProperties;n.colormap?.name&&this.setColormap(n.colormap);let r;n.voiRange==null?r=this._getVOIRangeForCurrentImage():r=n.voiRange,this.setVOI(r),this.setInterpolationType(Ka.LINEAR),this.setInvertColor(!1),this.render()}_getVOIFromCache(){let e;return this.voiUpdatedWithSetProperties?e=this.voiRange:this._isCurrentImagePTPrescaled()?e=this._getDefaultPTPrescaledVOIRange():e=this._getVOIRangeForCurrentImage()??this.voiRange,e}_setPropertiesFromCache(){const e=this._getVOIFromCache(),{interpolationType:n,invert:r}=this;this.setVOI(e),this.setInterpolationType(n),this.setInvertColor(r)}getCameraCPU(){const{metadata:e,viewport:n}=this._cpuFallbackEnabledElement;if(!e)return{};const{direction:r}=e,i=r.slice(6,9).map(u=>-u);let a=r.slice(3,6).map(u=>-u);if(n.rotation){const u=o1(ma(),n.rotation*Math.PI/180,i);a=Dt(it(),a,u)}const o=[this.element.clientWidth/2,this.element.clientHeight/2],s=this.canvasToWorld(o),c=this.canvasToWorld([0,0]),l=this.canvasToWorld([0,this.element.clientHeight]),f=O4(c,l)/2;return{parallelProjection:!0,focalPoint:s,position:[0,0,0],parallelScale:f,scale:n.scale,viewPlaneNormal:[i[0],i[1],i[2]],viewUp:[a[0],a[1],a[2]],flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}setCameraCPU(e){const{viewport:n,image:r}=this._cpuFallbackEnabledElement,i=this.getCameraCPU(),{focalPoint:a,parallelScale:o,scale:s,flipHorizontal:c,flipVertical:l}=e,{clientHeight:f}=this.element;if(a){const h=this.worldToCanvasCPU(a),p=x0(this._cpuFallbackEnabledElement,h),d=this.worldToCanvasCPU(i.focalPoint),g=x0(this._cpuFallbackEnabledElement,d),y=A4();Of(y,qm(p[0],p[1]),qm(g[0],g[1]));const x=Gk({x:y[0],y:y[1]},n);n.translation.x-=x.x,n.translation.y-=x.y}if(o){const{rowPixelSpacing:h}=r,p=f*h*.5/o;n.scale=p,n.parallelScale=o}if(s){const{rowPixelSpacing:h}=r;n.scale=s,n.parallelScale=f*h*.5/s}(c!==void 0||l!==void 0)&&this.setFlipCPU({flipHorizontal:c,flipVertical:l}),this._cpuFallbackEnabledElement.transform=yl(this._cpuFallbackEnabledElement);const u={previousCamera:i,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.CAMERA_MODIFIED,u)}getPanCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return[e.translation.x,e.translation.y]}setPanCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,focalPoint:[...e.map(r=>-r),0]})}getZoomCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return e.scale}setZoomCPU(e){const n=this.getCameraCPU();this.setCameraCPU({...n,scale:e})}setFlipCPU({flipHorizontal:e,flipVertical:n}){const{viewport:r}=this._cpuFallbackEnabledElement;e!==void 0&&(r.hflip=e,this.flipHorizontal=r.hflip),n!==void 0&&(r.vflip=n,this.flipVertical=r.vflip)}setVOILUTFunction(e,n){if(this.useCPURendering)throw new Error("VOI LUT function is not supported in CPU rendering");const r=this._getValidVOILUTFunction(e);let i=!1;this.VOILUTFunction!==r&&(i=!0),this.VOILUTFunction=r;const{voiRange:a}=this.getProperties();this.setVOI(a,{suppressEvents:n,forceRecreateLUTFunction:i})}setRotationCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.rotation=e}setRotationGPU(e){const n=this.getPan(this.fitToCanvasCamera),r=this.getPan(),i=Rf([0,0],n,r);this.setPan(i,!1);const{flipVertical:a,flipHorizontal:o,viewPlaneNormal:s}=this.getCamera(),c=Yv(this.initialViewUp,o,a,s);this.setCameraNoEvent({viewUp:c}),this.getVtkActiveCamera().roll(-e);const l=this.getPan(),f=this.getPan(this.fitToCanvasCamera),u=Rf([0,0],l,f),h=u1([0,0],n,u);this.setPan(h,!1)}setInterpolationTypeGPU(e){const n=this.getDefaultActor();if(!n||!ki(n))return;const{actor:r}=n;r.getProperty().setInterpolationType(e),this.interpolationType=e}setInterpolationTypeCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n.pixelReplication=e!==Ka.LINEAR,this.interpolationType=e}setInvertColorCPU(e){const{viewport:n}=this._cpuFallbackEnabledElement;n&&(n.invert=e,this.invert=e)}setInvertColorGPU(e){const n=this.getDefaultActor();if(n&&ki(n)){if(Hr(n,"vtkVolume")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&Hu(i),this.invert=e}else if(Hr(n,"vtkImageSlice")){const i=n.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&Hu(i),this.invert=e}}}setVOICPU(e,n={}){const{suppressEvents:r=!1}=n,{viewport:i,image:a}=this._cpuFallbackEnabledElement;if(!i||!a)return;if(typeof e>"u"){const{windowWidth:s,windowCenter:c}=a,l=Array.isArray(s)?s[0]:s,f=Array.isArray(c)?c[0]:c;i.voi={windowWidth:l,windowCenter:f,voiLUTFunction:a.voiLUTFunction};const{lower:u,upper:h}=Ku(l,f,a.voiLUTFunction);e={lower:u,upper:h}}else{const{lower:s,upper:c}=e,{windowCenter:l,windowWidth:f}=_h(s,c);i.voi||(i.voi={windowWidth:0,windowCenter:0,voiLUTFunction:a.voiLUTFunction}),i.voi.windowWidth=f,i.voi.windowCenter=l}this.voiRange=e;const o={viewportId:this.id,range:e};r||et(this.element,Je.VOI_MODIFIED,o)}getTransferFunction(){const e=this.getDefaultActor();return!e||!ki(e)?void 0:e.actor.getProperty().getRGBTransferFunction(0)}setVOIGPU(e,n={}){const{suppressEvents:r=!1,forceRecreateLUTFunction:i=!1,voiUpdatedWithSetProperties:a=!1}=n;if(e&&this.voiRange&&this.voiRange.lower===e.lower&&this.voiRange.upper===e.upper&&!i&&!this.stackInvalidated)return;const o=this.getDefaultActor();if(!o||!ki(o))return;const s=o.actor;let c=e;if(typeof c>"u"){const p=s.getMapper().getInputData().getPointData().getScalars().getRange();c={lower:p[0],upper:p[1]}}s.getProperty().setUseLookupTableScalarRange(!0);let l=s.getProperty().getRGBTransferFunction(0);const f=this.VOILUTFunction===ar.SAMPLED_SIGMOID;if((f||!l||i)&&(l=(f?g1:w9)(c),this.invert&&Hu(l),s.getProperty().setRGBTransferFunction(0,l),this.initialTransferFunctionNodes=Mf(l)),f||l.setRange(c.lower,c.upper),this.voiRange=c,this.voiUpdatedWithSetProperties||(this.voiUpdatedWithSetProperties=a),r)return;const u={viewportId:this.id,range:c,VOILUTFunction:this.VOILUTFunction};et(this.element,Je.VOI_MODIFIED,u)}_addScalingToViewport(e){if(this.scaling.PT)return;const{suvbw:n,suvlbm:r,suvbsa:i}=e,a={};r&&(a.suvbwToSuvlbm=r/n),i&&(a.suvbwToSuvbsa=i/n),this.scaling.PT=a}getImageDataMetadata(e){const n=e.imageId,r=y9(e),{numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:c,numVoxels:l,imagePixelModule:f,voiLUTFunction:u,modality:h,scalingFactor:p,calibration:d}=r;h==="PT"&&p&&this._addScalingToViewport(p),this.modality=h;const g=this._getValidVOILUTFunction(u);this.VOILUTFunction=g,this.calibration=d;let y=this._getImagePlaneModule(n);return this.useCPURendering||(y=this.calibrateIfNecessary(n,y)),{bitsAllocated:f.bitsAllocated,numberOfComponents:i,origin:a,direction:o,dimensions:s,spacing:c,numVoxels:l,imagePlaneModule:y,imagePixelModule:f}}matchImagesForOverlay(e,n){return(i=>{const a=nt(Ir.IMAGE_PLANE,n),o=nt(Ir.IMAGE_PLANE,i),s=a.imageOrientationPatient,c=o.imageOrientationPatient;if(s&&c){if(Un(a.imageOrientationPatient,o.imageOrientationPatient)){const f=a.imagePositionPatient,u=o.imagePositionPatient;if(f&&u&&Un(f,u)){const p=a.rows,d=a.columns,g=o.rows,y=o.columns;if(p===g&&d===y)return i}}}else{const l=a.rows,f=a.columns,u=o.rows,h=o.columns;if(l===u&&f===h)return i}})(e)}getImagePlaneReferenceData(e=this.getCurrentImageIdIndex()){const n=this.imageIds[e];if(!n)return;const r=nt(Ir.IMAGE_PLANE,n);if(!r)return;const{imagePositionPatient:i,frameOfReferenceUID:a}=r;let{rowCosines:o,columnCosines:s}=r;o||=[1,0,0],s||=[0,1,0];const c=mn([0,0,0],s,o);return{FrameOfReferenceUID:a,viewPlaneNormal:c,cameraFocalPoint:i,referencedImageId:n,sliceIndex:e}}_getCameraOrientation(e){const n=e.slice(6,9).map(i=>-i),r=e.slice(3,6).map(i=>-i);return{viewPlaneNormal:[n[0],n[1],n[2]],viewUp:[r[0],r[1],r[2]]}}createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){const s=new o.constructor(o.length),c=ft.newInstance({name:"Pixels",numberOfComponents:a,values:s}),l=L1.newInstance();return l.setDimensions(r),l.setSpacing(i),l.setDirection(n),l.setOrigin(e),l.getPointData().setScalars(c),l}_createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o}){try{this._imageData=this.createVTKImageData({origin:e,direction:n,dimensions:r,spacing:i,numberOfComponents:a,pixelArray:o})}catch(s){Jv.error(s)}}async setStack(e,n=0){if(this._throwIfDestroyed(),this.imageIds=e,n>e.length)throw new Error("Current image index is greater than the number of images in the stack");this.imageKeyToIndexMap.clear(),e.forEach((o,s)=>{this.imageKeyToIndexMap.set(o,s),this.imageKeyToIndexMap.set(yi(o),s)}),this.currentImageIdIndex=n,this.targetImageIdIndex=n;const r=nt(qc.IMAGE_RETRIEVE_CONFIGURATION,e[n],"stack");this.imagesLoader=r?(r.create||H6)(r):this,this.stackInvalidated=!0,this.flipVertical=!1,this.flipHorizontal=!1,this.voiRange=null,this.interpolationType=Ka.LINEAR,this.invert=!1,this.viewportStatus=Mr.LOADING,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={},delete this._cpuFallbackEnabledElement.viewport.colormap);const i=await this._setImageIdIndex(n),a={imageIds:e,viewportId:this.id,element:this.element,currentImageIdIndex:n};return et(this.element,Je.VIEWPORT_NEW_IMAGE_SET,a),i}_throwIfDestroyed(){if(this.isDisabled)throw new Error("The stack viewport has been destroyed and is no longer usable. Renderings will not be performed. If you are using the same viewportId and have re-enabled the viewport, you need to grab the new viewport instance using renderingEngine.getViewport(viewportId), instead of using your lexical scoped reference to the viewport instance.")}_checkVTKImageDataMatchesCornerstoneImage(e,n){if(!n)return!1;const[r,i]=n.getSpacing(),[a,o]=n.getDimensions(),s=this._getImagePlaneModule(e.imageId),c=n.getDirection(),l=c.slice(0,3),f=c.slice(3,6),u=n.getPointData().getScalars().getDataType(),h=Un(r,e.columnPixelSpacing),p=Un(i,e.rowPixelSpacing),d=h||e.columnPixelSpacing===null&&r===1,g=p||e.rowPixelSpacing===null&&i===1,y=a===e.columns,x=o===e.rows,m=Un(s.rowCosines,l),v=Un(s.columnCosines,f),w=u===e.voxelManager.getScalarData().constructor.name;return d&&g&&y&&x&&m&&v&&w}_updateVTKImageDataFromCornerstoneImage(e){let r=this._getImagePlaneModule(e.imageId).imagePositionPatient;r==null&&(r=[0,0,0]),this._imageData.setOrigin(r);const i=this.getActor(this.id);i&&(i.referencedId=e.imageId),C9(this._imageData,e)}_loadAndDisplayImage(e,n){return this.useCPURendering?this._loadAndDisplayImageCPU(e,n):this._loadAndDisplayImageGPU(e,n)}_loadAndDisplayImageCPU(e,n){return new Promise((r,i)=>{function a(p,d,g){if(this.currentImageIdIndex!==d)return;const y=p.voxelManager.getScalarData(),x=p.preScale,m=x?.scalingParameters,v=x?.scaled&&m?.rescaleIntercept%1!==0||m?.rescaleSlope%1!==0;if(y instanceof Float32Array&&v){const C={min:p.minPixelValue,max:p.maxPixelValue},S=Math.abs(C.max-C.min)/65535,b=C.min,D=y.length,E=new Uint16Array(D);let R=65535,F=0;for(let M=0;M<D;M++){const U=Math.floor((y[M]-b)/S);E[M]=U,R=Math.min(R,U),F=Math.max(F,U)}p.minPixelValue=R,p.maxPixelValue=F,p.slope=S,p.intercept=b,p.voxelManager?p.voxelManager.getScalarData=()=>E:p.getPixelData=()=>E,p.preScale={...p.preScale,scaled:!1}}this._setCSImage(p),this.viewportStatus=Mr.PRE_RENDER;const w={image:p,imageId:g,imageIdIndex:d,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.STACK_NEW_IMAGE,w),this._updateToDisplayImageCPU(p),this.render(),this.currentImageIdIndex=d,r(g)}function o(p,d,g){const y={error:p,imageIdIndex:d,imageId:g};this.suppressEvents||et(vt,Je.IMAGE_LOAD_ERROR,y),i(p)}function s(p,d,g){return ro(p,g).then(y=>{a.call(this,y,d,p)},y=>{o.call(this,y,d,p)})}const c=-5,l=St.Interaction,f={imageId:e,imageIdIndex:n},u={useRGBA:!0,requestType:l},h={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};et(this.element,Je.PRE_STACK_NEW_IMAGE,h),Pr.addRequest(s.bind(this,e,n,u),l,f,c)})}successCallback(e,n){const r=this.imageIds.indexOf(e);if(this.currentImageIdIndex!==r)return;const i=this.csImage?.imageFrame,a=n?.imageFrame,o=i?.photometricInterpretation||this.csImage?.photometricInterpretation,s=a?.photometricInterpretation||n?.photometricInterpretation;o!==s&&(this.stackInvalidated=!0),this._setCSImage(n);const c={image:n,imageId:e,imageIdIndex:r,viewportId:this.id,renderingEngineId:this.renderingEngineId};this._updateActorToDisplayImageId(n),et(this.element,Je.STACK_NEW_IMAGE,c),this.render(),this.currentImageIdIndex=r}errorCallback(e,n,r){if(!n)return;const i=this.imageIds.indexOf(e),a={error:r,imageIdIndex:i,imageId:e};et(vt,Je.IMAGE_LOAD_ERROR,a)}getLoaderImageOptions(e){const n=this.imageIds.indexOf(e),{transferSyntaxUID:r}=nt("transferSyntax",e)||{};return{useRGBA:!1,transferSyntaxUID:r,priority:5,requestType:St.Interaction,additionalDetails:{imageId:e,imageIdIndex:n}}}async loadImages(e,n){const r=await Promise.allSettled(e.map(a=>{const o=this.getLoaderImageOptions(a);return ro(a,o).then(s=>(n.successCallback(a,s),a),s=>(n.errorCallback(a,!0,s),a))})),i=r.filter(a=>a.status==="rejected");if(i&&i.length){const a=new CustomEvent(Je.IMAGE_LOAD_ERROR,{detail:i,cancelable:!0});vt.dispatchEvent(a)}return r}_loadAndDisplayImageGPU(e,n){if(!e){console.warn("No image id set yet to load");return}const r={imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};return et(this.element,Je.PRE_STACK_NEW_IMAGE,r),this.imagesLoader.loadImages([e],this).then(i=>e)}_updateToDisplayImageCPU(e){const n=this.getImageDataMetadata(e),r=M9(this.canvas,e,this.modality,this._cpuFallbackEnabledElement.viewport.colormap),{windowCenter:i,windowWidth:a,voiLUTFunction:o}=r.voi;this.voiRange=Ku(a,i,o),this._cpuFallbackEnabledElement.image=e,this._cpuFallbackEnabledElement.metadata={...n},this.cpuImagePixelData=e.voxelManager.getScalarData();const s=Object.assign({},r,this._cpuFallbackEnabledElement.viewport);this._cpuFallbackEnabledElement.viewport=this.stackInvalidated?r:s,this.stackInvalidated=!1,this.cpuRenderingInvalidated=!0,this._cpuFallbackEnabledElement.transform=yl(this._cpuFallbackEnabledElement)}getSliceViewInfo(){throw new Error("Method not implemented.")}addImages(e){const n=[];e.forEach(r=>{const{imageId:i,...a}=r,o=at.getImage(i),{origin:s,dimensions:c,direction:l,spacing:f,numberOfComponents:u}=this.getImageDataMetadata(o),h=this.createVTKImageData({origin:s,dimensions:c,direction:l,spacing:f,numberOfComponents:u,pixelArray:o.voxelManager.getScalarData()}),p=this.createActorMapper(h);p&&(n.push({uid:r.actorUID??si(),actor:p,referencedId:i,...a}),r.callback&&r.callback({imageActor:p,imageId:r.imageId}))}),this.addActors(n)}_updateActorToDisplayImageId(e){const n=this._checkVTKImageDataMatchesCornerstoneImage(e,this._imageData),r=this.getViewPresentation();if(n&&!this.stackInvalidated){this._updateVTKImageDataFromCornerstoneImage(e),this.resetCameraNoEvent(),this.setViewPresentation(r),this._setPropertiesFromCache(),this.stackActorReInitialized=!1;return}const{origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:c,imagePixelModule:l}=this.getImageDataMetadata(e),f=e.voxelManager.getScalarData();this._createVTKImageData({origin:i,direction:a,dimensions:o,spacing:s,numberOfComponents:c,pixelArray:f}),this._updateVTKImageDataFromCornerstoneImage(e);const u=this.createActorMapper(this._imageData),h=this.getActors();h.length&&h[0].uid===this.id?h[0].actor=u:h.unshift({uid:this.id,actor:u,referencedId:e.imageId}),this.setActors(h);const{viewPlaneNormal:p,viewUp:d}=this._getCameraOrientation(a),g=this.getCamera();this.setCameraNoEvent({viewUp:d,viewPlaneNormal:p}),this.initialViewUp=d,this.resetCameraNoEvent(),this.setViewPresentation(r),this.triggerCameraEvent(this.getCamera(),g);const y=l.photometricInterpretation==="MONOCHROME1";this.stackInvalidated=!0;const x=this._getInitialVOIRange(e);this.setVOI(x,{forceRecreateLUTFunction:!!y}),this.initialInvert=!!y,this.setInvertColor(this.invert||this.initialInvert),this.stackInvalidated=!1,this.stackActorReInitialized=!0,this._publishCalibratedEvent&&this.triggerCalibrationEvent()}_getInitialVOIRange(e){if(this.voiRange&&this.voiUpdatedWithSetProperties)return this.voiRange;const{windowCenter:n,windowWidth:r,voiLUTFunction:i}=e;let a=this._getVOIRangeFromWindowLevel(r,n,i);return a=this._getPTPreScaledRange()||a,a}_getPTPreScaledRange(){if(this._isCurrentImagePTPrescaled())return this._getDefaultPTPrescaledVOIRange()}_isCurrentImagePTPrescaled(){return!(this.modality!=="PT"||!this.csImage.isPreScaled||!this.csImage.preScale?.scalingParameters.suvbw)}_getDefaultPTPrescaledVOIRange(){return{lower:0,upper:5}}_getVOIRangeFromWindowLevel(e,n,r=ar.LINEAR){let i,a;if(typeof n=="number"&&typeof e=="number"?(i=n,a=e):Array.isArray(n)&&Array.isArray(e)&&(i=n[0],a=e[0]),i!==void 0&&a!==void 0)return Ku(a,i,r)}async _setImageIdIndex(e){if(e>=this.imageIds.length)throw new Error(`ImageIdIndex provided ${e} is invalid, the stack only has ${this.imageIds.length} elements`);this.currentImageIdIndex=e,this.hasPixelSpacing=!0,this.viewportStatus=Mr.PRE_RENDER;const n=await this._loadAndDisplayImage(this.imageIds[e],e);if(this.perImageIdDefaultProperties.size>=1){const r=this.perImageIdDefaultProperties.get(n);r!==void 0?this.setProperties(r):this.globalDefaultProperties!==void 0&&this.setProperties(this.globalDefaultProperties)}return n}resetCameraCPU({resetPan:e=!0,resetZoom:n=!0}){const{image:r}=this._cpuFallbackEnabledElement;if(!r)return;Wk(this._cpuFallbackEnabledElement,e,n);const{scale:i}=this._cpuFallbackEnabledElement.viewport,{clientWidth:a,clientHeight:o}=this.element,s=[a/2,o/2],c=this.canvasToWorldCPU(s);this.setCameraCPU({focalPoint:c,scale:i})}resetCameraGPU({resetPan:e,resetZoom:n}){return this.setCamera({flipHorizontal:!1,flipVertical:!1,viewUp:this.initialViewUp}),super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:!0})}scroll(e,n=!0,r=!1){const i=this.imageIds;if(isNaN(this.targetImageIdIndex))return;const a=this.targetImageIdIndex,o=i.length;let s=a+e;r?s=(s+o)%o:s=Math.max(0,Math.min(o-1,s)),this.targetImageIdIndex=s;const c=i[s];at.isLoaded(c)||!n?this.setImageIdIndex(s):(clearTimeout(this.debouncedTimeout),this.debouncedTimeout=window.setTimeout(()=>{this.setImageIdIndex(s)},40));const f={newImageIdIndex:s,imageId:c,direction:e};s!==a&&et(this.element,Je.STACK_VIEWPORT_SCROLL,f)}setImageIdIndex(e){if(this._throwIfDestroyed(),this.currentImageIdIndex===e)return Promise.resolve(this.getCurrentImageId());const n=this._setImageIdIndex(e);return this.targetImageIdIndex=e,n}calibrateSpacing(e){const n=this.getImageIds().indexOf(e);this.stackInvalidated=!0,this._loadAndDisplayImage(e,n)}triggerCameraEvent(e,n){const r={previousCamera:n,camera:e,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};this.suppressEvents||et(this.element,Je.CAMERA_MODIFIED,r)}triggerCalibrationEvent(){const{imageData:e}=this.getImageData(),n={element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,imageId:this.getCurrentImageId(),imageData:e,worldToIndex:e.getWorldToIndex(),...this._calibrationEvent};this.suppressEvents||et(this.element,Je.IMAGE_SPACING_CALIBRATED,n),this._publishCalibratedEvent=!1}jumpToWorld(e){const n=this.getImageIds(),r=this.getImageData(),{direction:i,spacing:a}=r,o=$f({direction:i,spacing:a,imageIds:n},e,this.getCamera().viewPlaneNormal,{ignoreSpacing:!0}),s=n.indexOf(o);return s===-1?!1:(this.setImageIdIndex(s),this.render(),!0)}getRendererContextPool(){return this.getRenderingEngine().getRenderer(this.id)}getRendererTiled(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}_getVOIRangeForCurrentImage(){const{windowCenter:e,windowWidth:n,voiLUTFunction:r}=this.csImage;return this._getVOIRangeFromWindowLevel(n,e,r)}_getValidVOILUTFunction(e){return Object.values(ar).includes(e)?e:ar.LINEAR}getSliceInfo(){const e=this.getSliceIndex(),{dimensions:n}=this.getImageData();return{width:n[0],height:n[1],sliceIndex:e,slicePlane:2}}isReferenceViewable(e,n={}){const r=this.getCurrentImageIdIndex(),i=this.imageIds[r];if(!i||!e)return!1;const{referencedImageId:a,multiSliceReference:o}=e;if(a){if(a===i)return!0;e.referencedImageURI||=yi(a);const{referencedImageURI:c}=e,l=this.imageKeyToIndexMap.get(c);if(n.asOverlay&&this.matchImagesForOverlay(i,a))return!0;if(l===void 0)return!1;if(n.withNavigation)return!0;const f=o&&this.imageKeyToIndexMap.get(o.referencedImageId);return r<=f&&r>=l}if(!super.isReferenceViewable(e,n))return!1;if(e.volumeId)return n.asVolume;const{cameraFocalPoint:s}=e;if(n.asNearbyProjection&&s){const{spacing:c,direction:l,origin:f}=this.getImageData(),u=l.slice(6,9),h=Gl({direction:l,spacing:c},u),p=Ln(it(),s,f),d=zt(p,u),g=h/2;if(Math.abs(d)<=g)return!0}return!1}getViewReference(e={}){const{sliceIndex:n=this.getCurrentImageIdIndex()}=e,r=super.getViewReference(e),i=this.getCurrentImageId(n);if(i){if(r.referencedImageId=i,this.getCurrentImageIdIndex()!==n){const a=this.getImagePlaneReferenceData(n);if(!a)return;Object.assign(r,a)}return r}}setViewReference(e){if(!e?.referencedImageId){e?.sliceIndex!==void 0&&this.scroll(e.sliceIndex-this.targetImageIdIndex);return}const{referencedImageId:n}=e;e.referencedImageURI||=yi(n);const{referencedImageURI:r}=e,i=this.imageKeyToIndexMap.get(r);if(i===void 0){Jv.error(`No image URI found for ${r}`);return}this.scroll(i-this.targetImageIdIndex)}getViewReferenceId(e={}){const{sliceIndex:n=this.currentImageIdIndex}=e;return`imageId:${this.imageIds[n]}`}getSliceIndexForImage(e){if(e){if(typeof e=="string")return this.imageKeyToIndexMap.get(e);if(e.referencedImageId)return this.imageKeyToIndexMap.get(e.referencedImageId)}}getCPUFallbackError(e){return new Error(`method ${e} cannot be used during CPU Fallback mode`)}fillWithBackgroundColor(){const e=this.getRenderingEngine();e&&e.fillCanvasWithBackgroundColor(this.canvas,this.options.background)}unsetColormapCPU(){delete this._cpuFallbackEnabledElement.viewport.colormap,this._cpuFallbackEnabledElement.renderingTools={},this.cpuRenderingInvalidated=!0,this.fillWithBackgroundColor(),this.render()}setColormapCPU(e){this.colormap=e;const n=pl(e.name);this._cpuFallbackEnabledElement.viewport.colormap=n,this._cpuFallbackEnabledElement.renderingTools={},this.fillWithBackgroundColor(),this.cpuRenderingInvalidated=!0,this.render();const r={viewportId:this.id,colormap:e};et(this.element,Je.COLORMAP_MODIFIED,r)}setColormapGPU(e){const i=this.getDefaultActor().actor.getProperty(),a=i.getRGBTransferFunction(),o=pl(e.name)||fl.getPresetByName(e.name);if(a)a.applyColorMap(o),a.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,a);else{const c=rs.newInstance();c.applyColorMap(o),c.setMappingRange(this.voiRange.lower,this.voiRange.upper),i.setRGBTransferFunction(0,c)}this.colormap=e,this.render();const s={viewportId:this.id,colormap:e};et(this.element,Je.COLORMAP_MODIFIED,s)}unsetColormapGPU(){throw new Error("unsetColormapGPU not implemented.")}_getImagePlaneModule(e){const n=m9(e);return this.hasPixelSpacing=!n.usingDefaultValues||this.calibration?.scale>0||this.calibration?.rowPixelSpacing>0,this.calibration||=n.calibration,n}isInAcquisitionPlane(){return!0}}function zo(t,e){const{imageData:n}=t.getImageData(),r=t.canvasToWorld(e);return Sh(n,r)}function Hf(t,e){return t.indexToWorld(e)}function jk(t,e){const{imageData:n}=t.getImageData(),r=Hf(n,e);return t.worldToCanvas(r)}class lc extends au{constructor(e){super(e),this._useAcquisitionPlaneForViewPlane=!1,this.getNumberOfSlices=()=>{const{numberOfSlices:r}=zf(this)||{};return r},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetRotation:!1,suppressEvents:!0}),this.getCurrentImageIdIndex=(r,i=!0)=>{const{currentStepIndex:a}=Vc(this,r||this.getVolumeId(),i);return a},this.getSliceIndex=()=>{const{imageIndex:r}=zf(this)||{};return r},this.getCurrentImageId=()=>{const r=this.getDefaultActor();if(!r||!Hr(r,"vtkVolume"))return;const i=at.getVolume(this.getVolumeId());if(!i)return;const{viewPlaneNormal:a,focalPoint:o}=this.getCamera();return $f(i,o,a)},this.getSlicePlaneCoordinates=()=>{const r=this.getDefaultActor();if(!r?.actor)return console.warn("No image data found for calculating vtkPlanes."),[];const i=this.getVolumeId(),a=at.getVolume(i),o=this.getCamera(),{focalPoint:s,position:c,viewPlaneNormal:l}=o,f=Gl(a,l),u=Ph(r.actor,l,s),h=Math.round((u.current-u.min)/f),p=Math.round((u.max-u.current)/f),d=this.getSliceIndex(),g=[];for(let y=-h;y<=p;y++){const{newFocalPoint:x}=kc(s,c,u,l,f,y);g.push({sliceIndex:d+y,point:x})}return g};const{orientation:n}=this.options;if(n&&n!==Zo.ACQUISITION){this.applyViewOrientation(n);return}this._useAcquisitionPlaneForViewPlane=!0}async setVolumes(e,n=!1,r=!1){const i=e[0].volumeId,a=at.getVolume(i);if(!a)throw new Error(`imageVolume with id: ${i} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(a),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,a),super.setVolumes(e,n,r)}async addVolumes(e,n=!1,r=!1){const i=at.getVolume(e[0].volumeId);if(!i)throw new Error(`imageVolume with id: ${i.volumeId} does not exist`);return this._useAcquisitionPlaneForViewPlane?(this._setViewPlaneToAcquisitionPlane(i),this._useAcquisitionPlaneForViewPlane=!1):this.options.orientation&&typeof this.options.orientation=="string"&&this.options.orientation.includes("_reformat")&&this._setViewPlaneToReformatOrientation(this.options.orientation,i),super.addVolumes(e,n,r)}jumpToWorld(e){const{focalPoint:n}=this.getCamera(),r=[0,0,0];Bn(r,e,n);const i=this.getCamera(),a=i.viewPlaneNormal,o=zt(r,a),s=Qt(a[0],a[1],a[2]);if(lr(s,s,o),Math.abs(s[0])>.001||Math.abs(s[1])>.001||Math.abs(s[2])>.001){const c=[0,0,0],l=[0,0,0];vi(c,i.focalPoint,s),vi(l,i.position,s),this.setCamera({focalPoint:c,position:l}),this.render()}return!0}setOrientation(e,n=!0){let r,i;if(typeof e=="string"){if(e===Zo.ACQUISITION)({viewPlaneNormal:r,viewUp:i}=super._getAcquisitionPlaneOrientation());else if(e===Zo.REFORMAT||e.includes("_reformat"))({viewPlaneNormal:r,viewUp:i}=f9(this,{useViewportNormal:!0}));else if(jo[e])({viewPlaneNormal:r,viewUp:i}=jo[e]);else throw new Error(`Invalid orientation: ${e}. Use Enums.OrientationAxis instead.`);this.setCamera({viewPlaneNormal:r,viewUp:i}),this.viewportProperties.orientation=e,this.resetCamera()}else({viewPlaneNormal:r,viewUp:i}=e),this.applyViewOrientation(e);n&&this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();if(!e){console.warn("No active camera found");return}e.getParallelProjection()?e.setClippingRange(-Tn.MAXIMUM_RAY_DISTANCE,Tn.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Tn.MINIMUM_SLAB_THICKNESS,Tn.MAXIMUM_RAY_DISTANCE)}_setViewPlaneToReformatOrientation(e,n){let r,i;if(n){const{direction:a}=n;({viewPlaneNormal:r,viewUp:i}=l9(a.slice(0,3),a.slice(3,6),a.slice(6,9),e))}else({viewPlaneNormal:r,viewUp:i}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:r,viewUp:i}),this.initialViewUp=i,this.resetCamera()}_setViewPlaneToAcquisitionPlane(e){let n,r;if(e){const{direction:i}=e;n=i.slice(6,9).map(a=>-a),r=i.slice(3,6).map(a=>-a)}else({viewPlaneNormal:n,viewUp:r}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:n,viewUp:r}),this.initialViewUp=r,this.resetCamera()}getBlendMode(e){const n=this.getActors(),r=e?.length>0?n.find(i=>e.includes(i.uid)):n[0];return r?.blendMode||r?.actor.getMapper().getBlendMode()}setBlendMode(e,n=[],r=!1){let i=this.getActors();n?.length>0&&(i=i.filter(a=>n.includes(a.uid))),i.forEach(a=>{const{actor:o}=a;o.getMapper().setBlendMode?.(e),a.blendMode=e}),r&&this.render()}resetCamera(e){const{resetPan:n=!0,resetZoom:r=!0,resetRotation:i=!0,resetToCenter:a=!0,suppressEvents:o=!1,resetOrientation:s=!0}=e||{},{orientation:c}=this.viewportProperties;c&&s&&this.applyViewOrientation(c,!1),super.resetCamera({resetPan:n,resetZoom:r,resetToCenter:a});const l=this.getVtkActiveCamera(),f=l.getViewPlaneNormal(),u=l.getFocalPoint();if(this.getActors().forEach(p=>{if(!p.actor)return;const d=p.actor.getMapper();if(d.getClippingPlanes().length===0&&!p?.clippingFilter){const y=hr.newInstance(),x=hr.newInstance(),m=[y,x];let v=Tn.MINIMUM_SLAB_THICKNESS;p.slabThickness&&(v=p.slabThickness),this.setOrientationOfClippingPlanes(m,v,f,u),d.addClippingPlane(y),d.addClippingPlane(x)}}),i&&jo[this.viewportProperties.orientation]!==void 0){const p=jo[this.viewportProperties.orientation];this.setCameraNoEvent({viewUp:p.viewUp,viewPlaneNormal:p.viewPlaneNormal})}if(!o){const p={viewportId:this.id,camera:this.getCamera(),renderingEngineId:this.renderingEngineId,element:this.element};et(this.element,Je.CAMERA_RESET,p)}return!0}setSlabThickness(e,n=[]){e<.1&&(e=.1);let r=this.getActors();n?.length>0&&(r=r.filter(a=>n.includes(a.uid))),r.forEach(a=>{Hr(a,"vtkVolume")&&(a.slabThickness=e)});const i=this.getCamera();this.updateClippingPlanesForActors(i),this.triggerCameraModifiedEventIfNecessary(i,i),this.viewportProperties.slabThickness=e}resetSlabThickness(){this.getActors().forEach(r=>{Hr(r,"vtkVolume")&&(r.slabThickness=Tn.MINIMUM_SLAB_THICKNESS)});const n=this.getCamera();this.updateClippingPlanesForActors(n),this.triggerCameraModifiedEventIfNecessary(n,n),this.viewportProperties.slabThickness=void 0}isInAcquisitionPlane(){const e=this.getImageData();if(!e)return!1;const{direction:n}=e,{viewPlaneNormal:r}=this.getCamera(),i=[n[6],n[7],n[8]];return Math.abs(zt(r,i))>.99}getSliceViewInfo(){const{width:e,height:n}=this.getCanvas(),r=zo(this,[0,0]),i=zo(this,[e-1,0]),a=zo(this,[0,n-1]),o=Bn(it(),i,r),s=Bn(it(),a,r),c=mn(it(),o,s);gn(o,o),gn(s,s),gn(c,c);const{dimensions:l}=this.getImageData(),[f,u,h]=l,g=[[0,0,0],[f-1,0,0],[0,u-1,0],[f-1,u-1,0],[0,0,h-1],[f-1,0,h-1],[0,u-1,h-1],[f-1,u-1,h-1]].map(D=>jk(this,D)).reduce((D,E)=>(D.minX=Math.min(D.minX,E[0]),D.minY=Math.min(D.minY,E[1]),D.maxX=Math.max(D.maxX,E[0]),D.maxY=Math.max(D.maxY,E[1]),D),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),y=zo(this,[g.minX,g.minY]),x=x4(o[0],o[1],o[2],0,s[0],s[1],s[2],0,c[0],c[1],c[2],0,y[0],y[1],y[2],1),m=zo(this,[g.maxX,g.maxY]),v=Bn(it(),m,y),w=Sn(ma(),x),{viewPlaneNormal:C}=this.getCamera();if(C.filter(D=>Math.abs(D)>xi).length>1)throw new Error("getSliceInfo is not supported for oblique views");const _=C.findIndex(D=>Math.abs(D)>1-xi);if(_===-1)throw new Error("Unable to determine slice axis");const S=zt(o,v)+1,b=zt(s,v)+1;return{sliceIndex:this.getSliceIndex(),width:S,height:b,slicePlane:_,sliceToIndexMatrix:x,indexToSliceMatrix:w}}getCurrentSlicePixelData(){const{voxelManager:e}=this.getImageData();return e.getSliceData(this.getSliceViewInfo())}getViewReference(e={}){const n=super.getViewReference(e);if(!n?.volumeId)return;const r=at.getVolume(n.volumeId);return n.referencedImageId=$f(r,n.cameraFocalPoint,n.viewPlaneNormal),n}resetProperties(e){this._resetProperties(e)}_resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Tn.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=at.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(Y1(n.actor,r),ki(n)){const l=n.actor.getProperty().getRGBTransferFunction(0);bh(l,this.initialTransferFunctionNodes)}const i={...super.getVOIModifiedEventDetail(e)};this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetCameraRotation:!0}),et(this.element,Je.VOI_MODIFIED,i)}getSlicesClippingPlanes(){const e=this.getSlicePlaneCoordinates(),{viewPlaneNormal:n}=this.getCamera(),r=Tn.MINIMUM_SLAB_THICKNESS;return e.map(({point:i,sliceIndex:a})=>{const o=[hr.newInstance(),hr.newInstance()];return this.setOrientationOfClippingPlanes(o,r,n,i),{sliceIndex:a,planes:o.map(s=>({normal:s.getNormal(),origin:s.getOrigin()}))}})}}class kh extends au{constructor(e){super(e),this.getNumberOfSlices=()=>1,this.getRotation=()=>0,this.getCurrentImageIdIndex=()=>0,this.getCurrentImageId=()=>null,this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0});const{parallelProjection:n,orientation:r}=this.options,i=this.getVtkActiveCamera();n!=null&&i.setParallelProjection(n),r&&r!==Zo.ACQUISITION&&this.applyViewOrientation(r)}isInAcquisitionPlane(){return!1}resetCamera({resetPan:e=!0,resetZoom:n=!0,resetToCenter:r=!0}={}){super.resetCamera({resetPan:e,resetZoom:n,resetToCenter:r});const i=this.getVtkActiveCamera();return i.getParallelProjection()?i.setClippingRange(-Tn.MAXIMUM_RAY_DISTANCE,Tn.MAXIMUM_RAY_DISTANCE):i.setClippingRange(Tn.MINIMUM_SLAB_THICKNESS,Tn.MAXIMUM_RAY_DISTANCE),this.getRenderer().resetCameraClippingRange(),!0}setSlabThickness(e,n){return null}setBlendMode(e,n,r){return null}resetProperties(e){const n=e?this.getActor(e):this.getDefaultActor();if(!n)throw new Error(`No actor found for the given volumeId: ${e}`);n.slabThickness&&(n.slabThickness=Tn.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const r=at.getVolume(e);if(!r)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if(Y1(n.actor,r),ki(n)){const i=n.actor.getProperty().getRGBTransferFunction(0);bh(i,this.initialTransferFunctionNodes)}this.setCamera(this.initialCamera),et(this.element,Je.VOI_MODIFIED,super.getVOIModifiedEventDetail(e))}getSliceIndex(){return null}setCamera(e){super.setCamera(e),this.getRenderer().resetCameraClippingRange(),this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();e.getParallelProjection()?e.setClippingRange(-Tn.MAXIMUM_RAY_DISTANCE,Tn.MAXIMUM_RAY_DISTANCE):e.setClippingRange(Tn.MINIMUM_SLAB_THICKNESS,Tn.MAXIMUM_RAY_DISTANCE)}resetSlabThickness(){return null}}async function N9(t,e,n,r=!1,i=!1){n.forEach(o=>{const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof au))throw new Error("setVolumesForViewports only supports VolumeViewport and VolumeViewport3D")});const a=n.map(async o=>{await t.getViewport(o).setVolumes(e,r,i)});await Promise.all(a)}async function $k(t,e,n,r=!1,i=!1){for(const o of n){const s=t.getViewport(o);if(!s)throw new Error(`Viewport with Id ${o} does not exist`);if(!(s instanceof au)){console.warn(`Viewport with Id ${o} is not a BaseVolumeViewport. Cannot add volume to this viewport.`);return}}const a=n.map(async o=>{await t.getViewport(o).addVolumes(e,r,i)});await Promise.all(a)}function Hk(t,e,n){for(const r of n){const i=t.getViewport(r);if(!i)throw new Error(`Viewport with Id ${r} does not exist`);if(!i.addImages){console.warn(`Viewport with Id ${r} does not have addImages. Cannot add image segmentation to this viewport.`);return}}n.forEach(r=>{t.getViewport(r).addImages(e)})}class Kk{constructor(e){this.opacity=.4,this.outlineOpacity=.4,this.transferFunction=[],this.actor=e}setRGBTransferFunction(e,n){this.transferFunction[e]=n}setScalarOpacity(e){}setInterpolationTypeToNearest(){}setUseLabelOutline(){}setLabelOutlineOpacity(e){this.outlineOpacity=e}setLabelOutlineThickness(){}getColor(e){const n=this.transferFunction[0],r=n.getRedValue(e),i=n.getGreenValue(e),a=n.getBlueValue(e);return[r,i,a,this.opacity]}}class qk{constructor(e){this.actor=e}getInputData(){return this.actor.getImage()}}class Xk{constructor(e,n){this.canvasProperties=new Kk(this),this.visibility=!1,this.mapper=new qk(this),this.className="CanvasActor",this.derivedImage=n,this.viewport=e}renderRLE(e,n,r){const{width:i,height:a}=this.image;let{canvas:o}=this;(!o||o.width!==i||o.height!==a)&&(this.canvas=o=new window.OffscreenCanvas(i,a));const s=o.getContext("2d"),c=s.createImageData(i,a),{data:l}=c;l.fill(0);const{map:f}=r;let u=1/0,h=1/0,p=-1/0,d=-1/0;for(let x=0;x<a;x++){const m=f.getRun(x,0);if(!m)continue;h=Math.min(h,x),d=Math.max(d,x);const v=x*i<<2;let w;for(const C of m){const{start:T,end:_,value:S}=C;if(S===0){w||=[],w.push(m.indexOf(C));continue}u=Math.min(u,T),p=Math.max(p,_);const b=this.canvasProperties.getColor(S).map(E=>E*255);let D=v+(T<<2);for(let E=T;E<_;E++)l[D++]=b[0],l[D++]=b[1],l[D++]=b[2],l[D++]=b[3]}}if(u>i)return;const g=p-u,y=d-h;s.putImageData(c,0,0,u-1,h-1,g+2,y+2),n.drawImage(o,u,h,g,y,u,h,g,y)}setMapper(e){this.mapper=e}render(e,n){if(!this.visibility)return;const r=this.image||this.getImage(),{width:i,height:a}=r,o=r.getScalarData();if(!o)return;const{voxelManager:s}=r;if(s&&s.map.getRun){this.renderRLE(e,n,s);return}let{canvas:c}=this;(!c||c.width!==i||c.height!==a)&&(this.canvas=c=new window.OffscreenCanvas(i,a));const l=c.getContext("2d"),f=l.createImageData(i,a),{data:u}=f;let h=0,p=0,d=1/0,g=1/0,y=-1/0,x=-1/0;for(let w=0;w<a;w++)for(let C=0;C<i;C++){const T=o[h++];if(T){d=Math.min(C,d),g=Math.min(w,g),y=Math.max(C,y),x=Math.max(w,x);const _=this.canvasProperties.getColor(T);u[p]=_[0]*255,u[p+1]=_[1]*255,u[p+2]=_[2]*255,u[p+3]=127}p+=4}if(d>i)return;const m=y-d+1,v=x-g+1;l.putImageData(f,0,0,d,g,m,v),n.drawImage(c,d,g,m,v,d,g,m,v)}getClassName(){return this.className}getProperty(){return this.canvasProperties}setVisibility(e){this.visibility=e}getMapper(){return this.mapper}isA(e){return e===this.className}getImage(){if(this.image)return this.image;this.image={...this.derivedImage};const e=this.viewport.getImageData();return Object.assign(this.image,{worldToIndex:n=>e.imageData.worldToIndex(n),indexToWorld:(n,r)=>e.imageData.indexToWorld(n,r),getDimensions:()=>e.dimensions,getScalarData:()=>this.derivedImage?.getPixelData(),getDirection:()=>e.direction,getSpacing:()=>e.spacing,setOrigin:()=>null,setDerivedImage:n=>{this.derivedImage=n,this.image=null},modified:()=>null}),this.image}}const b2=class b2{static imageIdToFrames(e){const n=e.match(this.frameRangeExtractor);if(!n||!n[2])return null;const r=n[2].split("-").map(i=>Number(i));return r.length===1?r[0]:r}static imageIdToFrameEnd(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[1]:n}static imageIdToFrameStart(e){const n=this.imageIdToFrames(e);return Array.isArray(n)?n[0]:n}static framesToString(e){return Array.isArray(e)?`${e[0]}-${e[1]}`:String(e)}static framesToImageId(e,n){const r=e.match(this.frameRangeExtractor);if(!r||!r[2])return null;const i=this.framesToString(n);return e.replace(this.frameRangeExtractor,`${r[1]}${i}`)}};b2.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let Uc=b2;const nl=class nl extends uc{constructor(e){super({...e,canvas:e.canvas||oi(e.element)}),this.videoWidth=0,this.videoHeight=0,this.loop=!0,this.mute=!0,this.isPlaying=!1,this.scrollSpeed=1,this.playbackRate=1,this.frameRange=[0,0],this.fps=30,this.videoCamera={panWorld:[0,0],parallelScale:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({loop:this.videoElement.loop,muted:this.videoElement.muted,playbackRate:this.playbackRate,scrollSpeed:this.scrollSpeed,voiRange:{...this.voiRange}}),this.getMiddleSliceData=()=>{throw new Error("Method not implemented.")},this.useCustomRenderingPipeline=!0,this.resetCamera=()=>(this.refreshRenderValues(),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame(),!0),this.getNumberOfSlices=()=>{const n=Math.round(this.videoElement.duration*this.fps/this.scrollSpeed);return isNaN(n)?this.numberOfFrames:n},this.getFrameOfReferenceUID=()=>this.videoElement.src,this.resize=()=>{const n=this.canvas,{clientWidth:r,clientHeight:i}=n;(n.width!==r||n.height!==i)&&(n.width=r,n.height=i),this.refreshRenderValues(),this.isPlaying||this.renderFrame()},this.canvasToWorld=(n,r=[0,0,0])=>{const i=this.videoCamera.panWorld,a=this.getWorldToCanvasRatio(),o=[i[0]*a,i[1]*a],s=[n[0]-o[0],n[1]-o[1]];return r.splice(0,2,s[0]/a,s[1]/a),r},this.worldToCanvas=n=>{const r=this.videoCamera.panWorld,i=this.getWorldToCanvasRatio();return[(n[0]+r[0])*i,(n[1]+r[1])*i]},this.getRotation=()=>0,this.canvasToIndex=n=>{const r=this.getTransform();return r.invert(),r.transformPoint(n.map(i=>i*devicePixelRatio))},this.indexToCanvas=n=>this.getTransform().transformPoint(n).map(i=>i/devicePixelRatio),this.customRenderViewportToCanvas=()=>{this.renderFrame()},this.renderFrame=()=>{const n=window.devicePixelRatio||1,i=this.getTransform().getMatrix(),a=this.canvasContext;a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.transform(i[0]/n,i[1]/n,i[2]/n,i[3]/n,i[4]/n,i[5]/n),a.drawImage(this.videoElement,0,0,this.videoWidth,this.videoHeight);for(const s of this.getActors())s.actor.render(this,this.canvasContext);this.canvasContext.resetTransform(),et(this.element,Je.STACK_NEW_IMAGE,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),et(this.element,Je.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,imageIndex:this.getCurrentImageIdIndex(),numberOfSlices:this.numberOfFrames,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),this.initialRender?.();const o=this.getFrameNumber();this.isPlaying&&(o<this.frameRange[0]?this.setFrameNumber(this.frameRange[0]):o>this.frameRange[1]&&(this.loop?this.setFrameNumber(this.frameRange[0]):this.pause()))},this.renderWhilstPlaying=()=>{this.renderFrame(),this.isPlaying&&requestAnimationFrame(this.renderWhilstPlaying)},this.canvasContext=this.canvas.getContext("2d"),this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.videoElement=document.createElement("video"),this.videoElement.muted=this.mute,this.videoElement.loop=this.loop,this.videoElement.autoplay=!0,this.videoElement.crossOrigin="anonymous",this.addEventListeners(),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(Je.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(Je.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.videoElement.remove()}getImageDataMetadata(e){const n=typeof e=="string"?e:e.imageId,r=nt(Ir.IMAGE_PLANE,n);let i=r.rowCosines,a=r.columnCosines;(r.usingDefaultValues||i==null||a==null)&&(i=[1,0,0],a=[0,1,0]);const s=Qt(i[0],i[1],i[2]),c=Qt(a[0],a[1],a[2]),{rows:l,columns:f}=r,u=it();mn(u,s,c);let h=r.imagePositionPatient;h==null&&(h=[0,0,0]);const p=r.columnPixelSpacing||1,d=r.rowPixelSpacing||1,g=r.columns,y=r.rows,x=1,m=1;return this.hasPixelSpacing=!!r.columnPixelSpacing,{bitsAllocated:8,numberOfComponents:3,origin:h,rows:l,columns:f,direction:[...s,...c,...u],dimensions:[g,y,m],spacing:[p,d,x],hasPixelSpacing:this.hasPixelSpacing,numVoxels:g*y*m,imagePlaneModule:r}}setDataIds(e,n){this.setVideo(e[0],(n.viewReference?.sliceIndex||0)+1)}setVideo(e,n){this.imageId=Array.isArray(e)?e[0]:e;const r=nt(Ir.IMAGE_URL,e);if(!r?.rendered)throw new Error(`Video Image ID ${e} does not have a rendered video view`);const{rendered:i}=r,a=nt(Ir.GENERAL_SERIES,e);this.modality=a?.Modality,this.metadata=this.getImageDataMetadata(e);let{cineRate:o,numberOfFrames:s}=nt(Ir.CINE,e);return this.numberOfFrames=s,this.setVideoURL(i).then(()=>((!s||s===1)&&(s=Math.round(this.videoElement.duration*(o||30))),o||(o=Math.round(s/this.videoElement.duration)),this.fps=o,this.numberOfFrames=s,this.setFrameRange([1,s]),this.initialRender=()=>{this.initialRender=null,this.pause(),this.setFrameNumber(n||1)},new Promise(c=>{window.setTimeout(()=>{this.setFrameNumber(n||1),c(this)},25)})))}async setVideoURL(e){return new Promise(n=>{this.videoElement.src=e,this.videoElement.preload="auto";const r=()=>{this.videoWidth=this.videoElement.videoWidth,this.videoHeight=this.videoElement.videoHeight,this.videoElement.removeEventListener("loadedmetadata",r),this.refreshRenderValues(),n(!0)};this.videoElement.addEventListener("loadedmetadata",r)})}getImageIds(){const e=new Array(this.numberOfFrames),n=this.imageId.replace(/[0-9]+$/,"");for(let r=0;r<this.numberOfFrames;r++)e[r]=`${n}${r+1}`;return e}togglePlayPause(){return this.isPlaying?(this.pause(),!1):(this.play(),!0)}async play(){try{this.isPlaying||(this.isPlaying=!0,await this.videoElement.play(),this.renderWhilstPlaying())}catch{}}pause(){try{this.isPlaying=!1,this.videoElement.pause()}catch{}}async scroll(e=1){await this.pause();const n=this.videoElement,r=this.renderFrame,a=n.currentTime+e*this.scrollSpeed/this.fps;n.currentTime=a;const o=s=>{r(),n.removeEventListener("seeked",o)};n.addEventListener("seeked",o)}async start(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=0,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async end(){const e=this.videoElement,n=this.renderFrame;if(e.currentTime=e.duration,e.paused){const r=i=>{n(),e.removeEventListener("seeked",r)};e.addEventListener("seeked",r)}}async setTime(e){const n=this.videoElement,r=this.renderFrame;if(n.currentTime=e,n.paused){const i=a=>{r(),n.removeEventListener("seeked",i)};n.addEventListener("seeked",i)}}getSliceViewInfo(){throw new Error("Method not implemented.")}async setFrameNumber(e){this.setTime((e-1)/this.fps)}setFrameRange(e){if(!e){this.frameRange=[1,this.numberOfFrames];return}e.length!==2||e[0]===e[1]||(this.frameRange=[e[0],e[1]])}getSliceIndexForImage(e){if(e){if(typeof e=="string")return Uc.imageIdToFrameStart(e);if(e.referencedImageId)return Uc.imageIdToFrameStart(e.referencedImageId)}}getFrameRange(){return this.frameRange}setProperties(e){e.loop!==void 0&&(this.videoElement.loop=e.loop),e.muted!==void 0&&(this.videoElement.muted=e.muted),e.playbackRate!==void 0&&this.setPlaybackRate(e.playbackRate),e.scrollSpeed!==void 0&&this.setScrollSpeed(e.scrollSpeed),e.voiRange&&this.setVOI(e.voiRange)}setPlaybackRate(e=1){if(this.playbackRate=e,e<.0625){this.pause();return}this.videoElement&&(this.videoElement.playbackRate=e,this.play())}setScrollSpeed(e=1,n=cl.FRAME){this.scrollSpeed=n===cl.SECOND?e*this.fps:e}resetProperties(){this.setProperties({loop:!1,muted:!0,voiRange:{lower:0,upper:255}})}getScalarData(){if(this.scalarData?.frameNumber===this.getFrameNumber())return this.scalarData;if(!this.videoElement||!this.videoElement.videoWidth||!this.videoElement.videoHeight){console.debug("Video not ready yet, returning empty scalar data");const a=new Uint8ClampedArray;return a.getRange=()=>[0,255],a.frameNumber=-1,a}const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const n=e.getContext("2d");n.drawImage(this.videoElement,0,0);const i=n.getImageData(0,0,e.width,e.height).data;return i.getRange=()=>[0,255],i.frameNumber=this.getFrameNumber(),this.scalarData=i,i}getImageData(){const{metadata:e}=this,n=e.spacing,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>{const o=this.worldToCanvas(a),s=this.canvasToIndex(o);return[s[0],s[1],0]},indexToWorld:(a,o)=>{const s=this.indexToCanvas([a[0],a[1]]);return this.canvasToWorld(s,o)}},i={dimensions:e.dimensions,spacing:n,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:e.FrameOfReferenceUID},getScalarData:()=>this.getScalarData(),scalarData:this.getScalarData(),imageData:r,voxelManager:{forEach:(a,o)=>W8(o.imageData,{pointInShapeFn:o.isInObject??(()=>!0),callback:a,boundsIJK:o.boundsIJK,returnPoints:o.returnPoints??!1})},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1}};return Object.defineProperty(r,"scalarData",{get:()=>this.getScalarData(),enumerable:!0}),i}hasImageURI(e){const n=e.match(nl.frameRangeExtractor),r=n?e.substring(0,n.index):e;return this.imageId.includes(r)}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.canvas.style.filter=n}setWindowLevel(e=256,n=128){const r=n-e/2,i=n+e/2-1;this.setVOI({lower:r,upper:i}),this.setColorTransform({lower:r,upper:i},this.averageWhite)}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}setCamera(e){const{parallelScale:n,focalPoint:r}=e;if(n&&(this.videoCamera.parallelScale=this.element.clientHeight/2/n),r!==void 0){const i=this.worldToCanvas(r),a=[this.element.clientWidth/2,this.element.clientHeight/2],o=[(i[0]-a[0])/this.videoCamera.parallelScale,(i[1]-a[1])/this.videoCamera.parallelScale];this.videoCamera.panWorld=[this.videoCamera.panWorld[0]-o[0],this.videoCamera.panWorld[1]-o[1]]}this.canvasContext.fillStyle="rgba(0,0,0,1)",this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame()}getCurrentImageId(e=this.getCurrentImageIdIndex()){return this.imageId.replace("/frames/1",`/frames/${e+1}`)}getViewReferenceId(e={}){const{sliceIndex:n}=e;return n===void 0?`videoId:${this.getCurrentImageId()}`:Array.isArray(n)?`videoId:${this.imageId.substring(0,this.imageId.length-1)}${n[0]+1}-${n[1]+1}`:`videoId:${this.imageId.replace("/frames/1",`/frames/${1+n}`)}`}isReferenceViewable(e,n={}){let{imageURI:r}=n;const{referencedImageId:i,sliceIndex:a,multiSliceReference:o}=e;if(!super.isReferenceViewable(e))return!1;const s=this.getCurrentImageId();if(!r){const h=s.indexOf(":");r=s.substring(h+1,s.length-1)}if(n.withNavigation)return!0;const c=this.getSliceIndex();if(o){const h=Uc.imageIdToFrameEnd(o.referencedImageId);return c>=a&&c<=h}if(a!==void 0)return c===a;if(!i)return!1;const l=i.match(nl.frameRangeExtractor);if(!l||!l[2])return!0;const f=l[2].split("-").map(h=>Number(h)),u=c+1;return f[0]<=u&&u<=(f[1]??f[0])}setViewReference(e){typeof e.sliceIndex=="number"?this.setFrameNumber(e.sliceIndex+1):Array.isArray(e.sliceIndex)&&this.setFrameRange(e.sliceIndex)}getViewReference(e){const n=e?.sliceIndex??(this.isPlaying?this.frameRange[0]:this.getCurrentImageIdIndex()),r=e?.rangeEndSliceIndex??(this.isPlaying?this.frameRange[1]-1:void 0),i=r>n?{sliceIndex:r,referencedImageId:this.getCurrentImageId(r)}:void 0;return{...super.getViewReference(e),referencedImageId:this.getViewReferenceId(e),sliceIndex:n,multiSliceReference:i}}getFrameNumber(){return 1+this.getCurrentImageIdIndex()}getCurrentImageIdIndex(){return Math.round(this.videoElement.currentTime*this.fps)}getSliceIndex(){return this.getCurrentImageIdIndex()/this.scrollSpeed}getCamera(){const{parallelScale:e}=this.videoCamera,n=[this.element.clientWidth/2,this.element.clientHeight/2];return{parallelProjection:!0,focalPoint:this.canvasToWorld(n),position:[0,0,0],viewUp:[0,-1,0],parallelScale:this.element.clientHeight/2/e,viewPlaneNormal:[0,0,1]}}getFrameRate(){return this.fps}getPan(){const e=this.videoCamera.panWorld;return[e[0],e[1]]}refreshRenderValues(){let e=this.canvas.offsetWidth/this.videoWidth;this.videoHeight*e>this.canvas.height&&(e=this.canvas.offsetHeight/this.videoHeight);const n=Math.floor(this.videoWidth*e),r=Math.floor(this.videoHeight*e),i=(this.canvas.offsetWidth-n)/2,a=(this.canvas.offsetHeight-r)/2,o=i/e,s=a/e;this.videoCamera.panWorld=[o,s],this.videoCamera.parallelScale=e}getWorldToCanvasRatio(){return this.videoCamera.parallelScale}getCanvasToWorldRatio(){return 1/this.videoCamera.parallelScale}getTransform(){const e=this.videoCamera.panWorld,n=window.devicePixelRatio||1,r=this.getWorldToCanvasRatio(),i=this.getCanvasToWorldRatio(),a=[this.canvas.offsetWidth/2,this.canvas.offsetHeight/2],o=[a[0]*i,a[1]*i],s=new su;return s.scale(n,n),s.translate(a[0],a[1]),s.scale(r,r),s.translate(e[0],e[1]),s.translate(-o[0],-o[1]),s}updateCameraClippingPlanesAndRange(){}addImages(e){const n=this.getActors();e.forEach(r=>{const{imageId:i,...a}=r,o=at.getImage(i),s=this.createActorMapper(o),c=r.actorUID??si();s&&(n.push({uid:c,actor:s,referencedId:i,...a}),r.callback&&r.callback({imageActor:s,imageId:i}))}),this.setActors(n)}createActorMapper(e){return new Xk(this,e)}};nl.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i;let Kf=nl;const Yk=`
.DicomMicroscopyViewer {
  --ol-partial-background-color: rgba(127, 127, 127, 0.7);
  --ol-foreground-color: #000000;
  --ol-subtle-foreground-color: #000;
  --ol-subtle-background-color: rgba(78, 78, 78, 0.5);
}

.DicomMicroscopyViewer .ol-box {
  box-sizing: border-box;
  border-radius: 2px;
  border: 1.5px solid var(--ol-background-color);
  background-color: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-mouse-position {
  top: 8px;
  right: 8px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line {
  background: var(--ol-partial-background-color);
  border-radius: 4px;
  bottom: 8px;
  left: 8px;
  padding: 2px;
  position: absolute;
}

.DicomMicroscopyViewer .ol-scale-line-inner {
  border: 1px solid var(--ol-subtle-foreground-color);
  border-top: none;
  color: var(--ol-foreground-color);
  font-size: 10px;
  text-align: center;
  margin: 1px;
  will-change: contents, width;
  transition: all 0.25s;
}

.DicomMicroscopyViewer .ol-scale-bar {
  position: absolute;
  bottom: 8px;
  left: 8px;
}

.DicomMicroscopyViewer .ol-scale-bar-inner {
  display: flex;
}

.DicomMicroscopyViewer .ol-scale-step-marker {
  width: 1px;
  height: 15px;
  background-color: var(--ol-foreground-color);
  float: right;
  z-index: 10;
}

.DicomMicroscopyViewer .ol-scale-step-text {
  position: absolute;
  bottom: -5px;
  font-size: 10px;
  z-index: 11;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-text {
  position: absolute;
  font-size: 12px;
  text-align: center;
  bottom: 25px;
  color: var(--ol-foreground-color);
  text-shadow:
    -1.5px 0 var(--ol-partial-background-color),
    0 1.5px var(--ol-partial-background-color),
    1.5px 0 var(--ol-partial-background-color),
    0 -1.5px var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar {
  position: relative;
  height: 10px;
  z-index: 9;
  box-sizing: border-box;
  border: 1px solid var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-even {
  background-color: var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-scale-singlebar-odd {
  background-color: var(--ol-background-color);
}

.DicomMicroscopyViewer .ol-unsupported {
  display: none;
}

.DicomMicroscopyViewer .ol-viewport,
.DicomMicroscopyViewer .ol-unselectable {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.DicomMicroscopyViewer .ol-viewport canvas {
  all: unset;
}

.DicomMicroscopyViewer .ol-selectable {
  -webkit-touch-callout: default;
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

.DicomMicroscopyViewer .ol-grabbing {
  cursor: -webkit-grabbing;
  cursor: -moz-grabbing;
  cursor: grabbing;
}

.DicomMicroscopyViewer .ol-grab {
  cursor: move;
  cursor: -webkit-grab;
  cursor: -moz-grab;
  cursor: grab;
}

.DicomMicroscopyViewer .ol-control {
  position: absolute;
  background-color: var(--ol-subtle-background-color);
  border-radius: 4px;
}

.DicomMicroscopyViewer .ol-zoom {
  top: 0.5em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-rotate {
  top: 0.5em;
  right: 0.5em;
  transition:
    opacity 0.25s linear,
    visibility 0s linear;
}

.DicomMicroscopyViewer .ol-rotate.ol-hidden {
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.25s linear,
    visibility 0s linear 0.25s;
}

.DicomMicroscopyViewer .ol-zoom-extent {
  top: 4.643em;
  left: 0.5em;
}

.DicomMicroscopyViewer .ol-full-screen {
  right: 0.5em;
  top: 0.5em;
}

.DicomMicroscopyViewer .ol-control button {
  display: block;
  margin: 1px;
  padding: 0;
  color: var(--ol-subtle-foreground-color);
  font-weight: bold;
  text-decoration: none;
  font-size: inherit;
  text-align: center;
  height: 1.375em;
  width: 1.375em;
  line-height: 0.4em;
  background-color: var(--ol-background-color);
  border: none;
  border-radius: 2px;
}

.DicomMicroscopyViewer .ol-control button::-moz-focus-inner {
  border: none;
  padding: 0;
}

.DicomMicroscopyViewer .ol-zoom-extent button {
  line-height: 1.4em;
}

.DicomMicroscopyViewer .ol-compass {
  display: block;
  font-weight: normal;
  will-change: transform;
}

.DicomMicroscopyViewer .ol-touch .ol-control button {
  font-size: 1.5em;
}

.DicomMicroscopyViewer .ol-touch .ol-zoom-extent {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-control button:hover,
.DicomMicroscopyViewer .ol-control button:focus {
  text-decoration: none;
  outline: 1px solid var(--ol-subtle-foreground-color);
  color: var(--ol-foreground-color);
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-in {
  border-radius: 2px 2px 0 0;
}

.DicomMicroscopyViewer .ol-zoom .ol-zoom-out {
  border-radius: 0 0 2px 2px;
}

.DicomMicroscopyViewer .ol-attribution {
  text-align: right;
  bottom: 0.5em;
  right: 0.5em;
  max-width: calc(100% - 1.3em);
  display: flex;
  flex-flow: row-reverse;
  align-items: center;
}

.DicomMicroscopyViewer .ol-attribution a {
  color: var(--ol-subtle-foreground-color);
  text-decoration: none;
}

.DicomMicroscopyViewer .ol-attribution ul {
  margin: 0;
  padding: 1px 0.5em;
  color: var(--ol-foreground-color);
  text-shadow: 0 0 2px var(--ol-background-color);
  font-size: 12px;
}

.DicomMicroscopyViewer .ol-attribution li {
  display: inline;
  list-style: none;
}

.DicomMicroscopyViewer .ol-attribution li:not(:last-child):after {
  content: ' ';
}

.DicomMicroscopyViewer .ol-attribution img {
  max-height: 2em;
  max-width: inherit;
  vertical-align: middle;
}

.DicomMicroscopyViewer .ol-attribution button {
  flex-shrink: 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-collapsed ul {
  display: none;
}

.DicomMicroscopyViewer .ol-attribution:not(.ol-collapsed) {
  background: var(--ol-partial-background-color);
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible {
  bottom: 0;
  right: 0;
  border-radius: 4px 0 0;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible img {
  margin-top: -0.2em;
  max-height: 1.6em;
}

.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-zoomslider {
  top: 4.5em;
  left: 0.5em;
  height: 200px;
}

.DicomMicroscopyViewer .ol-zoomslider button {
  position: relative;
  height: 10px;
}

.DicomMicroscopyViewer .ol-touch .ol-zoomslider {
  top: 5.5em;
}

.DicomMicroscopyViewer .ol-overviewmap {
  left: 0.5em;
  bottom: 0.5em;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible {
  bottom: 0;
  left: 0;
  border-radius: 0 4px 0 0;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap button {
  display: block;
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map {
  border: 1px solid var(--ol-subtle-foreground-color);
  height: 150px;
  width: 150px;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) button {
  bottom: 0;
  left: 0;
  position: absolute;
}

.DicomMicroscopyViewer .ol-overviewmap.ol-collapsed .ol-overviewmap-map,
.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible button {
  display: none;
}

.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) {
  background: var(--ol-subtle-background-color);
}

.DicomMicroscopyViewer .ol-overviewmap-box {
  border: 0.5px dotted var(--ol-subtle-foreground-color);
}

.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-box:hover {
  cursor: move;
}

@layout-header-background: #007ea3;
@primary-color: #007ea3;
@processing-color: #8cb8c6;
@success-color: #3f9c35;
@warning-color: #eeaf30;
@error-color: #96172e;
@font-size-base: 14px;

.DicomMicroscopyViewer .ol-tooltip {
  font-size: 16px !important;
}
`;let Cu=null;const Zv=Symbol.for("map"),Qv=Symbol.for("affine"),Jk="postrender",Rc=class Rc extends uc{constructor(e){super({...e,canvas:e.canvas||oi(e.element)}),this.internalCamera={rotation:0,centerIndex:[0,0],extent:[0,-2,1,-1],xSpacing:1,ySpacing:1,resolution:1,zoom:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({voiRange:{...this.voiRange}}),this.resetCamera=()=>!0,this.getNumberOfSlices=()=>1,this.getFrameOfReferenceUID=()=>this.frameOfReferenceUID,this.resize=()=>{const r=this.canvas,{clientWidth:i,clientHeight:a}=r;(r.width!==i||r.height!==a)&&(r.width=i,r.height=a),this.refreshRenderValues()},this.canvasToWorld=r=>{if(!this.metadata)return;const i=this.canvasToIndex(r);return i[1]=-i[1],this.indexToWorld(i)},this.worldToCanvas=r=>{if(!this.metadata)return;const i=this.worldToIndex(r);return i[1]=-i[1],this.indexToCanvas([i[0],i[1],0])},this.postrender=()=>{this.refreshRenderValues(),et(this.element,Je.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId})},this.getRotation=()=>0,this.canvasToIndex=r=>{const i=this.getTransform();i.invert();const a=i.transformPoint(r.map(o=>o*devicePixelRatio));return[a[0],a[1],0]},this.indexToCanvas=r=>this.getTransform().transformPoint([r[0],r[1]]).map(a=>a/devicePixelRatio),this.customRenderViewportToCanvas=()=>{},this.getImageIds=()=>[this.imageIds[0]],this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.element.style.position="relative",this.microscopyElement=document.createElement("div"),this.microscopyElement.setAttribute("class","DicomMicroscopyViewer"),this.microscopyElement.id=si(),this.microscopyElement.innerText="Initial",this.microscopyElement.style.background="grey",this.microscopyElement.style.width="100%",this.microscopyElement.style.height="100%",this.microscopyElement.style.position="absolute",this.microscopyElement.style.left="0",this.microscopyElement.style.top="0";const n=this.element.firstElementChild;n.insertBefore(this.microscopyElement,n.childNodes[1]),this.addEventListeners(),this.addWidget("DicomMicroscopyViewer",{getEnabled:()=>!!this.viewer,setEnabled:()=>{this.elementDisabledHandler()}}),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(Je.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(Je.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.viewer?.cleanup(),this.viewer=null,this.element.firstElementChild.removeChild(this.microscopyElement),this.microscopyElement=null}getImageDataMetadata(e=0){const n=this.metadataDicomweb.reduce((b,D)=>b?.NumberOfFrames<D.NumberOfFrames?D:b),{TotalPixelMatrixColumns:r,TotalPixelMatrixRows:i,ImageOrientationSlide:a,ImagedVolumeWidth:o,ImagedVolumeHeight:s,ImagedVolumeDepth:c}=n,l=nt(Ir.IMAGE_PLANE,this.imageIds[e]);let f=a.slice(0,3),u=a.slice(3,6);(f==null||u==null)&&(f=[1,0,0],u=[0,1,0]);const h=Qt(f[0],f[1],f[2]),p=Qt(u[0],u[1],u[2]),d=it();mn(d,h,p);const{XOffsetInSlideCoordinateSystem:g=0,YOffsetInSlideCoordinateSystem:y=0,ZOffsetInSlideCoordinateSystem:x=0}=n.TotalPixelMatrixOriginSequence?.[0]||{},m=[g,y,x],v=o/r,w=s/i,C=r,T=i,_=c,S=1;return this.hasPixelSpacing=!!(o&&s),{bitsAllocated:8,numberOfComponents:3,origin:m,direction:[...h,...p,...d],dimensions:[C,T,S],spacing:[v,w,_],hasPixelSpacing:this.hasPixelSpacing,numVoxels:C*T*S,imagePlaneModule:l}}async setFrameNumber(e){}setProperties(e){e.voiRange&&this.setVOI(e.voiRange)}resetProperties(){this.setProperties({voiRange:{lower:0,upper:255}})}setVOI(e){this.voiRange=e;const n=this.setColorTransform(e,this.averageWhite);this.map.getViewport().querySelectorAll(".ol-layers canvas").forEach(i=>{i.style.filter=n})}setAverageWhite(e){this.averageWhite=e,this.setColorTransform(this.voiRange,e)}getScalarData(){return null}computeTransforms(){const e=ma(),n=ma();return Vl(e,this.metadata.origin),e[0]=this.metadata.direction[0],e[1]=this.metadata.direction[1],e[2]=this.metadata.direction[2],e[4]=this.metadata.direction[3],e[5]=this.metadata.direction[4],e[6]=this.metadata.direction[5],e[8]=this.metadata.direction[6],e[9]=this.metadata.direction[7],e[10]=this.metadata.direction[8],va(e,e,this.metadata.spacing),Sn(n,e),{indexToWorld:e,worldToIndex:n}}getImageData(){const{metadata:e}=this;if(!e)return null;const{spacing:n}=e,r={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:a=>this.worldToIndex(a),indexToWorld:a=>this.indexToWorld(a)};return{dimensions:e.dimensions,spacing:n,numberOfComponents:3,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.frameOfReferenceUID},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1},scalarData:this.getScalarData(),imageData:r}}hasImageURI(e){return!0}setCamera(e){const n=this.getCamera(),{parallelScale:r,focalPoint:i}=e,a=this.getView(),{xSpacing:o}=this.internalCamera;if(r){const c=this.element.clientHeight/r,l=1/o/c;a.setResolution(l)}if(i){const c=this.worldToCanvas(i),l=this.canvasToIndex(c);a.setCenter(l)}const s=this.getCamera();this.triggerCameraModifiedEventIfNecessary(n,s)}getCurrentImageId(){return this.imageIds[0]}getFrameNumber(){return 1}getCamera(){this.refreshRenderValues();const{resolution:e,xSpacing:n,centerIndex:r}=this.internalCamera,i=e*n,a=this.indexToCanvas([r[0],r[1],0]),o=this.canvasToWorld(a);return{parallelProjection:!0,focalPoint:o,position:o,viewUp:[0,-1,0],parallelScale:this.element.clientHeight*i,viewPlaneNormal:[0,0,1]}}worldToIndexWSI(e){if(!Cu)return;const n=this.viewer[Qv],r=Cu.applyInverseTransform({coordinate:[e[0],e[1]],affine:n});return[r[0],r[1]]}indexToWorldWSI(e){if(!Cu)return;const n=Cu.applyTransform({coordinate:[e[0],e[1]],affine:this.viewer[Qv]});return[n[0],n[1],0]}worldToIndex(e){const{worldToIndex:n}=this.computeTransforms(),r=it();return Dt(r,e,n),r}indexToWorld(e){const{indexToWorld:n}=this.computeTransforms(),r=it(),i=Qt(...e);return Dt(r,i,n),[r[0],r[1],r[2]]}setDataIds(e,n){n?.miniNavigationOverlay!==!1&&Rc.addMiniNavigationOverlayCss();const r=n?.webClient||nt(Ir.WADO_WEB_CLIENT,e[0]);if(!r)throw new Error(`To use setDataIds on WSI data, you must provide metaData.webClient for ${e[0]}`);return this.setWSI(e,r)}async setWSI(e,n){this.microscopyElement.style.background="black",this.microscopyElement.innerText="Loading",this.imageIds=e;const r=await Rc.getDicomMicroscopyViewer();Cu||=r.utils,this.frameOfReferenceUID=null;const i=this.imageIds.map(s=>{const c=n.getDICOMwebMetadata(s);Object.defineProperty(c,"isMultiframe",{value:c.isMultiframe,enumerable:!1}),Object.defineProperty(c,"frameNumber",{value:void 0,enumerable:!1});const l=c["00080008"]?.Value;l?.length===1&&(c["00080008"].Value=l[0].split("\\"));const f=c["00200052"]?.Value?.[0];return this.frameOfReferenceUID?f!==this.frameOfReferenceUID&&(c["00200052"].Value=[this.frameOfReferenceUID]):this.frameOfReferenceUID=f,c}),a=[];i.forEach(s=>{const c=new r.metadata.VLWholeSlideMicroscopyImage({metadata:s}),l=c.ImageType[2];l==="VOLUME"||l==="THUMBNAIL"?a.push(c):console.log("Unknown image type",c.ImageType)}),this.metadataDicomweb=a;const o=new r.viewer.VolumeImageViewer({client:n,metadata:a,controls:["overview","position"],retrieveRendered:!1,bindings:{}});o.render({container:this.microscopyElement}),this.metadata=this.getImageDataMetadata(),o.deactivateDragPanInteraction(),this.viewer=o,this.map=o[Zv],this.map.on(Jk,this.postrender),this.resize(),this.microscopyElement.innerText="",Object.assign(this.microscopyElement.style,{"--ol-partial-background-color":"rgba(127, 127, 127, 0.7)","--ol-foreground-color":"#000000","--ol-subtle-foreground-color":"#000","--ol-subtle-background-color":"rgba(78, 78, 78, 0.5)",background:"none"})}scroll(e){const n=this.getCamera();this.setCamera({parallelScale:n.parallelScale*(1+.1*e)})}getSliceIndex(){return 0}getView(){if(!this.viewer)return;const e=this.viewer[Zv],n=window;return n.map=e,n.viewer=this.viewer,n.view=e?.getView(),n.wsi=this,e?.getView()}refreshRenderValues(){const e=this.getView();if(!e)return;const n=e.getResolution();if(!n||n<xi)return;const r=e.getCenter(),i=e.getProjection().getExtent(),a=e.getRotation(),o=e.getZoom(),{metadata:{spacing:[s,c]}}=this,l=1/n/s;Object.assign(this.internalCamera,{extent:i,centerIndex:r,worldToCanvasRatio:l,xSpacing:s,ySpacing:c,resolution:n,rotation:a,zoom:o})}getZoom(){return this.getView()?.getZoom()}setZoom(e){this.getView()?.setZoom(e)}getTransform(){this.refreshRenderValues();const{centerIndex:e,resolution:n,rotation:r}=this.internalCamera,i=[this.canvas.width/2,this.canvas.height/2],a=new su;return a.translate(i[0],i[1]),a.rotate(r),a.scale(1/n,-1/n),a.translate(-e[0],-e[1]),a}getViewReferenceId(){return`imageId:${this.getCurrentImageId()}`}getCurrentImageIdIndex(){return 0}static addMiniNavigationOverlayCss(){if(document.getElementById(this.overlayCssId))return;const e=document.createElement("style");e.innerText=Yk,e.setAttribute("id",this.overlayCssId),document.getElementsByTagName("head")[0].append(e)}};Rc.getDicomMicroscopyViewer=async()=>d3("dicom-microscopy-viewer"),Rc.overlayCssId="overlayCss";let qf=Rc;const L9={[tn.ORTHOGRAPHIC]:lc,[tn.PERSPECTIVE]:lc,[tn.STACK]:io,[tn.VOLUME_3D]:kh,[tn.VIDEO]:Kf,[tn.WHOLE_SLIDE]:qf};function ua(t){return L9[t].useCustomRenderingPipeline}const Xf=2;class o2{constructor(e){if(this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this.renderFrameOfReference=n=>{const i=this._getViewportsAsArray().map(a=>{if(a.getFrameOfReferenceUID()===n)return a.id});this.renderViewports(i)},this.id=e||si(),this.useCPURendering=Ac(),ul.set(this),!h3())throw new Error("@cornerstonejs/core is not initialized, run init() first");this._viewports=new Map,this.hasBeenDestroyed=!1}enableElement(e){const n=this._normalizeViewportInputEntry(e);this._throwIfDestroyed();const{element:r,viewportId:i}=n;if(!r)throw new Error("No element provided");this.getViewport(i)&&this.disableElement(i);const{type:o}=n,s=ua(o);!this.useCPURendering&&!s?this.enableVTKjsDrivenViewport(n):this.addCustomViewport(n);const c=oi(r),{background:l}=n.defaultOptions;this.fillCanvasWithBackgroundColor(c,l)}disableElement(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n){console.warn(`viewport ${e} does not exist`);return}this._resetViewport(n),!ua(n.type)&&!this.useCPURendering&&this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(e),this._removeViewport(e),n.isDisabled=!0,this._needsRender.delete(e),this.getViewports().length||this._clearAnimationFrame()}setViewports(e){const n=this._normalizeViewportInputEntries(e);this._throwIfDestroyed(),this._reset();const r=[],i=[];n.forEach(a=>{!this.useCPURendering&&!ua(a.type)?r.push(a):i.push(a)}),this.setVtkjsDrivenViewports(r),this.setCustomViewports(i),n.forEach(a=>{const o=oi(a.element),{background:s}=a.defaultOptions;this.fillCanvasWithBackgroundColor(o,s)})}resize(e=!0,n=!0){this._throwIfDestroyed();const r=this._getViewportsAsArray(),i=[],a=[];r.forEach(o=>{ua(o.type)?a.push(o):i.push(o)}),i.length&&this._resizeVTKViewports(i,n,e),a.length&&this._resizeUsingCustomResizeHandler(a,n,e)}getViewport(e){return this._viewports?.get(e)}getViewports(){return this._throwIfDestroyed(),this._getViewportsAsArray()}getStackViewport(e){this._throwIfDestroyed();const n=this.getViewport(e);if(!n)throw new Error(`Viewport with Id ${e} does not exist`);if(!(n instanceof io))throw new Error(`Viewport with Id ${e} is not a StackViewport.`);return n}getStackViewports(){return this._throwIfDestroyed(),this.getViewports().filter(n=>n instanceof io)}getVolumeViewports(){this._throwIfDestroyed();const e=this.getViewports(),n=r=>r instanceof au;return e.filter(n)}render(){const n=this.getViewports().map(r=>r.id);this._setViewportsToBeRenderedNextFrame(n)}renderViewports(e){this._setViewportsToBeRenderedNextFrame(e)}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}destroy(){this.hasBeenDestroyed||(this.useCPURendering||(this._getViewportsAsArray().forEach(n=>{this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.removeRenderer(n.id)}),this.offscreenMultiRenderWindow&&this.offscreenMultiRenderWindow.delete(),delete this.offscreenMultiRenderWindow),this._reset(),ul.delete(this.id),this.hasBeenDestroyed=!0)}fillCanvasWithBackgroundColor(e,n){const r=e.getContext("2d");let i;if(n){const a=n.map(o=>Math.floor(255*o));i=`rgb(${a[0]}, ${a[1]}, ${a[2]})`}else i="black";r.fillStyle=i,r.fillRect(0,0,e.width,e.height)}_normalizeViewportInputEntry(e){const{type:n,defaultOptions:r}=e;let i=r;return(!i||Object.keys(i).length===0)&&(i={background:[0,0,0],orientation:null,displayArea:null},n===tn.ORTHOGRAPHIC&&(i={...i,orientation:Zo.AXIAL})),{...e,defaultOptions:i}}_normalizeViewportInputEntries(e){const n=[];return e.forEach(r=>{n.push(this._normalizeViewportInputEntry(r))}),n}_resizeUsingCustomResizeHandler(e,n=!0,r=!0){e.forEach(i=>{typeof i.resize=="function"&&i.resize()}),e.forEach(i=>{const a=i.getCamera();i.resetCamera(),n&&i.setCamera(a)}),r&&this.render()}_removeViewport(e){if(!this.getViewport(e)){console.warn(`viewport ${e} does not exist`);return}this._viewports.delete(e)}addCustomViewport(e){const{element:n,viewportId:r,type:i,defaultOptions:a}=e;n.tabIndex=-1;const o=oi(n),{clientWidth:s,clientHeight:c}=o;(o.width!==s||o.height!==c)&&(o.width=s,o.height=c);const l={id:r,renderingEngineId:this.id,element:n,type:i,canvas:o,sx:0,sy:0,sWidth:s,sHeight:c,defaultOptions:a||{}},f=L9[i],u=new f(l);this._viewports.set(r,u);const h={element:n,viewportId:r,renderingEngineId:this.id};et(vt,Je.ELEMENT_ENABLED,h)}getRenderer(e){return this.offscreenMultiRenderWindow.getRenderer(e)}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");return this.offscreenMultiRenderWindow}setCustomViewports(e){e.forEach(n=>{this.addCustomViewport(n)})}_getViewportsAsArray(){return Array.from(this._viewports.values())}_setViewportsToBeRenderedNextFrame(e){e.forEach(n=>{this._needsRender.add(n)}),this._render()}_render(){this._needsRender.size>0&&!this._animationFrameSet&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_resetViewport(e){const n=this.id,{element:r,canvas:i,id:a}=e,o={element:r,viewportId:a,renderingEngineId:n};e.removeWidgets(),et(vt,Je.ELEMENT_DISABLED,o),r.removeAttribute("data-viewport-uid"),r.removeAttribute("data-rendering-engine-uid"),i.getContext("2d").clearRect(0,0,i.width,i.height)}_clearAnimationFrame(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null}_reset(){this._getViewportsAsArray().forEach(n=>{this._resetViewport(n)}),this._clearAnimationFrame(),this._viewports=new Map}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}}class s2 extends o2{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed(),this.useCPURendering||this.performVtkDrawCall();const n=this._getViewportsAsArray(),r=[];for(let i=0;i<n.length;i++){const a=n[i];if(this._needsRender.has(a.id)){const o=this.renderViewportUsingCustomOrVtkPipeline(a);if(r.push(o),a.setRendered(),this._needsRender.delete(a.id),this._needsRender.size===0)break}}this._animationFrameSet=!1,this._animationFrameHandle=null,r.forEach(i=>{i?.element&&et(i.element,Je.IMAGE_RENDERED,i)})},this.useCPURendering||(this.offscreenMultiRenderWindow=N6.newInstance(),this.offScreenCanvasContainer=document.createElement("div"),this.offscreenMultiRenderWindow.setContainer(this.offScreenCanvasContainer))}enableVTKjsDrivenViewport(e){const r=this._getViewportsAsArray().filter(f=>ua(f.type)===!1),i=r.map(f=>f.canvas),a=oi(e.element);i.push(a);const{offScreenCanvasWidth:o,offScreenCanvasHeight:s}=this._resizeOffScreenCanvas(i),c=this._resize(r,o,s),l={...e,canvas:a};this.addVtkjsDrivenViewport(l,{offScreenCanvasWidth:o,offScreenCanvasHeight:s,xOffset:c})}addVtkjsDrivenViewport(e,n){const{element:r,canvas:i,viewportId:a,type:o,defaultOptions:s}=e;r.tabIndex=-1;const{offScreenCanvasWidth:c,offScreenCanvasHeight:l,xOffset:f}=n,{sxStartDisplayCoords:u,syStartDisplayCoords:h,sxEndDisplayCoords:p,syEndDisplayCoords:d,sx:g,sy:y,sWidth:x,sHeight:m}=this._getViewportCoordsOnOffScreenCanvas(e,c,l,f);this.offscreenMultiRenderWindow.addRenderer({viewport:[u,h,p,d],id:a,background:s.background?s.background:[0,0,0]});const v={id:a,element:r,renderingEngineId:this.id,type:o,canvas:i,sx:g,sy:y,sWidth:x,sHeight:m,defaultOptions:s||{}};let w;if(o===tn.STACK)w=new io(v);else if(o===tn.ORTHOGRAPHIC||o===tn.PERSPECTIVE)w=new lc(v);else if(o===tn.VOLUME_3D)w=new kh(v);else throw new Error(`Viewport Type ${o} is not supported`);this._viewports.set(a,w);const C={element:r,viewportId:a,renderingEngineId:this.id};w.suppressEvents||et(vt,Je.ELEMENT_ENABLED,C)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(o=>oi(o.element));n.forEach(o=>{const s=window.devicePixelRatio||1,c=o.getBoundingClientRect();o.width=c.width*s,o.height=c.height*s});const{offScreenCanvasWidth:r,offScreenCanvasHeight:i}=this._resizeOffScreenCanvas(n);let a=0;for(let o=0;o<e.length;o++){const s=e[o],c=n[o],l={...s,canvas:c};this.addVtkjsDrivenViewport(l,{offScreenCanvasWidth:r,offScreenCanvasHeight:i,xOffset:a}),a+=c.width}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>oi(a.element));if(i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length){const{offScreenCanvasWidth:a,offScreenCanvasHeight:o}=this._resizeOffScreenCanvas(i);this._resize(e,a,o)}e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:c}=o;a.resetCameraForResize();const l=a.getDisplayArea();n&&(l?(c&&a.setCamera({flipHorizontal:c}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}performVtkDrawCall(){const{offscreenMultiRenderWindow:e}=this,n=e.getRenderWindow(),r=e.getRenderers();if(r.length){for(let i=0;i<r.length;i++){const{renderer:a,id:o}=r[i];this._needsRender.has(o)?a.setDraw(!0):a.setDraw(!1)}n.render();for(let i=0;i<r.length;i++)r[i].renderer.setDraw(!1)}}renderViewportUsingCustomOrVtkPipeline(e){let n;if(e.sWidth<Xf||e.sHeight<Xf){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(ua(e.type)===!0)n=e.customRenderViewportToCanvas();else{if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const{offscreenMultiRenderWindow:r}=this,o=r.getOpenGLRenderWindow().get3DContext().canvas;n=this._renderViewportFromVtkCanvasToOnscreenCanvas(e,o)}return n}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){const{element:r,canvas:i,sx:a,sy:o,sWidth:s,sHeight:c,id:l,renderingEngineId:f,suppressEvents:u}=e,{width:h,height:p}=i;return i.getContext("2d").drawImage(n,a,o,s,c,0,0,h,p),{element:r,suppressEvents:u,viewportId:l,renderingEngineId:f,viewportStatus:e.viewportStatus}}_resizeOffScreenCanvas(e){const{offScreenCanvasContainer:n,offscreenMultiRenderWindow:r}=this,i=Math.max(...e.map(o=>o.height));let a=0;return e.forEach(o=>{a+=o.width}),n.width=a,n.height=i,r.resize(),{offScreenCanvasWidth:a,offScreenCanvasHeight:i}}_resize(e,n,r){let i=0;for(let a=0;a<e.length;a++){const o=e[a],{sxStartDisplayCoords:s,syStartDisplayCoords:c,sxEndDisplayCoords:l,syEndDisplayCoords:f,sx:u,sy:h,sWidth:p,sHeight:d}=this._getViewportCoordsOnOffScreenCanvas(o,n,r,i);i+=o.canvas.width,o.sx=u,o.sy=h,o.sWidth=p,o.sHeight=d,this.offscreenMultiRenderWindow.getRenderer(o.id).setViewport(s,c,l,f)}return i}_getViewportCoordsOnOffScreenCanvas(e,n,r,i){const{canvas:a}=e,{width:o,height:s}=a,c=i,l=0,f=c/n,u=l+(r-s)/r,h=o/n,p=s/r;return{sxStartDisplayCoords:f,syStartDisplayCoords:u,sxEndDisplayCoords:f+h,syEndDisplayCoords:u+p,sx:c,sy:l,sWidth:o,sHeight:s}}}class Zk{constructor(e){this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext=new Map;for(let n=0;n<e;n++){const r=N6.newInstance(),i=document.createElement("div");r.setContainer(i),this.contexts.push(r),this.offScreenCanvasContainers.push(i)}}getContextByIndex(e){return e>=0&&e<this.contexts.length?{context:this.contexts[e],container:this.offScreenCanvasContainers[e]}:null}assignViewportToContext(e,n){this.viewportToContext.set(e,n)}getContextIndexForViewport(e){return this.viewportToContext.get(e)}getAllContexts(){return this.contexts}getContextCount(){return this.contexts.length}destroy(){this.contexts.forEach(e=>{e.delete()}),this.contexts=[],this.offScreenCanvasContainers=[],this.viewportToContext.clear()}}class ng extends o2{constructor(e){super(e),this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const a=this._getViewportsAsArray().filter(s=>this._needsRender.has(s.id));if(a.length===0){this._animationFrameSet=!1,this._animationFrameHandle=null;return}const o=a.map(s=>{const c=this.renderViewportUsingCustomOrVtkPipeline(s);return s.setRendered(),this._needsRender.delete(s.id),c});this._animationFrameSet=!1,this._animationFrameHandle=null,o.forEach(s=>{s?.element&&et(s.element,Je.IMAGE_RENDERED,s)})};const{rendering:n}=hc(),{webGlContextCount:r}=n;this.useCPURendering||(this.contextPool=new Zk(r))}enableVTKjsDrivenViewport(e){const i=this._getViewportsAsArray().filter(s=>ua(s.type)===!1).map(s=>s.canvas),a=oi(e.element);i.push(a);const o={...e,canvas:a};this.addVtkjsDrivenViewport(o)}addVtkjsDrivenViewport(e){const{element:n,canvas:r,viewportId:i,type:a,defaultOptions:o}=e;n.tabIndex=-1;let s=0;if(a===tn.STACK){const p=this.contextPool.getAllContexts();s=this._viewports.size%p.length}this.contextPool.assignViewportToContext(i,s);const c=this.contextPool.getContextByIndex(s),{context:l}=c;l.addRenderer({viewport:[0,0,1,1],id:i,background:o.background?o.background:[0,0,0]});const f={id:i,element:n,renderingEngineId:this.id,type:a,canvas:r,sx:0,sy:0,sWidth:r.width,sHeight:r.height,defaultOptions:o||{}};let u;if(a===tn.STACK)u=new io(f);else if(a===tn.ORTHOGRAPHIC||a===tn.PERSPECTIVE)u=new lc(f);else if(a===tn.VOLUME_3D)u=new kh(f);else throw new Error(`Viewport Type ${a} is not supported`);this._viewports.set(i,u);const h={element:n,viewportId:i,renderingEngineId:this.id};u.suppressEvents||et(vt,Je.ELEMENT_ENABLED,h)}setVtkjsDrivenViewports(e){if(e.length){const n=e.map(r=>oi(r.element));n.forEach(r=>{const i=window.devicePixelRatio||1,a=r.getBoundingClientRect();r.width=a.width*i,r.height=a.height*i});for(let r=0;r<e.length;r++){const i=e[r],a=n[r],o={...i,canvas:a};this.addVtkjsDrivenViewport(o)}}}_resizeVTKViewports(e,n=!0,r=!0){const i=e.map(a=>oi(a.element));i.forEach(a=>{const o=window.devicePixelRatio||1;a.width=a.clientWidth*o,a.height=a.clientHeight*o}),i.length&&this._resize(e),e.forEach(a=>{const o=a.getCamera(),s=a.getRotation(),{flipHorizontal:c}=o;a.resetCameraForResize();const l=a.getDisplayArea();n&&(l?(c&&a.setCamera({flipHorizontal:c}),s&&a.setViewPresentation({rotation:s})):a.setCamera(o))}),r&&this.render()}renderViewportUsingCustomOrVtkPipeline(e){if(ua(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const n=this.contextPool.getContextIndexForViewport(e.id),r=this.contextPool.getContextByIndex(n),{context:i,container:a}=r;return this._renderViewportWithContext(e,i,a)}_renderViewportWithContext(e,n,r){if(e.sWidth<Xf||e.sHeight<Xf){console.warn("Viewport is too small",e.sWidth,e.sHeight);return}if(ua(e.type))return e.customRenderViewportToCanvas();if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");n.getRenderer(e.id)||n.addRenderer({viewport:[0,0,1,1],id:e.id,background:e.defaultOptions?.background||[0,0,0]});const i=n.getRenderWindow();this._resizeOffScreenCanvasForViewport(e.canvas,r,n),n.getRenderer(e.id).setViewport(0,0,1,1);const o=n.getRenderers();o.forEach(({renderer:h,id:p})=>{h.setDraw(p===e.id)}),this.getWidgetRenderers().forEach((h,p)=>{p.setDraw(h===e.id)}),i.render(),o.forEach(({renderer:h})=>h.setDraw(!1));const f=n.getOpenGLRenderWindow().get3DContext().canvas;return this._copyToOnscreenCanvas(e,f)}_renderViewportFromVtkCanvasToOnscreenCanvas(e,n){return this._copyToOnscreenCanvas(e,n)}_resizeOffScreenCanvasForViewport(e,n,r){const i=e.width,a=e.height;n.width=i,n.height=a,r.resize()}_copyToOnscreenCanvas(e,n){const{element:r,canvas:i,id:a,renderingEngineId:o,suppressEvents:s}=e,{width:c,height:l}=i;return i.getContext("2d").drawImage(n,0,0,c,l,0,0,c,l),{element:r,suppressEvents:s,viewportId:a,renderingEngineId:o,viewportStatus:e.viewportStatus}}_resize(e){for(const n of e){n.sx=0,n.sy=0,n.sWidth=n.canvas.width,n.sHeight=n.canvas.height;const r=this.contextPool.getContextIndexForViewport(n.id),i=this.contextPool.getContextByIndex(r),{context:a}=i;a.getRenderer(n.id).setViewport(0,0,1,1)}}getWidgetRenderers(){const e=this._getViewportsAsArray(),n=new Map;return e.forEach(r=>{(r.getWidgets?r.getWidgets():[]).forEach(a=>{const o=a.getRenderer?a.getRenderer():null;o&&n.set(o,r.id)})}),n}getRenderer(e){const n=this.contextPool?.getContextIndexForViewport(e),r=this.contextPool.getContextByIndex(n),{context:i}=r;return i.getRenderer(e)}disableElement(e){const n=this.getViewport(e);if(n&&(super.disableElement(e),!ua(n.type)&&!this.useCPURendering)){const r=this.contextPool.getContextIndexForViewport(e);if(r!==void 0){const i=this.contextPool.getContextByIndex(r);if(i){const{context:a}=i;a.removeRenderer(e)}}}}destroy(){this.contextPool&&this.contextPool.destroy(),super.destroy()}getOffscreenMultiRenderWindow(e){if(this.useCPURendering)throw new Error("Offscreen multi render window is not available when using CPU rendering.");const n=this.contextPool.getContextIndexForViewport(e);return this.contextPool.getContextByIndex(n).context}}class A9{constructor(e){const r=hc()?.rendering?.renderingEngineMode;switch(r){case ic.Tiled:this._implementation=new s2(e);break;case ic.ContextPool:this._implementation=new ng(e);break;default:console.warn(`RenderingEngine: Unknown rendering engine mode "${r}". Defaulting to Next rendering engine.`),this._implementation=new ng(e);break}}get id(){return this._implementation.id}enableElement(e){return this._implementation.enableElement(e)}disableElement(e){return this._implementation.disableElement(e)}setViewports(e){return this._implementation.setViewports(e)}resize(e=!0,n=!0){return this._implementation.resize(e,n)}getViewport(e){return this._implementation.getViewport(e)}getViewports(){return this._implementation.getViewports()}getStackViewport(e){return this._implementation.getStackViewport(e)}getStackViewports(){return this._implementation.getStackViewports()}getVolumeViewports(){return this._implementation.getVolumeViewports()}getRenderer(e){return this._implementation.getRenderer(e)}fillCanvasWithBackgroundColor(e,n){return this._implementation.fillCanvasWithBackgroundColor(e,n)}render(){return this._implementation.render()}renderViewports(e){return this._implementation.renderViewports(e)}renderViewport(e){return this._implementation.renderViewport(e)}destroy(){return this._implementation.destroy()}getOffscreenMultiRenderWindow(e){return this._implementation.getOffscreenMultiRenderWindow(e)}}const Qk="3.30.3";class F9{constructor(e){this._color=[200,0,0],this.id=e.id,this._points=e.points,this._polys=e.polys,this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes(),this._updateCentroid(),this._visible=!0}_getSizeInBytes(){return this._points.length*4+this._polys.length*4}_updateCentroid(){const e=this._points.length/3;let n=0,r=0,i=0;for(let a=0;a<this._points.length;a+=3)n+=this._points[a],r+=this._points[a+1],i+=this._points[a+2];this._centroid=[n/e,r/e,i/e]}get color(){return this._color}set color(e){this._color=e}get points(){return this._points}set points(e){this._points=e,this._updateCentroid()}get polys(){return this._polys}set polys(e){this._polys=e}get segmentIndex(){return this._segmentIndex}get visible(){return this._visible}set visible(e){this._visible=e}get centroid(){return this._centroid}get flatPointsArray(){return this._points}get totalNumberOfPoints(){return this._points.length/3}}function I9(t){return new TextDecoder("latin1").decode(t)}function eU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=I9(t),i=e.exec(r);if(!i)return{text:r};const a=i.index+i[0].length,o=r.substring(0,a);let s=null;const c=n?n.exec(r):null;if(c){const l=r.substr(c.index);s={text:o+l,binaryBuffer:t.slice(a,c.index)}}else s={text:o,binaryBuffer:t.slice(a)};return s}var xl={arrayBufferToString:I9,extractBinary:eU};const c2={};function P9(t){return!!c2[t]}function tU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return c2[t](e)}function V9(t,e){c2[t]=e}var zl={get:tU,has:P9,registerType:V9};function k9(){const t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,n[0]===3569595041?"LittleEndian":n[0]===2712847316?"BigEndian":null}const nU=k9();function rU(t,e){if(e<2)return;const n=new Int8Array(t),r=n.length,i=[];for(let a=0;a<r;a+=e){for(let o=0;o<e;o++)i.push(n[a+o]);for(let o=0;o<e;o++)n[a+o]=i.pop()}}var Vp={ENDIANNESS:nU,getEndianness:k9,swapBytes:rU};const{vtkErrorMacro:U9,vtkDebugMacro:iU}=J,u2=()=>(U9("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead.")));let Xc=0;function Uh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new XMLHttpRequest;return r.open(t,e,!0),n.headers&&Object.entries(n.headers).forEach(i=>{let[a,o]=i;return r.setRequestHeader(a,o)}),n.progressCallback&&r.addEventListener("progress",n.progressCallback),r}function aU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{const i=Uh("GET",t,e);i.onreadystatechange=a=>{i.readyState===4&&(i.status===200||i.status===0?n(i.response):r({xhr:i,e:a}))},i.responseType="arraybuffer",i.send()})}function oU(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r&&r.compression?u2():n.ref&&!n.ref.pending?new Promise((i,a)=>{const o=[e,n.ref.basepath,n.ref.id].join("/"),s=Uh("GET",o,r);s.onreadystatechange=c=>{s.readyState===1&&(n.ref.pending=!0,++Xc===1&&t?.invokeBusy&&t.invokeBusy(!0)),s.readyState===4&&(n.ref.pending=!1,s.status===200||s.status===0?(n.buffer=s.response,n.ref.encode==="JSON"?n.values=JSON.parse(n.buffer):(Vp.ENDIANNESS!==n.ref.encode&&Vp.ENDIANNESS&&(iU(`Swap bytes of ${n.name}`),Vp.swapBytes(n.buffer,c4[n.dataType])),n.values=J.newTypedArray(n.dataType,n.buffer)),n.values.length!==n.size&&U9(`Error in FetchArray: ${n.name}, does not have the proper array size. Got ${n.values.length}, instead of ${n.size}`),delete n.ref,--Xc===0&&t?.invokeBusy&&t.invokeBusy(!1),t?.modified&&t.modified(),i(n)):a({xhr:s,e:c}))},s.responseType=n.dataType!=="string"?"arraybuffer":"text",s.send()}):Promise.resolve(n)}function sU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?u2():new Promise((r,i)=>{const a=Uh("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++Xc===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--Xc===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(JSON.parse(a.responseText)):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function cU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?u2():new Promise((r,i)=>{const a=Uh("GET",e,n);a.onreadystatechange=o=>{a.readyState===1&&++Xc===1&&t?.invokeBusy&&t.invokeBusy(!0),a.readyState===4&&(--Xc===0&&t?.invokeBusy&&t.invokeBusy(!1),a.status===200||a.status===0?r(a.responseText):i({xhr:a,e:o}))},a.responseType="text",a.send()})}function uU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((r,i)=>{const a=new Image;n.crossOrigin&&(a.crossOrigin=n.crossOrigin),a.onload=()=>r(a),a.onerror=i,a.src=e})}const lU={fetchArray:oU,fetchJSON:sU,fetchText:cU,fetchBinary:aU,fetchImage:uU};P9("http")||V9("http",t=>lU);const kp={ASCII:"ascii",BINARY_LITTLE_ENDIAN:"binary_little_endian"},ey={diffuse_red:"red",diffuse_green:"green",diffuse_blue:"blue"},B9={patternHeader:/ply([\s\S]*)end_header\r?\n/,patternBody:/end_header\s([\s\S]*)$/};function ty(t){let e="",n=0;const r=B9.patternHeader.exec(t);r!==null&&(e=r[1],n=r[0].length);const i={comments:[],elements:[],headerLength:n},a=e.split(`
`);let o,s,c;for(let l=0;l<a.length;l++){let f=a[l];if(f=f.trim(),f!==""){let u;switch(c=f.split(/\s+/),s=c.shift(),f=c.join(" "),s){case"format":i.format=c[0],i.version=c[1];break;case"comment":i.comments.push(f);break;case"element":o!==void 0&&i.elements.push(o),o={},o.name=c[0],o.count=parseInt(c[1],10),o.properties=[];break;case"property":u={type:c[0]},u.type==="list"?(u.name=c[3],u.countType=c[1],u.itemType=c[2]):u.name=c[1],u.name in ey&&(u.name=ey[u.name]),o.properties.push(u);break;case"obj_info":i.objInfo=f;break;default:console.warn("unhandled",s,c);break}}}return o!==void 0&&i.elements.push(o),i}function ny(t,e){const n=e.find(g=>g.name==="vertex"),r=e.find(g=>g.name==="face");let i=0,a=0;n&&(i=n.count),r&&(a=r.count);const o=new Float32Array(i*3),s=new Uint8Array(i*3),c=new Float32Array(i*2),l=new Float32Array(i*3),f=t.colors.length>0,u=t.uvs.length>0,h=t.normals.length>0,p=t.faceVertexUvs.length>0;for(let g=0;g<i;g++){let y=g*3+0,x=g*3+1;const m=g*3+2;o[y]=t.vertices[y],o[x]=t.vertices[x],o[m]=t.vertices[m],f&&(s[y]=t.colors[y],s[x]=t.colors[x],s[m]=t.colors[m]),u&&(y=g*2+0,x=g*2+1,c[y]=t.uvs[y],c[x]=t.uvs[x]),h&&(l[y]=t.normals[y],l[x]=t.normals[x],l[m]=t.normals[m])}if(!u&&p){let g=0,y=0;for(let x=0;x<a;++x){const m=t.indices[g++],v=t.faceVertexUvs[y++];if(v&&m*2===v.length)for(let w=0;w<m;++w){const C=t.indices[g++];c[C*2+0]=v[w*2+0],c[C*2+1]=v[w*2+1]}else g+=m}}const d=Kn.newInstance();if(d.getPoints().setData(o,3),f&&d.getPointData().setScalars(ft.newInstance({numberOfComponents:3,values:s,name:"Scalars"})),u||p){const g=ft.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"}),y=d.getPointData();y.addArray(g),y.setActiveTCoords(g.getName())}return h&&d.getPointData().setNormals(ft.newInstance({numberOfComponents:3,name:"Normals",values:l})),d.getPolys().setData(Uint32Array.from(t.indices)),d}function Up(t,e){let n;switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":n=parseInt(t,10);break;case"float":case"double":case"float32":case"float64":n=parseFloat(t);break;default:console.log("Unsupported type");break}return n}function fU(t,e){const n=e.split(/\s+/),r={};for(let i=0;i<t.length;i++)if(t[i].type==="list"){const a=[],o=Up(n.shift(),t[i].countType);for(let s=0;s<o;s++)a.push(Up(n.shift(),t[i].itemType));r[t[i].name]=a}else r[t[i].name]=Up(n.shift(),t[i].type);return r}function ry(t,e,n){if(e==="vertex")t.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&t.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n?t.uvs.push(n.s,n.t):"u"in n&&"v"in n?t.uvs.push(n.u,n.v):"texture_u"in n&&"texture_v"in n&&t.uvs.push(n.texture_u,n.texture_v),"red"in n&&"green"in n&&"blue"in n&&t.colors.push(n.red,n.green,n.blue);else if(e==="face"){const r=n.vertex_indices||n.vertex_index,i=n.texcoord;r&&r.length>0&&(t.indices.push(r.length),r.forEach((a,o)=>{t.indices.push(a)})),t.faceVertexUvs.push(i)}}function Bp(t,e,n,r){let i;switch(n){case"int8":case"char":i=[t.getInt8(e),1];break;case"uint8":case"uchar":i=[t.getUint8(e),1];break;case"int16":case"short":i=[t.getInt16(e,r),2];break;case"uint16":case"ushort":i=[t.getUint16(e,r),2];break;case"int32":case"int":i=[t.getInt32(e,r),4];break;case"uint32":case"uint":i=[t.getUint32(e,r),4];break;case"float32":case"float":i=[t.getFloat32(e,r),4];break;case"float64":case"double":i=[t.getFloat64(e,r),8];break;default:console.log("Unsupported type");break}return i}function hU(t,e,n,r){const i={};let a,o=0;for(let s=0;s<n.length;s++)if(n[s].type==="list"){const c=[];a=Bp(t,e+o,n[s].countType,r);const l=a[0];o+=a[1];for(let f=0;f<l;f++)a=Bp(t,e+o,n[s].itemType,r),c.push(a[0]),o+=a[1];i[n[s].name]=c}else a=Bp(t,e+o,n[s].type,r),i[n[s].name]=a[0],o+=a[1];return[i,o]}function pU(t,e){e.classHierarchy.push("vtkPLYReader"),e.dataAccessHelper||(e.dataAccessHelper=zl.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{compression:a,progressCallback:o}=e;return i.binary?e.dataAccessHelper.fetchBinary(r,{compression:a,progressCallback:o}):e.dataAccessHelper.fetchText(t,r,{compression:a,progressCallback:o})}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),e.compression=i.compression,t.loadData({progressCallback:i.progressCallback,binary:!!i.binary})},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=n(e.url,r);return i.then(t.parse),i},t.parse=r=>{typeof r=="string"?t.parseAsText(r):t.parseAsArrayBuffer(r)},t.parseAsArrayBuffer=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;const i=xl.arrayBufferToString(r),a=ty(i);if(!(a.format!==kp.ASCII)){t.parseAsText(r);return}e.parseData=r;const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},c=a.format===kp.BINARY_LITTLE_ENDIAN,l=r instanceof ArrayBuffer?r:r.buffer,f=new DataView(l,a.headerLength);let u,h=0;for(let d=0;d<a.elements.length;d++)for(let g=0;g<a.elements[d].count;g++){u=hU(f,h,a.elements[d].properties,c),h+=u[1];const y=u[0];ry(s,a.elements[d].name,y)}const p=ny(s,a.elements);e.output[0]=p},t.parseAsText=r=>{if(!r)return;if(r!==e.parseData)t.modified();else return;e.parseData=r;const i=xl.arrayBufferToString(r),a=ty(i);if(a.format!==kp.ASCII){t.parseAsArrayBuffer(r);return}const s={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},c=B9.patternBody.exec(i);let l="";c!==null&&(l=c[1]);const f=l.split(`
`);let u=0,h=0;for(let d=0;d<f.length;d++){let g=f[d];if(g=g.trim(),g!==""){h>=a.elements[u].count&&(u++,h=0);const y=fU(a.elements[u].properties,g);ry(s,a.elements[u].name,y),h++}}const p=ny(s,a.elements);e.output[0]=p},t.requestData=(r,i)=>{t.parse(e.parseData)}}const dU={};function G9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dU,n),J.obj(t,e),J.get(t,e,["url","baseURL"]),J.setGet(t,e,["dataAccessHelper"]),J.algo(t,e,0,1),pU(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const gU=J.newInstance(G9,"vtkPLYReader");var mU={extend:G9,newInstance:gU};const{vtkErrorMacro:Gp}=J;function vU(t){const n=t.split(" ").filter(i=>i.indexOf("=")>-1),r={};for(let i=0;i<n.length;++i){const o=n[i].split("=");o.length===2&&(r[o[0]]=o[1])}return r}function iy(t,e){for(let n=0;n<t.length;n++)e.push(t[n])}function yU(t,e,n,r,i){const a=t[e];if(a===void 0)return-1;if(a.indexOf("endfacet")!==-1||a.indexOf("facet")===-1)return e+1;let o=0,s=2;const c=n.length/3,l=a.split(/[ \t]+/).filter(f=>f).slice(-3).map(Number);for(iy(l,i);t[e+s].indexOf("vertex")!==-1;){const u=t[e+s].split(/[ \t]+/).filter(h=>h).slice(-3).map(Number);iy(u,n),o++,s++}r.push(o);for(let f=0;f<o;f++)r.push(c+f);for(;t[e+s]&&t[e+s].indexOf("endfacet")!==-1;)s++;return e+s+2}function xU(t,e){e.classHierarchy.push("vtkSTLReader"),e.dataAccessHelper||(e.dataAccessHelper=zl.get("http"));function n(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=a.compression!==void 0?a.compression:e.compression,s=a.progressCallback!==void 0?a.progressCallback:e.progressCallback;return a.binary?e.dataAccessHelper.fetchBinary(i,{compression:o,progressCallback:s}):e.dataAccessHelper.fetchText(t,i,{compression:o,progressCallback:s})}function r(i){const a=e.output[0],o=a.getPoints().getData(),s=a.getPolys().getData();if(!o||!s){console.warn("No valid polydata.");return}const c=new Map,l=new Map;let f=0,u=!1;for(let g=0;g<o.length;g+=3){const y=(o[g]*10**i).toFixed(0),x=(o[g+1]*10**i).toFixed(0),m=(o[g+2]*10**i).toFixed(0),v=`${y},${x},${m}`;c.get(v)!==void 0?(l.set(g/3,c.get(v)),u=!0):(l.set(g/3,f),c.set(v,f),f++)}const h=new Float32Array(c.size*3),p=Array.from(c.keys());for(let g=0;g<p.length;g++){const y=p[g],x=c.get(y)*3,m=y.split(",").map(v=>+v*10**-i);h[x]=m[0],h[x+1]=m[1],h[x+2]=m[2]}const d=new Int32Array(s);for(let g=0;g<s.length;g+=4)d[g]=3,d[g+1]=l.get(s[g+1]),d[g+2]=l.get(s[g+2]),d[g+3]=l.get(s[g+3]);a.getPoints().setData(h),a.getPolys().setData(d),u&&t.modified()}t.setUrl=function(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=i;const o=i.split("/");return o.pop(),e.baseURL=o.join("/"),t.loadData(a)},t.loadData=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=n(e.url,i);return a.then(t.parse),a},t.parse=i=>{typeof i=="string"?t.parseAsText(i):t.parseAsArrayBuffer(i)},t.parseAsArrayBuffer=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;let a=!1;if(a=84+new DataView(i,0,84).getUint32(80,!0)*50===i.byteLength,!a){t.parseAsText(xl.arrayBufferToString(i));return}const c=i.slice(0,80),l=xl.arrayBufferToString(c),f=vU(l),u=new DataView(i,84),h=(i.byteLength-84)/50,p=new Float32Array(h*9),d=new Float32Array(h*3),g=new Uint32Array(h*4),y=new Uint16Array(h);let x=0;for(let w=0;w<h;w++){const C=w*50;d[w*3+0]=u.getFloat32(C+0,!0),d[w*3+1]=u.getFloat32(C+4,!0),d[w*3+2]=u.getFloat32(C+8,!0),p[w*9+0]=u.getFloat32(C+12,!0),p[w*9+1]=u.getFloat32(C+16,!0),p[w*9+2]=u.getFloat32(C+20,!0),p[w*9+3]=u.getFloat32(C+24,!0),p[w*9+4]=u.getFloat32(C+28,!0),p[w*9+5]=u.getFloat32(C+32,!0),p[w*9+6]=u.getFloat32(C+36,!0),p[w*9+7]=u.getFloat32(C+40,!0),p[w*9+8]=u.getFloat32(C+44,!0),g[x++]=3,g[x++]=w*3+0,g[x++]=w*3+1,g[x++]=w*3+2,y[w]=u.getUint16(C+48,!0)}const m="SPACE";if(m in f&&f[m]!=="LPS"){const w=f[m],C=new Float32Array(16);switch(C[15]=1,w[0]){case"L":C[0]=1;break;case"R":C[0]=-1;break;default:Gp(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[1]){case"P":C[5]=1;break;case"A":C[5]=-1;break;default:Gp(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(w[2]){case"S":C[10]=1;break;case"I":C[10]=-1;break;default:Gp(`Can not convert STL file from ${w} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}Ko.buildFromDegree().setMatrix(C).apply(p).apply(d)}const v=Kn.newInstance();v.getPoints().setData(p,3),v.getPolys().setData(g),v.getCellData().setScalars(ft.newInstance({name:"Attribute",values:y})),v.getCellData().setNormals(ft.newInstance({name:"Normals",values:d,numberOfComponents:3})),e.output[0]=v,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.parseAsText=i=>{if(!i)return;if(i!==e.parseData)t.modified();else return;e.parseData=i;const a=i.split(`
`);let o=1;const s=[],c=[],l=[];for(;o!==-1;)o=yU(a,o,s,c,l);const f=Kn.newInstance();f.getPoints().setData(Float32Array.from(s),3),f.getPolys().setData(Uint32Array.from(c)),f.getCellData().setNormals(ft.newInstance({name:"Normals",values:Float32Array.from(l),numberOfComponents:3})),e.output[0]=f,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.requestData=(i,a)=>{t.parse(e.parseData)}}const wU={removeDuplicateVertices:-1};function W9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wU,n),J.obj(t,e),J.get(t,e,["url","baseURL"]),J.setGet(t,e,["dataAccessHelper","removeDuplicateVertices"]),J.algo(t,e,0,1),xU(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const CU=J.newInstance(W9,"vtkSTLReader");var TU={extend:W9,newInstance:CU},af={exports:{}},_U=af.exports,ay;function SU(){return ay||(ay=1,function(t,e){(function(n,r){t.exports=r()})(_U,function(){return function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,s){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:s})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var c in a)i.d(s,c,(function(l){return a[l]}).bind(null,c));return s},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=184)}([function(n,r,i){function a(o){for(var s in o)r.hasOwnProperty(s)||(r[s]=o[s])}Object.defineProperty(r,"__esModule",{value:!0}),a(i(240)),a(i(251)),a(i(175)),a(i(107)),a(i(29)),a(i(73)),a(i(106)),a(i(30)),a(i(252)),a(i(52)),a(i(97)),a(i(253)),a(i(37)),a(i(51)),a(i(173)),a(i(176)),a(i(172)),a(i(108)),a(i(254)),a(i(255)),a(i(256)),a(i(72)),a(i(177)),a(i(105)),a(i(17)),a(i(257)),a(i(12)),a(i(174))},function(n,r,i){var a=this&&this.__values||function(v){var w=typeof Symbol=="function"&&Symbol.iterator,C=w&&v[w],T=0;if(C)return C.call(v);if(v&&typeof v.length=="number")return{next:function(){return v&&T>=v.length&&(v=void 0),{value:v&&v[T++],done:!v}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(212);r.FixedSizeSet=o.FixedSizeSet;var s=i(213);r.ObjectCache=s.ObjectCache;var c=i(214);r.CompareCache=c.CompareCache;var l=i(215);r.Lazy=l.Lazy;var f=i(216);function u(v,w,C){if(x(v))v.forEach(function(_,S){return w.call(C,S,_)});else for(var T in v)v.hasOwnProperty(T)&&w.call(C,T,v[T])}function h(v){var w,C;if(p(v))return v;if(g(v)){var T=[];try{for(var _=a(v),S=_.next();!S.done;S=_.next()){var b=S.value;T.push(h(b))}}catch(R){w={error:R}}finally{try{S&&!S.done&&(C=_.return)&&C.call(_)}finally{if(w)throw w.error}}return T}if(d(v)){T={};for(var D in v)if(v.hasOwnProperty(D)){var E=v[D];T[D]=h(E)}return T}return v}function p(v){return!!v&&Object.prototype.toString.call(v)==="[object Function]"}function d(v){var w=typeof v;return!!v&&(w==="function"||w==="object")}function g(v){return Array.isArray(v)}function y(v){return v instanceof Set}function x(v){return v instanceof Map}function m(v){if(d(v)){var w=Object.getPrototypeOf(v),C=w.constructor;return w&&C&&typeof C=="function"&&C instanceof C&&Function.prototype.toString.call(C)===Function.prototype.toString.call(Object)}return!1}r.StringWalker=f.StringWalker,r.applyMixin=function(v,w){for(var C=[],T=2;T<arguments.length;T++)C[T-2]=arguments[T];Object.getOwnPropertyNames(w.prototype).forEach(function(_){if(_!=="constructor"){if(C.indexOf(_)!==-1){var S=Object.getOwnPropertyDescriptor(v.prototype,_);S&&Object.defineProperty(v.prototype,"_"+_,S)}var b=Object.getOwnPropertyDescriptor(w.prototype,_);b&&Object.defineProperty(v.prototype,_,b)}})},r.applyDefaults=function v(w,C,T){T===void 0&&(T=!1);var _=h(w||{});return u(C,function(S,b){m(b)?_[S]=v(_[S],b,T):(T||_[S]===void 0)&&(_[S]=b)}),_},r.forEachArray=function(v,w,C){v.forEach(w,C)},r.forEachObject=u,r.arrayLength=function(v){return y(v)?v.size:v.length},r.objectLength=function(v){return x(v)?v.size:Object.keys(v).length},r.getObjectValue=function(v,w){return x(v)?v.get(w):v[w]},r.removeObjectValue=function(v,w){x(v)?v.delete(w):delete v[w]},r.clone=h,r.isBoolean=function(v){return typeof v=="boolean"},r.isNumber=function(v){return typeof v=="number"},r.isString=function(v){return typeof v=="string"},r.isFunction=p,r.isObject=d,r.isArray=g,r.isSet=y,r.isMap=x,r.isEmpty=function(v){if(g(v))return!v.length;if(y(v)||x(v))return!v.size;if(d(v)){for(var w in v)if(v.hasOwnProperty(w))return!1;return!0}return!1},r.isPlainObject=m,r.isIterable=function(v){return v&&typeof v[Symbol.iterator]=="function"},r.getValue=function(v){return p(v.valueOf)?v.valueOf():v},r.utf8Encode=function(v){for(var w=new Uint8Array(4*v.length),C=0,T=0;T<v.length;T++){var _=v.charCodeAt(T);if(_<128)w[C++]=_;else{if(_<2048)w[C++]=_>>6|192;else{if(_>55295&&_<56320){if(++T>=v.length)throw new Error("Incomplete surrogate pair.");var S=v.charCodeAt(T);if(S<56320||S>57343)throw new Error("Invalid surrogate character.");_=65536+((1023&_)<<10)+(1023&S),w[C++]=_>>18|240,w[C++]=_>>12&63|128}else w[C++]=_>>12|224;w[C++]=_>>6&63|128}w[C++]=63&_|128}}return w.subarray(0,C)},r.utf8Decode=function(v){for(var w="",C=0;C<v.length;){var T=v[C++];if(T>127)if(T>191&&T<224){if(C>=v.length)throw new Error("Incomplete 2-byte sequence.");T=(31&T)<<6|63&v[C++]}else if(T>223&&T<240){if(C+1>=v.length)throw new Error("Incomplete 3-byte sequence.");T=(15&T)<<12|(63&v[C++])<<6|63&v[C++]}else{if(!(T>239&&T<248))throw new Error("Unknown multi-byte start.");if(C+2>=v.length)throw new Error("Incomplete 4-byte sequence.");T=(7&T)<<18|(63&v[C++])<<12|(63&v[C++])<<6|63&v[C++]}if(T<=65535)w+=String.fromCharCode(T);else{if(!(T<=1114111))throw new Error("Code point exceeds UTF-16 limit.");T-=65536,w+=String.fromCharCode(T>>10|55296),w+=String.fromCharCode(1023&T|56320)}}return w}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),function(a){a[a.Before=0]="Before",a[a.Equal=1]="Equal",a[a.After=2]="After"}(r.BoundaryPosition||(r.BoundaryPosition={})),function(a){a[a.None=0]="None",a[a.Capturing=1]="Capturing",a[a.AtTarget=2]="AtTarget",a[a.Bubbling=3]="Bubbling"}(r.EventPhase||(r.EventPhase={})),function(a){a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=3]="Text",a[a.CData=4]="CData",a[a.EntityReference=5]="EntityReference",a[a.Entity=6]="Entity",a[a.ProcessingInstruction=7]="ProcessingInstruction",a[a.Comment=8]="Comment",a[a.Document=9]="Document",a[a.DocumentType=10]="DocumentType",a[a.DocumentFragment=11]="DocumentFragment",a[a.Notation=12]="Notation"}(r.NodeType||(r.NodeType={})),function(a){a[a.Disconnected=1]="Disconnected",a[a.Preceding=2]="Preceding",a[a.Following=4]="Following",a[a.Contains=8]="Contains",a[a.ContainedBy=16]="ContainedBy",a[a.ImplementationSpecific=32]="ImplementationSpecific"}(r.Position||(r.Position={})),function(a){a[a.Accept=1]="Accept",a[a.Reject=2]="Reject",a[a.Skip=3]="Skip"}(r.FilterResult||(r.FilterResult={})),function(a){a[a.All=4294967295]="All",a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=4]="Text",a[a.CDataSection=8]="CDataSection",a[a.EntityReference=16]="EntityReference",a[a.Entity=32]="Entity",a[a.ProcessingInstruction=64]="ProcessingInstruction",a[a.Comment=128]="Comment",a[a.Document=256]="Document",a[a.DocumentType=512]="DocumentType",a[a.DocumentFragment=1024]="DocumentFragment",a[a.Notation=2048]="Notation"}(r.WhatToShow||(r.WhatToShow={})),function(a){a[a.StartToStart=0]="StartToStart",a[a.StartToEnd=1]="StartToEnd",a[a.EndToEnd=2]="EndToEnd",a[a.EndToStart=3]="EndToStart"}(r.HowToCompare||(r.HowToCompare={}))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(241);r.Cast=a.Cast;var o=i(150);r.Guard=o.Guard;var s=i(242);r.EmptySet=s.EmptySet},function(n,r,i){var a=i(11),o=i(55).f,s=i(21),c=i(25),l=i(80),f=i(119),u=i(123);n.exports=function(h,p){var d,g,y,x,m,v=h.target,w=h.global,C=h.stat;if(d=w?a:C?a[v]||l(v,{}):(a[v]||{}).prototype)for(g in p){if(x=p[g],y=h.noTargetGet?(m=o(d,g))&&m.value:d[g],!u(w?g:v+(C?".":"#")+g,h.forced)&&y!==void 0){if(typeof x==typeof y)continue;f(x,y)}(h.sham||y&&y.sham)&&s(x,"sham",!0),c(d,g,x,h)}}},function(n,r,i){var a=i(11),o=i(81),s=i(14),c=i(58),l=i(86),f=i(124),u=o("wks"),h=a.Symbol,p=f?h:h&&h.withoutSetter||c;n.exports=function(d){return s(u,d)||(l&&s(h,d)?u[d]=h[d]:u[d]=p("Symbol."+d)),u[d]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(29),s=function(){function c(){this._features={mutationObservers:!0,customElements:!0,slots:!0,steps:!0},this._window=null,this._compareCache=new a.CompareCache,this._rangeList=new a.FixedSizeSet}return c.prototype.setFeatures=function(l){if(l===void 0&&(l=!0),a.isObject(l))for(var f in l)this._features[f]=l[f]||!1;else for(var f in this._features)this._features[f]=l},Object.defineProperty(c.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"window",{get:function(){return this._window===null&&(this._window=o.create_window()),this._window},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"compareCache",{get:function(){return this._compareCache},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"rangeList",{get:function(){return this._rangeList},enumerable:!0,configurable:!0}),Object.defineProperty(c,"instance",{get:function(){return c._instance||(c._instance=new c),c._instance},enumerable:!0,configurable:!0}),c}();r.dom=s.instance},function(n,r,i){var a=this&&this.__importStar||function(m){if(m&&m.__esModule)return m;var v={};if(m!=null)for(var w in m)Object.hasOwnProperty.call(m,w)&&(v[w]=m[w]);return v.default=m,v};Object.defineProperty(r,"__esModule",{value:!0});var o=a(i(228));r.base64=o;var s=a(i(146));r.byte=s;var c=a(i(147));r.byteSequence=c;var l=a(i(96));r.codePoint=l;var f=a(i(232));r.json=f;var u=a(i(233));r.list=u;var h=a(i(234));r.map=h;var p=a(i(235));r.namespace=p;var d=a(i(236));r.queue=d;var g=a(i(237));r.set=g;var y=a(i(238));r.stack=y;var x=a(i(239));r.string=x},function(n,r){n.exports=function(i){try{return!!i()}catch{return!0}}},function(n,r,i){var a,o=this&&this.__extends||(a=function(W,B){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,ie){j.__proto__=ie}||function(j,ie){for(var ae in ie)ie.hasOwnProperty(ae)&&(j[ae]=ie[ae])})(W,B)},function(W,B){function j(){this.constructor=W}a(W,B),W.prototype=B===null?Object.create(B):(j.prototype=B.prototype,new j)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(W){function B(j,ie){ie===void 0&&(ie="");var ae=W.call(this,ie)||this;return ae.name=j,ae}return o(B,W),B}(Error);r.DOMException=s;var c=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"DOMStringSizeError",j)||this}return o(B,W),B}(s);r.DOMStringSizeError=c;var l=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"WrongDocumentError","The object is in the wrong document. "+j)||this}return o(B,W),B}(s);r.WrongDocumentError=l;var f=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NoDataAllowedError",j)||this}return o(B,W),B}(s);r.NoDataAllowedError=f;var u=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NoModificationAllowedError","The object can not be modified. "+j)||this}return o(B,W),B}(s);r.NoModificationAllowedError=u;var h=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NotSupportedError","The operation is not supported. "+j)||this}return o(B,W),B}(s);r.NotSupportedError=h;var p=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InUseAttributeError",j)||this}return o(B,W),B}(s);r.InUseAttributeError=p;var d=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InvalidStateError","The object is in an invalid state. "+j)||this}return o(B,W),B}(s);r.InvalidStateError=d;var g=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InvalidModificationError","The object can not be modified in this way. "+j)||this}return o(B,W),B}(s);r.InvalidModificationError=g;var y=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NamespaceError","The operation is not allowed by Namespaces in XML. [XMLNS] "+j)||this}return o(B,W),B}(s);r.NamespaceError=y;var x=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InvalidAccessError","The object does not support the operation or argument. "+j)||this}return o(B,W),B}(s);r.InvalidAccessError=x;var m=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"ValidationError",j)||this}return o(B,W),B}(s);r.ValidationError=m;var v=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"TypeMismatchError",j)||this}return o(B,W),B}(s);r.TypeMismatchError=v;var w=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"SecurityError","The operation is insecure. "+j)||this}return o(B,W),B}(s);r.SecurityError=w;var C=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NetworkError","A network error occurred. "+j)||this}return o(B,W),B}(s);r.NetworkError=C;var T=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"AbortError","The operation was aborted. "+j)||this}return o(B,W),B}(s);r.AbortError=T;var _=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"URLMismatchError","The given URL does not match another URL. "+j)||this}return o(B,W),B}(s);r.URLMismatchError=_;var S=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"QuotaExceededError","The quota has been exceeded. "+j)||this}return o(B,W),B}(s);r.QuotaExceededError=S;var b=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"TimeoutError","The operation timed out. "+j)||this}return o(B,W),B}(s);r.TimeoutError=b;var D=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InvalidNodeTypeError","The supplied node is incorrect or has an incorrect ancestor for this operation. "+j)||this}return o(B,W),B}(s);r.InvalidNodeTypeError=D;var E=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"DataCloneError","The object can not be cloned. "+j)||this}return o(B,W),B}(s);r.DataCloneError=E;var R=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NotImplementedError","The DOM method is not implemented by this module. "+j)||this}return o(B,W),B}(s);r.NotImplementedError=R;var F=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"HierarchyRequestError","The operation would yield an incorrect node tree. "+j)||this}return o(B,W),B}(s);r.HierarchyRequestError=F;var M=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"NotFoundError","The object can not be found here. "+j)||this}return o(B,W),B}(s);r.NotFoundError=M;var U=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"IndexSizeError","The index is not in the allowed range. "+j)||this}return o(B,W),B}(s);r.IndexSizeError=U;var z=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"SyntaxError","The string did not match the expected pattern. "+j)||this}return o(B,W),B}(s);r.SyntaxError=z;var Y=function(W){function B(j){return j===void 0&&(j=""),W.call(this,"InvalidCharacterError","The string contains invalid characters. "+j)||this}return o(B,W),B}(s);r.InvalidCharacterError=Y},function(n,r,i){var a=i(53),o=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],s=["scalar","sequence","mapping"];n.exports=function(c,l){var f,u;if(l=l||{},Object.keys(l).forEach(function(h){if(o.indexOf(h)===-1)throw new a('Unknown option "'+h+'" is met in definition of "'+c+'" YAML type.')}),this.tag=c,this.kind=l.kind||null,this.resolve=l.resolve||function(){return!0},this.construct=l.construct||function(h){return h},this.instanceOf=l.instanceOf||null,this.predicate=l.predicate||null,this.represent=l.represent||null,this.defaultStyle=l.defaultStyle||null,this.styleAliases=(f=l.styleAliases||null,u={},f!==null&&Object.keys(f).forEach(function(h){f[h].forEach(function(p){u[String(p)]=h})}),u),s.indexOf(this.kind)===-1)throw new a('Unknown kind "'+this.kind+'" is specified for "'+c+'" YAML type.')}},function(n,r,i){(function(a){var o=function(s){return s&&s.Math==Math&&s};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof a=="object"&&a)||Function("return this")()}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.idl_defineConst=function(a,o,s){Object.defineProperty(a,o,{writable:!1,enumerable:!0,configurable:!1,value:s})}},function(n,r){n.exports=function(i){return typeof i=="object"?i!==null:typeof i=="function"}},function(n,r){var i={}.hasOwnProperty;n.exports=function(a,o){return i.call(a,o)}},function(n,r,i){var a=i(16),o=i(115),s=i(18),c=i(56),l=Object.defineProperty;r.f=a?l:function(f,u,h){if(s(f),u=c(u,!0),s(h),o)try{return l(f,u,h)}catch{}if("get"in h||"set"in h)throw TypeError("Accessors not supported");return"value"in h&&(f[u]=h.value),f}},function(n,r,i){var a=i(8);n.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(n,r,i){var a=this&&this.__values||function(v){var w=typeof Symbol=="function"&&Symbol.iterator,C=w&&v[w],T=0;if(C)return C.call(v);if(v&&typeof v.length=="number")return{next:function(){return v&&T>=v.length&&(v=void 0),{value:v&&v[T++],done:!v}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(2);function c(v,w,C){if(C===void 0&&(C=!1),C&&o.Guard.isElementNode(w)&&o.Guard.isShadowRoot(w.shadowRoot)&&w.shadowRoot._firstChild)return w.shadowRoot._firstChild;if(w._firstChild)return w._firstChild;if(w===v)return null;if(w._nextSibling)return w._nextSibling;for(var T=w._parent;T&&T!==v;){if(T._nextSibling)return T._nextSibling;T=T._parent}return null}function l(){var v;return(v={})[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:null}}}},v}function f(v,w,C,T){w===void 0&&(w=!1),C===void 0&&(C=!1);for(var _=w?v:c(v,v,C);_&&T&&!T(_);)_=c(v,_,C);return _}function u(v,w,C,T,_){T===void 0&&(T=!1);for(var S=c(v,w,T);S&&_&&!_(S);)S=c(v,S,T);return S}function h(v,w,C,T){var _;return w===void 0&&(w=!1),C===void 0&&(C=!1),w||v._children.size!==0?((_={})[Symbol.iterator]=function(){var S=w?v:c(v,v,C);return{next:function(){for(;S&&T&&!T(S);)S=c(v,S,C);if(S===null)return{done:!0,value:null};var b={done:!1,value:S};return S=c(v,S,C),b}}},_):l()}function p(v,w,C){w===void 0&&(w=!1);for(var T=w?v:v._parent;T&&C&&!C(T);)T=T._parent;return T}function d(v,w,C,T){for(var _=w._parent;_&&T&&!T(_);)_=_._parent;return _}function g(v){return o.Guard.isDocumentTypeNode(v)?0:o.Guard.isCharacterDataNode(v)?v._data.length:v._children.size}function y(v,w){if(w===void 0&&(w=!1),w){var C=y(v,!1);return o.Guard.isShadowRoot(C)?y(C._host,!0):C}return v._parent?y(v._parent):v}function x(v,w,C,T){C===void 0&&(C=!1),T===void 0&&(T=!1);for(var _=C?v:T&&o.Guard.isShadowRoot(v)?v._host:v._parent;_!==null;){if(_===w)return!0;_=T&&o.Guard.isShadowRoot(_)?_._host:_._parent}return!1}function m(v){for(var w=y(v),C=0,T=f(w);T!==null;){if(C++,T===v)return C;T=u(w,T)}return-1}r.tree_getFirstDescendantNode=f,r.tree_getNextDescendantNode=u,r.tree_getDescendantNodes=h,r.tree_getDescendantElements=function(v,w,C,T){var _;return w===void 0&&(w=!1),C===void 0&&(C=!1),w||v._children.size!==0?((_={})[Symbol.iterator]=function(){var S=h(v,w,C,function(D){return o.Guard.isElementNode(D)})[Symbol.iterator](),b=S.next().value;return{next:function(){for(;b&&T&&!T(b);)b=S.next().value;if(b===null)return{done:!0,value:null};var D={done:!1,value:b};return b=S.next().value,D}}},_):l()},r.tree_getSiblingNodes=function(v,w,C){var T;return w===void 0&&(w=!1),v._parent&&v._parent._children.size!==0?((T={})[Symbol.iterator]=function(){var _=v._parent?v._parent._firstChild:null;return{next:function(){for(;_&&(C&&!C(_)||!w&&_===v);)_=_._nextSibling;if(_===null)return{done:!0,value:null};var S={done:!1,value:_};return _=_._nextSibling,S}}},T):l()},r.tree_getFirstAncestorNode=p,r.tree_getNextAncestorNode=d,r.tree_getAncestorNodes=function(v,w,C){var T;return w===void 0&&(w=!1),w||v._parent?((T={})[Symbol.iterator]=function(){var _=p(v,w,C);return{next:function(){if(_===null)return{done:!0,value:null};var S={done:!1,value:_};return _=d(0,_,w,C),S}}},T):l()},r.tree_getCommonAncestor=function(v,w){if(v===w)return v._parent;for(var C=[],T=[],_=p(v,!0);_!==null;)C.push(_),_=d(0,_);for(var S=p(w,!0);S!==null;)T.push(S),S=d(0,S);for(var b=C.length,D=T.length,E=null,R=Math.min(b,D);R>0;R--){var F=C[--b];if(F!==T[--D])break;E=F}return E},r.tree_getFollowingNode=function(v,w){if(w._firstChild)return w._firstChild;if(w._nextSibling)return w._nextSibling;for(;;){var C=w._parent;if(C===null||C===v)return null;if(C._nextSibling)return C._nextSibling;w=C}},r.tree_getPrecedingNode=function(v,w){return w===v?null:w._previousSibling?(w=w._previousSibling)._lastChild?w._lastChild:w:w._parent},r.tree_isConstrained=function v(w){var C,T,_,S,b,D;switch(w._nodeType){case s.NodeType.Document:var E=!1,R=!1;try{for(var F=a(w._children),M=F.next();!M.done;M=F.next())switch(M.value._nodeType){case s.NodeType.ProcessingInstruction:case s.NodeType.Comment:break;case s.NodeType.DocumentType:if(E||R)return!1;E=!0;break;case s.NodeType.Element:if(R)return!1;R=!0;break;default:return!1}}catch(B){C={error:B}}finally{try{M&&!M.done&&(T=F.return)&&T.call(F)}finally{if(C)throw C.error}}break;case s.NodeType.DocumentFragment:case s.NodeType.Element:try{for(var U=a(w._children),z=U.next();!z.done;z=U.next())switch(z.value._nodeType){case s.NodeType.Element:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:break;default:return!1}}catch(B){_={error:B}}finally{try{z&&!z.done&&(S=U.return)&&S.call(U)}finally{if(_)throw _.error}}break;case s.NodeType.DocumentType:case s.NodeType.Text:case s.NodeType.ProcessingInstruction:case s.NodeType.CData:case s.NodeType.Comment:return!w.hasChildNodes()}try{for(var Y=a(w._children),W=Y.next();!W.done;W=Y.next())if(!v(W.value))return!1}catch(B){b={error:B}}finally{try{W&&!W.done&&(D=Y.return)&&D.call(Y)}finally{if(b)throw b.error}}return!0},r.tree_nodeLength=g,r.tree_isEmpty=function(v){return g(v)===0},r.tree_rootNode=y,r.tree_isDescendantOf=function(v,w,C,T){C===void 0&&(C=!1),T===void 0&&(T=!1);for(var _=f(v,C,T);_!==null;){if(_===w)return!0;_=u(v,_,C,T)}return!1},r.tree_isAncestorOf=x,r.tree_isHostIncludingAncestorOf=function v(w,C,T){if(T===void 0&&(T=!1),x(w,C,T))return!0;var _=y(w);return!(!o.Guard.isDocumentFragmentNode(_)||_._host===null||!v(_._host,C,T))},r.tree_isSiblingOf=function(v,w,C){return C===void 0&&(C=!1),v!==w?v._parent!==null&&v._parent===w._parent:!!C},r.tree_isPreceding=function(v,w){var C=m(v),T=m(w);return C!==-1&&T!==-1&&y(v)===y(w)&&T<C},r.tree_isFollowing=function(v,w){var C=m(v),T=m(w);return C!==-1&&T!==-1&&y(v)===y(w)&&T>C},r.tree_isParentOf=function(v,w){return v._parent===w},r.tree_isChildOf=function(v,w){return w._parent===v},r.tree_previousSibling=function(v){return v._previousSibling},r.tree_nextSibling=function(v){return v._nextSibling},r.tree_firstChild=function(v){return v._firstChild},r.tree_lastChild=function(v){return v._lastChild},r.tree_treePosition=m,r.tree_index=function(v){for(var w=0;v._previousSibling!==null;)w++,v=v._previousSibling;return w},r.tree_retarget=function(v,w){for(;;){if(!v||!o.Guard.isNode(v))return v;var C=y(v);if(!o.Guard.isShadowRoot(C)||w&&o.Guard.isNode(w)&&x(C,w,!0,!0))return v;v=C.host}}},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o))throw TypeError(String(o)+" is not an object");return o}},function(n,r,i){var a=i(24),o=i(130),s=i(49),c=i(43),l=i(88),f=c.set,u=c.getterFor("Array Iterator");n.exports=l(Array,"Array",function(h,p){f(this,{type:"Array Iterator",target:a(h),index:0,kind:p})},function(){var h=u(this),p=h.target,d=h.kind,g=h.index++;return!p||g>=p.length?(h.target=void 0,{value:void 0,done:!0}):d=="keys"?{value:g,done:!1}:d=="values"?{value:p[g],done:!1}:{value:[g,p[g]],done:!1}},"values"),s.Arguments=s.Array,o("keys"),o("values"),o("entries")},function(n,r,i){var a=i(90),o=i(25),s=i(202);a||o(Object.prototype,"toString",s,{unsafe:!0})},function(n,r,i){var a=i(16),o=i(15),s=i(40);n.exports=a?function(c,l,f){return o.f(c,l,s(1,f))}:function(c,l,f){return c[l]=f,c}},function(n,r,i){var a=i(137).charAt,o=i(43),s=i(88),c=o.set,l=o.getterFor("String Iterator");s(String,"String",function(f){c(this,{type:"String Iterator",string:String(f),index:0})},function(){var f,u=l(this),h=u.string,p=u.index;return p>=h.length?{value:void 0,done:!0}:(f=a(h,p),u.index+=f.length,{value:f,done:!1})})},function(n,r,i){var a=i(11),o=i(203),s=i(19),c=i(21),l=i(5),f=l("iterator"),u=l("toStringTag"),h=s.values;for(var p in o){var d=a[p],g=d&&d.prototype;if(g){if(g[f]!==h)try{c(g,f,h)}catch{g[f]=h}if(g[u]||c(g,u,p),o[p]){for(var y in s)if(g[y]!==s[y])try{c(g,y,s[y])}catch{g[y]=s[y]}}}}},function(n,r,i){var a=i(41),o=i(35);n.exports=function(s){return a(o(s))}},function(n,r,i){var a=i(11),o=i(21),s=i(14),c=i(80),l=i(117),f=i(43),u=f.get,h=f.enforce,p=String(String).split("String");(n.exports=function(d,g,y,x){var m=!!x&&!!x.unsafe,v=!!x&&!!x.enumerable,w=!!x&&!!x.noTargetGet;typeof y=="function"&&(typeof g!="string"||s(y,"name")||o(y,"name",g),h(y).source=p.join(typeof g=="string"?g:"")),d!==a?(m?!w&&d[g]&&(v=!0):delete d[g],v?d[g]=y:o(d,g,y)):v?d[g]=y:c(g,y)})(Function.prototype,"toString",function(){return typeof this=="function"&&u(this).source||l(this)})},function(n,r,i){var a=i(47),o=Math.min;n.exports=function(s){return s>0?o(a(s),9007199254740991):0}},function(n,r,i){var a=i(35);n.exports=function(o){return Object(a(o))}},function(n,r,i){var a=i(16),o=i(8),s=i(14),c=Object.defineProperty,l={},f=function(u){throw u};n.exports=function(u,h){if(s(l,u))return l[u];h||(h={});var p=[][u],d=!!s(h,"ACCESSORS")&&h.ACCESSORS,g=s(h,0)?h[0]:f,y=s(h,1)?h[1]:void 0;return l[u]=!!p&&!o(function(){if(d&&!a)return!0;var x={length:-1};d?c(x,1,{enumerable:!0,get:f}):x[1]=1,p.call(x,g,y)})}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(148),o=i(149),s=i(151),c=i(98),l=i(153),f=i(154),u=i(155),h=i(99),p=i(100),d=i(156),g=i(157),y=i(101),x=i(158),m=i(159),v=i(160),w=i(161),C=i(162),T=i(163),_=i(164),S=i(165),b=i(166),D=i(167),E=i(168),R=i(169),F=i(170);r.create_domImplementation=function(M){return a.DOMImplementationImpl._create(M)},r.create_window=function(){return o.WindowImpl._create()},r.create_xmlDocument=function(){return new s.XMLDocumentImpl},r.create_document=function(){return new c.DocumentImpl},r.create_abortController=function(){return new l.AbortControllerImpl},r.create_abortSignal=function(){return f.AbortSignalImpl._create()},r.create_documentType=function(M,U,z,Y){return u.DocumentTypeImpl._create(M,U,z,Y)},r.create_element=function(M,U,z,Y){return h.ElementImpl._create(M,U,z,Y)},r.create_htmlElement=function(M,U,z,Y){return h.ElementImpl._create(M,U,z,Y)},r.create_htmlUnknownElement=function(M,U,z,Y){return h.ElementImpl._create(M,U,z,Y)},r.create_documentFragment=function(M){return p.DocumentFragmentImpl._create(M)},r.create_shadowRoot=function(M,U){return d.ShadowRootImpl._create(M,U)},r.create_attr=function(M,U){return g.AttrImpl._create(M,U)},r.create_text=function(M,U){return y.TextImpl._create(M,U)},r.create_cdataSection=function(M,U){return x.CDATASectionImpl._create(M,U)},r.create_comment=function(M,U){return m.CommentImpl._create(M,U)},r.create_processingInstruction=function(M,U,z){return v.ProcessingInstructionImpl._create(M,U,z)},r.create_htmlCollection=function(M,U){return U===void 0&&(U=function(){return!0}),w.HTMLCollectionImpl._create(M,U)},r.create_nodeList=function(M){return C.NodeListImpl._create(M)},r.create_nodeListStatic=function(M,U){return T.NodeListStaticImpl._create(M,U)},r.create_namedNodeMap=function(M){return _.NamedNodeMapImpl._create(M)},r.create_range=function(M,U){return S.RangeImpl._create(M,U)},r.create_nodeIterator=function(M,U,z){return b.NodeIteratorImpl._create(M,U,z)},r.create_treeWalker=function(M,U){return D.TreeWalkerImpl._create(M,U)},r.create_nodeFilter=function(){return E.NodeFilterImpl._create()},r.create_mutationRecord=function(M,U,z,Y,W,B,j,ie,ae){return R.MutationRecordImpl._create(M,U,z,Y,W,B,j,ie,ae)},r.create_domTokenList=function(M,U){return F.DOMTokenListImpl._create(M,U)}},function(n,r,i){var a=this&&this.__values||function(g){var y=typeof Symbol=="function"&&Symbol.iterator,x=y&&g[y],m=0;if(x)return x.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&m>=g.length&&(g=void 0),{value:g&&g[m++],done:!g}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(17),c=i(3),l=i(72),f=new Map;function u(g,y){if(y!==g._root&&s.tree_isAncestorOf(g._reference,y,!0)){if(g._pointerBeforeReference)for(;;){var x=s.tree_getFollowingNode(g._root,y);if(x!==null&&s.tree_isDescendantOf(g._root,x,!0)&&!s.tree_isDescendantOf(y,x,!0))return void(g._reference=x);if(x===null)return void(g._pointerBeforeReference=!1)}if(y._previousSibling===null)y._parent!==null&&(g._reference=y._parent);else{for(var m=y._previousSibling,v=s.tree_getFirstDescendantNode(y._previousSibling,!0,!1);v!==null;)v!==null&&(m=v),v=s.tree_getNextDescendantNode(y._previousSibling,v,!0,!1);g._reference=m}}}function h(g,y,x,m,v){if(c.Guard.isSlot(g)&&y==="name"&&v===null){if(m===x||m===null&&x===""||m===""&&x===null)return;g._name=m===null||m===""?"":m,l.shadowTree_assignSlotablesForATree(s.tree_rootNode(g))}}function p(g,y,x,m,v){if(c.Guard.isSlotable(g)&&y==="slot"&&v===null){if(m===x||m===null&&x===""||m===""&&x===null)return;g._name=m===null||m===""?"":m,l.shadowTree_isAssigned(g)&&l.shadowTree_assignSlotables(g._assignedSlot),l.shadowTree_assignASlot(g)}}function d(g,y,x,m){y==="id"&&m===null&&(g._uniqueIdentifier=x||void 0)}r.dom_runRemovingSteps=function(g,y){},r.dom_runCloningSteps=function(g,y,x,m){},r.dom_runAdoptingSteps=function(g,y){},r.dom_runAttributeChangeSteps=function(g,y,x,m,v){var w,C;o.dom.features.slots&&(p.call(g,g,y,x,m,v),h.call(g,g,y,x,m,v)),d.call(g,g,y,m,v);try{for(var T=a(g._attributeChangeSteps),_=T.next();!_.done;_=T.next())_.value.call(g,g,y,x,m,v)}catch(S){w={error:S}}finally{try{_&&!_.done&&(C=T.return)&&C.call(T)}finally{if(w)throw w.error}}},r.dom_runInsertionSteps=function(g){},r.dom_runNodeIteratorPreRemovingSteps=function(g,y){u.call(g,g,y)},r.dom_hasSupportedTokens=function(g){return f.has(g)},r.dom_getSupportedTokens=function(g){return f.get(g)||new Set},r.dom_runEventConstructingSteps=function(g){},r.dom_runChildTextContentChangeSteps=function(g){}},function(n,r,i){var a=i(4),o=i(11),s=i(46),c=i(44),l=i(16),f=i(86),u=i(124),h=i(8),p=i(14),d=i(59),g=i(13),y=i(18),x=i(27),m=i(24),v=i(56),w=i(40),C=i(60),T=i(61),_=i(82),S=i(190),b=i(85),D=i(55),E=i(15),R=i(79),F=i(21),M=i(25),U=i(81),z=i(57),Y=i(45),W=i(58),B=i(5),j=i(125),ie=i(126),ae=i(62),fe=i(43),Ee=i(36).forEach,ge=z("hidden"),be=B("toPrimitive"),Re=fe.set,Ne=fe.getterFor("Symbol"),Ce=Object.prototype,P=o.Symbol,O=s("JSON","stringify"),A=D.f,L=E.f,k=S.f,$=R.f,H=U("symbols"),se=U("op-symbols"),me=U("string-to-symbol-registry"),ye=U("symbol-to-string-registry"),_e=U("wks"),K=o.QObject,ne=!K||!K.prototype||!K.prototype.findChild,ce=l&&h(function(){return C(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a!=7})?function(Fe,ze,$e){var Xe=A(Ce,ze);Xe&&delete Ce[ze],L(Fe,ze,$e),Xe&&Fe!==Ce&&L(Ce,ze,Xe)}:L,re=function(Fe,ze){var $e=H[Fe]=C(P.prototype);return Re($e,{type:"Symbol",tag:Fe,description:ze}),l||($e.description=ze),$e},ue=u?function(Fe){return typeof Fe=="symbol"}:function(Fe){return Object(Fe)instanceof P},De=function(Fe,ze,$e){Fe===Ce&&De(se,ze,$e),y(Fe);var Xe=v(ze,!0);return y($e),p(H,Xe)?($e.enumerable?(p(Fe,ge)&&Fe[ge][Xe]&&(Fe[ge][Xe]=!1),$e=C($e,{enumerable:w(0,!1)})):(p(Fe,ge)||L(Fe,ge,w(1,{})),Fe[ge][Xe]=!0),ce(Fe,Xe,$e)):L(Fe,Xe,$e)},te=function(Fe,ze){y(Fe);var $e=m(ze),Xe=T($e).concat(xe($e));return Ee(Xe,function(ot){l&&!Ue.call($e,ot)||De(Fe,ot,$e[ot])}),Fe},Ue=function(Fe){var ze=v(Fe,!0),$e=$.call(this,ze);return!(this===Ce&&p(H,ze)&&!p(se,ze))&&(!($e||!p(this,ze)||!p(H,ze)||p(this,ge)&&this[ge][ze])||$e)},Ye=function(Fe,ze){var $e=m(Fe),Xe=v(ze,!0);if($e!==Ce||!p(H,Xe)||p(se,Xe)){var ot=A($e,Xe);return!ot||!p(H,Xe)||p($e,ge)&&$e[ge][Xe]||(ot.enumerable=!0),ot}},qe=function(Fe){var ze=k(m(Fe)),$e=[];return Ee(ze,function(Xe){p(H,Xe)||p(Y,Xe)||$e.push(Xe)}),$e},xe=function(Fe){var ze=Fe===Ce,$e=k(ze?se:m(Fe)),Xe=[];return Ee($e,function(ot){!p(H,ot)||ze&&!p(Ce,ot)||Xe.push(H[ot])}),Xe};f||(M((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor");var Fe=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,ze=W(Fe),$e=function(Xe){this===Ce&&$e.call(se,Xe),p(this,ge)&&p(this[ge],ze)&&(this[ge][ze]=!1),ce(this,ze,w(1,Xe))};return l&&ne&&ce(Ce,ze,{configurable:!0,set:$e}),re(ze,Fe)}).prototype,"toString",function(){return Ne(this).tag}),M(P,"withoutSetter",function(Fe){return re(W(Fe),Fe)}),R.f=Ue,E.f=De,D.f=Ye,_.f=S.f=qe,b.f=xe,j.f=function(Fe){return re(B(Fe),Fe)},l&&(L(P.prototype,"description",{configurable:!0,get:function(){return Ne(this).description}}),c||M(Ce,"propertyIsEnumerable",Ue,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:P}),Ee(T(_e),function(Fe){ie(Fe)}),a({target:"Symbol",stat:!0,forced:!f},{for:function(Fe){var ze=String(Fe);if(p(me,ze))return me[ze];var $e=P(ze);return me[ze]=$e,ye[$e]=ze,$e},keyFor:function(Fe){if(!ue(Fe))throw TypeError(Fe+" is not a symbol");if(p(ye,Fe))return ye[Fe]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),a({target:"Object",stat:!0,forced:!f,sham:!l},{create:function(Fe,ze){return ze===void 0?C(Fe):te(C(Fe),ze)},defineProperty:De,defineProperties:te,getOwnPropertyDescriptor:Ye}),a({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:qe,getOwnPropertySymbols:xe}),a({target:"Object",stat:!0,forced:h(function(){b.f(1)})},{getOwnPropertySymbols:function(Fe){return b.f(x(Fe))}}),O&&a({target:"JSON",stat:!0,forced:!f||h(function(){var Fe=P();return O([Fe])!="[null]"||O({a:Fe})!="{}"||O(Object(Fe))!="{}"})},{stringify:function(Fe,ze,$e){for(var Xe,ot=[Fe],rt=1;arguments.length>rt;)ot.push(arguments[rt++]);if(Xe=ze,(g(ze)||Fe!==void 0)&&!ue(Fe))return d(ze)||(ze=function(mt,wt){if(typeof Xe=="function"&&(wt=Xe.call(this,mt,wt)),!ue(wt))return wt}),ot[1]=ze,O.apply(null,ot)}}),P.prototype[be]||F(P.prototype,be,P.prototype.valueOf),ae(P,"Symbol"),Y[ge]=!0},function(n,r,i){var a=i(4),o=i(16),s=i(11),c=i(14),l=i(13),f=i(15).f,u=i(119),h=s.Symbol;if(o&&typeof h=="function"&&(!("description"in h.prototype)||h().description!==void 0)){var p={},d=function(){var v=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),w=this instanceof d?new h(v):v===void 0?h():h(v);return v===""&&(p[w]=!0),w};u(d,h);var g=d.prototype=h.prototype;g.constructor=d;var y=g.toString,x=String(h("test"))=="Symbol(test)",m=/^Symbol\((.*)\)[^)]+$/;f(g,"description",{configurable:!0,get:function(){var v=l(this)?this.valueOf():this,w=y.call(v);if(c(p,v))return"";var C=x?w.slice(7,-1):w.replace(m,"$1");return C===""?void 0:C}}),a({global:!0,forced:!0},{Symbol:d})}},function(n,r,i){i(126)("iterator")},function(n,r,i){var a,o=this&&this.__extends||(a=function(x,m){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var C in w)w.hasOwnProperty(C)&&(v[C]=w[C])})(x,m)},function(x,m){function v(){this.constructor=x}a(x,m),x.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}),s=this&&this.__values||function(x){var m=typeof Symbol=="function"&&Symbol.iterator,v=m&&x[m],w=0;if(v)return v.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&w>=x.length&&(x=void 0),{value:x&&x[w++],done:!x}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),l=i(2),f=i(70),u=i(3),h=i(9),p=i(0),d=i(152),g=i(12),y=function(x){function m(){var v=x.call(this)||this;return v._parent=null,v._firstChild=null,v._lastChild=null,v._previousSibling=null,v._nextSibling=null,v}return o(m,x),Object.defineProperty(m.prototype,"_childNodes",{get:function(){return this.__childNodes||(this.__childNodes=p.create_nodeList(this))},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverride||c.dom.window._associatedDocument},set:function(v){this._nodeDocumentOverride=v},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"_registeredObserverList",{get:function(){return this.__registeredObserverList||(this.__registeredObserverList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"nodeType",{get:function(){return this._nodeType},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"nodeName",{get:function(){return u.Guard.isElementNode(this)?this._htmlUppercasedQualifiedName:u.Guard.isAttrNode(this)?this._qualifiedName:u.Guard.isExclusiveTextNode(this)?"#text":u.Guard.isCDATASectionNode(this)?"#cdata-section":u.Guard.isProcessingInstructionNode(this)?this._target:u.Guard.isCommentNode(this)?"#comment":u.Guard.isDocumentNode(this)?"#document":u.Guard.isDocumentTypeNode(this)?this._name:u.Guard.isDocumentFragmentNode(this)?"#document-fragment":""},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"baseURI",{get:function(){return d.urlSerializer(this._nodeDocument._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"isConnected",{get:function(){return u.Guard.isElementNode(this)&&p.shadowTree_isConnected(this)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"ownerDocument",{get:function(){return this._nodeType===l.NodeType.Document?null:this._nodeDocument},enumerable:!0,configurable:!0}),m.prototype.getRootNode=function(v){return p.tree_rootNode(this,!!v&&v.composed)},Object.defineProperty(m.prototype,"parentNode",{get:function(){return this._nodeType===l.NodeType.Attribute?null:this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"parentElement",{get:function(){return this._parent&&u.Guard.isElementNode(this._parent)?this._parent:null},enumerable:!0,configurable:!0}),m.prototype.hasChildNodes=function(){return this._firstChild!==null},Object.defineProperty(m.prototype,"childNodes",{get:function(){return this._childNodes},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"firstChild",{get:function(){return this._firstChild},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"lastChild",{get:function(){return this._lastChild},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"nodeValue",{get:function(){return u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(v){v===null&&(v=""),u.Guard.isAttrNode(this)?p.attr_setAnExistingAttributeValue(this,v):u.Guard.isCharacterDataNode(this)&&p.characterData_replaceData(this,0,this._data.length,v)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"textContent",{get:function(){return u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?p.text_descendantTextContent(this):u.Guard.isAttrNode(this)?this._value:u.Guard.isCharacterDataNode(this)?this._data:null},set:function(v){v===null&&(v=""),u.Guard.isDocumentFragmentNode(this)||u.Guard.isElementNode(this)?p.node_stringReplaceAll(v,this):u.Guard.isAttrNode(this)?p.attr_setAnExistingAttributeValue(this,v):u.Guard.isCharacterDataNode(this)&&p.characterData_replaceData(this,0,p.tree_nodeLength(this),v)},enumerable:!0,configurable:!0}),m.prototype.normalize=function(){for(var v,w,C,T,_=[],S=p.tree_getFirstDescendantNode(this,!1,!1,function(Ee){return u.Guard.isExclusiveTextNode(Ee)});S!==null;)_.push(S),S=p.tree_getNextDescendantNode(this,S,!1,!1,function(Ee){return u.Guard.isExclusiveTextNode(Ee)});for(var b=0;b<_.length;b++){var D=_[b];if(D._parent!==null){var E=p.tree_nodeLength(D);if(E!==0){var R=[],F="";try{for(var M=(v=void 0,s(p.text_contiguousExclusiveTextNodes(D))),U=M.next();!U.done;U=M.next()){var z=U.value;R.push(z),F+=z._data}}catch(Ee){v={error:Ee}}finally{try{U&&!U.done&&(w=M.return)&&w.call(M)}finally{if(v)throw v.error}}if(p.characterData_replaceData(D,E,0,F),c.dom.rangeList.size!==0)for(var Y=D._nextSibling;Y!==null&&u.Guard.isExclusiveTextNode(Y);){var W=Y,B=p.tree_index(W);try{for(var j=(C=void 0,s(c.dom.rangeList)),ie=j.next();!ie.done;ie=j.next()){var ae=ie.value;ae._start[0]===W&&(ae._start[0]=D,ae._start[1]+=E),ae._end[0]===W&&(ae._end[0]=D,ae._end[1]+=E),ae._start[0]===W._parent&&ae._start[1]===B&&(ae._start[0]=D,ae._start[1]=E),ae._end[0]===W._parent&&ae._end[1]===B&&(ae._end[0]=D,ae._end[1]=E)}}catch(Ee){C={error:Ee}}finally{try{ie&&!ie.done&&(T=j.return)&&T.call(j)}finally{if(C)throw C.error}}E+=p.tree_nodeLength(Y),Y=Y._nextSibling}for(var fe=0;fe<R.length;fe++)(z=R[fe])._parent!==null&&p.mutation_remove(z,z._parent)}else p.mutation_remove(D,D._parent)}}},m.prototype.cloneNode=function(v){if(v===void 0&&(v=!1),u.Guard.isShadowRoot(this))throw new h.NotSupportedError;return p.node_clone(this,null,v)},m.prototype.isEqualNode=function(v){return v===void 0&&(v=null),v!==null&&p.node_equals(this,v)},m.prototype.isSameNode=function(v){return v===void 0&&(v=null),this===v},m.prototype.compareDocumentPosition=function(v){if(v===this)return 0;var w=v,C=this,T=null,_=null;if(u.Guard.isAttrNode(w)&&(w=(T=w)._element),u.Guard.isAttrNode(C)&&(C=(_=C)._element,T&&w&&w===C))for(var S=0;S<C._attributeList.length;S++){var b=C._attributeList[S];if(p.node_equals(b,T))return l.Position.ImplementationSpecific|l.Position.Preceding;if(p.node_equals(b,_))return l.Position.ImplementationSpecific|l.Position.Following}return w===null||C===null||p.tree_rootNode(w)!==p.tree_rootNode(C)?l.Position.Disconnected|l.Position.ImplementationSpecific|(c.dom.compareCache.check(this,v)?l.Position.Preceding:l.Position.Following):!T&&p.tree_isAncestorOf(C,w)||_&&w===C?l.Position.Contains|l.Position.Preceding:!_&&p.tree_isDescendantOf(C,w)||T&&w===C?l.Position.ContainedBy|l.Position.Following:p.tree_isPreceding(C,w)?l.Position.Preceding:l.Position.Following},m.prototype.contains=function(v){return v!==null&&p.tree_isDescendantOf(this,v,!0)},m.prototype.lookupPrefix=function(v){return v?u.Guard.isElementNode(this)?p.node_locateANamespacePrefix(this,v):u.Guard.isDocumentNode(this)?this.documentElement===null?null:p.node_locateANamespacePrefix(this.documentElement,v):u.Guard.isDocumentTypeNode(this)||u.Guard.isDocumentFragmentNode(this)?null:u.Guard.isAttrNode(this)?this._element===null?null:p.node_locateANamespacePrefix(this._element,v):this._parent!==null&&u.Guard.isElementNode(this._parent)?p.node_locateANamespacePrefix(this._parent,v):null:null},m.prototype.lookupNamespaceURI=function(v){return p.node_locateANamespace(this,v||null)},m.prototype.isDefaultNamespace=function(v){return v||(v=null),p.node_locateANamespace(this,null)===v},m.prototype.insertBefore=function(v,w){return p.mutation_preInsert(v,this,w)},m.prototype.appendChild=function(v){return p.mutation_append(v,this)},m.prototype.replaceChild=function(v,w){return p.mutation_replace(w,v,this)},m.prototype.removeChild=function(v){return p.mutation_preRemove(v,this)},m.prototype._getTheParent=function(v){return u.Guard.isSlotable(this)&&p.shadowTree_isAssigned(this)?this._assignedSlot:this._parent},m.ELEMENT_NODE=1,m.ATTRIBUTE_NODE=2,m.TEXT_NODE=3,m.CDATA_SECTION_NODE=4,m.ENTITY_REFERENCE_NODE=5,m.ENTITY_NODE=6,m.PROCESSING_INSTRUCTION_NODE=7,m.COMMENT_NODE=8,m.DOCUMENT_NODE=9,m.DOCUMENT_TYPE_NODE=10,m.DOCUMENT_FRAGMENT_NODE=11,m.NOTATION_NODE=12,m.DOCUMENT_POSITION_DISCONNECTED=1,m.DOCUMENT_POSITION_PRECEDING=2,m.DOCUMENT_POSITION_FOLLOWING=4,m.DOCUMENT_POSITION_CONTAINS=8,m.DOCUMENT_POSITION_CONTAINED_BY=16,m.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,m}(f.EventTargetImpl);r.NodeImpl=y,y.prototype._children=new u.EmptySet,g.idl_defineConst(y.prototype,"ELEMENT_NODE",1),g.idl_defineConst(y.prototype,"ATTRIBUTE_NODE",2),g.idl_defineConst(y.prototype,"TEXT_NODE",3),g.idl_defineConst(y.prototype,"CDATA_SECTION_NODE",4),g.idl_defineConst(y.prototype,"ENTITY_REFERENCE_NODE",5),g.idl_defineConst(y.prototype,"ENTITY_NODE",6),g.idl_defineConst(y.prototype,"PROCESSING_INSTRUCTION_NODE",7),g.idl_defineConst(y.prototype,"COMMENT_NODE",8),g.idl_defineConst(y.prototype,"DOCUMENT_NODE",9),g.idl_defineConst(y.prototype,"DOCUMENT_TYPE_NODE",10),g.idl_defineConst(y.prototype,"DOCUMENT_FRAGMENT_NODE",11),g.idl_defineConst(y.prototype,"NOTATION_NODE",12),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_DISCONNECTED",1),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_PRECEDING",2),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_FOLLOWING",4),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_CONTAINS",8),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_CONTAINED_BY",16),g.idl_defineConst(y.prototype,"DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC",32)},function(n,r){n.exports=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i}},function(n,r,i){var a=i(87),o=i(41),s=i(27),c=i(26),l=i(128),f=[].push,u=function(h){var p=h==1,d=h==2,g=h==3,y=h==4,x=h==6,m=h==5||x;return function(v,w,C,T){for(var _,S,b=s(v),D=o(b),E=a(w,C,3),R=c(D.length),F=0,M=T||l,U=p?M(v,R):d?M(v,0):void 0;R>F;F++)if((m||F in D)&&(S=E(_=D[F],F,b),h)){if(p)U[F]=S;else if(S)switch(h){case 3:return!0;case 5:return _;case 6:return F;case 2:f.call(U,_)}else if(y)return!1}return x?-1:g||y?y:U}};n.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(n,r,i){var a=this&&this.__values||function(b){var D=typeof Symbol=="function"&&Symbol.iterator,E=D&&b[D],R=0;if(E)return E.call(b);if(b&&typeof b.length=="number")return{next:function(){return b&&R>=b.length&&(b=void 0),{value:b&&b[R++],done:!b}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(b,D){var E=typeof Symbol=="function"&&b[Symbol.iterator];if(!E)return b;var R,F,M=E.call(b),U=[];try{for(;(D===void 0||D-- >0)&&!(R=M.next()).done;)U.push(R.value)}catch(z){F={error:z}}finally{try{R&&!R.done&&(E=M.return)&&E.call(M)}finally{if(F)throw F.error}}return U},s=this&&this.__spread||function(){for(var b=[],D=0;D<arguments.length;D++)b=b.concat(o(arguments[D]));return b};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),l=i(9),f=i(2),u=i(3),h=i(1),p=i(7),d=i(73),g=i(17),y=i(172),x=i(72),m=i(51),v=i(30),w=i(106);function C(b,D,E){var R,F,M,U,z,Y,W,B,j=D._nodeType,ie=b._nodeType,ae=E?E._nodeType:null;if(j!==f.NodeType.Document&&j!==f.NodeType.DocumentFragment&&j!==f.NodeType.Element)throw new l.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+D.nodeName+".");if(g.tree_isHostIncludingAncestorOf(D,b,!0))throw new l.HierarchyRequestError("The node to be inserted cannot be an inclusive ancestor of parent node. Node is "+b.nodeName+", parent node is "+D.nodeName+".");if(E!==null&&E._parent!==D)throw new l.NotFoundError("The reference child node cannot be found under parent node. Child node is "+E.nodeName+", parent node is "+D.nodeName+".");if(ie!==f.NodeType.DocumentFragment&&ie!==f.NodeType.DocumentType&&ie!==f.NodeType.Element&&ie!==f.NodeType.Text&&ie!==f.NodeType.ProcessingInstruction&&ie!==f.NodeType.CData&&ie!==f.NodeType.Comment)throw new l.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+b.nodeName+".");if(ie===f.NodeType.Text&&j===f.NodeType.Document)throw new l.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+b.nodeName+".");if(ie===f.NodeType.DocumentType&&j!==f.NodeType.Document)throw new l.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+D.nodeName+".");if(j===f.NodeType.Document){if(ie===f.NodeType.DocumentFragment){var fe=0;try{for(var Ee=a(b._children),ge=Ee.next();!ge.done;ge=Ee.next()){var be=ge.value;if(be._nodeType===f.NodeType.Element)fe++;else if(be._nodeType===f.NodeType.Text)throw new l.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+be.nodeName+".")}}catch($){R={error:$}}finally{try{ge&&!ge.done&&(F=Ee.return)&&F.call(Ee)}finally{if(R)throw R.error}}if(fe>1)throw new l.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+fe+" element nodes.");if(fe===1){try{for(var Re=a(D._children),Ne=Re.next();!Ne.done;Ne=Re.next())if(Ne.value._nodeType===f.NodeType.Element)throw new l.HierarchyRequestError("The document node already has a document element node.")}catch($){M={error:$}}finally{try{Ne&&!Ne.done&&(U=Re.return)&&U.call(Re)}finally{if(M)throw M.error}}if(E){if(ae===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node.");for(var Ce=E._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node.");Ce=Ce._nextSibling}}}}else if(ie===f.NodeType.Element){try{for(var P=a(D._children),O=P.next();!O.done;O=P.next())if(O.value._nodeType===f.NodeType.Element)throw new l.HierarchyRequestError("Document already has a document element node. Node is "+b.nodeName+".")}catch($){z={error:$}}finally{try{O&&!O.done&&(Y=P.return)&&Y.call(P)}finally{if(z)throw z.error}}if(E){if(ae===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+b.nodeName+".");for(Ce=E._nextSibling;Ce;){if(Ce._nodeType===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+b.nodeName+".");Ce=Ce._nextSibling}}}else if(ie===f.NodeType.DocumentType){try{for(var A=a(D._children),L=A.next();!L.done;L=A.next())if(L.value._nodeType===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Document already has a document type node. Node is "+b.nodeName+".")}catch($){W={error:$}}finally{try{L&&!L.done&&(B=A.return)&&B.call(A)}finally{if(W)throw W.error}}if(E)for(var k=E._previousSibling;k;){if(k._nodeType===f.NodeType.Element)throw new l.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+b.nodeName+".");k=k._previousSibling}else for(k=D._firstChild;k;){if(k._nodeType===f.NodeType.Element)throw new l.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+b.nodeName+".");k=k._nextSibling}}}}function T(b,D,E){C(b,D,E);var R=E;return R===b&&(R=b._nextSibling),w.document_adopt(b,D._nodeDocument),_(b,D,R),b}function _(b,D,E,R){var F,M;if(E!==null||b._nodeType===f.NodeType.DocumentFragment){var U=b._nodeType===f.NodeType.DocumentFragment?b._children.size:1;if(E!==null&&c.dom.rangeList.size!==0){var z=g.tree_index(E);try{for(var Y=a(c.dom.rangeList),W=Y.next();!W.done;W=Y.next()){var B=W.value;B._start[0]===D&&B._start[1]>z&&(B._start[1]+=U),B._end[0]===D&&B._end[1]>z&&(B._end[1]+=U)}}catch(Ne){F={error:Ne}}finally{try{W&&!W.done&&(M=Y.return)&&M.call(Y)}finally{if(F)throw F.error}}}var j=b._nodeType===f.NodeType.DocumentFragment?new(Array.bind.apply(Array,s([void 0],b._children))):[b];if(b._nodeType===f.NodeType.DocumentFragment)for(;b._firstChild;)S(b._firstChild,b,!0);c.dom.features.mutationObservers&&b._nodeType===f.NodeType.DocumentFragment&&m.observer_queueTreeMutationRecord(b,[],j,null,null);for(var ie=E?E._previousSibling:D._lastChild,ae=E===null?-1:g.tree_index(E),fe=0;fe<j.length;fe++){var Ee=j[fe];if(u.Guard.isElementNode(Ee)&&(u.Guard.isDocumentNode(D)&&(D._documentElement=Ee),Ee._nodeDocument._hasNamespaces||Ee._namespace===null&&Ee._namespacePrefix===null||(Ee._nodeDocument._hasNamespaces=!0)),Ee._parent=D,E===null?p.set.append(D._children,Ee):(p.set.insert(D._children,Ee,ae),ae++),D._firstChild===null)Ee._previousSibling=null,Ee._nextSibling=null,D._firstChild=Ee,D._lastChild=Ee;else{var ge=E?E._previousSibling:D._lastChild,be=E||null;Ee._previousSibling=ge,Ee._nextSibling=be,ge&&(ge._nextSibling=Ee),be&&(be._previousSibling=Ee),ge||(D._firstChild=Ee),be||(D._lastChild=Ee)}c.dom.features.slots&&D._shadowRoot!==null&&u.Guard.isSlotable(Ee)&&x.shadowTree_assignASlot(Ee),c.dom.features.steps&&u.Guard.isTextNode(Ee)&&v.dom_runChildTextContentChangeSteps(D),c.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(D))&&u.Guard.isSlot(D)&&h.isEmpty(D._assignedNodes)&&x.shadowTree_signalASlotChange(D),c.dom.features.slots&&x.shadowTree_assignSlotablesForATree(g.tree_rootNode(Ee));for(var Re=g.tree_getFirstDescendantNode(Ee,!0,!0);Re!==null;)c.dom.features.steps&&v.dom_runInsertionSteps(Re),c.dom.features.customElements&&u.Guard.isElementNode(Re)&&x.shadowTree_isConnected(Re)&&(u.Guard.isCustomElementNode(Re)?d.customElement_enqueueACustomElementCallbackReaction(Re,"connectedCallback",[]):d.customElement_tryToUpgrade(Re)),Re=g.tree_getNextDescendantNode(Ee,Re,!0,!0)}c.dom.features.mutationObservers&&(R||m.observer_queueTreeMutationRecord(D,j,[],ie,E))}else(function(Ne,Ce,P){var O=Ce._lastChild;if(u.Guard.isElementNode(Ne)&&(u.Guard.isDocumentNode(Ce)&&(Ce._documentElement=Ne),Ne._nodeDocument._hasNamespaces||Ne._namespace===null&&Ne._namespacePrefix===null||(Ne._nodeDocument._hasNamespaces=!0)),Ne._parent=Ce,Ce._children.add(Ne),Ce._firstChild===null)Ne._previousSibling=null,Ne._nextSibling=null,Ce._firstChild=Ne,Ce._lastChild=Ne;else{var A=Ce._lastChild;Ne._previousSibling=A,Ne._nextSibling=null,A&&(A._nextSibling=Ne),A||(Ce._firstChild=Ne),Ce._lastChild=Ne}c.dom.features.slots&&Ce._shadowRoot!==null&&u.Guard.isSlotable(Ne)&&x.shadowTree_assignASlot(Ne),c.dom.features.steps&&u.Guard.isTextNode(Ne)&&v.dom_runChildTextContentChangeSteps(Ce),c.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(Ce))&&u.Guard.isSlot(Ce)&&h.isEmpty(Ce._assignedNodes)&&x.shadowTree_signalASlotChange(Ce),c.dom.features.slots&&x.shadowTree_assignSlotablesForATree(g.tree_rootNode(Ne)),c.dom.features.steps&&v.dom_runInsertionSteps(Ne),c.dom.features.customElements&&u.Guard.isElementNode(Ne)&&x.shadowTree_isConnected(Ne)&&(u.Guard.isCustomElementNode(Ne)?d.customElement_enqueueACustomElementCallbackReaction(Ne,"connectedCallback",[]):d.customElement_tryToUpgrade(Ne)),c.dom.features.mutationObservers&&(P||m.observer_queueTreeMutationRecord(Ce,[Ne],[],O,null))})(b,D,R)}function S(b,D,E){var R,F,M,U,z,Y,W,B;if(c.dom.rangeList.size!==0){var j=g.tree_index(b);try{for(var ie=a(c.dom.rangeList),ae=ie.next();!ae.done;ae=ie.next()){var fe=ae.value;g.tree_isDescendantOf(b,fe._start[0],!0)&&(fe._start=[D,j]),g.tree_isDescendantOf(b,fe._end[0],!0)&&(fe._end=[D,j]),fe._start[0]===D&&fe._start[1]>j&&fe._start[1]--,fe._end[0]===D&&fe._end[1]>j&&fe._end[1]--}}catch(me){R={error:me}}finally{try{ae&&!ae.done&&(F=ie.return)&&F.call(ie)}finally{if(R)throw R.error}}try{for(var Ee=a(c.dom.rangeList),ge=Ee.next();!ge.done;ge=Ee.next())(fe=ge.value)._start[0]===D&&fe._start[1]>j&&(fe._start[1]-=1),fe._end[0]===D&&fe._end[1]>j&&(fe._end[1]-=1)}catch(me){M={error:me}}finally{try{ge&&!ge.done&&(U=Ee.return)&&U.call(Ee)}finally{if(M)throw M.error}}}if(c.dom.features.steps)try{for(var be=a(y.nodeIterator_iteratorList()),Re=be.next();!Re.done;Re=be.next()){var Ne=Re.value;Ne._root._nodeDocument===b._nodeDocument&&v.dom_runNodeIteratorPreRemovingSteps(Ne,b)}}catch(me){z={error:me}}finally{try{Re&&!Re.done&&(Y=be.return)&&Y.call(be)}finally{if(z)throw z.error}}var Ce=b._previousSibling,P=b._nextSibling;u.Guard.isDocumentNode(D)&&u.Guard.isElementNode(b)&&(D._documentElement=null),b._parent=null,D._children.delete(b);var O=b._previousSibling,A=b._nextSibling;b._previousSibling=null,b._nextSibling=null,O&&(O._nextSibling=A),A&&(A._previousSibling=O),O||(D._firstChild=A),A||(D._lastChild=O),c.dom.features.slots&&u.Guard.isSlotable(b)&&b._assignedSlot!==null&&x.shadowTree_isAssigned(b)&&x.shadowTree_assignSlotables(b._assignedSlot),c.dom.features.slots&&u.Guard.isShadowRoot(g.tree_rootNode(D))&&u.Guard.isSlot(D)&&h.isEmpty(D._assignedNodes)&&x.shadowTree_signalASlotChange(D),c.dom.features.slots&&g.tree_getFirstDescendantNode(b,!0,!1,function(me){return u.Guard.isSlot(me)})!==null&&(x.shadowTree_assignSlotablesForATree(g.tree_rootNode(D)),x.shadowTree_assignSlotablesForATree(b)),c.dom.features.steps&&v.dom_runRemovingSteps(b,D),c.dom.features.customElements&&u.Guard.isCustomElementNode(b)&&d.customElement_enqueueACustomElementCallbackReaction(b,"disconnectedCallback",[]);for(var L=g.tree_getFirstDescendantNode(b,!1,!0);L!==null;)c.dom.features.steps&&v.dom_runRemovingSteps(L,b),c.dom.features.customElements&&u.Guard.isCustomElementNode(L)&&d.customElement_enqueueACustomElementCallbackReaction(L,"disconnectedCallback",[]),L=g.tree_getNextDescendantNode(b,L,!1,!0);if(c.dom.features.mutationObservers)for(var k=g.tree_getFirstAncestorNode(D,!0);k!==null;){try{for(var $=(W=void 0,a(k._registeredObserverList)),H=$.next();!H.done;H=$.next()){var se=H.value;se.options.subtree&&b._registeredObserverList.push({observer:se.observer,options:se.options,source:se})}}catch(me){W={error:me}}finally{try{H&&!H.done&&(B=$.return)&&B.call($)}finally{if(W)throw W.error}}k=g.tree_getNextAncestorNode(D,k,!0)}c.dom.features.mutationObservers&&(E||m.observer_queueTreeMutationRecord(D,[],[b],Ce,P)),c.dom.features.steps&&u.Guard.isTextNode(b)&&v.dom_runChildTextContentChangeSteps(D)}r.mutation_ensurePreInsertionValidity=C,r.mutation_preInsert=T,r.mutation_insert=_,r.mutation_append=function(b,D){return T(b,D,null)},r.mutation_replace=function(b,D,E){var R,F,M,U,z,Y,W,B;if(E._nodeType!==f.NodeType.Document&&E._nodeType!==f.NodeType.DocumentFragment&&E._nodeType!==f.NodeType.Element)throw new l.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+E.nodeName+".");if(g.tree_isHostIncludingAncestorOf(E,D,!0))throw new l.HierarchyRequestError("The node to be inserted cannot be an ancestor of parent node. Node is "+D.nodeName+", parent node is "+E.nodeName+".");if(b._parent!==E)throw new l.NotFoundError("The reference child node cannot be found under parent node. Child node is "+b.nodeName+", parent node is "+E.nodeName+".");if(D._nodeType!==f.NodeType.DocumentFragment&&D._nodeType!==f.NodeType.DocumentType&&D._nodeType!==f.NodeType.Element&&D._nodeType!==f.NodeType.Text&&D._nodeType!==f.NodeType.ProcessingInstruction&&D._nodeType!==f.NodeType.CData&&D._nodeType!==f.NodeType.Comment)throw new l.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+D.nodeName+".");if(D._nodeType===f.NodeType.Text&&E._nodeType===f.NodeType.Document)throw new l.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+D.nodeName+".");if(D._nodeType===f.NodeType.DocumentType&&E._nodeType!==f.NodeType.Document)throw new l.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+E.nodeName+".");if(E._nodeType===f.NodeType.Document){if(D._nodeType===f.NodeType.DocumentFragment){var j=0;try{for(var ie=a(D._children),ae=ie.next();!ae.done;ae=ie.next()){var fe=ae.value;if(fe._nodeType===f.NodeType.Element)j++;else if(fe._nodeType===f.NodeType.Text)throw new l.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+fe.nodeName+".")}}catch(se){R={error:se}}finally{try{ae&&!ae.done&&(F=ie.return)&&F.call(ie)}finally{if(R)throw R.error}}if(j>1)throw new l.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+j+" element nodes.");if(j===1){try{for(var Ee=a(E._children),ge=Ee.next();!ge.done;ge=Ee.next())if((O=ge.value)._nodeType===f.NodeType.Element&&O!==b)throw new l.HierarchyRequestError("The document node already has a document element node.")}catch(se){M={error:se}}finally{try{ge&&!ge.done&&(U=Ee.return)&&U.call(Ee)}finally{if(M)throw M.error}}for(var be=b._nextSibling;be;){if(be._nodeType===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node.");be=be._nextSibling}}}else if(D._nodeType===f.NodeType.Element){try{for(var Re=a(E._children),Ne=Re.next();!Ne.done;Ne=Re.next())if((O=Ne.value)._nodeType===f.NodeType.Element&&O!==b)throw new l.HierarchyRequestError("Document already has a document element node. Node is "+D.nodeName+".")}catch(se){z={error:se}}finally{try{Ne&&!Ne.done&&(Y=Re.return)&&Y.call(Re)}finally{if(z)throw z.error}}for(be=b._nextSibling;be;){if(be._nodeType===f.NodeType.DocumentType)throw new l.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+D.nodeName+".");be=be._nextSibling}}else if(D._nodeType===f.NodeType.DocumentType){try{for(var Ce=a(E._children),P=Ce.next();!P.done;P=Ce.next()){var O;if((O=P.value)._nodeType===f.NodeType.DocumentType&&O!==b)throw new l.HierarchyRequestError("Document already has a document type node. Node is "+D.nodeName+".")}}catch(se){W={error:se}}finally{try{P&&!P.done&&(B=Ce.return)&&B.call(Ce)}finally{if(W)throw W.error}}for(var A=b._previousSibling;A;){if(A._nodeType===f.NodeType.Element)throw new l.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+D.nodeName+".");A=A._previousSibling}}}var L=b._nextSibling;L===D&&(L=D._nextSibling);var k=b._previousSibling;w.document_adopt(D,E._nodeDocument);var $=[];b._parent!==null&&($.push(b),S(b,b._parent,!0));var H=[];return D._nodeType===f.NodeType.DocumentFragment?H=Array.from(D._children):H.push(D),_(D,E,L,!0),c.dom.features.mutationObservers&&m.observer_queueTreeMutationRecord(E,H,$,k,L),b},r.mutation_replaceAll=function(b,D){var E,R;b!==null&&w.document_adopt(b,D._nodeDocument);var F=Array.from(D._children),M=[];b&&b._nodeType===f.NodeType.DocumentFragment?M=Array.from(b._children):b!==null&&M.push(b);try{for(var U=a(F),z=U.next();!z.done;z=U.next())S(z.value,D,!0)}catch(Y){E={error:Y}}finally{try{z&&!z.done&&(R=U.return)&&R.call(U)}finally{if(E)throw E.error}}b!==null&&_(b,D,null,!0),c.dom.features.mutationObservers&&m.observer_queueTreeMutationRecord(D,M,F,null,null)},r.mutation_preRemove=function(b,D){if(b._parent!==D)throw new l.NotFoundError("The child node cannot be found under parent node. Child node is "+b.nodeName+", parent node is "+D.nodeName+".");return S(b,D),b},r.mutation_remove=S},function(n,r,i){function a(o){return o==null}n.exports.isNothing=a,n.exports.isObject=function(o){return typeof o=="object"&&o!==null},n.exports.toArray=function(o){return Array.isArray(o)?o:a(o)?[]:[o]},n.exports.repeat=function(o,s){var c,l="";for(c=0;c<s;c+=1)l+=o;return l},n.exports.isNegativeZero=function(o){return o===0&&Number.NEGATIVE_INFINITY===1/o},n.exports.extend=function(o,s){var c,l,f,u;if(s)for(c=0,l=(u=Object.keys(s)).length;c<l;c+=1)o[f=u[c]]=s[f];return o}},function(n,r,i){var a=i(38),o=i(53),s=i(10);function c(f,u,h){var p=[];return f.include.forEach(function(d){h=c(d,u,h)}),f[u].forEach(function(d){h.forEach(function(g,y){g.tag===d.tag&&g.kind===d.kind&&p.push(y)}),h.push(d)}),h.filter(function(d,g){return p.indexOf(g)===-1})}function l(f){this.include=f.include||[],this.implicit=f.implicit||[],this.explicit=f.explicit||[],this.implicit.forEach(function(u){if(u.loadKind&&u.loadKind!=="scalar")throw new o("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=c(this,"implicit",[]),this.compiledExplicit=c(this,"explicit",[]),this.compiledTypeMap=function(){var u,h,p={scalar:{},sequence:{},mapping:{},fallback:{}};function d(g){p[g.kind][g.tag]=p.fallback[g.tag]=g}for(u=0,h=arguments.length;u<h;u+=1)arguments[u].forEach(d);return p}(this.compiledImplicit,this.compiledExplicit)}l.DEFAULT=null,l.create=function(){var f,u;switch(arguments.length){case 1:f=l.DEFAULT,u=arguments[0];break;case 2:f=arguments[0],u=arguments[1];break;default:throw new o("Wrong number of arguments for Schema.create function")}if(f=a.toArray(f),u=a.toArray(u),!f.every(function(h){return h instanceof l}))throw new o("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!u.every(function(h){return h instanceof s}))throw new o("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new l({include:f,explicit:u})},n.exports=l},function(n,r){n.exports=function(i,a){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:a}}},function(n,r,i){var a=i(8),o=i(42),s="".split;n.exports=a(function(){return!Object("z").propertyIsEnumerable(0)})?function(c){return o(c)=="String"?s.call(c,""):Object(c)}:Object},function(n,r){var i={}.toString;n.exports=function(a){return i.call(a).slice(8,-1)}},function(n,r,i){var a,o,s,c=i(186),l=i(11),f=i(13),u=i(21),h=i(14),p=i(57),d=i(45),g=l.WeakMap;if(c){var y=new g,x=y.get,m=y.has,v=y.set;a=function(C,T){return v.call(y,C,T),T},o=function(C){return x.call(y,C)||{}},s=function(C){return m.call(y,C)}}else{var w=p("state");d[w]=!0,a=function(C,T){return u(C,w,T),T},o=function(C){return h(C,w)?C[w]:{}},s=function(C){return h(C,w)}}n.exports={set:a,get:o,has:s,enforce:function(C){return s(C)?o(C):a(C,{})},getterFor:function(C){return function(T){var _;if(!f(T)||(_=o(T)).type!==C)throw TypeError("Incompatible receiver, "+C+" required");return _}}}},function(n,r){n.exports=!1},function(n,r){n.exports={}},function(n,r,i){var a=i(120),o=i(11),s=function(c){return typeof c=="function"?c:void 0};n.exports=function(c,l){return arguments.length<2?s(a[c])||s(o[c]):a[c]&&a[c][l]||o[c]&&o[c][l]}},function(n,r){var i=Math.ceil,a=Math.floor;n.exports=function(o){return isNaN(o=+o)?0:(o>0?a:i)(o)}},function(n,r,i){var a=i(8);n.exports=function(o,s){var c=[][o];return!!c&&a(function(){c.call(null,s||function(){throw 1},1)})}},function(n,r){n.exports={}},function(n,r,i){i(31),i(32),i(33),i(220),i(64),i(19),i(65),i(20),i(68),i(66),i(92),i(144),i(22),i(94),i(23);var a=this&&this.__values||function(d){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&d[g],x=0;if(y)return y.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&x>=d.length&&(d=void 0),{value:d&&d[x++],done:!d}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(d,g){var y=typeof Symbol=="function"&&d[Symbol.iterator];if(!y)return d;var x,m,v=y.call(d),w=[];try{for(;(g===void 0||g-- >0)&&!(x=v.next()).done;)w.push(x.value)}catch(C){m={error:C}}finally{try{x&&!x.done&&(y=v.return)&&y.call(v)}finally{if(m)throw m.error}}return w},s=this&&this.__spread||function(){for(var d=[],g=0;g<arguments.length;g++)d=d.concat(o(arguments[g]));return d};Object.defineProperty(r,"__esModule",{value:!0});var c=i(2),l=i(69),f=i(95),u=i(7),h=i(0),p=function(){function d(g){this.level=0,this._builderOptions=g}return d.prototype.declaration=function(g,y,x){},d.prototype.docType=function(g,y,x){},d.prototype.comment=function(g){},d.prototype.text=function(g){},d.prototype.instruction=function(g,y){},d.prototype.cdata=function(g){},d.prototype.openTagBegin=function(g){},d.prototype.openTagEnd=function(g,y,x){},d.prototype.closeTag=function(g){},d.prototype.attributes=function(g){var y,x;try{for(var m=a(g),v=m.next();!v.done;v=m.next()){var w=v.value;this.attribute(w[1]===null?w[2]:w[1]+":"+w[2],w[3])}}catch(C){y={error:C}}finally{try{v&&!v.done&&(x=m.return)&&x.call(m)}finally{if(y)throw y.error}}},d.prototype.attribute=function(g,y){},d.prototype.beginElement=function(g){},d.prototype.endElement=function(g){},d.prototype.serializeNode=function(g,y){var x=g._nodeDocument!==void 0&&g._nodeDocument._hasNamespaces;if(this.level=0,this.currentNode=g,x){var m=new f.NamespacePrefixMap;m.set("xml",u.namespace.XML),this._serializeNodeNS(g,null,m,{value:1},y)}else this._serializeNode(g,y)},d.prototype._serializeNodeNS=function(g,y,x,m,v){switch(this.currentNode=g,g.nodeType){case c.NodeType.Element:this._serializeElementNS(g,y,x,m,v);break;case c.NodeType.Document:this._serializeDocumentNS(g,y,x,m,v);break;case c.NodeType.Comment:this._serializeComment(g,v);break;case c.NodeType.Text:this._serializeText(g,v);break;case c.NodeType.DocumentFragment:this._serializeDocumentFragmentNS(g,y,x,m,v);break;case c.NodeType.DocumentType:this._serializeDocumentType(g,v);break;case c.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,v);break;case c.NodeType.CData:this._serializeCData(g,v);break;default:throw new Error("Unknown node type: "+g.nodeType)}},d.prototype._serializeNode=function(g,y){switch(this.currentNode=g,g.nodeType){case c.NodeType.Element:this._serializeElement(g,y);break;case c.NodeType.Document:this._serializeDocument(g,y);break;case c.NodeType.Comment:this._serializeComment(g,y);break;case c.NodeType.Text:this._serializeText(g,y);break;case c.NodeType.DocumentFragment:this._serializeDocumentFragment(g,y);break;case c.NodeType.DocumentType:this._serializeDocumentType(g,y);break;case c.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(g,y);break;case c.NodeType.CData:this._serializeCData(g,y);break;default:throw new Error("Unknown node type: "+g.nodeType)}},d.prototype._serializeElementNS=function(g,y,x,m,v){var w,C,T=[];if(v&&(g.localName.indexOf(":")!==-1||!h.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var _="",S=!1,b=!1,D=x.copy(),E={},R=this._recordNamespaceInformation(g,D,E),F=y,M=g.namespaceURI;if(F===M)R!==null&&(b=!0),_=M===u.namespace.XML?"xml:"+g.localName:g.localName,this.beginElement(_),this.openTagBegin(_);else{var U=g.prefix,z=null;if(U===null&&M===R||(z=D.get(U,M)),U==="xmlns"){if(v)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");z=U}z!==null?(_=z+":"+g.localName,R!==null&&R!==u.namespace.XML&&(F=R||null),this.beginElement(_),this.openTagBegin(_)):U!==null?(U in E&&(U=this._generatePrefix(M,D,m)),D.set(U,M),_+=U+":"+g.localName,this.beginElement(_),this.openTagBegin(_),T.push([null,"xmlns",U,this._serializeAttributeValue(M,v)]),R!==null&&(F=R||null)):R===null||R!==null&&R!==M?(b=!0,_+=g.localName,F=M,this.beginElement(_),this.openTagBegin(_),T.push([null,null,"xmlns",this._serializeAttributeValue(M,v)])):(_+=g.localName,F=M,this.beginElement(_),this.openTagBegin(_))}T.push.apply(T,s(this._serializeAttributesNS(g,D,m,E,b,v))),this.attributes(T);var Y=M===u.namespace.HTML;if(Y&&g.childNodes.length===0&&d._VoidElementNames.has(g.localName)?(this.openTagEnd(_,!0,!0),this.endElement(_),S=!0):Y||g.childNodes.length!==0?this.openTagEnd(_,!1,!1):(this.openTagEnd(_,!0,!1),this.endElement(_),S=!0),!S){if(!(Y&&g.localName==="template"))try{for(var W=a(g.childNodes),B=W.next();!B.done;B=W.next()){var j=B.value;this.level++,this._serializeNodeNS(j,F,D,m,v),this.level--}}catch(ie){w={error:ie}}finally{try{B&&!B.done&&(C=W.return)&&C.call(W)}finally{if(w)throw w.error}}this.closeTag(_),this.endElement(_)}},d.prototype._serializeElement=function(g,y){var x,m;if(y&&(g.localName.indexOf(":")!==-1||!h.xml_isName(g.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var v=!1,w=g.localName;this.beginElement(w),this.openTagBegin(w);var C=this._serializeAttributes(g,y);if(this.attributes(C),g.hasChildNodes()?this.openTagEnd(w,!1,!1):(this.openTagEnd(w,!0,!1),this.endElement(w),v=!0),!v){try{for(var T=a(g._children),_=T.next();!_.done;_=T.next()){var S=_.value;this.level++,this._serializeNode(S,y),this.level--}}catch(b){x={error:b}}finally{try{_&&!_.done&&(m=T.return)&&m.call(T)}finally{if(x)throw x.error}}this.closeTag(w),this.endElement(w)}},d.prototype._serializeDocumentNS=function(g,y,x,m,v){var w,C;if(v&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var S=_.value;this._serializeNodeNS(S,y,x,m,v)}}catch(b){w={error:b}}finally{try{_&&!_.done&&(C=T.return)&&C.call(T)}finally{if(w)throw w.error}}},d.prototype._serializeDocument=function(g,y){var x,m;if(y&&g.documentElement===null)throw new Error("Missing document element (well-formed required).");try{for(var v=a(g._children),w=v.next();!w.done;w=v.next()){var C=w.value;this._serializeNode(C,y)}}catch(T){x={error:T}}finally{try{w&&!w.done&&(m=v.return)&&m.call(v)}finally{if(x)throw x.error}}},d.prototype._serializeComment=function(g,y){if(y&&(!h.xml_isLegalChar(g.data)||g.data.indexOf("--")!==-1||g.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");this.comment(g.data)},d.prototype._serializeText=function(g,y){if(y&&!h.xml_isLegalChar(g.data))throw new Error("Text data contains invalid characters (well-formed required).");var x=g.data.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.text(x)},d.prototype._serializeDocumentFragmentNS=function(g,y,x,m,v){var w,C;try{for(var T=a(g.childNodes),_=T.next();!_.done;_=T.next()){var S=_.value;this._serializeNodeNS(S,y,x,m,v)}}catch(b){w={error:b}}finally{try{_&&!_.done&&(C=T.return)&&C.call(T)}finally{if(w)throw w.error}}},d.prototype._serializeDocumentFragment=function(g,y){var x,m;try{for(var v=a(g._children),w=v.next();!w.done;w=v.next()){var C=w.value;this._serializeNode(C,y)}}catch(T){x={error:T}}finally{try{w&&!w.done&&(m=v.return)&&m.call(v)}finally{if(x)throw x.error}}},d.prototype._serializeDocumentType=function(g,y){if(y&&!h.xml_isPubidChar(g.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(y&&(!h.xml_isLegalChar(g.systemId)||g.systemId.indexOf('"')!==-1&&g.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");this.docType(g.name,g.publicId,g.systemId)},d.prototype._serializeProcessingInstruction=function(g,y){if(y&&(g.target.indexOf(":")!==-1||/^xml$/i.test(g.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(y&&(!h.xml_isLegalChar(g.data)||g.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");this.instruction(g.target,g.data)},d.prototype._serializeCData=function(g,y){if(y&&g.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");this.cdata(g.data)},d.prototype._serializeAttributesNS=function(g,y,x,m,v,w){var C,T,_=[],S=w?new l.LocalNameSet:void 0;try{for(var b=a(g.attributes),D=b.next();!D.done;D=b.next()){var E=D.value;if(w||v||E.namespaceURI!==null){if(w&&S&&S.has(E.namespaceURI,E.localName))throw new Error("Element contains duplicate attributes (well-formed required).");w&&S&&S.set(E.namespaceURI,E.localName);var R=E.namespaceURI,F=null;if(R!==null)if(F=y.get(E.prefix,R),R===u.namespace.XMLNS){if(E.value===u.namespace.XML||E.prefix===null&&v||E.prefix!==null&&(!(E.localName in m)||m[E.localName]!==E.value)&&y.has(E.localName,E.value))continue;if(w&&E.value===u.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(w&&E.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");E.prefix==="xmlns"&&(F="xmlns")}else F===null&&(F=E.prefix===null||y.hasPrefix(E.prefix)&&!y.has(E.prefix,R)?this._generatePrefix(R,y,x):E.prefix,_.push([null,"xmlns",F,this._serializeAttributeValue(R,w)]));if(w&&(E.localName.indexOf(":")!==-1||!h.xml_isName(E.localName)||E.localName==="xmlns"&&R===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");_.push([R,F,E.localName,this._serializeAttributeValue(E.value,w)])}else _.push([null,null,E.localName,this._serializeAttributeValue(E.value,w)])}}catch(M){C={error:M}}finally{try{D&&!D.done&&(T=b.return)&&T.call(b)}finally{if(C)throw C.error}}return _},d.prototype._serializeAttributes=function(g,y){var x,m,v=[],w=y?{}:void 0;try{for(var C=a(g.attributes),T=C.next();!T.done;T=C.next()){var _=T.value;if(y){if(y&&w&&_.localName in w)throw new Error("Element contains duplicate attributes (well-formed required).");if(y&&w&&(w[_.localName]=!0),y&&(_.localName.indexOf(":")!==-1||!h.xml_isName(_.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");v.push([null,null,_.localName,this._serializeAttributeValue(_.value,y)])}else v.push([null,null,_.localName,this._serializeAttributeValue(_.value,y)])}}catch(S){x={error:S}}finally{try{T&&!T.done&&(m=C.return)&&m.call(C)}finally{if(x)throw x.error}}return v},d.prototype._recordNamespaceInformation=function(g,y,x){var m,v,w=null;try{for(var C=a(g.attributes),T=C.next();!T.done;T=C.next()){var _=T.value,S=_.namespaceURI,b=_.prefix;if(S===u.namespace.XMLNS){if(b===null){w=_.value;continue}var D=_.localName,E=_.value;if(E===u.namespace.XML||(E===""&&(E=null),y.has(D,E)))continue;y.set(D,E),x[D]=E||""}}}catch(R){m={error:R}}finally{try{T&&!T.done&&(v=C.return)&&v.call(C)}finally{if(m)throw m.error}}return w},d.prototype._generatePrefix=function(g,y,x){var m="ns"+x.value.toString();return x.value++,y.set(m,g),m},d.prototype._serializeAttributeValue=function(g,y){if(y&&g!==null&&!h.xml_isLegalChar(g))throw new Error("Invalid characters in attribute value.");return g===null?"":g.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},d._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),d}();r.BaseWriter=p},function(n,r,i){var a=this&&this.__values||function(y){var x=typeof Symbol=="function"&&Symbol.iterator,m=x&&y[x],v=0;if(m)return m.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&v>=y.length&&(y=void 0),{value:y&&y[v++],done:!y}}};throw new TypeError(x?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(y,x){var m=typeof Symbol=="function"&&y[Symbol.iterator];if(!m)return y;var v,w,C=m.call(y),T=[];try{for(;(x===void 0||x-- >0)&&!(v=C.next()).done;)T.push(v.value)}catch(_){w={error:_}}finally{try{v&&!v.done&&(m=C.return)&&m.call(C)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),c=i(3),l=i(7),f=i(29),u=i(17),h=i(97);function p(){var y=s.dom.window;y._mutationObserverMicrotaskQueued||(y._mutationObserverMicrotaskQueued=!0,Promise.resolve().then(function(){d()}))}function d(){var y,x,m,v,w=s.dom.window;w._mutationObserverMicrotaskQueued=!1;var C=l.set.clone(w._mutationObservers),T=l.set.clone(w._signalSlots);l.set.empty(w._signalSlots);var _=function(F){var M=l.list.clone(F._recordQueue);l.list.empty(F._recordQueue);for(var U=0;U<F._nodeList.length;U++){var z=F._nodeList[U];l.list.remove(z._registeredObserverList,function(Y){return c.Guard.isTransientRegisteredObserver(Y)&&Y.observer===F})}if(!l.list.isEmpty(M))try{F._callback.call(F,M,F)}catch{}};try{for(var S=a(C),b=S.next();!b.done;b=S.next())_(b.value)}catch(F){y={error:F}}finally{try{b&&!b.done&&(x=S.return)&&x.call(S)}finally{if(y)throw y.error}}if(s.dom.features.slots)try{for(var D=a(T),E=D.next();!E.done;E=D.next()){var R=E.value;h.event_fireAnEvent("slotchange",R,void 0,{bubbles:!0})}}catch(F){m={error:F}}finally{try{E&&!E.done&&(v=D.return)&&v.call(D)}finally{if(m)throw m.error}}}function g(y,x,m,v,w,C,T,_,S){for(var b,D,E=new Map,R=u.tree_getFirstAncestorNode(x,!0);R!==null;){for(var F=0;F<R._registeredObserverList.length;F++){var M=R._registeredObserverList[F],U=M.options;if((R===x||U.subtree)&&(y!=="attributes"||U.attributes)&&(y!=="attributes"||!U.attributeFilter||U.attributeFilter.indexOf(m||"")&&v===null)&&(y!=="characterData"||U.characterData)&&(y!=="childList"||U.childList)){var z=M.observer;E.has(z)||E.set(z,null),(y==="attributes"&&U.attributeOldValue||y==="characterData"&&U.characterDataOldValue)&&E.set(z,w)}}R=u.tree_getNextAncestorNode(x,R,!0)}try{for(var Y=a(E),W=Y.next();!W.done;W=Y.next()){var B=o(W.value,2),j=B[0],ie=B[1],ae=f.create_mutationRecord(y,x,f.create_nodeListStatic(x,C),f.create_nodeListStatic(x,T),_,S,m,v,ie);j._recordQueue.push(ae)}}catch(fe){b={error:fe}}finally{try{W&&!W.done&&(D=Y.return)&&D.call(Y)}finally{if(b)throw b.error}}p()}r.observer_queueAMutationObserverMicrotask=p,r.observer_notifyMutationObservers=d,r.observer_queueMutationRecord=g,r.observer_queueTreeMutationRecord=function(y,x,m,v,w){g("childList",y,null,null,null,x,m,v,w)},r.observer_queueAttributeMutationRecord=function(y,x,m,v){g("attributes",y,x,m,v,[],[],null,null)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(3),c=i(9),l=i(29),f=i(73),u=i(51),h=i(30),p=i(37),d=i(106);function g(C,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,C._localName,C._namespace,C._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[C._localName,C._value,_,C._namespace]),a.dom.features.steps&&h.dom_runAttributeChangeSteps(T,C._localName,C._value,_,C._namespace),C._value=_}function y(C,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,C._localName,C._namespace,null),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[C._localName,null,C._value,C._namespace]),a.dom.features.steps&&h.dom_runAttributeChangeSteps(T,C._localName,null,C._value,C._namespace),T._attributeList._asArray().push(C),C._element=T,T._nodeDocument._hasNamespaces||C._namespace===null&&C._namespacePrefix===null&&C._localName!=="xmlns"||(T._nodeDocument._hasNamespaces=!0)}function x(C,T){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(T,C._localName,C._namespace,C._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(T)&&f.customElement_enqueueACustomElementCallbackReaction(T,"attributeChangedCallback",[C._localName,C._value,null,C._namespace]),a.dom.features.steps&&h.dom_runAttributeChangeSteps(T,C._localName,C._value,null,C._namespace);var _=T._attributeList._asArray().indexOf(C);T._attributeList._asArray().splice(_,1),C._element=null}function m(C,T,_){a.dom.features.mutationObservers&&u.observer_queueAttributeMutationRecord(_,C._localName,C._namespace,C._value),a.dom.features.customElements&&s.Guard.isCustomElementNode(_)&&f.customElement_enqueueACustomElementCallbackReaction(_,"attributeChangedCallback",[C._localName,C._value,T._value,C._namespace]),a.dom.features.steps&&h.dom_runAttributeChangeSteps(_,C._localName,C._value,T._value,C._namespace);var S=_._attributeList._asArray().indexOf(C);S!==-1&&(_._attributeList._asArray()[S]=T),C._element=null,T._element=_,_._nodeDocument._hasNamespaces||T._namespace===null&&T._namespacePrefix===null&&T._localName!=="xmlns"||(_._nodeDocument._hasNamespaces=!0)}function v(C,T){return T._namespace===o.namespace.HTML&&T._nodeDocument._type==="html"&&(C=C.toLowerCase()),T._attributeList._asArray().find(function(_){return _._qualifiedName===C})||null}function w(C,T,_){var S=C||null;return _._attributeList._asArray().find(function(b){return b._namespace===S&&b._localName===T})||null}r.element_has=function(C,T){return T._attributeList._asArray().indexOf(C)!==-1},r.element_change=g,r.element_append=y,r.element_remove=x,r.element_replace=m,r.element_getAnAttributeByName=v,r.element_getAnAttributeByNamespaceAndLocalName=w,r.element_getAnAttributeValue=function(C,T,_){_===void 0&&(_="");var S=w(_,T,C);return S===null?"":S._value},r.element_setAnAttribute=function(C,T){if(C._element!==null&&C._element!==T)throw new c.InUseAttributeError("This attribute already exists in the document: "+C._qualifiedName+" as a child of "+C._element._qualifiedName+".");var _=w(C._namespace||"",C._localName,T);return _===C?C:(_!==null?m(_,C,T):y(C,T),_)},r.element_setAnAttributeValue=function(C,T,_,S,b){S===void 0&&(S=null),b===void 0&&(b=null);var D=w(b||"",T,C);if(D===null){var E=l.create_attr(C._nodeDocument,T);return E._namespace=b,E._namespacePrefix=S,E._value=_,void y(E,C)}g(D,C,_)},r.element_removeAnAttributeByName=function(C,T){var _=v(C,T);return _!==null&&x(_,T),_},r.element_removeAnAttributeByNamespaceAndLocalName=function(C,T,_){var S=w(C,T,_);return S!==null&&x(S,_),S},r.element_createAnElement=function(C,T,_,S,b,D){S===void 0&&(S=null),b===void 0&&(b=null),D===void 0&&(D=!1);var E=null;if(!a.dom.features.customElements)return(E=l.create_element(C,T,_,S))._customElementState="uncustomized",E._customElementDefinition=null,E._is=b,E;var R=f.customElement_lookUpACustomElementDefinition(C,_,T,b);if(R!==null&&R.name!==R.localName)(E=new(d.document_elementInterface(T,o.namespace.HTML)))._localName=T,E._namespace=o.namespace.HTML,E._namespacePrefix=S,E._customElementState="undefined",E._customElementDefinition=null,E._is=b,E._nodeDocument=C,D?f.customElement_upgrade(R,E):f.customElement_enqueueACustomElementUpgradeReaction(E,R);else if(R!==null)if(D)try{var F=new R.constructor;if(console.assert(F._customElementState!==void 0),console.assert(F._customElementDefinition!==void 0),console.assert(F._namespace===o.namespace.HTML),F._attributeList.length!==0)throw new c.NotSupportedError("Custom element already has attributes.");if(F._children.size!==0)throw new c.NotSupportedError("Custom element already has child nodes.");if(F._parent!==null)throw new c.NotSupportedError("Custom element already has a parent node.");if(F._nodeDocument!==C)throw new c.NotSupportedError("Custom element is already in a document.");if(F._localName!==T)throw new c.NotSupportedError("Custom element has a different local name.");F._namespacePrefix=S,F._is=null}catch{(E=l.create_htmlUnknownElement(C,T,o.namespace.HTML,S))._customElementState="failed",E._customElementDefinition=null,E._is=null}else(E=l.create_htmlElement(C,T,o.namespace.HTML,S))._customElementState="undefined",E._customElementDefinition=null,E._is=null,f.customElement_enqueueACustomElementUpgradeReaction(E,R);else(E=new(d.document_elementInterface(T,_)))._localName=T,E._namespace=_,E._namespacePrefix=S,E._customElementState="uncustomized",E._customElementDefinition=null,E._is=b,E._nodeDocument=C,_!==o.namespace.HTML||b===null&&!f.customElement_isValidCustomElementName(T)||(E._customElementState="undefined");if(E===null)throw new Error("Unable to create element.");return E},r.element_insertAdjacent=function(C,T,_){switch(T.toLowerCase()){case"beforebegin":return C._parent===null?null:p.mutation_preInsert(_,C._parent,C);case"afterbegin":return p.mutation_preInsert(_,C,C._firstChild);case"beforeend":return p.mutation_preInsert(_,C,null);case"afterend":return C._parent===null?null:p.mutation_preInsert(_,C._parent,C._nextSibling);default:throw new c.SyntaxError(`Invalid 'where' argument. "beforebegin", "afterbegin", "beforeend" or "afterend" expected`)}}},function(n,r,i){function a(o,s){Error.call(this),this.name="YAMLException",this.reason=o,this.mark=s,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.toString=function(o){var s=this.name+": ";return s+=this.reason||"(unknown reason)",!o&&this.mark&&(s+=" "+this.mark.toString()),s},n.exports=a},function(n,r,i){var a=i(39);n.exports=new a({include:[i(181)],implicit:[i(293),i(294)],explicit:[i(295),i(296),i(297),i(298)]})},function(n,r,i){var a=i(16),o=i(79),s=i(40),c=i(24),l=i(56),f=i(14),u=i(115),h=Object.getOwnPropertyDescriptor;r.f=a?h:function(p,d){if(p=c(p),d=l(d,!0),u)try{return h(p,d)}catch{}if(f(p,d))return s(!o.f.call(p,d),p[d])}},function(n,r,i){var a=i(13);n.exports=function(o,s){if(!a(o))return o;var c,l;if(s&&typeof(c=o.toString)=="function"&&!a(l=c.call(o))||typeof(c=o.valueOf)=="function"&&!a(l=c.call(o))||!s&&typeof(c=o.toString)=="function"&&!a(l=c.call(o)))return l;throw TypeError("Can't convert object to primitive value")}},function(n,r,i){var a=i(81),o=i(58),s=a("keys");n.exports=function(c){return s[c]||(s[c]=o(c))}},function(n,r){var i=0,a=Math.random();n.exports=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++i+a).toString(36)}},function(n,r,i){var a=i(42);n.exports=Array.isArray||function(o){return a(o)=="Array"}},function(n,r,i){var a,o=i(18),s=i(188),c=i(84),l=i(45),f=i(189),u=i(116),h=i(57),p=h("IE_PROTO"),d=function(){},g=function(x){return"<script>"+x+"<\/script>"},y=function(){try{a=document.domain&&new ActiveXObject("htmlfile")}catch{}var x,m;y=a?function(w){w.write(g("")),w.close();var C=w.parentWindow.Object;return w=null,C}(a):((m=u("iframe")).style.display="none",f.appendChild(m),m.src="javascript:",(x=m.contentWindow.document).open(),x.write(g("document.F=Object")),x.close(),x.F);for(var v=c.length;v--;)delete y.prototype[c[v]];return y()};l[p]=!0,n.exports=Object.create||function(x,m){var v;return x!==null?(d.prototype=o(x),v=new d,d.prototype=null,v[p]=x):v=y(),m===void 0?v:s(v,m)}},function(n,r,i){var a=i(121),o=i(84);n.exports=Object.keys||function(s){return a(s,o)}},function(n,r,i){var a=i(15).f,o=i(14),s=i(5)("toStringTag");n.exports=function(c,l,f){c&&!o(c=f?c:c.prototype,s)&&a(c,s,{configurable:!0,value:l})}},function(n,r,i){var a=i(8),o=i(5),s=i(129),c=o("species");n.exports=function(l){return s>=51||!a(function(){var f=[];return(f.constructor={})[c]=function(){return{foo:1}},f[l](Boolean).foo!==1})}},function(n,r,i){var a=i(4),o=i(122).indexOf,s=i(48),c=i(28),l=[].indexOf,f=!!l&&1/[1].indexOf(1,-0)<0,u=s("indexOf"),h=c("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:f||!u||!h},{indexOf:function(p){return f?l.apply(this,arguments)||0:o(this,p,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(16),o=i(15).f,s=Function.prototype,c=s.toString,l=/^\s*function ([^ (]*)/;a&&!("name"in s)&&o(s,"name",{configurable:!0,get:function(){try{return c.call(this).match(l)[1]}catch{return""}}})},function(n,r,i){var a=i(25),o=i(18),s=i(8),c=i(136),l=RegExp.prototype,f=l.toString,u=s(function(){return f.call({source:"a",flags:"b"})!="/a/b"}),h=f.name!="toString";(u||h)&&a(RegExp.prototype,"toString",function(){var p=o(this),d=String(p.source),g=p.flags;return"/"+d+"/"+String(g===void 0&&p instanceof RegExp&&!("flags"in l)?c.call(p):g)},{unsafe:!0})},function(n,r,i){i(31),i(32),i(33),i(19),i(138),i(20),i(66),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}),s=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(1),l=i(2),f=function(u){function h(p,d){var g=u.call(this,p)||this;return g._writerOptions=c.applyDefaults(d,{format:"object",wellFormed:!1,group:!1,verbose:!1}),g}return o(h,u),h.prototype.serialize=function(p){return this._currentList=[],this._currentIndex=0,this._listRegister=[this._currentList],this.serializeNode(p,this._writerOptions.wellFormed),this._process(this._currentList,this._writerOptions)},h.prototype._process=function(p,d){var g,y,x,m,v,w,C;if(p.length===0)return{};for(var T={},_=!1,S=0,b=0,D=0,E=0,R=0;R<p.length;R++){var F=p[R];switch(Ce=Object.keys(F)[0]){case"@":continue;case"#":S++;break;case"!":b++;break;case"?":D++;break;case"$":E++;break;default:T[Ce]?_=!0:T[Ce]=!0}}var M=this._getAttrKey(),U=this._getNodeKey(l.NodeType.Text),z=this._getNodeKey(l.NodeType.Comment),Y=this._getNodeKey(l.NodeType.ProcessingInstruction),W=this._getNodeKey(l.NodeType.CData);if(S===1&&p.length===1&&c.isString(p[0]["#"]))return p[0]["#"];if(_){var B={};for(R=0;R<p.length;R++)if(F=p[R],(Ce=Object.keys(F)[0])==="@"){var j=F["@"];(P=Object.keys(j)).length===1?B[M+P[0]]=j[P[0]]:B[M]=F["@"]}var ie=[];for(R=0;R<p.length;R++)switch(F=p[R],Ce=Object.keys(F)[0]){case"@":break;case"#":ie.push(((g={})[U]=F["#"],g));break;case"!":ie.push(((y={})[z]=F["!"],y));break;case"?":ie.push(((x={})[Y]=F["?"],x));break;case"$":ie.push(((m={})[W]=F.$,m));break;default:if((A=F)[Ce].length!==0&&c.isArray(A[Ce][0])){for(var ae=[],fe=A[Ce],Ee=0;Ee<fe.length;Ee++)ae.push(this._process(fe[Ee],d));ie.push(((v={})[Ce]=ae,v))}else d.verbose?ie.push(((w={})[Ce]=[this._process(A[Ce],d)],w)):ie.push(((C={})[Ce]=this._process(A[Ce],d),C))}return B[U]=ie,B}var ge=1,be=1,Re=1,Ne=1;for(B={},R=0;R<p.length;R++){var Ce;switch(F=p[R],Ce=Object.keys(F)[0]){case"@":j=F["@"];var P=Object.keys(j);if(d.group&&P.length!==1)B[M]=j;else for(var O in j)B[M+O]=j[O];break;case"#":ge=this._processSpecItem(F["#"],B,d.group,U,S,ge);break;case"!":be=this._processSpecItem(F["!"],B,d.group,z,b,be);break;case"?":Re=this._processSpecItem(F["?"],B,d.group,Y,D,Re);break;case"$":Ne=this._processSpecItem(F.$,B,d.group,W,E,Ne);break;default:var A;if((A=F)[Ce].length!==0&&c.isArray(A[Ce][0])){ae=[],fe=A[Ce];for(var L=0;L<fe.length;L++)ae.push(this._process(fe[L],d));B[Ce]=ae}else d.verbose?B[Ce]=[this._process(A[Ce],d)]:B[Ce]=this._process(A[Ce],d)}}return B},h.prototype._processSpecItem=function(p,d,g,y,x,m){var v,w;if(!g&&c.isArray(p)&&x+p.length>2)try{for(var C=s(p),T=C.next();!T.done;T=C.next()){var _=T.value;d[y+(m++).toString()]=_}}catch(S){v={error:S}}finally{try{T&&!T.done&&(w=C.return)&&w.call(C)}finally{if(v)throw v.error}}else d[x>1?y+(m++).toString():y]=p;return m},h.prototype.beginElement=function(p){var d,g,y=[];if(this._currentList.length===0)this._currentList.push(((d={})[p]=y,d));else{var x=this._currentList[this._currentList.length-1];this._isElementNode(x,p)?x[p].length!==0&&c.isArray(x[p][0])?x[p].push(y):x[p]=[x[p],y]:this._currentList.push(((g={})[p]=y,g))}this._currentIndex++,this._listRegister.length>this._currentIndex?this._listRegister[this._currentIndex]=y:this._listRegister.push(y),this._currentList=y},h.prototype.endElement=function(){this._currentList=this._listRegister[--this._currentIndex]},h.prototype.attribute=function(p,d){var g,y;if(this._currentList.length===0)this._currentList.push({"@":(g={},g[p]=d,g)});else{var x=this._currentList[this._currentList.length-1];this._isAttrNode(x)?x["@"][p]=d:this._currentList.push({"@":(y={},y[p]=d,y)})}},h.prototype.comment=function(p){if(this._currentList.length===0)this._currentList.push({"!":p});else{var d=this._currentList[this._currentList.length-1];this._isCommentNode(d)?c.isArray(d["!"])?d["!"].push(p):d["!"]=[d["!"],p]:this._currentList.push({"!":p})}},h.prototype.text=function(p){if(this._currentList.length===0)this._currentList.push({"#":p});else{var d=this._currentList[this._currentList.length-1];this._isTextNode(d)?c.isArray(d["#"])?d["#"].push(p):d["#"]=[d["#"],p]:this._currentList.push({"#":p})}},h.prototype.instruction=function(p,d){var g=d===""?p:p+" "+d;if(this._currentList.length===0)this._currentList.push({"?":g});else{var y=this._currentList[this._currentList.length-1];this._isInstructionNode(y)?c.isArray(y["?"])?y["?"].push(g):y["?"]=[y["?"],g]:this._currentList.push({"?":g})}},h.prototype.cdata=function(p){if(this._currentList.length===0)this._currentList.push({$:p});else{var d=this._currentList[this._currentList.length-1];this._isCDATANode(d)?c.isArray(d.$)?d.$.push(p):d.$=[d.$,p]:this._currentList.push({$:p})}},h.prototype._isAttrNode=function(p){return"@"in p},h.prototype._isTextNode=function(p){return"#"in p},h.prototype._isCommentNode=function(p){return"!"in p},h.prototype._isInstructionNode=function(p){return"?"in p},h.prototype._isCDATANode=function(p){return"$"in p},h.prototype._isElementNode=function(p,d){return d in p},h.prototype._getAttrKey=function(){return this._builderOptions.convert.att},h.prototype._getNodeKey=function(p){switch(p){case l.NodeType.Comment:return this._builderOptions.convert.comment;case l.NodeType.Text:return this._builderOptions.convert.text;case l.NodeType.ProcessingInstruction:return this._builderOptions.convert.ins;case l.NodeType.CData:return this._builderOptions.convert.cdata;default:throw new Error("Invalid node type.")}},h}(i(50).BaseWriter);r.ObjectWriter=f},function(n,r,i){var a=i(4),o=i(93);a({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(){this._items={},this._nullItems={}}return o.prototype.set=function(s,c){s===null?this._nullItems[c]=!0:(this._items[s]||(this._items[s]={}),this._items[s][c]=!0)},o.prototype.has=function(s,c){return s===null?this._nullItems[c]===!0:!!this._items[s]&&this._items[s][c]===!0},o}();r.LocalNameSet=a},function(n,r,i){var a=this&&this.__read||function(f,u){var h=typeof Symbol=="function"&&f[Symbol.iterator];if(!h)return f;var p,d,g=h.call(f),y=[];try{for(;(u===void 0||u-- >0)&&!(p=g.next()).done;)y.push(p.value)}catch(x){d={error:x}}finally{try{p&&!p.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return y};Object.defineProperty(r,"__esModule",{value:!0});var o=i(9),s=i(3),c=i(0),l=function(){function f(){}return Object.defineProperty(f.prototype,"_eventListenerList",{get:function(){return this.__eventListenerList||(this.__eventListenerList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"_eventHandlerMap",{get:function(){return this.__eventHandlerMap||(this.__eventHandlerMap={})},enumerable:!0,configurable:!0}),f.prototype.addEventListener=function(u,h,p){p===void 0&&(p={passive:!1,once:!1,capture:!1});var d,g=a(c.eventTarget_flattenMore(p),3),y=g[0],x=g[1],m=g[2];h&&(d=s.Guard.isEventListener(h)?h:{handleEvent:h},c.eventTarget_addEventListener(this,{type:u,callback:d,capture:y,passive:x,once:m,removed:!1}))},f.prototype.removeEventListener=function(u,h,p){p===void 0&&(p={capture:!1});var d=c.eventTarget_flatten(p);if(h)for(var g=0;g<this._eventListenerList.length;g++){var y=this._eventListenerList[g];if(y.type===u&&y.capture===d){if(s.Guard.isEventListener(h)&&y.callback===h){c.eventTarget_removeEventListener(this,y,g);break}if(h&&y.callback.handleEvent===h){c.eventTarget_removeEventListener(this,y,g);break}}}},f.prototype.dispatchEvent=function(u){if(u._dispatchFlag||!u._initializedFlag)throw new o.InvalidStateError;return u._isTrusted=!1,c.event_dispatch(u,this)},f.prototype._getTheParent=function(u){return null},f}();r.EventTargetImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(34),c=i(0),l=function(f){function u(h){var p=f.call(this)||this;return p._data=h,p}return o(u,f),Object.defineProperty(u.prototype,"data",{get:function(){return this._data},set:function(h){c.characterData_replaceData(this,0,this._data.length,h)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"length",{get:function(){return this._data.length},enumerable:!0,configurable:!0}),u.prototype.substringData=function(h,p){return c.characterData_substringData(this,h,p)},u.prototype.appendData=function(h){return c.characterData_replaceData(this,this._data.length,0,h)},u.prototype.insertData=function(h,p){c.characterData_replaceData(this,h,0,p)},u.prototype.deleteData=function(h,p){c.characterData_replaceData(this,h,p,"")},u.prototype.replaceData=function(h,p,d){c.characterData_replaceData(this,h,p,d)},Object.defineProperty(u.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),u.prototype.before=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.after=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.replaceWith=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];throw new Error("Mixin: ChildNode not implemented.")},u.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},u}(s.NodeImpl);r.CharacterDataImpl=l},function(n,r,i){var a=this&&this.__values||function(x){var m=typeof Symbol=="function"&&Symbol.iterator,v=m&&x[m],w=0;if(v)return v.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&w>=x.length&&(x=void 0),{value:x&&x[w++],done:!x}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(x,m){var v=typeof Symbol=="function"&&x[Symbol.iterator];if(!v)return x;var w,C,T=v.call(x),_=[];try{for(;(m===void 0||m-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(S){C={error:S}}finally{try{w&&!w.done&&(v=T.return)&&v.call(T)}finally{if(C)throw C.error}}return _},s=this&&this.__spread||function(){for(var x=[],m=0;m<arguments.length;m++)x=x.concat(o(arguments[m]));return x};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),l=i(3),f=i(1),u=i(17),h=i(51);function p(x){c.dom.window._signalSlots.add(x),h.observer_queueAMutationObserverMicrotask()}function d(x,m){m===void 0&&(m=!1);var v=l.Cast.asNode(x)._parent;if(v===null)return null;var w=v._shadowRoot||null;if(w===null||m&&w._mode!=="open")return null;for(var C=u.tree_getFirstDescendantNode(w,!1,!0,function(T){return l.Guard.isSlot(T)});C!==null;){if(C._name===x._name)return C;C=u.tree_getNextDescendantNode(w,C,!1,!0,function(T){return l.Guard.isSlot(T)})}return null}function g(x){var m,v,w=[],C=u.tree_rootNode(x);if(!l.Guard.isShadowRoot(C))return w;var T=C._host;try{for(var _=a(T._children),S=_.next();!S.done;S=_.next()){var b=S.value;l.Guard.isSlotable(b)&&d(b)===x&&w.push(b)}}catch(D){m={error:D}}finally{try{S&&!S.done&&(v=_.return)&&v.call(_)}finally{if(m)throw m.error}}return w}function y(x){var m,v,w=g(x);if(w.length===x._assignedNodes.length){for(var C=!0,T=0;T<w.length;T++)if(w[T]!==x._assignedNodes[T]){C=!1;break}C||p(x)}x._assignedNodes=w;try{for(var _=a(w),S=_.next();!S.done;S=_.next())S.value._assignedSlot=x}catch(b){m={error:b}}finally{try{S&&!S.done&&(v=_.return)&&v.call(_)}finally{if(m)throw m.error}}}r.shadowTree_signalASlotChange=p,r.shadowTree_isConnected=function(x){return l.Guard.isDocumentNode(u.tree_rootNode(x,!0))},r.shadowTree_isAssigned=function(x){return x._assignedSlot!==null},r.shadowTree_findASlot=d,r.shadowTree_findSlotables=g,r.shadowTree_findFlattenedSlotables=function x(m){var v,w,C,T,_=[],S=u.tree_rootNode(m);if(!l.Guard.isShadowRoot(S))return _;var b=g(m);if(f.isEmpty(b))try{for(var D=a(m._children),E=D.next();!E.done;E=D.next()){var R=E.value;l.Guard.isSlotable(R)&&b.push(R)}}catch(Y){v={error:Y}}finally{try{E&&!E.done&&(w=D.return)&&w.call(D)}finally{if(v)throw v.error}}try{for(var F=a(b),M=F.next();!M.done;M=F.next()){var U=M.value;if(l.Guard.isSlot(U)&&l.Guard.isShadowRoot(u.tree_rootNode(U))){var z=x(U);_.push.apply(_,s(z))}else _.push(U)}}catch(Y){C={error:Y}}finally{try{M&&!M.done&&(T=F.return)&&T.call(F)}finally{if(C)throw C.error}}return _},r.shadowTree_assignSlotables=y,r.shadowTree_assignSlotablesForATree=function(x){for(var m=u.tree_getFirstDescendantNode(x,!0,!1,function(v){return l.Guard.isSlot(v)});m!==null;)y(m),m=u.tree_getNextDescendantNode(x,m,!0,!1,function(v){return l.Guard.isSlot(v)})},r.shadowTree_assignASlot=function(x){var m=d(x);m!==null&&y(m)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=/[a-z]([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*/,o=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]),s=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]),c=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),l=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);r.customElement_isValidCustomElementName=function(f){return!!a.test(f)&&!o.has(f)},r.customElement_isValidElementName=function(f){return s.has(f)},r.customElement_isVoidElementName=function(f){return c.has(f)},r.customElement_isValidShadowHostName=function(f){return l.has(f)},r.customElement_enqueueACustomElementUpgradeReaction=function(f,u){},r.customElement_enqueueACustomElementCallbackReaction=function(f,u,h){},r.customElement_upgrade=function(f,u){},r.customElement_tryToUpgrade=function(f){},r.customElement_lookUpACustomElementDefinition=function(f,u,h,p){return null}},function(n,r,i){i(4)({target:"String",proto:!0},{repeat:i(259)})},function(n,r,i){i(278),i(68),i(179),i(94),Object.defineProperty(r,"__esModule",{value:!0});var a=i(109),o=function(){function s(c){this._builderOptions=c,c.parser&&Object.assign(this,c.parser)}return s.prototype._docType=function(c,l,f,u){return c.dtd({name:l,pubID:f,sysID:u})},s.prototype._comment=function(c,l){return c.com(l)},s.prototype._text=function(c,l){return c.txt(l)},s.prototype._instruction=function(c,l,f){return c.ins(l,f)},s.prototype._cdata=function(c,l){return c.dat(l)},s.prototype._element=function(c,l,f){return l===void 0?c.ele(f):c.ele(l,f)},s.prototype._attribute=function(c,l,f,u){return l===void 0?c.att(f,u):c.att(l,f,u)},s.prototype._sanitize=function(c){return a.sanitizeInput(c,this._builderOptions.invalidCharReplacement)},s.prototype._decodeText=function(c){return c==null?c:c.replace(/&(quot|amp|apos|lt|gt);/g,function(l,f){return s._entityTable[f]}).replace(/&#(?:x([a-fA-F0-9]+)|([0-9]+));/g,function(l,f,u){return String.fromCodePoint(parseInt(f||u,f?16:10))})},s.prototype._decodeAttributeValue=function(c){return this._decodeText(c)},s.prototype.parse=function(c,l){return this._parse(c,l)},s.prototype.docType=function(c,l,f,u){return this._docType(c,l,f,u)},s.prototype.comment=function(c,l){return this._comment(c,l)},s.prototype.text=function(c,l){return this._text(c,l)},s.prototype.instruction=function(c,l,f){return this._instruction(c,l,f)},s.prototype.cdata=function(c,l){return this._cdata(c,l)},s.prototype.element=function(c,l,f){return this._element(c,l,f)},s.prototype.attribute=function(c,l,f,u){return this._attribute(c,l,f,u)},s.prototype.sanitize=function(c){return this._sanitize(c)},s._entityTable={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},s}();r.BaseReader=o},function(n,r,i){var a=i(39);n.exports=a.DEFAULT=new a({include:[i(54)],explicit:[i(299),i(300),i(301)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(185);r.XMLBuilderImpl=a.XMLBuilderImpl;var o=i(304);r.XMLBuilderCBImpl=o.XMLBuilderCBImpl;var s=i(183);r.builder=s.builder,r.create=s.create,r.fragment=s.fragment,r.convert=s.convert;var c=i(309);r.createCB=c.createCB,r.fragmentCB=c.fragmentCB},function(n,r){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}n.exports=i},function(n,r,i){var a={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!a.call({1:2},1);r.f=s?function(c){var l=o(this,c);return!!l&&l.enumerable}:a},function(n,r,i){var a=i(11),o=i(21);n.exports=function(s,c){try{o(a,s,c)}catch{a[s]=c}return c}},function(n,r,i){var a=i(44),o=i(118);(n.exports=function(s,c){return o[s]||(o[s]=c!==void 0?c:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(n,r,i){var a=i(121),o=i(84).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(s){return a(s,o)}},function(n,r,i){var a=i(47),o=Math.max,s=Math.min;n.exports=function(c,l){var f=a(c);return f<0?o(f+l,0):s(f,l)}},function(n,r){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,r){r.f=Object.getOwnPropertySymbols},function(n,r,i){var a=i(8);n.exports=!!Object.getOwnPropertySymbols&&!a(function(){return!String(Symbol())})},function(n,r,i){var a=i(127);n.exports=function(o,s,c){if(a(o),s===void 0)return o;switch(c){case 0:return function(){return o.call(s)};case 1:return function(l){return o.call(s,l)};case 2:return function(l,f){return o.call(s,l,f)};case 3:return function(l,f,u){return o.call(s,l,f,u)}}return function(){return o.apply(s,arguments)}}},function(n,r,i){var a=i(4),o=i(195),s=i(132),c=i(133),l=i(62),f=i(21),u=i(25),h=i(5),p=i(44),d=i(49),g=i(131),y=g.IteratorPrototype,x=g.BUGGY_SAFARI_ITERATORS,m=h("iterator"),v=function(){return this};n.exports=function(w,C,T,_,S,b,D){o(T,C,_);var E,R,F,M=function(ie){if(ie===S&&B)return B;if(!x&&ie in Y)return Y[ie];switch(ie){case"keys":case"values":case"entries":return function(){return new T(this,ie)}}return function(){return new T(this)}},U=C+" Iterator",z=!1,Y=w.prototype,W=Y[m]||Y["@@iterator"]||S&&Y[S],B=!x&&W||M(S),j=C=="Array"&&Y.entries||W;if(j&&(E=s(j.call(new w)),y!==Object.prototype&&E.next&&(p||s(E)===y||(c?c(E,y):typeof E[m]!="function"&&f(E,m,v)),l(E,U,!0,!0),p&&(d[U]=v))),S=="values"&&W&&W.name!=="values"&&(z=!0,B=function(){return W.call(this)}),p&&!D||Y[m]===B||f(Y,m,B),d[C]=B,S)if(R={values:M("values"),keys:b?B:M("keys"),entries:M("entries")},D)for(F in R)(x||z||!(F in Y))&&u(Y,F,R[F]);else a({target:C,proto:!0,forced:x||z},R);return R}},function(n,r,i){var a=i(4),o=i(13),s=i(59),c=i(83),l=i(26),f=i(24),u=i(134),h=i(5),p=i(63),d=i(28),g=p("slice"),y=d("slice",{ACCESSORS:!0,0:0,1:2}),x=h("species"),m=[].slice,v=Math.max;a({target:"Array",proto:!0,forced:!g||!y},{slice:function(w,C){var T,_,S,b=f(this),D=l(b.length),E=c(w,D),R=c(C===void 0?D:C,D);if(s(b)&&(typeof(T=b.constructor)!="function"||T!==Array&&!s(T.prototype)?o(T)&&(T=T[x])===null&&(T=void 0):T=void 0,T===Array||T===void 0))return m.call(b,E,R);for(_=new(T===void 0?Array:T)(v(R-E,0)),S=0;E<R;E++,S++)E in b&&u(_,S,b[E]);return _.length=S,_}})},function(n,r,i){var a={};a[i(5)("toStringTag")]="z",n.exports=String(a)==="[object z]"},function(n,r,i){i(19),i(138),i(20),i(92),i(22),i(23),Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultBuilderOptions={version:"1.0",encoding:void 0,standalone:void 0,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},invalidCharReplacement:void 0,parser:void 0},r.XMLBuilderOptionKeys=new Set(Object.keys(r.DefaultBuilderOptions)),r.DefaultXMLBuilderCBOptions={format:"xml",wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,spaceBeforeSlash:!1,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}}},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Set",function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}},o)},function(n,r,i){var a,o,s=i(136),c=i(221),l=RegExp.prototype.exec,f=String.prototype.replace,u=l,h=(a=/a/,o=/b*/g,l.call(a,"a"),l.call(o,"a"),a.lastIndex!==0||o.lastIndex!==0),p=c.UNSUPPORTED_Y||c.BROKEN_CARET,d=/()??/.exec("")[1]!==void 0;(h||d||p)&&(u=function(g){var y,x,m,v,w=this,C=p&&w.sticky,T=s.call(w),_=w.source,S=0,b=g;return C&&((T=T.replace("y","")).indexOf("g")===-1&&(T+="g"),b=String(g).slice(w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&g[w.lastIndex-1]!==`
`)&&(_="(?: "+_+")",b=" "+b,S++),x=new RegExp("^(?:"+_+")",T)),d&&(x=new RegExp("^"+_+"$(?!\\s)",T)),h&&(y=w.lastIndex),m=l.call(C?x:w,b),C?m?(m.input=m.input.slice(S),m[0]=m[0].slice(S),m.index=w.lastIndex,w.lastIndex+=m[0].length):w.lastIndex=0:h&&m&&(w.lastIndex=w.global?m.index+m[0].length:y),d&&m&&m.length>1&&f.call(m[0],x,function(){for(v=1;v<arguments.length-2;v++)arguments[v]===void 0&&(m[v]=void 0)}),m}),n.exports=u},function(n,r,i){var a=i(225),o=i(18),s=i(27),c=i(26),l=i(47),f=i(35),u=i(226),h=i(227),p=Math.max,d=Math.min,g=Math.floor,y=/\$([$&'`]|\d\d?|<[^>]*>)/g,x=/\$([$&'`]|\d\d?)/g;a("replace",2,function(m,v,w,C){var T=C.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=C.REPLACE_KEEPS_$0,S=T?"$":"$0";return[function(D,E){var R=f(this),F=D?.[m];return F!==void 0?F.call(D,R,E):v.call(String(R),D,E)},function(D,E){if(!T&&_||typeof E=="string"&&E.indexOf(S)===-1){var R=w(v,D,this,E);if(R.done)return R.value}var F=o(D),M=String(this),U=typeof E=="function";U||(E=String(E));var z=F.global;if(z){var Y=F.unicode;F.lastIndex=0}for(var W=[];;){var B=h(F,M);if(B===null||(W.push(B),!z))break;String(B[0])===""&&(F.lastIndex=u(M,c(F.lastIndex),Y))}for(var j,ie="",ae=0,fe=0;fe<W.length;fe++){B=W[fe];for(var Ee=String(B[0]),ge=p(d(l(B.index),M.length),0),be=[],Re=1;Re<B.length;Re++)be.push((j=B[Re])===void 0?j:String(j));var Ne=B.groups;if(U){var Ce=[Ee].concat(be,ge,M);Ne!==void 0&&Ce.push(Ne);var P=String(E.apply(void 0,Ce))}else P=b(Ee,M,ge,be,Ne,E);ge>=ae&&(ie+=M.slice(ae,ge)+P,ae=ge+Ee.length)}return ie+M.slice(ae)}];function b(D,E,R,F,M,U){var z=R+D.length,Y=F.length,W=x;return M!==void 0&&(M=s(M),W=y),v.call(U,W,function(B,j){var ie;switch(j.charAt(0)){case"$":return"$";case"&":return D;case"`":return E.slice(0,R);case"'":return E.slice(z);case"<":ie=M[j.slice(1,-1)];break;default:var ae=+j;if(ae===0)return B;if(ae>Y){var fe=g(ae/10);return fe===0?B:fe<=Y?F[fe-1]===void 0?j.charAt(1):F[fe-1]+j.charAt(1):B}ie=F[ae-1]}return ie===void 0?"":ie})}})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(){this._items={},this._nullItems=[]}return o.prototype.copy=function(){var s=new o;for(var c in this._items)s._items[c]=this._items[c].slice(0);return s._nullItems=this._nullItems.slice(0),s},o.prototype.get=function(s,c){var l=c===null?this._nullItems:this._items[c]||null;if(l===null)return null;for(var f=null,u=0;u<l.length;u++)if((f=l[u])===s)return f;return f},o.prototype.has=function(s,c){var l=c===null?this._nullItems:this._items[c]||null;return l!==null&&l.indexOf(s)!==-1},o.prototype.hasPrefix=function(s){if(this._nullItems.indexOf(s)!==-1)return!0;for(var c in this._items)if(this._items[c].indexOf(s)!==-1)return!0;return!1},o.prototype.set=function(s,c){var l=c===null?this._nullItems:this._items[c]||null;c!==null&&l===null?this._items[c]=[s]:l.push(s)},o}();r.NamespacePrefixMap=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Surrogate=/[\uD800-\uDFFF]/,r.ScalarValue=/[\uD800-\uDFFF]/,r.NonCharacter=/[\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]/,r.ASCIICodePoint=/[\u0000-\u007F]/,r.ASCIITabOrNewLine=/[\t\n\r]/,r.ASCIIWhiteSpace=/[\t\n\f\r ]/,r.C0Control=/[\u0000-\u001F]/,r.C0ControlOrSpace=/[\u0000-\u001F ]/,r.Control=/[\u0000-\u001F\u007F-\u009F]/,r.ASCIIDigit=/[0-9]/,r.ASCIIUpperHexDigit=/[0-9A-F]/,r.ASCIILowerHexDigit=/[0-9a-f]/,r.ASCIIHexDigit=/[0-9A-Fa-f]/,r.ASCIIUpperAlpha=/[A-Z]/,r.ASCIILowerAlpha=/[a-z]/,r.ASCIIAlpha=/[A-Za-z]/,r.ASCIIAlphanumeric=/[0-9A-Za-z]/},function(n,r,i){var a=this&&this.__values||function(E){var R=typeof Symbol=="function"&&Symbol.iterator,F=R&&E[R],M=0;if(F)return F.call(E);if(E&&typeof E.length=="number")return{next:function(){return E&&M>=E.length&&(E=void 0),{value:E&&E[M++],done:!E}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(E,R){var F=typeof Symbol=="function"&&E[Symbol.iterator];if(!F)return E;var M,U,z=F.call(E),Y=[];try{for(;(R===void 0||R-- >0)&&!(M=z.next()).done;)Y.push(M.value)}catch(W){U={error:W}}finally{try{M&&!M.done&&(F=z.return)&&F.call(z)}finally{if(U)throw U.error}}return Y},s=this&&this.__spread||function(){for(var E=[],R=0;R<arguments.length;R++)E=E.concat(o(arguments[R]));return E};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),l=i(2),f=i(3),u=i(171),h=i(104),p=i(9),d=i(17),g=i(72),y=i(30);function x(E,R){R===void 0&&(R=void 0),R===void 0&&(R=null);var F=m(E,R,new Date,{});return F._isTrusted=!0,F}function m(E,R,F,M){var U=new E("");return U._initializedFlag=!0,U._timeStamp=F.getTime(),Object.assign(U,M),c.dom.features.steps&&y.dom_runEventConstructingSteps(U),U}function v(E,R,F,M){var U,z,Y,W;F===void 0&&(F=!1),M===void 0&&(M={value:!1});var B=!1;E._dispatchFlag=!0;var j=R;if(F){var ie=R._associatedDocument;f.Guard.isDocumentNode(ie)&&(j=ie)}var ae=null,fe=d.tree_retarget(E._relatedTarget,R);if(R!==fe||R===E._relatedTarget){var Ee=[];try{for(var ge=a(E._touchTargetList),be=ge.next();!be.done;be=ge.next()){var Re=be.value;Ee.push(d.tree_retarget(Re,R))}}catch(_e){U={error:_e}}finally{try{be&&!be.done&&(z=ge.return)&&z.call(ge)}finally{if(U)throw U.error}}w(E,R,j,fe,Ee,!1);var Ne=f.Guard.isMouseEvent(E)&&E._type==="click";Ne&&R._activationBehavior!==void 0&&(ae=R);for(var Ce=f.Guard.isSlotable(R)&&g.shadowTree_isAssigned(R)?R:null,P=!1,O=R._getTheParent(E);O!==null&&f.Guard.isNode(O);){if(Ce!==null){if(!f.Guard.isSlot(O))throw new Error("Parent node of a slotable should be a slot.");Ce=null;var A=d.tree_rootNode(O,!0);f.Guard.isShadowRoot(A)&&A._mode==="closed"&&(P=!0)}f.Guard.isSlotable(O)&&g.shadowTree_isAssigned(O)&&(Ce=O),fe=d.tree_retarget(E._relatedTarget,O),Ee=[];try{for(var L=(Y=void 0,a(E._touchTargetList)),k=L.next();!k.done;k=L.next())Re=k.value,Ee.push(d.tree_retarget(Re,O))}catch(_e){Y={error:_e}}finally{try{k&&!k.done&&(W=L.return)&&W.call(L)}finally{if(Y)throw Y.error}}f.Guard.isWindow(O)||f.Guard.isNode(O)&&f.Guard.isNode(R)&&d.tree_isAncestorOf(d.tree_rootNode(R,!0),O,!0,!0)?(Ne&&E._bubbles&&ae===null&&O._activationBehavior&&(ae=O),w(E,O,null,fe,Ee,P)):O===fe?O=null:(R=O,Ne&&ae===null&&R._activationBehavior&&(ae=R),w(E,O,R,fe,Ee,P)),O!==null&&(O=O._getTheParent(E)),P=!1}for(var $=null,H=E._path,se=H.length-1;se>=0;se--)if((ye=H[se]).shadowAdjustedTarget!==null){$=ye;break}if($!==null)if(f.Guard.isNode($.shadowAdjustedTarget)&&f.Guard.isShadowRoot(d.tree_rootNode($.shadowAdjustedTarget,!0)))B=!0;else if(f.Guard.isNode($.relatedTarget)&&f.Guard.isShadowRoot(d.tree_rootNode($.relatedTarget,!0)))B=!0;else for(var me=0;me<$.touchTargetList.length;me++){var ye=$.touchTargetList[me];if(f.Guard.isNode(ye)&&f.Guard.isShadowRoot(d.tree_rootNode(ye,!0))){B=!0;break}}for(ae!==null&&ae._legacyPreActivationBehavior!==void 0&&ae._legacyPreActivationBehavior(E),se=H.length-1;se>=0;se--)(ye=H[se]).shadowAdjustedTarget!==null?E._eventPhase=l.EventPhase.AtTarget:E._eventPhase=l.EventPhase.Capturing,C(ye,E,"capturing",M);for(se=0;se<H.length;se++){if((ye=H[se]).shadowAdjustedTarget!==null)E._eventPhase=l.EventPhase.AtTarget;else{if(!E._bubbles)continue;E._eventPhase=l.EventPhase.Bubbling}C(ye,E,"bubbling",M)}}return E._eventPhase=l.EventPhase.None,E._currentTarget=null,E._path=[],E._dispatchFlag=!1,E._stopPropagationFlag=!1,E._stopImmediatePropagationFlag=!1,B&&(E._target=null,E._relatedTarget=null,E._touchTargetList=[]),ae!==null&&(E._canceledFlag||ae._activationBehavior===void 0?ae._legacyCanceledActivationBehavior!==void 0&&ae._legacyCanceledActivationBehavior(E):ae._activationBehavior(E)),!E._canceledFlag}function w(E,R,F,M,U,z){var Y=!1;f.Guard.isNode(R)&&f.Guard.isShadowRoot(d.tree_rootNode(R))&&(Y=!0);var W=!1;f.Guard.isShadowRoot(R)&&R._mode==="closed"&&(W=!0),E._path.push({invocationTarget:R,invocationTargetInShadowTree:Y,shadowAdjustedTarget:F,relatedTarget:M,touchTargetList:U,rootOfClosedTree:W,slotInClosedTree:z})}function C(E,R,F,M){M===void 0&&(M={value:!1});for(var U=R._path,z=-1,Y=0;Y<U.length;Y++)if(U[Y]===E){z=Y;break}if(z!==-1){var W=U[z];(W.shadowAdjustedTarget!==null||z>0&&(W=U[z-1]).shadowAdjustedTarget!==null)&&(R._target=W.shadowAdjustedTarget)}if(R._relatedTarget=E.relatedTarget,R._touchTargetList=E.touchTargetList,!R._stopPropagationFlag){R._currentTarget=E.invocationTarget;var B=R._currentTarget._eventListenerList,j=new(Array.bind.apply(Array,s([void 0],B)));if(!T(R,j,F,E,M)&&R._isTrusted){var ie=R._type;ie==="animationend"?R._type="webkitAnimationEnd":ie==="animationiteration"?R._type="webkitAnimationIteration":ie==="animationstart"?R._type="webkitAnimationStart":ie==="transitionend"&&(R._type="webkitTransitionEnd"),T(R,j,F,E,M),R._type=ie}}}function T(E,R,F,M,U){U===void 0&&(U={value:!1});for(var z=!1,Y=0;Y<R.length;Y++){var W=R[Y];if(!W.removed){if(E._type!==W.type||(z=!0,F==="capturing"&&!W.capture)||F==="bubbling"&&W.capture)continue;if(W.once&&E._currentTarget!==null){for(var B=E._currentTarget,j=-1,ie=0;ie<B._eventListenerList.length;ie++)if(B._eventListenerList[ie]===W){j=ie;break}j!==-1&&B._eventListenerList.splice(j,1)}var ae=void 0,fe=void 0;f.Guard.isWindow(ae)&&(fe=ae._currentEvent,M.invocationTargetInShadowTree===!1&&(ae._currentEvent=E)),W.passive&&(E._inPassiveListenerFlag=!0);try{W.callback.handleEvent.call(E._currentTarget,E)}catch{U.value=!0}if(W.passive&&(E._inPassiveListenerFlag=!1),f.Guard.isWindow(ae)&&(ae._currentEvent=fe),E._stopImmediatePropagationFlag)return z}}return z}function _(E,R){return null}function S(E,R){return null}function b(E,R){}function D(E,R){}r.event_setTheCanceledFlag=function(E){E._cancelable&&!E._inPassiveListenerFlag&&(E._canceledFlag=!0)},r.event_initialize=function(E,R,F,M){E._initializedFlag=!0,E._stopPropagationFlag=!1,E._stopImmediatePropagationFlag=!1,E._canceledFlag=!1,E._isTrusted=!1,E._target=null,E._type=R,E._bubbles=F,E._cancelable=M},r.event_createAnEvent=x,r.event_innerEventCreationSteps=m,r.event_dispatch=v,r.event_appendToAnEventPath=w,r.event_invoke=C,r.event_innerInvoke=T,r.event_fireAnEvent=function(E,R,F,M,U){F===void 0&&(F=h.EventImpl);var z=x(F);if(z._type=E,M)for(var Y in M)z[Y]=M[Y];return v(z,R,U)},r.event_createLegacyEvent=function(E){var R=null;switch(E.toLowerCase()){case"beforeunloadevent":case"compositionevent":break;case"customevent":R=u.CustomEventImpl;break;case"devicemotionevent":case"deviceorientationevent":case"dragevent":break;case"event":case"events":R=h.EventImpl}if(R===null)throw new p.NotSupportedError("Event constructor not found for interface "+E+".");var F=new R("");return F._type="",F._timeStamp=new Date().getTime(),F._isTrusted=!1,F._initializedFlag=!1,F},r.event_getterEventHandlerIDLAttribute=function(E,R){return null},r.event_setterEventHandlerIDLAttribute=function(E,R,F){},r.event_determineTheTargetOfAnEventHandler=_,r.event_getTheCurrentValueOfAnEventHandler=S,r.event_activateAnEventHandler=b,r.event_deactivateAnEventHandler=D},function(n,r,i){var a,o=this&&this.__extends||(a=function(w,C){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,_){T.__proto__=_}||function(T,_){for(var S in _)_.hasOwnProperty(S)&&(T[S]=_[S])})(w,C)},function(w,C){function T(){this.constructor=w}a(w,C),w.prototype=C===null?Object.create(C):(T.prototype=C.prototype,new T)}),s=this&&this.__values||function(w){var C=typeof Symbol=="function"&&Symbol.iterator,T=C&&w[C],_=0;if(T)return T.call(w);if(w&&typeof w.length=="number")return{next:function(){return w&&_>=w.length&&(w=void 0),{value:w&&w[_++],done:!w}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(w,C){var T=typeof Symbol=="function"&&w[Symbol.iterator];if(!T)return w;var _,S,b=T.call(w),D=[];try{for(;(C===void 0||C-- >0)&&!(_=b.next()).done;)D.push(_.value)}catch(E){S={error:E}}finally{try{_&&!_.done&&(T=b.return)&&T.call(b)}finally{if(S)throw S.error}}return D};Object.defineProperty(r,"__esModule",{value:!0});var l=i(6),f=i(2),u=i(9),h=i(34),p=i(3),d=i(1),g=i(7),y=i(152),x=i(0),m=i(12),v=function(w){function C(){var T=w.call(this)||this;return T._children=new Set,T._encoding={name:"UTF-8",labels:["unicode-1-1-utf-8","utf-8","utf8"]},T._contentType="application/xml",T._URL={scheme:"about",username:"",password:"",host:null,port:null,path:["blank"],query:null,fragment:null,_cannotBeABaseURLFlag:!0,_blobURLEntry:null},T._origin=null,T._type="xml",T._mode="no-quirks",T._documentElement=null,T._hasNamespaces=!1,T._nodeDocumentOverwrite=null,T}return o(C,w),Object.defineProperty(C.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverwrite||this},set:function(T){this._nodeDocumentOverwrite=T},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"implementation",{get:function(){return this._implementation||(this._implementation=x.create_domImplementation(this))},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"URL",{get:function(){return y.urlSerializer(this._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"documentURI",{get:function(){return this.URL},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"origin",{get:function(){return"null"},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"compatMode",{get:function(){return this._mode==="quirks"?"BackCompat":"CSS1Compat"},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"characterSet",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"charset",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"inputEncoding",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"contentType",{get:function(){return this._contentType},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"doctype",{get:function(){var T,_;try{for(var S=s(this._children),b=S.next();!b.done;b=S.next()){var D=b.value;if(p.Guard.isDocumentTypeNode(D))return D}}catch(E){T={error:E}}finally{try{b&&!b.done&&(_=S.return)&&_.call(S)}finally{if(T)throw T.error}}return null},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"documentElement",{get:function(){return this._documentElement},enumerable:!0,configurable:!0}),C.prototype.getElementsByTagName=function(T){return x.node_listOfElementsWithQualifiedName(T,this)},C.prototype.getElementsByTagNameNS=function(T,_){return x.node_listOfElementsWithNamespace(T,_,this)},C.prototype.getElementsByClassName=function(T){return x.node_listOfElementsWithClassNames(T,this)},C.prototype.createElement=function(T,_){if(!x.xml_isName(T))throw new u.InvalidCharacterError;this._type==="html"&&(T=T.toLowerCase());var S=null;_!==void 0&&(S=d.isString(_)?_:_.is);var b=this._type==="html"||this._contentType==="application/xhtml+xml"?g.namespace.HTML:null;return x.element_createAnElement(this,T,b,null,S,!0)},C.prototype.createElementNS=function(T,_,S){return x.document_internalCreateElementNS(this,T,_,S)},C.prototype.createDocumentFragment=function(){return x.create_documentFragment(this)},C.prototype.createTextNode=function(T){return x.create_text(this,T)},C.prototype.createCDATASection=function(T){if(this._type==="html")throw new u.NotSupportedError;if(T.indexOf("]]>")!==-1)throw new u.InvalidCharacterError;return x.create_cdataSection(this,T)},C.prototype.createComment=function(T){return x.create_comment(this,T)},C.prototype.createProcessingInstruction=function(T,_){if(!x.xml_isName(T))throw new u.InvalidCharacterError;if(_.indexOf("?>")!==-1)throw new u.InvalidCharacterError;return x.create_processingInstruction(this,T,_)},C.prototype.importNode=function(T,_){if(_===void 0&&(_=!1),p.Guard.isDocumentNode(T)||p.Guard.isShadowRoot(T))throw new u.NotSupportedError;return x.node_clone(T,this,_)},C.prototype.adoptNode=function(T){if(p.Guard.isDocumentNode(T))throw new u.NotSupportedError;if(p.Guard.isShadowRoot(T))throw new u.HierarchyRequestError;return x.document_adopt(T,this),T},C.prototype.createAttribute=function(T){if(!x.xml_isName(T))throw new u.InvalidCharacterError;return this._type==="html"&&(T=T.toLowerCase()),x.create_attr(this,T)},C.prototype.createAttributeNS=function(T,_){var S=c(x.namespace_validateAndExtract(T,_),3),b=S[0],D=S[1],E=S[2],R=x.create_attr(this,E);return R._namespace=b,R._namespacePrefix=D,R},C.prototype.createEvent=function(T){return x.event_createLegacyEvent(T)},C.prototype.createRange=function(){var T=x.create_range();return T._start=[this,0],T._end=[this,0],T},C.prototype.createNodeIterator=function(T,_,S){_===void 0&&(_=f.WhatToShow.All),S===void 0&&(S=null);var b=x.create_nodeIterator(T,T,!0);return b._whatToShow=_,b._iteratorCollection=x.create_nodeList(T),d.isFunction(S)?(b._filter=x.create_nodeFilter(),b._filter.acceptNode=S):b._filter=S,b},C.prototype.createTreeWalker=function(T,_,S){_===void 0&&(_=f.WhatToShow.All),S===void 0&&(S=null);var b=x.create_treeWalker(T,T);return b._whatToShow=_,d.isFunction(S)?(b._filter=x.create_nodeFilter(),b._filter.acceptNode=S):b._filter=S,b},C.prototype._getTheParent=function(T){return T._type==="load"?null:l.dom.window},C.prototype.getElementById=function(T){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(C.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),C.prototype.prepend=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},C.prototype.append=function(){for(var T=[],_=0;_<arguments.length;_++)T[_]=arguments[_];throw new Error("Mixin: ParentNode not implemented.")},C.prototype.querySelector=function(T){throw new Error("Mixin: ParentNode not implemented.")},C.prototype.querySelectorAll=function(T){throw new Error("Mixin: ParentNode not implemented.")},C}(h.NodeImpl);r.DocumentImpl=v,m.idl_defineConst(v.prototype,"_nodeType",f.NodeType.Document)},function(n,r,i){var a,o=this&&this.__extends||(a=function(y,x){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,v){m.__proto__=v}||function(m,v){for(var w in v)v.hasOwnProperty(w)&&(m[w]=v[w])})(y,x)},function(y,x){function m(){this.constructor=y}a(y,x),y.prototype=x===null?Object.create(x):(m.prototype=x.prototype,new m)}),s=this&&this.__values||function(y){var x=typeof Symbol=="function"&&Symbol.iterator,m=x&&y[x],v=0;if(m)return m.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&v>=y.length&&(y=void 0),{value:y&&y[v++],done:!y}}};throw new TypeError(x?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(y,x){var m=typeof Symbol=="function"&&y[Symbol.iterator];if(!m)return y;var v,w,C=m.call(y),T=[];try{for(;(x===void 0||x-- >0)&&!(v=C.next()).done;)T.push(v.value)}catch(_){w={error:_}}finally{try{v&&!v.done&&(m=C.return)&&m.call(C)}finally{if(w)throw w.error}}return T};Object.defineProperty(r,"__esModule",{value:!0});var l=i(2),f=i(34),u=i(9),h=i(7),p=i(0),d=i(12),g=function(y){function x(){var m=y.call(this)||this;return m._children=new Set,m._namespace=null,m._namespacePrefix=null,m._localName="",m._customElementState="undefined",m._customElementDefinition=null,m._is=null,m._shadowRoot=null,m._attributeList=p.create_namedNodeMap(m),m._attributeChangeSteps=[],m._name="",m._assignedSlot=null,m}return o(x,y),Object.defineProperty(x.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"tagName",{get:function(){return this._htmlUppercasedQualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"id",{get:function(){return p.element_getAnAttributeValue(this,"id")},set:function(m){p.element_setAnAttributeValue(this,"id",m)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"className",{get:function(){return p.element_getAnAttributeValue(this,"class")},set:function(m){p.element_setAnAttributeValue(this,"class",m)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"classList",{get:function(){var m=p.element_getAnAttributeByName("class",this);return m===null&&(m=p.create_attr(this._nodeDocument,"class")),p.create_domTokenList(this,m)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"slot",{get:function(){return p.element_getAnAttributeValue(this,"slot")},set:function(m){p.element_setAnAttributeValue(this,"slot",m)},enumerable:!0,configurable:!0}),x.prototype.hasAttributes=function(){return this._attributeList.length!==0},Object.defineProperty(x.prototype,"attributes",{get:function(){return this._attributeList},enumerable:!0,configurable:!0}),x.prototype.getAttributeNames=function(){var m,v,w=[];try{for(var C=s(this._attributeList),T=C.next();!T.done;T=C.next()){var _=T.value;w.push(_._qualifiedName)}}catch(S){m={error:S}}finally{try{T&&!T.done&&(v=C.return)&&v.call(C)}finally{if(m)throw m.error}}return w},x.prototype.getAttribute=function(m){var v=p.element_getAnAttributeByName(m,this);return v?v._value:null},x.prototype.getAttributeNS=function(m,v){var w=p.element_getAnAttributeByNamespaceAndLocalName(m,v,this);return w?w._value:null},x.prototype.setAttribute=function(m,v){if(!p.xml_isName(m))throw new u.InvalidCharacterError;this._namespace===h.namespace.HTML&&this._nodeDocument._type==="html"&&(m=m.toLowerCase());for(var w=null,C=0;C<this._attributeList.length;C++){var T=this._attributeList[C];if(T._qualifiedName===m){w=T;break}}if(w===null)return(w=p.create_attr(this._nodeDocument,m))._value=v,void p.element_append(w,this);p.element_change(w,this,v)},x.prototype.setAttributeNS=function(m,v,w){var C=c(p.namespace_validateAndExtract(m,v),3),T=C[0],_=C[1],S=C[2];p.element_setAnAttributeValue(this,S,w,_,T)},x.prototype.removeAttribute=function(m){p.element_removeAnAttributeByName(m,this)},x.prototype.removeAttributeNS=function(m,v){p.element_removeAnAttributeByNamespaceAndLocalName(m,v,this)},x.prototype.hasAttribute=function(m){this._namespace===h.namespace.HTML&&this._nodeDocument._type==="html"&&(m=m.toLowerCase());for(var v=0;v<this._attributeList.length;v++)if(this._attributeList[v]._qualifiedName===m)return!0;return!1},x.prototype.toggleAttribute=function(m,v){if(!p.xml_isName(m))throw new u.InvalidCharacterError;this._namespace===h.namespace.HTML&&this._nodeDocument._type==="html"&&(m=m.toLowerCase());for(var w=null,C=0;C<this._attributeList.length;C++){var T=this._attributeList[C];if(T._qualifiedName===m){w=T;break}}return w===null?(v===void 0||v===!0)&&((w=p.create_attr(this._nodeDocument,m))._value="",p.element_append(w,this),!0):v!==void 0&&v!==!1||(p.element_removeAnAttributeByName(m,this),!1)},x.prototype.hasAttributeNS=function(m,v){for(var w=m||null,C=0;C<this._attributeList.length;C++){var T=this._attributeList[C];if(T._namespace===w&&T._localName===v)return!0}return!1},x.prototype.getAttributeNode=function(m){return p.element_getAnAttributeByName(m,this)},x.prototype.getAttributeNodeNS=function(m,v){return p.element_getAnAttributeByNamespaceAndLocalName(m,v,this)},x.prototype.setAttributeNode=function(m){return p.element_setAnAttribute(m,this)},x.prototype.setAttributeNodeNS=function(m){return p.element_setAnAttribute(m,this)},x.prototype.removeAttributeNode=function(m){for(var v=!1,w=0;w<this._attributeList.length;w++)if(this._attributeList[w]===m){v=!0;break}if(!v)throw new u.NotFoundError;return p.element_remove(m,this),m},x.prototype.attachShadow=function(m){if(this._namespace!==h.namespace.HTML)throw new u.NotSupportedError;if(!p.customElement_isValidCustomElementName(this._localName)&&!p.customElement_isValidShadowHostName(this._localName))throw new u.NotSupportedError;if(p.customElement_isValidCustomElementName(this._localName)||this._is!==null){var v=p.customElement_lookUpACustomElementDefinition(this._nodeDocument,this._namespace,this._localName,this._is);if(v!==null&&v.disableShadow===!0)throw new u.NotSupportedError}if(this._shadowRoot!==null)throw new u.NotSupportedError;var w=p.create_shadowRoot(this._nodeDocument,this);return w._mode=m.mode,this._shadowRoot=w,w},Object.defineProperty(x.prototype,"shadowRoot",{get:function(){var m=this._shadowRoot;return m===null||m.mode==="closed"?null:m},enumerable:!0,configurable:!0}),x.prototype.closest=function(m){throw new u.NotImplementedError},x.prototype.matches=function(m){throw new u.NotImplementedError},x.prototype.webkitMatchesSelector=function(m){return this.matches(m)},x.prototype.getElementsByTagName=function(m){return p.node_listOfElementsWithQualifiedName(m,this)},x.prototype.getElementsByTagNameNS=function(m,v){return p.node_listOfElementsWithNamespace(m,v,this)},x.prototype.getElementsByClassName=function(m){return p.node_listOfElementsWithClassNames(m,this)},x.prototype.insertAdjacentElement=function(m,v){return p.element_insertAdjacent(this,m,v)},x.prototype.insertAdjacentText=function(m,v){var w=p.create_text(this._nodeDocument,v);p.element_insertAdjacent(this,m,w)},Object.defineProperty(x.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"_htmlUppercasedQualifiedName",{get:function(){var m=this._qualifiedName;return this._namespace===h.namespace.HTML&&this._nodeDocument._type==="html"&&(m=m.toUpperCase()),m},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),x.prototype.prepend=function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];throw new Error("Mixin: ParentNode not implemented.")},x.prototype.append=function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];throw new Error("Mixin: ParentNode not implemented.")},x.prototype.querySelector=function(m){throw new Error("Mixin: ParentNode not implemented.")},x.prototype.querySelectorAll=function(m){throw new Error("Mixin: ParentNode not implemented.")},Object.defineProperty(x.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),x.prototype.before=function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];throw new Error("Mixin: ChildNode not implemented.")},x.prototype.after=function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];throw new Error("Mixin: ChildNode not implemented.")},x.prototype.replaceWith=function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];throw new Error("Mixin: ChildNode not implemented.")},x.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},Object.defineProperty(x.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),x._create=function(m,v,w,C){w===void 0&&(w=null),C===void 0&&(C=null);var T=new x;return T._localName=v,T._namespace=w,T._namespacePrefix=C,T._nodeDocument=m,T},x}(f.NodeImpl);r.ElementImpl=g,d.idl_defineConst(g.prototype,"_nodeType",l.NodeType.Element)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(34),l=i(12),f=function(u){function h(p){p===void 0&&(p=null);var d=u.call(this)||this;return d._children=new Set,d._host=p,d}return o(h,u),h.prototype.getElementById=function(p){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(h.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),h.prototype.prepend=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];throw new Error("Mixin: ParentNode not implemented.")},h.prototype.append=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];throw new Error("Mixin: ParentNode not implemented.")},h.prototype.querySelector=function(p){throw new Error("Mixin: ParentNode not implemented.")},h.prototype.querySelectorAll=function(p){throw new Error("Mixin: ParentNode not implemented.")},h._create=function(p,d){d===void 0&&(d=null);var g=new h(d);return g._nodeDocument=p,g},h}(c.NodeImpl);r.DocumentFragmentImpl=f,l.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentFragment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(p,d){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,y){g.__proto__=y}||function(g,y){for(var x in y)y.hasOwnProperty(x)&&(g[x]=y[x])})(p,d)},function(p,d){function g(){this.constructor=p}a(p,d),p.prototype=d===null?Object.create(d):(g.prototype=d.prototype,new g)}),s=this&&this.__values||function(p){var d=typeof Symbol=="function"&&Symbol.iterator,g=d&&p[d],y=0;if(g)return g.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(2),l=i(71),f=i(0),u=i(12),h=function(p){function d(g){g===void 0&&(g="");var y=p.call(this,g)||this;return y._name="",y._assignedSlot=null,y}return o(d,p),Object.defineProperty(d.prototype,"wholeText",{get:function(){var g,y,x="";try{for(var m=s(f.text_contiguousTextNodes(this,!0)),v=m.next();!v.done;v=m.next())x+=v.value._data}catch(w){g={error:w}}finally{try{v&&!v.done&&(y=m.return)&&y.call(m)}finally{if(g)throw g.error}}return x},enumerable:!0,configurable:!0}),d.prototype.splitText=function(g){return f.text_split(this,g)},Object.defineProperty(d.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),d._create=function(g,y){y===void 0&&(y="");var x=new d(y);return x._nodeDocument=g,x},d}(l.CharacterDataImpl);r.TextImpl=h,u.idl_defineConst(h.prototype,"_nodeType",c.NodeType.Text)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(){}return Object.defineProperty(o.prototype,"_startNode",{get:function(){return this._start[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_startOffset",{get:function(){return this._start[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endNode",{get:function(){return this._end[0]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_endOffset",{get:function(){return this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"_collapsed",{get:function(){return this._start[0]===this._end[0]&&this._start[1]===this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startContainer",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endContainer",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"endOffset",{get:function(){return this._endOffset},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"collapsed",{get:function(){return this._collapsed},enumerable:!0,configurable:!0}),o}();r.AbstractRangeImpl=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=function(){function s(c){this._activeFlag=!1,this._root=c,this._whatToShow=a.WhatToShow.All,this._filter=null}return Object.defineProperty(s.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"whatToShow",{get:function(){return this._whatToShow},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),s}();r.TraverserImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(0),s=i(12),c=function(){function l(f,u){this._target=null,this._relatedTarget=null,this._touchTargetList=[],this._path=[],this._currentTarget=null,this._eventPhase=a.EventPhase.None,this._stopPropagationFlag=!1,this._stopImmediatePropagationFlag=!1,this._canceledFlag=!1,this._inPassiveListenerFlag=!1,this._composedFlag=!1,this._initializedFlag=!1,this._dispatchFlag=!1,this._isTrusted=!1,this._bubbles=!1,this._cancelable=!1,this._type=f,u&&(this._bubbles=u.bubbles||!1,this._cancelable=u.cancelable||!1,this._composedFlag=u.composed||!1),this._initializedFlag=!0,this._timeStamp=new Date().getTime()}return Object.defineProperty(l.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"srcElement",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"currentTarget",{get:function(){return this._currentTarget},enumerable:!0,configurable:!0}),l.prototype.composedPath=function(){var f=[],u=this._path;if(u.length===0)return f;var h=this._currentTarget;if(h===null)throw new Error("Event currentTarget is null.");f.push(h);for(var p=0,d=0,g=u.length-1;g>=0;){if(u[g].rootOfClosedTree&&d++,u[g].invocationTarget===h){p=g;break}u[g].slotInClosedTree&&d--,g--}var y=d,x=d;for(g=p-1;g>=0;)u[g].rootOfClosedTree&&y++,y<=x&&f.unshift(u[g].invocationTarget),u[g].slotInClosedTree&&--y<x&&(x=y),g--;for(y=d,x=d,g=p+1;g<u.length;)u[g].slotInClosedTree&&y++,y<=x&&f.push(u[g].invocationTarget),u[g].rootOfClosedTree&&--y<x&&(x=y),g++;return f},Object.defineProperty(l.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0}),l.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(l.prototype,"cancelBubble",{get:function(){return this._stopPropagationFlag},set:function(f){f&&this.stopPropagation()},enumerable:!0,configurable:!0}),l.prototype.stopImmediatePropagation=function(){this._stopPropagationFlag=!0,this._stopImmediatePropagationFlag=!0},Object.defineProperty(l.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"returnValue",{get:function(){return!this._canceledFlag},set:function(f){f||o.event_setTheCanceledFlag(this)},enumerable:!0,configurable:!0}),l.prototype.preventDefault=function(){o.event_setTheCanceledFlag(this)},Object.defineProperty(l.prototype,"defaultPrevented",{get:function(){return this._canceledFlag},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"composed",{get:function(){return this._composedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isTrusted",{get:function(){return this._isTrusted},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeStamp",{get:function(){return this._timeStamp},enumerable:!0,configurable:!0}),l.prototype.initEvent=function(f,u,h){u===void 0&&(u=!1),h===void 0&&(h=!1),this._dispatchFlag||o.event_initialize(this,f,u,h)},l.NONE=0,l.CAPTURING_PHASE=1,l.AT_TARGET=2,l.BUBBLING_PHASE=3,l}();r.EventImpl=c,s.idl_defineConst(c.prototype,"NONE",0),s.idl_defineConst(c.prototype,"CAPTURING_PHASE",1),s.idl_defineConst(c.prototype,"AT_TARGET",2),s.idl_defineConst(c.prototype,"BUBBLING_PHASE",3)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(9);r.traversal_filter=function(s,c){if(s._activeFlag)throw new o.InvalidStateError;var l=1<<c._nodeType-1;if((s.whatToShow&l)==0)return a.FilterResult.Skip;if(!s.filter)return a.FilterResult.Accept;s._activeFlag=!0;var f=a.FilterResult.Reject;try{f=s.filter.acceptNode(c)}catch(u){throw s._activeFlag=!1,u}return s._activeFlag=!1,f}},function(n,r,i){var a=this&&this.__read||function(x,m){var v=typeof Symbol=="function"&&x[Symbol.iterator];if(!v)return x;var w,C,T=v.call(x),_=[];try{for(;(m===void 0||m-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(S){C={error:S}}finally{try{w&&!w.done&&(v=T.return)&&v.call(T)}finally{if(C)throw C.error}}return _},o=this&&this.__values||function(x){var m=typeof Symbol=="function"&&Symbol.iterator,v=m&&x[m],w=0;if(v)return v.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&w>=x.length&&(x=void 0),{value:x&&x[w++],done:!x}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),c=i(3),l=i(1),f=i(99),u=i(73),h=i(17),p=i(173),d=i(30),g=i(52),y=i(37);r.document_elementInterface=function(x,m){return f.ElementImpl},r.document_internalCreateElementNS=function(x,m,v,w){var C=a(p.namespace_validateAndExtract(m,v),3),T=C[0],_=C[1],S=C[2],b=null;return w!==void 0&&(b=l.isString(w)?w:w.is),g.element_createAnElement(x,S,T,_,b,!0)},r.document_adopt=function(x,m){var v,w;if(x._nodeDocument!==m||x._parent!==null){var C=x._nodeDocument;if(x._parent&&y.mutation_remove(x,x._parent),m!==C)for(var T=h.tree_getFirstDescendantNode(x,!0,!0);T!==null;){if(T._nodeDocument=m,c.Guard.isElementNode(T))try{for(var _=(v=void 0,o(T._attributeList._asArray())),S=_.next();!S.done;S=_.next())S.value._nodeDocument=m}catch(b){v={error:b}}finally{try{S&&!S.done&&(w=_.return)&&w.call(_)}finally{if(v)throw v.error}}s.dom.features.customElements&&c.Guard.isElementNode(T)&&T._customElementState==="custom"&&u.customElement_enqueueACustomElementCallbackReaction(T,"adoptedCallback",[C,m]),s.dom.features.steps&&d.dom_runAdoptingSteps(T,C),T=h.tree_getNextDescendantNode(x,T,!0,!0)}}}},function(n,r,i){var a=this&&this.__values||function(h){var p=typeof Symbol=="function"&&Symbol.iterator,d=p&&h[p],g=0;if(d)return d.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&g>=h.length&&(h=void 0),{value:h&&h[g++],done:!h}}};throw new TypeError(p?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),c=i(9),l=i(17),f=i(51),u=i(30);r.characterData_replaceData=function(h,p,d,g){var y,x,m=l.tree_nodeLength(h);if(p>m)throw new c.IndexSizeError("Offset exceeds character data length. Offset: "+p+", Length: "+m+", Node is "+h.nodeName+".");p+d>m&&(d=m-p),o.dom.features.mutationObservers&&f.observer_queueMutationRecord("characterData",h,null,null,h._data,[],[],null,null);var v=h._data.substring(0,p)+g+h._data.substring(p+d);h._data=v;try{for(var w=a(o.dom.rangeList),C=w.next();!C.done;C=w.next()){var T=C.value;T._start[0]===h&&T._start[1]>p&&T._start[1]<=p+d&&(T._start[1]=p),T._end[0]===h&&T._end[1]>p&&T._end[1]<=p+d&&(T._end[1]=p),T._start[0]===h&&T._start[1]>p+d&&(T._start[1]+=g.length-d),T._end[0]===h&&T._end[1]>p+d&&(T._end[1]+=g.length-d)}}catch(_){y={error:_}}finally{try{C&&!C.done&&(x=w.return)&&x.call(w)}finally{if(y)throw y.error}}o.dom.features.steps&&s.Guard.isTextNode(h)&&h._parent!==null&&u.dom_runChildTextContentChangeSteps(h._parent)},r.characterData_substringData=function(h,p,d){var g=l.tree_nodeLength(h);if(p>g)throw new c.IndexSizeError("Offset exceeds character data length. Offset: "+p+", Length: "+g+", Node is "+h.nodeName+".");return p+d>g?h._data.substr(p):h._data.substr(p,d)}},function(n,r,i){var a=this&&this.__read||function(u,h){var p=typeof Symbol=="function"&&u[Symbol.iterator];if(!p)return u;var d,g,y=p.call(u),x=[];try{for(;(h===void 0||h-- >0)&&!(d=y.next()).done;)x.push(d.value)}catch(m){g={error:m}}finally{try{d&&!d.done&&(p=y.return)&&p.call(y)}finally{if(g)throw g.error}}return x},o=this&&this.__spread||function(){for(var u=[],h=0;h<arguments.length;h++)u=u.concat(a(arguments[h]));return u},s=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(7);function l(u){var h=c.string.splitAStringOnASCIIWhitespace(u);return new Set(h)}function f(u){return o(u).join(" ")}r.orderedSet_parse=l,r.orderedSet_serialize=f,r.orderedSet_sanitize=function(u){return f(l(u))},r.orderedSet_contains=function(u,h,p){var d,g,y,x;try{for(var m=s(h),v=m.next();!v.done;v=m.next()){var w=v.value,C=!1;try{for(var T=(y=void 0,s(u)),_=T.next();!_.done;_=T.next()){var S=_.value;if(p){if(S===w){C=!0;break}}else if(S.toUpperCase()===w.toUpperCase()){C=!0;break}}}catch(b){y={error:b}}finally{try{_&&!_.done&&(x=T.return)&&x.call(T)}finally{if(y)throw y.error}}if(!C)return!1}}catch(b){d={error:b}}finally{try{v&&!v.done&&(g=m.return)&&g.call(m)}finally{if(d)throw d.error}}return!0}},function(n,r,i){i(179),Object.defineProperty(r,"__esModule",{value:!0});var a=i(262),o=i(110),s=i(1);o.dom.setFeatures(!1),r.createDocument=function(){var c=new a.DOMImplementation().createDocument(null,"root",null);return c.documentElement&&c.removeChild(c.documentElement),c},r.sanitizeInput=function(c,l){if(c==null)return c;if(l===void 0)return c+"";var f="";c+="";for(var u=0;u<c.length;u++){var h=c.charCodeAt(u);if(h===9||h===10||h===13||h>=32&&h<=55295||h>=57344&&h<=65533)f+=c.charAt(u);else if(h>=55296&&h<=56319&&u<c.length-1){var p=c.charCodeAt(u+1);p>=56320&&p<=57343?(h=1024*(h-55296)+p-56320+65536,f+=String.fromCodePoint(h),u++):f+=s.isString(l)?l:l(c.charAt(u),u,c)}else f+=s.isString(l)?l:l(c.charAt(u),u,c)}return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(1),o=i(153);r.AbortController=o.AbortControllerImpl;var s=i(154);r.AbortSignal=s.AbortSignalImpl;var c=i(102);r.AbstractRange=c.AbstractRangeImpl;var l=i(157);r.Attr=l.AttrImpl;var f=i(158);r.CDATASection=f.CDATASectionImpl;var u=i(71);r.CharacterData=u.CharacterDataImpl;var h=i(263),p=i(159);r.Comment=p.CommentImpl;var d=i(171);r.CustomEvent=d.CustomEventImpl;var g=i(100);r.DocumentFragment=g.DocumentFragmentImpl;var y=i(98);r.Document=y.DocumentImpl;var x=i(264),m=i(155);r.DocumentType=m.DocumentTypeImpl;var v=i(6);r.dom=v.dom;var w=i(148);r.DOMImplementation=w.DOMImplementationImpl;var C=i(170);r.DOMTokenList=C.DOMTokenListImpl;var T=i(99);r.Element=T.ElementImpl;var _=i(104);r.Event=_.EventImpl;var S=i(70);r.EventTarget=S.EventTargetImpl;var b=i(161);r.HTMLCollection=b.HTMLCollectionImpl;var D=i(265);r.MutationObserver=D.MutationObserverImpl;var E=i(169);r.MutationRecord=E.MutationRecordImpl;var R=i(164);r.NamedNodeMap=R.NamedNodeMapImpl;var F=i(168);r.NodeFilter=F.NodeFilterImpl;var M=i(34);r.Node=M.NodeImpl;var U=i(166);r.NodeIterator=U.NodeIteratorImpl;var z=i(162);r.NodeList=z.NodeListImpl;var Y=i(163);r.NodeListStatic=Y.NodeListStaticImpl;var W=i(266),B=i(267),j=i(268),ie=i(160);r.ProcessingInstruction=ie.ProcessingInstructionImpl;var ae=i(165);r.Range=ae.RangeImpl;var fe=i(156);r.ShadowRoot=fe.ShadowRootImpl;var Ee=i(269),ge=i(270);r.StaticRange=ge.StaticRangeImpl;var be=i(101);r.Text=be.TextImpl;var Re=i(103);r.Traverser=Re.TraverserImpl;var Ne=i(167);r.TreeWalker=Ne.TreeWalkerImpl;var Ce=i(149);r.Window=Ce.WindowImpl;var P=i(151);r.XMLDocument=P.XMLDocumentImpl,a.applyMixin(T.ElementImpl,h.ChildNodeImpl),a.applyMixin(u.CharacterDataImpl,h.ChildNodeImpl),a.applyMixin(m.DocumentTypeImpl,h.ChildNodeImpl),a.applyMixin(y.DocumentImpl,x.DocumentOrShadowRootImpl),a.applyMixin(fe.ShadowRootImpl,x.DocumentOrShadowRootImpl),a.applyMixin(T.ElementImpl,W.NonDocumentTypeChildNodeImpl),a.applyMixin(u.CharacterDataImpl,W.NonDocumentTypeChildNodeImpl),a.applyMixin(y.DocumentImpl,B.NonElementParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,B.NonElementParentNodeImpl),a.applyMixin(y.DocumentImpl,j.ParentNodeImpl),a.applyMixin(g.DocumentFragmentImpl,j.ParentNodeImpl),a.applyMixin(T.ElementImpl,j.ParentNodeImpl),a.applyMixin(be.TextImpl,Ee.SlotableImpl),a.applyMixin(T.ElementImpl,Ee.SlotableImpl)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),function(a){a[a.EOF=0]="EOF",a[a.Declaration=1]="Declaration",a[a.DocType=2]="DocType",a[a.Element=3]="Element",a[a.Text=4]="Text",a[a.CDATA=5]="CDATA",a[a.PI=6]="PI",a[a.Comment=7]="Comment",a[a.ClosingTag=8]="ClosingTag"}(r.TokenType||(r.TokenType={}))},function(n,r,i){i(64),i(20),i(66);var a,o=this&&this.__extends||(a=function(l,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var p in h)h.hasOwnProperty(p)&&(u[p]=h[p])})(l,f)},function(l,f){function u(){this.constructor=l}a(l,f),l.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),c=function(l){function f(){return l!==null&&l.apply(this,arguments)||this}return o(f,l),f.prototype._parse=function(u,h){var p=this,d=this._builderOptions,g=null;return s.isFunction(h)?g=this.parse(u,h.apply(this)):s.isArray(h)||s.isSet(h)?s.forEachArray(h,function(y){return g=p.parse(u,y)},this):s.isMap(h)||s.isObject(h)?s.forEachObject(h,function(y,x){if(s.isFunction(x)&&(x=x.apply(p)),d.ignoreConverters||y.indexOf(d.convert.att)!==0)if(d.ignoreConverters||y.indexOf(d.convert.text)!==0)if(d.ignoreConverters||y.indexOf(d.convert.cdata)!==0)if(d.ignoreConverters||y.indexOf(d.convert.comment)!==0)if(d.ignoreConverters||y.indexOf(d.convert.ins)!==0){if(!((s.isArray(x)||s.isSet(x))&&s.isEmpty(x))){if((s.isMap(x)||s.isObject(x))&&s.isEmpty(x))g=p.element(u,void 0,p.sanitize(y))||g;else if(d.keepNullNodes||x!=null)if(s.isArray(x)||s.isSet(x))s.forEachArray(x,function(T){var _={};_[y]=T,g=p.parse(u,_)},p);else if(s.isMap(x)||s.isObject(x))(m=p.element(u,void 0,p.sanitize(y)))&&(g=m,p.parse(m,x));else if(x!=null&&x!==""){var m;(m=p.element(u,void 0,p.sanitize(y)))&&(g=m,p.text(m,p._decodeText(p.sanitize(x))))}else g=p.element(u,void 0,p.sanitize(y))||g}}else if(s.isString(x)){var v=x.indexOf(" "),w=v===-1?x:x.substr(0,v),C=v===-1?"":x.substr(v+1);g=p.instruction(u,p.sanitize(w),p.sanitize(C))||g}else s.isArray(x)||s.isSet(x)?s.forEachArray(x,function(T){var _=T.indexOf(" "),S=_===-1?T:T.substr(0,_),b=_===-1?"":T.substr(_+1);g=p.instruction(u,p.sanitize(S),p.sanitize(b))||g},p):s.forEachObject(x,function(T,_){return g=p.instruction(u,p.sanitize(T),p.sanitize(_))||g},p);else s.isArray(x)||s.isSet(x)?s.forEachArray(x,function(T){return g=p.comment(u,p.sanitize(T))||g},p):g=p.comment(u,p.sanitize(x))||g;else s.isArray(x)||s.isSet(x)?s.forEachArray(x,function(T){return g=p.cdata(u,p.sanitize(T))||g},p):g=p.cdata(u,p.sanitize(x))||g;else g=s.isMap(x)||s.isObject(x)?p.parse(u,x):p.text(u,p._decodeText(p.sanitize(x)))||g;else if(y===d.convert.att){if(s.isArray(x)||s.isSet(x))throw new Error("Invalid attribute: "+x.toString()+". "+u._debugInfo());s.forEachObject(x,function(T,_){g=p.attribute(u,void 0,p.sanitize(T),p._decodeAttributeValue(p.sanitize(_)))||g})}else g=p.attribute(u,void 0,p.sanitize(y.substr(d.convert.att.length)),p._decodeAttributeValue(p.sanitize(x)))||g},this):(d.keepNullNodes||h!=null)&&(g=this.text(u,this._decodeText(this.sanitize(h)))||g),g||u},f}(i(75).BaseReader);r.ObjectReader=c},function(n,r,i){var a=i(39);n.exports=new a({explicit:[i(286),i(287),i(288)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(o){this.level=0,this._builderOptions=o,this._writerOptions=o};r.BaseCBWriter=a},function(n,r,i){var a=i(16),o=i(8),s=i(116);n.exports=!a&&!o(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7})},function(n,r,i){var a=i(11),o=i(13),s=a.document,c=o(s)&&o(s.createElement);n.exports=function(l){return c?s.createElement(l):{}}},function(n,r,i){var a=i(118),o=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(s){return o.call(s)}),n.exports=a.inspectSource},function(n,r,i){var a=i(11),o=i(80),s=a["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=s},function(n,r,i){var a=i(14),o=i(187),s=i(55),c=i(15);n.exports=function(l,f){for(var u=o(f),h=c.f,p=s.f,d=0;d<u.length;d++){var g=u[d];a(l,g)||h(l,g,p(f,g))}}},function(n,r,i){var a=i(11);n.exports=a},function(n,r,i){var a=i(14),o=i(24),s=i(122).indexOf,c=i(45);n.exports=function(l,f){var u,h=o(l),p=0,d=[];for(u in h)!a(c,u)&&a(h,u)&&d.push(u);for(;f.length>p;)a(h,u=f[p++])&&(~s(d,u)||d.push(u));return d}},function(n,r,i){var a=i(24),o=i(26),s=i(83),c=function(l){return function(f,u,h){var p,d=a(f),g=o(d.length),y=s(h,g);if(l&&u!=u){for(;g>y;)if((p=d[y++])!=p)return!0}else for(;g>y;y++)if((l||y in d)&&d[y]===u)return l||y||0;return!l&&-1}};n.exports={includes:c(!0),indexOf:c(!1)}},function(n,r,i){var a=i(8),o=/#|\.prototype\./,s=function(h,p){var d=l[c(h)];return d==u||d!=f&&(typeof p=="function"?a(p):!!p)},c=s.normalize=function(h){return String(h).replace(o,".").toLowerCase()},l=s.data={},f=s.NATIVE="N",u=s.POLYFILL="P";n.exports=s},function(n,r,i){var a=i(86);n.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(n,r,i){var a=i(5);r.f=a},function(n,r,i){var a=i(120),o=i(14),s=i(125),c=i(15).f;n.exports=function(l){var f=a.Symbol||(a.Symbol={});o(f,l)||c(f,l,{value:s.f(l)})}},function(n,r){n.exports=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i}},function(n,r,i){var a=i(13),o=i(59),s=i(5)("species");n.exports=function(c,l){var f;return o(c)&&(typeof(f=c.constructor)!="function"||f!==Array&&!o(f.prototype)?a(f)&&(f=f[s])===null&&(f=void 0):f=void 0),new(f===void 0?Array:f)(l===0?0:l)}},function(n,r,i){var a,o,s=i(11),c=i(193),l=s.process,f=l&&l.versions,u=f&&f.v8;u?o=(a=u.split("."))[0]+a[1]:c&&(!(a=c.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=c.match(/Chrome\/(\d+)/))&&(o=a[1]),n.exports=o&&+o},function(n,r,i){var a=i(5),o=i(60),s=i(15),c=a("unscopables"),l=Array.prototype;l[c]==null&&s.f(l,c,{configurable:!0,value:o(null)}),n.exports=function(f){l[c][f]=!0}},function(n,r,i){var a,o,s,c=i(132),l=i(21),f=i(14),u=i(5),h=i(44),p=u("iterator"),d=!1;[].keys&&("next"in(s=[].keys())?(o=c(c(s)))!==Object.prototype&&(a=o):d=!0),a==null&&(a={}),h||f(a,p)||l(a,p,function(){return this}),n.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:d}},function(n,r,i){var a=i(14),o=i(27),s=i(57),c=i(196),l=s("IE_PROTO"),f=Object.prototype;n.exports=c?Object.getPrototypeOf:function(u){return u=o(u),a(u,l)?u[l]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?f:null}},function(n,r,i){var a=i(18),o=i(197);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var s,c=!1,l={};try{(s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(l,[]),c=l instanceof Array}catch{}return function(f,u){return a(f),o(u),c?s.call(f,u):f.__proto__=u,f}}():void 0)},function(n,r,i){var a=i(56),o=i(15),s=i(40);n.exports=function(c,l,f){var u=a(l);u in c?o.f(c,u,s(0,f)):c[u]=f}},function(n,r,i){var a=i(90),o=i(42),s=i(5)("toStringTag"),c=o(function(){return arguments}())=="Arguments";n.exports=a?o:function(l){var f,u,h;return l===void 0?"Undefined":l===null?"Null":typeof(u=function(p,d){try{return p[d]}catch{}}(f=Object(l),s))=="string"?u:c?o(f):(h=o(f))=="Object"&&typeof f.callee=="function"?"Arguments":h}},function(n,r,i){var a=i(18);n.exports=function(){var o=a(this),s="";return o.global&&(s+="g"),o.ignoreCase&&(s+="i"),o.multiline&&(s+="m"),o.dotAll&&(s+="s"),o.unicode&&(s+="u"),o.sticky&&(s+="y"),s}},function(n,r,i){var a=i(47),o=i(35),s=function(c){return function(l,f){var u,h,p=String(o(l)),d=a(f),g=p.length;return d<0||d>=g?c?"":void 0:(u=p.charCodeAt(d))<55296||u>56319||d+1===g||(h=p.charCodeAt(d+1))<56320||h>57343?c?p.charAt(d):u:c?p.slice(d,d+2):h-56320+(u-55296<<10)+65536}};n.exports={codeAt:s(!1),charAt:s(!0)}},function(n,r,i){var a=i(4),o=i(27),s=i(61);a({target:"Object",stat:!0,forced:i(8)(function(){s(1)})},{keys:function(c){return s(o(c))}})},function(n,r,i){var a=i(4),o=i(11),s=i(123),c=i(25),l=i(140),f=i(141),u=i(142),h=i(13),p=i(8),d=i(208),g=i(62),y=i(209);n.exports=function(x,m,v){var w=x.indexOf("Map")!==-1,C=x.indexOf("Weak")!==-1,T=w?"set":"add",_=o[x],S=_&&_.prototype,b=_,D={},E=function(Y){var W=S[Y];c(S,Y,Y=="add"?function(B){return W.call(this,B===0?0:B),this}:Y=="delete"?function(B){return!(C&&!h(B))&&W.call(this,B===0?0:B)}:Y=="get"?function(B){return C&&!h(B)?void 0:W.call(this,B===0?0:B)}:Y=="has"?function(B){return!(C&&!h(B))&&W.call(this,B===0?0:B)}:function(B,j){return W.call(this,B===0?0:B,j),this})};if(s(x,typeof _!="function"||!(C||S.forEach&&!p(function(){new _().entries().next()}))))b=v.getConstructor(m,x,w,T),l.REQUIRED=!0;else if(s(x,!0)){var R=new b,F=R[T](C?{}:-0,1)!=R,M=p(function(){R.has(1)}),U=d(function(Y){new _(Y)}),z=!C&&p(function(){for(var Y=new _,W=5;W--;)Y[T](W,W);return!Y.has(-0)});U||((b=m(function(Y,W){u(Y,b,x);var B=y(new _,Y,b);return W!=null&&f(W,B[T],B,w),B})).prototype=S,S.constructor=b),(M||z)&&(E("delete"),E("has"),w&&E("get")),(z||F)&&E(T),C&&S.clear&&delete S.clear}return D[x]=b,a({global:!0,forced:b!=_},D),g(b,x),C||v.setStrong(b,x,w),b}},function(n,r,i){var a=i(45),o=i(13),s=i(14),c=i(15).f,l=i(58),f=i(204),u=l("meta"),h=0,p=Object.isExtensible||function(){return!0},d=function(y){c(y,u,{value:{objectID:"O"+ ++h,weakData:{}}})},g=n.exports={REQUIRED:!1,fastKey:function(y,x){if(!o(y))return typeof y=="symbol"?y:(typeof y=="string"?"S":"P")+y;if(!s(y,u)){if(!p(y))return"F";if(!x)return"E";d(y)}return y[u].objectID},getWeakData:function(y,x){if(!s(y,u)){if(!p(y))return!0;if(!x)return!1;d(y)}return y[u].weakData},onFreeze:function(y){return f&&g.REQUIRED&&p(y)&&!s(y,u)&&d(y),y}};a[u]=!0},function(n,r,i){var a=i(18),o=i(205),s=i(26),c=i(87),l=i(206),f=i(207),u=function(h,p){this.stopped=h,this.result=p};(n.exports=function(h,p,d,g,y){var x,m,v,w,C,T,_,S=c(p,d,g?2:1);if(y)x=h;else{if(typeof(m=l(h))!="function")throw TypeError("Target is not iterable");if(o(m)){for(v=0,w=s(h.length);w>v;v++)if((C=g?S(a(_=h[v])[0],_[1]):S(h[v]))&&C instanceof u)return C;return new u(!1)}x=m.call(h)}for(T=x.next;!(_=T.call(x)).done;)if(typeof(C=f(x,S,_.value,g))=="object"&&C&&C instanceof u)return C;return new u(!1)}).stop=function(h){return new u(!0,h)}},function(n,r){n.exports=function(i,a,o){if(!(i instanceof a))throw TypeError("Incorrect "+(o?o+" ":"")+"invocation");return i}},function(n,r,i){var a=i(15).f,o=i(60),s=i(210),c=i(87),l=i(142),f=i(141),u=i(88),h=i(211),p=i(16),d=i(140).fastKey,g=i(43),y=g.set,x=g.getterFor;n.exports={getConstructor:function(m,v,w,C){var T=m(function(D,E){l(D,T,v),y(D,{type:v,index:o(null),first:void 0,last:void 0,size:0}),p||(D.size=0),E!=null&&f(E,D[C],D,w)}),_=x(v),S=function(D,E,R){var F,M,U=_(D),z=b(D,E);return z?z.value=R:(U.last=z={index:M=d(E,!0),key:E,value:R,previous:F=U.last,next:void 0,removed:!1},U.first||(U.first=z),F&&(F.next=z),p?U.size++:D.size++,M!=="F"&&(U.index[M]=z)),D},b=function(D,E){var R,F=_(D),M=d(E);if(M!=="F")return F.index[M];for(R=F.first;R;R=R.next)if(R.key==E)return R};return s(T.prototype,{clear:function(){for(var D=_(this),E=D.index,R=D.first;R;)R.removed=!0,R.previous&&(R.previous=R.previous.next=void 0),delete E[R.index],R=R.next;D.first=D.last=void 0,p?D.size=0:this.size=0},delete:function(D){var E=_(this),R=b(this,D);if(R){var F=R.next,M=R.previous;delete E.index[R.index],R.removed=!0,M&&(M.next=F),F&&(F.previous=M),E.first==R&&(E.first=F),E.last==R&&(E.last=M),p?E.size--:this.size--}return!!R},forEach:function(D){for(var E,R=_(this),F=c(D,arguments.length>1?arguments[1]:void 0,3);E=E?E.next:R.first;)for(F(E.value,E.key,this);E&&E.removed;)E=E.previous},has:function(D){return!!b(this,D)}}),s(T.prototype,w?{get:function(D){var E=b(this,D);return E&&E.value},set:function(D,E){return S(this,D===0?0:D,E)}}:{add:function(D){return S(this,D=D===0?0:D,D)}}),p&&a(T.prototype,"size",{get:function(){return _(this).size}}),T},setStrong:function(m,v,w){var C=v+" Iterator",T=x(v),_=x(C);u(m,v,function(S,b){y(this,{type:C,target:S,state:T(S),kind:b,last:void 0})},function(){for(var S=_(this),b=S.kind,D=S.last;D&&D.removed;)D=D.previous;return S.target&&(S.last=D=D?D.next:S.state.first)?b=="keys"?{value:D.key,done:!1}:b=="values"?{value:D.value,done:!1}:{value:[D.key,D.value],done:!1}:(S.target=void 0,{value:void 0,done:!0})},w?"entries":"values",!w,!0),h(v)}}},function(n,r,i){var a,o=i(4),s=i(55).f,c=i(26),l=i(222),f=i(35),u=i(224),h=i(44),p="".endsWith,d=Math.min,g=u("endsWith");o({target:"String",proto:!0,forced:!!(h||g||(a=s(String.prototype,"endsWith"),!a||a.writable))&&!g},{endsWith:function(y){var x=String(f(this));l(y);var m=arguments.length>1?arguments[1]:void 0,v=c(x.length),w=m===void 0?v:d(c(m),v),C=String(y);return p?p.call(x,C,w):x.slice(w-C.length,w)===C}})},function(n,r,i){(function(a){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var o=i(229),s=i(230),c=i(231);function l(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(P,O){if(l()<O)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(P=new Uint8Array(O)).__proto__=u.prototype:(P===null&&(P=new u(O)),P.length=O),P}function u(P,O,A){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(P,O,A);if(typeof P=="number"){if(typeof O=="string")throw new Error("If encoding is specified then the first argument must be a string");return d(this,P)}return h(this,P,O,A)}function h(P,O,A,L){if(typeof O=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&O instanceof ArrayBuffer?function(k,$,H,se){if($.byteLength,H<0||$.byteLength<H)throw new RangeError("'offset' is out of bounds");if($.byteLength<H+(se||0))throw new RangeError("'length' is out of bounds");return $=H===void 0&&se===void 0?new Uint8Array($):se===void 0?new Uint8Array($,H):new Uint8Array($,H,se),u.TYPED_ARRAY_SUPPORT?(k=$).__proto__=u.prototype:k=g(k,$),k}(P,O,A,L):typeof O=="string"?function(k,$,H){if(typeof H=="string"&&H!==""||(H="utf8"),!u.isEncoding(H))throw new TypeError('"encoding" must be a valid string encoding');var se=0|x($,H),me=(k=f(k,se)).write($,H);return me!==se&&(k=k.slice(0,me)),k}(P,O,A):function(k,$){if(u.isBuffer($)){var H=0|y($.length);return(k=f(k,H)).length===0||$.copy(k,0,0,H),k}if($){if(typeof ArrayBuffer<"u"&&$.buffer instanceof ArrayBuffer||"length"in $)return typeof $.length!="number"||(se=$.length)!=se?f(k,0):g(k,$);if($.type==="Buffer"&&c($.data))return g(k,$.data)}var se;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(P,O)}function p(P){if(typeof P!="number")throw new TypeError('"size" argument must be a number');if(P<0)throw new RangeError('"size" argument must not be negative')}function d(P,O){if(p(O),P=f(P,O<0?0:0|y(O)),!u.TYPED_ARRAY_SUPPORT)for(var A=0;A<O;++A)P[A]=0;return P}function g(P,O){var A=O.length<0?0:0|y(O.length);P=f(P,A);for(var L=0;L<A;L+=1)P[L]=255&O[L];return P}function y(P){if(P>=l())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l().toString(16)+" bytes");return 0|P}function x(P,O){if(u.isBuffer(P))return P.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(P)||P instanceof ArrayBuffer))return P.byteLength;typeof P!="string"&&(P=""+P);var A=P.length;if(A===0)return 0;for(var L=!1;;)switch(O){case"ascii":case"latin1":case"binary":return A;case"utf8":case"utf-8":case void 0:return Re(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*A;case"hex":return A>>>1;case"base64":return Ne(P).length;default:if(L)return Re(P).length;O=(""+O).toLowerCase(),L=!0}}function m(P,O,A){var L=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((A===void 0||A>this.length)&&(A=this.length),A<=0)||(A>>>=0)<=(O>>>=0))return"";for(P||(P="utf8");;)switch(P){case"hex":return z(this,O,A);case"utf8":case"utf-8":return F(this,O,A);case"ascii":return M(this,O,A);case"latin1":case"binary":return U(this,O,A);case"base64":return R(this,O,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,O,A);default:if(L)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),L=!0}}function v(P,O,A){var L=P[O];P[O]=P[A],P[A]=L}function w(P,O,A,L,k){if(P.length===0)return-1;if(typeof A=="string"?(L=A,A=0):A>2147483647?A=2147483647:A<-2147483648&&(A=-2147483648),A=+A,isNaN(A)&&(A=k?0:P.length-1),A<0&&(A=P.length+A),A>=P.length){if(k)return-1;A=P.length-1}else if(A<0){if(!k)return-1;A=0}if(typeof O=="string"&&(O=u.from(O,L)),u.isBuffer(O))return O.length===0?-1:C(P,O,A,L,k);if(typeof O=="number")return O&=255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(P,O,A):Uint8Array.prototype.lastIndexOf.call(P,O,A):C(P,[O],A,L,k);throw new TypeError("val must be string, number or Buffer")}function C(P,O,A,L,k){var $,H=1,se=P.length,me=O.length;if(L!==void 0&&((L=String(L).toLowerCase())==="ucs2"||L==="ucs-2"||L==="utf16le"||L==="utf-16le")){if(P.length<2||O.length<2)return-1;H=2,se/=2,me/=2,A/=2}function ye(ce,re){return H===1?ce[re]:ce.readUInt16BE(re*H)}if(k){var _e=-1;for($=A;$<se;$++)if(ye(P,$)===ye(O,_e===-1?0:$-_e)){if(_e===-1&&(_e=$),$-_e+1===me)return _e*H}else _e!==-1&&($-=$-_e),_e=-1}else for(A+me>se&&(A=se-me),$=A;$>=0;$--){for(var K=!0,ne=0;ne<me;ne++)if(ye(P,$+ne)!==ye(O,ne)){K=!1;break}if(K)return $}return-1}function T(P,O,A,L){A=Number(A)||0;var k=P.length-A;L?(L=Number(L))>k&&(L=k):L=k;var $=O.length;if($%2!=0)throw new TypeError("Invalid hex string");L>$/2&&(L=$/2);for(var H=0;H<L;++H){var se=parseInt(O.substr(2*H,2),16);if(isNaN(se))return H;P[A+H]=se}return H}function _(P,O,A,L){return Ce(Re(O,P.length-A),P,A,L)}function S(P,O,A,L){return Ce(function(k){for(var $=[],H=0;H<k.length;++H)$.push(255&k.charCodeAt(H));return $}(O),P,A,L)}function b(P,O,A,L){return S(P,O,A,L)}function D(P,O,A,L){return Ce(Ne(O),P,A,L)}function E(P,O,A,L){return Ce(function(k,$){for(var H,se,me,ye=[],_e=0;_e<k.length&&!(($-=2)<0);++_e)H=k.charCodeAt(_e),se=H>>8,me=H%256,ye.push(me),ye.push(se);return ye}(O,P.length-A),P,A,L)}function R(P,O,A){return O===0&&A===P.length?o.fromByteArray(P):o.fromByteArray(P.slice(O,A))}function F(P,O,A){A=Math.min(P.length,A);for(var L=[],k=O;k<A;){var $,H,se,me,ye=P[k],_e=null,K=ye>239?4:ye>223?3:ye>191?2:1;if(k+K<=A)switch(K){case 1:ye<128&&(_e=ye);break;case 2:(192&($=P[k+1]))==128&&(me=(31&ye)<<6|63&$)>127&&(_e=me);break;case 3:$=P[k+1],H=P[k+2],(192&$)==128&&(192&H)==128&&(me=(15&ye)<<12|(63&$)<<6|63&H)>2047&&(me<55296||me>57343)&&(_e=me);break;case 4:$=P[k+1],H=P[k+2],se=P[k+3],(192&$)==128&&(192&H)==128&&(192&se)==128&&(me=(15&ye)<<18|(63&$)<<12|(63&H)<<6|63&se)>65535&&me<1114112&&(_e=me)}_e===null?(_e=65533,K=1):_e>65535&&(_e-=65536,L.push(_e>>>10&1023|55296),_e=56320|1023&_e),L.push(_e),k+=K}return function(ne){var ce=ne.length;if(ce<=4096)return String.fromCharCode.apply(String,ne);for(var re="",ue=0;ue<ce;)re+=String.fromCharCode.apply(String,ne.slice(ue,ue+=4096));return re}(L)}r.Buffer=u,r.SlowBuffer=function(P){return+P!=P&&(P=0),u.alloc(+P)},r.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=a.TYPED_ARRAY_SUPPORT!==void 0?a.TYPED_ARRAY_SUPPORT:function(){try{var P=new Uint8Array(1);return P.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},P.foo()===42&&typeof P.subarray=="function"&&P.subarray(1,1).byteLength===0}catch{return!1}}(),r.kMaxLength=l(),u.poolSize=8192,u._augment=function(P){return P.__proto__=u.prototype,P},u.from=function(P,O,A){return h(null,P,O,A)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(P,O,A){return function(L,k,$,H){return p(k),k<=0?f(L,k):$!==void 0?typeof H=="string"?f(L,k).fill($,H):f(L,k).fill($):f(L,k)}(null,P,O,A)},u.allocUnsafe=function(P){return d(null,P)},u.allocUnsafeSlow=function(P){return d(null,P)},u.isBuffer=function(P){return!(P==null||!P._isBuffer)},u.compare=function(P,O){if(!u.isBuffer(P)||!u.isBuffer(O))throw new TypeError("Arguments must be Buffers");if(P===O)return 0;for(var A=P.length,L=O.length,k=0,$=Math.min(A,L);k<$;++k)if(P[k]!==O[k]){A=P[k],L=O[k];break}return A<L?-1:L<A?1:0},u.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(P,O){if(!c(P))throw new TypeError('"list" argument must be an Array of Buffers');if(P.length===0)return u.alloc(0);var A;if(O===void 0)for(O=0,A=0;A<P.length;++A)O+=P[A].length;var L=u.allocUnsafe(O),k=0;for(A=0;A<P.length;++A){var $=P[A];if(!u.isBuffer($))throw new TypeError('"list" argument must be an Array of Buffers');$.copy(L,k),k+=$.length}return L},u.byteLength=x,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var P=this.length;if(P%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var O=0;O<P;O+=2)v(this,O,O+1);return this},u.prototype.swap32=function(){var P=this.length;if(P%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var O=0;O<P;O+=4)v(this,O,O+3),v(this,O+1,O+2);return this},u.prototype.swap64=function(){var P=this.length;if(P%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var O=0;O<P;O+=8)v(this,O,O+7),v(this,O+1,O+6),v(this,O+2,O+5),v(this,O+3,O+4);return this},u.prototype.toString=function(){var P=0|this.length;return P===0?"":arguments.length===0?F(this,0,P):m.apply(this,arguments)},u.prototype.equals=function(P){if(!u.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P||u.compare(this,P)===0},u.prototype.inspect=function(){var P="",O=r.INSPECT_MAX_BYTES;return this.length>0&&(P=this.toString("hex",0,O).match(/.{2}/g).join(" "),this.length>O&&(P+=" ... ")),"<Buffer "+P+">"},u.prototype.compare=function(P,O,A,L,k){if(!u.isBuffer(P))throw new TypeError("Argument must be a Buffer");if(O===void 0&&(O=0),A===void 0&&(A=P?P.length:0),L===void 0&&(L=0),k===void 0&&(k=this.length),O<0||A>P.length||L<0||k>this.length)throw new RangeError("out of range index");if(L>=k&&O>=A)return 0;if(L>=k)return-1;if(O>=A)return 1;if(this===P)return 0;for(var $=(k>>>=0)-(L>>>=0),H=(A>>>=0)-(O>>>=0),se=Math.min($,H),me=this.slice(L,k),ye=P.slice(O,A),_e=0;_e<se;++_e)if(me[_e]!==ye[_e]){$=me[_e],H=ye[_e];break}return $<H?-1:H<$?1:0},u.prototype.includes=function(P,O,A){return this.indexOf(P,O,A)!==-1},u.prototype.indexOf=function(P,O,A){return w(this,P,O,A,!0)},u.prototype.lastIndexOf=function(P,O,A){return w(this,P,O,A,!1)},u.prototype.write=function(P,O,A,L){if(O===void 0)L="utf8",A=this.length,O=0;else if(A===void 0&&typeof O=="string")L=O,A=this.length,O=0;else{if(!isFinite(O))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");O|=0,isFinite(A)?(A|=0,L===void 0&&(L="utf8")):(L=A,A=void 0)}var k=this.length-O;if((A===void 0||A>k)&&(A=k),P.length>0&&(A<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");for(var $=!1;;)switch(L){case"hex":return T(this,P,O,A);case"utf8":case"utf-8":return _(this,P,O,A);case"ascii":return S(this,P,O,A);case"latin1":case"binary":return b(this,P,O,A);case"base64":return D(this,P,O,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,P,O,A);default:if($)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase(),$=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(P,O,A){var L="";A=Math.min(P.length,A);for(var k=O;k<A;++k)L+=String.fromCharCode(127&P[k]);return L}function U(P,O,A){var L="";A=Math.min(P.length,A);for(var k=O;k<A;++k)L+=String.fromCharCode(P[k]);return L}function z(P,O,A){var L=P.length;(!O||O<0)&&(O=0),(!A||A<0||A>L)&&(A=L);for(var k="",$=O;$<A;++$)k+=be(P[$]);return k}function Y(P,O,A){for(var L=P.slice(O,A),k="",$=0;$<L.length;$+=2)k+=String.fromCharCode(L[$]+256*L[$+1]);return k}function W(P,O,A){if(P%1!=0||P<0)throw new RangeError("offset is not uint");if(P+O>A)throw new RangeError("Trying to access beyond buffer length")}function B(P,O,A,L,k,$){if(!u.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>k||O<$)throw new RangeError('"value" argument is out of bounds');if(A+L>P.length)throw new RangeError("Index out of range")}function j(P,O,A,L){O<0&&(O=65535+O+1);for(var k=0,$=Math.min(P.length-A,2);k<$;++k)P[A+k]=(O&255<<8*(L?k:1-k))>>>8*(L?k:1-k)}function ie(P,O,A,L){O<0&&(O=4294967295+O+1);for(var k=0,$=Math.min(P.length-A,4);k<$;++k)P[A+k]=O>>>8*(L?k:3-k)&255}function ae(P,O,A,L,k,$){if(A+L>P.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("Index out of range")}function fe(P,O,A,L,k){return k||ae(P,0,A,4),s.write(P,O,A,L,23,4),A+4}function Ee(P,O,A,L,k){return k||ae(P,0,A,8),s.write(P,O,A,L,52,8),A+8}u.prototype.slice=function(P,O){var A,L=this.length;if((P=~~P)<0?(P+=L)<0&&(P=0):P>L&&(P=L),(O=O===void 0?L:~~O)<0?(O+=L)<0&&(O=0):O>L&&(O=L),O<P&&(O=P),u.TYPED_ARRAY_SUPPORT)(A=this.subarray(P,O)).__proto__=u.prototype;else{var k=O-P;A=new u(k,void 0);for(var $=0;$<k;++$)A[$]=this[$+P]}return A},u.prototype.readUIntLE=function(P,O,A){P|=0,O|=0,A||W(P,O,this.length);for(var L=this[P],k=1,$=0;++$<O&&(k*=256);)L+=this[P+$]*k;return L},u.prototype.readUIntBE=function(P,O,A){P|=0,O|=0,A||W(P,O,this.length);for(var L=this[P+--O],k=1;O>0&&(k*=256);)L+=this[P+--O]*k;return L},u.prototype.readUInt8=function(P,O){return O||W(P,1,this.length),this[P]},u.prototype.readUInt16LE=function(P,O){return O||W(P,2,this.length),this[P]|this[P+1]<<8},u.prototype.readUInt16BE=function(P,O){return O||W(P,2,this.length),this[P]<<8|this[P+1]},u.prototype.readUInt32LE=function(P,O){return O||W(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+16777216*this[P+3]},u.prototype.readUInt32BE=function(P,O){return O||W(P,4,this.length),16777216*this[P]+(this[P+1]<<16|this[P+2]<<8|this[P+3])},u.prototype.readIntLE=function(P,O,A){P|=0,O|=0,A||W(P,O,this.length);for(var L=this[P],k=1,$=0;++$<O&&(k*=256);)L+=this[P+$]*k;return L>=(k*=128)&&(L-=Math.pow(2,8*O)),L},u.prototype.readIntBE=function(P,O,A){P|=0,O|=0,A||W(P,O,this.length);for(var L=O,k=1,$=this[P+--L];L>0&&(k*=256);)$+=this[P+--L]*k;return $>=(k*=128)&&($-=Math.pow(2,8*O)),$},u.prototype.readInt8=function(P,O){return O||W(P,1,this.length),128&this[P]?-1*(255-this[P]+1):this[P]},u.prototype.readInt16LE=function(P,O){O||W(P,2,this.length);var A=this[P]|this[P+1]<<8;return 32768&A?4294901760|A:A},u.prototype.readInt16BE=function(P,O){O||W(P,2,this.length);var A=this[P+1]|this[P]<<8;return 32768&A?4294901760|A:A},u.prototype.readInt32LE=function(P,O){return O||W(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},u.prototype.readInt32BE=function(P,O){return O||W(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},u.prototype.readFloatLE=function(P,O){return O||W(P,4,this.length),s.read(this,P,!0,23,4)},u.prototype.readFloatBE=function(P,O){return O||W(P,4,this.length),s.read(this,P,!1,23,4)},u.prototype.readDoubleLE=function(P,O){return O||W(P,8,this.length),s.read(this,P,!0,52,8)},u.prototype.readDoubleBE=function(P,O){return O||W(P,8,this.length),s.read(this,P,!1,52,8)},u.prototype.writeUIntLE=function(P,O,A,L){P=+P,O|=0,A|=0,L||B(this,P,O,A,Math.pow(2,8*A)-1,0);var k=1,$=0;for(this[O]=255&P;++$<A&&(k*=256);)this[O+$]=P/k&255;return O+A},u.prototype.writeUIntBE=function(P,O,A,L){P=+P,O|=0,A|=0,L||B(this,P,O,A,Math.pow(2,8*A)-1,0);var k=A-1,$=1;for(this[O+k]=255&P;--k>=0&&($*=256);)this[O+k]=P/$&255;return O+A},u.prototype.writeUInt8=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,1,255,0),u.TYPED_ARRAY_SUPPORT||(P=Math.floor(P)),this[O]=255&P,O+1},u.prototype.writeUInt16LE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[O]=255&P,this[O+1]=P>>>8):j(this,P,O,!0),O+2},u.prototype.writeUInt16BE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[O]=P>>>8,this[O+1]=255&P):j(this,P,O,!1),O+2},u.prototype.writeUInt32LE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[O+3]=P>>>24,this[O+2]=P>>>16,this[O+1]=P>>>8,this[O]=255&P):ie(this,P,O,!0),O+4},u.prototype.writeUInt32BE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[O]=P>>>24,this[O+1]=P>>>16,this[O+2]=P>>>8,this[O+3]=255&P):ie(this,P,O,!1),O+4},u.prototype.writeIntLE=function(P,O,A,L){if(P=+P,O|=0,!L){var k=Math.pow(2,8*A-1);B(this,P,O,A,k-1,-k)}var $=0,H=1,se=0;for(this[O]=255&P;++$<A&&(H*=256);)P<0&&se===0&&this[O+$-1]!==0&&(se=1),this[O+$]=(P/H>>0)-se&255;return O+A},u.prototype.writeIntBE=function(P,O,A,L){if(P=+P,O|=0,!L){var k=Math.pow(2,8*A-1);B(this,P,O,A,k-1,-k)}var $=A-1,H=1,se=0;for(this[O+$]=255&P;--$>=0&&(H*=256);)P<0&&se===0&&this[O+$+1]!==0&&(se=1),this[O+$]=(P/H>>0)-se&255;return O+A},u.prototype.writeInt8=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,1,127,-128),u.TYPED_ARRAY_SUPPORT||(P=Math.floor(P)),P<0&&(P=255+P+1),this[O]=255&P,O+1},u.prototype.writeInt16LE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[O]=255&P,this[O+1]=P>>>8):j(this,P,O,!0),O+2},u.prototype.writeInt16BE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[O]=P>>>8,this[O+1]=255&P):j(this,P,O,!1),O+2},u.prototype.writeInt32LE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[O]=255&P,this[O+1]=P>>>8,this[O+2]=P>>>16,this[O+3]=P>>>24):ie(this,P,O,!0),O+4},u.prototype.writeInt32BE=function(P,O,A){return P=+P,O|=0,A||B(this,P,O,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),u.TYPED_ARRAY_SUPPORT?(this[O]=P>>>24,this[O+1]=P>>>16,this[O+2]=P>>>8,this[O+3]=255&P):ie(this,P,O,!1),O+4},u.prototype.writeFloatLE=function(P,O,A){return fe(this,P,O,!0,A)},u.prototype.writeFloatBE=function(P,O,A){return fe(this,P,O,!1,A)},u.prototype.writeDoubleLE=function(P,O,A){return Ee(this,P,O,!0,A)},u.prototype.writeDoubleBE=function(P,O,A){return Ee(this,P,O,!1,A)},u.prototype.copy=function(P,O,A,L){if(A||(A=0),L||L===0||(L=this.length),O>=P.length&&(O=P.length),O||(O=0),L>0&&L<A&&(L=A),L===A||P.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(A<0||A>=this.length)throw new RangeError("sourceStart out of bounds");if(L<0)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length),P.length-O<L-A&&(L=P.length-O+A);var k,$=L-A;if(this===P&&A<O&&O<L)for(k=$-1;k>=0;--k)P[k+O]=this[k+A];else if($<1e3||!u.TYPED_ARRAY_SUPPORT)for(k=0;k<$;++k)P[k+O]=this[k+A];else Uint8Array.prototype.set.call(P,this.subarray(A,A+$),O);return $},u.prototype.fill=function(P,O,A,L){if(typeof P=="string"){if(typeof O=="string"?(L=O,O=0,A=this.length):typeof A=="string"&&(L=A,A=this.length),P.length===1){var k=P.charCodeAt(0);k<256&&(P=k)}if(L!==void 0&&typeof L!="string")throw new TypeError("encoding must be a string");if(typeof L=="string"&&!u.isEncoding(L))throw new TypeError("Unknown encoding: "+L)}else typeof P=="number"&&(P&=255);if(O<0||this.length<O||this.length<A)throw new RangeError("Out of range index");if(A<=O)return this;var $;if(O>>>=0,A=A===void 0?this.length:A>>>0,P||(P=0),typeof P=="number")for($=O;$<A;++$)this[$]=P;else{var H=u.isBuffer(P)?P:Re(new u(P,L).toString()),se=H.length;for($=0;$<A-O;++$)this[$+O]=H[$%se]}return this};var ge=/[^+\/0-9A-Za-z-_]/g;function be(P){return P<16?"0"+P.toString(16):P.toString(16)}function Re(P,O){var A;O=O||1/0;for(var L=P.length,k=null,$=[],H=0;H<L;++H){if((A=P.charCodeAt(H))>55295&&A<57344){if(!k){if(A>56319){(O-=3)>-1&&$.push(239,191,189);continue}if(H+1===L){(O-=3)>-1&&$.push(239,191,189);continue}k=A;continue}if(A<56320){(O-=3)>-1&&$.push(239,191,189),k=A;continue}A=65536+(k-55296<<10|A-56320)}else k&&(O-=3)>-1&&$.push(239,191,189);if(k=null,A<128){if((O-=1)<0)break;$.push(A)}else if(A<2048){if((O-=2)<0)break;$.push(A>>6|192,63&A|128)}else if(A<65536){if((O-=3)<0)break;$.push(A>>12|224,A>>6&63|128,63&A|128)}else{if(!(A<1114112))throw new Error("Invalid code point");if((O-=4)<0)break;$.push(A>>18|240,A>>12&63|128,A>>6&63|128,63&A|128)}}return $}function Ne(P){return o.toByteArray(function(O){if((O=function(A){return A.trim?A.trim():A.replace(/^\s+|\s+$/g,"")}(O).replace(ge,"")).length<2)return"";for(;O.length%4!=0;)O+="=";return O}(P))}function Ce(P,O,A,L){for(var k=0;k<L&&!(k+A>=O.length||k>=P.length);++k)O[k+A]=P[k];return k}}).call(this,i(78))},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.isASCIIByte=function(a){return a>=0&&a<=127}},function(n,r,i){var a=this&&this.__read||function(s,c){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var f,u,h=l.call(s),p=[];try{for(;(c===void 0||c-- >0)&&!(f=h.next()).done;)p.push(f.value)}catch(d){u={error:d}}finally{try{f&&!f.done&&(l=h.return)&&l.call(h)}finally{if(u)throw u.error}}return p},o=this&&this.__spread||function(){for(var s=[],c=0;c<arguments.length;c++)s=s.concat(a(arguments[c]));return s};Object.defineProperty(r,"__esModule",{value:!0}),r.length=function(s){return s.length},r.byteLowercase=function(s){for(var c=0;c<s.length;c++){var l=s[c];l>=65&&l<=90&&(s[c]=l+32)}},r.byteUppercase=function(s){for(var c=0;c<s.length;c++){var l=s[c];l>=97&&l<=122&&(s[c]=l-32)}},r.byteCaseInsensitiveMatch=function(s,c){if(s.length!==c.length)return!1;for(var l=0;l<s.length;l++){var f=s[l],u=c[l];if(f>=65&&f<=90&&(f+=32),u>=65&&u<=90&&(u+=32),f!==u)return!1}return!0},r.startsWith=function(s,c){for(var l=0;;){if(l>=s.length)return!1;if(l>=c.length)return!0;if(s[l]!==c[l])return!1;l++}},r.byteLessThan=function(s,c){for(var l=0;;){if(l>=s.length)return!1;if(l>=c.length)return!0;var f=s[l],u=c[l];if(f<u)return!0;if(f>u)return!1;l++}},r.isomorphicDecode=function(s){return String.fromCodePoint.apply(String,o(s))}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(7),s=i(0),c=i(12),l=function(){function f(u){this._associatedDocument=u||a.dom.window.document}return f.prototype.createDocumentType=function(u,h,p){return s.namespace_validate(u),s.create_documentType(this._associatedDocument,u,h,p)},f.prototype.createDocument=function(u,h,p){p===void 0&&(p=null);var d=s.create_xmlDocument(),g=null;return h&&(g=s.document_internalCreateElementNS(d,u,h)),p&&d.appendChild(p),g&&d.appendChild(g),d._origin=this._associatedDocument._origin,u===o.namespace.HTML?d._contentType="application/xhtml+xml":u===o.namespace.SVG?d._contentType="image/svg+xml":d._contentType="application/xml",d},f.prototype.createHTMLDocument=function(u){var h=s.create_document();h._type="html",h._contentType="text/html",h.appendChild(s.create_documentType(h,"html","",""));var p=s.element_createAnElement(h,"html",o.namespace.HTML);h.appendChild(p);var d=s.element_createAnElement(h,"head",o.namespace.HTML);if(p.appendChild(d),u!==void 0){var g=s.element_createAnElement(h,"title",o.namespace.HTML);d.appendChild(g);var y=s.create_text(h,u);g.appendChild(y)}var x=s.element_createAnElement(h,"body",o.namespace.HTML);return p.appendChild(x),h._origin=this._associatedDocument._origin,h},f.prototype.hasFeature=function(){return!0},f._create=function(u){return new f(u)},f}();r.DOMImplementationImpl=l,c.idl_defineConst(l.prototype,"_ID","@oozcitak/dom")},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),c=i(1),l=i(0),f=function(u){function h(){var p=u.call(this)||this;return p._signalSlots=new Set,p._mutationObserverMicrotaskQueued=!1,p._mutationObservers=new Set,p._iteratorList=new c.FixedSizeSet,p._associatedDocument=l.create_document(),p}return o(h,u),Object.defineProperty(h.prototype,"document",{get:function(){return this._associatedDocument},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"event",{get:function(){return this._currentEvent},enumerable:!0,configurable:!0}),h._create=function(){return new h},h}(s.EventTargetImpl);r.WindowImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=function(){function s(){}return s.isNode=function(c){return!!c&&c._nodeType!==void 0},s.isDocumentNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.Document},s.isDocumentTypeNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.DocumentType},s.isDocumentFragmentNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.DocumentFragment},s.isAttrNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.Attribute},s.isCharacterDataNode=function(c){if(!s.isNode(c))return!1;var l=c._nodeType;return l===a.NodeType.Text||l===a.NodeType.ProcessingInstruction||l===a.NodeType.Comment||l===a.NodeType.CData},s.isTextNode=function(c){return s.isNode(c)&&(c._nodeType===a.NodeType.Text||c._nodeType===a.NodeType.CData)},s.isExclusiveTextNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.Text},s.isCDATASectionNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.CData},s.isCommentNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.Comment},s.isProcessingInstructionNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.ProcessingInstruction},s.isElementNode=function(c){return s.isNode(c)&&c._nodeType===a.NodeType.Element},s.isCustomElementNode=function(c){return s.isElementNode(c)&&c._customElementState==="custom"},s.isShadowRoot=function(c){return!!c&&c.host!==void 0},s.isMouseEvent=function(c){return!!c&&c.screenX!==void 0&&c.screenY!=null},s.isSlotable=function(c){return!!c&&c._name!==void 0&&c._assignedSlot!==void 0&&(s.isTextNode(c)||s.isElementNode(c))},s.isSlot=function(c){return!!c&&c._name!==void 0&&c._assignedNodes!==void 0&&s.isElementNode(c)},s.isWindow=function(c){return!!c&&c.navigator!==void 0},s.isEventListener=function(c){return!!c&&c.handleEvent!==void 0},s.isRegisteredObserver=function(c){return!!c&&c.observer!==void 0&&c.options!==void 0},s.isTransientRegisteredObserver=function(c){return!!c&&c.source!==void 0&&s.isRegisteredObserver(c)},s}();r.Guard=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(c,l){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var h in u)u.hasOwnProperty(h)&&(f[h]=u[h])})(c,l)},function(c,l){function f(){this.constructor=c}a(c,l),c.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(c){function l(){return c.call(this)||this}return o(l,c),l}(i(98).DocumentImpl);r.XMLDocumentImpl=s},function(n,r,i){var a=this&&this.__values||function(L){var k=typeof Symbol=="function"&&Symbol.iterator,$=k&&L[k],H=0;if($)return $.call(L);if(L&&typeof L.length=="number")return{next:function(){return L&&H>=L.length&&(L=void 0),{value:L&&L[H++],done:!L}}};throw new TypeError(k?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(L,k){var $=typeof Symbol=="function"&&L[Symbol.iterator];if(!$)return L;var H,se,me=$.call(L),ye=[];try{for(;(k===void 0||k-- >0)&&!(H=me.next()).done;)ye.push(H.value)}catch(_e){se={error:_e}}finally{try{H&&!H.done&&($=me.return)&&$.call(me)}finally{if(se)throw se.error}}return ye};Object.defineProperty(r,"__esModule",{value:!0});var s,c=i(1),l=i(243),f=i(7),u=i(244),h={ftp:21,file:null,http:80,https:443,ws:80,wss:443},p=/[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,d=/[ "<>`]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=/[ "<>`#?{}]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y=/[ "<>`#?{}/:;=@\[\]\\\^\|]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,x=/[0-9A-Za-z!\$&-\/:;=\?@_~\xA0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uD83E\uD840-\uD87E\uD880-\uD8BE\uD8C0-\uD8FE\uD900-\uD93E\uD940-\uD97E\uD980-\uD9BE\uD9C0-\uD9FE\uDA00-\uDA3E\uDA40-\uDA7E\uDA80-\uDABE\uDAC0-\uDAFE\uDB00-\uDB3E\uDB40-\uDB7E\uDB80-\uDBBE\uDBC0-\uDBFE][\uDC00-\uDFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDC00-\uDFFD]/,m=/[\0\t\f\r #%/:?@\[\\\]]/;function v(L){s!==void 0&&s.call(null,"Validation Error: "+L)}function w(){return{scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null}}function C(L){return L in h}function T(L){return C(L.scheme)}function _(L){return h[L]||null}function S(L){return L.username!==""||L.password!==""}function b(L,k){var $,H;k===void 0&&(k=!1);var se=L.scheme+":";if(L.host!==null?(se+="//",S(L)&&(se+=L.username,L.password!==""&&(se+=":"+L.password),se+="@"),se+=D(L.host),L.port!==null&&(se+=":"+L.port)):L.host===null&&L.scheme==="file"&&(se+="//"),L._cannotBeABaseURLFlag)se+=L.path[0];else try{for(var me=a(L.path),ye=me.next();!ye.done;ye=me.next())se+="/"+ye.value}catch(_e){$={error:_e}}finally{try{ye&&!ye.done&&(H=me.return)&&H.call(me)}finally{if($)throw $.error}}return L.query!==null&&(se+="?"+L.query),k||L.fragment===null||(se+="#"+L.fragment),se}function D(L){return c.isNumber(L)?E(L):c.isArray(L)?"["+R(L)+"]":L}function E(L){for(var k="",$=L,H=1;H<=4;H++)k=($%256).toString()+k,H!==4&&(k="."+k),$=Math.floor($/256);return k}function R(L){for(var k="",$=null,H=-1,se=0,me=0,ye=0;ye<8;ye++)if(L[ye]===0){se=1;for(var _e=ye+1;_e<8&&L[_e]===0;_e++)se++;se>me&&(me=se,H=ye)}me>1&&($=H);for(var K=!1,ne=0;ne<8;ne++)K&&L[ne]===0||(K&&(K=!1),$!==ne?(k+=L[ne].toString(16),ne!==7&&(k+=":")):(k+=ne===0?"::":":",K=!0));return k}function F(L,k,$,H,se){var me,ye,_e,K;if(H===void 0){H={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null};var ne=/^[\u0000-\u001F\u0020]+/,ce=/[\u0000-\u001F\u0020]+$/;(ne.test(L)||ce.test(L))&&v("Input string contains leading or trailing control characters or space."),L=(L=L.replace(ne,"")).replace(ce,"")}var re=/[\u0009\u000A\u000D]/g;re.test(L)&&v("Input string contains tab or newline characters."),L=L.replace(re,"");var ue=se===void 0?l.ParserState.SchemeStart:se;k===void 0&&(k=null);for(var De=$===void 0||$==="replacement"||$==="UTF-16BE"||$==="UTF-16LE"?"UTF-8":$,te="",Ue=!1,Ye=!1,qe=!1,xe=new c.StringWalker(L);;){switch(ue){case l.ParserState.SchemeStart:if(f.codePoint.ASCIIAlpha.test(xe.c()))te+=xe.c().toLowerCase(),ue=l.ParserState.Scheme;else{if(se!==void 0)return v("Invalid scheme start character."),null;ue=l.ParserState.NoScheme,xe.pointer--}break;case l.ParserState.Scheme:if(f.codePoint.ASCIIAlphanumeric.test(xe.c())||xe.c()==="+"||xe.c()==="-"||xe.c()===".")te+=xe.c().toLowerCase();else{if(xe.c()!==":"){if(se===void 0){te="",ue=l.ParserState.NoScheme,xe.pointer=0;continue}return v("Invalid input string."),null}if(se!==void 0&&(C(H.scheme)&&!C(te)||!C(H.scheme)&&C(te)||(S(H)||H.port!==null)&&te==="file"||H.scheme==="file"&&(H.host===""||H.host===null)))return H;if(H.scheme=te,se!==void 0)return H.port===_(H.scheme)&&(H.port=null),H;te="",H.scheme==="file"?(xe.remaining().startsWith("//")||v("Invalid file URL scheme, '//' expected."),ue=l.ParserState.File):T(H)&&k!==null&&k.scheme===H.scheme?ue=l.ParserState.SpecialRelativeOrAuthority:T(H)?ue=l.ParserState.SpecialAuthoritySlashes:xe.remaining().startsWith("/")?(ue=l.ParserState.PathOrAuthority,xe.pointer++):(H._cannotBeABaseURLFlag=!0,H.path.push(""),ue=l.ParserState.CannotBeABaseURLPath)}break;case l.ParserState.NoScheme:if(k===null||k._cannotBeABaseURLFlag&&xe.c()!=="#")return v("Invalid input string."),null;k._cannotBeABaseURLFlag&&xe.c()==="#"?(H.scheme=k.scheme,H.path=f.list.clone(k.path),H.query=k.query,H.fragment="",H._cannotBeABaseURLFlag=!0,ue=l.ParserState.Fragment):k.scheme!=="file"?(ue=l.ParserState.Relative,xe.pointer--):(ue=l.ParserState.File,xe.pointer--);break;case l.ParserState.SpecialRelativeOrAuthority:xe.c()==="/"&&xe.remaining().startsWith("/")?(ue=l.ParserState.SpecialAuthorityIgnoreSlashes,xe.pointer++):(v("Invalid input string."),ue=l.ParserState.Relative,xe.pointer--);break;case l.ParserState.PathOrAuthority:xe.c()==="/"?ue=l.ParserState.Authority:(ue=l.ParserState.Path,xe.pointer--);break;case l.ParserState.Relative:if(k===null)throw new Error("Invalid parser state. Base URL is null.");switch(H.scheme=k.scheme,xe.c()){case"":H.username=k.username,H.password=k.password,H.host=k.host,H.port=k.port,H.path=f.list.clone(k.path),H.query=k.query;break;case"/":ue=l.ParserState.RelativeSlash;break;case"?":H.username=k.username,H.password=k.password,H.host=k.host,H.port=k.port,H.path=f.list.clone(k.path),H.query="",ue=l.ParserState.Query;break;case"#":H.username=k.username,H.password=k.password,H.host=k.host,H.port=k.port,H.path=f.list.clone(k.path),H.query=k.query,H.fragment="",ue=l.ParserState.Fragment;break;default:T(H)&&xe.c()==="\\"?(v("Invalid input string."),ue=l.ParserState.RelativeSlash):(H.username=k.username,H.password=k.password,H.host=k.host,H.port=k.port,H.path=f.list.clone(k.path),H.path.length!==0&&H.path.splice(H.path.length-1,1),ue=l.ParserState.Path,xe.pointer--)}break;case l.ParserState.RelativeSlash:if(!T(H)||xe.c()!=="/"&&xe.c()!=="\\")if(xe.c()==="/")ue=l.ParserState.Authority;else{if(k===null)throw new Error("Invalid parser state. Base URL is null.");H.username=k.username,H.password=k.password,H.host=k.host,H.port=k.port,ue=l.ParserState.Path,xe.pointer--}else xe.c()==="\\"&&v("Invalid input string."),ue=l.ParserState.SpecialAuthorityIgnoreSlashes;break;case l.ParserState.SpecialAuthoritySlashes:xe.c()==="/"&&xe.remaining().startsWith("/")?(ue=l.ParserState.SpecialAuthorityIgnoreSlashes,xe.pointer++):(v("Expected '//'."),ue=l.ParserState.SpecialAuthorityIgnoreSlashes,xe.pointer--);break;case l.ParserState.SpecialAuthorityIgnoreSlashes:xe.c()!=="/"&&xe.c()!=="\\"?(ue=l.ParserState.Authority,xe.pointer--):v("Unexpected '/' or '\\'.");break;case l.ParserState.Authority:if(xe.c()==="@"){v("Unexpected '@'."),Ue&&(te="%40"+te),Ue=!0;try{for(var Fe=(me=void 0,a(te)),ze=Fe.next();!ze.done;ze=Fe.next()){var $e=ze.value;if($e!==":"||qe){var Xe=Ce($e,y);qe?H.password+=Xe:H.username+=Xe}else qe=!0}}catch(Ht){me={error:Ht}}finally{try{ze&&!ze.done&&(ye=Fe.return)&&ye.call(Fe)}finally{if(me)throw me.error}}te=""}else if(xe.c()===""||xe.c()==="/"||xe.c()==="?"||xe.c()==="#"||T(H)&&xe.c()==="\\"){if(Ue&&te==="")return v("Invalid input string."),null;xe.pointer-=te.length+1,te="",ue=l.ParserState.Host}else te+=xe.c();break;case l.ParserState.Host:case l.ParserState.Hostname:if(se!==void 0&&H.scheme==="file")xe.pointer--,ue=l.ParserState.FileHost;else if(xe.c()!==":"||Ye)if(xe.c()===""||xe.c()==="/"||xe.c()==="?"||xe.c()==="#"||T(H)&&xe.c()==="\\"){if(xe.pointer--,T(H)&&te==="")return v("Invalid input string."),null;if(se!==void 0&&te===""&&(S(H)||H.port!==null))return v("Invalid input string."),H;if((rt=j(te,!T(H)))===null)return null;if(H.host=rt,te="",ue=l.ParserState.PathStart,se!==void 0)return H}else xe.c()==="["&&(Ye=!0),xe.c()==="]"&&(Ye=!1),te+=xe.c();else{if(te==="")return v("Invalid input string."),null;if((rt=j(te,!T(H)))===null)return null;if(H.host=rt,te="",ue=l.ParserState.Port,se===l.ParserState.Hostname)return H}break;case l.ParserState.Port:if(f.codePoint.ASCIIDigit.test(xe.c()))te+=xe.c();else{if(!(xe.c()===""||xe.c()==="/"||xe.c()==="?"||xe.c()==="#"||T(H)&&xe.c()==="\\"||se))return v("Invalid input string."),null;if(te!==""&&te!==""){var ot=parseInt(te,10);if(ot>Math.pow(2,16)-1)return v("Invalid port number."),null;H.port=ot===_(H.scheme)?null:ot,te=""}if(se!==void 0)return H;ue=l.ParserState.PathStart,xe.pointer--}break;case l.ParserState.File:if(H.scheme="file",xe.c()==="/"||xe.c()==="\\")xe.c()==="\\"&&v("Invalid input string."),ue=l.ParserState.FileSlash;else if(k!==null&&k.scheme==="file")switch(xe.c()){case"":H.host=k.host,H.path=f.list.clone(k.path),H.query=k.query;break;case"?":H.host=k.host,H.path=f.list.clone(k.path),H.query="",ue=l.ParserState.Query;break;case"#":H.host=k.host,H.path=f.list.clone(k.path),H.query=k.query,H.fragment="",ue=l.ParserState.Fragment;break;default:B(xe.substring())?v("Unexpected windows drive letter in input string."):(H.host=k.host,H.path=f.list.clone(k.path),z(H)),ue=l.ParserState.Path,xe.pointer--}else ue=l.ParserState.Path,xe.pointer--;break;case l.ParserState.FileSlash:xe.c()==="/"||xe.c()==="\\"?(xe.c()==="\\"&&v("Invalid input string."),ue=l.ParserState.FileHost):(k===null||k.scheme!=="file"||B(xe.substring())||(Y(k.path[0])?H.path.push(k.path[0]):H.host=k.host),ue=l.ParserState.Path,xe.pointer--);break;case l.ParserState.FileHost:if(xe.c()===""||xe.c()==="/"||xe.c()==="\\"||xe.c()==="?"||xe.c()==="#")if(xe.pointer--,se===void 0&&W(te))v("Unexpected windows drive letter in input string."),ue=l.ParserState.Path;else if(te===""){if(H.host="",se!==void 0)return H;ue=l.ParserState.PathStart}else{var rt;if((rt=j(te,!T(H)))===null)return null;if(rt==="localhost"&&(rt=""),H.host=rt,se!==void 0)return H;te="",ue=l.ParserState.PathStart}else te+=xe.c();break;case l.ParserState.PathStart:T(H)?(xe.c()==="\\"&&v("Invalid input string."),ue=l.ParserState.Path,xe.c()!=="/"&&xe.c()!=="\\"&&xe.pointer--):se===void 0&&xe.c()==="?"?(H.query="",ue=l.ParserState.Query):se===void 0&&xe.c()==="#"?(H.fragment="",ue=l.ParserState.Fragment):xe.c()!==""&&(ue=l.ParserState.Path,xe.c()!=="/"&&xe.pointer--);break;case l.ParserState.Path:if(xe.c()===""||xe.c()==="/"||T(H)&&xe.c()==="\\"||se===void 0&&(xe.c()==="?"||xe.c()==="#")){if(T(H)&&xe.c()==="\\"&&v("Invalid input string."),U(te))z(H),xe.c()==="/"||T(H)&&xe.c()==="\\"||H.path.push("");else if(!M(te)||xe.c()==="/"||T(H)&&xe.c()==="\\"){if(!M(te)){if(H.scheme==="file"&&H.path.length===0&&W(te)){H.host!==null&&H.host!==""&&(v("Invalid input string."),H.host="");var mt=Array.from(te);te=mt.slice(0,1)+":"+mt.slice(2)}H.path.push(te)}}else H.path.push("");if(te="",H.scheme==="file"&&(xe.c()===""||xe.c()==="?"||xe.c()==="#"))for(;H.path.length>1&&H.path[0]==="";)v("Invalid input string."),H.path.splice(0,1);xe.c()==="?"&&(H.query="",ue=l.ParserState.Query),xe.c()==="#"&&(H.fragment="",ue=l.ParserState.Fragment)}else x.test(xe.c())||xe.c()==="%"||v("Character is not a URL code point or a percent encoded character."),xe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(xe.remaining())||v("Percent encoded character must be followed by two hex digits."),te+=Ce(xe.c(),g);break;case l.ParserState.CannotBeABaseURLPath:xe.c()==="?"?(H.query="",ue=l.ParserState.Query):xe.c()==="#"?(H.fragment="",ue=l.ParserState.Fragment):(xe.c()===""||x.test(xe.c())||xe.c()==="%"||v("Character is not a URL code point or a percent encoded character."),xe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(xe.remaining())||v("Percent encoded character must be followed by two hex digits."),xe.c()!==""&&(H.path[0]+=Ce(xe.c(),p)));break;case l.ParserState.Query:if(De==="UTF-8"||T(H)&&H.scheme!=="ws"&&H.scheme!=="wss"||(De="UTF-8"),se===void 0&&xe.c()==="#")H.fragment="",ue=l.ParserState.Fragment;else if(xe.c()!==""){if(x.test(xe.c())||xe.c()==="%"||v("Character is not a URL code point or a percent encoded character."),xe.c()!=="%"||/^[0-9a-fA-F][0-9a-fA-F]/.test(xe.remaining())||v("Percent encoded character must be followed by two hex digits."),De.toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var wt=c.utf8Encode(xe.c());if(wt.length>=3&&wt[0]===38&&wt[1]===35&&wt[wt.length-1]===59)wt=wt.subarray(2,wt.length-1),H.query+="%26%23"+f.byteSequence.isomorphicDecode(wt)+"%3B";else try{for(var qt=(_e=void 0,a(wt)),nn=qt.next();!nn.done;nn=qt.next()){var Pt=nn.value;Pt<33||Pt>126||Pt===34||Pt===35||Pt===60||Pt===62||Pt===39&&T(H)?H.query+=be(Pt):H.query+=String.fromCharCode(Pt)}}catch(Ht){_e={error:Ht}}finally{try{nn&&!nn.done&&(K=qt.return)&&K.call(qt)}finally{if(_e)throw _e.error}}}break;case l.ParserState.Fragment:xe.c()===""||(xe.c()==="\0"?v("NULL character in input string."):(x.test(xe.c())||xe.c()==="%"||v("Unexpected character in fragment string."),xe.c()!=="%"||/^[A-Za-z0-9][A-Za-z0-9]/.test(xe.remaining())||v("Unexpected character in fragment string."),H.fragment+=Ce(xe.c(),d)))}if(xe.eof)break;xe.pointer++}return H}function M(L){return L==="."||L.toLowerCase()==="%2e"}function U(L){var k=L.toLowerCase();return k===".."||k===".%2e"||k==="%2e."||k==="%2e%2e"}function z(L){var k=L.path;k.length!==0&&(L.scheme==="file"&&k.length===1&&Y(k[0])||L.path.splice(L.path.length-1,1))}function Y(L){return L.length>=2&&f.codePoint.ASCIIAlpha.test(L[0])&&L[1]===":"}function W(L){return L.length>=2&&f.codePoint.ASCIIAlpha.test(L[0])&&(L[1]===":"||L[1]==="|")}function B(L){return L.length>=2&&W(L)&&(L.length===2||L[2]==="/"||L[2]==="\\"||L[2]==="?"||L[2]==="#")}function j(L,k){if(k===void 0&&(k=!1),L.startsWith("["))return L.endsWith("]")?fe(L.substring(1,L.length-1)):(v("Expected ']' after '['."),null);if(k)return Ee(L);var $=A(c.utf8Decode(Ne(L)));if($===null||m.test($))return v("Invalid domain."),null;var H=ae($);return H===null||c.isNumber(H)?H:$}function ie(L,k){k===void 0&&(k={value:!1});var $=10;return L.startsWith("0x")||L.startsWith("0X")?(k.value=!0,L=L.substr(2),$=16):L.length>=2&&L[0]==="0"&&(k.value=!0,L=L.substr(1),$=8),L===""?0:($===10?/^[0-9]+$/:$===16?/^[0-9A-Fa-f]+$/:/^[0-7]+$/).test(L)?parseInt(L,$):null}function ae(L){var k,$,H,se,me={value:!1},ye=L.split(".");if(ye[ye.length-1]===""&&(me.value=!0,ye.length>1&&ye.pop()),ye.length>4)return L;var _e=[];try{for(var K=a(ye),ne=K.next();!ne.done;ne=K.next()){var ce=ne.value;if(ce===""||(Ye=ie(ce,me))===null)return L;_e.push(Ye)}}catch(qe){k={error:qe}}finally{try{ne&&!ne.done&&($=K.return)&&$.call(K)}finally{if(k)throw k.error}}me.value&&v("Invalid IP v4 address.");for(var re=0;re<_e.length;re++)if(_e[re]>255&&(v("Invalid IP v4 address."),re<_e.length-1))return null;if(_e[_e.length-1]>=Math.pow(256,5-_e.length))return v("Invalid IP v4 address."),null;var ue=_e[_e.length-1];_e.pop();var De=0;try{for(var te=a(_e),Ue=te.next();!Ue.done;Ue=te.next()){var Ye;ue+=(Ye=Ue.value)*Math.pow(256,3-De),De++}}catch(qe){H={error:qe}}finally{try{Ue&&!Ue.done&&(se=te.return)&&se.call(te)}finally{if(H)throw H.error}}return ue}function fe(L){var k,$=[0,0,0,0,0,0,0,0],H=0,se=null,me=new c.StringWalker(L);if(me.c()===":"){if(!me.remaining().startsWith(":"))return v("Invalid IP v6 address."),null;me.pointer+=2,se=H+=1}for(;me.c()!=="";){if(H===8)return v("Invalid IP v6 address."),null;if(me.c()!==":"){for(var ye=0,_e=0;_e<4&&f.codePoint.ASCIIHexDigit.test(me.c());)ye=16*ye+parseInt(me.c(),16),me.pointer++,_e++;if(me.c()==="."){if(_e===0||(me.pointer-=_e,H>6))return v("Invalid IP v6 address."),null;for(var K=0;me.c()!=="";){var ne=null;if(K>0){if(!(me.c()==="."&&K<4))return v("Invalid IP v6 address."),null;me.pointer++}if(!f.codePoint.ASCIIDigit.test(me.c()))return v("Invalid IP v6 address."),null;for(;f.codePoint.ASCIIDigit.test(me.c());){var ce=parseInt(me.c(),10);if(ne===null)ne=ce;else{if(ne===0)return v("Invalid IP v6 address."),null;ne=10*ne+ce}if(ne>255)return v("Invalid IP v6 address."),null;me.pointer++}if(ne===null)return v("Invalid IP v6 address."),null;$[H]=256*$[H]+ne,++K!==2&&K!==4||H++}if(K!==4)return v("Invalid IP v6 address."),null;break}if(me.c()===":"){if(me.pointer++,me.c()==="")return v("Invalid IP v6 address."),null}else if(me.c()!=="")return v("Invalid IP v6 address."),null;$[H]=ye,H++}else{if(se!==null)return v("Invalid IP v6 address."),null;me.pointer++,se=++H}}if(se!==null){var re=H-se;for(H=7;H!==0&&re>0;)k=o([$[se+re-1],$[H]],2),$[H]=k[0],$[se+re-1]=k[1],H--,re--}else if(se===null&&H!==8)return v("Invalid IP v6 address."),null;return $}function Ee(L){var k,$;if(/[\x00\t\f\r #/:?@\[\\\]]/.test(L))return v("Invalid host string."),null;var H="";try{for(var se=a(L),me=se.next();!me.done;me=se.next())H+=Ce(me.value,p)}catch(ye){k={error:ye}}finally{try{me&&!me.done&&($=se.return)&&$.call(se)}finally{if(k)throw k.error}}return H}function ge(L){return null}function be(L){return"%"+("00"+L.toString(16).toUpperCase()).slice(-2)}function Re(L){for(var k=function(_e){return _e>=48&&_e<=57||_e>=65&&_e<=70||_e>=97&&_e<=102},$=new Uint8Array(L.length),H=0,se=0;se<L.length;se++){var me=L[se];if(me!==37)$[H]=me,H++;else if(me===37&&se>=L.length-2)$[H]=me,H++;else if(me!==37||k(L[se+1])&&k(L[se+2])){var ye=parseInt(c.utf8Decode(Uint8Array.of(L[se+1],L[se+2])),16);$[H]=ye,H++,se+=2}else $[H]=me,H++}return $.subarray(0,H)}function Ne(L){return Re(c.utf8Encode(L))}function Ce(L,k){var $,H;if(!k.test(L))return L;var se=c.utf8Encode(L),me="";try{for(var ye=a(se),_e=ye.next();!_e.done;_e=ye.next())me+=be(_e.value)}catch(K){$={error:K}}finally{try{_e&&!_e.done&&(H=ye.return)&&H.call(ye)}finally{if($)throw $.error}}return me}function P(L){var k,$,H,se,me=[],ye=[];try{for(var _e=a(L),K=_e.next();!K.done;K=_e.next()){var ne=K.value;ne===38?(me.push(Uint8Array.from(ye)),ye=[]):ye.push(ne)}}catch(ze){k={error:ze}}finally{try{K&&!K.done&&($=_e.return)&&$.call(_e)}finally{if(k)throw k.error}}ye.length!==0&&me.push(Uint8Array.from(ye));var ce=[];try{for(var re=a(me),ue=re.next();!ue.done;ue=re.next()){var De=ue.value;if(De.length!==0){for(var te=De.indexOf(61),Ue=te!==-1?De.slice(0,te):De,Ye=te!==-1?De.slice(te+1):new Uint8Array,qe=0;qe<Ue.length;qe++)Ue[qe]===43&&(Ue[qe]=32);for(qe=0;qe<Ye.length;qe++)Ye[qe]===43&&(Ye[qe]=32);var xe=c.utf8Decode(Ue),Fe=c.utf8Decode(Ye);ce.push([xe,Fe])}}}catch(ze){H={error:ze}}finally{try{ue&&!ue.done&&(se=re.return)&&se.call(re)}finally{if(H)throw H.error}}return ce}function O(L){var k,$,H="";try{for(var se=a(L),me=se.next();!me.done;me=se.next()){var ye=me.value;H+=ye===32?"+":ye===42||ye===45||ye===46||ye>=48&&ye<=57||ye>=65&&ye<=90||ye===95||ye>=97&&ye<=122?String.fromCodePoint(ye):be(ye)}}catch(_e){k={error:_e}}finally{try{me&&!me.done&&($=se.return)&&$.call(se)}finally{if(k)throw k.error}}return H}function A(L,k){var $=u.domainToASCII(L);return $===""?(v("Invalid domain name."),null):$}r.setValidationErrorCallback=function(L){s=L},r.newURL=w,r.isSpecialScheme=C,r.isSpecial=T,r.defaultPort=_,r.includesCredentials=S,r.cannotHaveAUsernamePasswordPort=function(L){return L.host===null||L.host===""||L._cannotBeABaseURLFlag||L.scheme==="file"},r.urlSerializer=b,r.hostSerializer=D,r.iPv4Serializer=E,r.iPv6Serializer=R,r.urlParser=function(L,k,$){var H=F(L,k,$);return H===null?null:(H.scheme!=="blob"||(H._blobURLEntry=null),H)},r.basicURLParser=F,r.setTheUsername=function(L,k){var $,H,se="";try{for(var me=a(k),ye=me.next();!ye.done;ye=me.next())se+=Ce(ye.value,y)}catch(_e){$={error:_e}}finally{try{ye&&!ye.done&&(H=me.return)&&H.call(me)}finally{if($)throw $.error}}L.username=se},r.setThePassword=function(L,k){var $,H,se="";try{for(var me=a(k),ye=me.next();!ye.done;ye=me.next())se+=Ce(ye.value,y)}catch(_e){$={error:_e}}finally{try{ye&&!ye.done&&(H=me.return)&&H.call(me)}finally{if($)throw $.error}}L.password=se},r.isSingleDotPathSegment=M,r.isDoubleDotPathSegment=U,r.shorten=z,r.isNormalizedWindowsDriveLetter=Y,r.isWindowsDriveLetter=W,r.startsWithAWindowsDriveLetter=B,r.hostParser=j,r.iPv4NumberParser=ie,r.iPv4Parser=ae,r.iPv6Parser=fe,r.opaqueHostParser=Ee,r.resolveABlobURL=ge,r.percentEncode=be,r.percentDecode=Re,r.stringPercentDecode=Ne,r.utf8PercentEncode=Ce,r.hostEquals=function(L,k){return L===k},r.urlEquals=function(L,k,$){return $===void 0&&($=!1),b(L,$)===b(k,$)},r.urlEncodedStringParser=function(L){return P(c.utf8Encode(L))},r.urlEncodedParser=P,r.urlEncodedByteSerializer=O,r.urlEncodedSerializer=function(L,k){var $,H;if((k===void 0||k==="replacement"||k==="UTF-16BE"||k==="UTF-16LE"?"UTF-8":k).toUpperCase()!=="UTF-8")throw new Error("Only UTF-8 encoding is supported.");var se="";try{for(var me=a(L),ye=me.next();!ye.done;ye=me.next()){var _e=ye.value,K=O(c.utf8Encode(_e[0])),ne=_e[1];ne=O(c.utf8Encode(ne)),se!==""&&(se+="&"),se+=K+"="+ne}}catch(ce){$={error:ce}}finally{try{ye&&!ye.done&&(H=me.return)&&H.call(me)}finally{if($)throw $.error}}return se},r.origin=function L(k){switch(k.scheme){case"blob":k._blobURLEntry;var $=F(k.path[0]);return $===null?l.OpaqueOrigin:L($);case"ftp":case"http":case"https":case"ws":case"wss":return[k.scheme,k.host===null?"":k.host,k.port,null];case"file":default:return l.OpaqueOrigin}},r.domainToASCII=A,r.domainToUnicode=function(L,k){var $=u.domainToUnicode(L);return $===""&&v("Invalid domain name."),$},r.asciiSerializationOfAnOrigin=function(L){if(L[0]===""&&L[1]===""&&L[2]===null&&L[3]===null)return"null";var k=L[0]+"://"+D(L[1]);return L[2]!==null&&(k+=":"+L[2].toString()),k}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=function(){function s(){this._signal=a.create_abortSignal()}return Object.defineProperty(s.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),s.prototype.abort=function(){a.abort_signalAbort(this._signal)},s}();r.AbortControllerImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(70),c=i(0),l=function(f){function u(){var h=f.call(this)||this;return h._abortedFlag=!1,h._abortAlgorithms=new Set,h}return o(u,f),Object.defineProperty(u.prototype,"aborted",{get:function(){return this._abortedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"onabort",{get:function(){return c.event_getterEventHandlerIDLAttribute(this,"onabort")},set:function(h){c.event_setterEventHandlerIDLAttribute(this,"onabort",h)},enumerable:!0,configurable:!0}),u._create=function(){return new u},u}(s.EventTargetImpl);r.AbortSignalImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(34),l=i(12),f=function(u){function h(p,d,g){var y=u.call(this)||this;return y._name="",y._publicId="",y._systemId="",y._name=p,y._publicId=d,y._systemId=g,y}return o(h,u),Object.defineProperty(h.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"publicId",{get:function(){return this._publicId},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"systemId",{get:function(){return this._systemId},enumerable:!0,configurable:!0}),h.prototype.before=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];throw new Error("Mixin: ChildNode not implemented.")},h.prototype.after=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];throw new Error("Mixin: ChildNode not implemented.")},h.prototype.replaceWith=function(){for(var p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];throw new Error("Mixin: ChildNode not implemented.")},h.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},h._create=function(p,d,g,y){g===void 0&&(g=""),y===void 0&&(y="");var x=new h(d,g,y);return x._nodeDocument=p,x},h}(c.NodeImpl);r.DocumentTypeImpl=f,l.idl_defineConst(f.prototype,"_nodeType",s.NodeType.DocumentType)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(100),c=i(1),l=i(0),f=function(u){function h(p,d){var g=u.call(this)||this;return g._host=p,g._mode=d,g}return o(h,u),Object.defineProperty(h.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),h.prototype._getTheParent=function(p){return p._composedFlag||c.isEmpty(p._path)||l.tree_rootNode(p._path[0].invocationTarget)!==this?this._host:null},h._create=function(p,d){return new h(d,"closed")},h}(s.DocumentFragmentImpl);r.ShadowRootImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(h,p){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var y in g)g.hasOwnProperty(y)&&(d[y]=g[y])})(h,p)},function(h,p){function d(){this.constructor=h}a(h,p),h.prototype=p===null?Object.create(p):(d.prototype=p.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(34),l=i(0),f=i(12),u=function(h){function p(d){var g=h.call(this)||this;return g._namespace=null,g._namespacePrefix=null,g._element=null,g._value="",g._localName=d,g}return o(p,h),Object.defineProperty(p.prototype,"ownerElement",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._qualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this._value},set:function(d){l.attr_setAnExistingAttributeValue(this,d)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix!==null?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),p._create=function(d,g){var y=new p(g);return y._nodeDocument=d,y},p}(c.NodeImpl);r.AttrImpl=u,f.idl_defineConst(u.prototype,"_nodeType",s.NodeType.Attribute),f.idl_defineConst(u.prototype,"specified",!0)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(101),c=i(2),l=i(12),f=function(u){function h(p){return u.call(this,p)||this}return o(h,u),h._create=function(p,d){d===void 0&&(d="");var g=new h(d);return g._nodeDocument=p,g},h}(s.TextImpl);r.CDATASectionImpl=f,l.idl_defineConst(f.prototype,"_nodeType",c.NodeType.CData)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(71),l=i(12),f=function(u){function h(p){return p===void 0&&(p=""),u.call(this,p)||this}return o(h,u),h._create=function(p,d){d===void 0&&(d="");var g=new h(d);return g._nodeDocument=p,g},h}(c.CharacterDataImpl);r.CommentImpl=f,l.idl_defineConst(f.prototype,"_nodeType",s.NodeType.Comment)},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(71),l=i(12),f=function(u){function h(p,d){var g=u.call(this,d)||this;return g._target=p,g}return o(h,u),Object.defineProperty(h.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),h._create=function(p,d,g){var y=new h(d,g);return y._nodeDocument=p,y},h}(c.CharacterDataImpl);r.ProcessingInstructionImpl=f,l.idl_defineConst(f.prototype,"_nodeType",s.NodeType.ProcessingInstruction)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(7),o=i(0),s=i(3),c=i(1),l=function(){function f(u,h){return this._live=!0,this._root=u,this._filter=h,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){for(var u=this,h=0,p=o.tree_getFirstDescendantNode(this._root,!1,!1,function(d){return s.Guard.isElementNode(d)&&u._filter(d)});p!==null;)h++,p=o.tree_getNextDescendantNode(this._root,p,!1,!1,function(d){return s.Guard.isElementNode(d)&&u._filter(d)});return h},enumerable:!0,configurable:!0}),f.prototype.item=function(u){for(var h=this,p=0,d=o.tree_getFirstDescendantNode(this._root,!1,!1,function(g){return s.Guard.isElementNode(g)&&h._filter(g)});d!==null;){if(p===u)return d;p++,d=o.tree_getNextDescendantNode(this._root,d,!1,!1,function(g){return s.Guard.isElementNode(g)&&h._filter(g)})}return null},f.prototype.namedItem=function(u){var h=this;if(u==="")return null;for(var p=o.tree_getFirstDescendantNode(this._root,!1,!1,function(y){return s.Guard.isElementNode(y)&&h._filter(y)});p!=null;){if(p._uniqueIdentifier===u)return p;if(p._namespace===a.namespace.HTML)for(var d=0;d<p._attributeList.length;d++){var g=p._attributeList[d];if(g._localName==="name"&&g._namespace===null&&g._namespacePrefix===null&&g._value===u)return p}p=o.tree_getNextDescendantNode(this._root,p,!1,!1,function(y){return s.Guard.isElementNode(y)&&h._filter(y)})}return null},f.prototype[Symbol.iterator]=function(){var u=this._root,h=this._filter,p=o.tree_getFirstDescendantNode(u,!1,!1,function(d){return s.Guard.isElementNode(d)&&h(d)});return{next:function(){if(p===null)return{done:!0,value:null};var d={done:!1,value:p};return p=o.tree_getNextDescendantNode(u,p,!1,!1,function(g){return s.Guard.isElementNode(g)&&h(g)}),d}}},f.prototype.get=function(u,h,p){if(!c.isString(h)||f.reservedNames.indexOf(h)!==-1)return Reflect.get(u,h,p);var d=Number(h);return isNaN(d)?u.namedItem(h)||void 0:u.item(d)||void 0},f.prototype.set=function(u,h,p,d){if(!c.isString(h)||f.reservedNames.indexOf(h)!==-1)return Reflect.set(u,h,p,d);var g=Number(h),y=isNaN(g)?u.namedItem(h)||void 0:u.item(g)||void 0;return!(!y||!y._parent)&&(o.mutation_replace(y,p,y._parent),!0)},f._create=function(u,h){return h===void 0&&(h=function(){return!0}),new f(u,h)},f.reservedNames=["_root","_live","_filter","length","item","namedItem","get","set"],f}();r.HTMLCollectionImpl=l},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,h=u&&f[u],p=0;if(h)return h.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&p>=f.length&&(f=void 0),{value:f&&f[p++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),c=i(0),l=function(){function f(u){return this._live=!0,this._filter=null,this._length=0,this._root=u,new Proxy(this,this)}return Object.defineProperty(f.prototype,"length",{get:function(){return this._root._children.size},enumerable:!0,configurable:!0}),f.prototype.item=function(u){if(u<0||u>this.length-1)return null;if(u<this.length/2){for(var h=0,p=this._root._firstChild;p!==null&&h!==u;)p=p._nextSibling,h++;return p}for(h=this.length-1,p=this._root._lastChild;p!==null&&h!==u;)p=p._previousSibling,h--;return p},f.prototype.keys=function(){var u;return(u={})[Symbol.iterator]=(function(){var h=0;return{next:(function(){return h===this.length?{done:!0,value:null}:{done:!1,value:h++}}).bind(this)}}).bind(this),u},f.prototype.values=function(){var u;return(u={})[Symbol.iterator]=(function(){var h=this[Symbol.iterator]();return{next:function(){return h.next()}}}).bind(this),u},f.prototype.entries=function(){var u;return(u={})[Symbol.iterator]=(function(){var h=this[Symbol.iterator](),p=0;return{next:function(){var d=h.next();return d.done?{done:!0,value:null}:{done:!1,value:[p++,d.value]}}}}).bind(this),u},f.prototype[Symbol.iterator]=function(){return this._root._children[Symbol.iterator]()},f.prototype.forEach=function(u,h){var p,d;h===void 0&&(h=o.dom.window);var g=0;try{for(var y=a(this._root._children),x=y.next();!x.done;x=y.next()){var m=x.value;u.call(h,m,g++,this)}}catch(v){p={error:v}}finally{try{x&&!x.done&&(d=y.return)&&d.call(y)}finally{if(p)throw p.error}}},f.prototype.get=function(u,h,p){if(!s.isString(h))return Reflect.get(u,h,p);var d=Number(h);return isNaN(d)?Reflect.get(u,h,p):u.item(d)||void 0},f.prototype.set=function(u,h,p,d){if(!s.isString(h))return Reflect.set(u,h,p,d);var g=Number(h);if(isNaN(g))return Reflect.set(u,h,p,d);var y=u.item(g)||void 0;return!!y&&!!y._parent&&(c.mutation_replace(y,p,y._parent),!0)},f._create=function(u){return new f(u)},f}();r.NodeListImpl=l},function(n,r,i){var a=this&&this.__values||function(l){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&l[f],h=0;if(u)return u.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&h>=l.length&&(l=void 0),{value:l&&l[h++],done:!l}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(1),c=function(){function l(f){return this._live=!1,this._items=[],this._length=0,this._root=f,this._items=[],this._filter=function(u){return!0},new Proxy(this,this)}return Object.defineProperty(l.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),l.prototype.item=function(f){return f<0||f>this.length-1?null:this._items[f]},l.prototype.keys=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=0;return{next:(function(){return u===this.length?{done:!0,value:null}:{done:!1,value:u++}}).bind(this)}}).bind(this),f},l.prototype.values=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator]();return{next:function(){return u.next()}}}).bind(this),f},l.prototype.entries=function(){var f;return(f={})[Symbol.iterator]=(function(){var u=this[Symbol.iterator](),h=0;return{next:function(){var p=u.next();return p.done?{done:!0,value:null}:{done:!1,value:[h++,p.value]}}}}).bind(this),f},l.prototype[Symbol.iterator]=function(){var f=this._items[Symbol.iterator]();return{next:function(){return f.next()}}},l.prototype.forEach=function(f,u){var h,p;u===void 0&&(u=o.dom.window);var d=0;try{for(var g=a(this._items),y=g.next();!y.done;y=g.next()){var x=y.value;f.call(u,x,d++,this)}}catch(m){h={error:m}}finally{try{y&&!y.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}},l.prototype.get=function(f,u,h){if(!s.isString(u))return Reflect.get(f,u,h);var p=Number(u);return isNaN(p)?Reflect.get(f,u,h):f._items[p]||void 0},l.prototype.set=function(f,u,h,p){if(!s.isString(u))return Reflect.set(f,u,h,p);var d=Number(u);return isNaN(d)?Reflect.set(f,u,h,p):d>=0&&d<f._items.length&&(f._items[d]=h,!0)},l._create=function(f,u){var h=new l(f);return h._items=u,h},l}();r.NodeListStaticImpl=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(9),c=i(0),l=function(f){function u(h){var p=f.call(this)||this;return p._element=h,Object.setPrototypeOf(p,u.prototype),p}return o(u,f),u.prototype._asArray=function(){return this},u.prototype.item=function(h){return this[h]||null},u.prototype.getNamedItem=function(h){return c.element_getAnAttributeByName(h,this._element)},u.prototype.getNamedItemNS=function(h,p){return c.element_getAnAttributeByNamespaceAndLocalName(h||"",p,this._element)},u.prototype.setNamedItem=function(h){return c.element_setAnAttribute(h,this._element)},u.prototype.setNamedItemNS=function(h){return c.element_setAnAttribute(h,this._element)},u.prototype.removeNamedItem=function(h){var p=c.element_removeAnAttributeByName(h,this._element);if(p===null)throw new s.NotFoundError;return p},u.prototype.removeNamedItemNS=function(h,p){var d=c.element_removeAnAttributeByNamespaceAndLocalName(h||"",p,this._element);if(d===null)throw new s.NotFoundError;return d},u._create=function(h){return new u(h)},u}(Array);r.NamedNodeMapImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(y,x){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,v){m.__proto__=v}||function(m,v){for(var w in v)v.hasOwnProperty(w)&&(m[w]=v[w])})(y,x)},function(y,x){function m(){this.constructor=y}a(y,x),y.prototype=x===null?Object.create(x):(m.prototype=x.prototype,new m)}),s=this&&this.__values||function(y){var x=typeof Symbol=="function"&&Symbol.iterator,m=x&&y[x],v=0;if(m)return m.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&v>=y.length&&(y=void 0),{value:y&&y[v++],done:!y}}};throw new TypeError(x?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(6),l=i(2),f=i(102),u=i(9),h=i(0),p=i(12),d=i(3),g=function(y){function x(){var m=y.call(this)||this,v=c.dom.window._associatedDocument;return m._start=[v,0],m._end=[v,0],c.dom.rangeList.add(m),m}return o(x,y),Object.defineProperty(x.prototype,"commonAncestorContainer",{get:function(){for(var m=this._start[0];!h.tree_isAncestorOf(this._end[0],m,!0);){if(m._parent===null)throw new Error("Parent node  is null.");m=m._parent}return m},enumerable:!0,configurable:!0}),x.prototype.setStart=function(m,v){h.range_setTheStart(this,m,v)},x.prototype.setEnd=function(m,v){h.range_setTheEnd(this,m,v)},x.prototype.setStartBefore=function(m){var v=m._parent;if(v===null)throw new u.InvalidNodeTypeError;h.range_setTheStart(this,v,h.tree_index(m))},x.prototype.setStartAfter=function(m){var v=m._parent;if(v===null)throw new u.InvalidNodeTypeError;h.range_setTheStart(this,v,h.tree_index(m)+1)},x.prototype.setEndBefore=function(m){var v=m._parent;if(v===null)throw new u.InvalidNodeTypeError;h.range_setTheEnd(this,v,h.tree_index(m))},x.prototype.setEndAfter=function(m){var v=m._parent;if(v===null)throw new u.InvalidNodeTypeError;h.range_setTheEnd(this,v,h.tree_index(m)+1)},x.prototype.collapse=function(m){m?this._end=this._start:this._start=this._end},x.prototype.selectNode=function(m){h.range_select(m,this)},x.prototype.selectNodeContents=function(m){if(d.Guard.isDocumentTypeNode(m))throw new u.InvalidNodeTypeError;var v=h.tree_nodeLength(m);this._start=[m,0],this._end=[m,v]},x.prototype.compareBoundaryPoints=function(m,v){if(m!==l.HowToCompare.StartToStart&&m!==l.HowToCompare.StartToEnd&&m!==l.HowToCompare.EndToEnd&&m!==l.HowToCompare.EndToStart)throw new u.NotSupportedError;if(h.range_root(this)!==h.range_root(v))throw new u.WrongDocumentError;var w,C;switch(m){case l.HowToCompare.StartToStart:w=this._start,C=v._start;break;case l.HowToCompare.StartToEnd:w=this._end,C=v._start;break;case l.HowToCompare.EndToEnd:w=this._end,C=v._end;break;case l.HowToCompare.EndToStart:w=this._start,C=v._end;break;default:throw new u.NotSupportedError}var T=h.boundaryPoint_position(w,C);return T===l.BoundaryPosition.Before?-1:T===l.BoundaryPosition.After?1:0},x.prototype.deleteContents=function(){var m,v,w,C;if(!h.range_collapsed(this)){var T=this._startNode,_=this._startOffset,S=this._endNode,b=this._endOffset;if(T===S&&d.Guard.isCharacterDataNode(T))h.characterData_replaceData(T,_,b-_,"");else{var D,E,R=[];try{for(var F=s(h.range_getContainedNodes(this)),M=F.next();!M.done;M=F.next()){var U=(B=M.value)._parent;U!==null&&h.range_isContained(U,this)||R.push(B)}}catch(j){m={error:j}}finally{try{M&&!M.done&&(v=F.return)&&v.call(F)}finally{if(m)throw m.error}}if(h.tree_isAncestorOf(S,T,!0))D=T,E=_;else{for(var z=T;z._parent!==null&&!h.tree_isAncestorOf(S,z._parent,!0);)z=z._parent;if(z._parent===null)throw new Error("Parent node is null.");D=z._parent,E=h.tree_index(z)+1}d.Guard.isCharacterDataNode(T)&&h.characterData_replaceData(T,_,h.tree_nodeLength(T)-_,"");try{for(var Y=s(R),W=Y.next();!W.done;W=Y.next()){var B;(B=W.value)._parent&&h.mutation_remove(B,B._parent)}}catch(j){w={error:j}}finally{try{W&&!W.done&&(C=Y.return)&&C.call(Y)}finally{if(w)throw w.error}}d.Guard.isCharacterDataNode(S)&&h.characterData_replaceData(S,0,b,""),this._start=[D,E],this._end=[D,E]}}},x.prototype.extractContents=function(){return h.range_extract(this)},x.prototype.cloneContents=function(){return h.range_cloneTheContents(this)},x.prototype.insertNode=function(m){return h.range_insert(m,this)},x.prototype.surroundContents=function(m){var v,w;try{for(var C=s(h.range_getPartiallyContainedNodes(this)),T=C.next();!T.done;T=C.next()){var _=T.value;if(!d.Guard.isTextNode(_))throw new u.InvalidStateError}}catch(b){v={error:b}}finally{try{T&&!T.done&&(w=C.return)&&w.call(C)}finally{if(v)throw v.error}}if(d.Guard.isDocumentNode(m)||d.Guard.isDocumentTypeNode(m)||d.Guard.isDocumentFragmentNode(m))throw new u.InvalidNodeTypeError;var S=h.range_extract(this);m._children.size!==0&&h.mutation_replaceAll(null,m),h.range_insert(m,this),h.mutation_append(S,m),h.range_select(m,this)},x.prototype.cloneRange=function(){return h.create_range(this._start,this._end)},x.prototype.detach=function(){c.dom.rangeList.delete(this)},x.prototype.isPointInRange=function(m,v){if(h.tree_rootNode(m)!==h.range_root(this))return!1;if(d.Guard.isDocumentTypeNode(m))throw new u.InvalidNodeTypeError;if(v>h.tree_nodeLength(m))throw new u.IndexSizeError;var w=[m,v];return h.boundaryPoint_position(w,this._start)!==l.BoundaryPosition.Before&&h.boundaryPoint_position(w,this._end)!==l.BoundaryPosition.After},x.prototype.comparePoint=function(m,v){if(h.tree_rootNode(m)!==h.range_root(this))throw new u.WrongDocumentError;if(d.Guard.isDocumentTypeNode(m))throw new u.InvalidNodeTypeError;if(v>h.tree_nodeLength(m))throw new u.IndexSizeError;var w=[m,v];return h.boundaryPoint_position(w,this._start)===l.BoundaryPosition.Before?-1:h.boundaryPoint_position(w,this._end)===l.BoundaryPosition.After?1:0},x.prototype.intersectsNode=function(m){if(h.tree_rootNode(m)!==h.range_root(this))return!1;var v=m._parent;if(v===null)return!0;var w=h.tree_index(m);return h.boundaryPoint_position([v,w],this._end)===l.BoundaryPosition.Before&&h.boundaryPoint_position([v,w+1],this._start)===l.BoundaryPosition.After},x.prototype.toString=function(){var m,v,w="";if(this._startNode===this._endNode&&d.Guard.isTextNode(this._startNode))return this._startNode._data.substring(this._startOffset,this._endOffset);d.Guard.isTextNode(this._startNode)&&(w+=this._startNode._data.substring(this._startOffset));try{for(var C=s(h.range_getContainedNodes(this)),T=C.next();!T.done;T=C.next()){var _=T.value;d.Guard.isTextNode(_)&&(w+=_._data)}}catch(S){m={error:S}}finally{try{T&&!T.done&&(v=C.return)&&v.call(C)}finally{if(m)throw m.error}}return d.Guard.isTextNode(this._endNode)&&(w+=this._endNode._data.substring(0,this._endOffset)),w},x._create=function(m,v){var w=new x;return m&&(w._start=m),v&&(w._end=v),w},x.START_TO_START=0,x.START_TO_END=1,x.END_TO_END=2,x.END_TO_START=3,x}(f.AbstractRangeImpl);r.RangeImpl=g,p.idl_defineConst(g.prototype,"START_TO_START",0),p.idl_defineConst(g.prototype,"START_TO_END",1),p.idl_defineConst(g.prototype,"END_TO_END",2),p.idl_defineConst(g.prototype,"END_TO_START",3)},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(103),c=i(0),l=function(f){function u(h,p,d){var g=f.call(this,h)||this;return g._iteratorCollection=void 0,g._reference=p,g._pointerBeforeReference=d,c.nodeIterator_iteratorList().add(g),g}return o(u,f),Object.defineProperty(u.prototype,"referenceNode",{get:function(){return this._reference},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"pointerBeforeReferenceNode",{get:function(){return this._pointerBeforeReference},enumerable:!0,configurable:!0}),u.prototype.nextNode=function(){return c.nodeIterator_traverse(this,!0)},u.prototype.previousNode=function(){return c.nodeIterator_traverse(this,!1)},u.prototype.detach=function(){c.nodeIterator_iteratorList().delete(this)},u._create=function(h,p,d){return new u(h,p,d)},u}(s.TraverserImpl);r.NodeIteratorImpl=l},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(2),c=i(103),l=i(0),f=function(u){function h(p,d){var g=u.call(this,p)||this;return g._current=d,g}return o(h,u),Object.defineProperty(h.prototype,"currentNode",{get:function(){return this._current},set:function(p){this._current=p},enumerable:!0,configurable:!0}),h.prototype.parentNode=function(){for(var p=this._current;p!==null&&p!==this._root;)if((p=p._parent)!==null&&l.traversal_filter(this,p)===s.FilterResult.Accept)return this._current=p,p;return null},h.prototype.firstChild=function(){return l.treeWalker_traverseChildren(this,!0)},h.prototype.lastChild=function(){return l.treeWalker_traverseChildren(this,!1)},h.prototype.nextSibling=function(){return l.treeWalker_traverseSiblings(this,!0)},h.prototype.previousNode=function(){for(var p=this._current;p!==this._root;){for(var d=p._previousSibling;d;){p=d;for(var g=l.traversal_filter(this,p);g!==s.FilterResult.Reject&&p._lastChild;)p=p._lastChild,g=l.traversal_filter(this,p);if(g===s.FilterResult.Accept)return this._current=p,p;d=p._previousSibling}if(p===this._root||p._parent===null)return null;if(p=p._parent,l.traversal_filter(this,p)===s.FilterResult.Accept)return this._current=p,p}return null},h.prototype.previousSibling=function(){return l.treeWalker_traverseSiblings(this,!1)},h.prototype.nextNode=function(){for(var p=this._current,d=s.FilterResult.Accept;;){for(;d!==s.FilterResult.Reject&&p._firstChild;)if(p=p._firstChild,(d=l.traversal_filter(this,p))===s.FilterResult.Accept)return this._current=p,p;for(var g=null,y=p;y!==null;){if(y===this._root)return null;if((g=y._nextSibling)!==null){p=g;break}y=y._parent}if((d=l.traversal_filter(this,p))===s.FilterResult.Accept)return this._current=p,p}},h._create=function(p,d){return new h(p,d)},h}(c.TraverserImpl);r.TreeWalkerImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(12),s=function(){function c(){}return c.prototype.acceptNode=function(l){return a.FilterResult.Accept},c._create=function(){return new c},c.FILTER_ACCEPT=1,c.FILTER_REJECT=2,c.FILTER_SKIP=3,c.SHOW_ALL=4294967295,c.SHOW_ELEMENT=1,c.SHOW_ATTRIBUTE=2,c.SHOW_TEXT=4,c.SHOW_CDATA_SECTION=8,c.SHOW_ENTITY_REFERENCE=16,c.SHOW_ENTITY=32,c.SHOW_PROCESSING_INSTRUCTION=64,c.SHOW_COMMENT=128,c.SHOW_DOCUMENT=256,c.SHOW_DOCUMENT_TYPE=512,c.SHOW_DOCUMENT_FRAGMENT=1024,c.SHOW_NOTATION=2048,c}();r.NodeFilterImpl=s,o.idl_defineConst(s.prototype,"FILTER_ACCEPT",1),o.idl_defineConst(s.prototype,"FILTER_REJECT",2),o.idl_defineConst(s.prototype,"FILTER_SKIP",3),o.idl_defineConst(s.prototype,"SHOW_ALL",4294967295),o.idl_defineConst(s.prototype,"SHOW_ELEMENT",1),o.idl_defineConst(s.prototype,"SHOW_ATTRIBUTE",2),o.idl_defineConst(s.prototype,"SHOW_TEXT",4),o.idl_defineConst(s.prototype,"SHOW_CDATA_SECTION",8),o.idl_defineConst(s.prototype,"SHOW_ENTITY_REFERENCE",16),o.idl_defineConst(s.prototype,"SHOW_ENTITY",32),o.idl_defineConst(s.prototype,"SHOW_PROCESSING_INSTRUCTION",64),o.idl_defineConst(s.prototype,"SHOW_COMMENT",128),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT",256),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_TYPE",512),o.idl_defineConst(s.prototype,"SHOW_DOCUMENT_FRAGMENT",1024),o.idl_defineConst(s.prototype,"SHOW_NOTATION",2048)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(s,c,l,f,u,h,p,d,g){this._type=s,this._target=c,this._addedNodes=l,this._removedNodes=f,this._previousSibling=u,this._nextSibling=h,this._attributeName=p,this._attributeNamespace=d,this._oldValue=g}return Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"addedNodes",{get:function(){return this._addedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"removedNodes",{get:function(){return this._removedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeName",{get:function(){return this._attributeName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributeNamespace",{get:function(){return this._attributeNamespace},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"oldValue",{get:function(){return this._oldValue},enumerable:!0,configurable:!0}),o._create=function(s,c,l,f,u,h,p,d,g){return new o(s,c,l,f,u,h,p,d,g)},o}();r.MutationRecordImpl=a},function(n,r,i){var a=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(9),c=i(7),l=i(0),f=function(){function u(h,p){this._element=h,this._attribute=p,this._tokenSet=new Set;var d=p._localName,g=l.element_getAnAttributeValue(h,d),y=this;this._element._attributeChangeSteps.push(function(x,m,v,w,C){m===y._attribute._localName&&C===null&&(w?y._tokenSet=l.orderedSet_parse(w):y._tokenSet.clear())}),o.dom.features.steps&&l.dom_runAttributeChangeSteps(h,d,g,g,null)}return Object.defineProperty(u.prototype,"length",{get:function(){return this._tokenSet.size},enumerable:!0,configurable:!0}),u.prototype.item=function(h){var p,d,g=0;try{for(var y=a(this._tokenSet),x=y.next();!x.done;x=y.next()){var m=x.value;if(g===h)return m;g++}}catch(v){p={error:v}}finally{try{x&&!x.done&&(d=y.return)&&d.call(y)}finally{if(p)throw p.error}}return null},u.prototype.contains=function(h){return this._tokenSet.has(h)},u.prototype.add=function(){for(var h,p,d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];try{for(var y=a(d),x=y.next();!x.done;x=y.next()){var m=x.value;if(m==="")throw new s.SyntaxError("Cannot add an empty token.");if(c.codePoint.ASCIIWhiteSpace.test(m))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.add(m)}}catch(v){h={error:v}}finally{try{x&&!x.done&&(p=y.return)&&p.call(y)}finally{if(h)throw h.error}}l.tokenList_updateSteps(this)},u.prototype.remove=function(){for(var h,p,d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];try{for(var y=a(d),x=y.next();!x.done;x=y.next()){var m=x.value;if(m==="")throw new s.SyntaxError("Cannot remove an empty token.");if(c.codePoint.ASCIIWhiteSpace.test(m))throw new s.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.delete(m)}}catch(v){h={error:v}}finally{try{x&&!x.done&&(p=y.return)&&p.call(y)}finally{if(h)throw h.error}}l.tokenList_updateSteps(this)},u.prototype.toggle=function(h,p){if(p===void 0&&(p=void 0),h==="")throw new s.SyntaxError("Cannot toggle an empty token.");if(c.codePoint.ASCIIWhiteSpace.test(h))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return this._tokenSet.has(h)?p!==void 0&&p!==!1||(this._tokenSet.delete(h),l.tokenList_updateSteps(this),!1):(p===void 0||p===!0)&&(this._tokenSet.add(h),l.tokenList_updateSteps(this),!0)},u.prototype.replace=function(h,p){if(h===""||p==="")throw new s.SyntaxError("Cannot replace an empty token.");if(c.codePoint.ASCIIWhiteSpace.test(h)||c.codePoint.ASCIIWhiteSpace.test(p))throw new s.InvalidCharacterError("Token cannot contain whitespace.");return!!this._tokenSet.has(h)&&(c.set.replace(this._tokenSet,h,p),l.tokenList_updateSteps(this),!0)},u.prototype.supports=function(h){return l.tokenList_validationSteps(this,h)},Object.defineProperty(u.prototype,"value",{get:function(){return l.tokenList_serializeSteps(this)},set:function(h){l.element_setAnAttributeValue(this._element,this._attribute._localName,h)},enumerable:!0,configurable:!0}),u.prototype[Symbol.iterator]=function(){var h=this._tokenSet[Symbol.iterator]();return{next:function(){return h.next()}}},u._create=function(h,p){return new u(h,p)},u}();r.DOMTokenListImpl=f},function(n,r,i){var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(104),c=i(0),l=function(f){function u(h,p){var d=f.call(this,h,p)||this;return d._detail=null,d._detail=p&&p.detail||null,d}return o(u,f),Object.defineProperty(u.prototype,"detail",{get:function(){return this._detail},enumerable:!0,configurable:!0}),u.prototype.initCustomEvent=function(h,p,d,g){p===void 0&&(p=!1),d===void 0&&(d=!1),g===void 0&&(g=null),this._dispatchFlag||(c.event_initialize(this,h,p,d),this._detail=g)},u}(s.EventImpl);r.CustomEventImpl=l},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(6),o=i(2),s=i(105),c=i(17);r.nodeIterator_traverse=function(l,f){for(var u=l._reference,h=l._pointerBeforeReference;;){if(f)if(h)h=!1;else{var p=c.tree_getFollowingNode(l._root,u);if(!p)return null;u=p}else if(h){var d=c.tree_getPrecedingNode(l.root,u);if(!d)return null;u=d}else h=!0;if(s.traversal_filter(l,u)===o.FilterResult.Accept)break}return l._reference=u,l._pointerBeforeReference=h,u},r.nodeIterator_iteratorList=function(){return a.dom.window._iteratorList}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9),o=i(7),s=i(174);function c(l){if(!s.xml_isName(l))throw new a.InvalidCharacterError("Invalid XML name: "+l);if(!s.xml_isQName(l))throw new a.InvalidCharacterError("Invalid XML qualified name: "+l+".")}r.namespace_validate=c,r.namespace_validateAndExtract=function(l,f){l||(l=null),c(f);var u=f.split(":"),h=u.length===2?u[0]:null,p=u.length===2?u[1]:f;if(h&&l===null)throw new a.NamespaceError("Qualified name includes a prefix but the namespace is null.");if(h==="xml"&&l!==o.namespace.XML)throw new a.NamespaceError('Qualified name includes the "xml" prefix but the namespace is not the XML namespace.');if(l!==o.namespace.XMLNS&&(h==="xmlns"||f==="xmlns"))throw new a.NamespaceError('Qualified name includes the "xmlns" prefix but the namespace is not the XMLNS namespace.');if(l===o.namespace.XMLNS&&h!=="xmlns"&&f!=="xmlns")throw new a.NamespaceError('Qualified name does not include the "xmlns" prefix but the namespace is the XMLNS namespace.');return[l,h,p]},r.namespace_extractQName=function(l){c(l);var f=l.split(":");return[f.length===2?f[0]:null,f.length===2?f[1]:l]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.xml_isName=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s===58||s===95||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533)&&(o===0||!(s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256))){if(s>=55296&&s<=56319&&o<a.length-1){var c=a.charCodeAt(o+1);if(c>=56320&&c<=57343&&(o++,(s=1024*(s-55296)+c-56320+65536)>=65536&&s<=983039))continue}return!1}}return!0},r.xml_isQName=function(a){for(var o=!1,s=0;s<a.length;s++){var c=a.charCodeAt(s);if(!(c>=97&&c<=122||c>=65&&c<=90||c===95||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8204&&c<=8205||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533)&&(s===0||!(c===45||c===46||c>=48&&c<=57||c===183||c>=768&&c<=879||c>=8255&&c<=8256))){if(s===0||c!==58){if(c>=55296&&c<=56319&&s<a.length-1){var l=a.charCodeAt(s+1);if(l>=56320&&l<=57343&&(s++,(c=1024*(c-55296)+l-56320+65536)>=65536&&c<=983039))continue}return!1}if(o||s===a.length-1)return!1;o=!0}}return!0},r.xml_isLegalChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s===9||s===10||s===13||s>=32&&s<=55295||s>=57344&&s<=65533)){if(s>=55296&&s<=56319&&o<a.length-1){var c=a.charCodeAt(o+1);if(c>=56320&&c<=57343&&(o++,(s=1024*(s-55296)+c-56320+65536)>=65536&&s<=1114111))continue}return!1}}return!0},r.xml_isPubidChar=function(a){for(var o=0;o<a.length;o++){var s=a.charCodeAt(o);if(!(s>=97&&s<=122||s>=65&&s<=90||s>=39&&s<=59||s===32||s===13||s===10||s>=35&&s<=37||s===33||s===61||s===63||s===64||s===95))return!1}return!0}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(17);r.boundaryPoint_position=function s(c,l){var f=c[0],u=c[1],h=l[0],p=l[1];if(console.assert(o.tree_rootNode(f)===o.tree_rootNode(h),"Boundary points must share the same root node."),f===h)return u===p?a.BoundaryPosition.Equal:u<p?a.BoundaryPosition.Before:a.BoundaryPosition.After;if(o.tree_isFollowing(h,f)){var d=s([h,p],[f,u]);if(d===a.BoundaryPosition.Before)return a.BoundaryPosition.After;if(d===a.BoundaryPosition.After)return a.BoundaryPosition.Before}if(o.tree_isAncestorOf(h,f)){for(var g=h;!o.tree_isChildOf(f,g);)g._parent!==null&&(g=g._parent);if(o.tree_index(g)<u)return a.BoundaryPosition.After}return a.BoundaryPosition.Before}},function(n,r,i){var a=this&&this.__values||function(d){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&d[g],x=0;if(y)return y.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&x>=d.length&&(d=void 0),{value:d&&d[x++],done:!d}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),c=i(7),l=i(29),f=i(108),u=i(30),h=i(37),p=i(52);r.node_stringReplaceAll=function(d,g){var y=null;d!==""&&(y=l.create_text(g._nodeDocument,d)),h.mutation_replaceAll(y,g)},r.node_clone=function d(g,y,x){var m,v,w,C,T;if(y===void 0&&(y=null),x===void 0&&(x=!1),y===null&&(y=g._nodeDocument),s.Guard.isElementNode(g)){T=p.element_createAnElement(y,g._localName,g._namespace,g._namespacePrefix,g._is,!1);try{for(var _=a(g._attributeList),S=_.next();!S.done;S=_.next()){var b=d(S.value,y);p.element_append(b,T)}}catch(U){m={error:U}}finally{try{S&&!S.done&&(v=_.return)&&v.call(_)}finally{if(m)throw m.error}}}else if(s.Guard.isDocumentNode(g)){var D=l.create_document();D._encoding=g._encoding,D._contentType=g._contentType,D._URL=g._URL,D._origin=g._origin,D._type=g._type,D._mode=g._mode,T=D}else if(s.Guard.isDocumentTypeNode(g))T=l.create_documentType(y,g._name,g._publicId,g._systemId);else if(s.Guard.isAttrNode(g)){var E=l.create_attr(y,g.localName);E._namespace=g._namespace,E._namespacePrefix=g._namespacePrefix,E._value=g._value,T=E}else T=s.Guard.isExclusiveTextNode(g)?l.create_text(y,g._data):s.Guard.isCDATASectionNode(g)?l.create_cdataSection(y,g._data):s.Guard.isCommentNode(g)?l.create_comment(y,g._data):s.Guard.isProcessingInstructionNode(g)?l.create_processingInstruction(y,g._target,g._data):s.Guard.isDocumentFragmentNode(g)?l.create_documentFragment(y):Object.create(g);if(s.Guard.isDocumentNode(T)?(T._nodeDocument=T,y=T):T._nodeDocument=y,o.dom.features.steps&&u.dom_runCloningSteps(T,g,y,x),x)try{for(var R=a(g._children),F=R.next();!F.done;F=R.next()){var M=d(F.value,y,!0);h.mutation_append(M,T)}}catch(U){w={error:U}}finally{try{F&&!F.done&&(C=R.return)&&C.call(R)}finally{if(w)throw w.error}}return T},r.node_equals=function d(g,y){var x,m,v,w;if(g._nodeType!==y._nodeType)return!1;if(s.Guard.isDocumentTypeNode(g)&&s.Guard.isDocumentTypeNode(y)){if(g._name!==y._name||g._publicId!==y._publicId||g._systemId!==y._systemId)return!1}else if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(y)){if(g._namespace!==y._namespace||g._namespacePrefix!==y._namespacePrefix||g._localName!==y._localName||g._attributeList.length!==y._attributeList.length)return!1}else if(s.Guard.isAttrNode(g)&&s.Guard.isAttrNode(y)){if(g._namespace!==y._namespace||g._localName!==y._localName||g._value!==y._value)return!1}else if(s.Guard.isProcessingInstructionNode(g)&&s.Guard.isProcessingInstructionNode(y)){if(g._target!==y._target||g._data!==y._data)return!1}else if(s.Guard.isCharacterDataNode(g)&&s.Guard.isCharacterDataNode(y)&&g._data!==y._data)return!1;if(s.Guard.isElementNode(g)&&s.Guard.isElementNode(y)){var C={};try{for(var T=a(g._attributeList),_=T.next();!_.done;_=T.next())C[(D=_.value)._localName]=D}catch(z){x={error:z}}finally{try{_&&!_.done&&(m=T.return)&&m.call(T)}finally{if(x)throw x.error}}try{for(var S=a(y._attributeList),b=S.next();!b.done;b=S.next()){var D,E=b.value;if(!(D=C[E._localName])||!d(D,E))return!1}}catch(z){v={error:z}}finally{try{b&&!b.done&&(w=S.return)&&w.call(S)}finally{if(v)throw v.error}}}if(g._children.size!==y._children.size)return!1;for(var R=g._children[Symbol.iterator](),F=y._children[Symbol.iterator](),M=R.next(),U=F.next();!M.done&&!U.done;){if(!d(M.value,U.value))return!1;M=R.next(),U=F.next()}return!0},r.node_listOfElementsWithQualifiedName=function(d,g){return d==="*"?l.create_htmlCollection(g):g._nodeDocument._type==="html"?l.create_htmlCollection(g,function(y){return y._namespace===c.namespace.HTML&&y._qualifiedName===d.toLowerCase()||y._namespace!==c.namespace.HTML&&y._qualifiedName===d}):l.create_htmlCollection(g,function(y){return y._qualifiedName===d})},r.node_listOfElementsWithNamespace=function(d,g,y){return d===""&&(d=null),d==="*"&&g==="*"?l.create_htmlCollection(y):d==="*"?l.create_htmlCollection(y,function(x){return x._localName===g}):g==="*"?l.create_htmlCollection(y,function(x){return x._namespace===d}):l.create_htmlCollection(y,function(x){return x._localName===g&&x._namespace===d})},r.node_listOfElementsWithClassNames=function(d,g){var y=f.orderedSet_parse(d);if(y.size===0)return l.create_htmlCollection(g,function(){return!1});var x=g._nodeDocument._mode!=="quirks";return l.create_htmlCollection(g,function(m){var v=m.classList;return f.orderedSet_contains(v._tokenSet,y,x)})},r.node_locateANamespacePrefix=function d(g,y){if(g._namespace===y&&g._namespacePrefix!==null)return g._namespacePrefix;for(var x=0;x<g._attributeList.length;x++){var m=g._attributeList[x];if(m._namespacePrefix==="xmlns"&&m._value===y)return m._localName}return g._parent&&s.Guard.isElementNode(g._parent)?d(g._parent,y):null},r.node_locateANamespace=function d(g,y){if(s.Guard.isElementNode(g)){if(g._namespace!==null&&g._namespacePrefix===y)return g._namespace;for(var x=0;x<g._attributeList.length;x++){var m=g._attributeList[x];if(m._namespace===c.namespace.XMLNS&&m._namespacePrefix==="xmlns"&&m._localName===y||y===null&&m._namespace===c.namespace.XMLNS&&m._namespacePrefix===null&&m._localName==="xmlns")return m._value||null}return g.parentElement===null?null:d(g.parentElement,y)}return s.Guard.isDocumentNode(g)?g.documentElement===null?null:d(g.documentElement,y):s.Guard.isDocumentTypeNode(g)||s.Guard.isDocumentFragmentNode(g)?null:s.Guard.isAttrNode(g)?g._element===null?null:d(g._element,y):g._parent&&s.Guard.isElementNode(g._parent)?d(g._parent,y):null}},function(n,r,i){var a=this&&this.__values||function(p){var d=typeof Symbol=="function"&&Symbol.iterator,g=d&&p[d],y=0;if(g)return g.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),c=i(9),l=i(29),f=i(17),u=i(107),h=i(37);r.text_contiguousTextNodes=function(p,d){var g;return d===void 0&&(d=!1),(g={})[Symbol.iterator]=function(){for(var y=p;y&&s.Guard.isTextNode(y._previousSibling);)y=y._previousSibling;return{next:function(){if(y&&!d&&y===p&&(y=s.Guard.isTextNode(y._nextSibling)?y._nextSibling:null),y===null)return{done:!0,value:null};var x={done:!1,value:y};return y=s.Guard.isTextNode(y._nextSibling)?y._nextSibling:null,x}}},g},r.text_contiguousExclusiveTextNodes=function(p,d){var g;return d===void 0&&(d=!1),(g={})[Symbol.iterator]=function(){for(var y=p;y&&s.Guard.isExclusiveTextNode(y._previousSibling);)y=y._previousSibling;return{next:function(){if(y&&!d&&y===p&&(y=s.Guard.isExclusiveTextNode(y._nextSibling)?y._nextSibling:null),y===null)return{done:!0,value:null};var x={done:!1,value:y};return y=s.Guard.isExclusiveTextNode(y._nextSibling)?y._nextSibling:null,x}}},g},r.text_descendantTextContent=function(p){for(var d="",g=f.tree_getFirstDescendantNode(p,!1,!1,function(y){return s.Guard.isTextNode(y)});g!==null;)d+=g._data,g=f.tree_getNextDescendantNode(p,g,!1,!1,function(y){return s.Guard.isTextNode(y)});return d},r.text_split=function(p,d){var g,y,x=p._data.length;if(d>x)throw new c.IndexSizeError;var m=x-d,v=u.characterData_substringData(p,d,m),w=l.create_text(p._nodeDocument,v),C=p._parent;if(C!==null){h.mutation_insert(w,C,p._nextSibling);try{for(var T=a(o.dom.rangeList),_=T.next();!_.done;_=T.next()){var S=_.value;S._start[0]===p&&S._start[1]>d&&(S._start[0]=w,S._start[1]-=d),S._end[0]===p&&S._end[1]>d&&(S._end[0]=w,S._end[1]-=d);var b=f.tree_index(p);S._start[0]===C&&S._start[1]===b+1&&S._start[1]++,S._end[0]===C&&S._end[1]===b+1&&S._end[1]++}}catch(D){g={error:D}}finally{try{_&&!_.done&&(y=T.return)&&y.call(T)}finally{if(g)throw g.error}}}return u.characterData_replaceData(p,d,m,""),w}},function(n,r,i){var a=i(4),o=i(41),s=i(24),c=i(48),l=[].join,f=o!=Object,u=c("join",",");a({target:"Array",proto:!0,forced:f||!u},{join:function(h){return l.call(s(this),h===void 0?",":h)}})},function(n,r,i){var a=i(4),o=i(83),s=String.fromCharCode,c=String.fromCodePoint;a({target:"String",stat:!0,forced:!!c&&c.length!=1},{fromCodePoint:function(l){for(var f,u=[],h=arguments.length,p=0;h>p;){if(f=+arguments[p++],o(f,1114111)!==f)throw RangeError(f+" is not a valid code point");u.push(f<65536?s(f):s(55296+((f-=65536)>>10),f%1024+56320))}return u.join("")}})},function(n,r,i){var a=this&&this.__read||function(c,l){var f=typeof Symbol=="function"&&c[Symbol.iterator];if(!f)return c;var u,h,p=f.call(c),d=[];try{for(;(l===void 0||l-- >0)&&!(u=p.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(f=p.return)&&f.call(p)}finally{if(h)throw h.error}}return d};Object.defineProperty(r,"__esModule",{value:!0});var o=i(111),s=function(){function c(l,f){this._options={skipWhitespaceOnlyText:!1},this.err={line:-1,col:-1,index:-1,str:""},this._str=l,this._index=0,this._length=l.length,f&&(this._options.skipWhitespaceOnlyText=f.skipWhitespaceOnlyText||!1)}return c.prototype.nextToken=function(){if(this.eof())return{type:o.TokenType.EOF};var l=this.skipIfStartsWith("<")?this.openBracket():this.text();return this._options.skipWhitespaceOnlyText&&l.type===o.TokenType.Text&&c.isWhiteSpaceToken(l)&&(l=this.nextToken()),l},c.prototype.openBracket=function(){return this.skipIfStartsWith("?")?this.skipIfStartsWith("xml")?c.isSpace(this._str[this._index])?this.declaration():(this.seek(-3),this.pi()):this.pi():this.skipIfStartsWith("!")?this.skipIfStartsWith("--")?this.comment():this.skipIfStartsWith("[CDATA[")?this.cdata():this.skipIfStartsWith("DOCTYPE")?this.doctype():void this.throwError("Invalid '!' in opening tag."):this.skipIfStartsWith("/")?this.closeTag():this.openTag()},c.prototype.declaration=function(){for(var l="",f="",u="";!this.eof();){if(this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.Declaration,version:l,encoding:f,standalone:u};var h=a(this.attribute(),2),p=h[0],d=h[1];p==="version"?l=d:p==="encoding"?f=d:p==="standalone"?u=d:this.throwError("Invalid attribute name: "+p)}this.throwError("Missing declaration end symbol `?>`")},c.prototype.doctype=function(){var l="",f="";this.skipSpace();var u=this.takeUntil2("[",">",!0);return this.skipSpace(),this.skipIfStartsWith("PUBLIC")?(l=this.quotedString(),f=this.quotedString()):this.skipIfStartsWith("SYSTEM")&&(f=this.quotedString()),this.skipSpace(),this.skipIfStartsWith("[")&&(this.skipUntil("]"),this.skipIfStartsWith("]")||this.throwError("Missing end bracket of DTD internal subset")),this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing doctype end symbol `>`"),{type:o.TokenType.DocType,name:u,pubId:l,sysId:f}},c.prototype.pi=function(){var l=this.takeUntilStartsWith("?>",!0);if(this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.skipSpace(),this.skipIfStartsWith("?>"))return{type:o.TokenType.PI,target:l,data:""};var f=this.takeUntilStartsWith("?>");return this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.seek(2),{type:o.TokenType.PI,target:l,data:f}},c.prototype.text=function(){var l=this.takeUntil("<");return{type:o.TokenType.Text,data:l}},c.prototype.comment=function(){var l=this.takeUntilStartsWith("-->");return this.eof()&&this.throwError("Missing comment end symbol `-->`"),this.seek(3),{type:o.TokenType.Comment,data:l}},c.prototype.cdata=function(){var l=this.takeUntilStartsWith("]]>");return this.eof()&&this.throwError("Missing CDATA end symbol `]>`"),this.seek(3),{type:o.TokenType.CDATA,data:l}},c.prototype.openTag=function(){this.skipSpace();var l=this.takeUntil2(">","/",!0);if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:l,attributes:[],selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:l,attributes:[],selfClosing:!0};for(var f=[];!this.eof();){if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:o.TokenType.Element,name:l,attributes:f,selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:o.TokenType.Element,name:l,attributes:f,selfClosing:!0};var u=this.attribute();f.push(u)}this.throwError("Missing opening element tag end symbol `>`")},c.prototype.closeTag=function(){this.skipSpace();var l=this.takeUntil(">",!0);return this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing closing element tag end symbol `>`"),{type:o.TokenType.ClosingTag,name:l}},c.prototype.attribute=function(){this.skipSpace();var l=this.takeUntil("=",!0);return this.skipSpace(),this.skipIfStartsWith("=")||this.throwError("Missing equals sign before attribute value"),[l,this.quotedString()]},c.prototype.quotedString=function(){this.skipSpace();var l=this.take(1);c.isQuote(l)||this.throwError("Missing start quote character before quoted value");var f=this.takeUntil(l);return this.skipIfStartsWith(l)||this.throwError("Missing end quote character after quoted value"),f},c.prototype.eof=function(){return this._index>=this._length},c.prototype.skipIfStartsWith=function(l){var f=l.length;if(f===1)return this._str[this._index]===l&&(this._index++,!0);for(var u=0;u<f;u++)if(this._str[this._index+u]!==l[u])return!1;return this._index+=f,!0},c.prototype.seek=function(l){this._index+=l,this._index<0&&(this._index=0),this._index>this._length&&(this._index=this._length)},c.prototype.skipSpace=function(){for(;!this.eof()&&c.isSpace(this._str[this._index]);)this._index++},c.prototype.take=function(l){if(l===1)return this._str[this._index++];var f=this._index;return this.seek(l),this._str.slice(f,this._index)},c.prototype.takeUntil=function(l,f){f===void 0&&(f=!1);for(var u=this._index;this._index<this._length;){var h=this._str[this._index];if(h===l||f&&c.isSpace(h))break;this._index++}return this._str.slice(u,this._index)},c.prototype.takeUntil2=function(l,f,u){u===void 0&&(u=!1);for(var h=this._index;this._index<this._length;){var p=this._str[this._index];if(p===l||p===f||u&&c.isSpace(p))break;this._index++}return this._str.slice(h,this._index)},c.prototype.takeUntilStartsWith=function(l,f){f===void 0&&(f=!1);for(var u=this._index,h=l.length;this._index<this._length;){for(var p=!0,d=0;d<h;d++){var g=this._str[this._index+d],y=l[d];if(f&&c.isSpace(g))return this._str.slice(u,this._index);if(g!==y){this._index++,p=!1;break}}if(p)return this._str.slice(u,this._index)}return this._index=this._length,this._str.slice(u)},c.prototype.skipUntil=function(l){for(;this._index<this._length&&this._str[this._index]!==l;)this._index++},c.isWhiteSpaceToken=function(l){for(var f=l.data,u=0;u<f.length;u++){var h=f[u];if(h!==" "&&h!==`
`&&h!=="\r"&&h!=="	"&&h!=="\f")return!1}return!0},c.isSpace=function(l){return l===" "||l===`
`||l==="\r"||l==="	"},c.isQuote=function(l){return l==='"'||l==="'"},c.prototype.throwError=function(l){for(var f=/\r\n|\r|\n/g,u=null,h=0,p=0,d=this._str.length;(u=f.exec(this._str))!==null&&u!==null;)if(h++,u.index<this._index&&(p=f.lastIndex),u.index>this._index){d=u.index;break}throw this.err={line:h,col:this._index-p,index:this._index,str:this._str.substring(p,d)},new Error(l+`
Index: `+this.err.index+`
Ln: `+this.err.line+", Col: "+this.err.col+`
Input: `+this.err.str)},c.prototype[Symbol.iterator]=function(){return this._index=0,{next:(function(){var l=this.nextToken();return l.type===o.TokenType.EOF?{done:!0,value:null}:{done:!1,value:l}}).bind(this)}},c}();r.XMLStringLexer=s},function(n,r,i){var a=i(39);n.exports=new a({include:[i(182)]})},function(n,r,i){var a=i(39);n.exports=new a({include:[i(113)],implicit:[i(289),i(290),i(291),i(292)]})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(91),o=i(1),s=i(3),c=i(77),l=i(109);function f(d,g){var y=h(d===void 0||u(d)?d:a.DefaultBuilderOptions),x=u(d)?g:d,m=l.createDocument();p(m,y);var v=new c.XMLBuilderImpl(m);return x!==void 0&&v.ele(x),v}function u(d){if(!o.isPlainObject(d))return!1;for(var g in d)if(d.hasOwnProperty(g)&&!a.XMLBuilderOptionKeys.has(g))return!1;return!0}function h(d){d===void 0&&(d={});var g=o.applyDefaults(d,a.DefaultBuilderOptions);if(g.convert.att.length===0||g.convert.ins.length===0||g.convert.text.length===0||g.convert.cdata.length===0||g.convert.comment.length===0)throw new Error("JS object converter strings cannot be zero length.");return g}function p(d,g,y){var x=d;x._xmlBuilderOptions=g,x._isFragment=y}r.builder=function(d,g){var y=h(u(d)?d:a.DefaultBuilderOptions),x=s.Guard.isNode(d)||o.isArray(d)?d:g;if(x===void 0)throw new Error("Invalid arguments.");if(o.isArray(x)){for(var m=[],v=0;v<x.length;v++){var w=new c.XMLBuilderImpl(x[v]);w.set(y),m.push(w)}return m}var C=new c.XMLBuilderImpl(x);return C.set(y),C},r.create=f,r.fragment=function(d,g){var y=h(d===void 0||u(d)?d:a.DefaultBuilderOptions),x=u(d)?g:d,m=l.createDocument();p(m,y,!0);var v=new c.XMLBuilderImpl(m.createDocumentFragment());return x!==void 0&&v.ele(x),v},r.convert=function(d,g,y){var x,m,v;return u(d)&&g!==void 0?(x=d,m=g,v=y):(x=a.DefaultBuilderOptions,m=d,v=g||void 0),f(x,m).end(v)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.builder=a.builder,r.create=a.create,r.fragment=a.fragment,r.convert=a.convert,r.createCB=a.createCB,r.fragmentCB=a.fragmentCB},function(n,r,i){i(31),i(32),i(33),i(191),i(192),i(194),i(64),i(19),i(198),i(199),i(89),i(201),i(65),i(20),i(66),i(22),i(23);var a=this&&this.__read||function(x,m){var v=typeof Symbol=="function"&&x[Symbol.iterator];if(!v)return x;var w,C,T=v.call(x),_=[];try{for(;(m===void 0||m-- >0)&&!(w=T.next()).done;)_.push(w.value)}catch(S){C={error:S}}finally{try{w&&!w.done&&(v=T.return)&&v.call(T)}finally{if(C)throw C.error}}return _},o=this&&this.__values||function(x){var m=typeof Symbol=="function"&&Symbol.iterator,v=m&&x[m],w=0;if(v)return v.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&w>=x.length&&(x=void 0),{value:x&&x[w++],done:!x}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(91),c=i(1),l=i(217),f=i(2),u=i(3),h=i(0),p=i(109),d=i(7),g=i(276),y=function(){function x(m){this._domNode=m}return Object.defineProperty(x.prototype,"node",{get:function(){return this._domNode},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),x.prototype.set=function(m){return this._options=c.applyDefaults(c.applyDefaults(this._options,m,!0),s.DefaultBuilderOptions),this},x.prototype.ele=function(m,v,w){var C,T,_,S,b,D;if(c.isObject(m))return new g.ObjectReader(this._options).parse(this,m);if(m!==null&&/^\s*</.test(m))return new g.XMLReader(this._options).parse(this,m);if(m!==null&&/^\s*[\{\[]/.test(m))return new g.JSONReader(this._options).parse(this,m);if(m!==null&&/^(\s*|(#.*)|(%.*))*---/.test(m))return new g.YAMLReader(this._options).parse(this,m);if((m===null||c.isString(m))&&c.isString(v))S=(C=a([m,v,w],3))[0],b=C[1],D=C[2];else{if(m===null)throw new Error("Element name cannot be null. "+this._debugInfo());S=(T=a([void 0,m,c.isObject(v)?v:void 0],3))[0],b=T[1],D=T[2]}if(D&&(D=c.getValue(D)),S=(_=a(this._extractNamespace(p.sanitizeInput(S,this._options.invalidCharReplacement),p.sanitizeInput(b,this._options.invalidCharReplacement),!0),2))[0],b=_[1],S===void 0){var E=a(h.namespace_extractQName(b),1)[0];S=this.node.lookupNamespaceURI(E)}var R=S!=null?this._doc.createElementNS(S,b):this._doc.createElement(b);this.node.appendChild(R);var F=new x(R),M=this._doc.doctype;if(R===this._doc.documentElement&&M!==null){var U=this._doc.implementation.createDocumentType(this._doc.documentElement.tagName,M.publicId,M.systemId);this._doc.replaceChild(U,M)}return D&&!c.isEmpty(D)&&F.att(D),F},x.prototype.remove=function(){var m=this.up();return m.node.removeChild(this.node),m},x.prototype.att=function(m,v,w){var C,T,_,S,b,D,E=this;if(c.isMap(m)||c.isObject(m))return c.forEachObject(m,function(W,B){return E.att(W,B)},this),this;if(m!=null&&(m=c.getValue(m+"")),v!=null&&(v=c.getValue(v+"")),w!=null&&(w=c.getValue(w+"")),m!==null&&!c.isString(m)||!c.isString(v)||w!==null&&!c.isString(w)){if(!c.isString(m)||v!=null&&!c.isString(v))throw new Error("Attribute name and value not specified. "+this._debugInfo());S=(T=a([void 0,m,v],3))[0],b=T[1],D=T[2]}else S=(C=a([m,v,w],3))[0],b=C[1],D=C[2];if(this._options.keepNullAttributes&&D==null)D="";else if(D==null)return this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be assigned to an element node.");var R=this.node;S=(_=a(this._extractNamespace(S,b,!1),2))[0],b=_[1],b=p.sanitizeInput(b,this._options.invalidCharReplacement),S=p.sanitizeInput(S,this._options.invalidCharReplacement),D=p.sanitizeInput(D,this._options.invalidCharReplacement);var F=a(h.namespace_extractQName(b),2),M=F[0],U=F[1],z=a(h.namespace_extractQName(R.prefix?R.prefix+":"+R.localName:R.localName),1)[0],Y=null;return M==="xmlns"?(S=d.namespace.XMLNS,R.namespaceURI===null&&z===U&&(Y=D)):M===null&&U==="xmlns"&&z===null&&(S=d.namespace.XMLNS,Y=D),Y!==null&&(this._updateNamespace(Y),R=this.node),S!==void 0?R.setAttributeNS(S,b,D):R.setAttribute(b,D),this},x.prototype.removeAtt=function(m,v){var w,C,T=this;if(!u.Guard.isElementNode(this.node))throw new Error("An attribute can only be removed from an element node.");if(m=c.getValue(m),v!==void 0&&(v=c.getValue(v)),m!==null&&v===void 0)C=m;else{if(m!==null&&!c.isString(m)||v===void 0)throw new Error("Attribute namespace must be a string. "+this._debugInfo());w=m,C=v}return c.isArray(C)||c.isSet(C)?c.forEachArray(C,function(_){return w===void 0?T.removeAtt(_):T.removeAtt(w,_)},this):w!==void 0?(C=p.sanitizeInput(C,this._options.invalidCharReplacement),w=p.sanitizeInput(w,this._options.invalidCharReplacement),this.node.removeAttributeNS(w,C)):(C=p.sanitizeInput(C,this._options.invalidCharReplacement),this.node.removeAttribute(C)),this},x.prototype.txt=function(m){if(m==null){if(!this._options.keepNullNodes)return this;m=""}var v=this._doc.createTextNode(p.sanitizeInput(m,this._options.invalidCharReplacement));return this.node.appendChild(v),this},x.prototype.com=function(m){if(m==null){if(!this._options.keepNullNodes)return this;m=""}var v=this._doc.createComment(p.sanitizeInput(m,this._options.invalidCharReplacement));return this.node.appendChild(v),this},x.prototype.dat=function(m){if(m==null){if(!this._options.keepNullNodes)return this;m=""}var v=this._doc.createCDATASection(p.sanitizeInput(m,this._options.invalidCharReplacement));return this.node.appendChild(v),this},x.prototype.ins=function(m,v){var w=this;if(v===void 0&&(v=""),v==null){if(!this._options.keepNullNodes)return this;v=""}if(c.isArray(m)||c.isSet(m))c.forEachArray(m,function(T){var _=(T+="").indexOf(" "),S=_===-1?T:T.substr(0,_),b=_===-1?"":T.substr(_+1);w.ins(S,b)},this);else if(c.isMap(m)||c.isObject(m))c.forEachObject(m,function(T,_){return w.ins(T,_)},this);else{var C=this._doc.createProcessingInstruction(p.sanitizeInput(m,this._options.invalidCharReplacement),p.sanitizeInput(v,this._options.invalidCharReplacement));this.node.appendChild(C)}return this},x.prototype.dec=function(m){return this._options.version=m.version||"1.0",this._options.encoding=m.encoding,this._options.standalone=m.standalone,this},x.prototype.dtd=function(m){var v=p.sanitizeInput(m&&m.name||(this._doc.documentElement?this._doc.documentElement.tagName:"ROOT"),this._options.invalidCharReplacement),w=p.sanitizeInput(m&&m.pubID||"",this._options.invalidCharReplacement),C=p.sanitizeInput(m&&m.sysID||"",this._options.invalidCharReplacement);if(this._doc.documentElement!==null&&v!==this._doc.documentElement.tagName)throw new Error("DocType name does not match document element name.");var T=this._doc.implementation.createDocumentType(v,w,C);return this._doc.doctype!==null?this._doc.replaceChild(T,this._doc.doctype):this._doc.insertBefore(T,this._doc.documentElement),this},x.prototype.import=function(m){var v,w,C=this._domNode,T=this._doc,_=m.node;if(u.Guard.isDocumentNode(_)){var S=_.documentElement;if(S===null)throw new Error("Imported document has no document element node. "+this._debugInfo());var b=T.importNode(S,!0);C.appendChild(b);var D=a(h.namespace_extractQName(b.prefix?b.prefix+":"+b.localName:b.localName),1)[0],E=C.lookupNamespaceURI(D);new x(b)._updateNamespace(E)}else if(u.Guard.isDocumentFragmentNode(_))try{for(var R=o(_.childNodes),F=R.next();!F.done;F=R.next()){var M=F.value;b=T.importNode(M,!0),C.appendChild(b),u.Guard.isElementNode(b)&&(D=a(h.namespace_extractQName(b.prefix?b.prefix+":"+b.localName:b.localName),1)[0],E=C.lookupNamespaceURI(D),new x(b)._updateNamespace(E))}}catch(U){v={error:U}}finally{try{F&&!F.done&&(w=R.return)&&w.call(R)}finally{if(v)throw v.error}}else b=T.importNode(_,!0),C.appendChild(b),u.Guard.isElementNode(b)&&(D=a(h.namespace_extractQName(b.prefix?b.prefix+":"+b.localName:b.localName),1)[0],E=C.lookupNamespaceURI(D),new x(b)._updateNamespace(E));return this},x.prototype.doc=function(){if(this._doc._isFragment){for(var m=this.node;m&&m.nodeType!==f.NodeType.DocumentFragment;)m=m.parentNode;if(m===null)throw new Error("Node has no parent node while searching for document fragment ancestor. "+this._debugInfo());return new x(m)}return new x(this._doc)},x.prototype.root=function(){var m=this._doc.documentElement;if(!m)throw new Error("Document root element is null. "+this._debugInfo());return new x(m)},x.prototype.up=function(){var m=this._domNode.parentNode;if(!m)throw new Error("Parent node is null. "+this._debugInfo());return new x(m)},x.prototype.prev=function(){var m=this._domNode.previousSibling;if(!m)throw new Error("Previous sibling node is null. "+this._debugInfo());return new x(m)},x.prototype.next=function(){var m=this._domNode.nextSibling;if(!m)throw new Error("Next sibling node is null. "+this._debugInfo());return new x(m)},x.prototype.first=function(){var m=this._domNode.firstChild;if(!m)throw new Error("First child node is null. "+this._debugInfo());return new x(m)},x.prototype.last=function(){var m=this._domNode.lastChild;if(!m)throw new Error("Last child node is null. "+this._debugInfo());return new x(m)},x.prototype.each=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,v,w);T[0];){var _=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2]);m.call(C,new x(T[0]),T[1],T[2]),T=_}return this},x.prototype.map=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);var T=[];return this.each(function(_,S,b){return T.push(m.call(C,_,S,b))},v,w),T},x.prototype.reduce=function(m,v,w,C,T){w===void 0&&(w=!1),C===void 0&&(C=!1);var _=v;return this.each(function(S,b,D){return _=m.call(T,_,S,b,D)},w,C),_},x.prototype.find=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,v,w);T[0];){var _=new x(T[0]);if(m.call(C,_,T[1],T[2]))return _;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}},x.prototype.filter=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);var T=[];return this.each(function(_,S,b){m.call(C,_,S,b)&&T.push(_)},v,w),T},x.prototype.every=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,v,w);T[0];){var _=new x(T[0]);if(!m.call(C,_,T[1],T[2]))return!1;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!0},x.prototype.some=function(m,v,w,C){v===void 0&&(v=!1),w===void 0&&(w=!1);for(var T=this._getFirstDescendantNode(this._domNode,v,w);T[0];){var _=new x(T[0]);if(m.call(C,_,T[1],T[2]))return!0;T=this._getNextDescendantNode(this._domNode,T[0],w,T[1],T[2])}return!1},x.prototype.toArray=function(m,v){m===void 0&&(m=!1),v===void 0&&(v=!1);var w=[];return this.each(function(C){return w.push(C)},m,v),w},x.prototype.toString=function(m){return(m=m||{}).format===void 0&&(m.format="xml"),this._serialize(m)},x.prototype.toObject=function(m){return(m=m||{}).format===void 0&&(m.format="object"),this._serialize(m)},x.prototype.end=function(m){return(m=m||{}).format===void 0&&(m.format="xml"),this.doc()._serialize(m)},x.prototype._getFirstDescendantNode=function(m,v,w){return v?[this._domNode,0,0]:w?this._getNextDescendantNode(m,m,w,0,0):[this._domNode.firstChild,0,1]},x.prototype._getNextDescendantNode=function(m,v,w,C,T){if(!w)return m===v?[v.firstChild,0,T+1]:[v.nextSibling,C+1,T];if(v.firstChild)return[v.firstChild,0,T+1];if(v===m)return[null,-1,-1];if(v.nextSibling)return[v.nextSibling,C+1,T];for(var _=v.parentNode;_&&_!==m;){if(_.nextSibling)return[_.nextSibling,h.tree_index(_.nextSibling),T-1];_=_.parentNode,T--}return[null,-1,-1]},x.prototype._serialize=function(m){if(m.format==="xml")return new l.XMLWriter(this._options,m).serialize(this.node);if(m.format==="map")return new l.MapWriter(this._options,m).serialize(this.node);if(m.format==="object")return new l.ObjectWriter(this._options,m).serialize(this.node);if(m.format==="json")return new l.JSONWriter(this._options,m).serialize(this.node);if(m.format==="yaml")return new l.YAMLWriter(this._options,m).serialize(this.node);throw new Error("Invalid writer format: "+m.format+". "+this._debugInfo())},x.prototype._extractNamespace=function(m,v,w){var C=v.indexOf("@");if(C>0&&(m===void 0&&(m=v.slice(C+1)),v=v.slice(0,C)),m===void 0)m=w?this._options.defaultNamespace.ele:this._options.defaultNamespace.att;else if(m!==null&&m[0]==="@"){var T=m.slice(1);if((m=this._options.namespaceAlias[T])===void 0)throw new Error("Namespace alias `"+T+"` is not defined. "+this._debugInfo())}return[m,v]},x.prototype._updateNamespace=function(m){var v,w,C,T,_=this._domNode;if(u.Guard.isElementNode(_)&&m!==null&&_.namespaceURI!==m){var S=a(h.namespace_extractQName(_.prefix?_.prefix+":"+_.localName:_.localName),2),b=S[0],D=S[1],E=h.create_element(this._doc,D,m,b);try{for(var R=o(_.attributes),F=R.next();!F.done;F=R.next()){var M=F.value,U=M.prefix?M.prefix+":"+M.localName:M.localName,z=a(h.namespace_extractQName(U),1)[0],Y=M.namespaceURI;Y===null&&z!==null&&(Y=_.lookupNamespaceURI(z)),Y===null?E.setAttribute(U,M.value):E.setAttributeNS(Y,U,M.value)}}catch(Ee){v={error:Ee}}finally{try{F&&!F.done&&(w=R.return)&&w.call(R)}finally{if(v)throw v.error}}var W=_.parentNode;if(W===null)throw new Error("Parent node is null."+this._debugInfo());W.replaceChild(E,_),this._domNode=E;try{for(var B=o(_.childNodes),j=B.next();!j.done;j=B.next()){var ie=j.value.cloneNode(!0);if(E.appendChild(ie),u.Guard.isElementNode(ie)){var ae=a(h.namespace_extractQName(ie.prefix?ie.prefix+":"+ie.localName:ie.localName),1)[0],fe=E.lookupNamespaceURI(ae);new x(ie)._updateNamespace(fe)}}}catch(Ee){C={error:Ee}}finally{try{j&&!j.done&&(T=B.return)&&T.call(B)}finally{if(C)throw C.error}}}},Object.defineProperty(x.prototype,"_doc",{get:function(){var m=this.node;if(u.Guard.isDocumentNode(m))return m;var v=m.ownerDocument;if(!v)throw new Error("Owner document is null. "+this._debugInfo());return v},enumerable:!0,configurable:!0}),x.prototype._debugInfo=function(m){var v=this.node,w=v.parentNode;m=m||v.nodeName;var C=w?w.nodeName:"";return C?"node: <"+m+">, parent: <"+C+">":"node: <"+m+">"},Object.defineProperty(x.prototype,"_options",{get:function(){var m=this._doc;if(m._xmlBuilderOptions===void 0)throw new Error("Builder options is not set.");return m._xmlBuilderOptions},set:function(m){this._doc._xmlBuilderOptions=m},enumerable:!0,configurable:!0}),x}();r.XMLBuilderImpl=y},function(n,r,i){var a=i(11),o=i(117),s=a.WeakMap;n.exports=typeof s=="function"&&/native code/.test(o(s))},function(n,r,i){var a=i(46),o=i(82),s=i(85),c=i(18);n.exports=a("Reflect","ownKeys")||function(l){var f=o.f(c(l)),u=s.f;return u?f.concat(u(l)):f}},function(n,r,i){var a=i(16),o=i(15),s=i(18),c=i(61);n.exports=a?Object.defineProperties:function(l,f){s(l);for(var u,h=c(f),p=h.length,d=0;p>d;)o.f(l,u=h[d++],f[u]);return l}},function(n,r,i){var a=i(46);n.exports=a("document","documentElement")},function(n,r,i){var a=i(24),o=i(82).f,s={}.toString,c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(l){return c&&s.call(l)=="[object Window]"?function(f){try{return o(f)}catch{return c.slice()}}(l):o(a(l))}},function(n,r,i){var a=i(4),o=i(36).every,s=i(48),c=i(28),l=s("every"),f=c("every");a({target:"Array",proto:!0,forced:!l||!f},{every:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(36).filter,s=i(63),c=i(28),l=s("filter"),f=c("filter");a({target:"Array",proto:!0,forced:!l||!f},{filter:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(46);n.exports=a("navigator","userAgent")||""},function(n,r,i){var a=i(4),o=i(36).find,s=i(130),c=i(28),l=!0,f=c("find");"find"in[]&&Array(1).find(function(){l=!1}),a({target:"Array",proto:!0,forced:l||!f},{find:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),s("find")},function(n,r,i){var a=i(131).IteratorPrototype,o=i(60),s=i(40),c=i(62),l=i(49),f=function(){return this};n.exports=function(u,h,p){var d=h+" Iterator";return u.prototype=o(a,{next:s(1,p)}),c(u,d,!1,!0),l[d]=f,u}},function(n,r,i){var a=i(8);n.exports=!a(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},function(n,r,i){var a=i(13);n.exports=function(o){if(!a(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype");return o}},function(n,r,i){var a=i(4),o=i(36).map,s=i(63),c=i(28),l=s("map"),f=c("map");a({target:"Array",proto:!0,forced:!l||!f},{map:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(4),o=i(200).left,s=i(48),c=i(28),l=s("reduce"),f=c("reduce",{1:0});a({target:"Array",proto:!0,forced:!l||!f},{reduce:function(u){return o(this,u,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(127),o=i(27),s=i(41),c=i(26),l=function(f){return function(u,h,p,d){a(h);var g=o(u),y=s(g),x=c(g.length),m=f?x-1:0,v=f?-1:1;if(p<2)for(;;){if(m in y){d=y[m],m+=v;break}if(m+=v,f?m<0:x<=m)throw TypeError("Reduce of empty array with no initial value")}for(;f?m>=0:x>m;m+=v)m in y&&(d=h(d,y[m],m,g));return d}};n.exports={left:l(!1),right:l(!0)}},function(n,r,i){var a=i(4),o=i(36).some,s=i(48),c=i(28),l=s("some"),f=c("some");a({target:"Array",proto:!0,forced:!l||!f},{some:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}})},function(n,r,i){var a=i(90),o=i(135);n.exports=a?{}.toString:function(){return"[object "+o(this)+"]"}},function(n,r){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,r,i){var a=i(8);n.exports=!a(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(n,r,i){var a=i(5),o=i(49),s=a("iterator"),c=Array.prototype;n.exports=function(l){return l!==void 0&&(o.Array===l||c[s]===l)}},function(n,r,i){var a=i(135),o=i(49),s=i(5)("iterator");n.exports=function(c){if(c!=null)return c[s]||c["@@iterator"]||o[a(c)]}},function(n,r,i){var a=i(18);n.exports=function(o,s,c,l){try{return l?s(a(c)[0],c[1]):s(c)}catch(u){var f=o.return;throw f!==void 0&&a(f.call(o)),u}}},function(n,r,i){var a=i(5)("iterator"),o=!1;try{var s=0,c={next:function(){return{done:!!s++}},return:function(){o=!0}};c[a]=function(){return this},Array.from(c,function(){throw 2})}catch{}n.exports=function(l,f){if(!f&&!o)return!1;var u=!1;try{var h={};h[a]=function(){return{next:function(){return{done:u=!0}}}},l(h)}catch{}return u}},function(n,r,i){var a=i(13),o=i(133);n.exports=function(s,c,l){var f,u;return o&&typeof(f=c.constructor)=="function"&&f!==l&&a(u=f.prototype)&&u!==l.prototype&&o(s,u),s}},function(n,r,i){var a=i(25);n.exports=function(o,s,c){for(var l in s)a(o,l,s[l],c);return o}},function(n,r,i){var a=i(46),o=i(15),s=i(5),c=i(16),l=s("species");n.exports=function(f){var u=a(f),h=o.f;c&&u&&!u[l]&&h(u,l,{configurable:!0,get:function(){return this}})}},function(n,r,i){var a=this&&this.__generator||function(c,l){var f,u,h,p,d={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(y){return function(x){return function(m){if(f)throw new TypeError("Generator is already executing.");for(;d;)try{if(f=1,u&&(h=2&m[0]?u.return:m[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,m[1])).done)return h;switch(u=0,h&&(m=[2&m[0],h.value]),m[0]){case 0:case 1:h=m;break;case 4:return d.label++,{value:m[1],done:!1};case 5:d.label++,u=m[1],m=[0];continue;case 7:m=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!((h=h.length>0&&h[h.length-1])||m[0]!==6&&m[0]!==2)){d=0;continue}if(m[0]===3&&(!h||m[1]>h[0]&&m[1]<h[3])){d.label=m[1];break}if(m[0]===6&&d.label<h[1]){d.label=h[1],h=m;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(m);break}h[2]&&d.ops.pop(),d.trys.pop();continue}m=l.call(c,d)}catch(v){m=[6,v],u=0}finally{f=h=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([y,x])}}},o=this&&this.__values||function(c){var l=typeof Symbol=="function"&&Symbol.iterator,f=l&&c[l],u=0;if(f)return f.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&u>=c.length&&(c=void 0),{value:c&&c[u++],done:!c}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function c(l){l===void 0&&(l=1e3),this._items=new Set,this._limit=l}return c.prototype.add=function(l){if(this._items.add(l),this._items.size>this._limit){var f=this._items.values().next();f.done||this._items.delete(f.value)}return this},c.prototype.delete=function(l){return this._items.delete(l)},c.prototype.has=function(l){return this._items.has(l)},c.prototype.clear=function(){this._items.clear()},Object.defineProperty(c.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),c.prototype.forEach=function(l,f){var u=this;this._items.forEach(function(h){return l.call(f,h,h,u)})},c.prototype.keys=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.keys())];case 1:return l.sent(),[2]}})},c.prototype.values=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.values())];case 1:return l.sent(),[2]}})},c.prototype.entries=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.entries())];case 1:return l.sent(),[2]}})},c.prototype[Symbol.iterator]=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items)];case 1:return l.sent(),[2]}})},Object.defineProperty(c.prototype,Symbol.toStringTag,{get:function(){return"FixedSizeSet"},enumerable:!0,configurable:!0}),c}();r.FixedSizeSet=s},function(n,r,i){var a=this&&this.__generator||function(c,l){var f,u,h,p,d={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(y){return function(x){return function(m){if(f)throw new TypeError("Generator is already executing.");for(;d;)try{if(f=1,u&&(h=2&m[0]?u.return:m[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,m[1])).done)return h;switch(u=0,h&&(m=[2&m[0],h.value]),m[0]){case 0:case 1:h=m;break;case 4:return d.label++,{value:m[1],done:!1};case 5:d.label++,u=m[1],m=[0];continue;case 7:m=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!((h=h.length>0&&h[h.length-1])||m[0]!==6&&m[0]!==2)){d=0;continue}if(m[0]===3&&(!h||m[1]>h[0]&&m[1]<h[3])){d.label=m[1];break}if(m[0]===6&&d.label<h[1]){d.label=h[1],h=m;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(m);break}h[2]&&d.ops.pop(),d.trys.pop();continue}m=l.call(c,d)}catch(v){m=[6,v],u=0}finally{f=h=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([y,x])}}},o=this&&this.__values||function(c){var l=typeof Symbol=="function"&&Symbol.iterator,f=l&&c[l],u=0;if(f)return f.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&u>=c.length&&(c=void 0),{value:c&&c[u++],done:!c}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function c(l){l===void 0&&(l=1e3),this._items=new Map,this._limit=l}return c.prototype.get=function(l){return this._items.get(l)},c.prototype.set=function(l,f){if(this._items.set(l,f),this._items.size>this._limit){var u=this._items.keys().next();u.done||this._items.delete(u.value)}},c.prototype.delete=function(l){return this._items.delete(l)},c.prototype.has=function(l){return this._items.has(l)},c.prototype.clear=function(){this._items.clear()},Object.defineProperty(c.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),c.prototype.forEach=function(l,f){this._items.forEach(function(u,h){return l.call(f,h,u)})},c.prototype.keys=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.keys())];case 1:return l.sent(),[2]}})},c.prototype.values=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.values())];case 1:return l.sent(),[2]}})},c.prototype.entries=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items.entries())];case 1:return l.sent(),[2]}})},c.prototype[Symbol.iterator]=function(){return a(this,function(l){switch(l.label){case 0:return[5,o(this._items)];case 1:return l.sent(),[2]}})},Object.defineProperty(c.prototype,Symbol.toStringTag,{get:function(){return"ObjectCache"},enumerable:!0,configurable:!0}),c}();r.ObjectCache=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(s){s===void 0&&(s=1e3),this._items=new Map,this._limit=s}return o.prototype.check=function(s,c){if(this._items.get(s)===c)return!0;if(this._items.get(c)===s)return!1;var l=Math.random()<.5;if(l?this._items.set(s,c):this._items.set(c,s),this._items.size>this._limit){var f=this._items.keys().next();f.done||this._items.delete(f.value)}return l},o}();r.CompareCache=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(s){this._initialized=!1,this._value=void 0,this._initFunc=s}return Object.defineProperty(o.prototype,"value",{get:function(){return this._initialized||(this._value=this._initFunc(),this._initialized=!0),this._value},enumerable:!0,configurable:!0}),o}();r.Lazy=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function o(s){this._pointer=0,this._chars=Array.from(s),this._length=this._chars.length}return Object.defineProperty(o.prototype,"eof",{get:function(){return this._pointer>=this._length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),o.prototype.codePoint=function(){if(this._codePoint===void 0)if(this.eof)this._codePoint=-1;else{var s=this._chars[this._pointer].codePointAt(0);this._codePoint=s!==void 0?s:-1}return this._codePoint},o.prototype.c=function(){return this._c===void 0&&(this._c=this.eof?"":this._chars[this._pointer]),this._c},o.prototype.remaining=function(){return this._remaining===void 0&&(this._remaining=this.eof?"":this._chars.slice(this._pointer+1).join("")),this._remaining},o.prototype.substring=function(){return this._substring===void 0&&(this._substring=this.eof?"":this._chars.slice(this._pointer).join("")),this._substring},Object.defineProperty(o.prototype,"pointer",{get:function(){return this._pointer},set:function(s){s!==this._pointer&&(this._pointer=s,this._codePoint=void 0,this._c=void 0,this._remaining=void 0,this._substring=void 0)},enumerable:!0,configurable:!0}),o}();r.StringWalker=a},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(218);r.MapWriter=a.MapWriter;var o=i(258);r.XMLWriter=o.XMLWriter;var s=i(67);r.ObjectWriter=s.ObjectWriter;var c=i(260);r.JSONWriter=c.JSONWriter;var l=i(261);r.YAMLWriter=l.YAMLWriter},function(n,r,i){i(19),i(219),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(f,u){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,p){h.__proto__=p}||function(h,p){for(var d in p)p.hasOwnProperty(d)&&(h[d]=p[d])})(f,u)},function(f,u){function h(){this.constructor=f}a(f,u),f.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),c=i(67),l=function(f){function u(h,p){var d=f.call(this,h)||this;return d._writerOptions=s.applyDefaults(p,{format:"map",wellFormed:!1,group:!1,verbose:!1}),d}return o(u,f),u.prototype.serialize=function(h){var p=s.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1,verbose:!1}),d=new c.ObjectWriter(this._builderOptions,p).serialize(h);return this._convertObject(d)},u.prototype._convertObject=function(h){if(s.isArray(h)){for(var p=0;p<h.length;p++)h[p]=this._convertObject(h[p]);return h}if(s.isObject(h)){var d=new Map;for(var g in h)d.set(g,this._convertObject(h[g]));return d}return h},u}(i(50).BaseWriter);r.MapWriter=l},function(n,r,i){var a=i(139),o=i(143);n.exports=a("Map",function(s){return function(){return s(this,arguments.length?arguments[0]:void 0)}},o)},function(n,r,i){var a=i(4),o=i(8),s=i(59),c=i(13),l=i(27),f=i(26),u=i(134),h=i(128),p=i(63),d=i(5),g=i(129),y=d("isConcatSpreadable"),x=g>=51||!o(function(){var w=[];return w[y]=!1,w.concat()[0]!==w}),m=p("concat"),v=function(w){if(!c(w))return!1;var C=w[y];return C!==void 0?!!C:s(w)};a({target:"Array",proto:!0,forced:!x||!m},{concat:function(w){var C,T,_,S,b,D=l(this),E=h(D,0),R=0;for(C=-1,_=arguments.length;C<_;C++)if(v(b=C===-1?D:arguments[C])){if(R+(S=f(b.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(T=0;T<S;T++,R++)T in b&&u(E,R,b[T])}else{if(R>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(E,R++,b)}return E.length=R,E}})},function(n,r,i){var a=i(8);function o(s,c){return RegExp(s,c)}r.UNSUPPORTED_Y=a(function(){var s=o("a","y");return s.lastIndex=2,s.exec("abcd")!=null}),r.BROKEN_CARET=a(function(){var s=o("^r","gy");return s.lastIndex=2,s.exec("str")!=null})},function(n,r,i){var a=i(223);n.exports=function(o){if(a(o))throw TypeError("The method doesn't accept regular expressions");return o}},function(n,r,i){var a=i(13),o=i(42),s=i(5)("match");n.exports=function(c){var l;return a(c)&&((l=c[s])!==void 0?!!l:o(c)=="RegExp")}},function(n,r,i){var a=i(5)("match");n.exports=function(o){var s=/./;try{"/./"[o](s)}catch{try{return s[a]=!1,"/./"[o](s)}catch{}}return!1}},function(n,r,i){i(68);var a=i(25),o=i(8),s=i(5),c=i(93),l=i(21),f=s("species"),u=!o(function(){var y=/./;return y.exec=function(){var x=[];return x.groups={a:"7"},x},"".replace(y,"$<a>")!=="7"}),h="a".replace(/./,"$0")==="$0",p=s("replace"),d=!!/./[p]&&/./[p]("a","$0")==="",g=!o(function(){var y=/(?:)/,x=y.exec;y.exec=function(){return x.apply(this,arguments)};var m="ab".split(y);return m.length!==2||m[0]!=="a"||m[1]!=="b"});n.exports=function(y,x,m,v){var w=s(y),C=!o(function(){var E={};return E[w]=function(){return 7},""[y](E)!=7}),T=C&&!o(function(){var E=!1,R=/a/;return y==="split"&&((R={}).constructor={},R.constructor[f]=function(){return R},R.flags="",R[w]=/./[w]),R.exec=function(){return E=!0,null},R[w](""),!E});if(!C||!T||y==="replace"&&(!u||!h||d)||y==="split"&&!g){var _=/./[w],S=m(w,""[y],function(E,R,F,M,U){return R.exec===c?C&&!U?{done:!0,value:_.call(R,F,M)}:{done:!0,value:E.call(F,R,M)}:{done:!1}},{REPLACE_KEEPS_$0:h,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),b=S[0],D=S[1];a(String.prototype,y,b),a(RegExp.prototype,w,x==2?function(E,R){return D.call(E,this,R)}:function(E){return D.call(E,this)})}v&&l(RegExp.prototype[w],"sham",!0)}},function(n,r,i){var a=i(137).charAt;n.exports=function(o,s,c){return s+(c?a(o,s).length:1)}},function(n,r,i){var a=i(42),o=i(93);n.exports=function(s,c){var l=s.exec;if(typeof l=="function"){var f=l.call(s,c);if(typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(a(s)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return o.call(s,c)}},function(n,r,i){(function(a){Object.defineProperty(r,"__esModule",{value:!0});var o=i(96);r.forgivingBase64Encode=function(s){return a.from(s).toString("base64")},r.forgivingBase64Decode=function(s){return s===""?"":((s=s.replace(o.ASCIIWhiteSpace,"")).length%4==0&&(s.endsWith("==")?s=s.substr(0,s.length-2):s.endsWith("=")&&(s=s.substr(0,s.length-1))),s.length%4==1?null:/[0-9A-Za-z+/]/.test(s)?a.from(s,"base64").toString("utf8"):null)}}).call(this,i(145).Buffer)},function(n,r,i){r.byteLength=function(p){var d=u(p),g=d[0],y=d[1];return 3*(g+y)/4-y},r.toByteArray=function(p){var d,g,y=u(p),x=y[0],m=y[1],v=new s(function(T,_,S){return 3*(_+S)/4-S}(0,x,m)),w=0,C=m>0?x-4:x;for(g=0;g<C;g+=4)d=o[p.charCodeAt(g)]<<18|o[p.charCodeAt(g+1)]<<12|o[p.charCodeAt(g+2)]<<6|o[p.charCodeAt(g+3)],v[w++]=d>>16&255,v[w++]=d>>8&255,v[w++]=255&d;return m===2&&(d=o[p.charCodeAt(g)]<<2|o[p.charCodeAt(g+1)]>>4,v[w++]=255&d),m===1&&(d=o[p.charCodeAt(g)]<<10|o[p.charCodeAt(g+1)]<<4|o[p.charCodeAt(g+2)]>>2,v[w++]=d>>8&255,v[w++]=255&d),v},r.fromByteArray=function(p){for(var d,g=p.length,y=g%3,x=[],m=0,v=g-y;m<v;m+=16383)x.push(h(p,m,m+16383>v?v:m+16383));return y===1?(d=p[g-1],x.push(a[d>>2]+a[d<<4&63]+"==")):y===2&&(d=(p[g-2]<<8)+p[g-1],x.push(a[d>>10]+a[d>>4&63]+a[d<<2&63]+"=")),x.join("")};for(var a=[],o=[],s=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)a[l]=c[l],o[c.charCodeAt(l)]=l;function u(p){var d=p.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=p.indexOf("=");return g===-1&&(g=d),[g,g===d?0:4-g%4]}function h(p,d,g){for(var y,x,m=[],v=d;v<g;v+=3)y=(p[v]<<16&16711680)+(p[v+1]<<8&65280)+(255&p[v+2]),m.push(a[(x=y)>>18&63]+a[x>>12&63]+a[x>>6&63]+a[63&x]);return m.join("")}o[45]=62,o[95]=63},function(n,r){r.read=function(i,a,o,s,c){var l,f,u=8*c-s-1,h=(1<<u)-1,p=h>>1,d=-7,g=o?c-1:0,y=o?-1:1,x=i[a+g];for(g+=y,l=x&(1<<-d)-1,x>>=-d,d+=u;d>0;l=256*l+i[a+g],g+=y,d-=8);for(f=l&(1<<-d)-1,l>>=-d,d+=s;d>0;f=256*f+i[a+g],g+=y,d-=8);if(l===0)l=1-p;else{if(l===h)return f?NaN:1/0*(x?-1:1);f+=Math.pow(2,s),l-=p}return(x?-1:1)*f*Math.pow(2,l-s)},r.write=function(i,a,o,s,c,l){var f,u,h,p=8*l-c-1,d=(1<<p)-1,g=d>>1,y=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=s?0:l-1,m=s?1:-1,v=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(u=isNaN(a)?1:0,f=d):(f=Math.floor(Math.log(a)/Math.LN2),a*(h=Math.pow(2,-f))<1&&(f--,h*=2),(a+=f+g>=1?y/h:y*Math.pow(2,1-g))*h>=2&&(f++,h/=2),f+g>=d?(u=0,f=d):f+g>=1?(u=(a*h-1)*Math.pow(2,c),f+=g):(u=a*Math.pow(2,g-1)*Math.pow(2,c),f=0));c>=8;i[o+x]=255&u,x+=m,u/=256,c-=8);for(f=f<<c|u,p+=c;p>0;i[o+x]=255&f,x+=m,f/=256,p-=8);i[o+x-m]|=128*v}},function(n,r){var i={}.toString;n.exports=Array.isArray||function(a){return i.call(a)=="[object Array]"}},function(n,r,i){var a=this&&this.__values||function(c){var l=typeof Symbol=="function"&&Symbol.iterator,f=l&&c[l],u=0;if(f)return f.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&u>=c.length&&(c=void 0),{value:c&&c[u++],done:!c}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(c){var l,f;if(c===null||o.isString(c)||o.isNumber(c))return c;if(o.isArray(c)){var u=new Array;try{for(var h=a(c),p=h.next();!p.done;p=h.next()){var d=p.value;u.push(s(d))}}catch(x){l={error:x}}finally{try{p&&!p.done&&(f=h.return)&&f.call(h)}finally{if(l)throw l.error}}return u}if(o.isObject(c)){u=new Map;for(var g in c)if(c.hasOwnProperty(g)){var y=c[g];u.set(g,s(y))}return u}return c}r.parseJSONFromBytes=function(c){var l=o.utf8Decode(c);return JSON.parse.call(void 0,l)},r.serializeJSONToBytes=function(c){var l=JSON.stringify.call(void 0,c);return o.utf8Encode(l)},r.parseJSONIntoInfraValues=function(c){return s(JSON.parse.call(void 0,c))},r.convertAJSONDerivedJavaScriptValueToAnInfraValue=s},function(n,r,i){var a=this&&this.__generator||function(f,u){var h,p,d,g,y={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return g={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function x(m){return function(v){return function(w){if(h)throw new TypeError("Generator is already executing.");for(;y;)try{if(h=1,p&&(d=2&w[0]?p.return:w[0]?p.throw||((d=p.return)&&d.call(p),0):p.next)&&!(d=d.call(p,w[1])).done)return d;switch(p=0,d&&(w=[2&w[0],d.value]),w[0]){case 0:case 1:d=w;break;case 4:return y.label++,{value:w[1],done:!1};case 5:y.label++,p=w[1],w=[0];continue;case 7:w=y.ops.pop(),y.trys.pop();continue;default:if(d=y.trys,!((d=d.length>0&&d[d.length-1])||w[0]!==6&&w[0]!==2)){y=0;continue}if(w[0]===3&&(!d||w[1]>d[0]&&w[1]<d[3])){y.label=w[1];break}if(w[0]===6&&y.label<d[1]){y.label=d[1],d=w;break}if(d&&y.label<d[2]){y.label=d[2],y.ops.push(w);break}d[2]&&y.ops.pop(),y.trys.pop();continue}w=u.call(f,y)}catch(C){w=[6,C],p=0}finally{h=d=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([m,v])}}},o=this&&this.__read||function(f,u){var h=typeof Symbol=="function"&&f[Symbol.iterator];if(!h)return f;var p,d,g=h.call(f),y=[];try{for(;(u===void 0||u-- >0)&&!(p=g.next()).done;)y.push(p.value)}catch(x){d={error:x}}finally{try{p&&!p.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return y},s=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(o(arguments[u]));return f},c=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,h=u&&f[u],p=0;if(h)return h.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&p>=f.length&&(f=void 0),{value:f&&f[p++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(1);r.append=function(f,u){f.push(u)},r.extend=function(f,u){f.push.apply(f,s(u))},r.prepend=function(f,u){f.unshift(u)},r.replace=function(f,u,h){var p,d,g=0;try{for(var y=c(f),x=y.next();!x.done;x=y.next()){var m=x.value;if(l.isFunction(u))u.call(null,m)&&(f[g]=h);else if(m===u)return void(f[g]=h);g++}}catch(v){p={error:v}}finally{try{x&&!x.done&&(d=y.return)&&d.call(y)}finally{if(p)throw p.error}}},r.insert=function(f,u,h){f.splice(h,0,u)},r.remove=function(f,u){for(var h=f.length;h--;){var p=f[h];if(l.isFunction(u))u.call(null,p)&&f.splice(h,1);else if(p===u)return void f.splice(h,1)}},r.empty=function(f){f.length=0},r.contains=function(f,u){var h,p;try{for(var d=c(f),g=d.next();!g.done;g=d.next()){var y=g.value;if(l.isFunction(u)){if(u.call(null,y))return!0}else if(y===u)return!0}}catch(x){h={error:x}}finally{try{g&&!g.done&&(p=d.return)&&p.call(d)}finally{if(h)throw h.error}}return!1},r.size=function(f,u){var h,p;if(u===void 0)return f.length;var d=0;try{for(var g=c(f),y=g.next();!y.done;y=g.next()){var x=y.value;u.call(null,x)&&d++}}catch(m){h={error:m}}finally{try{y&&!y.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return d},r.isEmpty=function(f){return f.length===0},r.forEach=function(f,u){var h,p,d,g,y,x;return a(this,function(m){switch(m.label){case 0:return u!==void 0?[3,2]:[5,c(f)];case 1:return m.sent(),[3,9];case 2:m.trys.push([2,7,8,9]),h=c(f),p=h.next(),m.label=3;case 3:return p.done?[3,6]:(d=p.value,u.call(null,d)?[4,d]:[3,5]);case 4:m.sent(),m.label=5;case 5:return p=h.next(),[3,3];case 6:return[3,9];case 7:return g=m.sent(),y={error:g},[3,9];case 8:try{p&&!p.done&&(x=h.return)&&x.call(h)}finally{if(y)throw y.error}return[7];case 9:return[2]}})},r.clone=function(f){return new(Array.bind.apply(Array,s([void 0],f)))},r.sortInAscendingOrder=function(f,u){return f.sort(function(h,p){return u.call(null,h,p)?-1:1})},r.sortInDescendingOrder=function(f,u){return f.sort(function(h,p){return u.call(null,h,p)?1:-1})}},function(n,r,i){var a=this&&this.__generator||function(f,u){var h,p,d,g,y={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return g={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function x(m){return function(v){return function(w){if(h)throw new TypeError("Generator is already executing.");for(;y;)try{if(h=1,p&&(d=2&w[0]?p.return:w[0]?p.throw||((d=p.return)&&d.call(p),0):p.next)&&!(d=d.call(p,w[1])).done)return d;switch(p=0,d&&(w=[2&w[0],d.value]),w[0]){case 0:case 1:d=w;break;case 4:return y.label++,{value:w[1],done:!1};case 5:y.label++,p=w[1],w=[0];continue;case 7:w=y.ops.pop(),y.trys.pop();continue;default:if(d=y.trys,!((d=d.length>0&&d[d.length-1])||w[0]!==6&&w[0]!==2)){y=0;continue}if(w[0]===3&&(!d||w[1]>d[0]&&w[1]<d[3])){y.label=w[1];break}if(w[0]===6&&y.label<d[1]){y.label=d[1],d=w;break}if(d&&y.label<d[2]){y.label=d[2],y.ops.push(w);break}d[2]&&y.ops.pop(),y.trys.pop();continue}w=u.call(f,y)}catch(C){w=[6,C],p=0}finally{h=d=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([m,v])}}},o=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,h=u&&f[u],p=0;if(h)return h.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&p>=f.length&&(f=void 0),{value:f&&f[p++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(f,u){var h=typeof Symbol=="function"&&f[Symbol.iterator];if(!h)return f;var p,d,g=h.call(f),y=[];try{for(;(u===void 0||u-- >0)&&!(p=g.next()).done;)y.push(p.value)}catch(x){d={error:x}}finally{try{p&&!p.done&&(h=g.return)&&h.call(g)}finally{if(d)throw d.error}}return y},c=this&&this.__spread||function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(s(arguments[u]));return f};Object.defineProperty(r,"__esModule",{value:!0});var l=i(1);r.get=function(f,u){return f.get(u)},r.set=function(f,u,h){f.set(u,h)},r.remove=function(f,u){var h,p,d,g;if(l.isFunction(u)){var y=[];try{for(var x=o(f),m=x.next();!m.done;m=x.next()){var v=m.value;u.call(null,v)&&y.push(v[0])}}catch(_){h={error:_}}finally{try{m&&!m.done&&(p=x.return)&&p.call(x)}finally{if(h)throw h.error}}try{for(var w=o(y),C=w.next();!C.done;C=w.next()){var T=C.value;f.delete(T)}}catch(_){d={error:_}}finally{try{C&&!C.done&&(g=w.return)&&g.call(w)}finally{if(d)throw d.error}}}else f.delete(u)},r.contains=function(f,u){var h,p;if(l.isFunction(u)){try{for(var d=o(f),g=d.next();!g.done;g=d.next()){var y=g.value;if(u.call(null,y))return!0}}catch(x){h={error:x}}finally{try{g&&!g.done&&(p=d.return)&&p.call(d)}finally{if(h)throw h.error}}return!1}return f.has(u)},r.keys=function(f){return new Set(f.keys())},r.values=function(f){return c(f.values())},r.size=function(f,u){var h,p;if(u===void 0)return f.size;var d=0;try{for(var g=o(f),y=g.next();!y.done;y=g.next()){var x=y.value;u.call(null,x)&&d++}}catch(m){h={error:m}}finally{try{y&&!y.done&&(p=g.return)&&p.call(g)}finally{if(h)throw h.error}}return d},r.isEmpty=function(f){return f.size===0},r.forEach=function(f,u){var h,p,d,g,y,x;return a(this,function(m){switch(m.label){case 0:return u!==void 0?[3,2]:[5,o(f)];case 1:return m.sent(),[3,9];case 2:m.trys.push([2,7,8,9]),h=o(f),p=h.next(),m.label=3;case 3:return p.done?[3,6]:(d=p.value,u.call(null,d)?[4,d]:[3,5]);case 4:m.sent(),m.label=5;case 5:return p=h.next(),[3,3];case 6:return[3,9];case 7:return g=m.sent(),y={error:g},[3,9];case 8:try{p&&!p.done&&(x=h.return)&&x.call(h)}finally{if(y)throw y.error}return[7];case 9:return[2]}})},r.clone=function(f){return new Map(f)},r.sortInAscendingOrder=function(f,u){var h=new(Array.bind.apply(Array,c([void 0],f)));return h.sort(function(p,d){return u.call(null,p,d)?-1:1}),new Map(h)},r.sortInDescendingOrder=function(f,u){var h=new(Array.bind.apply(Array,c([void 0],f)));return h.sort(function(p,d){return u.call(null,p,d)?1:-1}),new Map(h)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.HTML="http://www.w3.org/1999/xhtml",r.XML="http://www.w3.org/XML/1998/namespace",r.XMLNS="http://www.w3.org/2000/xmlns/",r.MathML="http://www.w3.org/1998/Math/MathML",r.SVG="http://www.w3.org/2000/svg",r.XLink="http://www.w3.org/1999/xlink"},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.enqueue=function(a,o){a.push(o)},r.dequeue=function(a){return a.shift()||null}},function(n,r,i){var a=this&&this.__generator||function(u,h){var p,d,g,y,x={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return y={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function m(v){return function(w){return function(C){if(p)throw new TypeError("Generator is already executing.");for(;x;)try{if(p=1,d&&(g=2&C[0]?d.return:C[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,C[1])).done)return g;switch(d=0,g&&(C=[2&C[0],g.value]),C[0]){case 0:case 1:g=C;break;case 4:return x.label++,{value:C[1],done:!1};case 5:x.label++,d=C[1],C=[0];continue;case 7:C=x.ops.pop(),x.trys.pop();continue;default:if(g=x.trys,!((g=g.length>0&&g[g.length-1])||C[0]!==6&&C[0]!==2)){x=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){x.label=C[1];break}if(C[0]===6&&x.label<g[1]){x.label=g[1],g=C;break}if(g&&x.label<g[2]){x.label=g[2],x.ops.push(C);break}g[2]&&x.ops.pop(),x.trys.pop();continue}C=h.call(u,x)}catch(T){C=[6,T],d=0}finally{p=g=0}if(5&C[0])throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}([v,w])}}},o=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(u,h){var p=typeof Symbol=="function"&&u[Symbol.iterator];if(!p)return u;var d,g,y=p.call(u),x=[];try{for(;(h===void 0||h-- >0)&&!(d=y.next()).done;)x.push(d.value)}catch(m){g={error:m}}finally{try{d&&!d.done&&(p=y.return)&&p.call(y)}finally{if(g)throw g.error}}return x},c=this&&this.__spread||function(){for(var u=[],h=0;h<arguments.length;h++)u=u.concat(s(arguments[h]));return u};Object.defineProperty(r,"__esModule",{value:!0});var l=i(1);function f(u,h){var p,d;try{for(var g=o(u),y=g.next();!y.done;y=g.next()){var x=y.value;if(!h.has(x))return!1}}catch(m){p={error:m}}finally{try{y&&!y.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return!0}r.append=function(u,h){u.add(h)},r.extend=function(u,h){h.forEach(u.add,u)},r.prepend=function(u,h){var p=new Set(u);u.clear(),u.add(h),p.forEach(u.add,u)},r.replace=function(u,h,p){var d,g,y=new Set;try{for(var x=o(u),m=x.next();!m.done;m=x.next()){var v=m.value;l.isFunction(h)?h.call(null,v)?y.add(p):y.add(v):v===h?y.add(p):y.add(v)}}catch(w){d={error:w}}finally{try{m&&!m.done&&(g=x.return)&&g.call(x)}finally{if(d)throw d.error}}u.clear(),y.forEach(u.add,u)},r.insert=function(u,h,p){var d,g,y=new Set,x=0;try{for(var m=o(u),v=m.next();!v.done;v=m.next()){var w=v.value;x===p&&y.add(h),y.add(w),x++}}catch(C){d={error:C}}finally{try{v&&!v.done&&(g=m.return)&&g.call(m)}finally{if(d)throw d.error}}u.clear(),y.forEach(u.add,u)},r.remove=function(u,h){var p,d,g,y;if(l.isFunction(h)){var x=[];try{for(var m=o(u),v=m.next();!v.done;v=m.next()){var w=v.value;h.call(null,w)&&x.push(w)}}catch(S){p={error:S}}finally{try{v&&!v.done&&(d=m.return)&&d.call(m)}finally{if(p)throw p.error}}try{for(var C=o(x),T=C.next();!T.done;T=C.next()){var _=T.value;u.delete(_)}}catch(S){g={error:S}}finally{try{T&&!T.done&&(y=C.return)&&y.call(C)}finally{if(g)throw g.error}}}else u.delete(h)},r.empty=function(u){u.clear()},r.contains=function(u,h){var p,d;if(!l.isFunction(h))return u.has(h);try{for(var g=o(u),y=g.next();!y.done;y=g.next()){var x=y.value;if(h.call(null,x))return!0}}catch(m){p={error:m}}finally{try{y&&!y.done&&(d=g.return)&&d.call(g)}finally{if(p)throw p.error}}return!1},r.size=function(u,h){var p,d;if(h===void 0)return u.size;var g=0;try{for(var y=o(u),x=y.next();!x.done;x=y.next()){var m=x.value;h.call(null,m)&&g++}}catch(v){p={error:v}}finally{try{x&&!x.done&&(d=y.return)&&d.call(y)}finally{if(p)throw p.error}}return g},r.isEmpty=function(u){return u.size===0},r.forEach=function(u,h){var p,d,g,y,x,m;return a(this,function(v){switch(v.label){case 0:return h!==void 0?[3,2]:[5,o(u)];case 1:return v.sent(),[3,9];case 2:v.trys.push([2,7,8,9]),p=o(u),d=p.next(),v.label=3;case 3:return d.done?[3,6]:(g=d.value,h.call(null,g)?[4,g]:[3,5]);case 4:v.sent(),v.label=5;case 5:return d=p.next(),[3,3];case 6:return[3,9];case 7:return y=v.sent(),x={error:y},[3,9];case 8:try{d&&!d.done&&(m=p.return)&&m.call(p)}finally{if(x)throw x.error}return[7];case 9:return[2]}})},r.clone=function(u){return new Set(u)},r.sortInAscendingOrder=function(u,h){var p=new(Array.bind.apply(Array,c([void 0],u)));return p.sort(function(d,g){return h.call(null,d,g)?-1:1}),new Set(p)},r.sortInDescendingOrder=function(u,h){var p=new(Array.bind.apply(Array,c([void 0],u)));return p.sort(function(d,g){return h.call(null,d,g)?1:-1}),new Set(p)},r.isSubsetOf=f,r.isSupersetOf=function(u,h){return f(h,u)},r.intersection=function(u,h){var p,d,g=new Set;try{for(var y=o(u),x=y.next();!x.done;x=y.next()){var m=x.value;h.has(m)&&g.add(m)}}catch(v){p={error:v}}finally{try{x&&!x.done&&(d=y.return)&&d.call(y)}finally{if(p)throw p.error}}return g},r.union=function(u,h){var p=new Set(u);return h.forEach(p.add,p),p},r.range=function(u,h){for(var p=new Set,d=u;d<=h;d++)p.add(d);return p}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.push=function(a,o){a.push(o)},r.pop=function(a){return a.pop()||null}},function(n,r,i){var a=this&&this.__values||function(x){var m=typeof Symbol=="function"&&Symbol.iterator,v=m&&x[m],w=0;if(v)return v.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&w>=x.length&&(x=void 0),{value:x&&x[w++],done:!x}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(96),s=i(147),c=i(146),l=i(1);function f(x,m){for(var v=0;;){var w=v<x.length?x.charCodeAt(v):null,C=v<m.length?m.charCodeAt(v):null;if(w===null)return!0;if(w!==C)return!1;v++}}function u(x){var m,v,w=Array.from(x),C=new Uint8Array(w.length),T=0;try{for(var _=a(x),S=_.next();!S.done;S=_.next()){var b=S.value.codePointAt(0);console.assert(b!==void 0&&b<=255,"isomorphicEncode requires string bytes to be less than or equal to 0x00FF."),b!==void 0&&b<=255&&(C[T++]=b)}}catch(D){m={error:D}}finally{try{S&&!S.done&&(v=_.return)&&v.call(_)}finally{if(m)throw m.error}}return C}function h(x){return/^[\u0000-\u007F]*$/.test(x)}function p(x){var m,v,w="";try{for(var C=a(x),T=C.next();!T.done;T=C.next()){var _=T.value,S=_.codePointAt(0);w+=S!==void 0&&S>=65&&S<=90?String.fromCodePoint(S+32):_}}catch(b){m={error:b}}finally{try{T&&!T.done&&(v=C.return)&&v.call(C)}finally{if(m)throw m.error}}return w}function d(x){return x.replace(/^[\t\n\f\r ]+/,"").replace(/[\t\n\f\r ]+$/,"")}function g(x,m,v){if(!l.isArray(m))return g(x,Array.from(m),v);for(var w="";v.position<m.length&&x.call(null,m[v.position]);)w+=m[v.position],v.position++;return w}function y(x,m){g(function(v){return o.ASCIIWhiteSpace.test(v)},x,m)}r.isCodeUnitPrefix=f,r.isCodeUnitLessThan=function(x,m){if(f(m,x))return!1;if(f(x,m))return!0;for(var v=0;v<Math.min(x.length,m.length);v++){var w=x.charCodeAt(v),C=m.charCodeAt(v);if(w!==C)return w<C}return!1},r.isomorphicEncode=u,r.isASCIIString=h,r.asciiLowercase=p,r.asciiUppercase=function(x){var m,v,w="";try{for(var C=a(x),T=C.next();!T.done;T=C.next()){var _=T.value,S=_.codePointAt(0);w+=S!==void 0&&S>=97&&S<=122?String.fromCodePoint(S-32):_}}catch(b){m={error:b}}finally{try{T&&!T.done&&(v=C.return)&&v.call(C)}finally{if(m)throw m.error}}return w},r.asciiCaseInsensitiveMatch=function(x,m){return p(x)===p(m)},r.asciiEncode=function(x){return console.assert(h(x),"asciiEncode requires an ASCII string."),u(x)},r.asciiDecode=function(x){var m,v;try{for(var w=a(x),C=w.next();!C.done;C=w.next()){var T=C.value;console.assert(c.isASCIIByte(T),"asciiDecode requires an ASCII byte sequence.")}}catch(_){m={error:_}}finally{try{C&&!C.done&&(v=w.return)&&v.call(w)}finally{if(m)throw m.error}}return s.isomorphicDecode(x)},r.stripNewlines=function(x){return x.replace(/[\n\r]/g,"")},r.normalizeNewlines=function(x){return x.replace(/\r\n/g,`
`).replace(/\r/g,`
`)},r.stripLeadingAndTrailingASCIIWhitespace=d,r.stripAndCollapseASCIIWhitespace=function(x){return d(x.replace(/[\t\n\f\r ]{2,}/g," "))},r.collectASequenceOfCodePoints=g,r.skipASCIIWhitespace=y,r.strictlySplit=function x(m,v){if(!l.isArray(m))return x(Array.from(m),v);var w={position:0},C=[],T=g(function(_){return v!==_},m,w);for(C.push(T);w.position<m.length;)console.assert(m[w.position]===v,"strictlySplit found no delimiter in input string."),w.position++,T=g(function(_){return v!==_},m,w),C.push(T);return C},r.splitAStringOnASCIIWhitespace=function x(m){if(!l.isArray(m))return x(Array.from(m));var v={position:0},w=[];for(y(m,v);v.position<m.length;){var C=g(function(T){return!o.ASCIIWhiteSpace.test(T)},m,v);w.push(C),y(m,v)}return w},r.splitAStringOnCommas=function x(m){if(!l.isArray(m))return x(Array.from(m));for(var v={position:0},w=[];v.position<m.length;){var C=g(function(T){return T!==","},m,v);w.push(d(C)),v.position<m.length&&(console.assert(m[v.position]===",","splitAStringOnCommas found no delimiter in input string."),v.position++)}return w},r.concatenate=function(x,m){return m===void 0&&(m=""),x.length===0?"":x.join(m)}},function(n,r,i){var a=this&&this.__values||function(s){var c=typeof Symbol=="function"&&Symbol.iterator,l=c&&s[c],f=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&f>=s.length&&(s=void 0),{value:s&&s[f++],done:!s}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(97);r.abort_add=function(s,c){c._abortedFlag||c._abortAlgorithms.add(s)},r.abort_remove=function(s,c){c._abortAlgorithms.delete(s)},r.abort_signalAbort=function(s){var c,l;if(!s._abortedFlag){s._abortedFlag=!0;try{for(var f=a(s._abortAlgorithms),u=f.next();!u.done;u=f.next())u.value.call(s)}catch(h){c={error:h}}finally{try{u&&!u.done&&(l=f.return)&&l.call(f)}finally{if(c)throw c.error}}s._abortAlgorithms.clear(),o.event_fireAnEvent("abort",s)}}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(150),o=function(){function s(){}return s.asNode=function(c){if(a.Guard.isNode(c))return c;throw new Error("Invalid object. Node expected.")},s}();r.Cast=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function s(){}return Object.defineProperty(s.prototype,"size",{get:function(){return 0},enumerable:!0,configurable:!0}),s.prototype.add=function(c){throw new Error("Cannot add to an empty set.")},s.prototype.clear=function(){},s.prototype.delete=function(c){return!1},s.prototype.forEach=function(c,l){},s.prototype.has=function(c){return!1},s.prototype[Symbol.iterator]=function(){return new o},s.prototype.entries=function(){return new o},s.prototype.keys=function(){return new o},s.prototype.values=function(){return new o},Object.defineProperty(s.prototype,Symbol.toStringTag,{get:function(){return"EmptySet"},enumerable:!0,configurable:!0}),s}();r.EmptySet=a;var o=function(){function s(){}return s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){return{done:!0,value:null}},s}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),function(a){a[a.SchemeStart=0]="SchemeStart",a[a.Scheme=1]="Scheme",a[a.NoScheme=2]="NoScheme",a[a.SpecialRelativeOrAuthority=3]="SpecialRelativeOrAuthority",a[a.PathOrAuthority=4]="PathOrAuthority",a[a.Relative=5]="Relative",a[a.RelativeSlash=6]="RelativeSlash",a[a.SpecialAuthoritySlashes=7]="SpecialAuthoritySlashes",a[a.SpecialAuthorityIgnoreSlashes=8]="SpecialAuthorityIgnoreSlashes",a[a.Authority=9]="Authority",a[a.Host=10]="Host",a[a.Hostname=11]="Hostname",a[a.Port=12]="Port",a[a.File=13]="File",a[a.FileSlash=14]="FileSlash",a[a.FileHost=15]="FileHost",a[a.PathStart=16]="PathStart",a[a.Path=17]="Path",a[a.CannotBeABaseURLPath=18]="CannotBeABaseURLPath",a[a.Query=19]="Query",a[a.Fragment=20]="Fragment"}(r.ParserState||(r.ParserState={})),r.OpaqueOrigin=["","",null,null]},function(n,r,i){var a=i(245),o=i(247);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=C,r.resolve=function(T,_){return C(T,!1,!0).resolve(_)},r.resolveObject=function(T,_){return T?C(T,!1,!0).resolveObject(_):_},r.format=function(T){return o.isString(T)&&(T=C(T)),T instanceof s?T.format():s.prototype.format.call(T)},r.Url=s;var c=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),h=["'"].concat(u),p=["%","/","?",";","#"].concat(h),d=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=i(248);function C(T,_,S){if(T&&o.isObject(T)&&T instanceof s)return T;var b=new s;return b.parse(T,_,S),b}s.prototype.parse=function(T,_,S){if(!o.isString(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var b=T.indexOf("?"),D=b!==-1&&b<T.indexOf("#")?"?":"#",E=T.split(D);E[0]=E[0].replace(/\\/g,"/");var R=T=E.join(D);if(R=R.trim(),!S&&T.split("#").length===1){var F=f.exec(R);if(F)return this.path=R,this.href=R,this.pathname=F[1],F[2]?(this.search=F[2],this.query=_?w.parse(this.search.substr(1)):this.search.substr(1)):_&&(this.search="",this.query={}),this}var M=c.exec(R);if(M){var U=(M=M[0]).toLowerCase();this.protocol=U,R=R.substr(M.length)}if(S||M||R.match(/^\/\/[^@\/]+@[^@\/]+/)){var z=R.substr(0,2)==="//";!z||M&&m[M]||(R=R.substr(2),this.slashes=!0)}if(!m[M]&&(z||M&&!v[M])){for(var Y,W,B=-1,j=0;j<d.length;j++)(ie=R.indexOf(d[j]))!==-1&&(B===-1||ie<B)&&(B=ie);for((W=B===-1?R.lastIndexOf("@"):R.lastIndexOf("@",B))!==-1&&(Y=R.slice(0,W),R=R.slice(W+1),this.auth=decodeURIComponent(Y)),B=-1,j=0;j<p.length;j++){var ie;(ie=R.indexOf(p[j]))!==-1&&(B===-1||ie<B)&&(B=ie)}B===-1&&(B=R.length),this.host=R.slice(0,B),R=R.slice(B),this.parseHost(),this.hostname=this.hostname||"";var ae=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ae)for(var fe=this.hostname.split(/\./),Ee=(j=0,fe.length);j<Ee;j++){var ge=fe[j];if(ge&&!ge.match(g)){for(var be="",Re=0,Ne=ge.length;Re<Ne;Re++)ge.charCodeAt(Re)>127?be+="x":be+=ge[Re];if(!be.match(g)){var Ce=fe.slice(0,j),P=fe.slice(j+1),O=ge.match(y);O&&(Ce.push(O[1]),P.unshift(O[2])),P.length&&(R="/"+P.join(".")+R),this.hostname=Ce.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ae||(this.hostname=a.toASCII(this.hostname));var A=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+A,this.href+=this.host,ae&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),R[0]!=="/"&&(R="/"+R))}if(!x[U])for(j=0,Ee=h.length;j<Ee;j++){var k=h[j];if(R.indexOf(k)!==-1){var $=encodeURIComponent(k);$===k&&($=escape(k)),R=R.split(k).join($)}}var H=R.indexOf("#");H!==-1&&(this.hash=R.substr(H),R=R.slice(0,H));var se=R.indexOf("?");if(se!==-1?(this.search=R.substr(se),this.query=R.substr(se+1),_&&(this.query=w.parse(this.query)),R=R.slice(0,se)):_&&(this.search="",this.query={}),R&&(this.pathname=R),v[U]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var me=this.search||"";this.path=A+me}return this.href=this.format(),this},s.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var _=this.protocol||"",S=this.pathname||"",b=this.hash||"",D=!1,E="";this.host?D=T+this.host:this.hostname&&(D=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(D+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(E=w.stringify(this.query));var R=this.search||E&&"?"+E||"";return _&&_.substr(-1)!==":"&&(_+=":"),this.slashes||(!_||v[_])&&D!==!1?(D="//"+(D||""),S&&S.charAt(0)!=="/"&&(S="/"+S)):D||(D=""),b&&b.charAt(0)!=="#"&&(b="#"+b),R&&R.charAt(0)!=="?"&&(R="?"+R),_+D+(S=S.replace(/[?#]/g,function(F){return encodeURIComponent(F)}))+(R=R.replace("#","%23"))+b},s.prototype.resolve=function(T){return this.resolveObject(C(T,!1,!0)).format()},s.prototype.resolveObject=function(T){if(o.isString(T)){var _=new s;_.parse(T,!1,!0),T=_}for(var S=new s,b=Object.keys(this),D=0;D<b.length;D++){var E=b[D];S[E]=this[E]}if(S.hash=T.hash,T.href==="")return S.href=S.format(),S;if(T.slashes&&!T.protocol){for(var R=Object.keys(T),F=0;F<R.length;F++){var M=R[F];M!=="protocol"&&(S[M]=T[M])}return v[S.protocol]&&S.hostname&&!S.pathname&&(S.path=S.pathname="/"),S.href=S.format(),S}if(T.protocol&&T.protocol!==S.protocol){if(!v[T.protocol]){for(var U=Object.keys(T),z=0;z<U.length;z++){var Y=U[z];S[Y]=T[Y]}return S.href=S.format(),S}if(S.protocol=T.protocol,T.host||m[T.protocol])S.pathname=T.pathname;else{for(var W=(T.pathname||"").split("/");W.length&&!(T.host=W.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),W[0]!==""&&W.unshift(""),W.length<2&&W.unshift(""),S.pathname=W.join("/")}if(S.search=T.search,S.query=T.query,S.host=T.host||"",S.auth=T.auth,S.hostname=T.hostname||T.host,S.port=T.port,S.pathname||S.search){var B=S.pathname||"",j=S.search||"";S.path=B+j}return S.slashes=S.slashes||T.slashes,S.href=S.format(),S}var ie=S.pathname&&S.pathname.charAt(0)==="/",ae=T.host||T.pathname&&T.pathname.charAt(0)==="/",fe=ae||ie||S.host&&T.pathname,Ee=fe,ge=S.pathname&&S.pathname.split("/")||[],be=(W=T.pathname&&T.pathname.split("/")||[],S.protocol&&!v[S.protocol]);if(be&&(S.hostname="",S.port=null,S.host&&(ge[0]===""?ge[0]=S.host:ge.unshift(S.host)),S.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(W[0]===""?W[0]=T.host:W.unshift(T.host)),T.host=null),fe=fe&&(W[0]===""||ge[0]==="")),ae)S.host=T.host||T.host===""?T.host:S.host,S.hostname=T.hostname||T.hostname===""?T.hostname:S.hostname,S.search=T.search,S.query=T.query,ge=W;else if(W.length)ge||(ge=[]),ge.pop(),ge=ge.concat(W),S.search=T.search,S.query=T.query;else if(!o.isNullOrUndefined(T.search))return be&&(S.hostname=S.host=ge.shift(),(O=!!(S.host&&S.host.indexOf("@")>0)&&S.host.split("@"))&&(S.auth=O.shift(),S.host=S.hostname=O.shift())),S.search=T.search,S.query=T.query,o.isNull(S.pathname)&&o.isNull(S.search)||(S.path=(S.pathname?S.pathname:"")+(S.search?S.search:"")),S.href=S.format(),S;if(!ge.length)return S.pathname=null,S.search?S.path="/"+S.search:S.path=null,S.href=S.format(),S;for(var Re=ge.slice(-1)[0],Ne=(S.host||T.host||ge.length>1)&&(Re==="."||Re==="..")||Re==="",Ce=0,P=ge.length;P>=0;P--)(Re=ge[P])==="."?ge.splice(P,1):Re===".."?(ge.splice(P,1),Ce++):Ce&&(ge.splice(P,1),Ce--);if(!fe&&!Ee)for(;Ce--;Ce)ge.unshift("..");!fe||ge[0]===""||ge[0]&&ge[0].charAt(0)==="/"||ge.unshift(""),Ne&&ge.join("/").substr(-1)!=="/"&&ge.push("");var O,A=ge[0]===""||ge[0]&&ge[0].charAt(0)==="/";return be&&(S.hostname=S.host=A?"":ge.length?ge.shift():"",(O=!!(S.host&&S.host.indexOf("@")>0)&&S.host.split("@"))&&(S.auth=O.shift(),S.host=S.hostname=O.shift())),(fe=fe||S.host&&ge.length)&&!A&&ge.unshift(""),ge.length?S.pathname=ge.join("/"):(S.pathname=null,S.path=null),o.isNull(S.pathname)&&o.isNull(S.search)||(S.path=(S.pathname?S.pathname:"")+(S.search?S.search:"")),S.auth=T.auth||S.auth,S.slashes=S.slashes||T.slashes,S.href=S.format(),S},s.prototype.parseHost=function(){var T=this.host,_=l.exec(T);_&&((_=_[0])!==":"&&(this.port=_.substr(1)),T=T.substr(0,T.length-_.length)),T&&(this.hostname=T)}},function(n,r,i){(function(a,o){var s;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(c){r&&r.nodeType,a&&a.nodeType;var l=typeof o=="object"&&o;l.global!==l&&l.window!==l&&l.self;var f,u=2147483647,h=/^xn--/,p=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=Math.floor,x=String.fromCharCode;function m(E){throw new RangeError(g[E])}function v(E,R){for(var F=E.length,M=[];F--;)M[F]=R(E[F]);return M}function w(E,R){var F=E.split("@"),M="";return F.length>1&&(M=F[0]+"@",E=F[1]),M+v((E=E.replace(d,".")).split("."),R).join(".")}function C(E){for(var R,F,M=[],U=0,z=E.length;U<z;)(R=E.charCodeAt(U++))>=55296&&R<=56319&&U<z?(64512&(F=E.charCodeAt(U++)))==56320?M.push(((1023&R)<<10)+(1023&F)+65536):(M.push(R),U--):M.push(R);return M}function T(E){return v(E,function(R){var F="";return R>65535&&(F+=x((R-=65536)>>>10&1023|55296),R=56320|1023&R),F+=x(R)}).join("")}function _(E,R){return E+22+75*(E<26)-((R!=0)<<5)}function S(E,R,F){var M=0;for(E=F?y(E/700):E>>1,E+=y(E/R);E>455;M+=36)E=y(E/35);return y(M+36*E/(E+38))}function b(E){var R,F,M,U,z,Y,W,B,j,ie,ae,fe=[],Ee=E.length,ge=0,be=128,Re=72;for((F=E.lastIndexOf("-"))<0&&(F=0),M=0;M<F;++M)E.charCodeAt(M)>=128&&m("not-basic"),fe.push(E.charCodeAt(M));for(U=F>0?F+1:0;U<Ee;){for(z=ge,Y=1,W=36;U>=Ee&&m("invalid-input"),((B=(ae=E.charCodeAt(U++))-48<10?ae-22:ae-65<26?ae-65:ae-97<26?ae-97:36)>=36||B>y((u-ge)/Y))&&m("overflow"),ge+=B*Y,!(B<(j=W<=Re?1:W>=Re+26?26:W-Re));W+=36)Y>y(u/(ie=36-j))&&m("overflow"),Y*=ie;Re=S(ge-z,R=fe.length+1,z==0),y(ge/R)>u-be&&m("overflow"),be+=y(ge/R),ge%=R,fe.splice(ge++,0,be)}return T(fe)}function D(E){var R,F,M,U,z,Y,W,B,j,ie,ae,fe,Ee,ge,be,Re=[];for(fe=(E=C(E)).length,R=128,F=0,z=72,Y=0;Y<fe;++Y)(ae=E[Y])<128&&Re.push(x(ae));for(M=U=Re.length,U&&Re.push("-");M<fe;){for(W=u,Y=0;Y<fe;++Y)(ae=E[Y])>=R&&ae<W&&(W=ae);for(W-R>y((u-F)/(Ee=M+1))&&m("overflow"),F+=(W-R)*Ee,R=W,Y=0;Y<fe;++Y)if((ae=E[Y])<R&&++F>u&&m("overflow"),ae==R){for(B=F,j=36;!(B<(ie=j<=z?1:j>=z+26?26:j-z));j+=36)be=B-ie,ge=36-ie,Re.push(x(_(ie+be%ge,0))),B=y(be/ge);Re.push(x(_(B,0))),z=S(F,Ee,M==U),F=0,++M}++F,++R}return Re.join("")}f={version:"1.4.1",ucs2:{decode:C,encode:T},decode:b,encode:D,toASCII:function(E){return w(E,function(R){return p.test(R)?"xn--"+D(R):R})},toUnicode:function(E){return w(E,function(R){return h.test(R)?b(R.slice(4).toLowerCase()):R})}},(s=(function(){return f}).call(r,i,r,a))===void 0||(a.exports=s)})()}).call(this,i(246)(n),i(78))},function(n,r){n.exports=function(i){return i.webpackPolyfill||(i.deprecate=function(){},i.paths=[],i.children||(i.children=[]),Object.defineProperty(i,"loaded",{enumerable:!0,get:function(){return i.l}}),Object.defineProperty(i,"id",{enumerable:!0,get:function(){return i.i}}),i.webpackPolyfill=1),i}},function(n,r,i){n.exports={isString:function(a){return typeof a=="string"},isObject:function(a){return typeof a=="object"&&a!==null},isNull:function(a){return a===null},isNullOrUndefined:function(a){return a==null}}},function(n,r,i){r.decode=r.parse=i(249),r.encode=r.stringify=i(250)},function(n,r,i){function a(s,c){return Object.prototype.hasOwnProperty.call(s,c)}n.exports=function(s,c,l,f){c=c||"&",l=l||"=";var u={};if(typeof s!="string"||s.length===0)return u;var h=/\+/g;s=s.split(c);var p=1e3;f&&typeof f.maxKeys=="number"&&(p=f.maxKeys);var d=s.length;p>0&&d>p&&(d=p);for(var g=0;g<d;++g){var y,x,m,v,w=s[g].replace(h,"%20"),C=w.indexOf(l);C>=0?(y=w.substr(0,C),x=w.substr(C+1)):(y=w,x=""),m=decodeURIComponent(y),v=decodeURIComponent(x),a(u,m)?o(u[m])?u[m].push(v):u[m]=[u[m],v]:u[m]=v}return u};var o=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"}},function(n,r,i){var a=function(l){switch(typeof l){case"string":return l;case"boolean":return l?"true":"false";case"number":return isFinite(l)?l:"";default:return""}};n.exports=function(l,f,u,h){return f=f||"&",u=u||"=",l===null&&(l=void 0),typeof l=="object"?s(c(l),function(p){var d=encodeURIComponent(a(p))+u;return o(l[p])?s(l[p],function(g){return d+encodeURIComponent(a(g))}).join(f):d+encodeURIComponent(a(l[p]))}).join(f):h?encodeURIComponent(a(h))+u+encodeURIComponent(a(l)):""};var o=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function s(l,f){if(l.map)return l.map(f);for(var u=[],h=0;h<l.length;h++)u.push(f(l[h],h));return u}var c=Object.keys||function(l){var f=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&f.push(u);return f}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(52);r.attr_setAnExistingAttributeValue=function(o,s){o._element===null?o._value=s:a.element_change(o,o._element,s)}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(108),o=i(30),s=i(52);r.tokenList_validationSteps=function(c,l){if(!o.dom_hasSupportedTokens(c._attribute._localName))throw new TypeError("There are no supported tokens defined for attribute name: '"+c._attribute._localName+"'.");return o.dom_getSupportedTokens(c._attribute._localName).has(l.toLowerCase())},r.tokenList_updateSteps=function(c){(c._element.hasAttribute(c._attribute._localName)||c._tokenSet.size!==0)&&s.element_setAnAttributeValue(c._element,c._attribute._localName,a.orderedSet_serialize(c._tokenSet))},r.tokenList_serializeSteps=function(c){return s.element_getAnAttributeValue(c._element,c._attribute._localName)}},function(n,r,i){var a=this&&this.__values||function(c){var l=typeof Symbol=="function"&&Symbol.iterator,f=l&&c[l],u=0;if(f)return f.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&u>=c.length&&(c=void 0),{value:c&&c[u++],done:!c}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1);function s(c){return o.isBoolean(c)?c:c.capture||!1}r.eventTarget_flatten=s,r.eventTarget_flattenMore=function(c){var l=s(c),f=!1,u=!1;return o.isBoolean(c)||(f=c.once||!1,u=c.passive||!1),[l,u,f]},r.eventTarget_addEventListener=function(c,l){if(l.callback!==null){for(var f=0;f<c._eventListenerList.length;f++){var u=c._eventListenerList[f];if(u.type===l.type&&u.callback.handleEvent===l.callback.handleEvent&&u.capture===l.capture)return}c._eventListenerList.push(l)}},r.eventTarget_removeEventListener=function(c,l,f){l.removed=!0,c._eventListenerList.splice(f,1)},r.eventTarget_removeAllEventListeners=function(c){var l,f;try{for(var u=a(c._eventListenerList),h=u.next();!h.done;h=u.next())h.value.removed=!0}catch(p){l={error:p}}finally{try{h&&!h.done&&(f=u.return)&&f.call(u)}finally{if(l)throw l.error}}c._eventListenerList.length=0}},function(n,r,i){var a=this&&this.__values||function(c){var l=typeof Symbol=="function"&&Symbol.iterator,f=l&&c[l],u=0;if(f)return f.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&u>=c.length&&(c=void 0),{value:c&&c[u++],done:!c}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),s=i(29);r.parentNode_convertNodesIntoANode=function(c,l){for(var f,u,h=null,p=0;p<c.length;p++){var d=c[p];if(o.isString(d)){var g=s.create_text(l,d);c[p]=g}}if(c.length===1)h=c[0];else{var y=h=s.create_documentFragment(l);try{for(var x=a(c),m=x.next();!m.done;m=x.next())d=m.value,y.appendChild(d)}catch(v){f={error:v}}finally{try{m&&!m.done&&(u=x.return)&&u.call(x)}finally{if(f)throw f.error}}}return h}},function(n,r,i){var a=this&&this.__values||function(_){var S=typeof Symbol=="function"&&Symbol.iterator,b=S&&_[S],D=0;if(b)return b.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&D>=_.length&&(_=void 0),{value:_&&_[D++],done:!_}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(_,S){var b=typeof Symbol=="function"&&_[Symbol.iterator];if(!b)return _;var D,E,R=b.call(_),F=[];try{for(;(S===void 0||S-- >0)&&!(D=R.next()).done;)F.push(D.value)}catch(M){E={error:M}}finally{try{D&&!D.done&&(b=R.return)&&b.call(R)}finally{if(E)throw E.error}}return F},s=this&&this.__spread||function(){for(var _=[],S=0;S<arguments.length;S++)_=_.concat(o(arguments[S]));return _};Object.defineProperty(r,"__esModule",{value:!0});var c=i(2),l=i(9),f=i(3),u=i(29),h=i(17),p=i(175),d=i(107),g=i(176),y=i(37),x=i(177);function m(_){return _._startNode===_._endNode&&_._startOffset===_._endOffset}function v(_){return h.tree_rootNode(_._startNode)}function w(_,S){return h.tree_rootNode(_)===v(S)&&p.boundaryPoint_position([_,0],S._start)===c.BoundaryPosition.After&&p.boundaryPoint_position([_,h.tree_nodeLength(_)],S._end)===c.BoundaryPosition.Before}function C(_,S){var b=h.tree_isAncestorOf(S._startNode,_,!0),D=h.tree_isAncestorOf(S._endNode,_,!0);return b&&!D||!b&&D}function T(_){var S,b,D,E,R,F,M=u.create_documentFragment(_._startNode._nodeDocument);if(m(_))return M;var U=_._startNode,z=_._startOffset,Y=_._endNode,W=_._endOffset;if(U===Y&&f.Guard.isCharacterDataNode(U))return(L=g.node_clone(U))._data=d.characterData_substringData(U,z,W-z),y.mutation_append(L,M),d.characterData_replaceData(U,z,W-z,""),M;for(var B=U;!h.tree_isAncestorOf(Y,B,!0);){if(B._parent===null)throw new Error("Parent node  is null.");B=B._parent}var j=null;if(!h.tree_isAncestorOf(Y,U,!0))try{for(var ie=a(B._children),ae=ie.next();!ae.done;ae=ie.next())if(C(be=ae.value,_)){j=be;break}}catch(me){S={error:me}}finally{try{ae&&!ae.done&&(b=ie.return)&&b.call(ie)}finally{if(S)throw S.error}}var fe=null;if(!h.tree_isAncestorOf(U,Y,!0))for(var Ee=s(B._children),ge=Ee.length-1;ge>0;ge--){var be;if(C(be=Ee[ge],_)){fe=be;break}}var Re,Ne,Ce=[];try{for(var P=a(B._children),O=P.next();!O.done;O=P.next())if(w(se=O.value,_)){if(f.Guard.isDocumentTypeNode(se))throw new l.HierarchyRequestError;Ce.push(se)}}catch(me){D={error:me}}finally{try{O&&!O.done&&(E=P.return)&&E.call(P)}finally{if(D)throw D.error}}if(h.tree_isAncestorOf(Y,U,!0))Re=U,Ne=z;else{for(var A=U;A._parent!==null&&!h.tree_isAncestorOf(Y,A._parent);)A=A._parent;if(A._parent===null)throw new Error("Parent node is null.");Re=A._parent,Ne=1+h.tree_index(A)}if(f.Guard.isCharacterDataNode(j))(L=g.node_clone(U))._data=d.characterData_substringData(U,z,h.tree_nodeLength(U)-z),y.mutation_append(L,M),d.characterData_replaceData(U,z,h.tree_nodeLength(U)-z,"");else if(j!==null){var L=g.node_clone(j);y.mutation_append(L,M);var k=T(u.create_range([U,z],[j,h.tree_nodeLength(j)]));y.mutation_append(k,L)}try{for(var $=a(Ce),H=$.next();!H.done;H=$.next()){var se=H.value;y.mutation_append(se,M)}}catch(me){R={error:me}}finally{try{H&&!H.done&&(F=$.return)&&F.call($)}finally{if(R)throw R.error}}return f.Guard.isCharacterDataNode(fe)?((L=g.node_clone(Y))._data=d.characterData_substringData(Y,0,W),y.mutation_append(L,M),d.characterData_replaceData(Y,0,W,"")):fe!==null&&(L=g.node_clone(fe),y.mutation_append(L,M),k=T(u.create_range([fe,0],[Y,W])),y.mutation_append(k,L)),_._start=[Re,Ne],_._end=[Re,Ne],M}r.range_collapsed=m,r.range_root=v,r.range_isContained=w,r.range_isPartiallyContained=C,r.range_setTheStart=function(_,S,b){if(f.Guard.isDocumentTypeNode(S))throw new l.InvalidNodeTypeError;if(b>h.tree_nodeLength(S))throw new l.IndexSizeError;var D=[S,b];v(_)===h.tree_rootNode(S)&&p.boundaryPoint_position(D,_._end)!==c.BoundaryPosition.After||(_._end=D),_._start=D},r.range_setTheEnd=function(_,S,b){if(f.Guard.isDocumentTypeNode(S))throw new l.InvalidNodeTypeError;if(b>h.tree_nodeLength(S))throw new l.IndexSizeError;var D=[S,b];v(_)===h.tree_rootNode(S)&&p.boundaryPoint_position(D,_._start)!==c.BoundaryPosition.Before||(_._start=D),_._end=D},r.range_select=function(_,S){var b=_._parent;if(b===null)throw new l.InvalidNodeTypeError;var D=h.tree_index(_);S._start=[b,D],S._end=[b,D+1]},r.range_extract=T,r.range_cloneTheContents=function _(S){var b,D,E,R,F,M,U=u.create_documentFragment(S._startNode._nodeDocument);if(m(S))return U;var z=S._startNode,Y=S._startOffset,W=S._endNode,B=S._endOffset;z===W&&f.Guard.isCharacterDataNode(z)&&((O=g.node_clone(z))._data=d.characterData_substringData(z,Y,B-Y),y.mutation_append(O,U));for(var j=z;!h.tree_isAncestorOf(W,j,!0);){if(j._parent===null)throw new Error("Parent node  is null.");j=j._parent}var ie=null;if(!h.tree_isAncestorOf(W,z,!0))try{for(var ae=a(j._children),fe=ae.next();!fe.done;fe=ae.next())if(C(Re=fe.value,S)){ie=Re;break}}catch(H){b={error:H}}finally{try{fe&&!fe.done&&(D=ae.return)&&D.call(ae)}finally{if(b)throw b.error}}var Ee=null;if(!h.tree_isAncestorOf(z,W,!0))for(var ge=s(j._children),be=ge.length-1;be>0;be--){var Re;if(C(Re=ge[be],S)){Ee=Re;break}}var Ne=[];try{for(var Ce=a(j._children),P=Ce.next();!P.done;P=Ce.next())if(w($=P.value,S)){if(f.Guard.isDocumentTypeNode($))throw new l.HierarchyRequestError;Ne.push($)}}catch(H){E={error:H}}finally{try{P&&!P.done&&(R=Ce.return)&&R.call(Ce)}finally{if(E)throw E.error}}if(f.Guard.isCharacterDataNode(ie))(O=g.node_clone(z))._data=d.characterData_substringData(z,Y,h.tree_nodeLength(z)-Y),y.mutation_append(O,U);else if(ie!==null){var O=g.node_clone(ie);y.mutation_append(O,U);var A=_(u.create_range([z,Y],[ie,h.tree_nodeLength(ie)]));y.mutation_append(A,O)}try{for(var L=a(Ne),k=L.next();!k.done;k=L.next()){var $=k.value,O=g.node_clone($);y.mutation_append(O,U)}}catch(H){F={error:H}}finally{try{k&&!k.done&&(M=L.return)&&M.call(L)}finally{if(F)throw F.error}}return f.Guard.isCharacterDataNode(Ee)?((O=g.node_clone(W))._data=d.characterData_substringData(W,0,B),y.mutation_append(O,U)):Ee!==null&&(O=g.node_clone(Ee),U.append(O),A=T(u.create_range([Ee,0],[W,B])),y.mutation_append(A,O)),U},r.range_insert=function(_,S){var b,D;if(f.Guard.isProcessingInstructionNode(S._startNode)||f.Guard.isCommentNode(S._startNode)||f.Guard.isTextNode(S._startNode)&&S._startNode._parent===null||S._startNode===_)throw new l.HierarchyRequestError;var E,R=null;if(f.Guard.isTextNode(S._startNode))R=S._startNode;else{var F=0;try{for(var M=a(S._startNode._children),U=M.next();!U.done;U=M.next()){var z=U.value;if(F===S._startOffset){R=z;break}F++}}catch(W){b={error:W}}finally{try{U&&!U.done&&(D=M.return)&&D.call(M)}finally{if(b)throw b.error}}}if(R===null)E=S._startNode;else{if(R._parent===null)throw new Error("Parent node is null.");E=R._parent}y.mutation_ensurePreInsertionValidity(_,E,R),f.Guard.isTextNode(S._startNode)&&(R=x.text_split(S._startNode,S._startOffset)),_===R&&(R=_._nextSibling),_._parent!==null&&y.mutation_remove(_,_._parent);var Y=R===null?h.tree_nodeLength(E):h.tree_index(R);f.Guard.isDocumentFragmentNode(_)?Y+=h.tree_nodeLength(_):Y++,y.mutation_preInsert(_,E,R),m(S)&&(S._end=[E,Y])},r.range_getContainedNodes=function(_){var S;return(S={})[Symbol.iterator]=function(){var b=_.commonAncestorContainer,D=h.tree_getFirstDescendantNode(b);return{next:function(){for(;D&&!w(D,_);)D=h.tree_getNextDescendantNode(b,D);if(D===null)return{done:!0,value:null};var E={done:!1,value:D};return D=h.tree_getNextDescendantNode(b,D),E}}},S},r.range_getPartiallyContainedNodes=function(_){var S;return(S={})[Symbol.iterator]=function(){var b=_.commonAncestorContainer,D=h.tree_getFirstDescendantNode(b);return{next:function(){for(;D&&!C(D,_);)D=h.tree_getNextDescendantNode(b,D);if(D===null)return{done:!0,value:null};var E={done:!1,value:D};return D=h.tree_getNextDescendantNode(b,D),E}}},S}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(9);r.selectors_scopeMatchASelectorsString=function(o,s){throw new a.NotSupportedError}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(2),o=i(105);r.treeWalker_traverseChildren=function(s,c){for(var l=c?s._current._firstChild:s._current._lastChild;l!==null;){var f=o.traversal_filter(s,l);if(f===a.FilterResult.Accept)return s._current=l,l;if(f===a.FilterResult.Skip){var u=c?l._firstChild:l._lastChild;if(u!==null){l=u;continue}}for(;l!==null;){var h=c?l._nextSibling:l._previousSibling;if(h!==null){l=h;break}var p=l._parent;if(p===null||p===s._root||p===s._current)return null;l=p}}return null},r.treeWalker_traverseSiblings=function(s,c){var l=s._current;if(l===s._root)return null;for(;;){for(var f=c?l._nextSibling:l._previousSibling;f!==null;){l=f;var u=o.traversal_filter(s,l);if(u===a.FilterResult.Accept)return s._current=l,l;f=c?l._firstChild:l._lastChild,u!==a.FilterResult.Reject&&f!==null||(f=c?l._nextSibling:l._previousSibling)}if((l=l._parent)===null||l===s._root||o.traversal_filter(s,l)===a.FilterResult.Accept)return null}}},function(n,r,i){i(89),i(74);var a,o=this&&this.__extends||(a=function(h,p){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var y in g)g.hasOwnProperty(y)&&(d[y]=g[y])})(h,p)},function(h,p){function d(){this.constructor=h}a(h,p),h.prototype=p===null?Object.create(p):(d.prototype=p.prototype,new d)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),c=i(2),l=i(50),f=i(3),u=function(h){function p(d,g){var y=h.call(this,d)||this;return y._indentation={},y._lengthToLastNewline=0,y._writerOptions=s.applyDefaults(g,{wellFormed:!1,headless:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,width:0,allowEmptyTags:!1,indentTextOnlyNodes:!1,spaceBeforeSlash:!1}),y}return o(p,h),p.prototype.serialize=function(d){return this._refs={suppressPretty:!1,emptyNode:!1,markup:""},d.nodeType!==c.NodeType.Document||this._writerOptions.headless||this.declaration(this._builderOptions.version,this._builderOptions.encoding,this._builderOptions.standalone),this.serializeNode(d,this._writerOptions.wellFormed),this._writerOptions.prettyPrint&&this._refs.markup.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(this._refs.markup=this._refs.markup.slice(0,-this._writerOptions.newline.length)),this._refs.markup},p.prototype.declaration=function(d,g,y){this._beginLine(),this._refs.markup+='<?xml version="'+d+'"',g!==void 0&&(this._refs.markup+=' encoding="'+g+'"'),y!==void 0&&(this._refs.markup+=' standalone="'+(y?"yes":"no")+'"'),this._refs.markup+="?>",this._endLine()},p.prototype.docType=function(d,g,y){this._beginLine(),this._refs.markup+=g&&y?"<!DOCTYPE "+d+' PUBLIC "'+g+'" "'+y+'">':g?"<!DOCTYPE "+d+' PUBLIC "'+g+'">':y?"<!DOCTYPE "+d+' SYSTEM "'+y+'">':"<!DOCTYPE "+d+">",this._endLine()},p.prototype.openTagBegin=function(d){this._beginLine(),this._refs.markup+="<"+d},p.prototype.openTagEnd=function(d,g,y){if(this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._writerOptions.prettyPrint&&!g&&!y){for(var x=!0,m=!0,v=this.currentNode.firstChild,w=0,C=0;v;){if(f.Guard.isExclusiveTextNode(v))C++;else{if(!f.Guard.isCDATASectionNode(v)){x=!1,m=!1;break}w++}v.data!==""&&(m=!1),v=v.nextSibling}this._refs.suppressPretty=!this._writerOptions.indentTextOnlyNodes&&x&&(w<=1&&C===0||w===0),this._refs.emptyNode=m}(y||g||this._refs.emptyNode)&&this._writerOptions.allowEmptyTags?this._refs.markup+="></"+d+">":this._refs.markup+=y?" />":g||this._refs.emptyNode?this._writerOptions.spaceBeforeSlash?" />":"/>":">",this._endLine()},p.prototype.closeTag=function(d){this._refs.emptyNode||(this._beginLine(),this._refs.markup+="</"+d+">"),this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._endLine()},p.prototype.attribute=function(d,g){var y=d+'="'+g+'"';this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._refs.markup.length-this._lengthToLastNewline+1+y.length>this._writerOptions.width?(this._endLine(),this._beginLine(),this._refs.markup+=this._indent(1)+y):this._refs.markup+=" "+y},p.prototype.text=function(d){d!==""&&(this._beginLine(),this._refs.markup+=d,this._endLine())},p.prototype.cdata=function(d){d!==""&&(this._beginLine(),this._refs.markup+="<![CDATA["+d+"]]>",this._endLine())},p.prototype.comment=function(d){this._beginLine(),this._refs.markup+="<!--"+d+"-->",this._endLine()},p.prototype.instruction=function(d,g){this._beginLine(),this._refs.markup+="<?"+(g===""?d:d+" "+g)+"?>",this._endLine()},p.prototype._beginLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._indent(this._writerOptions.offset+this.level))},p.prototype._endLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._writerOptions.newline,this._lengthToLastNewline=this._refs.markup.length)},p.prototype._indent=function(d){if(d<=0)return"";if(this._indentation[d]!==void 0)return this._indentation[d];var g=this._writerOptions.indent.repeat(d);return this._indentation[d]=g,g},p}(l.BaseWriter);r.XMLWriter=u},function(n,r,i){var a=i(47),o=i(35);n.exports="".repeat||function(s){var c=String(o(this)),l="",f=a(s);if(f<0||f==1/0)throw RangeError("Wrong number of repetitions");for(;f>0;(f>>>=1)&&(c+=c))1&f&&(l+=c);return l}},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}),s=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(67),l=i(1),f=function(u){function h(p,d){var g=u.call(this,p)||this;return g._writerOptions=l.applyDefaults(d,{wellFormed:!1,prettyPrint:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g}return o(h,u),h.prototype.serialize=function(p){var d=l.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new c.ObjectWriter(this._builderOptions,d).serialize(p);return this._beginLine(this._writerOptions,0)+this._convertObject(g,this._writerOptions)},h.prototype._convertObject=function(p,d,g){var y,x,m=this;g===void 0&&(g=0);var v="",w=this._isLeafNode(p);if(l.isArray(p)){v+="[";var C=p.length,T=0;try{for(var _=s(p),S=_.next();!S.done;S=_.next()){var b=S.value;v+=this._endLine(d,g+1)+this._beginLine(d,g+1)+this._convertObject(b,d,g+1),T<C-1&&(v+=","),T++}}catch(R){y={error:R}}finally{try{S&&!S.done&&(x=_.return)&&x.call(_)}finally{if(y)throw y.error}}v+=this._endLine(d,g)+this._beginLine(d,g),v+="]"}else if(l.isObject(p)){v+="{";var D=l.objectLength(p),E=0;l.forEachObject(p,function(R,F){w&&d.prettyPrint?v+=" ":v+=m._endLine(d,g+1)+m._beginLine(d,g+1),v+=m._key(R),d.prettyPrint&&(v+=" "),v+=m._convertObject(F,d,g+1),E<D-1&&(v+=","),E++},this),w&&d.prettyPrint?v+=" ":v+=this._endLine(d,g)+this._beginLine(d,g),v+="}"}else v+=this._val(p);return v},h.prototype._beginLine=function(p,d){if(!p.prettyPrint)return"";var g=p.offset+d+1;return g>0?new Array(g).join(p.indent):""},h.prototype._endLine=function(p,d){return p.prettyPrint?p.newline:""},h.prototype._key=function(p){return'"'+p+'":'},h.prototype._val=function(p){return JSON.stringify(p)},h.prototype._isLeafNode=function(p){return this._descendantCount(p)<=1},h.prototype._descendantCount=function(p,d){var g=this;return d===void 0&&(d=0),l.isArray(p)?l.forEachArray(p,function(y){return d+=g._descendantCount(y,d)},this):l.isObject(p)?l.forEachObject(p,function(y,x){return d+=g._descendantCount(x,d)},this):d++,d},h}(i(50).BaseWriter);r.JSONWriter=f},function(n,r,i){i(31),i(32),i(33),i(19),i(178),i(89),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}),s=this&&this.__values||function(u){var h=typeof Symbol=="function"&&Symbol.iterator,p=h&&u[h],d=0;if(p)return p.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&d>=u.length&&(u=void 0),{value:u&&u[d++],done:!u}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=i(67),l=i(1),f=function(u){function h(p,d){var g=u.call(this,p)||this;if(g._writerOptions=l.applyDefaults(d,{wellFormed:!1,indent:"  ",newline:`
`,offset:0,group:!1,verbose:!1}),g._writerOptions.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(g._writerOptions.offset<0)throw new Error("YAML offset should be zero or a positive number.");return g}return o(h,u),h.prototype.serialize=function(p){var d=l.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),g=new c.ObjectWriter(this._builderOptions,d).serialize(p),y=this._beginLine(this._writerOptions,0)+"---"+this._endLine(this._writerOptions)+this._convertObject(g,this._writerOptions,0);return y.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(y=y.slice(0,-this._writerOptions.newline.length)),y},h.prototype._convertObject=function(p,d,g,y){var x,m,v=this;y===void 0&&(y=!1);var w="";if(l.isArray(p))try{for(var C=s(p),T=C.next();!T.done;T=C.next()){var _=T.value;w+=this._beginLine(d,g,!0),l.isObject(_)?l.isEmpty(_)?w+='""'+this._endLine(d):w+=this._convertObject(_,d,g,!0):w+=this._val(_)+this._endLine(d)}}catch(S){x={error:S}}finally{try{T&&!T.done&&(m=C.return)&&m.call(C)}finally{if(x)throw x.error}}else l.forEachObject(p,function(S,b){y?(w+=v._key(S),y=!1):w+=v._beginLine(d,g)+v._key(S),l.isObject(b)?l.isEmpty(b)?w+=' ""'+v._endLine(d):w+=v._endLine(d)+v._convertObject(b,d,g+1):w+=" "+v._val(b)+v._endLine(d)},this);return w},h.prototype._beginLine=function(p,d,g){g===void 0&&(g=!1);var y=p.offset+d+1,x=new Array(y).join(p.indent);return g?x.substr(0,x.length-2)+"-"+x.substr(-1,1):x},h.prototype._endLine=function(p){return p.newline},h.prototype._key=function(p){return'"'+p+'":'},h.prototype._val=function(p){return JSON.stringify(p)},h}(i(50).BaseWriter);r.YAMLWriter=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),i(110).dom.setFeatures(!0);var a=i(110);r.DOMImplementation=a.DOMImplementation;var o=i(271);r.DOMParser=o.DOMParser;var s=i(274);r.XMLSerializer=s.XMLSerializer},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=function(){function c(){}return c.prototype.before=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];var u=a.Cast.asNode(this),h=u._parent;if(h!==null){for(var p=u._previousSibling,d=!0;d&&p;){d=!1;for(var g=0;g<l.length;g++){var y=l[g];if(y===p){p=p._previousSibling,d=!0;break}}}var x=o.parentNode_convertNodesIntoANode(l,u._nodeDocument);p=p===null?h._firstChild:p._nextSibling,o.mutation_preInsert(x,h,p)}},c.prototype.after=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];var u=a.Cast.asNode(this),h=u._parent;if(h){for(var p=u._nextSibling,d=!0;d&&p;){d=!1;for(var g=0;g<l.length;g++){var y=l[g];if(y===p){p=p._nextSibling,d=!0;break}}}var x=o.parentNode_convertNodesIntoANode(l,u._nodeDocument);o.mutation_preInsert(x,h,p)}},c.prototype.replaceWith=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];var u=a.Cast.asNode(this),h=u._parent;if(h){for(var p=u._nextSibling,d=!0;d&&p;){d=!1;for(var g=0;g<l.length;g++){var y=l[g];if(y===p){p=p._nextSibling,d=!0;break}}}var x=o.parentNode_convertNodesIntoANode(l,u._nodeDocument);u._parent===h?o.mutation_replace(u,x,h):o.mutation_preInsert(x,h,p)}},c.prototype.remove=function(){var l=a.Cast.asNode(this),f=l._parent;f&&o.mutation_remove(l,f)},c}();r.ChildNodeImpl=s},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=function(){};r.DocumentOrShadowRootImpl=a},function(n,r,i){var a=this&&this.__values||function(f){var u=typeof Symbol=="function"&&Symbol.iterator,h=u&&f[u],p=0;if(h)return h.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&p>=f.length&&(f=void 0),{value:f&&f[p++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),s=i(3),c=i(7),l=function(){function f(u){this._nodeList=[],this._recordQueue=[],this._callback=u;var h=o.dom.window;c.set.append(h._mutationObservers,this)}return f.prototype.observe=function(u,h){var p,d;if((h=h||{childList:!1,subtree:!1}).attributeOldValue===void 0&&h.attributeFilter===void 0||h.attributes!==void 0||(h.attributes=!0),h.characterDataOldValue!==void 0&&h.characterData===void 0&&(h.characterData=!0),!h.childList&&!h.attributes&&!h.characterData)throw new TypeError;if(h.attributeOldValue&&!h.attributes)throw new TypeError;if(h.attributeFilter!==void 0&&!h.attributes)throw new TypeError;if(h.characterDataOldValue&&!h.characterData)throw new TypeError;var g=!1,y=h,x=function(C){var T,_;if(C.observer===m){g=!0;try{for(var S=(T=void 0,a(m._nodeList)),b=S.next();!b.done;b=S.next()){var D=b.value;c.list.remove(D._registeredObserverList,function(E){return s.Guard.isTransientRegisteredObserver(E)&&E.source===C})}}catch(E){T={error:E}}finally{try{b&&!b.done&&(_=S.return)&&_.call(S)}finally{if(T)throw T.error}}C.options=y}},m=this;try{for(var v=a(u._registeredObserverList),w=v.next();!w.done;w=v.next())x(w.value)}catch(C){p={error:C}}finally{try{w&&!w.done&&(d=v.return)&&d.call(v)}finally{if(p)throw p.error}}g||(u._registeredObserverList.push({observer:this,options:h}),this._nodeList.push(u))},f.prototype.disconnect=function(){var u,h,p=this;try{for(var d=a(this._nodeList),g=d.next();!g.done;g=d.next()){var y=g.value;c.list.remove(y._registeredObserverList,function(x){return x.observer===p})}}catch(x){u={error:x}}finally{try{g&&!g.done&&(h=d.return)&&h.call(d)}finally{if(u)throw u.error}}this._recordQueue=[]},f.prototype.takeRecords=function(){var u=this._recordQueue;return this._recordQueue=[],u},f}();r.MutationObserverImpl=l},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=function(){function s(){}return Object.defineProperty(s.prototype,"previousElementSibling",{get:function(){for(var c=a.Cast.asNode(this)._previousSibling;c;){if(a.Guard.isElementNode(c))return c;c=c._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"nextElementSibling",{get:function(){for(var c=a.Cast.asNode(this)._nextSibling;c;){if(a.Guard.isElementNode(c))return c;c=c._nextSibling}return null},enumerable:!0,configurable:!0}),s}();r.NonDocumentTypeChildNodeImpl=o},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(3),o=i(0),s=function(){function c(){}return c.prototype.getElementById=function(l){for(var f=o.tree_getFirstDescendantNode(a.Cast.asNode(this),!1,!1,function(u){return a.Guard.isElementNode(u)});f!==null;){if(f._uniqueIdentifier===l)return f;f=o.tree_getNextDescendantNode(a.Cast.asNode(this),f,!1,!1,function(u){return a.Guard.isElementNode(u)})}return null},c}();r.NonElementParentNodeImpl=s},function(n,r,i){var a=this&&this.__values||function(l){var f=typeof Symbol=="function"&&Symbol.iterator,u=f&&l[f],h=0;if(u)return u.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&h>=l.length&&(l=void 0),{value:l&&l[h++],done:!l}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(3),s=i(0),c=function(){function l(){}return Object.defineProperty(l.prototype,"children",{get:function(){return s.create_htmlCollection(o.Cast.asNode(this))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"firstElementChild",{get:function(){for(var f=o.Cast.asNode(this)._firstChild;f;){if(o.Guard.isElementNode(f))return f;f=f._nextSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lastElementChild",{get:function(){for(var f=o.Cast.asNode(this)._lastChild;f;){if(o.Guard.isElementNode(f))return f;f=f._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"childElementCount",{get:function(){var f,u,h=0;try{for(var p=a(o.Cast.asNode(this)._children),d=p.next();!d.done;d=p.next()){var g=d.value;o.Guard.isElementNode(g)&&h++}}catch(y){f={error:y}}finally{try{d&&!d.done&&(u=p.return)&&u.call(p)}finally{if(f)throw f.error}}return h},enumerable:!0,configurable:!0}),l.prototype.prepend=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var h=o.Cast.asNode(this),p=s.parentNode_convertNodesIntoANode(f,h._nodeDocument);s.mutation_preInsert(p,h,h._firstChild)},l.prototype.append=function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];var h=o.Cast.asNode(this),p=s.parentNode_convertNodesIntoANode(f,h._nodeDocument);s.mutation_append(p,h)},l.prototype.querySelector=function(f){var u=o.Cast.asNode(this),h=s.selectors_scopeMatchASelectorsString(f,u);return h.length===0?null:h[0]},l.prototype.querySelectorAll=function(f){var u=o.Cast.asNode(this),h=s.selectors_scopeMatchASelectorsString(f,u);return s.create_nodeListStatic(u,h)},l}();r.ParentNodeImpl=c},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=function(){function s(){}return Object.defineProperty(s.prototype,"_name",{get:function(){return this.__name||""},set:function(c){this.__name=c},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_assignedSlot",{get:function(){return this.__assignedSlot||null},set:function(c){this.__assignedSlot=c},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"assignedSlot",{get:function(){return a.shadowTree_findASlot(this,!0)},enumerable:!0,configurable:!0}),s}();r.SlotableImpl=o},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(102),c=i(9),l=i(3),f=function(u){function h(p){var d=u.call(this)||this;if(l.Guard.isDocumentTypeNode(p.startContainer)||l.Guard.isAttrNode(p.startContainer)||l.Guard.isDocumentTypeNode(p.endContainer)||l.Guard.isAttrNode(p.endContainer))throw new c.InvalidNodeTypeError;return d._start=[p.startContainer,p.startOffset],d._end=[p.endContainer,p.endOffset],d}return o(h,u),h}(s.AbstractRangeImpl);r.StaticRangeImpl=f},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(272);r.DOMParser=a.DOMParserImpl},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(0),o=i(273),s=function(){function c(){}return c.prototype.parseFromString=function(l,f){if(f==="text/html")throw new Error("HTML parser not implemented.");try{return(u=new o.XMLParserImpl().parse(l))._contentType=f,u}catch(g){var u,h="http://www.mozilla.org/newlayout/xml/parsererror.xml",p=(u=a.create_xmlDocument()).createElementNS(h,"parsererror"),d=u.createElementNS(h,"error");return d.setAttribute("message",g.message),p.appendChild(d),u.appendChild(p),u}},c}();r.DOMParserImpl=s},function(n,r,i){var a=this&&this.__read||function(p,d){var g=typeof Symbol=="function"&&p[Symbol.iterator];if(!g)return p;var y,x,m=g.call(p),v=[];try{for(;(d===void 0||d-- >0)&&!(y=m.next()).done;)v.push(y.value)}catch(w){x={error:w}}finally{try{y&&!y.done&&(g=m.return)&&g.call(m)}finally{if(x)throw x.error}}return v},o=this&&this.__values||function(p){var d=typeof Symbol=="function"&&Symbol.iterator,g=d&&p[d],y=0;if(g)return g.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var s=i(180),c=i(111),l=i(7),f=i(0),u=i(69),h=function(){function p(){}return p.prototype.parse=function(d){for(var g,y,x,m,v=new s.XMLStringLexer(d,{skipWhitespaceOnlyText:!0}),w=f.create_document(),C=w,T=v.nextToken();T.type!==c.TokenType.EOF;){switch(T.type){case c.TokenType.Declaration:var _=T;if(_.version!=="1.0")throw new Error("Invalid xml version: "+_.version);break;case c.TokenType.DocType:var S=T;if(!f.xml_isPubidChar(S.pubId))throw new Error("DocType public identifier does not match PubidChar construct.");if(!f.xml_isLegalChar(S.sysId)||S.sysId.indexOf('"')!==-1&&S.sysId.indexOf("'")!==-1)throw new Error("DocType system identifier contains invalid characters.");C.appendChild(w.implementation.createDocumentType(S.name,S.pubId,S.sysId));break;case c.TokenType.CDATA:var b=T;if(!f.xml_isLegalChar(b.data)||b.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters.");C.appendChild(w.createCDATASection(b.data));break;case c.TokenType.Comment:var D=T;if(!f.xml_isLegalChar(D.data)||D.data.indexOf("--")!==-1||D.data.endsWith("-"))throw new Error("Comment data contains invalid characters.");C.appendChild(w.createComment(D.data));break;case c.TokenType.PI:var E=T;if(E.target.indexOf(":")!==-1||/^xml$/i.test(E.target))throw new Error("Processing instruction target contains invalid characters.");if(!f.xml_isLegalChar(E.data)||E.data.indexOf("?>")!==-1)throw new Error("Processing instruction data contains invalid characters.");C.appendChild(w.createProcessingInstruction(E.target,E.data));break;case c.TokenType.Text:var R=T;if(!f.xml_isLegalChar(R.data))throw new Error("Text data contains invalid characters.");C.appendChild(w.createTextNode(this._decodeText(R.data)));break;case c.TokenType.Element:var F=T,M=a(f.namespace_extractQName(F.name),2),U=M[0],z=M[1];if(z.indexOf(":")!==-1||!f.xml_isName(z))throw new Error("Node local name contains invalid characters.");if(U==="xmlns")throw new Error("An element cannot have the 'xmlns' prefix.");var Y=C.lookupNamespaceURI(U),W={};try{for(var B=(g=void 0,o(F.attributes)),j=B.next();!j.done;j=B.next()){var ie=a(j.value,2),ae=ie[0],fe=ie[1];if(ae==="xmlns")Y=fe;else{var Ee=a(f.namespace_extractQName(ae),2),ge=Ee[0],be=Ee[1];ge==="xmlns"&&(be===U&&(Y=fe),W[be]=fe)}}}catch(k){g={error:k}}finally{try{j&&!j.done&&(y=B.return)&&y.call(B)}finally{if(g)throw g.error}}var Re=Y!==null?w.createElementNS(Y,F.name):w.createElement(F.name);C.appendChild(Re);var Ne=new u.LocalNameSet;try{for(var Ce=(x=void 0,o(F.attributes)),P=Ce.next();!P.done;P=Ce.next()){var O=a(P.value,2),A=(ae=O[0],fe=O[1],a(f.namespace_extractQName(ae),2)),L=(ge=A[0],be=A[1],null);if(ge==="xmlns"||ge===null&&be==="xmlns"?L=l.namespace.XMLNS:(L=Re.lookupNamespaceURI(ge))!==null&&Re.isDefaultNamespace(L)?L=null:L===null&&ge!==null&&(L=W[ge]||null),Ne.has(L,be))throw new Error("Element contains duplicate attributes.");if(Ne.set(L,be),L===l.namespace.XMLNS&&fe===l.namespace.XMLNS)throw new Error("XMLNS namespace is reserved.");if(be.indexOf(":")!==-1||!f.xml_isName(be))throw new Error("Attribute local name contains invalid characters.");if(ge==="xmlns"&&fe==="")throw new Error("Empty XML namespace is not allowed.");L!==null?Re.setAttributeNS(L,ae,this._decodeAttributeValue(fe)):Re.setAttribute(ae,this._decodeAttributeValue(fe))}}catch(k){x={error:k}}finally{try{P&&!P.done&&(m=Ce.return)&&m.call(Ce)}finally{if(x)throw x.error}}F.selfClosing||(C=Re);break;case c.TokenType.ClosingTag:if(T.name!==C.nodeName)throw new Error("Closing tag name does not match opening tag name.");C._parent&&(C=C._parent)}T=v.nextToken()}return w},p.prototype._decodeText=function(d){return d==null?d:d.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},p.prototype._decodeAttributeValue=function(d){return d==null?d:d.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},p}();r.XMLParserImpl=h},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(275);r.XMLSerializer=a.XMLSerializerImpl},function(n,r,i){var a=this&&this.__values||function(p){var d=typeof Symbol=="function"&&Symbol.iterator,g=d&&p[d],y=0;if(g)return g.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&y>=p.length&&(p=void 0),{value:p&&p[y++],done:!p}}};throw new TypeError(d?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var o=i(2),s=i(69),c=i(95),l=i(9),f=i(7),u=i(0),h=function(){function p(){}return p.prototype.serializeToString=function(d){return this._xmlSerialization(d,!1)},p.prototype._xmlSerialization=function(d,g){if(d._nodeDocument===void 0||d._nodeDocument._hasNamespaces){var y=new c.NamespacePrefixMap;y.set("xml",f.namespace.XML);try{return this._serializeNodeNS(d,null,y,{value:1},g)}catch{throw new l.InvalidStateError}}else try{return this._serializeNode(d,g)}catch{throw new l.InvalidStateError}},p.prototype._serializeNodeNS=function(d,g,y,x,m){switch(d.nodeType){case o.NodeType.Element:return this._serializeElementNS(d,g,y,x,m);case o.NodeType.Document:return this._serializeDocumentNS(d,g,y,x,m);case o.NodeType.Comment:return this._serializeComment(d,m);case o.NodeType.Text:return this._serializeText(d,m);case o.NodeType.DocumentFragment:return this._serializeDocumentFragmentNS(d,g,y,x,m);case o.NodeType.DocumentType:return this._serializeDocumentType(d,m);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(d,m);case o.NodeType.CData:return this._serializeCData(d,m);default:throw new Error("Unknown node type: "+d.nodeType)}},p.prototype._serializeNode=function(d,g){switch(d.nodeType){case o.NodeType.Element:return this._serializeElement(d,g);case o.NodeType.Document:return this._serializeDocument(d,g);case o.NodeType.Comment:return this._serializeComment(d,g);case o.NodeType.Text:return this._serializeText(d,g);case o.NodeType.DocumentFragment:return this._serializeDocumentFragment(d,g);case o.NodeType.DocumentType:return this._serializeDocumentType(d,g);case o.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(d,g);case o.NodeType.CData:return this._serializeCData(d,g);default:throw new Error("Unknown node type: "+d.nodeType)}},p.prototype._serializeElementNS=function(d,g,y,x,m){var v,w;if(m&&(d.localName.indexOf(":")!==-1||!u.xml_isName(d.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var C="<",T="",_=!1,S=!1,b=y.copy(),D={},E=this._recordNamespaceInformation(d,b,D),R=g,F=d.namespaceURI;if(R===F)E!==null&&(S=!0),C+=T=F===f.namespace.XML?"xml:"+d.localName:d.localName;else{var M=d.prefix,U=null;if(M===null&&F===E||(U=b.get(M,F)),M==="xmlns"){if(m)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");U=M}U!==null?(T=U+":"+d.localName,E!==null&&E!==f.namespace.XML&&(R=E||null),C+=T):M!==null?(M in D&&(M=this._generatePrefix(F,b,x)),b.set(M,F),C+=T+=M+":"+d.localName,C+=" xmlns:"+M+'="'+this._serializeAttributeValue(F,m)+'"',E!==null&&(R=E||null)):E===null||E!==null&&E!==F?(S=!0,R=F,C+=T+=d.localName,C+=' xmlns="'+this._serializeAttributeValue(F,m)+'"'):(R=F,C+=T+=d.localName)}C+=this._serializeAttributesNS(d,b,x,D,S,m);var z=F===f.namespace.HTML;if(z&&d.childNodes.length===0&&p._VoidElementNames.has(d.localName)?(C+=" /",_=!0):z||d.childNodes.length!==0||(C+="/",_=!0),C+=">",_)return C;if(!(z&&d.localName==="template"))try{for(var Y=a(d._children||d.childNodes),W=Y.next();!W.done;W=Y.next()){var B=W.value;C+=this._serializeNodeNS(B,R,b,x,m)}}catch(j){v={error:j}}finally{try{W&&!W.done&&(w=Y.return)&&w.call(Y)}finally{if(v)throw v.error}}return C+="</"+T+">"},p.prototype._serializeDocumentNS=function(d,g,y,x,m){var v,w;if(m&&d.documentElement===null)throw new Error("Missing document element (well-formed required).");var C="";try{for(var T=a(d._children||d.childNodes),_=T.next();!_.done;_=T.next()){var S=_.value;C+=this._serializeNodeNS(S,g,y,x,m)}}catch(b){v={error:b}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(v)throw v.error}}return C},p.prototype._serializeComment=function(d,g){if(g&&(!u.xml_isLegalChar(d.data)||d.data.indexOf("--")!==-1||d.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");return"<!--"+d.data+"-->"},p.prototype._serializeText=function(d,g){if(g&&!u.xml_isLegalChar(d.data))throw new Error("Text data contains invalid characters (well-formed required).");for(var y="",x=0;x<d.data.length;x++){var m=d.data[x];y+=m==="&"?"&amp;":m==="<"?"&lt;":m===">"?"&gt;":m}return y},p.prototype._serializeDocumentFragmentNS=function(d,g,y,x,m){var v,w,C="";try{for(var T=a(d._children||d.childNodes),_=T.next();!_.done;_=T.next()){var S=_.value;C+=this._serializeNodeNS(S,g,y,x,m)}}catch(b){v={error:b}}finally{try{_&&!_.done&&(w=T.return)&&w.call(T)}finally{if(v)throw v.error}}return C},p.prototype._serializeDocumentType=function(d,g){if(g&&!u.xml_isPubidChar(d.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(g&&(!u.xml_isLegalChar(d.systemId)||d.systemId.indexOf('"')!==-1&&d.systemId.indexOf("'")!==-1))throw new Error("DocType system identifier contains invalid characters (well-formed required).");return d.publicId&&d.systemId?"<!DOCTYPE "+d.name+' PUBLIC "'+d.publicId+'" "'+d.systemId+'">':d.publicId?"<!DOCTYPE "+d.name+' PUBLIC "'+d.publicId+'">':d.systemId?"<!DOCTYPE "+d.name+' SYSTEM "'+d.systemId+'">':"<!DOCTYPE "+d.name+">"},p.prototype._serializeProcessingInstruction=function(d,g){if(g&&(d.target.indexOf(":")!==-1||/^xml$/i.test(d.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(g&&(!u.xml_isLegalChar(d.data)||d.data.indexOf("?>")!==-1))throw new Error("Processing instruction data contains invalid characters (well-formed required).");return"<?"+(d.data===""?d.target:d.target+" "+d.data)+"?>"},p.prototype._serializeCData=function(d,g){if(g&&d.data.indexOf("]]>")!==-1)throw new Error("CDATA contains invalid characters (well-formed required).");return"<![CDATA["+d.data+"]]>"},p.prototype._serializeAttributesNS=function(d,g,y,x,m,v){var w,C,T="",_=v?new s.LocalNameSet:void 0;try{for(var S=a(d.attributes),b=S.next();!b.done;b=S.next()){var D=b.value;if(m||v||D.namespaceURI!==null){if(v&&_&&_.has(D.namespaceURI,D.localName))throw new Error("Element contains duplicate attributes (well-formed required).");v&&_&&_.set(D.namespaceURI,D.localName);var E=D.namespaceURI,R=null;if(E!==null)if(R=g.get(D.prefix,E),E===f.namespace.XMLNS){if(D.value===f.namespace.XML||D.prefix===null&&m||D.prefix!==null&&(!(D.localName in x)||x[D.localName]!==D.value)&&g.has(D.localName,D.value))continue;if(v&&D.value===f.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(v&&D.value==="")throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");D.prefix==="xmlns"&&(R="xmlns")}else R===null&&(T+=" xmlns:"+(R=D.prefix===null||g.hasPrefix(D.prefix)&&!g.has(D.prefix,E)?this._generatePrefix(E,g,y):D.prefix)+'="'+this._serializeAttributeValue(E,v)+'"');if(T+=" ",R!==null&&(T+=R+":"),v&&(D.localName.indexOf(":")!==-1||!u.xml_isName(D.localName)||D.localName==="xmlns"&&E===null))throw new Error("Attribute local name contains invalid characters (well-formed required).");T+=D.localName+'="'+this._serializeAttributeValue(D.value,v)+'"'}else T+=" "+D.localName+'="'+this._serializeAttributeValue(D.value,v)+'"'}}catch(F){w={error:F}}finally{try{b&&!b.done&&(C=S.return)&&C.call(S)}finally{if(w)throw w.error}}return T},p.prototype._recordNamespaceInformation=function(d,g,y){var x,m,v=null;try{for(var w=a(d.attributes),C=w.next();!C.done;C=w.next()){var T=C.value,_=T.namespaceURI,S=T.prefix;if(_===f.namespace.XMLNS){if(S===null){v=T.value;continue}var b=T.localName,D=T.value;if(D===f.namespace.XML||(D===""&&(D=null),g.has(b,D)))continue;g.set(b,D),y[b]=D||""}}}catch(E){x={error:E}}finally{try{C&&!C.done&&(m=w.return)&&m.call(w)}finally{if(x)throw x.error}}return v},p.prototype._generatePrefix=function(d,g,y){var x="ns"+y.value;return y.value++,g.set(x,d),x},p.prototype._serializeAttributeValue=function(d,g){if(g&&d!==null&&!u.xml_isLegalChar(d))throw new Error("Invalid characters in attribute value.");if(d===null)return"";for(var y="",x=0;x<d.length;x++){var m=d[x];y+=m==='"'?"&quot;":m==="&"?"&amp;":m==="<"?"&lt;":m===">"?"&gt;":m}return y},p.prototype._serializeElement=function(d,g){var y,x;if(g&&(d.localName.indexOf(":")!==-1||!u.xml_isName(d.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var m=!1,v=d.localName,w="<"+v;if(w+=this._serializeAttributes(d,g),d._children.size===0&&(w+="/",m=!0),w+=">",m)return w;try{for(var C=a(d._children),T=C.next();!T.done;T=C.next()){var _=T.value;w+=this._serializeNode(_,g)}}catch(S){y={error:S}}finally{try{T&&!T.done&&(x=C.return)&&x.call(C)}finally{if(y)throw y.error}}return w+="</"+v+">"},p.prototype._serializeDocument=function(d,g){var y,x;if(g&&d.documentElement===null)throw new Error("Missing document element (well-formed required).");var m="";try{for(var v=a(d._children),w=v.next();!w.done;w=v.next()){var C=w.value;m+=this._serializeNode(C,g)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(x=v.return)&&x.call(v)}finally{if(y)throw y.error}}return m},p.prototype._serializeDocumentFragment=function(d,g){var y,x,m="";try{for(var v=a(d._children),w=v.next();!w.done;w=v.next()){var C=w.value;m+=this._serializeNode(C,g)}}catch(T){y={error:T}}finally{try{w&&!w.done&&(x=v.return)&&x.call(v)}finally{if(y)throw y.error}}return m},p.prototype._serializeAttributes=function(d,g){var y,x,m="",v=g?{}:void 0;try{for(var w=a(d.attributes),C=w.next();!C.done;C=w.next()){var T=C.value;if(g&&v&&T.localName in v)throw new Error("Element contains duplicate attributes (well-formed required).");if(g&&v&&(v[T.localName]=!0),g&&(T.localName.indexOf(":")!==-1||!u.xml_isName(T.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");m+=" "+T.localName+'="'+this._serializeAttributeValue(T.value,g)+'"'}}catch(_){y={error:_}}finally{try{C&&!C.done&&(x=w.return)&&x.call(w)}finally{if(y)throw y.error}}return m},p._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),p}();r.XMLSerializerImpl=h},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(277);r.XMLReader=a.XMLReader;var o=i(112);r.ObjectReader=o.ObjectReader;var s=i(280);r.JSONReader=s.JSONReader;var c=i(281);r.YAMLReader=c.YAMLReader},function(n,r,i){i(31),i(32),i(33),i(19),i(65),i(20),i(22),i(23);var a,o=this&&this.__extends||(a=function(d,g){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,x){y.__proto__=x}||function(y,x){for(var m in x)x.hasOwnProperty(m)&&(y[m]=x[m])})(d,g)},function(d,g){function y(){this.constructor=d}a(d,g),d.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)}),s=this&&this.__read||function(d,g){var y=typeof Symbol=="function"&&d[Symbol.iterator];if(!y)return d;var x,m,v=y.call(d),w=[];try{for(;(g===void 0||g-- >0)&&!(x=v.next()).done;)w.push(x.value)}catch(C){m={error:C}}finally{try{x&&!x.done&&(y=v.return)&&y.call(v)}finally{if(m)throw m.error}}return w},c=this&&this.__values||function(d){var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&d[g],x=0;if(y)return y.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&x>=d.length&&(d=void 0),{value:d&&d[x++],done:!d}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var l=i(180),f=i(111),u=i(7),h=i(0),p=function(d){function g(){return d!==null&&d.apply(this,arguments)||this}return o(g,d),g.prototype._parse=function(y,x){for(var m,v,w,C,T=new l.XMLStringLexer(x,{skipWhitespaceOnlyText:!0}),_=y,S=y,b=T.nextToken();b.type!==f.TokenType.EOF;){switch(b.type){case f.TokenType.Declaration:var D=b,E=this.sanitize(D.version);if(E!=="1.0")throw new Error("Invalid xml version: "+E);var R={version:E};D.encoding&&(R.encoding=this.sanitize(D.encoding)),D.standalone&&(R.standalone=this.sanitize(D.standalone)==="yes"),S.set(R);break;case f.TokenType.DocType:var F=b;S=this.docType(S,this.sanitize(F.name),this.sanitize(F.pubId),this.sanitize(F.sysId))||S;break;case f.TokenType.CDATA:var M=b;S=this.cdata(S,this.sanitize(M.data))||S;break;case f.TokenType.Comment:var U=b;S=this.comment(S,this.sanitize(U.data))||S;break;case f.TokenType.PI:var z=b;S=this.instruction(S,this.sanitize(z.target),this.sanitize(z.data))||S;break;case f.TokenType.Text:var Y=b;S=this.text(S,this._decodeText(this.sanitize(Y.data)))||S;break;case f.TokenType.Element:var W=b,B=this.sanitize(W.name),j=s(h.namespace_extractQName(B),1)[0],ie=S.node.lookupNamespaceURI(j),ae={};try{for(var fe=(m=void 0,c(W.attributes)),Ee=fe.next();!Ee.done;Ee=fe.next()){var ge=s(Ee.value,2),be=ge[0],Re=ge[1];if(be=this.sanitize(be),Re=this.sanitize(Re),be==="xmlns")ie=Re;else{var Ne=s(h.namespace_extractQName(be),2),Ce=Ne[0],P=Ne[1];Ce==="xmlns"&&(P===j&&(ie=Re),ae[P]=Re)}}}catch(se){m={error:se}}finally{try{Ee&&!Ee.done&&(v=fe.return)&&v.call(fe)}finally{if(m)throw m.error}}var O=ie!==null?this.element(S,ie,B):this.element(S,void 0,B);if(O===void 0)break;S.node===y.node&&(_=O);try{for(var A=(w=void 0,c(W.attributes)),L=A.next();!L.done;L=A.next()){var k=s(L.value,2);be=k[0],Re=k[1],be=this.sanitize(be),Re=this.sanitize(Re);var $=s(h.namespace_extractQName(be),2),H=(Ce=$[0],P=$[1],null);Ce==="xmlns"||Ce===null&&P==="xmlns"?H=u.namespace.XMLNS:(H=O.node.lookupNamespaceURI(Ce))!==null&&O.node.isDefaultNamespace(H)?H=null:H===null&&Ce!==null&&(H=ae[Ce]||null),H!==null?this.attribute(O,H,be,this._decodeAttributeValue(Re)):this.attribute(O,void 0,be,this._decodeAttributeValue(Re))}}catch(se){w={error:se}}finally{try{L&&!L.done&&(C=A.return)&&C.call(A)}finally{if(w)throw w.error}}W.selfClosing||(S=O);break;case f.TokenType.ClosingTag:S.node.parentNode&&(S=S.up())}b=T.nextToken()}return _},g}(i(75).BaseReader);r.XMLReader=p},function(n,r,i){var a=i(4),o=i(279);a({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(n,r,i){var a=i(16),o=i(8),s=i(61),c=i(85),l=i(79),f=i(27),u=i(41),h=Object.assign,p=Object.defineProperty;n.exports=!h||o(function(){if(a&&h({b:1},h(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var d={},g={},y=Symbol();return d[y]=7,"abcdefghijklmnopqrst".split("").forEach(function(x){g[x]=x}),h({},d)[y]!=7||s(h({},g)).join("")!="abcdefghijklmnopqrst"})?function(d,g){for(var y=f(d),x=arguments.length,m=1,v=c.f,w=l.f;x>m;)for(var C,T=u(arguments[m++]),_=v?s(T).concat(v(T)):s(T),S=_.length,b=0;S>b;)C=_[b++],a&&!w.call(T,C)||(y[C]=T[C]);return y}:h},function(n,r,i){var a,o=this&&this.__extends||(a=function(l,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var p in h)h.hasOwnProperty(p)&&(u[p]=h[p])})(l,f)},function(l,f){function u(){this.constructor=l}a(l,f),l.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),c=function(l){function f(){return l!==null&&l.apply(this,arguments)||this}return o(f,l),f.prototype._parse=function(u,h){return new s.ObjectReader(this._builderOptions).parse(u,JSON.parse(h))},f}(i(75).BaseReader);r.JSONReader=c},function(n,r,i){var a,o=this&&this.__extends||(a=function(u,h){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var g in d)d.hasOwnProperty(g)&&(p[g]=d[g])})(u,h)},function(u,h){function p(){this.constructor=u}a(u,h),u.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)});Object.defineProperty(r,"__esModule",{value:!0});var s=i(112),c=i(75),l=i(282),f=function(u){function h(){return u!==null&&u.apply(this,arguments)||this}return o(h,u),h.prototype._parse=function(p,d){var g=l.safeLoad(d);if(g===void 0)throw new Error("Unable to parse YAML document.");return new s.ObjectReader(this._builderOptions).parse(p,g)},h}(c.BaseReader);r.YAMLReader=f},function(n,r,i){var a=i(283);n.exports=a},function(n,r,i){var a=i(284),o=i(303);function s(c){return function(){throw new Error("Function "+c+" is deprecated and cannot be used.")}}n.exports.Type=i(10),n.exports.Schema=i(39),n.exports.FAILSAFE_SCHEMA=i(113),n.exports.JSON_SCHEMA=i(182),n.exports.CORE_SCHEMA=i(181),n.exports.DEFAULT_SAFE_SCHEMA=i(54),n.exports.DEFAULT_FULL_SCHEMA=i(76),n.exports.load=a.load,n.exports.loadAll=a.loadAll,n.exports.safeLoad=a.safeLoad,n.exports.safeLoadAll=a.safeLoadAll,n.exports.dump=o.dump,n.exports.safeDump=o.safeDump,n.exports.YAMLException=i(53),n.exports.MINIMAL_SCHEMA=i(113),n.exports.SAFE_SCHEMA=i(54),n.exports.DEFAULT_SCHEMA=i(76),n.exports.scan=s("scan"),n.exports.parse=s("parse"),n.exports.compose=s("compose"),n.exports.addConstructor=s("addConstructor")},function(n,r,i){var a=i(38),o=i(53),s=i(285),c=i(54),l=i(76),f=Object.prototype.hasOwnProperty,u=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,h=/[\x85\u2028\u2029]/,p=/[,\[\]\{\}]/,d=/^(?:!|!!|![a-z\-]+!)$/i,g=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function y(O){return Object.prototype.toString.call(O)}function x(O){return O===10||O===13}function m(O){return O===9||O===32}function v(O){return O===9||O===32||O===10||O===13}function w(O){return O===44||O===91||O===93||O===123||O===125}function C(O){var A;return 48<=O&&O<=57?O-48:97<=(A=32|O)&&A<=102?A-97+10:-1}function T(O){return O===48?"\0":O===97?"\x07":O===98?"\b":O===116||O===9?"	":O===110?`
`:O===118?"\v":O===102?"\f":O===114?"\r":O===101?"\x1B":O===32?" ":O===34?'"':O===47?"/":O===92?"\\":O===78?"":O===95?"":O===76?"\u2028":O===80?"\u2029":""}function _(O){return O<=65535?String.fromCharCode(O):String.fromCharCode(55296+(O-65536>>10),56320+(O-65536&1023))}for(var S=new Array(256),b=new Array(256),D=0;D<256;D++)S[D]=T(D)?1:0,b[D]=T(D);function E(O,A){this.input=O,this.filename=A.filename||null,this.schema=A.schema||l,this.onWarning=A.onWarning||null,this.legacy=A.legacy||!1,this.json=A.json||!1,this.listener=A.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=O.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function R(O,A){return new o(A,new s(O.filename,O.input,O.position,O.line,O.position-O.lineStart))}function F(O,A){throw R(O,A)}function M(O,A){O.onWarning&&O.onWarning.call(null,R(O,A))}var U={YAML:function(O,A,L){var k,$,H;O.version!==null&&F(O,"duplication of %YAML directive"),L.length!==1&&F(O,"YAML directive accepts exactly one argument"),(k=/^([0-9]+)\.([0-9]+)$/.exec(L[0]))===null&&F(O,"ill-formed argument of the YAML directive"),$=parseInt(k[1],10),H=parseInt(k[2],10),$!==1&&F(O,"unacceptable YAML version of the document"),O.version=L[0],O.checkLineBreaks=H<2,H!==1&&H!==2&&M(O,"unsupported YAML version of the document")},TAG:function(O,A,L){var k,$;L.length!==2&&F(O,"TAG directive accepts exactly two arguments"),k=L[0],$=L[1],d.test(k)||F(O,"ill-formed tag handle (first argument) of the TAG directive"),f.call(O.tagMap,k)&&F(O,'there is a previously declared suffix for "'+k+'" tag handle'),g.test($)||F(O,"ill-formed tag prefix (second argument) of the TAG directive"),O.tagMap[k]=$}};function z(O,A,L,k){var $,H,se,me;if(A<L){if(me=O.input.slice(A,L),k)for($=0,H=me.length;$<H;$+=1)(se=me.charCodeAt($))===9||32<=se&&se<=1114111||F(O,"expected valid JSON character");else u.test(me)&&F(O,"the stream contains non-printable characters");O.result+=me}}function Y(O,A,L,k){var $,H,se,me;for(a.isObject(L)||F(O,"cannot merge mappings; the provided source object is unacceptable"),se=0,me=($=Object.keys(L)).length;se<me;se+=1)H=$[se],f.call(A,H)||(A[H]=L[H],k[H]=!0)}function W(O,A,L,k,$,H,se,me){var ye,_e;if(Array.isArray($))for(ye=0,_e=($=Array.prototype.slice.call($)).length;ye<_e;ye+=1)Array.isArray($[ye])&&F(O,"nested arrays are not supported inside keys"),typeof $=="object"&&y($[ye])==="[object Object]"&&($[ye]="[object Object]");if(typeof $=="object"&&y($)==="[object Object]"&&($="[object Object]"),$=String($),A===null&&(A={}),k==="tag:yaml.org,2002:merge")if(Array.isArray(H))for(ye=0,_e=H.length;ye<_e;ye+=1)Y(O,A,H[ye],L);else Y(O,A,H,L);else O.json||f.call(L,$)||!f.call(A,$)||(O.line=se||O.line,O.position=me||O.position,F(O,"duplicated mapping key")),A[$]=H,delete L[$];return A}function B(O){var A;(A=O.input.charCodeAt(O.position))===10?O.position++:A===13?(O.position++,O.input.charCodeAt(O.position)===10&&O.position++):F(O,"a line break is expected"),O.line+=1,O.lineStart=O.position}function j(O,A,L){for(var k=0,$=O.input.charCodeAt(O.position);$!==0;){for(;m($);)$=O.input.charCodeAt(++O.position);if(A&&$===35)do $=O.input.charCodeAt(++O.position);while($!==10&&$!==13&&$!==0);if(!x($))break;for(B(O),$=O.input.charCodeAt(O.position),k++,O.lineIndent=0;$===32;)O.lineIndent++,$=O.input.charCodeAt(++O.position)}return L!==-1&&k!==0&&O.lineIndent<L&&M(O,"deficient indentation"),k}function ie(O){var A,L=O.position;return!((A=O.input.charCodeAt(L))!==45&&A!==46||A!==O.input.charCodeAt(L+1)||A!==O.input.charCodeAt(L+2)||(L+=3,(A=O.input.charCodeAt(L))!==0&&!v(A)))}function ae(O,A){A===1?O.result+=" ":A>1&&(O.result+=a.repeat(`
`,A-1))}function fe(O,A){var L,k,$=O.tag,H=O.anchor,se=[],me=!1;for(O.anchor!==null&&(O.anchorMap[O.anchor]=se),k=O.input.charCodeAt(O.position);k!==0&&k===45&&v(O.input.charCodeAt(O.position+1));)if(me=!0,O.position++,j(O,!0,-1)&&O.lineIndent<=A)se.push(null),k=O.input.charCodeAt(O.position);else if(L=O.line,be(O,A,3,!1,!0),se.push(O.result),j(O,!0,-1),k=O.input.charCodeAt(O.position),(O.line===L||O.lineIndent>A)&&k!==0)F(O,"bad indentation of a sequence entry");else if(O.lineIndent<A)break;return!!me&&(O.tag=$,O.anchor=H,O.kind="sequence",O.result=se,!0)}function Ee(O){var A,L,k,$,H=!1,se=!1;if(($=O.input.charCodeAt(O.position))!==33)return!1;if(O.tag!==null&&F(O,"duplication of a tag property"),($=O.input.charCodeAt(++O.position))===60?(H=!0,$=O.input.charCodeAt(++O.position)):$===33?(se=!0,L="!!",$=O.input.charCodeAt(++O.position)):L="!",A=O.position,H){do $=O.input.charCodeAt(++O.position);while($!==0&&$!==62);O.position<O.length?(k=O.input.slice(A,O.position),$=O.input.charCodeAt(++O.position)):F(O,"unexpected end of the stream within a verbatim tag")}else{for(;$!==0&&!v($);)$===33&&(se?F(O,"tag suffix cannot contain exclamation marks"):(L=O.input.slice(A-1,O.position+1),d.test(L)||F(O,"named tag handle cannot contain such characters"),se=!0,A=O.position+1)),$=O.input.charCodeAt(++O.position);k=O.input.slice(A,O.position),p.test(k)&&F(O,"tag suffix cannot contain flow indicator characters")}return k&&!g.test(k)&&F(O,"tag name cannot contain such characters: "+k),H?O.tag=k:f.call(O.tagMap,L)?O.tag=O.tagMap[L]+k:L==="!"?O.tag="!"+k:L==="!!"?O.tag="tag:yaml.org,2002:"+k:F(O,'undeclared tag handle "'+L+'"'),!0}function ge(O){var A,L;if((L=O.input.charCodeAt(O.position))!==38)return!1;for(O.anchor!==null&&F(O,"duplication of an anchor property"),L=O.input.charCodeAt(++O.position),A=O.position;L!==0&&!v(L)&&!w(L);)L=O.input.charCodeAt(++O.position);return O.position===A&&F(O,"name of an anchor node must contain at least one character"),O.anchor=O.input.slice(A,O.position),!0}function be(O,A,L,k,$){var H,se,me,ye,_e,K,ne,ce,re=1,ue=!1,De=!1;if(O.listener!==null&&O.listener("open",O),O.tag=null,O.anchor=null,O.kind=null,O.result=null,H=se=me=L===4||L===3,k&&j(O,!0,-1)&&(ue=!0,O.lineIndent>A?re=1:O.lineIndent===A?re=0:O.lineIndent<A&&(re=-1)),re===1)for(;Ee(O)||ge(O);)j(O,!0,-1)?(ue=!0,me=H,O.lineIndent>A?re=1:O.lineIndent===A?re=0:O.lineIndent<A&&(re=-1)):me=!1;if(me&&(me=ue||$),re!==1&&L!==4||(ne=L===1||L===2?A:A+1,ce=O.position-O.lineStart,re===1?me&&(fe(O,ce)||function(te,Ue,Ye){var qe,xe,Fe,ze,$e,Xe=te.tag,ot=te.anchor,rt={},mt={},wt=null,qt=null,nn=null,Pt=!1,Ht=!1;for(te.anchor!==null&&(te.anchorMap[te.anchor]=rt),$e=te.input.charCodeAt(te.position);$e!==0;){if(qe=te.input.charCodeAt(te.position+1),Fe=te.line,ze=te.position,$e!==63&&$e!==58||!v(qe)){if(!be(te,Ye,2,!1,!0))break;if(te.line===Fe){for($e=te.input.charCodeAt(te.position);m($e);)$e=te.input.charCodeAt(++te.position);if($e===58)v($e=te.input.charCodeAt(++te.position))||F(te,"a whitespace character is expected after the key-value separator within a block mapping"),Pt&&(W(te,rt,mt,wt,qt,null),wt=qt=nn=null),Ht=!0,Pt=!1,xe=!1,wt=te.tag,qt=te.result;else{if(!Ht)return te.tag=Xe,te.anchor=ot,!0;F(te,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Ht)return te.tag=Xe,te.anchor=ot,!0;F(te,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else $e===63?(Pt&&(W(te,rt,mt,wt,qt,null),wt=qt=nn=null),Ht=!0,Pt=!0,xe=!0):Pt?(Pt=!1,xe=!0):F(te,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),te.position+=1,$e=qe;if((te.line===Fe||te.lineIndent>Ue)&&(be(te,Ue,4,!0,xe)&&(Pt?qt=te.result:nn=te.result),Pt||(W(te,rt,mt,wt,qt,nn,Fe,ze),wt=qt=nn=null),j(te,!0,-1),$e=te.input.charCodeAt(te.position)),te.lineIndent>Ue&&$e!==0)F(te,"bad indentation of a mapping entry");else if(te.lineIndent<Ue)break}return Pt&&W(te,rt,mt,wt,qt,null),Ht&&(te.tag=Xe,te.anchor=ot,te.kind="mapping",te.result=rt),Ht}(O,ce,ne))||function(te,Ue){var Ye,qe,xe,Fe,ze,$e,Xe,ot,rt,mt,wt=!0,qt=te.tag,nn=te.anchor,Pt={};if((mt=te.input.charCodeAt(te.position))===91)xe=93,$e=!1,qe=[];else{if(mt!==123)return!1;xe=125,$e=!0,qe={}}for(te.anchor!==null&&(te.anchorMap[te.anchor]=qe),mt=te.input.charCodeAt(++te.position);mt!==0;){if(j(te,!0,Ue),(mt=te.input.charCodeAt(te.position))===xe)return te.position++,te.tag=qt,te.anchor=nn,te.kind=$e?"mapping":"sequence",te.result=qe,!0;wt||F(te,"missed comma between flow collection entries"),rt=null,Fe=ze=!1,mt===63&&v(te.input.charCodeAt(te.position+1))&&(Fe=ze=!0,te.position++,j(te,!0,Ue)),Ye=te.line,be(te,Ue,1,!1,!0),ot=te.tag,Xe=te.result,j(te,!0,Ue),mt=te.input.charCodeAt(te.position),!ze&&te.line!==Ye||mt!==58||(Fe=!0,mt=te.input.charCodeAt(++te.position),j(te,!0,Ue),be(te,Ue,1,!1,!0),rt=te.result),$e?W(te,qe,Pt,ot,Xe,rt):Fe?qe.push(W(te,null,Pt,ot,Xe,rt)):qe.push(Xe),j(te,!0,Ue),(mt=te.input.charCodeAt(te.position))===44?(wt=!0,mt=te.input.charCodeAt(++te.position)):wt=!1}F(te,"unexpected end of the stream within a flow collection")}(O,ne)?De=!0:(se&&function(te,Ue){var Ye,qe,xe,Fe,ze,$e=1,Xe=!1,ot=!1,rt=Ue,mt=0,wt=!1;if((Fe=te.input.charCodeAt(te.position))===124)qe=!1;else{if(Fe!==62)return!1;qe=!0}for(te.kind="scalar",te.result="";Fe!==0;)if((Fe=te.input.charCodeAt(++te.position))===43||Fe===45)$e===1?$e=Fe===43?3:2:F(te,"repeat of a chomping mode identifier");else{if(!((xe=48<=(ze=Fe)&&ze<=57?ze-48:-1)>=0))break;xe===0?F(te,"bad explicit indentation width of a block scalar; it cannot be less than one"):ot?F(te,"repeat of an indentation width identifier"):(rt=Ue+xe-1,ot=!0)}if(m(Fe)){do Fe=te.input.charCodeAt(++te.position);while(m(Fe));if(Fe===35)do Fe=te.input.charCodeAt(++te.position);while(!x(Fe)&&Fe!==0)}for(;Fe!==0;){for(B(te),te.lineIndent=0,Fe=te.input.charCodeAt(te.position);(!ot||te.lineIndent<rt)&&Fe===32;)te.lineIndent++,Fe=te.input.charCodeAt(++te.position);if(!ot&&te.lineIndent>rt&&(rt=te.lineIndent),x(Fe))mt++;else{if(te.lineIndent<rt){$e===3?te.result+=a.repeat(`
`,Xe?1+mt:mt):$e===1&&Xe&&(te.result+=`
`);break}for(qe?m(Fe)?(wt=!0,te.result+=a.repeat(`
`,Xe?1+mt:mt)):wt?(wt=!1,te.result+=a.repeat(`
`,mt+1)):mt===0?Xe&&(te.result+=" "):te.result+=a.repeat(`
`,mt):te.result+=a.repeat(`
`,Xe?1+mt:mt),Xe=!0,ot=!0,mt=0,Ye=te.position;!x(Fe)&&Fe!==0;)Fe=te.input.charCodeAt(++te.position);z(te,Ye,te.position,!1)}}return!0}(O,ne)||function(te,Ue){var Ye,qe,xe;if((Ye=te.input.charCodeAt(te.position))!==39)return!1;for(te.kind="scalar",te.result="",te.position++,qe=xe=te.position;(Ye=te.input.charCodeAt(te.position))!==0;)if(Ye===39){if(z(te,qe,te.position,!0),(Ye=te.input.charCodeAt(++te.position))!==39)return!0;qe=te.position,te.position++,xe=te.position}else x(Ye)?(z(te,qe,xe,!0),ae(te,j(te,!1,Ue)),qe=xe=te.position):te.position===te.lineStart&&ie(te)?F(te,"unexpected end of the document within a single quoted scalar"):(te.position++,xe=te.position);F(te,"unexpected end of the stream within a single quoted scalar")}(O,ne)||function(te,Ue){var Ye,qe,xe,Fe,ze,$e,Xe;if(($e=te.input.charCodeAt(te.position))!==34)return!1;for(te.kind="scalar",te.result="",te.position++,Ye=qe=te.position;($e=te.input.charCodeAt(te.position))!==0;){if($e===34)return z(te,Ye,te.position,!0),te.position++,!0;if($e===92){if(z(te,Ye,te.position,!0),x($e=te.input.charCodeAt(++te.position)))j(te,!1,Ue);else if($e<256&&S[$e])te.result+=b[$e],te.position++;else if((ze=(Xe=$e)===120?2:Xe===117?4:Xe===85?8:0)>0){for(xe=ze,Fe=0;xe>0;xe--)(ze=C($e=te.input.charCodeAt(++te.position)))>=0?Fe=(Fe<<4)+ze:F(te,"expected hexadecimal character");te.result+=_(Fe),te.position++}else F(te,"unknown escape sequence");Ye=qe=te.position}else x($e)?(z(te,Ye,qe,!0),ae(te,j(te,!1,Ue)),Ye=qe=te.position):te.position===te.lineStart&&ie(te)?F(te,"unexpected end of the document within a double quoted scalar"):(te.position++,qe=te.position)}F(te,"unexpected end of the stream within a double quoted scalar")}(O,ne)?De=!0:function(te){var Ue,Ye,qe;if((qe=te.input.charCodeAt(te.position))!==42)return!1;for(qe=te.input.charCodeAt(++te.position),Ue=te.position;qe!==0&&!v(qe)&&!w(qe);)qe=te.input.charCodeAt(++te.position);return te.position===Ue&&F(te,"name of an alias node must contain at least one character"),Ye=te.input.slice(Ue,te.position),te.anchorMap.hasOwnProperty(Ye)||F(te,'unidentified alias "'+Ye+'"'),te.result=te.anchorMap[Ye],j(te,!0,-1),!0}(O)?(De=!0,O.tag===null&&O.anchor===null||F(O,"alias node should not have any properties")):function(te,Ue,Ye){var qe,xe,Fe,ze,$e,Xe,ot,rt,mt=te.kind,wt=te.result;if(v(rt=te.input.charCodeAt(te.position))||w(rt)||rt===35||rt===38||rt===42||rt===33||rt===124||rt===62||rt===39||rt===34||rt===37||rt===64||rt===96||(rt===63||rt===45)&&(v(qe=te.input.charCodeAt(te.position+1))||Ye&&w(qe)))return!1;for(te.kind="scalar",te.result="",xe=Fe=te.position,ze=!1;rt!==0;){if(rt===58){if(v(qe=te.input.charCodeAt(te.position+1))||Ye&&w(qe))break}else if(rt===35){if(v(te.input.charCodeAt(te.position-1)))break}else{if(te.position===te.lineStart&&ie(te)||Ye&&w(rt))break;if(x(rt)){if($e=te.line,Xe=te.lineStart,ot=te.lineIndent,j(te,!1,-1),te.lineIndent>=Ue){ze=!0,rt=te.input.charCodeAt(te.position);continue}te.position=Fe,te.line=$e,te.lineStart=Xe,te.lineIndent=ot;break}}ze&&(z(te,xe,Fe,!1),ae(te,te.line-$e),xe=Fe=te.position,ze=!1),m(rt)||(Fe=te.position+1),rt=te.input.charCodeAt(++te.position)}return z(te,xe,Fe,!1),!!te.result||(te.kind=mt,te.result=wt,!1)}(O,ne,L===1)&&(De=!0,O.tag===null&&(O.tag="?")),O.anchor!==null&&(O.anchorMap[O.anchor]=O.result)):re===0&&(De=me&&fe(O,ce))),O.tag!==null&&O.tag!=="!")if(O.tag==="?"){for(O.result!==null&&O.kind!=="scalar"&&F(O,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+O.kind+'"'),ye=0,_e=O.implicitTypes.length;ye<_e;ye+=1)if((K=O.implicitTypes[ye]).resolve(O.result)){O.result=K.construct(O.result),O.tag=K.tag,O.anchor!==null&&(O.anchorMap[O.anchor]=O.result);break}}else f.call(O.typeMap[O.kind||"fallback"],O.tag)?(K=O.typeMap[O.kind||"fallback"][O.tag],O.result!==null&&K.kind!==O.kind&&F(O,"unacceptable node kind for !<"+O.tag+'> tag; it should be "'+K.kind+'", not "'+O.kind+'"'),K.resolve(O.result)?(O.result=K.construct(O.result),O.anchor!==null&&(O.anchorMap[O.anchor]=O.result)):F(O,"cannot resolve a node with !<"+O.tag+"> explicit tag")):F(O,"unknown tag !<"+O.tag+">");return O.listener!==null&&O.listener("close",O),O.tag!==null||O.anchor!==null||De}function Re(O){var A,L,k,$,H=O.position,se=!1;for(O.version=null,O.checkLineBreaks=O.legacy,O.tagMap={},O.anchorMap={};($=O.input.charCodeAt(O.position))!==0&&(j(O,!0,-1),$=O.input.charCodeAt(O.position),!(O.lineIndent>0||$!==37));){for(se=!0,$=O.input.charCodeAt(++O.position),A=O.position;$!==0&&!v($);)$=O.input.charCodeAt(++O.position);for(k=[],(L=O.input.slice(A,O.position)).length<1&&F(O,"directive name must not be less than one character in length");$!==0;){for(;m($);)$=O.input.charCodeAt(++O.position);if($===35){do $=O.input.charCodeAt(++O.position);while($!==0&&!x($));break}if(x($))break;for(A=O.position;$!==0&&!v($);)$=O.input.charCodeAt(++O.position);k.push(O.input.slice(A,O.position))}$!==0&&B(O),f.call(U,L)?U[L](O,L,k):M(O,'unknown document directive "'+L+'"')}j(O,!0,-1),O.lineIndent===0&&O.input.charCodeAt(O.position)===45&&O.input.charCodeAt(O.position+1)===45&&O.input.charCodeAt(O.position+2)===45?(O.position+=3,j(O,!0,-1)):se&&F(O,"directives end mark is expected"),be(O,O.lineIndent-1,4,!1,!0),j(O,!0,-1),O.checkLineBreaks&&h.test(O.input.slice(H,O.position))&&M(O,"non-ASCII line breaks are interpreted as content"),O.documents.push(O.result),O.position===O.lineStart&&ie(O)?O.input.charCodeAt(O.position)===46&&(O.position+=3,j(O,!0,-1)):O.position<O.length-1&&F(O,"end of the stream or a document separator is expected")}function Ne(O,A){A=A||{},(O=String(O)).length!==0&&(O.charCodeAt(O.length-1)!==10&&O.charCodeAt(O.length-1)!==13&&(O+=`
`),O.charCodeAt(0)===65279&&(O=O.slice(1)));var L=new E(O,A),k=O.indexOf("\0");for(k!==-1&&(L.position=k,F(L,"null byte is not allowed in input")),L.input+="\0";L.input.charCodeAt(L.position)===32;)L.lineIndent+=1,L.position+=1;for(;L.position<L.length-1;)Re(L);return L.documents}function Ce(O,A,L){A!==null&&typeof A=="object"&&L===void 0&&(L=A,A=null);var k=Ne(O,L);if(typeof A!="function")return k;for(var $=0,H=k.length;$<H;$+=1)A(k[$])}function P(O,A){var L=Ne(O,A);if(L.length!==0){if(L.length===1)return L[0];throw new o("expected a single document in the stream, but found more")}}n.exports.loadAll=Ce,n.exports.load=P,n.exports.safeLoadAll=function(O,A,L){return typeof A=="object"&&A!==null&&L===void 0&&(L=A,A=null),Ce(O,A,a.extend({schema:c},L))},n.exports.safeLoad=function(O,A){return P(O,a.extend({schema:c},A))}},function(n,r,i){var a=i(38);function o(s,c,l,f,u){this.name=s,this.buffer=c,this.position=l,this.line=f,this.column=u}o.prototype.getSnippet=function(s,c){var l,f,u,h,p;if(!this.buffer)return null;for(s=s||4,c=c||75,l="",f=this.position;f>0&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(f-1))===-1;)if(f-=1,this.position-f>c/2-1){l=" ... ",f+=5;break}for(u="",h=this.position;h<this.buffer.length&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(h))===-1;)if((h+=1)-this.position>c/2-1){u=" ... ",h-=5;break}return p=this.buffer.slice(f,h),a.repeat(" ",s)+l+p+u+`
`+a.repeat(" ",s+this.position-f+l.length)+"^"},o.prototype.toString=function(s){var c,l="";return this.name&&(l+='in "'+this.name+'" '),l+="at line "+(this.line+1)+", column "+(this.column+1),s||(c=this.getSnippet())&&(l+=`:
`+c),l},n.exports=o},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:str",{kind:"scalar",construct:function(o){return o!==null?o:""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(o){return o!==null?o:[]}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:map",{kind:"mapping",construct:function(o){return o!==null?o:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(o){if(o===null)return!0;var s=o.length;return s===1&&o==="~"||s===4&&(o==="null"||o==="Null"||o==="NULL")},construct:function(){return null},predicate:function(o){return o===null},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(o){if(o===null)return!1;var s=o.length;return s===4&&(o==="true"||o==="True"||o==="TRUE")||s===5&&(o==="false"||o==="False"||o==="FALSE")},construct:function(o){return o==="true"||o==="True"||o==="TRUE"},predicate:function(o){return Object.prototype.toString.call(o)==="[object Boolean]"},represent:{lowercase:function(o){return o?"true":"false"},uppercase:function(o){return o?"TRUE":"FALSE"},camelcase:function(o){return o?"True":"False"}},defaultStyle:"lowercase"})},function(n,r,i){var a=i(38),o=i(10);function s(l){return 48<=l&&l<=55}function c(l){return 48<=l&&l<=57}n.exports=new o("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(l){if(l===null)return!1;var f,u,h=l.length,p=0,d=!1;if(!h)return!1;if((f=l[p])!=="-"&&f!=="+"||(f=l[++p]),f==="0"){if(p+1===h)return!0;if((f=l[++p])==="b"){for(p++;p<h;p++)if((f=l[p])!=="_"){if(f!=="0"&&f!=="1")return!1;d=!0}return d&&f!=="_"}if(f==="x"){for(p++;p<h;p++)if((f=l[p])!=="_"){if(!(48<=(u=l.charCodeAt(p))&&u<=57||65<=u&&u<=70||97<=u&&u<=102))return!1;d=!0}return d&&f!=="_"}for(;p<h;p++)if((f=l[p])!=="_"){if(!s(l.charCodeAt(p)))return!1;d=!0}return d&&f!=="_"}if(f==="_")return!1;for(;p<h;p++)if((f=l[p])!=="_"){if(f===":")break;if(!c(l.charCodeAt(p)))return!1;d=!0}return!(!d||f==="_")&&(f!==":"||/^(:[0-5]?[0-9])+$/.test(l.slice(p)))},construct:function(l){var f,u,h=l,p=1,d=[];return h.indexOf("_")!==-1&&(h=h.replace(/_/g,"")),(f=h[0])!=="-"&&f!=="+"||(f==="-"&&(p=-1),f=(h=h.slice(1))[0]),h==="0"?0:f==="0"?h[1]==="b"?p*parseInt(h.slice(2),2):h[1]==="x"?p*parseInt(h,16):p*parseInt(h,8):h.indexOf(":")!==-1?(h.split(":").forEach(function(g){d.unshift(parseInt(g,10))}),h=0,u=1,d.forEach(function(g){h+=g*u,u*=60}),p*h):p*parseInt(h,10)},predicate:function(l){return Object.prototype.toString.call(l)==="[object Number]"&&l%1==0&&!a.isNegativeZero(l)},represent:{binary:function(l){return l>=0?"0b"+l.toString(2):"-0b"+l.toString(2).slice(1)},octal:function(l){return l>=0?"0"+l.toString(8):"-0"+l.toString(8).slice(1)},decimal:function(l){return l.toString(10)},hexadecimal:function(l){return l>=0?"0x"+l.toString(16).toUpperCase():"-0x"+l.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},function(n,r,i){var a=i(38),o=i(10),s=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),c=/^[-+]?[0-9]+e/;n.exports=new o("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(l){return l!==null&&!(!s.test(l)||l[l.length-1]==="_")},construct:function(l){var f,u,h,p;return u=(f=l.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,p=[],"+-".indexOf(f[0])>=0&&(f=f.slice(1)),f===".inf"?u===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:f===".nan"?NaN:f.indexOf(":")>=0?(f.split(":").forEach(function(d){p.unshift(parseFloat(d,10))}),f=0,h=1,p.forEach(function(d){f+=d*h,h*=60}),u*f):u*parseFloat(f,10)},predicate:function(l){return Object.prototype.toString.call(l)==="[object Number]"&&(l%1!=0||a.isNegativeZero(l))},represent:function(l,f){var u;if(isNaN(l))switch(f){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===l)switch(f){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===l)switch(f){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(a.isNegativeZero(l))return"-0.0";return u=l.toString(10),c.test(u)?u.replace("e",".e"):u},defaultStyle:"lowercase"})},function(n,r,i){var a=i(10),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),s=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");n.exports=new a("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(c){return c!==null&&(o.exec(c)!==null||s.exec(c)!==null)},construct:function(c){var l,f,u,h,p,d,g,y,x=0,m=null;if((l=o.exec(c))===null&&(l=s.exec(c)),l===null)throw new Error("Date resolve error");if(f=+l[1],u=+l[2]-1,h=+l[3],!l[4])return new Date(Date.UTC(f,u,h));if(p=+l[4],d=+l[5],g=+l[6],l[7]){for(x=l[7].slice(0,3);x.length<3;)x+="0";x=+x}return l[9]&&(m=6e4*(60*+l[10]+ +(l[11]||0)),l[9]==="-"&&(m=-m)),y=new Date(Date.UTC(f,u,h,p,d,g,x)),m&&y.setTime(y.getTime()-m),y},instanceOf:Date,represent:function(c){return c.toISOString()}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(o){return o==="<<"||o===null}})},function(n,r,i){var a;try{a=i(145).Buffer}catch{}var o=i(10),s=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;n.exports=new o("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(c){if(c===null)return!1;var l,f,u=0,h=c.length,p=s;for(f=0;f<h;f++)if(!((l=p.indexOf(c.charAt(f)))>64)){if(l<0)return!1;u+=6}return u%8==0},construct:function(c){var l,f,u=c.replace(/[\r\n=]/g,""),h=u.length,p=s,d=0,g=[];for(l=0;l<h;l++)l%4==0&&l&&(g.push(d>>16&255),g.push(d>>8&255),g.push(255&d)),d=d<<6|p.indexOf(u.charAt(l));return(f=h%4*6)===0?(g.push(d>>16&255),g.push(d>>8&255),g.push(255&d)):f===18?(g.push(d>>10&255),g.push(d>>2&255)):f===12&&g.push(d>>4&255),a?a.from?a.from(g):new a(g):g},predicate:function(c){return a&&a.isBuffer(c)},represent:function(c){var l,f,u="",h=0,p=c.length,d=s;for(l=0;l<p;l++)l%3==0&&l&&(u+=d[h>>18&63],u+=d[h>>12&63],u+=d[h>>6&63],u+=d[63&h]),h=(h<<8)+c[l];return(f=p%3)===0?(u+=d[h>>18&63],u+=d[h>>12&63],u+=d[h>>6&63],u+=d[63&h]):f===2?(u+=d[h>>10&63],u+=d[h>>4&63],u+=d[h<<2&63],u+=d[64]):f===1&&(u+=d[h>>2&63],u+=d[h<<4&63],u+=d[64],u+=d[64]),u}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty,s=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(c){if(c===null)return!0;var l,f,u,h,p,d=[],g=c;for(l=0,f=g.length;l<f;l+=1){if(u=g[l],p=!1,s.call(u)!=="[object Object]")return!1;for(h in u)if(o.call(u,h)){if(p)return!1;p=!0}if(!p||d.indexOf(h)!==-1)return!1;d.push(h)}return!0},construct:function(c){return c!==null?c:[]}})},function(n,r,i){var a=i(10),o=Object.prototype.toString;n.exports=new a("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(s){if(s===null)return!0;var c,l,f,u,h,p=s;for(h=new Array(p.length),c=0,l=p.length;c<l;c+=1){if(f=p[c],o.call(f)!=="[object Object]"||(u=Object.keys(f)).length!==1)return!1;h[c]=[u[0],f[u[0]]]}return!0},construct:function(s){if(s===null)return[];var c,l,f,u,h,p=s;for(h=new Array(p.length),c=0,l=p.length;c<l;c+=1)f=p[c],u=Object.keys(f),h[c]=[u[0],f[u[0]]];return h}})},function(n,r,i){var a=i(10),o=Object.prototype.hasOwnProperty;n.exports=new a("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(s){if(s===null)return!0;var c,l=s;for(c in l)if(o.call(l,c)&&l[c]!==null)return!1;return!0},construct:function(s){return s!==null?s:{}}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(o){return o===void 0},represent:function(){return""}})},function(n,r,i){var a=i(10);n.exports=new a("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(o){if(o===null||o.length===0)return!1;var s=o,c=/\/([gim]*)$/.exec(o),l="";return!(s[0]==="/"&&(c&&(l=c[1]),l.length>3||s[s.length-l.length-1]!=="/"))},construct:function(o){var s=o,c=/\/([gim]*)$/.exec(o),l="";return s[0]==="/"&&(c&&(l=c[1]),s=s.slice(1,s.length-l.length-1)),new RegExp(s,l)},predicate:function(o){return Object.prototype.toString.call(o)==="[object RegExp]"},represent:function(o){var s="/"+o.source+"/";return o.global&&(s+="g"),o.multiline&&(s+="m"),o.ignoreCase&&(s+="i"),s}})},function(n,r,i){var a;try{a=i(302)}catch{typeof window<"u"&&(a=window.esprima)}var o=i(10);n.exports=new o("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(s){if(s===null)return!1;try{var c="("+s+")",l=a.parse(c,{range:!0});return l.type==="Program"&&l.body.length===1&&l.body[0].type==="ExpressionStatement"&&(l.body[0].expression.type==="ArrowFunctionExpression"||l.body[0].expression.type==="FunctionExpression")}catch{return!1}},construct:function(s){var c,l="("+s+")",f=a.parse(l,{range:!0}),u=[];if(f.type!=="Program"||f.body.length!==1||f.body[0].type!=="ExpressionStatement"||f.body[0].expression.type!=="ArrowFunctionExpression"&&f.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return f.body[0].expression.params.forEach(function(h){u.push(h.name)}),c=f.body[0].expression.body.range,f.body[0].expression.body.type==="BlockStatement"?new Function(u,l.slice(c[0]+1,c[1]-1)):new Function(u,"return "+l.slice(c[0],c[1]))},predicate:function(s){return Object.prototype.toString.call(s)==="[object Function]"},represent:function(s){return s.toString()}})},function(n,r,i){var a;a=function(){return function(o){var s={};function c(l){if(s[l])return s[l].exports;var f=s[l]={exports:{},id:l,loaded:!1};return o[l].call(f.exports,f,f.exports,c),f.loaded=!0,f.exports}return c.m=o,c.c=s,c.p="",c(0)}([function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(1),f=c(3),u=c(8),h=c(15);function p(g,y,x){var m=null,v=function(D,E){x&&x(D,E),m&&m.visit(D,E)},w=typeof x=="function"?v:null,C=!1;if(y){C=typeof y.comment=="boolean"&&y.comment;var T=typeof y.attachComment=="boolean"&&y.attachComment;(C||T)&&((m=new l.CommentHandler).attach=T,y.comment=!0,w=v)}var _,S=!1;y&&typeof y.sourceType=="string"&&(S=y.sourceType==="module"),_=y&&typeof y.jsx=="boolean"&&y.jsx?new f.JSXParser(g,y,w):new u.Parser(g,y,w);var b=S?_.parseModule():_.parseScript();return C&&m&&(b.comments=m.comments),_.config.tokens&&(b.tokens=_.tokens),_.config.tolerant&&(b.errors=_.errorHandler.errors),b}s.parse=p,s.parseModule=function(g,y,x){var m=y||{};return m.sourceType="module",p(g,m,x)},s.parseScript=function(g,y,x){var m=y||{};return m.sourceType="script",p(g,m,x)},s.tokenize=function(g,y,x){var m,v=new h.Tokenizer(g,y);m=[];try{for(;;){var w=v.getNextToken();if(!w)break;x&&(w=x(w)),m.push(w)}}catch(C){v.errorHandler.tolerate(C)}return v.errorHandler.tolerant&&(m.errors=v.errors()),m};var d=c(2);s.Syntax=d.Syntax,s.version="4.0.1"},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(2),f=function(){function u(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return u.prototype.insertInnerComments=function(h,p){if(h.type===l.Syntax.BlockStatement&&h.body.length===0){for(var d=[],g=this.leading.length-1;g>=0;--g){var y=this.leading[g];p.end.offset>=y.start&&(d.unshift(y.comment),this.leading.splice(g,1),this.trailing.splice(g,1))}d.length&&(h.innerComments=d)}},u.prototype.findTrailingComments=function(h){var p=[];if(this.trailing.length>0){for(var d=this.trailing.length-1;d>=0;--d){var g=this.trailing[d];g.start>=h.end.offset&&p.unshift(g.comment)}return this.trailing.length=0,p}var y=this.stack[this.stack.length-1];if(y&&y.node.trailingComments){var x=y.node.trailingComments[0];x&&x.range[0]>=h.end.offset&&(p=y.node.trailingComments,delete y.node.trailingComments)}return p},u.prototype.findLeadingComments=function(h){for(var p,d=[];this.stack.length>0&&(x=this.stack[this.stack.length-1])&&x.start>=h.start.offset;)p=x.node,this.stack.pop();if(p){for(var g=(p.leadingComments?p.leadingComments.length:0)-1;g>=0;--g){var y=p.leadingComments[g];y.range[1]<=h.start.offset&&(d.unshift(y),p.leadingComments.splice(g,1))}return p.leadingComments&&p.leadingComments.length===0&&delete p.leadingComments,d}for(g=this.leading.length-1;g>=0;--g){var x;(x=this.leading[g]).start<=h.start.offset&&(d.unshift(x.comment),this.leading.splice(g,1))}return d},u.prototype.visitNode=function(h,p){if(!(h.type===l.Syntax.Program&&h.body.length>0)){this.insertInnerComments(h,p);var d=this.findTrailingComments(p),g=this.findLeadingComments(p);g.length>0&&(h.leadingComments=g),d.length>0&&(h.trailingComments=d),this.stack.push({node:h,start:p.start.offset})}},u.prototype.visitComment=function(h,p){var d=h.type[0]==="L"?"Line":"Block",g={type:d,value:h.value};if(h.range&&(g.range=h.range),h.loc&&(g.loc=h.loc),this.comments.push(g),this.attach){var y={comment:{type:d,value:h.value,range:[p.start.offset,p.end.offset]},start:p.start.offset};h.loc&&(y.comment.loc=h.loc),h.type=d,this.leading.push(y),this.trailing.push(y)}},u.prototype.visit=function(h,p){h.type==="LineComment"||h.type==="BlockComment"?this.visitComment(h,p):this.attach&&this.visitNode(h,p)},u}();s.CommentHandler=f},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(o,s,c){var l,f=this&&this.__extends||(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,C){w.__proto__=C}||function(w,C){for(var T in C)C.hasOwnProperty(T)&&(w[T]=C[T])},function(w,C){function T(){this.constructor=w}l(w,C),w.prototype=C===null?Object.create(C):(T.prototype=C.prototype,new T)});Object.defineProperty(s,"__esModule",{value:!0});var u=c(4),h=c(5),p=c(6),d=c(7),g=c(8),y=c(13),x=c(14);function m(w){var C;switch(w.type){case p.JSXSyntax.JSXIdentifier:C=w.name;break;case p.JSXSyntax.JSXNamespacedName:var T=w;C=m(T.namespace)+":"+m(T.name);break;case p.JSXSyntax.JSXMemberExpression:var _=w;C=m(_.object)+"."+m(_.property)}return C}y.TokenName[100]="JSXIdentifier",y.TokenName[101]="JSXText";var v=function(w){function C(T,_,S){return w.call(this,T,_,S)||this}return f(C,w),C.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():w.prototype.parsePrimaryExpression.call(this)},C.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},C.prototype.finishJSX=function(){this.nextToken()},C.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},C.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},C.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},C.prototype.scanXHTMLEntity=function(T){for(var _="&",S=!0,b=!1,D=!1,E=!1;!this.scanner.eof()&&S&&!b;){var R=this.scanner.source[this.scanner.index];if(R===T)break;if(b=R===";",_+=R,++this.scanner.index,!b)switch(_.length){case 2:D=R==="#";break;case 3:D&&(S=(E=R==="x")||u.Character.isDecimalDigit(R.charCodeAt(0)),D=D&&!E);break;default:S=(S=S&&!(D&&!u.Character.isDecimalDigit(R.charCodeAt(0))))&&!(E&&!u.Character.isHexDigit(R.charCodeAt(0)))}}if(S&&b&&_.length>2){var F=_.substr(1,_.length-2);D&&F.length>1?_=String.fromCharCode(parseInt(F.substr(1),10)):E&&F.length>2?_=String.fromCharCode(parseInt("0"+F.substr(1),16)):D||E||!x.XHTMLEntities[F]||(_=x.XHTMLEntities[F])}return _},C.prototype.lexJSX=function(){var T=this.scanner.source.charCodeAt(this.scanner.index);if(T===60||T===62||T===47||T===58||T===61||T===123||T===125)return{type:7,value:R=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(T===34||T===39){for(var _=this.scanner.index,S=this.scanner.source[this.scanner.index++],b="";!this.scanner.eof()&&(F=this.scanner.source[this.scanner.index++])!==S;)b+=F==="&"?this.scanXHTMLEntity(S):F;return{type:8,value:b,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===46){var D=this.scanner.source.charCodeAt(this.scanner.index+1),E=this.scanner.source.charCodeAt(this.scanner.index+2),R=D===46&&E===46?"...":".";return _=this.scanner.index,this.scanner.index+=R.length,{type:7,value:R,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}if(T===96)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(u.Character.isIdentifierStart(T)&&T!==92){for(_=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var F=this.scanner.source.charCodeAt(this.scanner.index);if(u.Character.isIdentifierPart(F)&&F!==92)++this.scanner.index;else{if(F!==45)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(_,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:_,end:this.scanner.index}}return this.scanner.lex()},C.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var T=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(T)),T},C.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var T=this.scanner.index,_="";!this.scanner.eof();){var S=this.scanner.source[this.scanner.index];if(S==="{"||S==="<")break;++this.scanner.index,_+=S,u.Character.isLineTerminator(S.charCodeAt(0))&&(++this.scanner.lineNumber,S==="\r"&&this.scanner.source[this.scanner.index]===`
`&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var b={type:101,value:_,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:T,end:this.scanner.index};return _.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(b)),b},C.prototype.peekJSXToken=function(){var T=this.scanner.saveState();this.scanner.scanComments();var _=this.lexJSX();return this.scanner.restoreState(T),_},C.prototype.expectJSX=function(T){var _=this.nextJSXToken();_.type===7&&_.value===T||this.throwUnexpectedToken(_)},C.prototype.matchJSX=function(T){var _=this.peekJSXToken();return _.type===7&&_.value===T},C.prototype.parseJSXIdentifier=function(){var T=this.createJSXNode(),_=this.nextJSXToken();return _.type!==100&&this.throwUnexpectedToken(_),this.finalize(T,new h.JSXIdentifier(_.value))},C.prototype.parseJSXElementName=function(){var T=this.createJSXNode(),_=this.parseJSXIdentifier();if(this.matchJSX(":")){var S=_;this.expectJSX(":");var b=this.parseJSXIdentifier();_=this.finalize(T,new h.JSXNamespacedName(S,b))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var D=_;this.expectJSX(".");var E=this.parseJSXIdentifier();_=this.finalize(T,new h.JSXMemberExpression(D,E))}return _},C.prototype.parseJSXAttributeName=function(){var T,_=this.createJSXNode(),S=this.parseJSXIdentifier();if(this.matchJSX(":")){var b=S;this.expectJSX(":");var D=this.parseJSXIdentifier();T=this.finalize(_,new h.JSXNamespacedName(b,D))}else T=S;return T},C.prototype.parseJSXStringLiteralAttribute=function(){var T=this.createJSXNode(),_=this.nextJSXToken();_.type!==8&&this.throwUnexpectedToken(_);var S=this.getTokenRaw(_);return this.finalize(T,new d.Literal(_.value,S))},C.prototype.parseJSXExpressionAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new h.JSXExpressionContainer(_))},C.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},C.prototype.parseJSXNameValueAttribute=function(){var T=this.createJSXNode(),_=this.parseJSXAttributeName(),S=null;return this.matchJSX("=")&&(this.expectJSX("="),S=this.parseJSXAttributeValue()),this.finalize(T,new h.JSXAttribute(_,S))},C.prototype.parseJSXSpreadAttribute=function(){var T=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var _=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(T,new h.JSXSpreadAttribute(_))},C.prototype.parseJSXAttributes=function(){for(var T=[];!this.matchJSX("/")&&!this.matchJSX(">");){var _=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();T.push(_)}return T},C.prototype.parseJSXOpeningElement=function(){var T=this.createJSXNode();this.expectJSX("<");var _=this.parseJSXElementName(),S=this.parseJSXAttributes(),b=this.matchJSX("/");return b&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new h.JSXOpeningElement(_,b,S))},C.prototype.parseJSXBoundaryElement=function(){var T=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var _=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(T,new h.JSXClosingElement(_))}var S=this.parseJSXElementName(),b=this.parseJSXAttributes(),D=this.matchJSX("/");return D&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(T,new h.JSXOpeningElement(S,D,b))},C.prototype.parseJSXEmptyExpression=function(){var T=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(T,new h.JSXEmptyExpression)},C.prototype.parseJSXExpressionContainer=function(){var T,_=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(T=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),T=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(_,new h.JSXExpressionContainer(T))},C.prototype.parseJSXChildren=function(){for(var T=[];!this.scanner.eof();){var _=this.createJSXChildNode(),S=this.nextJSXText();if(S.start<S.end){var b=this.getTokenRaw(S),D=this.finalize(_,new h.JSXText(S.value,b));T.push(D)}if(this.scanner.source[this.scanner.index]!=="{")break;var E=this.parseJSXExpressionContainer();T.push(E)}return T},C.prototype.parseComplexJSXElement=function(T){for(var _=[];!this.scanner.eof();){T.children=T.children.concat(this.parseJSXChildren());var S=this.createJSXChildNode(),b=this.parseJSXBoundaryElement();if(b.type===p.JSXSyntax.JSXOpeningElement){var D=b;if(D.selfClosing){var E=this.finalize(S,new h.JSXElement(D,[],null));T.children.push(E)}else _.push(T),T={node:S,opening:D,closing:null,children:[]}}if(b.type===p.JSXSyntax.JSXClosingElement){T.closing=b;var R=m(T.opening.name);if(R!==m(T.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",R),!(_.length>0))break;E=this.finalize(T.node,new h.JSXElement(T.opening,T.children,T.closing)),(T=_[_.length-1]).children.push(E),_.pop()}}return T},C.prototype.parseJSXElement=function(){var T=this.createJSXNode(),_=this.parseJSXOpeningElement(),S=[],b=null;if(!_.selfClosing){var D=this.parseComplexJSXElement({node:T,opening:_,closing:b,children:S});S=D.children,b=D.closing}return this.finalize(T,new h.JSXElement(_,S,b))},C.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var T=this.parseJSXElement();return this.finishJSX(),T},C.prototype.isStartOfExpression=function(){return w.prototype.isStartOfExpression.call(this)||this.match("<")},C}(g.Parser);s.JSXParser=v},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var c={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};s.Character={fromCodePoint:function(l){return l<65536?String.fromCharCode(l):String.fromCharCode(55296+(l-65536>>10))+String.fromCharCode(56320+(l-65536&1023))},isWhiteSpace:function(l){return l===32||l===9||l===11||l===12||l===160||l>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(l)>=0},isLineTerminator:function(l){return l===10||l===13||l===8232||l===8233},isIdentifierStart:function(l){return l===36||l===95||l>=65&&l<=90||l>=97&&l<=122||l===92||l>=128&&c.NonAsciiIdentifierStart.test(s.Character.fromCodePoint(l))},isIdentifierPart:function(l){return l===36||l===95||l>=65&&l<=90||l>=97&&l<=122||l>=48&&l<=57||l===92||l>=128&&c.NonAsciiIdentifierPart.test(s.Character.fromCodePoint(l))},isDecimalDigit:function(l){return l>=48&&l<=57},isHexDigit:function(l){return l>=48&&l<=57||l>=65&&l<=70||l>=97&&l<=102},isOctalDigit:function(l){return l>=48&&l<=55}}},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(6),f=function(C){this.type=l.JSXSyntax.JSXClosingElement,this.name=C};s.JSXClosingElement=f;var u=function(C,T,_){this.type=l.JSXSyntax.JSXElement,this.openingElement=C,this.children=T,this.closingElement=_};s.JSXElement=u;var h=function(){this.type=l.JSXSyntax.JSXEmptyExpression};s.JSXEmptyExpression=h;var p=function(C){this.type=l.JSXSyntax.JSXExpressionContainer,this.expression=C};s.JSXExpressionContainer=p;var d=function(C){this.type=l.JSXSyntax.JSXIdentifier,this.name=C};s.JSXIdentifier=d;var g=function(C,T){this.type=l.JSXSyntax.JSXMemberExpression,this.object=C,this.property=T};s.JSXMemberExpression=g;var y=function(C,T){this.type=l.JSXSyntax.JSXAttribute,this.name=C,this.value=T};s.JSXAttribute=y;var x=function(C,T){this.type=l.JSXSyntax.JSXNamespacedName,this.namespace=C,this.name=T};s.JSXNamespacedName=x;var m=function(C,T,_){this.type=l.JSXSyntax.JSXOpeningElement,this.name=C,this.selfClosing=T,this.attributes=_};s.JSXOpeningElement=m;var v=function(C){this.type=l.JSXSyntax.JSXSpreadAttribute,this.argument=C};s.JSXSpreadAttribute=v;var w=function(C,T){this.type=l.JSXSyntax.JSXText,this.value=C,this.raw=T};s.JSXText=w},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(2),f=function(Le){this.type=l.Syntax.ArrayExpression,this.elements=Le};s.ArrayExpression=f;var u=function(Le){this.type=l.Syntax.ArrayPattern,this.elements=Le};s.ArrayPattern=u;var h=function(Le,Ke,dt){this.type=l.Syntax.ArrowFunctionExpression,this.id=null,this.params=Le,this.body=Ke,this.generator=!1,this.expression=dt,this.async=!1};s.ArrowFunctionExpression=h;var p=function(Le,Ke,dt){this.type=l.Syntax.AssignmentExpression,this.operator=Le,this.left=Ke,this.right=dt};s.AssignmentExpression=p;var d=function(Le,Ke){this.type=l.Syntax.AssignmentPattern,this.left=Le,this.right=Ke};s.AssignmentPattern=d;var g=function(Le,Ke,dt){this.type=l.Syntax.ArrowFunctionExpression,this.id=null,this.params=Le,this.body=Ke,this.generator=!1,this.expression=dt,this.async=!0};s.AsyncArrowFunctionExpression=g;var y=function(Le,Ke,dt){this.type=l.Syntax.FunctionDeclaration,this.id=Le,this.params=Ke,this.body=dt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionDeclaration=y;var x=function(Le,Ke,dt){this.type=l.Syntax.FunctionExpression,this.id=Le,this.params=Ke,this.body=dt,this.generator=!1,this.expression=!1,this.async=!0};s.AsyncFunctionExpression=x;var m=function(Le){this.type=l.Syntax.AwaitExpression,this.argument=Le};s.AwaitExpression=m;var v=function(Le,Ke,dt){var Vt=Le==="||"||Le==="&&";this.type=Vt?l.Syntax.LogicalExpression:l.Syntax.BinaryExpression,this.operator=Le,this.left=Ke,this.right=dt};s.BinaryExpression=v;var w=function(Le){this.type=l.Syntax.BlockStatement,this.body=Le};s.BlockStatement=w;var C=function(Le){this.type=l.Syntax.BreakStatement,this.label=Le};s.BreakStatement=C;var T=function(Le,Ke){this.type=l.Syntax.CallExpression,this.callee=Le,this.arguments=Ke};s.CallExpression=T;var _=function(Le,Ke){this.type=l.Syntax.CatchClause,this.param=Le,this.body=Ke};s.CatchClause=_;var S=function(Le){this.type=l.Syntax.ClassBody,this.body=Le};s.ClassBody=S;var b=function(Le,Ke,dt){this.type=l.Syntax.ClassDeclaration,this.id=Le,this.superClass=Ke,this.body=dt};s.ClassDeclaration=b;var D=function(Le,Ke,dt){this.type=l.Syntax.ClassExpression,this.id=Le,this.superClass=Ke,this.body=dt};s.ClassExpression=D;var E=function(Le,Ke){this.type=l.Syntax.MemberExpression,this.computed=!0,this.object=Le,this.property=Ke};s.ComputedMemberExpression=E;var R=function(Le,Ke,dt){this.type=l.Syntax.ConditionalExpression,this.test=Le,this.consequent=Ke,this.alternate=dt};s.ConditionalExpression=R;var F=function(Le){this.type=l.Syntax.ContinueStatement,this.label=Le};s.ContinueStatement=F;var M=function(){this.type=l.Syntax.DebuggerStatement};s.DebuggerStatement=M;var U=function(Le,Ke){this.type=l.Syntax.ExpressionStatement,this.expression=Le,this.directive=Ke};s.Directive=U;var z=function(Le,Ke){this.type=l.Syntax.DoWhileStatement,this.body=Le,this.test=Ke};s.DoWhileStatement=z;var Y=function(){this.type=l.Syntax.EmptyStatement};s.EmptyStatement=Y;var W=function(Le){this.type=l.Syntax.ExportAllDeclaration,this.source=Le};s.ExportAllDeclaration=W;var B=function(Le){this.type=l.Syntax.ExportDefaultDeclaration,this.declaration=Le};s.ExportDefaultDeclaration=B;var j=function(Le,Ke,dt){this.type=l.Syntax.ExportNamedDeclaration,this.declaration=Le,this.specifiers=Ke,this.source=dt};s.ExportNamedDeclaration=j;var ie=function(Le,Ke){this.type=l.Syntax.ExportSpecifier,this.exported=Ke,this.local=Le};s.ExportSpecifier=ie;var ae=function(Le){this.type=l.Syntax.ExpressionStatement,this.expression=Le};s.ExpressionStatement=ae;var fe=function(Le,Ke,dt){this.type=l.Syntax.ForInStatement,this.left=Le,this.right=Ke,this.body=dt,this.each=!1};s.ForInStatement=fe;var Ee=function(Le,Ke,dt){this.type=l.Syntax.ForOfStatement,this.left=Le,this.right=Ke,this.body=dt};s.ForOfStatement=Ee;var ge=function(Le,Ke,dt,Vt){this.type=l.Syntax.ForStatement,this.init=Le,this.test=Ke,this.update=dt,this.body=Vt};s.ForStatement=ge;var be=function(Le,Ke,dt,Vt){this.type=l.Syntax.FunctionDeclaration,this.id=Le,this.params=Ke,this.body=dt,this.generator=Vt,this.expression=!1,this.async=!1};s.FunctionDeclaration=be;var Re=function(Le,Ke,dt,Vt){this.type=l.Syntax.FunctionExpression,this.id=Le,this.params=Ke,this.body=dt,this.generator=Vt,this.expression=!1,this.async=!1};s.FunctionExpression=Re;var Ne=function(Le){this.type=l.Syntax.Identifier,this.name=Le};s.Identifier=Ne;var Ce=function(Le,Ke,dt){this.type=l.Syntax.IfStatement,this.test=Le,this.consequent=Ke,this.alternate=dt};s.IfStatement=Ce;var P=function(Le,Ke){this.type=l.Syntax.ImportDeclaration,this.specifiers=Le,this.source=Ke};s.ImportDeclaration=P;var O=function(Le){this.type=l.Syntax.ImportDefaultSpecifier,this.local=Le};s.ImportDefaultSpecifier=O;var A=function(Le){this.type=l.Syntax.ImportNamespaceSpecifier,this.local=Le};s.ImportNamespaceSpecifier=A;var L=function(Le,Ke){this.type=l.Syntax.ImportSpecifier,this.local=Le,this.imported=Ke};s.ImportSpecifier=L;var k=function(Le,Ke){this.type=l.Syntax.LabeledStatement,this.label=Le,this.body=Ke};s.LabeledStatement=k;var $=function(Le,Ke){this.type=l.Syntax.Literal,this.value=Le,this.raw=Ke};s.Literal=$;var H=function(Le,Ke){this.type=l.Syntax.MetaProperty,this.meta=Le,this.property=Ke};s.MetaProperty=H;var se=function(Le,Ke,dt,Vt,Qn){this.type=l.Syntax.MethodDefinition,this.key=Le,this.computed=Ke,this.value=dt,this.kind=Vt,this.static=Qn};s.MethodDefinition=se;var me=function(Le){this.type=l.Syntax.Program,this.body=Le,this.sourceType="module"};s.Module=me;var ye=function(Le,Ke){this.type=l.Syntax.NewExpression,this.callee=Le,this.arguments=Ke};s.NewExpression=ye;var _e=function(Le){this.type=l.Syntax.ObjectExpression,this.properties=Le};s.ObjectExpression=_e;var K=function(Le){this.type=l.Syntax.ObjectPattern,this.properties=Le};s.ObjectPattern=K;var ne=function(Le,Ke,dt,Vt,Qn,ht){this.type=l.Syntax.Property,this.key=Ke,this.computed=dt,this.value=Vt,this.kind=Le,this.method=Qn,this.shorthand=ht};s.Property=ne;var ce=function(Le,Ke,dt,Vt){this.type=l.Syntax.Literal,this.value=Le,this.raw=Ke,this.regex={pattern:dt,flags:Vt}};s.RegexLiteral=ce;var re=function(Le){this.type=l.Syntax.RestElement,this.argument=Le};s.RestElement=re;var ue=function(Le){this.type=l.Syntax.ReturnStatement,this.argument=Le};s.ReturnStatement=ue;var De=function(Le){this.type=l.Syntax.Program,this.body=Le,this.sourceType="script"};s.Script=De;var te=function(Le){this.type=l.Syntax.SequenceExpression,this.expressions=Le};s.SequenceExpression=te;var Ue=function(Le){this.type=l.Syntax.SpreadElement,this.argument=Le};s.SpreadElement=Ue;var Ye=function(Le,Ke){this.type=l.Syntax.MemberExpression,this.computed=!1,this.object=Le,this.property=Ke};s.StaticMemberExpression=Ye;var qe=function(){this.type=l.Syntax.Super};s.Super=qe;var xe=function(Le,Ke){this.type=l.Syntax.SwitchCase,this.test=Le,this.consequent=Ke};s.SwitchCase=xe;var Fe=function(Le,Ke){this.type=l.Syntax.SwitchStatement,this.discriminant=Le,this.cases=Ke};s.SwitchStatement=Fe;var ze=function(Le,Ke){this.type=l.Syntax.TaggedTemplateExpression,this.tag=Le,this.quasi=Ke};s.TaggedTemplateExpression=ze;var $e=function(Le,Ke){this.type=l.Syntax.TemplateElement,this.value=Le,this.tail=Ke};s.TemplateElement=$e;var Xe=function(Le,Ke){this.type=l.Syntax.TemplateLiteral,this.quasis=Le,this.expressions=Ke};s.TemplateLiteral=Xe;var ot=function(){this.type=l.Syntax.ThisExpression};s.ThisExpression=ot;var rt=function(Le){this.type=l.Syntax.ThrowStatement,this.argument=Le};s.ThrowStatement=rt;var mt=function(Le,Ke,dt){this.type=l.Syntax.TryStatement,this.block=Le,this.handler=Ke,this.finalizer=dt};s.TryStatement=mt;var wt=function(Le,Ke){this.type=l.Syntax.UnaryExpression,this.operator=Le,this.argument=Ke,this.prefix=!0};s.UnaryExpression=wt;var qt=function(Le,Ke,dt){this.type=l.Syntax.UpdateExpression,this.operator=Le,this.argument=Ke,this.prefix=dt};s.UpdateExpression=qt;var nn=function(Le,Ke){this.type=l.Syntax.VariableDeclaration,this.declarations=Le,this.kind=Ke};s.VariableDeclaration=nn;var Pt=function(Le,Ke){this.type=l.Syntax.VariableDeclarator,this.id=Le,this.init=Ke};s.VariableDeclarator=Pt;var Ht=function(Le,Ke){this.type=l.Syntax.WhileStatement,this.test=Le,this.body=Ke};s.WhileStatement=Ht;var Vr=function(Le,Ke){this.type=l.Syntax.WithStatement,this.object=Le,this.body=Ke};s.WithStatement=Vr;var On=function(Le,Ke){this.type=l.Syntax.YieldExpression,this.argument=Le,this.delegate=Ke};s.YieldExpression=On},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(9),f=c(10),u=c(11),h=c(7),p=c(12),d=c(2),g=c(13),y=function(){function x(m,v,w){v===void 0&&(v={}),this.config={range:typeof v.range=="boolean"&&v.range,loc:typeof v.loc=="boolean"&&v.loc,source:null,tokens:typeof v.tokens=="boolean"&&v.tokens,comment:typeof v.comment=="boolean"&&v.comment,tolerant:typeof v.tolerant=="boolean"&&v.tolerant},this.config.loc&&v.source&&v.source!==null&&(this.config.source=String(v.source)),this.delegate=w,this.errorHandler=new f.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new p.Scanner(m,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return x.prototype.throwError=function(m){for(var v=[],w=1;w<arguments.length;w++)v[w-1]=arguments[w];var C=Array.prototype.slice.call(arguments,1),T=m.replace(/%(\d)/g,function(D,E){return l.assert(E<C.length,"Message reference must be in range"),C[E]}),_=this.lastMarker.index,S=this.lastMarker.line,b=this.lastMarker.column+1;throw this.errorHandler.createError(_,S,b,T)},x.prototype.tolerateError=function(m){for(var v=[],w=1;w<arguments.length;w++)v[w-1]=arguments[w];var C=Array.prototype.slice.call(arguments,1),T=m.replace(/%(\d)/g,function(D,E){return l.assert(E<C.length,"Message reference must be in range"),C[E]}),_=this.lastMarker.index,S=this.scanner.lineNumber,b=this.lastMarker.column+1;this.errorHandler.tolerateError(_,S,b,T)},x.prototype.unexpectedTokenError=function(m,v){var w,C=v||u.Messages.UnexpectedToken;if(m?(v||(C=m.type===2?u.Messages.UnexpectedEOS:m.type===3?u.Messages.UnexpectedIdentifier:m.type===6?u.Messages.UnexpectedNumber:m.type===8?u.Messages.UnexpectedString:m.type===10?u.Messages.UnexpectedTemplate:u.Messages.UnexpectedToken,m.type===4&&(this.scanner.isFutureReservedWord(m.value)?C=u.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(m.value)&&(C=u.Messages.StrictReservedWord))),w=m.value):w="ILLEGAL",C=C.replace("%0",w),m&&typeof m.lineNumber=="number"){var T=m.start,_=m.lineNumber,S=this.lastMarker.index-this.lastMarker.column,b=m.start-S+1;return this.errorHandler.createError(T,_,b,C)}return T=this.lastMarker.index,_=this.lastMarker.line,b=this.lastMarker.column+1,this.errorHandler.createError(T,_,b,C)},x.prototype.throwUnexpectedToken=function(m,v){throw this.unexpectedTokenError(m,v)},x.prototype.tolerateUnexpectedToken=function(m,v){this.errorHandler.tolerate(this.unexpectedTokenError(m,v))},x.prototype.collectComments=function(){if(this.config.comment){var m=this.scanner.scanComments();if(m.length>0&&this.delegate)for(var v=0;v<m.length;++v){var w=m[v],C=void 0;C={type:w.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(w.slice[0],w.slice[1])},this.config.range&&(C.range=w.range),this.config.loc&&(C.loc=w.loc);var T={start:{line:w.loc.start.line,column:w.loc.start.column,offset:w.range[0]},end:{line:w.loc.end.line,column:w.loc.end.column,offset:w.range[1]}};this.delegate(C,T)}}else this.scanner.scanComments()},x.prototype.getTokenRaw=function(m){return this.scanner.source.slice(m.start,m.end)},x.prototype.convertToken=function(m){var v={type:g.TokenName[m.type],value:this.getTokenRaw(m)};if(this.config.range&&(v.range=[m.start,m.end]),this.config.loc&&(v.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),m.type===9){var w=m.pattern,C=m.flags;v.regex={pattern:w,flags:C}}return v},x.prototype.nextToken=function(){var m=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var v=this.scanner.lex();return this.hasLineTerminator=m.lineNumber!==v.lineNumber,v&&this.context.strict&&v.type===3&&this.scanner.isStrictModeReservedWord(v.value)&&(v.type=4),this.lookahead=v,this.config.tokens&&v.type!==2&&this.tokens.push(this.convertToken(v)),m},x.prototype.nextRegexToken=function(){this.collectComments();var m=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(m))),this.lookahead=m,this.nextToken(),m},x.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},x.prototype.startNode=function(m,v){v===void 0&&(v=0);var w=m.start-m.lineStart,C=m.lineNumber;return w<0&&(w+=v,C--),{index:m.start,line:C,column:w}},x.prototype.finalize=function(m,v){if(this.config.range&&(v.range=[m.index,this.lastMarker.index]),this.config.loc&&(v.loc={start:{line:m.line,column:m.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(v.loc.source=this.config.source)),this.delegate){var w={start:{line:m.line,column:m.column,offset:m.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(v,w)}return v},x.prototype.expect=function(m){var v=this.nextToken();v.type===7&&v.value===m||this.throwUnexpectedToken(v)},x.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var m=this.lookahead;m.type===7&&m.value===","?this.nextToken():m.type===7&&m.value===";"?(this.nextToken(),this.tolerateUnexpectedToken(m)):this.tolerateUnexpectedToken(m,u.Messages.UnexpectedToken)}else this.expect(",")},x.prototype.expectKeyword=function(m){var v=this.nextToken();v.type===4&&v.value===m||this.throwUnexpectedToken(v)},x.prototype.match=function(m){return this.lookahead.type===7&&this.lookahead.value===m},x.prototype.matchKeyword=function(m){return this.lookahead.type===4&&this.lookahead.value===m},x.prototype.matchContextualKeyword=function(m){return this.lookahead.type===3&&this.lookahead.value===m},x.prototype.matchAssign=function(){if(this.lookahead.type!==7)return!1;var m=this.lookahead.value;return m==="="||m==="*="||m==="**="||m==="/="||m==="%="||m==="+="||m==="-="||m==="<<="||m===">>="||m===">>>="||m==="&="||m==="^="||m==="|="},x.prototype.isolateCoverGrammar=function(m){var v=this.context.isBindingElement,w=this.context.isAssignmentTarget,C=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=m.call(this);return this.context.firstCoverInitializedNameError!==null&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=v,this.context.isAssignmentTarget=w,this.context.firstCoverInitializedNameError=C,T},x.prototype.inheritCoverGrammar=function(m){var v=this.context.isBindingElement,w=this.context.isAssignmentTarget,C=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var T=m.call(this);return this.context.isBindingElement=this.context.isBindingElement&&v,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&w,this.context.firstCoverInitializedNameError=C||this.context.firstCoverInitializedNameError,T},x.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(this.lookahead.type===2||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},x.prototype.parsePrimaryExpression=function(){var m,v,w,C=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&this.lookahead.value==="await"&&this.tolerateUnexpectedToken(this.lookahead),m=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(C,new h.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,u.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,v=this.nextToken(),w=this.getTokenRaw(v),m=this.finalize(C,new h.Literal(v.value,w));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,v=this.nextToken(),w=this.getTokenRaw(v),m=this.finalize(C,new h.Literal(v.value==="true",w));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,v=this.nextToken(),w=this.getTokenRaw(v),m=this.finalize(C,new h.Literal(null,w));break;case 10:m=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,m=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":m=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":m=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,v=this.nextRegexToken(),w=this.getTokenRaw(v),m=this.finalize(C,new h.RegexLiteral(v.regex,w,v.pattern,v.flags));break;default:m=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?m=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?m=this.finalize(C,new h.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?m=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),m=this.finalize(C,new h.ThisExpression)):m=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:m=this.throwUnexpectedToken(this.nextToken())}return m},x.prototype.parseSpreadElement=function(){var m=this.createNode();this.expect("...");var v=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(m,new h.SpreadElement(v))},x.prototype.parseArrayInitializer=function(){var m=this.createNode(),v=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),v.push(null);else if(this.match("...")){var w=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),v.push(w)}else v.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(m,new h.ArrayExpression(v))},x.prototype.parsePropertyMethod=function(m){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var v=this.context.strict,w=this.context.allowStrictDirective;this.context.allowStrictDirective=m.simple;var C=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&m.firstRestricted&&this.tolerateUnexpectedToken(m.firstRestricted,m.message),this.context.strict&&m.stricted&&this.tolerateUnexpectedToken(m.stricted,m.message),this.context.strict=v,this.context.allowStrictDirective=w,C},x.prototype.parsePropertyMethodFunction=function(){var m=this.createNode(),v=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters(),C=this.parsePropertyMethod(w);return this.context.allowYield=v,this.finalize(m,new h.FunctionExpression(null,w.params,C,!1))},x.prototype.parsePropertyMethodAsyncFunction=function(){var m=this.createNode(),v=this.context.allowYield,w=this.context.await;this.context.allowYield=!1,this.context.await=!0;var C=this.parseFormalParameters(),T=this.parsePropertyMethod(C);return this.context.allowYield=v,this.context.await=w,this.finalize(m,new h.AsyncFunctionExpression(null,C.params,T))},x.prototype.parseObjectPropertyKey=function(){var m,v=this.createNode(),w=this.nextToken();switch(w.type){case 8:case 6:this.context.strict&&w.octal&&this.tolerateUnexpectedToken(w,u.Messages.StrictOctalLiteral);var C=this.getTokenRaw(w);m=this.finalize(v,new h.Literal(w.value,C));break;case 3:case 1:case 5:case 4:m=this.finalize(v,new h.Identifier(w.value));break;case 7:w.value==="["?(m=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):m=this.throwUnexpectedToken(w);break;default:m=this.throwUnexpectedToken(w)}return m},x.prototype.isPropertyKey=function(m,v){return m.type===d.Syntax.Identifier&&m.name===v||m.type===d.Syntax.Literal&&m.value===v},x.prototype.parseObjectProperty=function(m){var v,w=this.createNode(),C=this.lookahead,T=null,_=null,S=!1,b=!1,D=!1,E=!1;if(C.type===3){var R=C.value;this.nextToken(),S=this.match("["),T=(E=!(this.hasLineTerminator||R!=="async"||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(w,new h.Identifier(R))}else this.match("*")?this.nextToken():(S=this.match("["),T=this.parseObjectPropertyKey());var F=this.qualifiedPropertyName(this.lookahead);if(C.type===3&&!E&&C.value==="get"&&F)v="get",S=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod();else if(C.type===3&&!E&&C.value==="set"&&F)v="set",S=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod();else if(C.type===7&&C.value==="*"&&F)v="init",S=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),b=!0;else if(T||this.throwUnexpectedToken(this.lookahead),v="init",this.match(":")&&!E)!S&&this.isPropertyKey(T,"__proto__")&&(m.value&&this.tolerateError(u.Messages.DuplicateProtoProperty),m.value=!0),this.nextToken(),_=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))_=E?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),b=!0;else if(C.type===3)if(R=this.finalize(w,new h.Identifier(C.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),D=!0;var M=this.isolateCoverGrammar(this.parseAssignmentExpression);_=this.finalize(w,new h.AssignmentPattern(R,M))}else D=!0,_=R;else this.throwUnexpectedToken(this.nextToken());return this.finalize(w,new h.Property(v,T,S,_,b,D))},x.prototype.parseObjectInitializer=function(){var m=this.createNode();this.expect("{");for(var v=[],w={value:!1};!this.match("}");)v.push(this.parseObjectProperty(w)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(m,new h.ObjectExpression(v))},x.prototype.parseTemplateHead=function(){l.assert(this.lookahead.head,"Template literal must start with a template head");var m=this.createNode(),v=this.nextToken(),w=v.value,C=v.cooked;return this.finalize(m,new h.TemplateElement({raw:w,cooked:C},v.tail))},x.prototype.parseTemplateElement=function(){this.lookahead.type!==10&&this.throwUnexpectedToken();var m=this.createNode(),v=this.nextToken(),w=v.value,C=v.cooked;return this.finalize(m,new h.TemplateElement({raw:w,cooked:C},v.tail))},x.prototype.parseTemplateLiteral=function(){var m=this.createNode(),v=[],w=[],C=this.parseTemplateHead();for(w.push(C);!C.tail;)v.push(this.parseExpression()),C=this.parseTemplateElement(),w.push(C);return this.finalize(m,new h.TemplateLiteral(w,v))},x.prototype.reinterpretExpressionAsPattern=function(m){switch(m.type){case d.Syntax.Identifier:case d.Syntax.MemberExpression:case d.Syntax.RestElement:case d.Syntax.AssignmentPattern:break;case d.Syntax.SpreadElement:m.type=d.Syntax.RestElement,this.reinterpretExpressionAsPattern(m.argument);break;case d.Syntax.ArrayExpression:m.type=d.Syntax.ArrayPattern;for(var v=0;v<m.elements.length;v++)m.elements[v]!==null&&this.reinterpretExpressionAsPattern(m.elements[v]);break;case d.Syntax.ObjectExpression:for(m.type=d.Syntax.ObjectPattern,v=0;v<m.properties.length;v++)this.reinterpretExpressionAsPattern(m.properties[v].value);break;case d.Syntax.AssignmentExpression:m.type=d.Syntax.AssignmentPattern,delete m.operator,this.reinterpretExpressionAsPattern(m.left)}},x.prototype.parseGroupExpression=function(){var m;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),m={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var v=this.lookahead,w=[];if(this.match("..."))m=this.parseRestElement(w),this.expect(")"),this.match("=>")||this.expect("=>"),m={type:"ArrowParameterPlaceHolder",params:[m],async:!1};else{var C=!1;if(this.context.isBindingElement=!0,m=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var T=[];for(this.context.isAssignmentTarget=!1,T.push(m);this.lookahead.type!==2&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var _=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);C=!0,m={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),T.push(this.parseRestElement(w)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,_=0;_<T.length;_++)this.reinterpretExpressionAsPattern(T[_]);C=!0,m={type:"ArrowParameterPlaceHolder",params:T,async:!1}}else T.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(C)break}C||(m=this.finalize(this.startNode(v),new h.SequenceExpression(T)))}if(!C){if(this.expect(")"),this.match("=>")&&(m.type===d.Syntax.Identifier&&m.name==="yield"&&(C=!0,m={type:"ArrowParameterPlaceHolder",params:[m],async:!1}),!C)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),m.type===d.Syntax.SequenceExpression)for(_=0;_<m.expressions.length;_++)this.reinterpretExpressionAsPattern(m.expressions[_]);else this.reinterpretExpressionAsPattern(m);m={type:"ArrowParameterPlaceHolder",params:m.type===d.Syntax.SequenceExpression?m.expressions:[m],async:!1}}this.context.isBindingElement=!1}}}return m},x.prototype.parseArguments=function(){this.expect("(");var m=[];if(!this.match(")"))for(;;){var v=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(m.push(v),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),m},x.prototype.isIdentifierName=function(m){return m.type===3||m.type===4||m.type===1||m.type===5},x.prototype.parseIdentifierName=function(){var m=this.createNode(),v=this.nextToken();return this.isIdentifierName(v)||this.throwUnexpectedToken(v),this.finalize(m,new h.Identifier(v.value))},x.prototype.parseNewExpression=function(){var m,v=this.createNode(),w=this.parseIdentifierName();if(l.assert(w.name==="new","New expression must start with `new`"),this.match("."))if(this.nextToken(),this.lookahead.type===3&&this.context.inFunctionBody&&this.lookahead.value==="target"){var C=this.parseIdentifierName();m=new h.MetaProperty(w,C)}else this.throwUnexpectedToken(this.lookahead);else{var T=this.isolateCoverGrammar(this.parseLeftHandSideExpression),_=this.match("(")?this.parseArguments():[];m=new h.NewExpression(T,_),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(v,m)},x.prototype.parseAsyncArgument=function(){var m=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,m},x.prototype.parseAsyncArguments=function(){this.expect("(");var m=[];if(!this.match(")"))for(;;){var v=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(m.push(v),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),m},x.prototype.parseLeftHandSideExpressionAllowCall=function(){var m,v=this.lookahead,w=this.matchContextualKeyword("async"),C=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(m=this.createNode(),this.nextToken(),m=this.finalize(m,new h.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):m=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var T=this.parseIdentifierName();m=this.finalize(this.startNode(v),new h.StaticMemberExpression(m,T))}else if(this.match("(")){var _=w&&v.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var S=_?this.parseAsyncArguments():this.parseArguments();if(m=this.finalize(this.startNode(v),new h.CallExpression(m,S)),_&&this.match("=>")){for(var b=0;b<S.length;++b)this.reinterpretExpressionAsPattern(S[b]);m={type:"ArrowParameterPlaceHolder",params:S,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),T=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),m=this.finalize(this.startNode(v),new h.ComputedMemberExpression(m,T));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var D=this.parseTemplateLiteral();m=this.finalize(this.startNode(v),new h.TaggedTemplateExpression(m,D))}return this.context.allowIn=C,m},x.prototype.parseSuper=function(){var m=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(m,new h.Super)},x.prototype.parseLeftHandSideExpression=function(){l.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var m=this.startNode(this.lookahead),v=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var w=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),v=this.finalize(m,new h.ComputedMemberExpression(v,w))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),w=this.parseIdentifierName(),v=this.finalize(m,new h.StaticMemberExpression(v,w));else{if(this.lookahead.type!==10||!this.lookahead.head)break;var C=this.parseTemplateLiteral();v=this.finalize(m,new h.TaggedTemplateExpression(v,C))}return v},x.prototype.parseUpdateExpression=function(){var m,v=this.lookahead;if(this.match("++")||this.match("--")){var w=this.startNode(v),C=this.nextToken();m=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&m.type===d.Syntax.Identifier&&this.scanner.isRestrictedWord(m.name)&&this.tolerateError(u.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment);var T=!0;m=this.finalize(w,new h.UpdateExpression(C.value,m,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(m=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&this.lookahead.type===7&&(this.match("++")||this.match("--"))){this.context.strict&&m.type===d.Syntax.Identifier&&this.scanner.isRestrictedWord(m.name)&&this.tolerateError(u.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var _=this.nextToken().value;T=!1,m=this.finalize(this.startNode(v),new h.UpdateExpression(_,m,T))}return m},x.prototype.parseAwaitExpression=function(){var m=this.createNode();this.nextToken();var v=this.parseUnaryExpression();return this.finalize(m,new h.AwaitExpression(v))},x.prototype.parseUnaryExpression=function(){var m;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var v=this.startNode(this.lookahead),w=this.nextToken();m=this.inheritCoverGrammar(this.parseUnaryExpression),m=this.finalize(v,new h.UnaryExpression(w.value,m)),this.context.strict&&m.operator==="delete"&&m.argument.type===d.Syntax.Identifier&&this.tolerateError(u.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else m=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return m},x.prototype.parseExponentiationExpression=function(){var m=this.lookahead,v=this.inheritCoverGrammar(this.parseUnaryExpression);if(v.type!==d.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var w=v,C=this.isolateCoverGrammar(this.parseExponentiationExpression);v=this.finalize(this.startNode(m),new h.BinaryExpression("**",w,C))}return v},x.prototype.binaryPrecedence=function(m){var v=m.value;return m.type===7?this.operatorPrecedence[v]||0:m.type===4&&(v==="instanceof"||this.context.allowIn&&v==="in")?7:0},x.prototype.parseBinaryExpression=function(){var m=this.lookahead,v=this.inheritCoverGrammar(this.parseExponentiationExpression),w=this.lookahead,C=this.binaryPrecedence(w);if(C>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var T=[m,this.lookahead],_=v,S=this.isolateCoverGrammar(this.parseExponentiationExpression),b=[_,w.value,S],D=[C];!((C=this.binaryPrecedence(this.lookahead))<=0);){for(;b.length>2&&C<=D[D.length-1];){S=b.pop();var E=b.pop();D.pop(),_=b.pop(),T.pop();var R=this.startNode(T[T.length-1]);b.push(this.finalize(R,new h.BinaryExpression(E,_,S)))}b.push(this.nextToken().value),D.push(C),T.push(this.lookahead),b.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var F=b.length-1;v=b[F];for(var M=T.pop();F>1;){var U=T.pop(),z=M&&M.lineStart;R=this.startNode(U,z),E=b[F-1],v=this.finalize(R,new h.BinaryExpression(E,b[F-2],v)),F-=2,M=U}}return v},x.prototype.parseConditionalExpression=function(){var m=this.lookahead,v=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var w=this.context.allowIn;this.context.allowIn=!0;var C=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=w,this.expect(":");var T=this.isolateCoverGrammar(this.parseAssignmentExpression);v=this.finalize(this.startNode(m),new h.ConditionalExpression(v,C,T)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return v},x.prototype.checkPatternParam=function(m,v){switch(v.type){case d.Syntax.Identifier:this.validateParam(m,v,v.name);break;case d.Syntax.RestElement:this.checkPatternParam(m,v.argument);break;case d.Syntax.AssignmentPattern:this.checkPatternParam(m,v.left);break;case d.Syntax.ArrayPattern:for(var w=0;w<v.elements.length;w++)v.elements[w]!==null&&this.checkPatternParam(m,v.elements[w]);break;case d.Syntax.ObjectPattern:for(w=0;w<v.properties.length;w++)this.checkPatternParam(m,v.properties[w].value)}m.simple=m.simple&&v instanceof h.Identifier},x.prototype.reinterpretAsCoverFormalsList=function(m){var v,w=[m],C=!1;switch(m.type){case d.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":w=m.params,C=m.async;break;default:return null}v={simple:!0,paramSet:{}};for(var T=0;T<w.length;++T)(_=w[T]).type===d.Syntax.AssignmentPattern?_.right.type===d.Syntax.YieldExpression&&(_.right.argument&&this.throwUnexpectedToken(this.lookahead),_.right.type=d.Syntax.Identifier,_.right.name="yield",delete _.right.argument,delete _.right.delegate):C&&_.type===d.Syntax.Identifier&&_.name==="await"&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(v,_),w[T]=_;if(this.context.strict||!this.context.allowYield)for(T=0;T<w.length;++T){var _;(_=w[T]).type===d.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(v.message===u.Messages.StrictParamDupe){var S=this.context.strict?v.stricted:v.firstRestricted;this.throwUnexpectedToken(S,v.message)}return{simple:v.simple,params:w,stricted:v.stricted,firstRestricted:v.firstRestricted,message:v.message}},x.prototype.parseAssignmentExpression=function(){var m;if(!this.context.allowYield&&this.matchKeyword("yield"))m=this.parseYieldExpression();else{var v=this.lookahead,w=v;if(m=this.parseConditionalExpression(),w.type===3&&w.lineNumber===this.lookahead.lineNumber&&w.value==="async"&&(this.lookahead.type===3||this.matchKeyword("yield"))){var C=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(C),m={type:"ArrowParameterPlaceHolder",params:[C],async:!0}}if(m.type==="ArrowParameterPlaceHolder"||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var T=m.async,_=this.reinterpretAsCoverFormalsList(m);if(_){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var S=this.context.strict,b=this.context.allowStrictDirective;this.context.allowStrictDirective=_.simple;var D=this.context.allowYield,E=this.context.await;this.context.allowYield=!0,this.context.await=T;var R=this.startNode(v);this.expect("=>");var F=void 0;if(this.match("{")){var M=this.context.allowIn;this.context.allowIn=!0,F=this.parseFunctionSourceElements(),this.context.allowIn=M}else F=this.isolateCoverGrammar(this.parseAssignmentExpression);var U=F.type!==d.Syntax.BlockStatement;this.context.strict&&_.firstRestricted&&this.throwUnexpectedToken(_.firstRestricted,_.message),this.context.strict&&_.stricted&&this.tolerateUnexpectedToken(_.stricted,_.message),m=T?this.finalize(R,new h.AsyncArrowFunctionExpression(_.params,F,U)):this.finalize(R,new h.ArrowFunctionExpression(_.params,F,U)),this.context.strict=S,this.context.allowStrictDirective=b,this.context.allowYield=D,this.context.await=E}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(u.Messages.InvalidLHSInAssignment),this.context.strict&&m.type===d.Syntax.Identifier){var z=m;this.scanner.isRestrictedWord(z.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(z.name)&&this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(m):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var Y=(w=this.nextToken()).value,W=this.isolateCoverGrammar(this.parseAssignmentExpression);m=this.finalize(this.startNode(v),new h.AssignmentExpression(Y,m,W)),this.context.firstCoverInitializedNameError=null}}return m},x.prototype.parseExpression=function(){var m=this.lookahead,v=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var w=[];for(w.push(v);this.lookahead.type!==2&&this.match(",");)this.nextToken(),w.push(this.isolateCoverGrammar(this.parseAssignmentExpression));v=this.finalize(this.startNode(m),new h.SequenceExpression(w))}return v},x.prototype.parseStatementListItem=function(){var m;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,this.lookahead.type===4)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalExportDeclaration),m=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,u.Messages.IllegalImportDeclaration),m=this.parseImportDeclaration();break;case"const":m=this.parseLexicalDeclaration({inFor:!1});break;case"function":m=this.parseFunctionDeclaration();break;case"class":m=this.parseClassDeclaration();break;case"let":m=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:m=this.parseStatement()}else m=this.parseStatement();return m},x.prototype.parseBlock=function(){var m=this.createNode();this.expect("{");for(var v=[];!this.match("}");)v.push(this.parseStatementListItem());return this.expect("}"),this.finalize(m,new h.BlockStatement(v))},x.prototype.parseLexicalBinding=function(m,v){var w=this.createNode(),C=this.parsePattern([],m);this.context.strict&&C.type===d.Syntax.Identifier&&this.scanner.isRestrictedWord(C.name)&&this.tolerateError(u.Messages.StrictVarName);var T=null;return m==="const"?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),T=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(u.Messages.DeclarationMissingInitializer,"const")):(!v.inFor&&C.type!==d.Syntax.Identifier||this.match("="))&&(this.expect("="),T=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(w,new h.VariableDeclarator(C,T))},x.prototype.parseBindingList=function(m,v){for(var w=[this.parseLexicalBinding(m,v)];this.match(",");)this.nextToken(),w.push(this.parseLexicalBinding(m,v));return w},x.prototype.isLexicalDeclaration=function(){var m=this.scanner.saveState();this.scanner.scanComments();var v=this.scanner.lex();return this.scanner.restoreState(m),v.type===3||v.type===7&&v.value==="["||v.type===7&&v.value==="{"||v.type===4&&v.value==="let"||v.type===4&&v.value==="yield"},x.prototype.parseLexicalDeclaration=function(m){var v=this.createNode(),w=this.nextToken().value;l.assert(w==="let"||w==="const","Lexical declaration must be either let or const");var C=this.parseBindingList(w,m);return this.consumeSemicolon(),this.finalize(v,new h.VariableDeclaration(C,w))},x.prototype.parseBindingRestElement=function(m,v){var w=this.createNode();this.expect("...");var C=this.parsePattern(m,v);return this.finalize(w,new h.RestElement(C))},x.prototype.parseArrayPattern=function(m,v){var w=this.createNode();this.expect("[");for(var C=[];!this.match("]");)if(this.match(","))this.nextToken(),C.push(null);else{if(this.match("...")){C.push(this.parseBindingRestElement(m,v));break}C.push(this.parsePatternWithDefault(m,v)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(w,new h.ArrayPattern(C))},x.prototype.parsePropertyPattern=function(m,v){var w,C,T=this.createNode(),_=!1,S=!1;if(this.lookahead.type===3){var b=this.lookahead;w=this.parseVariableIdentifier();var D=this.finalize(T,new h.Identifier(b.value));if(this.match("=")){m.push(b),S=!0,this.nextToken();var E=this.parseAssignmentExpression();C=this.finalize(this.startNode(b),new h.AssignmentPattern(D,E))}else this.match(":")?(this.expect(":"),C=this.parsePatternWithDefault(m,v)):(m.push(b),S=!0,C=D)}else _=this.match("["),w=this.parseObjectPropertyKey(),this.expect(":"),C=this.parsePatternWithDefault(m,v);return this.finalize(T,new h.Property("init",w,_,C,!1,S))},x.prototype.parseObjectPattern=function(m,v){var w=this.createNode(),C=[];for(this.expect("{");!this.match("}");)C.push(this.parsePropertyPattern(m,v)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(w,new h.ObjectPattern(C))},x.prototype.parsePattern=function(m,v){var w;return this.match("[")?w=this.parseArrayPattern(m,v):this.match("{")?w=this.parseObjectPattern(m,v):(!this.matchKeyword("let")||v!=="const"&&v!=="let"||this.tolerateUnexpectedToken(this.lookahead,u.Messages.LetInLexicalBinding),m.push(this.lookahead),w=this.parseVariableIdentifier(v)),w},x.prototype.parsePatternWithDefault=function(m,v){var w=this.lookahead,C=this.parsePattern(m,v);if(this.match("=")){this.nextToken();var T=this.context.allowYield;this.context.allowYield=!0;var _=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=T,C=this.finalize(this.startNode(w),new h.AssignmentPattern(C,_))}return C},x.prototype.parseVariableIdentifier=function(m){var v=this.createNode(),w=this.nextToken();return w.type===4&&w.value==="yield"?this.context.strict?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(w):w.type!==3?this.context.strict&&w.type===4&&this.scanner.isStrictModeReservedWord(w.value)?this.tolerateUnexpectedToken(w,u.Messages.StrictReservedWord):(this.context.strict||w.value!=="let"||m!=="var")&&this.throwUnexpectedToken(w):(this.context.isModule||this.context.await)&&w.type===3&&w.value==="await"&&this.tolerateUnexpectedToken(w),this.finalize(v,new h.Identifier(w.value))},x.prototype.parseVariableDeclaration=function(m){var v=this.createNode(),w=this.parsePattern([],"var");this.context.strict&&w.type===d.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictVarName);var C=null;return this.match("=")?(this.nextToken(),C=this.isolateCoverGrammar(this.parseAssignmentExpression)):w.type===d.Syntax.Identifier||m.inFor||this.expect("="),this.finalize(v,new h.VariableDeclarator(w,C))},x.prototype.parseVariableDeclarationList=function(m){var v={inFor:m.inFor},w=[];for(w.push(this.parseVariableDeclaration(v));this.match(",");)this.nextToken(),w.push(this.parseVariableDeclaration(v));return w},x.prototype.parseVariableStatement=function(){var m=this.createNode();this.expectKeyword("var");var v=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(m,new h.VariableDeclaration(v,"var"))},x.prototype.parseEmptyStatement=function(){var m=this.createNode();return this.expect(";"),this.finalize(m,new h.EmptyStatement)},x.prototype.parseExpressionStatement=function(){var m=this.createNode(),v=this.parseExpression();return this.consumeSemicolon(),this.finalize(m,new h.ExpressionStatement(v))},x.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(u.Messages.StrictFunction),this.parseStatement()},x.prototype.parseIfStatement=function(){var m,v=this.createNode(),w=null;this.expectKeyword("if"),this.expect("(");var C=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),m=this.finalize(this.createNode(),new h.EmptyStatement)):(this.expect(")"),m=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),w=this.parseIfClause())),this.finalize(v,new h.IfStatement(C,m,w))},x.prototype.parseDoWhileStatement=function(){var m=this.createNode();this.expectKeyword("do");var v=this.context.inIteration;this.context.inIteration=!0;var w=this.parseStatement();this.context.inIteration=v,this.expectKeyword("while"),this.expect("(");var C=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(m,new h.DoWhileStatement(w,C))},x.prototype.parseWhileStatement=function(){var m,v=this.createNode();this.expectKeyword("while"),this.expect("(");var w=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),m=this.finalize(this.createNode(),new h.EmptyStatement);else{this.expect(")");var C=this.context.inIteration;this.context.inIteration=!0,m=this.parseStatement(),this.context.inIteration=C}return this.finalize(v,new h.WhileStatement(w,m))},x.prototype.parseForStatement=function(){var m,v,w,C=null,T=null,_=null,S=!0,b=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){C=this.createNode(),this.nextToken();var D=this.context.allowIn;this.context.allowIn=!1;var E=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=D,E.length===1&&this.matchKeyword("in")){var R=E[0];R.init&&(R.id.type===d.Syntax.ArrayPattern||R.id.type===d.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(u.Messages.ForInOfLoopInitializer,"for-in"),C=this.finalize(C,new h.VariableDeclaration(E,"var")),this.nextToken(),m=C,v=this.parseExpression(),C=null}else E.length===1&&E[0].init===null&&this.matchContextualKeyword("of")?(C=this.finalize(C,new h.VariableDeclaration(E,"var")),this.nextToken(),m=C,v=this.parseAssignmentExpression(),C=null,S=!1):(C=this.finalize(C,new h.VariableDeclaration(E,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){C=this.createNode();var F=this.nextToken().value;this.context.strict||this.lookahead.value!=="in"?(D=this.context.allowIn,this.context.allowIn=!1,E=this.parseBindingList(F,{inFor:!0}),this.context.allowIn=D,E.length===1&&E[0].init===null&&this.matchKeyword("in")?(C=this.finalize(C,new h.VariableDeclaration(E,F)),this.nextToken(),m=C,v=this.parseExpression(),C=null):E.length===1&&E[0].init===null&&this.matchContextualKeyword("of")?(C=this.finalize(C,new h.VariableDeclaration(E,F)),this.nextToken(),m=C,v=this.parseAssignmentExpression(),C=null,S=!1):(this.consumeSemicolon(),C=this.finalize(C,new h.VariableDeclaration(E,F)))):(C=this.finalize(C,new h.Identifier(F)),this.nextToken(),m=C,v=this.parseExpression(),C=null)}else{var M=this.lookahead;if(D=this.context.allowIn,this.context.allowIn=!1,C=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=D,this.matchKeyword("in"))this.context.isAssignmentTarget&&C.type!==d.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(C),m=C,v=this.parseExpression(),C=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&C.type!==d.Syntax.AssignmentExpression||this.tolerateError(u.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(C),m=C,v=this.parseAssignmentExpression(),C=null,S=!1;else{if(this.match(",")){for(var U=[C];this.match(",");)this.nextToken(),U.push(this.isolateCoverGrammar(this.parseAssignmentExpression));C=this.finalize(this.startNode(M),new h.SequenceExpression(U))}this.expect(";")}}if(m===void 0&&(this.match(";")||(T=this.parseExpression()),this.expect(";"),this.match(")")||(_=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),w=this.finalize(this.createNode(),new h.EmptyStatement);else{this.expect(")");var z=this.context.inIteration;this.context.inIteration=!0,w=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=z}return m===void 0?this.finalize(b,new h.ForStatement(C,T,_,w)):S?this.finalize(b,new h.ForInStatement(m,v,w)):this.finalize(b,new h.ForOfStatement(m,v,w))},x.prototype.parseContinueStatement=function(){var m=this.createNode();this.expectKeyword("continue");var v=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier();v=w;var C="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,C)||this.throwError(u.Messages.UnknownLabel,w.name)}return this.consumeSemicolon(),v!==null||this.context.inIteration||this.throwError(u.Messages.IllegalContinue),this.finalize(m,new h.ContinueStatement(v))},x.prototype.parseBreakStatement=function(){var m=this.createNode();this.expectKeyword("break");var v=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var w=this.parseVariableIdentifier(),C="$"+w.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,C)||this.throwError(u.Messages.UnknownLabel,w.name),v=w}return this.consumeSemicolon(),v!==null||this.context.inIteration||this.context.inSwitch||this.throwError(u.Messages.IllegalBreak),this.finalize(m,new h.BreakStatement(v))},x.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(u.Messages.IllegalReturn);var m=this.createNode();this.expectKeyword("return");var v=(this.match(";")||this.match("}")||this.hasLineTerminator||this.lookahead.type===2)&&this.lookahead.type!==8&&this.lookahead.type!==10?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(m,new h.ReturnStatement(v))},x.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(u.Messages.StrictModeWith);var m,v=this.createNode();this.expectKeyword("with"),this.expect("(");var w=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),m=this.finalize(this.createNode(),new h.EmptyStatement)):(this.expect(")"),m=this.parseStatement()),this.finalize(v,new h.WithStatement(w,m))},x.prototype.parseSwitchCase=function(){var m,v=this.createNode();this.matchKeyword("default")?(this.nextToken(),m=null):(this.expectKeyword("case"),m=this.parseExpression()),this.expect(":");for(var w=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)w.push(this.parseStatementListItem());return this.finalize(v,new h.SwitchCase(m,w))},x.prototype.parseSwitchStatement=function(){var m=this.createNode();this.expectKeyword("switch"),this.expect("(");var v=this.parseExpression();this.expect(")");var w=this.context.inSwitch;this.context.inSwitch=!0;var C=[],T=!1;for(this.expect("{");!this.match("}");){var _=this.parseSwitchCase();_.test===null&&(T&&this.throwError(u.Messages.MultipleDefaultsInSwitch),T=!0),C.push(_)}return this.expect("}"),this.context.inSwitch=w,this.finalize(m,new h.SwitchStatement(v,C))},x.prototype.parseLabelledStatement=function(){var m,v=this.createNode(),w=this.parseExpression();if(w.type===d.Syntax.Identifier&&this.match(":")){this.nextToken();var C=w,T="$"+C.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,T)&&this.throwError(u.Messages.Redeclaration,"Label",C.name),this.context.labelSet[T]=!0;var _=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),_=this.parseClassDeclaration();else if(this.matchKeyword("function")){var S=this.lookahead,b=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(S,u.Messages.StrictFunction):b.generator&&this.tolerateUnexpectedToken(S,u.Messages.GeneratorInLegacyContext),_=b}else _=this.parseStatement();delete this.context.labelSet[T],m=new h.LabeledStatement(C,_)}else this.consumeSemicolon(),m=new h.ExpressionStatement(w);return this.finalize(v,m)},x.prototype.parseThrowStatement=function(){var m=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(u.Messages.NewlineAfterThrow);var v=this.parseExpression();return this.consumeSemicolon(),this.finalize(m,new h.ThrowStatement(v))},x.prototype.parseCatchClause=function(){var m=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var v=[],w=this.parsePattern(v),C={},T=0;T<v.length;T++){var _="$"+v[T].value;Object.prototype.hasOwnProperty.call(C,_)&&this.tolerateError(u.Messages.DuplicateBinding,v[T].value),C[_]=!0}this.context.strict&&w.type===d.Syntax.Identifier&&this.scanner.isRestrictedWord(w.name)&&this.tolerateError(u.Messages.StrictCatchVariable),this.expect(")");var S=this.parseBlock();return this.finalize(m,new h.CatchClause(w,S))},x.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},x.prototype.parseTryStatement=function(){var m=this.createNode();this.expectKeyword("try");var v=this.parseBlock(),w=this.matchKeyword("catch")?this.parseCatchClause():null,C=this.matchKeyword("finally")?this.parseFinallyClause():null;return w||C||this.throwError(u.Messages.NoCatchOrFinally),this.finalize(m,new h.TryStatement(v,w,C))},x.prototype.parseDebuggerStatement=function(){var m=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(m,new h.DebuggerStatement)},x.prototype.parseStatement=function(){var m;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:m=this.parseExpressionStatement();break;case 7:var v=this.lookahead.value;m=v==="{"?this.parseBlock():v==="("?this.parseExpressionStatement():v===";"?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:m=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":m=this.parseBreakStatement();break;case"continue":m=this.parseContinueStatement();break;case"debugger":m=this.parseDebuggerStatement();break;case"do":m=this.parseDoWhileStatement();break;case"for":m=this.parseForStatement();break;case"function":m=this.parseFunctionDeclaration();break;case"if":m=this.parseIfStatement();break;case"return":m=this.parseReturnStatement();break;case"switch":m=this.parseSwitchStatement();break;case"throw":m=this.parseThrowStatement();break;case"try":m=this.parseTryStatement();break;case"var":m=this.parseVariableStatement();break;case"while":m=this.parseWhileStatement();break;case"with":m=this.parseWithStatement();break;default:m=this.parseExpressionStatement()}break;default:m=this.throwUnexpectedToken(this.lookahead)}return m},x.prototype.parseFunctionSourceElements=function(){var m=this.createNode();this.expect("{");var v=this.parseDirectivePrologues(),w=this.context.labelSet,C=this.context.inIteration,T=this.context.inSwitch,_=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;this.lookahead.type!==2&&!this.match("}");)v.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=w,this.context.inIteration=C,this.context.inSwitch=T,this.context.inFunctionBody=_,this.finalize(m,new h.BlockStatement(v))},x.prototype.validateParam=function(m,v,w){var C="$"+w;this.context.strict?(this.scanner.isRestrictedWord(w)&&(m.stricted=v,m.message=u.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(m.paramSet,C)&&(m.stricted=v,m.message=u.Messages.StrictParamDupe)):m.firstRestricted||(this.scanner.isRestrictedWord(w)?(m.firstRestricted=v,m.message=u.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(w)?(m.firstRestricted=v,m.message=u.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(m.paramSet,C)&&(m.stricted=v,m.message=u.Messages.StrictParamDupe)),typeof Object.defineProperty=="function"?Object.defineProperty(m.paramSet,C,{value:!0,enumerable:!0,writable:!0,configurable:!0}):m.paramSet[C]=!0},x.prototype.parseRestElement=function(m){var v=this.createNode();this.expect("...");var w=this.parsePattern(m);return this.match("=")&&this.throwError(u.Messages.DefaultRestParameter),this.match(")")||this.throwError(u.Messages.ParameterAfterRestParameter),this.finalize(v,new h.RestElement(w))},x.prototype.parseFormalParameter=function(m){for(var v=[],w=this.match("...")?this.parseRestElement(v):this.parsePatternWithDefault(v),C=0;C<v.length;C++)this.validateParam(m,v[C],v[C].value);m.simple=m.simple&&w instanceof h.Identifier,m.params.push(w)},x.prototype.parseFormalParameters=function(m){var v;if(v={simple:!0,params:[],firstRestricted:m},this.expect("("),!this.match(")"))for(v.paramSet={};this.lookahead.type!==2&&(this.parseFormalParameter(v),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:v.simple,params:v.params,stricted:v.stricted,firstRestricted:v.firstRestricted,message:v.message}},x.prototype.matchAsyncFunction=function(){var m=this.matchContextualKeyword("async");if(m){var v=this.scanner.saveState();this.scanner.scanComments();var w=this.scanner.lex();this.scanner.restoreState(v),m=v.lineNumber===w.lineNumber&&w.type===4&&w.value==="function"}return m},x.prototype.parseFunctionDeclaration=function(m){var v=this.createNode(),w=this.matchContextualKeyword("async");w&&this.nextToken(),this.expectKeyword("function");var C,T=!w&&this.match("*");T&&this.nextToken();var _=null,S=null;if(!m||!this.match("(")){var b=this.lookahead;_=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(b.value)&&this.tolerateUnexpectedToken(b,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(b.value)?(S=b,C=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(b.value)&&(S=b,C=u.Messages.StrictReservedWord)}var D=this.context.await,E=this.context.allowYield;this.context.await=w,this.context.allowYield=!T;var R=this.parseFormalParameters(S),F=R.params,M=R.stricted;S=R.firstRestricted,R.message&&(C=R.message);var U=this.context.strict,z=this.context.allowStrictDirective;this.context.allowStrictDirective=R.simple;var Y=this.parseFunctionSourceElements();return this.context.strict&&S&&this.throwUnexpectedToken(S,C),this.context.strict&&M&&this.tolerateUnexpectedToken(M,C),this.context.strict=U,this.context.allowStrictDirective=z,this.context.await=D,this.context.allowYield=E,w?this.finalize(v,new h.AsyncFunctionDeclaration(_,F,Y)):this.finalize(v,new h.FunctionDeclaration(_,F,Y,T))},x.prototype.parseFunctionExpression=function(){var m=this.createNode(),v=this.matchContextualKeyword("async");v&&this.nextToken(),this.expectKeyword("function");var w,C=!v&&this.match("*");C&&this.nextToken();var T,_=null,S=this.context.await,b=this.context.allowYield;if(this.context.await=v,this.context.allowYield=!C,!this.match("(")){var D=this.lookahead;_=this.context.strict||C||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(D.value)&&this.tolerateUnexpectedToken(D,u.Messages.StrictFunctionName):this.scanner.isRestrictedWord(D.value)?(T=D,w=u.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(D.value)&&(T=D,w=u.Messages.StrictReservedWord)}var E=this.parseFormalParameters(T),R=E.params,F=E.stricted;T=E.firstRestricted,E.message&&(w=E.message);var M=this.context.strict,U=this.context.allowStrictDirective;this.context.allowStrictDirective=E.simple;var z=this.parseFunctionSourceElements();return this.context.strict&&T&&this.throwUnexpectedToken(T,w),this.context.strict&&F&&this.tolerateUnexpectedToken(F,w),this.context.strict=M,this.context.allowStrictDirective=U,this.context.await=S,this.context.allowYield=b,v?this.finalize(m,new h.AsyncFunctionExpression(_,R,z)):this.finalize(m,new h.FunctionExpression(_,R,z,C))},x.prototype.parseDirective=function(){var m=this.lookahead,v=this.createNode(),w=this.parseExpression(),C=w.type===d.Syntax.Literal?this.getTokenRaw(m).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(v,C?new h.Directive(w,C):new h.ExpressionStatement(w))},x.prototype.parseDirectivePrologues=function(){for(var m=null,v=[];;){var w=this.lookahead;if(w.type!==8)break;var C=this.parseDirective();v.push(C);var T=C.directive;if(typeof T!="string")break;T==="use strict"?(this.context.strict=!0,m&&this.tolerateUnexpectedToken(m,u.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(w,u.Messages.IllegalLanguageModeDirective)):!m&&w.octal&&(m=w)}return v},x.prototype.qualifiedPropertyName=function(m){switch(m.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return m.value==="["}return!1},x.prototype.parseGetterMethod=function(){var m=this.createNode(),v=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length>0&&this.tolerateError(u.Messages.BadGetterArity);var C=this.parsePropertyMethod(w);return this.context.allowYield=v,this.finalize(m,new h.FunctionExpression(null,w.params,C,!1))},x.prototype.parseSetterMethod=function(){var m=this.createNode(),v=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();w.params.length!==1?this.tolerateError(u.Messages.BadSetterArity):w.params[0]instanceof h.RestElement&&this.tolerateError(u.Messages.BadSetterRestParameter);var C=this.parsePropertyMethod(w);return this.context.allowYield=v,this.finalize(m,new h.FunctionExpression(null,w.params,C,!1))},x.prototype.parseGeneratorMethod=function(){var m=this.createNode(),v=this.context.allowYield;this.context.allowYield=!0;var w=this.parseFormalParameters();this.context.allowYield=!1;var C=this.parsePropertyMethod(w);return this.context.allowYield=v,this.finalize(m,new h.FunctionExpression(null,w.params,C,!0))},x.prototype.isStartOfExpression=function(){var m=!0,v=this.lookahead.value;switch(this.lookahead.type){case 7:m=v==="["||v==="("||v==="{"||v==="+"||v==="-"||v==="!"||v==="~"||v==="++"||v==="--"||v==="/"||v==="/=";break;case 4:m=v==="class"||v==="delete"||v==="function"||v==="let"||v==="new"||v==="super"||v==="this"||v==="typeof"||v==="void"||v==="yield"}return m},x.prototype.parseYieldExpression=function(){var m=this.createNode();this.expectKeyword("yield");var v=null,w=!1;if(!this.hasLineTerminator){var C=this.context.allowYield;this.context.allowYield=!1,(w=this.match("*"))?(this.nextToken(),v=this.parseAssignmentExpression()):this.isStartOfExpression()&&(v=this.parseAssignmentExpression()),this.context.allowYield=C}return this.finalize(m,new h.YieldExpression(v,w))},x.prototype.parseClassElement=function(m){var v=this.lookahead,w=this.createNode(),C="",T=null,_=null,S=!1,b=!1,D=!1,E=!1;if(this.match("*"))this.nextToken();else if(S=this.match("["),(T=this.parseObjectPropertyKey()).name==="static"&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(v=this.lookahead,D=!0,S=this.match("["),this.match("*")?this.nextToken():T=this.parseObjectPropertyKey()),v.type===3&&!this.hasLineTerminator&&v.value==="async"){var R=this.lookahead.value;R!==":"&&R!=="("&&R!=="*"&&(E=!0,v=this.lookahead,T=this.parseObjectPropertyKey(),v.type===3&&v.value==="constructor"&&this.tolerateUnexpectedToken(v,u.Messages.ConstructorIsAsync))}var F=this.qualifiedPropertyName(this.lookahead);return v.type===3?v.value==="get"&&F?(C="get",S=this.match("["),T=this.parseObjectPropertyKey(),this.context.allowYield=!1,_=this.parseGetterMethod()):v.value==="set"&&F&&(C="set",S=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseSetterMethod()):v.type===7&&v.value==="*"&&F&&(C="init",S=this.match("["),T=this.parseObjectPropertyKey(),_=this.parseGeneratorMethod(),b=!0),!C&&T&&this.match("(")&&(C="init",_=E?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),b=!0),C||this.throwUnexpectedToken(this.lookahead),C==="init"&&(C="method"),S||(D&&this.isPropertyKey(T,"prototype")&&this.throwUnexpectedToken(v,u.Messages.StaticPrototype),!D&&this.isPropertyKey(T,"constructor")&&((C!=="method"||!b||_&&_.generator)&&this.throwUnexpectedToken(v,u.Messages.ConstructorSpecialMethod),m.value?this.throwUnexpectedToken(v,u.Messages.DuplicateConstructor):m.value=!0,C="constructor")),this.finalize(w,new h.MethodDefinition(T,S,_,C,D))},x.prototype.parseClassElementList=function(){var m=[],v={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():m.push(this.parseClassElement(v));return this.expect("}"),m},x.prototype.parseClassBody=function(){var m=this.createNode(),v=this.parseClassElementList();return this.finalize(m,new h.ClassBody(v))},x.prototype.parseClassDeclaration=function(m){var v=this.createNode(),w=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var C=m&&this.lookahead.type!==3?null:this.parseVariableIdentifier(),T=null;this.matchKeyword("extends")&&(this.nextToken(),T=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var _=this.parseClassBody();return this.context.strict=w,this.finalize(v,new h.ClassDeclaration(C,T,_))},x.prototype.parseClassExpression=function(){var m=this.createNode(),v=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var w=this.lookahead.type===3?this.parseVariableIdentifier():null,C=null;this.matchKeyword("extends")&&(this.nextToken(),C=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var T=this.parseClassBody();return this.context.strict=v,this.finalize(m,new h.ClassExpression(w,C,T))},x.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var m=this.createNode(),v=this.parseDirectivePrologues();this.lookahead.type!==2;)v.push(this.parseStatementListItem());return this.finalize(m,new h.Module(v))},x.prototype.parseScript=function(){for(var m=this.createNode(),v=this.parseDirectivePrologues();this.lookahead.type!==2;)v.push(this.parseStatementListItem());return this.finalize(m,new h.Script(v))},x.prototype.parseModuleSpecifier=function(){var m=this.createNode();this.lookahead.type!==8&&this.throwError(u.Messages.InvalidModuleSpecifier);var v=this.nextToken(),w=this.getTokenRaw(v);return this.finalize(m,new h.Literal(v.value,w))},x.prototype.parseImportSpecifier=function(){var m,v,w=this.createNode();return this.lookahead.type===3?(v=m=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),v=this.parseVariableIdentifier())):(v=m=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),v=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(w,new h.ImportSpecifier(v,m))},x.prototype.parseNamedImports=function(){this.expect("{");for(var m=[];!this.match("}");)m.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),m},x.prototype.parseImportDefaultSpecifier=function(){var m=this.createNode(),v=this.parseIdentifierName();return this.finalize(m,new h.ImportDefaultSpecifier(v))},x.prototype.parseImportNamespaceSpecifier=function(){var m=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(u.Messages.NoAsAfterImportNamespace),this.nextToken();var v=this.parseIdentifierName();return this.finalize(m,new h.ImportNamespaceSpecifier(v))},x.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalImportDeclaration);var m,v=this.createNode();this.expectKeyword("import");var w=[];if(this.lookahead.type===8)m=this.parseModuleSpecifier();else{if(this.match("{")?w=w.concat(this.parseNamedImports()):this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(w.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?w.push(this.parseImportNamespaceSpecifier()):this.match("{")?w=w.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var C=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(C,this.lookahead.value)}this.nextToken(),m=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(v,new h.ImportDeclaration(w,m))},x.prototype.parseExportSpecifier=function(){var m=this.createNode(),v=this.parseIdentifierName(),w=v;return this.matchContextualKeyword("as")&&(this.nextToken(),w=this.parseIdentifierName()),this.finalize(m,new h.ExportSpecifier(v,w))},x.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(u.Messages.IllegalExportDeclaration);var m,v=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var w=this.parseFunctionDeclaration(!0);m=this.finalize(v,new h.ExportDefaultDeclaration(w))}else this.matchKeyword("class")?(w=this.parseClassDeclaration(!0),m=this.finalize(v,new h.ExportDefaultDeclaration(w))):this.matchContextualKeyword("async")?(w=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),m=this.finalize(v,new h.ExportDefaultDeclaration(w))):(this.matchContextualKeyword("from")&&this.throwError(u.Messages.UnexpectedToken,this.lookahead.value),w=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),m=this.finalize(v,new h.ExportDefaultDeclaration(w)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var C=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause;this.throwError(C,this.lookahead.value)}this.nextToken();var T=this.parseModuleSpecifier();this.consumeSemicolon(),m=this.finalize(v,new h.ExportAllDeclaration(T))}else if(this.lookahead.type===4){switch(w=void 0,this.lookahead.value){case"let":case"const":w=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":w=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}m=this.finalize(v,new h.ExportNamedDeclaration(w,[],null))}else if(this.matchAsyncFunction())w=this.parseFunctionDeclaration(),m=this.finalize(v,new h.ExportNamedDeclaration(w,[],null));else{var _=[],S=null,b=!1;for(this.expect("{");!this.match("}");)b=b||this.matchKeyword("default"),_.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),S=this.parseModuleSpecifier(),this.consumeSemicolon()):b?(C=this.lookahead.value?u.Messages.UnexpectedToken:u.Messages.MissingFromClause,this.throwError(C,this.lookahead.value)):this.consumeSemicolon(),m=this.finalize(v,new h.ExportNamedDeclaration(null,_,S))}return m},x}();s.Parser=y},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.assert=function(c,l){if(!c)throw new Error("ASSERT: "+l)}},function(o,s){Object.defineProperty(s,"__esModule",{value:!0});var c=function(){function l(){this.errors=[],this.tolerant=!1}return l.prototype.recordError=function(f){this.errors.push(f)},l.prototype.tolerate=function(f){if(!this.tolerant)throw f;this.recordError(f)},l.prototype.constructError=function(f,u){var h=new Error(f);try{throw h}catch(p){Object.create&&Object.defineProperty&&(h=Object.create(p),Object.defineProperty(h,"column",{value:u}))}return h},l.prototype.createError=function(f,u,h,p){var d="Line "+u+": "+p,g=this.constructError(d,h);return g.index=f,g.lineNumber=u,g.description=p,g},l.prototype.throwError=function(f,u,h,p){throw this.createError(f,u,h,p)},l.prototype.tolerateError=function(f,u,h,p){var d=this.createError(f,u,h,p);if(!this.tolerant)throw d;this.recordError(d)},l}();s.ErrorHandler=c},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(9),f=c(4),u=c(11);function h(g){return"0123456789abcdef".indexOf(g.toLowerCase())}function p(g){return"01234567".indexOf(g)}var d=function(){function g(y,x){this.source=y,this.errorHandler=x,this.trackComment=!1,this.isModule=!1,this.length=y.length,this.index=0,this.lineNumber=y.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return g.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},g.prototype.restoreState=function(y){this.index=y.index,this.lineNumber=y.lineNumber,this.lineStart=y.lineStart},g.prototype.eof=function(){return this.index>=this.length},g.prototype.throwUnexpectedToken=function(y){return y===void 0&&(y=u.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,y)},g.prototype.tolerateUnexpectedToken=function(y){y===void 0&&(y=u.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,y)},g.prototype.skipSingleLineComment=function(y){var x,m,v=[];for(this.trackComment&&(v=[],x=this.index-y,m={start:{line:this.lineNumber,column:this.index-this.lineStart-y},end:{}});!this.eof();){var w=this.source.charCodeAt(this.index);if(++this.index,f.Character.isLineTerminator(w)){if(this.trackComment){m.end={line:this.lineNumber,column:this.index-this.lineStart-1};var C={multiLine:!1,slice:[x+y,this.index-1],range:[x,this.index-1],loc:m};v.push(C)}return w===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,v}}return this.trackComment&&(m.end={line:this.lineNumber,column:this.index-this.lineStart},C={multiLine:!1,slice:[x+y,this.index],range:[x,this.index],loc:m},v.push(C)),v},g.prototype.skipMultiLineComment=function(){var y,x,m=[];for(this.trackComment&&(m=[],y=this.index-2,x={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var v=this.source.charCodeAt(this.index);if(f.Character.isLineTerminator(v))v===13&&this.source.charCodeAt(this.index+1)===10&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(v===42){if(this.source.charCodeAt(this.index+1)===47){if(this.index+=2,this.trackComment){x.end={line:this.lineNumber,column:this.index-this.lineStart};var w={multiLine:!0,slice:[y+2,this.index-2],range:[y,this.index],loc:x};m.push(w)}return m}++this.index}else++this.index}return this.trackComment&&(x.end={line:this.lineNumber,column:this.index-this.lineStart},w={multiLine:!0,slice:[y+2,this.index],range:[y,this.index],loc:x},m.push(w)),this.tolerateUnexpectedToken(),m},g.prototype.scanComments=function(){var y;this.trackComment&&(y=[]);for(var x=this.index===0;!this.eof();){var m=this.source.charCodeAt(this.index);if(f.Character.isWhiteSpace(m))++this.index;else if(f.Character.isLineTerminator(m))++this.index,m===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,x=!0;else if(m===47)if((m=this.source.charCodeAt(this.index+1))===47){this.index+=2;var v=this.skipSingleLineComment(2);this.trackComment&&(y=y.concat(v)),x=!0}else{if(m!==42)break;this.index+=2,v=this.skipMultiLineComment(),this.trackComment&&(y=y.concat(v))}else if(x&&m===45){if(this.source.charCodeAt(this.index+1)!==45||this.source.charCodeAt(this.index+2)!==62)break;this.index+=3,v=this.skipSingleLineComment(3),this.trackComment&&(y=y.concat(v))}else{if(m!==60||this.isModule||this.source.slice(this.index+1,this.index+4)!=="!--")break;this.index+=4,v=this.skipSingleLineComment(4),this.trackComment&&(y=y.concat(v))}}return y},g.prototype.isFutureReservedWord=function(y){switch(y){case"enum":case"export":case"import":case"super":return!0;default:return!1}},g.prototype.isStrictModeReservedWord=function(y){switch(y){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},g.prototype.isRestrictedWord=function(y){return y==="eval"||y==="arguments"},g.prototype.isKeyword=function(y){switch(y.length){case 2:return y==="if"||y==="in"||y==="do";case 3:return y==="var"||y==="for"||y==="new"||y==="try"||y==="let";case 4:return y==="this"||y==="else"||y==="case"||y==="void"||y==="with"||y==="enum";case 5:return y==="while"||y==="break"||y==="catch"||y==="throw"||y==="const"||y==="yield"||y==="class"||y==="super";case 6:return y==="return"||y==="typeof"||y==="delete"||y==="switch"||y==="export"||y==="import";case 7:return y==="default"||y==="finally"||y==="extends";case 8:return y==="function"||y==="continue"||y==="debugger";case 10:return y==="instanceof";default:return!1}},g.prototype.codePointAt=function(y){var x=this.source.charCodeAt(y);if(x>=55296&&x<=56319){var m=this.source.charCodeAt(y+1);m>=56320&&m<=57343&&(x=1024*(x-55296)+m-56320+65536)}return x},g.prototype.scanHexEscape=function(y){for(var x=y==="u"?4:2,m=0,v=0;v<x;++v){if(this.eof()||!f.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;m=16*m+h(this.source[this.index++])}return String.fromCharCode(m)},g.prototype.scanUnicodeCodePointEscape=function(){var y=this.source[this.index],x=0;for(y==="}"&&this.throwUnexpectedToken();!this.eof()&&(y=this.source[this.index++],f.Character.isHexDigit(y.charCodeAt(0)));)x=16*x+h(y);return(x>1114111||y!=="}")&&this.throwUnexpectedToken(),f.Character.fromCodePoint(x)},g.prototype.getIdentifier=function(){for(var y=this.index++;!this.eof();){var x=this.source.charCodeAt(this.index);if(x===92)return this.index=y,this.getComplexIdentifier();if(x>=55296&&x<57343)return this.index=y,this.getComplexIdentifier();if(!f.Character.isIdentifierPart(x))break;++this.index}return this.source.slice(y,this.index)},g.prototype.getComplexIdentifier=function(){var y,x=this.codePointAt(this.index),m=f.Character.fromCodePoint(x);for(this.index+=m.length,x===92&&(this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,y=this.scanUnicodeCodePointEscape()):(y=this.scanHexEscape("u"))!==null&&y!=="\\"&&f.Character.isIdentifierStart(y.charCodeAt(0))||this.throwUnexpectedToken(),m=y);!this.eof()&&(x=this.codePointAt(this.index),f.Character.isIdentifierPart(x));)m+=y=f.Character.fromCodePoint(x),this.index+=y.length,x===92&&(m=m.substr(0,m.length-1),this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,y=this.scanUnicodeCodePointEscape()):(y=this.scanHexEscape("u"))!==null&&y!=="\\"&&f.Character.isIdentifierPart(y.charCodeAt(0))||this.throwUnexpectedToken(),m+=y);return m},g.prototype.octalToDecimal=function(y){var x=y!=="0",m=p(y);return!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(x=!0,m=8*m+p(this.source[this.index++]),"0123".indexOf(y)>=0&&!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(m=8*m+p(this.source[this.index++]))),{code:m,octal:x}},g.prototype.scanIdentifier=function(){var y,x=this.index,m=this.source.charCodeAt(x)===92?this.getComplexIdentifier():this.getIdentifier();if((y=m.length===1?3:this.isKeyword(m)?4:m==="null"?5:m==="true"||m==="false"?1:3)!=3&&x+m.length!==this.index){var v=this.index;this.index=x,this.tolerateUnexpectedToken(u.Messages.InvalidEscapedReservedWord),this.index=v}return{type:y,value:m,lineNumber:this.lineNumber,lineStart:this.lineStart,start:x,end:this.index}},g.prototype.scanPunctuator=function(){var y=this.index,x=this.source[this.index];switch(x){case"(":case"{":x==="{"&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,this.source[this.index]==="."&&this.source[this.index+1]==="."&&(this.index+=2,x="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:(x=this.source.substr(this.index,4))===">>>="?this.index+=4:(x=x.substr(0,3))==="==="||x==="!=="||x===">>>"||x==="<<="||x===">>="||x==="**="?this.index+=3:(x=x.substr(0,2))==="&&"||x==="||"||x==="=="||x==="!="||x==="+="||x==="-="||x==="*="||x==="/="||x==="++"||x==="--"||x==="<<"||x===">>"||x==="&="||x==="|="||x==="^="||x==="%="||x==="<="||x===">="||x==="=>"||x==="**"?this.index+=2:(x=this.source[this.index],"<>=!+-*%&|^/".indexOf(x)>=0&&++this.index)}return this.index===y&&this.throwUnexpectedToken(),{type:7,value:x,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanHexLiteral=function(y){for(var x="";!this.eof()&&f.Character.isHexDigit(this.source.charCodeAt(this.index));)x+=this.source[this.index++];return x.length===0&&this.throwUnexpectedToken(),f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+x,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanBinaryLiteral=function(y){for(var x,m="";!this.eof()&&((x=this.source[this.index])==="0"||x==="1");)m+=this.source[this.index++];return m.length===0&&this.throwUnexpectedToken(),this.eof()||(x=this.source.charCodeAt(this.index),(f.Character.isIdentifierStart(x)||f.Character.isDecimalDigit(x))&&this.throwUnexpectedToken()),{type:6,value:parseInt(m,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanOctalLiteral=function(y,x){var m="",v=!1;for(f.Character.isOctalDigit(y.charCodeAt(0))?(v=!0,m="0"+this.source[this.index++]):++this.index;!this.eof()&&f.Character.isOctalDigit(this.source.charCodeAt(this.index));)m+=this.source[this.index++];return v||m.length!==0||this.throwUnexpectedToken(),(f.Character.isIdentifierStart(this.source.charCodeAt(this.index))||f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(m,8),octal:v,lineNumber:this.lineNumber,lineStart:this.lineStart,start:x,end:this.index}},g.prototype.isImplicitOctalLiteral=function(){for(var y=this.index+1;y<this.length;++y){var x=this.source[y];if(x==="8"||x==="9")return!1;if(!f.Character.isOctalDigit(x.charCodeAt(0)))return!0}return!0},g.prototype.scanNumericLiteral=function(){var y=this.index,x=this.source[y];l.assert(f.Character.isDecimalDigit(x.charCodeAt(0))||x===".","Numeric literal must start with a decimal digit or a decimal point");var m="";if(x!=="."){if(m=this.source[this.index++],x=this.source[this.index],m==="0"){if(x==="x"||x==="X")return++this.index,this.scanHexLiteral(y);if(x==="b"||x==="B")return++this.index,this.scanBinaryLiteral(y);if(x==="o"||x==="O")return this.scanOctalLiteral(x,y);if(x&&f.Character.isOctalDigit(x.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(x,y)}for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)m+=this.source[this.index++];x=this.source[this.index]}if(x==="."){for(m+=this.source[this.index++];f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)m+=this.source[this.index++];x=this.source[this.index]}if(x==="e"||x==="E")if(m+=this.source[this.index++],(x=this.source[this.index])!=="+"&&x!=="-"||(m+=this.source[this.index++]),f.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;f.Character.isDecimalDigit(this.source.charCodeAt(this.index));)m+=this.source[this.index++];else this.throwUnexpectedToken();return f.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(m),lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanStringLiteral=function(){var y=this.index,x=this.source[y];l.assert(x==="'"||x==='"',"String literal must starts with a quote"),++this.index;for(var m=!1,v="";!this.eof();){var w=this.source[this.index++];if(w===x){x="";break}if(w==="\\")if((w=this.source[this.index++])&&f.Character.isLineTerminator(w.charCodeAt(0)))++this.lineNumber,w==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(w){case"u":if(this.source[this.index]==="{")++this.index,v+=this.scanUnicodeCodePointEscape();else{var C=this.scanHexEscape(w);C===null&&this.throwUnexpectedToken(),v+=C}break;case"x":var T=this.scanHexEscape(w);T===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),v+=T;break;case"n":v+=`
`;break;case"r":v+="\r";break;case"t":v+="	";break;case"b":v+="\b";break;case"f":v+="\f";break;case"v":v+="\v";break;case"8":case"9":v+=w,this.tolerateUnexpectedToken();break;default:if(w&&f.Character.isOctalDigit(w.charCodeAt(0))){var _=this.octalToDecimal(w);m=_.octal||m,v+=String.fromCharCode(_.code)}else v+=w}else{if(f.Character.isLineTerminator(w.charCodeAt(0)))break;v+=w}}return x!==""&&(this.index=y,this.throwUnexpectedToken()),{type:8,value:v,octal:m,lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.scanTemplate=function(){var y="",x=!1,m=this.index,v=this.source[m]==="`",w=!1,C=2;for(++this.index;!this.eof();){var T=this.source[this.index++];if(T==="`"){C=1,w=!0,x=!0;break}if(T==="$"){if(this.source[this.index]==="{"){this.curlyStack.push("${"),++this.index,x=!0;break}y+=T}else if(T==="\\")if(T=this.source[this.index++],f.Character.isLineTerminator(T.charCodeAt(0)))++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(T){case"n":y+=`
`;break;case"r":y+="\r";break;case"t":y+="	";break;case"u":if(this.source[this.index]==="{")++this.index,y+=this.scanUnicodeCodePointEscape();else{var _=this.index,S=this.scanHexEscape(T);S!==null?y+=S:(this.index=_,y+=T)}break;case"x":var b=this.scanHexEscape(T);b===null&&this.throwUnexpectedToken(u.Messages.InvalidHexEscapeSequence),y+=b;break;case"b":y+="\b";break;case"f":y+="\f";break;case"v":y+="\v";break;default:T==="0"?(f.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral),y+="\0"):f.Character.isOctalDigit(T.charCodeAt(0))?this.throwUnexpectedToken(u.Messages.TemplateOctalLiteral):y+=T}else f.Character.isLineTerminator(T.charCodeAt(0))?(++this.lineNumber,T==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index,y+=`
`):y+=T}return x||this.throwUnexpectedToken(),v||this.curlyStack.pop(),{type:10,value:this.source.slice(m+1,this.index-C),cooked:y,head:v,tail:w,lineNumber:this.lineNumber,lineStart:this.lineStart,start:m,end:this.index}},g.prototype.testRegExp=function(y,x){var m=y,v=this;x.indexOf("u")>=0&&(m=m.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,function(w,C,T){var _=parseInt(C||T,16);return _>1114111&&v.throwUnexpectedToken(u.Messages.InvalidRegExp),_<=65535?String.fromCharCode(_):""}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,""));try{RegExp(m)}catch{this.throwUnexpectedToken(u.Messages.InvalidRegExp)}try{return new RegExp(y,x)}catch{return null}},g.prototype.scanRegExpBody=function(){var y=this.source[this.index];l.assert(y==="/","Regular expression literal must start with a slash");for(var x=this.source[this.index++],m=!1,v=!1;!this.eof();)if(x+=y=this.source[this.index++],y==="\\")y=this.source[this.index++],f.Character.isLineTerminator(y.charCodeAt(0))&&this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),x+=y;else if(f.Character.isLineTerminator(y.charCodeAt(0)))this.throwUnexpectedToken(u.Messages.UnterminatedRegExp);else if(m)y==="]"&&(m=!1);else{if(y==="/"){v=!0;break}y==="["&&(m=!0)}return v||this.throwUnexpectedToken(u.Messages.UnterminatedRegExp),x.substr(1,x.length-2)},g.prototype.scanRegExpFlags=function(){for(var y="";!this.eof();){var x=this.source[this.index];if(!f.Character.isIdentifierPart(x.charCodeAt(0)))break;if(++this.index,x!=="\\"||this.eof())y+=x;else if((x=this.source[this.index])==="u"){++this.index;var m=this.index,v=this.scanHexEscape("u");if(v!==null)for(y+=v;m<this.index;++m)this.source[m];else this.index=m,y+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return y},g.prototype.scanRegExp=function(){var y=this.index,x=this.scanRegExpBody(),m=this.scanRegExpFlags();return{type:9,value:"",pattern:x,flags:m,regex:this.testRegExp(x,m),lineNumber:this.lineNumber,lineStart:this.lineStart,start:y,end:this.index}},g.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var y=this.source.charCodeAt(this.index);return f.Character.isIdentifierStart(y)?this.scanIdentifier():y===40||y===41||y===59?this.scanPunctuator():y===39||y===34?this.scanStringLiteral():y===46?f.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():f.Character.isDecimalDigit(y)?this.scanNumericLiteral():y===96||y===125&&this.curlyStack[this.curlyStack.length-1]==="${"?this.scanTemplate():y>=55296&&y<57343&&f.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},g}();s.Scanner=d},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.TokenName={},s.TokenName[1]="Boolean",s.TokenName[2]="<end>",s.TokenName[3]="Identifier",s.TokenName[4]="Keyword",s.TokenName[5]="Null",s.TokenName[6]="Numeric",s.TokenName[7]="Punctuator",s.TokenName[8]="String",s.TokenName[9]="RegularExpression",s.TokenName[10]="Template"},function(o,s){Object.defineProperty(s,"__esModule",{value:!0}),s.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",frasl:"",euro:"",image:"",weierp:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",lang:"",rang:""}},function(o,s,c){Object.defineProperty(s,"__esModule",{value:!0});var l=c(10),f=c(12),u=c(13),h=function(){function d(){this.values=[],this.curly=this.paren=-1}return d.prototype.beforeFunctionExpression=function(g){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(g)>=0},d.prototype.isRegexStart=function(){var g=this.values[this.values.length-1],y=g!==null;switch(g){case"this":case"]":y=!1;break;case")":var x=this.values[this.paren-1];y=x==="if"||x==="while"||x==="for"||x==="with";break;case"}":if(y=!1,this.values[this.curly-3]==="function")y=!!(m=this.values[this.curly-4])&&!this.beforeFunctionExpression(m);else if(this.values[this.curly-4]==="function"){var m;y=!(m=this.values[this.curly-5])||!this.beforeFunctionExpression(m)}}return y},d.prototype.push=function(g){g.type===7||g.type===4?(g.value==="{"?this.curly=this.values.length:g.value==="("&&(this.paren=this.values.length),this.values.push(g.value)):this.values.push(null)},d}(),p=function(){function d(g,y){this.errorHandler=new l.ErrorHandler,this.errorHandler.tolerant=!!y&&typeof y.tolerant=="boolean"&&y.tolerant,this.scanner=new f.Scanner(g,this.errorHandler),this.scanner.trackComment=!!y&&typeof y.comment=="boolean"&&y.comment,this.trackRange=!!y&&typeof y.range=="boolean"&&y.range,this.trackLoc=!!y&&typeof y.loc=="boolean"&&y.loc,this.buffer=[],this.reader=new h}return d.prototype.errors=function(){return this.errorHandler.errors},d.prototype.getNextToken=function(){if(this.buffer.length===0){var g=this.scanner.scanComments();if(this.scanner.trackComment)for(var y=0;y<g.length;++y){var x=g[y],m=this.scanner.source.slice(x.slice[0],x.slice[1]),v={type:x.multiLine?"BlockComment":"LineComment",value:m};this.trackRange&&(v.range=x.range),this.trackLoc&&(v.loc=x.loc),this.buffer.push(v)}if(!this.scanner.eof()){var w=void 0;this.trackLoc&&(w={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var C=this.scanner.source[this.scanner.index]==="/"&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(C);var T={type:u.TokenName[C.type],value:this.scanner.source.slice(C.start,C.end)};if(this.trackRange&&(T.range=[C.start,C.end]),this.trackLoc&&(w.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},T.loc=w),C.type===9){var _=C.pattern,S=C.flags;T.regex={pattern:_,flags:S}}this.buffer.push(T)}}return this.buffer.shift()},d}();s.Tokenizer=p}])},n.exports=a()},function(n,r,i){var a=i(38),o=i(53),s=i(76),c=i(54),l=Object.prototype.toString,f=Object.prototype.hasOwnProperty,u={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},h=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function p(M){var U,z,Y;if(U=M.toString(16).toUpperCase(),M<=255)z="x",Y=2;else if(M<=65535)z="u",Y=4;else{if(!(M<=4294967295))throw new o("code point within a string may not be greater than 0xFFFFFFFF");z="U",Y=8}return"\\"+z+a.repeat("0",Y-U.length)+U}function d(M){this.schema=M.schema||s,this.indent=Math.max(1,M.indent||2),this.noArrayIndent=M.noArrayIndent||!1,this.skipInvalid=M.skipInvalid||!1,this.flowLevel=a.isNothing(M.flowLevel)?-1:M.flowLevel,this.styleMap=function(U,z){var Y,W,B,j,ie,ae,fe;if(z===null)return{};for(Y={},B=0,j=(W=Object.keys(z)).length;B<j;B+=1)ie=W[B],ae=String(z[ie]),ie.slice(0,2)==="!!"&&(ie="tag:yaml.org,2002:"+ie.slice(2)),(fe=U.compiledTypeMap.fallback[ie])&&f.call(fe.styleAliases,ae)&&(ae=fe.styleAliases[ae]),Y[ie]=ae;return Y}(this.schema,M.styles||null),this.sortKeys=M.sortKeys||!1,this.lineWidth=M.lineWidth||80,this.noRefs=M.noRefs||!1,this.noCompatMode=M.noCompatMode||!1,this.condenseFlow=M.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function g(M,U){for(var z,Y=a.repeat(" ",U),W=0,B=-1,j="",ie=M.length;W<ie;)(B=M.indexOf(`
`,W))===-1?(z=M.slice(W),W=ie):(z=M.slice(W,B+1),W=B+1),z.length&&z!==`
`&&(j+=Y),j+=z;return j}function y(M,U){return`
`+a.repeat(" ",M.indent*U)}function x(M){return M===32||M===9}function m(M){return 32<=M&&M<=126||161<=M&&M<=55295&&M!==8232&&M!==8233||57344<=M&&M<=65533&&M!==65279||65536<=M&&M<=1114111}function v(M,U){return m(M)&&M!==65279&&M!==44&&M!==91&&M!==93&&M!==123&&M!==125&&M!==58&&(M!==35||U&&function(z){return m(z)&&!x(z)&&z!==65279&&z!==13&&z!==10}(U))}function w(M){return/^\n* /.test(M)}function C(M,U,z,Y,W){var B,j,ie,ae,fe=!1,Ee=!1,ge=Y!==-1,be=-1,Re=m(ae=M.charCodeAt(0))&&ae!==65279&&!x(ae)&&ae!==45&&ae!==63&&ae!==58&&ae!==44&&ae!==91&&ae!==93&&ae!==123&&ae!==125&&ae!==35&&ae!==38&&ae!==42&&ae!==33&&ae!==124&&ae!==61&&ae!==62&&ae!==39&&ae!==34&&ae!==37&&ae!==64&&ae!==96&&!x(M.charCodeAt(M.length-1));if(U)for(B=0;B<M.length;B++){if(!m(j=M.charCodeAt(B)))return 5;ie=B>0?M.charCodeAt(B-1):null,Re=Re&&v(j,ie)}else{for(B=0;B<M.length;B++){if((j=M.charCodeAt(B))===10)fe=!0,ge&&(Ee=Ee||B-be-1>Y&&M[be+1]!==" ",be=B);else if(!m(j))return 5;ie=B>0?M.charCodeAt(B-1):null,Re=Re&&v(j,ie)}Ee=Ee||ge&&B-be-1>Y&&M[be+1]!==" "}return fe||Ee?z>9&&w(M)?5:Ee?4:3:Re&&!W(M)?1:2}function T(M,U,z,Y){M.dump=function(){if(U.length===0)return"''";if(!M.noCompatMode&&h.indexOf(U)!==-1)return"'"+U+"'";var W=M.indent*Math.max(1,z),B=M.lineWidth===-1?-1:Math.max(Math.min(M.lineWidth,40),M.lineWidth-W),j=Y||M.flowLevel>-1&&z>=M.flowLevel;switch(C(U,j,M.indent,B,function(ie){return function(ae,fe){var Ee,ge;for(Ee=0,ge=ae.implicitTypes.length;Ee<ge;Ee+=1)if(ae.implicitTypes[Ee].resolve(fe))return!0;return!1}(M,ie)})){case 1:return U;case 2:return"'"+U.replace(/'/g,"''")+"'";case 3:return"|"+_(U,M.indent)+S(g(U,W));case 4:return">"+_(U,M.indent)+S(g(function(ie,ae){for(var fe,Ee,ge=/(\n+)([^\n]*)/g,be=(Ne=ie.indexOf(`
`),Ne=Ne!==-1?Ne:ie.length,ge.lastIndex=Ne,b(ie.slice(0,Ne),ae)),Re=ie[0]===`
`||ie[0]===" ",Ne;Ee=ge.exec(ie);){var Ce=Ee[1],P=Ee[2];fe=P[0]===" ",be+=Ce+(Re||fe||P===""?"":`
`)+b(P,ae),Re=fe}return be}(U,B),W));case 5:return'"'+function(ie){for(var ae,fe,Ee,ge="",be=0;be<ie.length;be++)(ae=ie.charCodeAt(be))>=55296&&ae<=56319&&(fe=ie.charCodeAt(be+1))>=56320&&fe<=57343?(ge+=p(1024*(ae-55296)+fe-56320+65536),be++):(Ee=u[ae],ge+=!Ee&&m(ae)?ie[be]:Ee||p(ae));return ge}(U)+'"';default:throw new o("impossible error: invalid scalar style")}}()}function _(M,U){var z=w(M)?String(U):"",Y=M[M.length-1]===`
`;return z+(Y&&(M[M.length-2]===`
`||M===`
`)?"+":Y?"":"-")+`
`}function S(M){return M[M.length-1]===`
`?M.slice(0,-1):M}function b(M,U){if(M===""||M[0]===" ")return M;for(var z,Y,W=/ [^ ]/g,B=0,j=0,ie=0,ae="";z=W.exec(M);)(ie=z.index)-B>U&&(Y=j>B?j:ie,ae+=`
`+M.slice(B,Y),B=Y+1),j=ie;return ae+=`
`,M.length-B>U&&j>B?ae+=M.slice(B,j)+`
`+M.slice(j+1):ae+=M.slice(B),ae.slice(1)}function D(M,U,z){var Y,W,B,j,ie,ae;for(B=0,j=(W=z?M.explicitTypes:M.implicitTypes).length;B<j;B+=1)if(((ie=W[B]).instanceOf||ie.predicate)&&(!ie.instanceOf||typeof U=="object"&&U instanceof ie.instanceOf)&&(!ie.predicate||ie.predicate(U))){if(M.tag=z?ie.tag:"?",ie.represent){if(ae=M.styleMap[ie.tag]||ie.defaultStyle,l.call(ie.represent)==="[object Function]")Y=ie.represent(U,ae);else{if(!f.call(ie.represent,ae))throw new o("!<"+ie.tag+'> tag resolver accepts not "'+ae+'" style');Y=ie.represent[ae](U,ae)}M.dump=Y}return!0}return!1}function E(M,U,z,Y,W,B){M.tag=null,M.dump=z,D(M,z,!1)||D(M,z,!0);var j=l.call(M.dump);Y&&(Y=M.flowLevel<0||M.flowLevel>U);var ie,ae,fe=j==="[object Object]"||j==="[object Array]";if(fe&&(ae=(ie=M.duplicates.indexOf(z))!==-1),(M.tag!==null&&M.tag!=="?"||ae||M.indent!==2&&U>0)&&(W=!1),ae&&M.usedDuplicates[ie])M.dump="*ref_"+ie;else{if(fe&&ae&&!M.usedDuplicates[ie]&&(M.usedDuplicates[ie]=!0),j==="[object Object]")Y&&Object.keys(M.dump).length!==0?(function(ge,be,Re,Ne){var Ce,P,O,A,L,k,$="",H=ge.tag,se=Object.keys(Re);if(ge.sortKeys===!0)se.sort();else if(typeof ge.sortKeys=="function")se.sort(ge.sortKeys);else if(ge.sortKeys)throw new o("sortKeys must be a boolean or a function");for(Ce=0,P=se.length;Ce<P;Ce+=1)k="",Ne&&Ce===0||(k+=y(ge,be)),A=Re[O=se[Ce]],E(ge,be+1,O,!0,!0,!0)&&((L=ge.tag!==null&&ge.tag!=="?"||ge.dump&&ge.dump.length>1024)&&(ge.dump&&ge.dump.charCodeAt(0)===10?k+="?":k+="? "),k+=ge.dump,L&&(k+=y(ge,be)),E(ge,be+1,A,!0,L)&&(ge.dump&&ge.dump.charCodeAt(0)===10?k+=":":k+=": ",$+=k+=ge.dump));ge.tag=H,ge.dump=$||"{}"}(M,U,M.dump,W),ae&&(M.dump="&ref_"+ie+M.dump)):(function(ge,be,Re){var Ne,Ce,P,O,A,L="",k=ge.tag,$=Object.keys(Re);for(Ne=0,Ce=$.length;Ne<Ce;Ne+=1)A="",Ne!==0&&(A+=", "),ge.condenseFlow&&(A+='"'),O=Re[P=$[Ne]],E(ge,be,P,!1,!1)&&(ge.dump.length>1024&&(A+="? "),A+=ge.dump+(ge.condenseFlow?'"':"")+":"+(ge.condenseFlow?"":" "),E(ge,be,O,!1,!1)&&(L+=A+=ge.dump));ge.tag=k,ge.dump="{"+L+"}"}(M,U,M.dump),ae&&(M.dump="&ref_"+ie+" "+M.dump));else if(j==="[object Array]"){var Ee=M.noArrayIndent&&U>0?U-1:U;Y&&M.dump.length!==0?(function(ge,be,Re,Ne){var Ce,P,O="",A=ge.tag;for(Ce=0,P=Re.length;Ce<P;Ce+=1)E(ge,be+1,Re[Ce],!0,!0)&&(Ne&&Ce===0||(O+=y(ge,be)),ge.dump&&ge.dump.charCodeAt(0)===10?O+="-":O+="- ",O+=ge.dump);ge.tag=A,ge.dump=O||"[]"}(M,Ee,M.dump,W),ae&&(M.dump="&ref_"+ie+M.dump)):(function(ge,be,Re){var Ne,Ce,P="",O=ge.tag;for(Ne=0,Ce=Re.length;Ne<Ce;Ne+=1)E(ge,be,Re[Ne],!1,!1)&&(Ne!==0&&(P+=","+(ge.condenseFlow?"":" ")),P+=ge.dump);ge.tag=O,ge.dump="["+P+"]"}(M,Ee,M.dump),ae&&(M.dump="&ref_"+ie+" "+M.dump))}else{if(j!=="[object String]"){if(M.skipInvalid)return!1;throw new o("unacceptable kind of an object to dump "+j)}M.tag!=="?"&&T(M,M.dump,U,B)}M.tag!==null&&M.tag!=="?"&&(M.dump="!<"+M.tag+"> "+M.dump)}return!0}function R(M,U){var z,Y,W=[],B=[];for(function j(ie,ae,fe){var Ee,ge,be;if(ie!==null&&typeof ie=="object")if((ge=ae.indexOf(ie))!==-1)fe.indexOf(ge)===-1&&fe.push(ge);else if(ae.push(ie),Array.isArray(ie))for(ge=0,be=ie.length;ge<be;ge+=1)j(ie[ge],ae,fe);else for(Ee=Object.keys(ie),ge=0,be=Ee.length;ge<be;ge+=1)j(ie[Ee[ge]],ae,fe)}(M,W,B),z=0,Y=B.length;z<Y;z+=1)U.duplicates.push(W[B[z]]);U.usedDuplicates=new Array(Y)}function F(M,U){var z=new d(U=U||{});return z.noRefs||R(M,z),E(z,0,M,!0,!0)?z.dump+`
`:""}n.exports.dump=F,n.exports.safeDump=function(M,U){return F(M,a.extend({schema:c},U))}},function(n,r,i){i(31),i(32),i(33),i(64),i(19),i(65),i(20),i(68),i(92),i(144),i(22),i(94),i(23);var a,o=this&&this.__extends||(a=function(C,T){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,S){_.__proto__=S}||function(_,S){for(var b in S)S.hasOwnProperty(b)&&(_[b]=S[b])})(C,T)},function(C,T){function _(){this.constructor=C}a(C,T),C.prototype=T===null?Object.create(T):(_.prototype=T.prototype,new _)}),s=this&&this.__values||function(C){var T=typeof Symbol=="function"&&Symbol.iterator,_=T&&C[T],S=0;if(_)return _.call(C);if(C&&typeof C.length=="number")return{next:function(){return C&&S>=C.length&&(C=void 0),{value:C&&C[S++],done:!C}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(C,T){var _=typeof Symbol=="function"&&C[Symbol.iterator];if(!_)return C;var S,b,D=_.call(C),E=[];try{for(;(T===void 0||T-- >0)&&!(S=D.next()).done;)E.push(S.value)}catch(R){b={error:R}}finally{try{S&&!S.done&&(_=D.return)&&_.call(D)}finally{if(b)throw b.error}}return E};Object.defineProperty(r,"__esModule",{value:!0});var l=i(91),f=i(1),u=i(183),h=i(0),p=i(7),d=i(95),g=i(69),y=i(3),x=i(305),m=i(306),v=i(307),w=function(C){function T(_,S){S===void 0&&(S=!1);var b=C.call(this)||this;return b._hasDeclaration=!1,b._docTypeName="",b._hasDocumentElement=!1,b._currentElementSerialized=!1,b._openTags=[],b._ended=!1,b._fragment=S,b._options=f.applyDefaults(_||{},l.DefaultXMLBuilderCBOptions),b._builderOptions={defaultNamespace:b._options.defaultNamespace,namespaceAlias:b._options.namespaceAlias},b._options.format==="json"?b._writer=new m.JSONCBWriter(b._options):b._options.format==="yaml"?b._writer=new v.YAMLCBWriter(b._options):b._writer=new x.XMLCBWriter(b._options),b._options.data!==void 0&&b.on("data",b._options.data),b._options.end!==void 0&&b.on("end",b._options.end),b._options.error!==void 0&&b.on("error",b._options.error),b._prefixMap=new d.NamespacePrefixMap,b._prefixMap.set("xml",p.namespace.XML),b._prefixIndex={value:1},b._push(b._writer.frontMatter()),b}return o(T,C),T.prototype.ele=function(_,S,b){var D,E;if(f.isObject(_)||f.isString(_)&&(/^\s*</.test(_)||/^\s*[\{\[]/.test(_)||/^(\s*|(#.*)|(%.*))*---/.test(_))){var R=u.fragment().set(this._options);try{R.ele(_)}catch(z){return this.emit("error",z),this}try{for(var F=s(R.node.childNodes),M=F.next();!M.done;M=F.next()){var U=M.value;this._fromNode(U)}}catch(z){D={error:z}}finally{try{M&&!M.done&&(E=F.return)&&E.call(F)}finally{if(D)throw D.error}}return this}if(this._serializeOpenTag(!0),!this._fragment&&this._hasDocumentElement&&this._writer.level===0)return this.emit("error",new Error("Document cannot have multiple document element nodes.")),this;try{this._currentElement=u.fragment(this._builderOptions).ele(_,S,b)}catch(z){return this.emit("error",z),this}return this._fragment||this._hasDocumentElement||this._docTypeName===""||this._currentElement.node._qualifiedName===this._docTypeName?(this._currentElementSerialized=!1,this._fragment||(this._hasDocumentElement=!0),this):(this.emit("error",new Error("Document element name does not match DocType declaration name.")),this)},T.prototype.att=function(_,S,b){if(this._currentElement===void 0)return this.emit("error",new Error("Cannot insert an attribute node as child of a document node.")),this;try{this._currentElement.att(_,S,b)}catch(D){return this.emit("error",D),this}return this},T.prototype.com=function(_){var S;this._serializeOpenTag(!0);try{S=u.fragment(this._builderOptions).com(_).first().node}catch(b){return this.emit("error",b),this}return!this._options.wellFormed||h.xml_isLegalChar(S.data)&&S.data.indexOf("--")===-1&&!S.data.endsWith("-")?(this._push(this._writer.comment(S.data)),this):(this.emit("error",new Error("Comment data contains invalid characters (well-formed required).")),this)},T.prototype.txt=function(_){if(!this._fragment&&this._currentElement===void 0)return this.emit("error",new Error("Cannot insert a text node as child of a document node.")),this;var S;this._serializeOpenTag(!0);try{S=u.fragment(this._builderOptions).txt(_).first().node}catch(D){return this.emit("error",D),this}if(this._options.wellFormed&&!h.xml_isLegalChar(S.data))return this.emit("error",new Error("Text data contains invalid characters (well-formed required).")),this;var b=S.data.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return this._push(this._writer.text(b)),this},T.prototype.ins=function(_,S){var b;S===void 0&&(S=""),this._serializeOpenTag(!0);try{b=u.fragment(this._builderOptions).ins(_,S).first().node}catch(D){return this.emit("error",D),this}return this._options.wellFormed&&(b.target.indexOf(":")!==-1||/^xml$/i.test(b.target))?(this.emit("error",new Error("Processing instruction target contains invalid characters (well-formed required).")),this):this._options.wellFormed&&!h.xml_isLegalChar(b.data)?(this.emit("error",Error("Processing instruction data contains invalid characters (well-formed required).")),this):(this._push(this._writer.instruction(b.target,b.data)),this)},T.prototype.dat=function(_){var S;this._serializeOpenTag(!0);try{S=u.fragment(this._builderOptions).dat(_).first().node}catch(b){return this.emit("error",b),this}return this._push(this._writer.cdata(S.data)),this},T.prototype.dec=function(_){return _===void 0&&(_={version:"1.0"}),this._fragment?(this.emit("error",Error("Cannot insert an XML declaration into a document fragment.")),this):this._hasDeclaration?(this.emit("error",Error("XML declaration is already inserted.")),this):(this._push(this._writer.declaration(_.version||"1.0",_.encoding,_.standalone)),this._hasDeclaration=!0,this)},T.prototype.dtd=function(_){if(this._fragment)return this.emit("error",Error("Cannot insert a DocType declaration into a document fragment.")),this;if(this._docTypeName!=="")return this.emit("error",new Error("DocType declaration is already inserted.")),this;if(this._hasDocumentElement)return this.emit("error",new Error("Cannot insert DocType declaration after document element.")),this;var S;try{S=u.create().dtd(_).first().node}catch(b){return this.emit("error",b),this}return this._options.wellFormed&&!h.xml_isPubidChar(S.publicId)?(this.emit("error",new Error("DocType public identifier does not match PubidChar construct (well-formed required).")),this):this._options.wellFormed&&(!h.xml_isLegalChar(S.systemId)||S.systemId.indexOf('"')!==-1&&S.systemId.indexOf("'")!==-1)?(this.emit("error",new Error("DocType system identifier contains invalid characters (well-formed required).")),this):(this._docTypeName=_.name,this._push(this._writer.docType(_.name,S.publicId,S.systemId)),this)},T.prototype.import=function(_){var S,b,D=u.fragment().set(this._options);try{D.import(_)}catch(M){return this.emit("error",M),this}try{for(var E=s(D.node.childNodes),R=E.next();!R.done;R=E.next()){var F=R.value;this._fromNode(F)}}catch(M){S={error:M}}finally{try{R&&!R.done&&(b=E.return)&&b.call(E)}finally{if(S)throw S.error}}return this},T.prototype.up=function(){return this._serializeOpenTag(!1),this._serializeCloseTag(),this},T.prototype.end=function(){for(this._serializeOpenTag(!1);this._openTags.length>0;)this._serializeCloseTag();return this._push(null),this},T.prototype._serializeOpenTag=function(_){if(!this._currentElementSerialized&&this._currentElement!==void 0){var S=this._currentElement.node;if(!this._options.wellFormed||S.localName.indexOf(":")===-1&&h.xml_isName(S.localName)){var b="",D=!1,E=this._prefixMap.copy(),R={},F=this._recordNamespaceInformation(S,E,R),M=this._openTags.length===0?null:this._openTags[this._openTags.length-1][1],U=S.namespaceURI;if(U===null&&(U=M),M===U)F!==null&&(D=!0),b=U===p.namespace.XML?"xml:"+S.localName:S.localName,this._writer.beginElement(b),this._push(this._writer.openTagBegin(b));else{var z=S.prefix,Y=null;if(z===null&&U===F||(Y=E.get(z,U)),z==="xmlns"){if(this._options.wellFormed)return void this.emit("error",new Error("An element cannot have the 'xmlns' prefix (well-formed required)."));Y=z}Y!==null?(b=Y+":"+S.localName,F!==null&&F!==p.namespace.XML&&(M=F||null),this._writer.beginElement(b),this._push(this._writer.openTagBegin(b))):z!==null?(z in R&&(z=this._generatePrefix(U,E,this._prefixIndex)),E.set(z,U),b+=z+":"+S.localName,this._writer.beginElement(b),this._push(this._writer.openTagBegin(b)),this._push(this._writer.attribute("xmlns:"+z,this._serializeAttributeValue(U,this._options.wellFormed))),F!==null&&(M=F||null)):F===null||F!==null&&F!==U?(D=!0,b+=S.localName,M=U,this._writer.beginElement(b),this._push(this._writer.openTagBegin(b)),this._push(this._writer.attribute("xmlns",this._serializeAttributeValue(U,this._options.wellFormed)))):(b+=S.localName,M=U,this._writer.beginElement(b),this._push(this._writer.openTagBegin(b)))}this._serializeAttributes(S,E,this._prefixIndex,R,D,this._options.wellFormed);var W=U===p.namespace.HTML;W&&!_&&T._VoidElementNames.has(S.localName)?(this._push(this._writer.openTagEnd(b,!0,!0)),this._writer.endElement(b)):W||_?this._push(this._writer.openTagEnd(b,!1,!1)):(this._push(this._writer.openTagEnd(b,!0,!1)),this._writer.endElement(b)),this._currentElementSerialized=!0,this._openTags.push([b,M,this._prefixMap,_]),this._isPrefixMapModified(this._prefixMap,E)&&(this._prefixMap=E),this._writer.level++}else this.emit("error",new Error("Node local name contains invalid characters (well-formed required)."))}},T.prototype._serializeCloseTag=function(){this._writer.level--;var _=this._openTags.pop();if(_!==void 0){var S=c(_,4),b=S[0],D=(S[1],S[2]),E=S[3];this._prefixMap=D,E&&(this._push(this._writer.closeTag(b)),this._writer.endElement(b))}else this.emit("error",new Error("Last element is undefined."))},T.prototype._push=function(_){_===null?(this._ended=!0,this.emit("end")):this._ended?this.emit("error",new Error("Cannot push to ended stream.")):_.length!==0&&(this._writer.hasData=!0,this.emit("data",_,this._writer.level))},T.prototype._fromNode=function(_){var S,b,D,E;if(y.Guard.isElementNode(_)){var R=_.prefix?_.prefix+":"+_.localName:_.localName;_.namespaceURI!==null?this.ele(_.namespaceURI,R):this.ele(R);try{for(var F=s(_.attributes),M=F.next();!M.done;M=F.next()){var U=M.value,z=U.prefix?U.prefix+":"+U.localName:U.localName;U.namespaceURI!==null?this.att(U.namespaceURI,z,U.value):this.att(z,U.value)}}catch(j){S={error:j}}finally{try{M&&!M.done&&(b=F.return)&&b.call(F)}finally{if(S)throw S.error}}try{for(var Y=s(_.childNodes),W=Y.next();!W.done;W=Y.next()){var B=W.value;this._fromNode(B)}}catch(j){D={error:j}}finally{try{W&&!W.done&&(E=Y.return)&&E.call(Y)}finally{if(D)throw D.error}}this.up()}else y.Guard.isExclusiveTextNode(_)&&_.data?this.txt(_.data):y.Guard.isCommentNode(_)?this.com(_.data):y.Guard.isCDATASectionNode(_)?this.dat(_.data):y.Guard.isProcessingInstructionNode(_)&&this.ins(_.target,_.data)},T.prototype._serializeAttributes=function(_,S,b,D,E,R){var F,M,U=R?new g.LocalNameSet:void 0;try{for(var z=s(_.attributes),Y=z.next();!Y.done;Y=z.next()){var W=Y.value;if(R||E||W.namespaceURI!==null){if(R&&U&&U.has(W.namespaceURI,W.localName))return void this.emit("error",new Error("Element contains duplicate attributes (well-formed required)."));R&&U&&U.set(W.namespaceURI,W.localName);var B=W.namespaceURI,j=null;if(B!==null)if(j=S.get(W.prefix,B),B===p.namespace.XMLNS){if(W.value===p.namespace.XML||W.prefix===null&&E||W.prefix!==null&&(!(W.localName in D)||D[W.localName]!==W.value)&&S.has(W.localName,W.value))continue;if(R&&W.value===p.namespace.XMLNS)return void this.emit("error",new Error("XMLNS namespace is reserved (well-formed required)."));if(R&&W.value==="")return void this.emit("error",new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required)."));W.prefix==="xmlns"&&(j="xmlns")}else j===null&&(j=W.prefix===null||S.hasPrefix(W.prefix)&&!S.has(W.prefix,B)?this._generatePrefix(B,S,b):W.prefix,this._push(this._writer.attribute("xmlns:"+j,this._serializeAttributeValue(B,this._options.wellFormed))));if(R&&(W.localName.indexOf(":")!==-1||!h.xml_isName(W.localName)||W.localName==="xmlns"&&B===null))return void this.emit("error",new Error("Attribute local name contains invalid characters (well-formed required)."));this._push(this._writer.attribute((j!==null?j+":":"")+W.localName,this._serializeAttributeValue(W.value,this._options.wellFormed)))}else this._push(this._writer.attribute(W.localName,this._serializeAttributeValue(W.value,this._options.wellFormed)))}}catch(ie){F={error:ie}}finally{try{Y&&!Y.done&&(M=z.return)&&M.call(z)}finally{if(F)throw F.error}}},T.prototype._serializeAttributeValue=function(_,S){return S&&_!==null&&!h.xml_isLegalChar(_)?(this.emit("error",new Error("Invalid characters in attribute value.")),""):_===null?"":_.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},T.prototype._recordNamespaceInformation=function(_,S,b){var D,E,R=null;try{for(var F=s(_.attributes),M=F.next();!M.done;M=F.next()){var U=M.value,z=U.namespaceURI,Y=U.prefix;if(z===p.namespace.XMLNS){if(Y===null){R=U.value;continue}var W=U.localName,B=U.value;if(B===p.namespace.XML||(B===""&&(B=null),S.has(W,B)))continue;S.set(W,B),b[W]=B||""}}}catch(j){D={error:j}}finally{try{M&&!M.done&&(E=F.return)&&E.call(F)}finally{if(D)throw D.error}}return R},T.prototype._generatePrefix=function(_,S,b){var D="ns"+b.value;return b.value++,S.set(D,_),D},T.prototype._isPrefixMapModified=function(_,S){var b=_._items,D=S._items,E=_._nullItems,R=S._nullItems;for(var F in D){var M=b[F];if(M===void 0)return!0;var U=D[F];if(M.length!==U.length)return!0;for(var z=0;z<M.length;z++)if(M[z]!==U[z])return!0}if(E.length!==R.length)return!0;for(z=0;z<E.length;z++)if(E[z]!==R[z])return!0;return!1},T._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),T}(i(308).EventEmitter);r.XMLBuilderCBImpl=w},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(c,l){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var h in u)u.hasOwnProperty(h)&&(f[h]=u[h])})(c,l)},function(c,l){function f(){this.constructor=c}a(c,l),c.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(c){function l(f){var u=c.call(this,f)||this;return u._lineLength=0,u}return o(l,c),l.prototype.frontMatter=function(){return""},l.prototype.declaration=function(f,u,h){var p=this._beginLine()+"<?xml";return p+=' version="'+f+'"',u!==void 0&&(p+=' encoding="'+u+'"'),h!==void 0&&(p+=' standalone="'+(h?"yes":"no")+'"'),p+="?>"},l.prototype.docType=function(f,u,h){var p=this._beginLine();return p+=u&&h?"<!DOCTYPE "+f+' PUBLIC "'+u+'" "'+h+'">':u?"<!DOCTYPE "+f+' PUBLIC "'+u+'">':h?"<!DOCTYPE "+f+' SYSTEM "'+h+'">':"<!DOCTYPE "+f+">"},l.prototype.comment=function(f){return this._beginLine()+"<!--"+f+"-->"},l.prototype.text=function(f){return this._beginLine()+f},l.prototype.instruction=function(f,u){return u?this._beginLine()+"<?"+f+" "+u+"?>":this._beginLine()+"<?"+f+"?>"},l.prototype.cdata=function(f){return this._beginLine()+"<![CDATA["+f+"]]>"},l.prototype.openTagBegin=function(f){return this._lineLength+=1+f.length,this._beginLine()+"<"+f},l.prototype.openTagEnd=function(f,u,h){return h?" />":u?this._writerOptions.allowEmptyTags?"></"+f+">":this._writerOptions.spaceBeforeSlash?" />":"/>":">"},l.prototype.closeTag=function(f){return this._beginLine()+"</"+f+">"},l.prototype.attribute=function(f,u){var h=f+'="'+u+'"';return this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._lineLength+1+h.length>this._writerOptions.width?(h=this._beginLine()+this._indent(1)+h,this._lineLength=h.length,h):(this._lineLength+=1+h.length," "+h)},l.prototype.beginElement=function(f){},l.prototype.endElement=function(f){},l.prototype._beginLine=function(){if(this._writerOptions.prettyPrint){var f=(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level);return this._lineLength=f.length,f}return""},l.prototype._indent=function(f){return f<=0?"":this._writerOptions.indent.repeat(f)},l}(i(114).BaseCBWriter);r.XMLCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(c,l){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var h in u)u.hasOwnProperty(h)&&(f[h]=u[h])})(c,l)},function(c,l){function f(){this.constructor=c}a(c,l),c.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(c){function l(f){var u=c.call(this,f)||this;return u._hasChildren=[],u._additionalLevel=0,u}return o(l,c),l.prototype.frontMatter=function(){return""},l.prototype.declaration=function(f,u,h){return""},l.prototype.docType=function(f,u,h){return""},l.prototype.comment=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.comment)+this._sep()+this._val(f)+this._sep()+"}"},l.prototype.text=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.text)+this._sep()+this._val(f)+this._sep()+"}"},l.prototype.instruction=function(f,u){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.ins)+this._sep()+this._val(u?f+" "+u:f)+this._sep()+"}"},l.prototype.cdata=function(f){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.cdata)+this._sep()+this._val(f)+this._sep()+"}"},l.prototype.attribute=function(f,u){return this._comma()+this._beginLine(1)+"{"+this._sep()+this._key(this._builderOptions.convert.att+f)+this._sep()+this._val(u)+this._sep()+"}"},l.prototype.openTagBegin=function(f){var u=this._comma()+this._beginLine()+"{"+this._sep()+this._key(f)+this._sep()+"{";return this._additionalLevel++,this.hasData=!0,u+=this._beginLine()+this._key(this._builderOptions.convert.text)+this._sep()+"[",this._hasChildren.push(!1),u},l.prototype.openTagEnd=function(f,u,h){if(u){var p=this._sep()+"]";return this._additionalLevel--,p+=this._beginLine()+"}"+this._sep()+"}"}return""},l.prototype.closeTag=function(f){var u=this._beginLine()+"]";return this._additionalLevel--,u+=this._beginLine()+"}"+this._sep()+"}"},l.prototype.beginElement=function(f){},l.prototype.endElement=function(f){this._hasChildren.pop()},l.prototype._beginLine=function(f){return f===void 0&&(f=0),this._writerOptions.prettyPrint?(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level+f):""},l.prototype._indent=function(f){return f+this._additionalLevel<=0?"":this._writerOptions.indent.repeat(f+this._additionalLevel)},l.prototype._comma=function(){var f=this._hasChildren[this._hasChildren.length-1]?",":"";return this._hasChildren.length>0&&(this._hasChildren[this._hasChildren.length-1]=!0),f},l.prototype._sep=function(){return this._writerOptions.prettyPrint?" ":""},l.prototype._key=function(f){return'"'+f+'":'},l.prototype._val=function(f){return JSON.stringify(f)},l}(i(114).BaseCBWriter);r.JSONCBWriter=s},function(n,r,i){i(74);var a,o=this&&this.__extends||(a=function(c,l){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var h in u)u.hasOwnProperty(h)&&(f[h]=u[h])})(c,l)},function(c,l){function f(){this.constructor=c}a(c,l),c.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(c){function l(f){var u=c.call(this,f)||this;if(u._rootWritten=!1,u._additionalLevel=0,f.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(f.offset<0)throw new Error("YAML offset should be zero or a positive number.");return u}return o(l,c),l.prototype.frontMatter=function(){return this._beginLine()+"---"},l.prototype.declaration=function(f,u,h){return""},l.prototype.docType=function(f,u,h){return""},l.prototype.comment=function(f){return this._beginLine()+this._key(this._builderOptions.convert.comment)+" "+this._val(f)},l.prototype.text=function(f){return this._beginLine()+this._key(this._builderOptions.convert.text)+" "+this._val(f)},l.prototype.instruction=function(f,u){return this._beginLine()+this._key(this._builderOptions.convert.ins)+" "+this._val(u?f+" "+u:f)},l.prototype.cdata=function(f){return this._beginLine()+this._key(this._builderOptions.convert.cdata)+" "+this._val(f)},l.prototype.attribute=function(f,u){this._additionalLevel++;var h=this._beginLine()+this._key(this._builderOptions.convert.att+f)+" "+this._val(u);return this._additionalLevel--,h},l.prototype.openTagBegin=function(f){var u=this._beginLine()+this._key(f);return this._rootWritten||(this._rootWritten=!0),this.hasData=!0,this._additionalLevel++,u+=this._beginLine(!0)+this._key(this._builderOptions.convert.text)},l.prototype.openTagEnd=function(f,u,h){return u?" "+this._val(""):""},l.prototype.closeTag=function(f){return this._additionalLevel--,""},l.prototype.beginElement=function(f){},l.prototype.endElement=function(f){},l.prototype._beginLine=function(f){return f===void 0&&(f=!1),(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level,f)},l.prototype._indent=function(f,u){if(f+this._additionalLevel<=0)return"";var h=this._writerOptions.indent.repeat(f+this._additionalLevel);return!u&&this._rootWritten?h.substr(0,h.length-2)+"-"+h.substr(-1,1):h},l.prototype._key=function(f){return'"'+f+'":'},l.prototype._val=function(f){return JSON.stringify(f)},l}(i(114).BaseCBWriter);r.YAMLCBWriter=s},function(n,r,i){var a,o=typeof Reflect=="object"?Reflect:null,s=o&&typeof o.apply=="function"?o.apply:function(v,w,C){return Function.prototype.apply.call(v,w,C)};a=o&&typeof o.ownKeys=="function"?o.ownKeys:Object.getOwnPropertySymbols?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:function(v){return Object.getOwnPropertyNames(v)};var c=Number.isNaN||function(v){return v!=v};function l(){l.init.call(this)}n.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var f=10;function u(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}function h(v){return v._maxListeners===void 0?l.defaultMaxListeners:v._maxListeners}function p(v,w,C,T){var _,S,b,D;if(u(C),(S=v._events)===void 0?(S=v._events=Object.create(null),v._eventsCount=0):(S.newListener!==void 0&&(v.emit("newListener",w,C.listener?C.listener:C),S=v._events),b=S[w]),b===void 0)b=S[w]=C,++v._eventsCount;else if(typeof b=="function"?b=S[w]=T?[C,b]:[b,C]:T?b.unshift(C):b.push(C),(_=h(v))>0&&b.length>_&&!b.warned){b.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");E.name="MaxListenersExceededWarning",E.emitter=v,E.type=w,E.count=b.length,D=E,console&&console.warn&&console.warn(D)}return v}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(v,w,C){var T={fired:!1,wrapFn:void 0,target:v,type:w,listener:C},_=d.bind(T);return _.listener=C,T.wrapFn=_,_}function y(v,w,C){var T=v._events;if(T===void 0)return[];var _=T[w];return _===void 0?[]:typeof _=="function"?C?[_.listener||_]:[_]:C?function(S){for(var b=new Array(S.length),D=0;D<b.length;++D)b[D]=S[D].listener||S[D];return b}(_):m(_,_.length)}function x(v){var w=this._events;if(w!==void 0){var C=w[v];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}function m(v,w){for(var C=new Array(w),T=0;T<w;++T)C[T]=v[T];return C}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(v){if(typeof v!="number"||v<0||c(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");f=v}}),l.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||c(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(v){for(var w=[],C=1;C<arguments.length;C++)w.push(arguments[C]);var T=v==="error",_=this._events;if(_!==void 0)T=T&&_.error===void 0;else if(!T)return!1;if(T){var S;if(w.length>0&&(S=w[0]),S instanceof Error)throw S;var b=new Error("Unhandled error."+(S?" ("+S.message+")":""));throw b.context=S,b}var D=_[v];if(D===void 0)return!1;if(typeof D=="function")s(D,this,w);else{var E=D.length,R=m(D,E);for(C=0;C<E;++C)s(R[C],this,w)}return!0},l.prototype.addListener=function(v,w){return p(this,v,w,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(v,w){return p(this,v,w,!0)},l.prototype.once=function(v,w){return u(w),this.on(v,g(this,v,w)),this},l.prototype.prependOnceListener=function(v,w){return u(w),this.prependListener(v,g(this,v,w)),this},l.prototype.removeListener=function(v,w){var C,T,_,S,b;if(u(w),(T=this._events)===void 0)return this;if((C=T[v])===void 0)return this;if(C===w||C.listener===w)--this._eventsCount==0?this._events=Object.create(null):(delete T[v],T.removeListener&&this.emit("removeListener",v,C.listener||w));else if(typeof C!="function"){for(_=-1,S=C.length-1;S>=0;S--)if(C[S]===w||C[S].listener===w){b=C[S].listener,_=S;break}if(_<0)return this;_===0?C.shift():function(D,E){for(;E+1<D.length;E++)D[E]=D[E+1];D.pop()}(C,_),C.length===1&&(T[v]=C[0]),T.removeListener!==void 0&&this.emit("removeListener",v,b||w)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(v){var w,C,T;if((C=this._events)===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[v]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete C[v]),this;if(arguments.length===0){var _,S=Object.keys(C);for(T=0;T<S.length;++T)(_=S[T])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(w=C[v])=="function")this.removeListener(v,w);else if(w!==void 0)for(T=w.length-1;T>=0;T--)this.removeListener(v,w[T]);return this},l.prototype.listeners=function(v){return y(this,v,!0)},l.prototype.rawListeners=function(v){return y(this,v,!1)},l.listenerCount=function(v,w){return typeof v.listenerCount=="function"?v.listenerCount(w):x.call(v,w)},l.prototype.listenerCount=x,l.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var a=i(77);r.createCB=function(o){return new a.XMLBuilderCBImpl(o)},r.fragmentCB=function(o){return new a.XMLBuilderCBImpl(o,!0)}}])})}(af)),af.exports}var bU=SU(),ri=Uint8Array,Zs=Uint16Array,z9=Uint32Array,j9=new ri([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$9=new ri([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),EU=new ri([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H9=function(t,e){for(var n=new Zs(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new z9(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return[n,i]},K9=H9(j9,2),q9=K9[0],DU=K9[1];q9[28]=258,DU[258]=28;var OU=H9($9,0),RU=OU[0],rg=new Zs(32768);for(var dn=0;dn<32768;++dn){var Ao=(dn&43690)>>>1|(dn&21845)<<1;Ao=(Ao&52428)>>>2|(Ao&13107)<<2,Ao=(Ao&61680)>>>4|(Ao&3855)<<4,rg[dn]=((Ao&65280)>>>8|(Ao&255)<<8)>>>1}var Ju=function(t,e,n){for(var r=t.length,i=0,a=new Zs(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new Zs(e);for(i=0;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var s;if(n){s=new Zs(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var l=i<<4|t[i],f=e-t[i],u=o[t[i]-1]++<<f,h=u|(1<<f)-1;u<=h;++u)s[rg[u]>>>c]=l}else for(s=new Zs(r),i=0;i<r;++i)t[i]&&(s[i]=rg[o[t[i]-1]++]>>>15-t[i]);return s},jl=new ri(288);for(var dn=0;dn<144;++dn)jl[dn]=8;for(var dn=144;dn<256;++dn)jl[dn]=9;for(var dn=256;dn<280;++dn)jl[dn]=7;for(var dn=280;dn<288;++dn)jl[dn]=8;var X9=new ri(32);for(var dn=0;dn<32;++dn)X9[dn]=5;var MU=Ju(jl,9,1),NU=Ju(X9,5,1),Wp=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Ni=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},zp=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},LU=function(t){return(t+7)/8|0},AU=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new(t.BYTES_PER_ELEMENT==2?Zs:t.BYTES_PER_ELEMENT==4?z9:ri)(n-e);return r.set(t.subarray(e,n)),r},FU=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Pi=function(t,e,n){var r=new Error(e||FU[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,Pi),!n)throw r;return r},l2=function(t,e,n){var r=t.length;if(!r||n&&n.f&&!n.l)return e||new ri(0);var i=!e||n,a=!n||n.i;n||(n={}),e||(e=new ri(r*3));var o=function(be){var Re=e.length;if(be>Re){var Ne=new ri(Math.max(Re*2,be));Ne.set(e),e=Ne}},s=n.f||0,c=n.p||0,l=n.b||0,f=n.l,u=n.d,h=n.m,p=n.n,d=r*8;do{if(!f){s=Ni(t,c,1);var g=Ni(t,c+1,3);if(c+=3,g)if(g==1)f=MU,u=NU,h=9,p=5;else if(g==2){var v=Ni(t,c,31)+257,w=Ni(t,c+10,15)+4,C=v+Ni(t,c+5,31)+1;c+=14;for(var T=new ri(C),_=new ri(19),S=0;S<w;++S)_[EU[S]]=Ni(t,c+S*3,7);c+=w*3;for(var b=Wp(_),D=(1<<b)-1,E=Ju(_,b,1),S=0;S<C;){var R=E[Ni(t,c,D)];c+=R&15;var y=R>>>4;if(y<16)T[S++]=y;else{var F=0,M=0;for(y==16?(M=3+Ni(t,c,3),c+=2,F=T[S-1]):y==17?(M=3+Ni(t,c,7),c+=3):y==18&&(M=11+Ni(t,c,127),c+=7);M--;)T[S++]=F}}var U=T.subarray(0,v),z=T.subarray(v);h=Wp(U),p=Wp(z),f=Ju(U,h,1),u=Ju(z,p,1)}else Pi(1);else{var y=LU(c)+4,x=t[y-4]|t[y-3]<<8,m=y+x;if(m>r){a&&Pi(0);break}i&&o(l+x),e.set(t.subarray(y,m),l),n.b=l+=x,n.p=c=m*8,n.f=s;continue}if(c>d){a&&Pi(0);break}}i&&o(l+131072);for(var Y=(1<<h)-1,W=(1<<p)-1,B=c;;B=c){var F=f[zp(t,c)&Y],j=F>>>4;if(c+=F&15,c>d){a&&Pi(0);break}if(F||Pi(2),j<256)e[l++]=j;else if(j==256){B=c,f=null;break}else{var ie=j-254;if(j>264){var S=j-257,ae=j9[S];ie=Ni(t,c,(1<<ae)-1)+q9[S],c+=ae}var fe=u[zp(t,c)&W],Ee=fe>>>4;fe||Pi(3),c+=fe&15;var z=RU[Ee];if(Ee>3){var ae=$9[Ee];z+=zp(t,c)&(1<<ae)-1,c+=ae}if(c>d){a&&Pi(0);break}i&&o(l+131072);for(var ge=l+ie;l<ge;l+=4)e[l]=e[l-z],e[l+1]=e[l+1-z],e[l+2]=e[l+2-z],e[l+3]=e[l+3-z];l=ge}}n.l=f,n.p=B,n.b=l,n.f=s,f&&(s=1,n.m=h,n.d=u,n.n=p)}while(!s);return l==e.length?e:AU(e,0,l)},IU=new ri(0),PU=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Pi(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=t[10]|(t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},VU=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},kU=function(t){((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&Pi(6,"invalid zlib data"),t[1]&32&&Pi(6,"invalid zlib data: preset dictionaries not supported")};function UU(t,e){return l2(t,e)}function BU(t,e){return l2(t.subarray(PU(t),-8),new ri(VU(t)))}function GU(t,e){return l2((kU(t),t.subarray(2,-4)),e)}function WU(t,e){return t[0]==31&&t[1]==139&&t[2]==8?BU(t):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?UU(t,e):GU(t,e)}var zU=typeof TextDecoder<"u"&&new TextDecoder,jU=0;try{zU.decode(IU,{stream:!0}),jU=1}catch{}const ti=[];ti[45]=62;ti[95]=63;const bc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let t=0;t<bc.length;t++)ti[bc.charCodeAt(t)]=t;function na(t){return ti[t.charCodeAt(0)]!==void 0}function $U(t){const e=t.length,n=[];let r=null;for(let i=0;i<e;i++)na(t[i])?(r||(r={start:i,count:0}),r.count++,r.end=i):t[i]==="="&&r&&(n.push(r),r=null);return r&&n.push(r),n}function HU(t,e,n,r){const{start:i,count:a}=e,o=a%4,s=Math.floor(a/4);let c=i,l=null,f=n;for(let u=0;u<s;u++){for(;!na(t[c]);)c++;for(l=ti[t.charCodeAt(c++)]<<18;!na(t[c]);)c++;for(l|=ti[t.charCodeAt(c++)]<<12;!na(t[c]);)c++;for(l|=ti[t.charCodeAt(c++)]<<6;!na(t[c]);)c++;l|=ti[t.charCodeAt(c++)],r[f++]=l>>16&255,r[f++]=l>>8&255,r[f++]=l&255}switch(o){case 3:for(;!na(t[c]);)c++;for(l=ti[t.charCodeAt(c++)]<<10;!na(t[c]);)c++;for(l|=ti[t.charCodeAt(c++)]<<4;!na(t[c]);)c++;l|=ti[t.charCodeAt(c++)]>>2,r[f++]=l>>8&255,r[f++]=l&255;break;case 2:for(;!na(t[c]);)c++;for(l=ti[t.charCodeAt(c++)]<<2;!na(t[c]);)c++;l|=ti[t.charCodeAt(c++)]>>4,r[f++]=l&255;break;case 1:throw new Error("BASE64: remain 1 should not happen")}return f}function KU(t){const e=$U(t),n=e[e.length-1].end+1,r=(4-n%4)%4,i=(n+r)*3/4-r,a=new ArrayBuffer(i),o=new Uint8Array(a);let s=0;for(let c=0;c<e.length;c++)s+=HU(t,e[c],s,o),s+=(4-e[c].count%4)%4;return a}function oy(t,e,n){const r=(t<<16)+(e<<8)+n;return bc[r>>18]+bc[r>>12&63]+bc[r>>6&63]+bc[r&63]}function qU(t){const e=new Uint8Array(t),n=t.byteLength%3,r=t.byteLength-n,i=Array(r/3);for(let a=0;a<i.length;a++){const o=a*3;i[a]=oy(e[o],e[o+1],e[o+2])}if(n>0){const a=oy(e[r],e[r+1]||0,e[r+2]||0);n===1?i.push(`${a.substr(0,2)}==`):n===2&&i.push(`${a.substr(0,3)}=`)}return i.join("")}var f2={toArrayBuffer:KU,fromArrayBuffer:qU};function XU(t,e){e.classHierarchy.push("vtkStringArray"),t.getComponent=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[n*e.numberOfComponents+r]},t.setComponent=(n,r,i)=>{i!==e.values[n*e.numberOfComponents+r]&&(e.values[n*e.numberOfComponents+r]=i,t.modified())},t.getData=()=>e.values,t.getTuple=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=e.numberOfComponents||1;r.length&&(r.length=i);const a=n*i;for(let o=0;o<i;o++)r[o]=e.values[a+o];return r},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.values.length,t.getNumberOfTuples=()=>e.values.length/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>J9({name:e.name,numberOfComponents:e.numberOfComponents,empty:!0}),t.getName=()=>(e.name||t.setName(`vtkStringArray${t.getMTime()}`),e.name),t.setData=(n,r)=>{e.values=n,e.size=n.length,r&&(e.numberOfComponents=r),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.modified()}}const YU={name:"",numberOfComponents:1,size:0,dataType:"string"};function Y9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,YU,n),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkStringArray object without: size > 0, values");e.values?Array.isArray(e.values)&&(e.values=[...e.values]):e.values=[],e.values&&(e.size=e.values.length),J.obj(t,e),J.set(t,e,["name"]),XU(t,e)}const J9=J.newInstance(Y9,"vtkStringArray");var JU={newInstance:J9,extend:Y9};function ZU(t,e){return[...t.getElementsByTagName(e)]}function sy(t,e){return ZU(t,e)[0]}function QU(t){return bU.create(t)}function eB(t){const e=/^\s*<AppendedData\s+encoding="raw">\s*_/m,n=/\n\s*<\/AppendedData>/m;return xl.extractBinary(t,e,n)}const Xo={Int8:Int8Array,UInt8:Uint8Array,Int16:Int16Array,UInt16:Uint16Array,Int32:Int32Array,UInt32:Uint32Array,Int64:Int32Array,UInt64:Uint32Array,Float32:Float32Array,Float64:Float64Array},wl={Int8:1,UInt8:1,Int16:2,UInt16:2,Int32:4,UInt32:4,Int64:8,UInt64:8,Float32:4,Float64:8};function ig(t){const e=t.length-1;return t.filter((n,r)=>r<e&&r%2===0)}function ag(t,e,n){if(!["UInt64","UInt32"].includes(n))throw new Error(`Cannot handle a header type of ${n}`);let r=Xo[n],i=Xo[e],a=!1;n==="UInt64"&&(r=Xo.UInt32),/^U?Int64$/.test(e)&&(a=!0,i=Xo[e.replace("64","32")]);const{byteOffset:o}=t,s=wl[e],c=wl[n];let l;o%c===0?l=new r(t.buffer,o,1):l=new r(t.buffer.slice(o,o+c));const f=Number(l[0]);let u,h=f/s;a&&(h*=2);const p=o+c;return p%s===0?u=new i(t.buffer,p,h):u=new i(t.buffer.slice(p,p+f)),a&&(u=ig(u)),u}function tB(t,e){if(e==="UInt64"){let l=new Uint32Array(t.buffer,0,6);const f=l[0],u=l[2],h=l[4],p=[8,f,u,h];l=new Uint32Array(t.buffer,3*8,f*2);for(let d=0;d<f;d++)p.push(l[d*2]);return p}let n=new Uint32Array(t.buffer,0,3);const r=4,i=n[0],a=n[1],o=n[2],s=[r,i,a,o];n=new Uint32Array(t.buffer,3*4,i);for(let c=0;c<i;c++)s.push(n[c]);return s}function nB(t,e){const[n]=t;return(t.length-1)*n}function rB(t,e){const n=WU(t);e.uint8.set(n,e.offset),e.offset+=n.length}function h2(t,e){const n=tB(t,e),r=n[1],i=n[2],a=n[3];let o=0;r>0&&(a===0?o=r*i:o=(r-1)*i+a);const s=new ArrayBuffer(o),c={offset:0,uint8:new Uint8Array(s)};let l=nB(n);for(;l<t.length&&t[l]!==120;)l++;for(let f=0;f<r;f++){const u=n[4+f],h=new Uint8Array(t.buffer,l,u);rB(h,c),l+=u}return c.uint8}function Cl(t,e,n,r,i,a){const o=e.getAttribute("type"),s=e.getAttribute("Name"),c=e.getAttribute("format"),l=Number(e.getAttribute("NumberOfComponents")||"1");let f=null;if(c==="ascii"){f=new Xo[o](t*l);let u=0;e.firstChild.nodeValue.split(/[\\t \\n]+/).forEach(h=>{h.trim().length&&(f[u++]=Number(h))})}else if(c==="binary"){const u=new Uint8Array(f2.toArrayBuffer(e.firstChild.nodeValue.trim()));if(n==="vtkZLibDataCompressor"){const h=h2(u,i);f=new Xo[o](h.buffer),/^U?Int64$/.test(o)&&(f=ig(f))}else f=new Xo[o](u.buffer,wl[i]),o.indexOf("Int64")!==-1&&(f=ig(f))}else if(c==="appended"){const u=Number(e.getAttribute("offset"));f=ag(new Uint8Array(a,u),o,i)}else console.error("Format not supported",c);return{name:s,values:f,numberOfComponents:l}}function jp(t){return new TextDecoder().decode(t).split("\0").slice(0,-1)}function iB(t,e,n,r,i){const a=t.getAttribute("Name"),o=t.getAttribute("format"),s=Number(t.getAttribute("NumberOfComponents")||"1"),l=Number(t.getAttribute("NumberOfTuples")||"1")*s,f=[];if(o==="ascii"){const u=t.firstChild.nodeValue.trim().split(/\s+/);let h=0;const p=[];for(;f.length<l;){const d=Number(u[h++]);d===0?(f.push(p.join("")),p.length=0):p.push(String.fromCharCode(d))}}else if(o==="binary"){const u=new Uint8Array(f2.toArrayBuffer(t.firstChild.nodeValue.trim()));if(e==="vtkZLibDataCompressor"){const h=h2(u,r);f.push(...jp(h))}else{const h=ag(u,"UInt8",r);f.push(...jp(h))}}else if(o==="appended"){const u=Number(t.getAttribute("offset")),h=ag(new Uint8Array(i,u),"UInt8",r);f.push(...jp(h))}else J.vtkErrorMacro(`Format not supported: ${o}`);return{name:a,values:f,numberOfComponents:s}}function aB(t,e,n,r,i,a){const o={},s=e.getElementsByTagName("DataArray");for(let d=0;d<s.length;d++){const g=s[d];o[g.getAttribute("Name")]=g}const c=Cl(t,o.offsets,n,r,i,a).values,l=c[c.length-1],f=Cl(l,o.connectivity,n,r,i,a).values,u=new Uint32Array(t+l);let h=0,p=0;return c.forEach(d=>{const g=d-p;u[h++]=g;for(let y=0;y<g;y++)u[h++]=f[p+y];p=d}),u}function oB(t,e,n,r,i,a,o){if(e){const s=["Scalars","Vectors","Normals","Tensors","TCoords"],c={};s.forEach(u=>{const h=e.getAttribute(u);h&&(c[h]=n[`set${u}`])});const l=e.getElementsByTagName("DataArray"),f=l.length;for(let u=0;u<f;u++){const h=l[u],p=ft.newInstance(Cl(t,h,r,i,a,o)),d=p.getName();(c[d]||n.addArray)(p)}}}function sB(t,e,n,r,i){const a=[...t.getElementsByTagName("DataArray")].map(s=>ft.newInstance(Cl(Number(s.getAttribute("NumberOfTuples")),s,e,n,r,i))),o=[...t.getElementsByTagName("Array")].filter(s=>s.getAttribute("type")==="String").map(s=>JU.newInstance(iB(s,e,n,r,i)));return[...a,...o]}function cB(t,e){e.classHierarchy.push("vtkXMLReader"),e.dataAccessHelper||(e.dataAccessHelper=zl.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchBinary(r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.url=r;const a=r.split("/");return a.pop(),e.baseURL=a.join("/"),t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(t.parseAsArrayBuffer)},t.parseAsArrayBuffer=r=>{if(!r)return!1;if(r!==e.rawDataBuffer)t.modified();else return!0;const{text:i,binaryBuffer:a}=eB(r);e.rawDataBuffer=r,e.binaryBuffer=a;const s=QU(i).root(),c=s.node,l=c.getAttribute("type"),f=c.getAttribute("compressor"),u=c.getAttribute("byte_order"),h=c.getAttribute("header_type")||"UInt32";if(f&&f!=="vtkZLibDataCompressor")return console.error("Invalid compressor",f),!1;if(u&&u!=="LittleEndian")return console.error("Only LittleEndian encoding is supported"),!1;if(l!==e.dataType)return console.error("Invalid data type",l,"expecting",e.dataType),!1;if(sy(c,"AppendedData")){const g=sy(c,"AppendedData"),y=g.getAttribute("encoding"),x=s.filter(_=>{const{node:S}=_;return S.nodeType===Node.ELEMENT_NODE&&S.getAttribute("format")==="appended"&&S.hasAttribute("offset")},!1,!0).map(_=>({node:_.node,offset:Number(_.node.getAttribute("offset"))}));x.sort((_,S)=>_.offset-S.offset);let m=e.binaryBuffer;y==="base64"&&(m=g.textContent.trim().substr(1));const v=[];for(let _=0;_<x.length;++_){const S=x[_].offset;let b=0;_===x.length-1?b=m.length||m.byteLength:b=x[_+1].offset,y==="base64"?v.push(new Uint8Array(f2.toArrayBuffer(m.substring(S,b)))):v.push(new Uint8Array(m.slice(S,b)))}if(f==="vtkZLibDataCompressor")for(let _=0;_<v.length;++_){const S=v[_],b=h2(S,h),D=new Uint8Array(b.length+wl[h]);new Xo[h](D.buffer,0,1)[0]=b.length,D.set(b,wl[h]),v[_]=D}const w=v.reduce((_,S)=>_+S.length,0),C=new ArrayBuffer(w),T=new Uint8Array(C);for(let _=0,S=0;_<v.length;++_)x[_].node.setAttribute("offset",S),T.set(v[_],S),S+=v[_].length;if(e.binaryBuffer=C,!e.binaryBuffer)return console.error("Processing appended data format: requires binaryBuffer to parse"),!1}t.parseXML(c,l,f,u,h);const d=c.getElementsByTagName(l)[0].getElementsByTagName("FieldData")[0];if(d){const g=sB(d,f,u,h,e.binaryBuffer);for(let y=0;y<e.output.length;y++){const x=e.output[y].getFieldData();for(let m=0;m<g.length;m++)x.addArray(g[m])}}return!0},t.requestData=(r,i)=>{t.parseAsArrayBuffer(e.rawDataBuffer)}}const uB={};function lB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uB,n),J.obj(t,e),J.get(t,e,["url","baseURL"]),J.setGet(t,e,["dataAccessHelper"]),J.algo(t,e,0,1),cB(t,e)}var Tl={extend:lB,processDataArray:Cl,processFieldData:oB,processCells:aB};function fB(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const c=n.getElementsByTagName(e)[0].getElementsByTagName("DataArray")[0],{values:l,numberOfComponents:f}=Tl.processDataArray(s,c,r,i,a,o);t[`get${e}`]().setData(l,f)}return s}function hB(t,e,n,r,i,a,o){const s=Number(n.getAttribute(`NumberOf${e}`));if(s>0){const c=Tl.processCells(s,n.getElementsByTagName(e)[0],r,i,a,o);t[`get${e}`]().setData(c)}return s}function pB(t,e){e.classHierarchy.push("vtkXMLPolyDataReader"),t.parseXML=(n,r,i,a,o)=>{const c=n.getElementsByTagName(e.dataType)[0].getElementsByTagName("Piece"),l=c.length;for(let f=0;f<l;f++){const u=Kn.newInstance(),h=c[f],p=fB(u,"Points",h,i,a,o,e.binaryBuffer);let d=0;["Verts","Lines","Strips","Polys"].forEach(g=>{d+=hB(u,g,h,i,a,o,e.binaryBuffer)}),Tl.processFieldData(p,h.getElementsByTagName("PointData")[0],u.getPointData(),i,a,o,e.binaryBuffer),Tl.processFieldData(d,h.getElementsByTagName("CellData")[0],u.getCellData(),i,a,o,e.binaryBuffer),e.output[f]=u}}}const dB={dataType:"PolyData"};function Z9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dB,n),Tl.extend(t,e,n),pB(t,e)}const gB=J.newInstance(Z9,"vtkXMLPolyDataReader");var mB={newInstance:gB,extend:Z9};const bt={};function $p(t,e,n,r,i){for(let a=0;a<i;a++)n[r+a]=t[e+a]}function vB(t){bt.splitOn=t,bt.pieces=[],bt.v=[],bt.vt=[],bt.vn=[],bt.f=[[]],bt.size=0}function yB(t){const e=t.split("/").map(a=>Number(a));let n=e[0]-1;n=n<0?n+1+bt.v.length/3:n;let r=e[1]?e[1]-1:n;r=r<0?r+1+bt.vt.length/2:r;let i=e[2]?e[2]-1:n;return i=i<0?i+1+bt.vn.length/3:i,[n,r,i]}function xB(t){if(t[0]==="#")return;const e=t.split(/[ \t]+/);if(e[0]===bt.splitOn)e.shift(),bt.pieces.push(e.join(" ").trim()),bt.f.push([]),bt.size++;else if(e[0]==="v")bt.v.push(Number(e[1])),bt.v.push(Number(e[2])),bt.v.push(Number(e[3]));else if(e[0]==="vt")bt.vt.push(Number(e[1])),bt.vt.push(Number(e[2]));else if(e[0]==="vn")bt.vn.push(Number(e[1])),bt.vn.push(Number(e[2])),bt.vn.push(Number(e[3]));else if(e[0]==="f"){bt.size===0&&bt.size++;const n=bt.f[bt.size-1];e.shift();const r=e.filter(a=>a.length>0&&a!=="\r"),i=r.length;n.push(i);for(let a=0;a<i;a++)n.push(yB(r[a]))}}function wB(t){const e=!!bt.vt.length,n=!!bt.vn.length;if(t.splitMode){t.numberOfOutputs=bt.size;for(let r=0;r<bt.size;r++){const i=bt.f[r],a=i.length,o=bt.v.length/3,s={};let c;if(t.trackDuplicates){const y=[];let x=0;for(let v=0;v<a;){const w=i[v++];for(let C=0;C<w;C++){const[T,_,S]=i[v++],b=`${T}/${_}/${S}`;s[b]===void 0&&(y[T]===void 0?y[T]=[b]:(y[T].push(b),++x),s[b]=T)}}c=new Uint16Array(o+x);let m=0;for(let v=0;v<y.length;++v){const w=y[v]?y[v].length:0;c[v]=w>1?o+m:v;for(let C=1;C<w;++C){const T=o+m++;c[T]=v,s[y[v][C]]=T}}}const l={},f=Kn.newInstance({name:bt.pieces[r]}),u=[],h=[],p=[],d=[];let g=0;for(;g<a;){const y=i[g];d.push(y);for(let x=0;x<y;x++){const[m,v,w]=i[g+x+1],C=`${m}/${v}/${w}`;if(l[C]===void 0){const T=t.trackDuplicates?s[C]:u.length/3;l[C]=T,$p(bt.v,m*3,u,T*3,3),e&&$p(bt.vt,v*2,h,T*2,2),n&&$p(bt.vn,w*3,p,T*3,3)}d.push(l[C])}g+=y+1}if(f.getPoints().setData(Float32Array.from(u),3),t.trackDuplicates){const y=ft.newInstance({name:"Duplicates",values:c});f.getPointData().addArray(y)}if(f.getPolys().setData(Uint32Array.from(d)),e){const y=ft.newInstance({numberOfComponents:2,values:Float32Array.from(h),name:"TextureCoordinates"});f.getPointData().setTCoords(y)}if(n){const y=ft.newInstance({numberOfComponents:3,values:Float32Array.from(p),name:"Normals"});f.getPointData().setNormals(y)}t.output[r]=f}}else{t.numberOfOutputs=1;const r=Kn.newInstance();if(r.getPoints().setData(Float32Array.from(bt.v),3),e&&bt.v.length/3===bt.vt.length/2){const c=ft.newInstance({numberOfComponents:2,values:Float32Array.from(bt.vt),name:"TextureCoordinates"});r.getPointData().setTCoords(c)}if(n&&bt.v.length===bt.vn.length){const c=ft.newInstance({numberOfComponents:3,values:Float32Array.from(bt.vn),name:"Normals"});r.getPointData().setNormals(c)}const i=[],a=bt.f[0],o=a.length;let s=0;for(;s<o;){const c=a[s];i.push(c);for(let l=0;l<c;l++){const[f]=a[s+l+1];i.push(f)}s+=c+1}r.getPolys().setData(Uint32Array.from(i)),t.output[0]=r}}function CB(t,e){const n=[],r=t.getPointData().getArrayByName("Duplicates");if(r==null)return n;const i=r.getData(),a=Math.min(e,i[e]);n.push(a);let o=i[a];if(o!==a)for(;o<i.length&&i[o]===a;)n.push(o++);return n}const TB={getPointDuplicateIds:CB};function _B(t,e){e.classHierarchy.push("vtkOBJReader"),e.dataAccessHelper||(e.dataAccessHelper=zl.get("http"));function n(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchText(t,r,i)}t.setUrl=function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r.indexOf(".obj")===-1&&!i.fullpath)e.baseURL=r,e.url=`${r}/index.obj`;else{e.url=r;const a=r.split("/");a.pop(),e.baseURL=a.join("/")}return t.loadData(i)},t.loadData=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(e.url,r).then(i=>t.isDeleted()?!1:t.parseAsText(i))},t.parseAsText=r=>(r&&(r!==e.parseData&&t.modified(),e.parseData=r,e.numberOfOutputs=0,vB(e.splitMode),r.split(`
`).forEach(xB),wB(e)),!0),t.requestData=(r,i)=>{t.parseAsText(e.parseData)},t.isBusy=()=>!!e.requestCount,t.getNumberOfOutputPorts=()=>e.numberOfOutputs}const SB={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function Q9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SB,n),J.obj(t,e),J.get(t,e,["url","baseURL"]),J.setGet(t,e,["dataAccessHelper","splitMode","trackDuplicates"]),J.algo(t,e,0,1),J.event(t,e,"busy"),_B(t,e)}const bB=J.newInstance(Q9,"vtkOBJReader");var EB={newInstance:bB,extend:Q9,...TB};function DB(t,e){e.classHierarchy.push("vtkPolyDataNormals"),t.vtkPolyDataNormalsExecute=(n,r,i)=>{if(!i)return null;const a=new Float32Array(i.length),o=new Float32Array(3*n);let s=0,c=0;const l=r.length,f=[0,0,0],u=[0,0,0];for(let h=0;h<l;h+=c+1)if(c=r[h],!(c<3)){for(let p=1;p<=3;++p)f[p-1]=3*r[h+p];if(jx.computeNormal(i.slice(f[0],f[0]+3),i.slice(f[1],f[1]+3),i.slice(f[2],f[2]+3),u),o[s++]=u[0],o[s++]=u[1],o[s++]=u[2],e.computePointNormals)for(let p=1;p<=c;++p){let d=3*r[h+p];a[d]+=u[0],a[++d]+=u[1],a[++d]+=u[2]}}if(e.computePointNormals){const h=[0,0,0];for(let p=0;p<i.length;)h[0]=a[p],h[1]=a[p+1],h[2]=a[p+2],mi.normalize(h),a[p++]=h[0],a[p++]=h[1],a[p++]=h[2]}return[o,a]},t.requestData=(n,r)=>{if(!t.getNumberOfInputPorts())return;const a=n[0];if(!a)return;const o=Kn.newInstance();o.setPoints(a.getPoints()),o.setVerts(a.getVerts()),o.setLines(a.getLines()),o.setPolys(a.getPolys()),o.setStrips(a.getStrips()),o.getPointData().passData(a.getPointData()),o.getCellData().passData(a.getCellData()),o.getFieldData().passData(a.getFieldData());const[s,c]=t.vtkPolyDataNormalsExecute(a.getNumberOfPolys(),a.getPolys().getData(),a.getPoints().getData());if(e.computePointNormals){const l=ft.newInstance({numberOfComponents:3,name:"Normals",values:c});o.getPointData().setNormals(l)}if(e.computeCellNormals){const l=ft.newInstance({numberOfComponents:3,name:"Normals",values:s});o.getCellData().setNormals(l)}r[0]=o}}function OB(t){return{computeCellNormals:!1,computePointNormals:!0,...t}}function ew(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OB(n)),J.obj(t,e),J.algo(t,e,1,1),J.setGet(t,e,["computeCellNormals","computePointNormals"]),DB(t,e)}const RB=J.newInstance(ew,"vtkPolyDataNormals");var MB={newInstance:RB,extend:ew};class NB{constructor(e){this._color=[255,255,255],this._actors=[],this.id=e.id,this._color=e.color??this._color,this._format=e.format;const n=new TextDecoder,r=MB.newInstance(),i=a=>{const o=cc.newInstance();o.setMapper(a);const s=pc.newInstance();return s.setColor(this._color[0]/255,this._color[1]/255,this._color[2]/255),o.setProperty(s),o};if(this._format===ai.PLY){const a=ca.newInstance(),o=mU.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}else if(this._format===ai.STL){const a=ca.newInstance(),o=TU.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),r.setInputConnection(o.getOutputPort()),a.setInputConnection(r.getOutputPort()),this._actors.push(i(a))}else if(this._format===ai.OBJ){const a=EB.newInstance({splitMode:e.materialUrl?"usemtl":null});a.parseAsText(n.decode(e.arrayBuffer));const o=a.getNumberOfOutputPorts();for(let s=0;s<o;s++){const c=a.getOutputData(s),l=ca.newInstance();l.setInputData(c),this._actors.push(i(l))}}else if(this._format===ai.VTP){const a=ca.newInstance(),o=mB.newInstance();o.parseAsArrayBuffer(e.arrayBuffer),a.setInputConnection(o.getOutputPort()),this._actors.push(i(a))}this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){let e=0;for(let n=0;n<this._actors.length;n++){const a=this._actors[n].getMapper().getInputData(),o=a.getPoints(),s=a.getPolys(),c=o.getData().length,l=s.getData().length;e+=c*4+l*4}return e}get defaultActor(){return this._actors[0]}get actors(){return this._actors}get color(){return this._color}get format(){return this._format}}var Fi;(function(t){t[t.None=0]="None",t[t.Capture=1]="Capture",t[t.Bubble=2]="Bubble"})(Fi||(Fi={}));class Bh{constructor(e){this._eventListeners=new Map,this._children=new Map,this._target=e}get isEmpty(){return this._eventListeners.size===0&&this._children.size===0}addEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i);let s=this._children.get(o);s||(s=new Bh(this._target),this._children.set(o,s)),e=e.substring(i+1),s.addEventListener(e,n,r)}else this._addEventListener(e,n,r)}removeEventListener(e,n,r){const i=e.indexOf(".");if(i!==-1){const o=e.substring(0,i),s=this._children.get(o);if(!s)return;e=e.substring(i+1),s.removeEventListener(e,n,r),s.isEmpty&&this._children.delete(o)}else this._removeEventListener(e,n,r)}reset(){Array.from(this._children.entries()).forEach(([e,n])=>{if(n.reset(),n.isEmpty)this._children.delete(e);else throw new Error("Child is not empty and cannot be removed")}),this._unregisterAllEvents()}_addEventListener(e,n,r){let i=this._eventListeners.get(e);i||(i=new Map,this._eventListeners.set(e,i));const o=r?.capture??!1?Fi.Capture:Fi.Bubble,s=i.get(n)??Fi.None;if(s&o){console.warn("A listener is already registered for this phase");return}i.set(n,s|o),this._target.addEventListener(e,n,r)}_removeEventListener(e,n,r){const a=r?.capture??!1?Fi.Capture:Fi.Bubble,o=this._eventListeners.get(e);if(!o)return;(n?[n]:Array.from(o.keys())).forEach(c=>{const l=o.get(c)??Fi.None;if(!!!(l&a))return;this._target.removeEventListener(e,c,r);const u=l^a;u===Fi.None?o.delete(c):o.set(c,u)}),o.size||this._eventListeners.delete(e)}_unregisterAllListeners(e,n){Array.from(n.entries()).forEach(([r,i])=>{const a=Fi.Capture;for(let o=a;i;o<<=1){if(!(i&o))continue;const s=o===Fi.Capture;this.removeEventListener(e,r,{capture:s}),i^=o}})}_unregisterAllEvents(){Array.from(this._eventListeners.entries()).forEach(([e,n])=>{this._unregisterAllListeners(e,n)})}}class LB{constructor(){this._targetsEventListeners=new Map}addEventListener(e,n,r,i){let a=this._targetsEventListeners.get(e);a||(a=new Bh(e),this._targetsEventListeners.set(e,a)),a.addEventListener(n,r,i)}removeEventListener(e,n,r,i){const a=this._targetsEventListeners.get(e);a&&(a.removeEventListener(n,r,i),a.isEmpty&&this._targetsEventListeners.delete(e))}reset(){Array.from(this._targetsEventListeners.entries()).forEach(([e,n])=>{n.reset(),this._targetsEventListeners.delete(e)})}}const AB=Object.freeze(Object.defineProperty({__proto__:null,MultiTargetEventListenerManager:LB,TargetEventListeners:Bh},Symbol.toStringTag,{value:"Module"}));function FB(t,e){const n=t.getSize();for(let r=0;r<n;r++){const i=[];t.getNodeValue(r,i),i[1]=i[1]*e,i[2]=i[2]*e,i[3]=i[3]*e,t.setNodeValue(r,i)}}function IB(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}const PB=Symbol("LastRuntimeId"),VB={},kB=4294967295,UB="-";function BB(t,e,n){return GB(t!==null&&typeof t=="object"?t:VB,PB,(typeof n=="number"&&n>0?n:kB)>>>0).join(typeof e=="string"?e:UB)}function GB(t,e,n){let r=t[e];r instanceof Array||(r=[0],Object.defineProperty(t,e,{value:r}));for(let i=!0,a=0;i&&a<r.length;++a){let o=r[a]|0;o<n?(i=!1,o=o+1):(o=0,a+1===r.length&&r.push(0)),r[a]=o}return r}const cy={},WB={add:(t,e)=>{const n=yi(t);cy[n]=e},get:(t,e)=>{if(t==="calibratedPixelSpacing"){const n=yi(e);return cy[n]}}};function zB(t,e,n=1e-5){return Math.abs(t[0]+e[0])<n&&Math.abs(t[1]+e[1])<n&&Math.abs(t[2]+e[2])<n}function jB(t,e){return!(t[0]<0||t[0]>=e[0]||t[1]<0||t[1]>=e[1]||t[2]<0||t[2]>=e[2])}function $B(t,e){let n;e?n=[Ol(e)]:n=is();const r=[];return n.forEach(i=>{const a=t.getActors(),o=i.getVolumeViewports();for(const s of o){const c=s.getActors();if(c.length!==a.length)continue;a.every(({uid:f})=>c.find(u=>f===u.uid))&&r.push(s)}}),r}const tw=t=>t.preScale.scaled&&t.preScale.scalingParameters.suvbw;function nw(t,e,n=void 0,r="_thumbnails",i={displayArea:{imageArea:[1,1]}}){if(!t||!(t instanceof HTMLCanvasElement))throw new Error("canvas element is required");const a=!e.imageId,o=!a&&e,s=a&&e,l=`renderGPUViewport-${o.imageId||s.volumeId}`,f=document.createElement("div"),u=window.devicePixelRatio||1;i.displayArea||(i.displayArea={imageArea:[1,1]});const h=t.width,p=t.height;f.style.width=`${h/u+Jd}px`,f.style.height=`${p/u+Jd}px`,f.style.visibility="hidden",f.style.position="absolute",document.body.appendChild(f);const d=l.split(":").join("-");f.setAttribute("viewport-id-for-remove",d);const g=oi(f),y=Ol(r)||new s2(r);let x=y.getViewport(l);if(!x){const m={viewportId:l,type:a?tn.ORTHOGRAPHIC:tn.STACK,element:f,defaultOptions:{...i,suppressEvents:!0}};y.enableElement(m),x=y.getViewport(l)}return new Promise(m=>{let v=!1,{viewReference:w}=i;const C=T=>{if(v)return;if(w){const M=w;w=null,x.setViewReference(M),x.render();return}t.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,t.width,t.height);const S=x.canvasToWorld([0,0]),b=x.canvasToWorld([g.width/u,0]),D=x.canvasToWorld([0,g.height/u]),E=Bn([0,0,0],x.canvasToWorld([1/u,0]),S),R=Bn([0,0,0],x.canvasToWorld([0,1/u]),S),F=1;v=!0,f.removeEventListener(Je.IMAGE_RENDERED,C),setTimeout(()=>{y.disableElement(l),document.querySelectorAll(`[viewport-id-for-remove="${d}"]`).forEach(U=>{U.remove()})},0),m({origin:S,bottomLeft:D,topRight:b,thicknessMm:F,rightVector:E,downVector:R})};f.addEventListener(Je.IMAGE_RENDERED,C),a?x.setVolumes([s],!1,!0):x.renderImageObject(e),x.resetCamera(),n==="PT"&&!tw(o)&&x.setProperties({voiRange:{lower:o.minPixelValue,upper:o.maxPixelValue}}),x.render()})}function rw(t,e,n,r,i){if(e.volumeId)throw new Error("Unsupported volume rendering for CPU");const o=e,s=M9(t,o,n),c={canvas:t,viewport:s,image:o,renderingTools:{}};c.transform=yl(c);const l=!0;return new Promise((f,u)=>{D9(c,l),f(null)})}function HB(t){const{canvas:e,imageId:n,viewReference:r,requestType:i=St.Thumbnail,priority:a=-5,renderingEngineId:o="_thumbnails",useCPURendering:s=!1,thumbnail:c=!1,imageAspect:l=!1,viewportOptions:f}=t,u=r?.volumeId,h=u&&!n,p=r&&f?{...f,viewReference:r}:f,d=s?rw:nw;return new Promise((g,y)=>{function x(C,T){const{modality:_}=nt("generalSeriesModule",T)||{},S=!h&&C,b=h&&C;S&&(S.isPreScaled=S.isPreScaled||S.preScale?.scaled),c&&(e.height=256,e.width=256),l&&S&&(e.width=S&&e.height*S.width/S.height),e.style.width=`${e.width/devicePixelRatio}px`,e.style.height=`${e.height/devicePixelRatio}px`,b&&s&&y(new Error("CPU rendering of volume not supported")),d(e,C,_,o,p).then(g)}function m(C,T){console.error(C,T),y(C)}function v(C,T,_){return ro(C,_).then(S=>{x.call(this,S,C)},S=>{m.call(this,S,C)})}const w={useRGBA:!!s,requestType:i};if(u){const C=at.getVolume(u);C||y(new Error(`Volume id ${u} not found in cache`));const T=C.imageIds[0];x(C,T)}else Pr.addRequest(v.bind(null,n,null,w),i,{imageId:n},a)})}function og(t){return Array.isArray(t)?t:[t]}const uy={HISTORY_UNDO:"CORNERSTONE_TOOLS_HISTORY_UNDO",HISTORY_REDO:"CORNERSTONE_TOOLS_HISTORY_REDO"};class iw{constructor(e="Tools",n=50){this.position=-1,this.redoAvailable=0,this.undoAvailable=0,this.ring=new Array,this.isRecordingGrouped=!1,this.label=e,this._size=n}get size(){return this._size}set size(e){this.ring=new Array(e),this._size=e,this.position=-1,this.redoAvailable=0,this.undoAvailable=0}undo(e=1){for(;e>0&&this.undoAvailable>0;){const n=this.ring[this.position];for(const r of og(n).reverse())r.restoreMemo(!0),this.dispatchHistoryEvent({item:r,isUndo:!0});e--,this.redoAvailable++,this.undoAvailable--,this.position=(this.position-1+this.size)%this.size}}undoIf(e){return this.undoAvailable>0&&e(this.ring[this.position])?(this.undo(),!0):!1}dispatchHistoryEvent({item:e,isUndo:n}){e.id&&vt.dispatchEvent(new CustomEvent(n?uy.HISTORY_UNDO:uy.HISTORY_REDO,{detail:{isUndo:n,id:e.id,operationType:e.operationType||"annotation",memo:e}}))}redo(e=1){for(;e>0&&this.redoAvailable>0;){const n=(this.position+1)%this.size,r=this.ring[n];for(const i of og(r).reverse())i.restoreMemo(!1),this.dispatchHistoryEvent({item:i,isUndo:!1});e--,this.position=n,this.undoAvailable++,this.redoAvailable--}}initializeGroupItem(){this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=[]}startGroupRecording(){this.isRecordingGrouped=!0,this.initializeGroupItem()}rollbackUnusedGroupItem(){this.ring[this.position]=void 0,this.position=(this.position-1)%this._size,this.undoAvailable--}endGroupRecording(){this.isRecordingGrouped=!1;const e=this.ring[this.position];Array.isArray(e)&&e.length===0&&this.rollbackUnusedGroupItem()}pushGrouped(e){const n=this.ring[this.position];if(Array.isArray(n))return n.push(e),e;throw new Error("Last item should be an array for grouped memos.")}push(e){if(!e)return;const n=e.restoreMemo?e:e.createMemo?.();if(n)return this.isRecordingGrouped?this.pushGrouped(n):(this.redoAvailable=0,this.undoAvailable<this._size&&this.undoAvailable++,this.position=(this.position+1)%this._size,this.ring[this.position]=n,n)}}const KB=new iw,qB=Object.freeze(Object.defineProperty({__proto__:null,DefaultHistoryMemo:KB,HistoryMemo:iw},Symbol.toStringTag,{value:"Module"}));function XB(t,e){const n=nt("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const c=it();zr(c,a,r,-o/2),zr(c,c,i,-s/2);const l=it();Bn(l,e,c);const f=zt(l,i),u=zt(l,r);return[f/s,u/o]}function YB(t,e){const n=nt("imagePlaneModule",t);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${t}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:a}=n;let{columnPixelSpacing:o,rowPixelSpacing:s}=n;o||=1,s||=1;const c=it();return zr(c,a,i,s*(e[0]-.5)),zr(c,c,r,o*(e[1]-.5)),Array.from(c)}function JB(t){const e=is(),n=[];return e.forEach(r=>{r.getViewports().forEach(a=>{a.hasImageURI(t)&&n.push(a)})}),n}function ZB(t,e){const n=QB(t,e);return n?n.index:null}function QB(t,e){const n=e.getImageIds(),r=e.getCurrentImageIdIndex();if(n.length===0)return null;const i=c=>{const l=eG(c);if(!l)return null;const f=o9(l.planeNormal,l.imagePositionPatient);return Z1(f,t)},a={distance:i(n[r])??1/0,index:r},o=n.slice(r+1);for(let c=0;c<o.length;c++){const l=o[c],f=i(l);if(f!==null)if(f<=a.distance)a.distance=f,a.index=c+r+1;else break}const s=n.slice(0,r);for(let c=s.length-1;c>=0;c--){const l=s[c],f=i(l);if(!(f===null||f===a.distance))if(f<a.distance)a.distance=f,a.index=c;else break}return a.distance===1/0?null:a}function eG(t){const e=nt("imagePlaneModule",t);if(!e||!(e.rowCosines instanceof Array&&e.rowCosines.length===3)||!(e.columnCosines instanceof Array&&e.columnCosines.length===3)||!(e.imagePositionPatient instanceof Array&&e.imagePositionPatient.length===3))return null;const{rowCosines:n,columnCosines:r,imagePositionPatient:i}=e,a=$t(it(),...n),o=$t(it(),...r),s=mn(it(),a,o);return{rowCosines:n,columnCosines:r,imagePositionPatient:i,planeNormal:s}}function tG(t){const{width:e,height:n}=t.getCanvas(),{sliceToIndexMatrix:r,indexToSliceMatrix:i}=t.getSliceViewInfo(),a=zo(t,[0,0]),o=zo(t,[e-1,0]),s=zo(t,[0,n-1]),c=Bn(it(),o,a),l=Bn(it(),s,a),f=mn(it(),c,l);gn(c,c),gn(l,l),gn(f,f);const u=Math.max(Math.abs(c[0]),Math.abs(c[1]),Math.abs(c[2])),h=Math.max(Math.abs(l[0]),Math.abs(l[1]),Math.abs(l[2]));if(!Wm(1,u)||!Wm(1,h))throw new Error("Livewire is not available for rotate/oblique viewports");const{voxelManager:p}=t.getImageData(),d=t.getSliceViewInfo(),g=p.getSliceData(d);return{width:d.width,height:d.height,scalarData:g,sliceToIndexMatrix:r,indexToSliceMatrix:i}}const Vs={},Yf={add:(t,e)=>{const[n,r]=t,i=`${n}_${r}`;Vs[i]||(Vs[i]={}),Vs[i]=e},get:(t,e,n)=>{if(t!=="spatialRegistrationModule")return;const r=`${e}_${n}`;if(Vs[r])return Vs[r];const i=`${n}_${e}`;if(Vs[i])return Sn(ma(),Vs[i])}};Fh(Yf.get.bind(Yf));const nG=.05;function rG(t,e){const n=t.getSliceIndex(),r=e.getSliceIndex(),i=nt("imagePlaneModule",n.toString()),a=nt("imagePlaneModule",r.toString());if(!i||!a){console.log("Viewport spatial registration requires image plane module");return}const{imageOrientationPatient:o}=a;if(!i.imageOrientationPatient.every((h,p)=>Math.abs(h-o[p])<nG)){console.log("Viewport spatial registration only supported for same orientation (hence translation only) for now",i?.imageOrientationPatient,a?.imageOrientationPatient);return}const c=i.imagePositionPatient,l=a.imagePositionPatient,f=Ln(it(),c,l),u=Vl(ma(),f);Yf.add([t.id,e.id],u)}function iG(t){const{imageData:e,dimensions:n}=t.getImageData()||{};if(!e||!n)return[];const{canvas:r}=t,i=window.devicePixelRatio,a=[0,0],o=[r.width/i,0],s=[r.width/i,r.height/i],c=[0,r.height/i],l=t.canvasToWorld(a),f=t.canvasToWorld(o),u=t.canvasToWorld(s),h=t.canvasToWorld(c),p=e.worldToIndex(l),d=e.worldToIndex(f),g=e.worldToIndex(u),y=e.worldToIndex(h);return aG({dimensions:n,imageData:e,topLeftImage:p,topRightImage:d,bottomRightImage:g,bottomLeftImage:y,topLeftWorld:l,topRightWorld:f,bottomRightWorld:u,bottomLeftWorld:h})}function aG({dimensions:t,imageData:e,topLeftImage:n,topRightImage:r,bottomRightImage:i,bottomLeftImage:a,topLeftWorld:o,topRightWorld:s,bottomRightWorld:c,bottomLeftWorld:l}){const f=w0(n,t)?o:e.indexToWorld([0,0,0]),u=w0(r,t)?s:e.indexToWorld([t[0]-1,0,0]),h=w0(i,t)?c:e.indexToWorld([t[0]-1,t[1]-1,0]),p=w0(a,t)?l:e.indexToWorld([0,t[1]-1,0]);return[f,u,p,h]}function w0(t,e){return t[0]>0||t[0]<e[0]-1||t[1]>0||t[1]<e[1]-1||t[2]>0||t[2]<e[2]-1}function $l(t){if(!t)return;const{viewportUid:e,renderingEngineUid:n}=t.dataset;return p2(e,n)}function p2(t,e){if(!e||!t)return;const n=Ol(e);if(!n||n.hasBeenDestroyed)return;const r=n.getViewport(t);if(!r)return;const i=r.getFrameOfReferenceUID();return{viewport:r,renderingEngine:n,viewportId:t,renderingEngineId:e,FrameOfReferenceUID:i}}function oG(t){const e=is();for(let n=0;n<e.length;n++){const r=e[n];if(r.getViewport(t))return p2(t,r.id)}}function sG(){const t=[];return is().forEach(n=>{n.getViewports().forEach(({element:i})=>{t.push($l(i))})}),t}function cG(t){const e=$l(t);if(!e)return;const{viewport:n}=e;if(!(n instanceof io))throw new Error(`An image can only be fetched for a stack viewport and not for a viewport of type: ${n.type}`);return n.getCornerstoneImage()}function uG(t){if(t.length<=1)return!1;const e=t[0],{modality:n,seriesInstanceUID:r}=nt("generalSeriesModule",e),{imageOrientationPatient:i,pixelSpacing:a,frameOfReferenceUID:o,columns:s,rows:c,usingDefaultValues:l}=nt("imagePlaneModule",e);if(l)return!1;const f={modality:n,imageOrientationPatient:i,pixelSpacing:a,columns:s,rows:c,seriesInstanceUID:r};let u=!0;for(let h=0;h<t.length;h++){const p=t[h],{modality:d,seriesInstanceUID:g}=nt("generalSeriesModule",p),{imageOrientationPatient:y,pixelSpacing:x,columns:m,rows:v}=nt("imagePlaneModule",p);if(g!==f.seriesInstanceUID){u=!1;break}if(d!==f.modality){u=!1;break}if(m!==f.columns){u=!1;break}if(v!==f.rows){u=!1;break}if(!Un(y,f.imageOrientationPatient)){u=!1;break}if(!Un(x,f.pixelSpacing)){u=!1;break}}return u}const lG=new Set(["1.2.840.10008.1.2.4.100","1.2.840.10008.1.2.4.100.1","1.2.840.10008.1.2.4.101","1.2.840.10008.1.2.4.101.1","1.2.840.10008.1.2.4.102","1.2.840.10008.1.2.4.102.1","1.2.840.10008.1.2.4.103","1.2.840.10008.1.2.4.103.1","1.2.840.10008.1.2.4.104","1.2.840.10008.1.2.4.104.1","1.2.840.10008.1.2.4.105","1.2.840.10008.1.2.4.105.1","1.2.840.10008.1.2.4.106","1.2.840.10008.1.2.4.106.1","1.2.840.10008.1.2.4.107","1.2.840.10008.1.2.4.108"]);function fG(t){return t?(Array.isArray(t)?t:[t]).find(n=>lG.has(n)):!1}async function hG({viewport:t,options:e={}}){const n=t.getRenderingEngine();let r=e.volumeId||`${si()}`;r.split(":").length===0&&(r=`${t9()}:${r}`);const{id:i,element:a}=t,o=e.viewportId||i,s=t.getImageIds(),c=t.getViewPresentation(),l=t.getViewReference();n.enableElement({viewportId:o,type:tn.ORTHOGRAPHIC,element:a,defaultOptions:{background:e.background,orientation:e.orientation}}),(await q1(r,{imageIds:s})).load();const u=n.getViewport(o);await N9(n,[{volumeId:r}],[o]);const h=()=>{u.render(),a.removeEventListener(Je.VOLUME_VIEWPORT_NEW_VOLUME,h)};return(()=>{a.addEventListener(Je.VOLUME_VIEWPORT_NEW_VOLUME,h)})(),u.setViewPresentation(c),u.setViewReference(l),u.render(),u}async function pG({viewport:t,options:e}){const n=t,{id:r,element:i}=n,a=t.getRenderingEngine(),{background:o}=e,s=e.viewportId||r,c=at.getVolume(n.getVolumeId());if(!(c instanceof iu))throw new Error("Currently, you cannot decache a volume that is not an ImageVolume. So, unfortunately, volumes such as nifti  (which are basic Volume, without imageIds) cannot be decached.");const l={viewportId:s,type:tn.STACK,element:i,defaultOptions:{background:o}},f=n.getViewReference();a.enableElement(l);const u=a.getViewport(s);return await u.setStack(c.imageIds),u.setViewReference(f),u.render(),u}function aw(t,e=2){if(Array.isArray(t))return t.map(i=>aw(i,e)).join(", ");if(t==null||t==="")return"NaN";t=Number(t);const n=Math.abs(t);if(n<1e-4)return`${t}`;const r=n>=100?e-2:n>=10?e-1:n>=1?e:n>=.1?e+1:n>=.01?e+2:n>=.001?e+3:e+4;return t.toFixed(r)}function dG(t){return Math.round(t/xi)*xi}function gG(t,e,n){const r=t.length===e*n*4,i=t.length===e*n*3;if(r||i){const a=new Float32Array(e*n);let o=0,s=0;const c=r?4:3;for(let l=0;l<e;l++)for(let f=0;f<n;f++){const u=t[o],h=t[o+1],p=t[o+2];a[s]=(u+h+p)/3,o+=c,s++}return a}else return t}function mG(t){if(t instanceof lc)return at.getVolume(t.getVolumeId()).imageIds;if(t.getImageIds)return t.getImageIds()}function vG(t,e){const n=[...t];return e>=n.length?(ly(n),n):(ly(n),n.slice(0,e))}function ly(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function Hp(t){const e=t.toString(16);return e.length==1?"0"+e:e}function yG(t,e,n){return"#"+Hp(t)+Hp(e)+Hp(n)}function xG(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}const wG=Object.freeze(Object.defineProperty({__proto__:null,hexToRgb:xG,rgbToHex:yG},Symbol.toStringTag,{value:"Module"}));function CG(t,e){if(t===e)return!0;if(t==null||e==null)return!1;try{return JSON.stringify(t)===JSON.stringify(e)}catch(n){return console.debug("Error in JSON.stringify during deep comparison:",n),t===e}}function TG(t,e,n){if(!n)throw new Error("getVolume is required, use the utilities export instead ");if(t.modality)return t.modality;if(t.setVolumes)return e=e??t.getVolumeId(),!e||!n?void 0:n(e).metadata.Modality;throw new Error("Invalid viewport type")}const _G=(t,e)=>t.reduce((n,r)=>((n[r[e]]=n[r[e]]||[]).push(r),n),{});function SG(t){const e=t.map(o=>{const{imagePositionPatient:s}=nt("imagePlaneModule",o)||{};return{imageId:o,imagePositionPatient:s}});if(!e.every(o=>o.imagePositionPatient))return null;const n=_G(e,"imagePositionPatient"),r=Object.keys(n),i=n[r[0]].length;return i===1||!r.every(o=>n[o].length===i)?null:n}function bG(t,e){const n={};let r=[];const i=Object.keys(t);for(let a=0;a<i.length;a++){const o=new Set,s=t[i[a]];for(let c=0;c<s.length;c++){const l=e(s[c].imageId)||0;if(n[l]=n[l]||[],n[l].push({imageId:s[c].imageId}),o.add(l),o.size-1<c)return}if(a==0)r=Array.from(o);else if(!RG(r,o))return}return n}function Tu(t,e){const n=nt(e,t);try{return parseFloat(n)}catch{return}}function EG(t){const e=nt("20011003",t);try{const{InlineBinary:n}=e;if(n){const r=atob(n),i=new ArrayBuffer(r.length),a=new DataView(i);for(let o=0;o<r.length;o++)a.setUint8(o,r.charCodeAt(o));return new Float32Array(i)[0]}return parseFloat(e)}catch{return}}function DG(t){let e=nt("0019100c",t)||nt("0019100C",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n)),parseFloat(e)}catch{return}}function OG(t){let e=nt("00431039",t);try{const{InlineBinary:n}=e;return n&&(e=atob(n).split("//")),parseFloat(e[0])%1e5}catch{return}}function RG(t,e){if(t.length!=e.size)return!1;for(let n=0;n<t.length;n++)if(!e.has(t[n]))return!1;return!0}function MG(t){const e=nt("petImageModule",t);return e?e.frameReferenceTime:0}function d2(t){const e=SG(t);if(!e)return{imageIdGroups:[t],splittingTag:null};const n=["TemporalPositionIdentifier","DiffusionBValue","TriggerTime","EchoTime","EchoNumber","PhilipsPrivateBValue","SiemensPrivateBValue","GEPrivateBValue","PetFrameReferenceTime"],r=[i=>Tu(i,n[0]),i=>Tu(i,n[1]),i=>Tu(i,n[2]),i=>Tu(i,n[3]),i=>Tu(i,n[4]),EG,DG,OG,MG];for(let i=0;i<r.length;i++){const a=bG(e,r[i]);if(a)return{imageIdGroups:Object.keys(a).map(Number.parseFloat).sort((c,l)=>c-l).map(c=>a[c].map(l=>l.imageId)),splittingTag:n[i]}}return{imageIdGroups:[t],splittingTag:null}}function NG(t){const{imageIdGroups:e,splittingTag:n}=d2(t);return{isDynamicVolume:e.length>1,timePoints:e,splittingTag:n}}function LG(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a}=e;if(e.modality==="PT"&&typeof a=="number")for(let o=0;o<n;o++)t[o]=a*(t[o]*r+i);else for(let o=0;o<n;o++)t[o]=t[o]*r+i;return t}function ow(t,e,n){return Math.min(Math.max(e,t),n)}function sw(t,e){if(!$l(t.element))throw new Error("Scroll::Viewport is not enabled (it might be disabled)");if(t instanceof io&&t.getImageIds().length===0)throw new Error("Scroll::Stack Viewport has no images");const{volumeId:r,delta:i,scrollSlabs:a}=e;if(t instanceof lc)AG(t,r,i,a);else{const o=t.getCurrentImageIdIndex();if(o+i>t.getImageIds().length-1||o+i<0){const s={imageIdIndex:o,direction:i};et(vt,Je.STACK_SCROLL_OUT_OF_BOUNDS,s)}t.scroll(i,e.debounceLoading,e.loop)}}function AG(t,e,n,r=!1){const i=r,{numScrollSteps:a,currentStepIndex:o,sliceRangeInfo:s}=Vc(t,e,i);if(!s)return;const{sliceRange:c,spacingInNormalDirection:l,camera:f}=s,{focalPoint:u,viewPlaneNormal:h,position:p}=f,{newFocalPoint:d,newPosition:g}=kc(u,p,c,h,l,n);t.setCamera({focalPoint:d,position:g}),t.render();const y=o+n,x={volumeId:e,viewport:t,delta:n,desiredStepIndex:y,currentStepIndex:o,numScrollSteps:a,currentImageId:t.getCurrentImageId()};(y>a||y<0)&&t.getCurrentImageId()?et(vt,Je.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS,x):et(vt,Je.VOLUME_VIEWPORT_SCROLL,x)}async function FG(t,e={}){const{imageIndex:n,debounceLoading:r,volumeId:i}=e,a=$l(t);if(!a)throw new Error("Element has been disabled");const{viewport:o}=a,{imageIndex:s,numberOfSlices:c}=IG(o,r),f=PG(c,n)-s;sw(o,{delta:f,debounceLoading:r,volumeId:i})}function IG(t,e){return t instanceof io?{numberOfSlices:t.getImageIds().length,imageIndex:e?t.getTargetImageIdIndex():t.getCurrentImageIdIndex()}:{numberOfSlices:t.getNumberOfSlices(),imageIndex:t.getSliceIndex()}}function PG(t,e){const n=t-1;return ow(e,0,n)}function VG(t,e,n={}){const r=at.getVolume(t);if(!r)throw new Error(`Referenced volume with id ${t} does not exist.`);const{metadata:i,spacing:a,direction:o,dimensions:s}=r,{minX:c,maxX:l,minY:f,maxY:u,minZ:h,maxZ:p}=e,d=[Math.min(c,l),Math.min(f,u),Math.min(h,p)],g=Hf(r.imageData,d),y=[Math.abs(l-c)+1,Math.abs(u-f)+1,Math.abs(p-h)+1],{targetBuffer:x}=n,m={metadata:i,dimensions:y,spacing:a,origin:g,direction:o,targetBuffer:x,scalarData:x?.type==="Float32Array"?new Float32Array(y[0]*y[1]*y[2]):void 0},v=X1(si(),m),w=v.voxelManager.getCompleteScalarDataArray(),C=y[0]*y[1],T=s[0]*s[1],_=r.voxelManager.getCompleteScalarDataArray();for(let S=0;S<y[2];S++)for(let b=0;b<y[1];b++){const D=Hf(v.imageData,[0,b,S]),E=Sh(r.imageData,D),R=E[2]*T+E[1]*s[0]+E[0],F=_.slice(R,R+y[0]),M=S*C+b*y[0];w.set(F,M)}return v.voxelManager.setCompleteScalarDataArray(w),v}function kG(t,e){const{viewUp:n,viewPlaneNormal:r}=e,i=X0(t,[0,0,0]),a=Za(it(),n),o=Za(it(),r),s=mn(it(),a,o),c=Bn(it(),X0(t,a),i),l=Bn(it(),X0(t,o),i);gn(c,c),gn(l,l);const f=mn(it(),c,l);return{worldVecRowDir:s,worldVecColDir:a,worldVecSliceDir:o,ijkVecRowDir:f,ijkVecColDir:c,ijkVecSliceDir:l}}function UG(t,e,n,r){const[i,a,o]=e,s=i*a;let c=0,l=0,f=0;const[u,h,p]=n.map(Math.round);for(let x=p-r;x<=p+r;x++)if(!(x<0||x>=o)){for(let m=h-r;m<=h+r;m++)if(!(m<0||m>=a))for(let v=u-r;v<=u+r;v++){if(v<0||v>=i)continue;const w=x*s+m*i+v,C=t[w];c+=C,l+=C*C,f++}}if(f===0){const x=p*s+h*i+u;return x>=0&&x<t.length?{mean:t[x],stdDev:0,count:1}:{mean:0,stdDev:0,count:0}}const d=c/f,g=l/f-d*d,y=Math.sqrt(Math.max(0,g));return{mean:d,stdDev:y,count:f}}const BG=new Set(["1.2.840.10008.5.1.4.1.1.1","1.2.840.10008.5.1.4.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.1.1","1.2.840.10008.5.1.4.1.1.1.2","1.2.840.10008.5.1.4.1.1.1.2.1","1.2.840.10008.5.1.4.1.1.1.3","1.2.840.10008.5.1.4.1.1.1.3.1","1.2.840.10008.5.1.4.1.1.12.1","1.2.840.10008.5.1.4.1.1.12.1.1","1.2.840.10008.5.1.4.1.1.12.2","1.2.840.10008.5.1.4.1.1.12.2.1","1.2.840.10008.5.1.4.1.1.12.3"]);function GG(t){const{PixelSpacing:e,ImagerPixelSpacing:n,EstimatedRadiographicMagnificationFactor:r,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}=t,o=!0;return n?e?Un(e,n)?{PixelSpacing:e,type:oa.PROJECTION,isProjection:o}:i||a?{PixelSpacing:e,type:oa.CALIBRATED,isProjection:o,PixelSpacingCalibrationType:i,PixelSpacingCalibrationDescription:a}:{PixelSpacing:e,type:oa.UNKNOWN,isProjection:o}:r?{PixelSpacing:n.map(c=>c/r),type:oa.ERMF,isProjection:o}:(console.warn("EstimatedRadiographicMagnificationFactor was not present. Unable to correct ImagerPixelSpacing."),{PixelSpacing:n,type:oa.PROJECTION,isProjection:o}):{PixelSpacing:e,type:oa.UNKNOWN,isProjection:o}}function WG(t){const{SequenceOfUltrasoundRegions:e}=t,n=Array.isArray(e);if(n&&e.length>1){console.warn("Sequence of Ultrasound Regions > one entry. This is not yet implemented, all measurements will be shown in pixels.");return}const{PhysicalDeltaX:r,PhysicalDeltaY:i}=n?e[0]:e;return{PixelSpacing:[Math.abs(r)*10,Math.abs(i)*10]}}function zG(t){const{PixelSpacing:e,SOPClassUID:n,SequenceOfUltrasoundRegions:r}=t;return r?WG(t):BG.has(n)?GG(t):{PixelSpacing:e,type:oa.NOT_APPLICABLE,isProjection:!1}}const jG=(t,e)=>TG(t,e,at.getVolume),$G=Object.freeze(Object.defineProperty({__proto__:null,FrameRange:Uc,HistoryMemo:qB,PointsManager:Xa,ProgressiveIterator:Kc,RLEVoxelMap:Go,VoxelManager:rn,actorIsA:Hr,applyPreset:u9,asArray:og,autoLoad:qd,buildMetadata:v9,calculateNeighborhoodStats:UG,calculateSpacingBetweenImageIds:W6,calculateViewportsSpatialRegistration:rG,calibratedPixelSpacingMetadataProvider:WB,clamp:tg,clip:ow,color:wG,colormap:AE,convertStackToVolumeViewport:hG,convertToGrayscale:gG,convertVolumeToStackViewport:pG,createLinearRGBTransferFunction:w9,createSigmoidRGBTransferFunction:g1,createSubVolume:VG,decimate:$6,deepClone:vl,deepEqual:CG,deepMerge:Rl,eventListener:AB,fnv1aHash:F4,generateVolumePropsFromImageIds:Ih,genericMetadataProvider:qo,getBufferConfiguration:k1,getClosestImageId:$f,getClosestStackImageIndexForPoint:ZB,getCurrentVolumeViewportSlice:tG,getDynamicVolumeInfo:NG,getImageDataMetadata:y9,getImageLegacy:cG,getImageSliceDataForVolumeViewport:zf,getMinMax:IB,getPixelSpacingInformation:zG,getRandomSampleFromArray:vG,getRuntimeId:BB,getScalingParameters:z6,getSliceRange:Ph,getSpacingInNormalDirection:Gl,getTargetVolumeAndSpacingInNormalDir:J1,getViewportImageCornersInWorld:iG,getViewportImageIds:mG,getViewportModality:jG,getViewportsWithImageURI:JB,getViewportsWithVolumeId:j6,getVoiFromSigmoidRGBTransferFunction:c9,getVolumeActorCorners:r9,getVolumeDirectionVectors:kG,getVolumeId:i9,getVolumeSliceRangeInfo:s9,getVolumeViewportScrollInfo:Vc,getVolumeViewportsContainingSameVolumes:$B,hasFloatScalingParameters:H1,hasNaNValues:Yd,imageIdToURI:yi,imageRetrieveMetadataProvider:qc,imageToWorldCoords:YB,indexWithinDimensions:jB,invertRgbTransferFunction:Hu,isEqual:Un,isEqualAbs:ME,isEqualNegative:V4,isImageActor:ki,isNumber:k4,isOpposite:zB,isPTPrescaledWithSUV:tw,isValidVolume:uG,isVideoTransferSyntax:fG,jumpToSlice:FG,loadImageToCanvas:HB,logger:QV,makeVolumeMetadata:G6,planar:dV,pointInShapeCallback:W8,renderToCanvasCPU:rw,renderToCanvasGPU:nw,roundNumber:aw,roundToPrecision:dG,scaleArray:LG,scaleRgbTransferFunction:FB,scroll:sw,snapFocalPointToSlice:kc,sortImageIdsAndGetSpacing:$1,spatialRegistrationMetadataProvider:Yf,splitImageIdsBy4DTags:d2,transferFunctionUtils:IE,transformIndexToWorld:Hf,transformWorldToIndex:Sh,transformWorldToIndexContinuous:X0,triggerEvent:et,updateVTKImageDataWithCornerstoneImage:C9,uuidv4:si,windowLevel:FE,worldToImageCoords:XB},Symbol.toStringTag,{value:"Module"}));class cw extends K6{constructor(e,n){super(e,n),this._dimensionGroupNumber=1,this._loadedDimensionGroups=new Set,this._getImageIdRequests=(a,o)=>this.getImageIdsRequests(a,o),this.getImageLoadRequests=a=>{const o=this.getImageIdsToLoad();return this._getImageIdRequests(o,a)};const{imageIdGroups:r,splittingTag:i}=e;this._splittingTag=i,this._imageIdGroups=r,this.numDimensionGroups=this._imageIdGroups.length,this.numTimePoints=this.numDimensionGroups}_getImageIdsToLoad(){const e=this._imageIdGroups,n=this._dimensionGroupNumber-1,r=[...e[n]];let i=n-1,a=n+1;for(;i>=0||a<e.length;)i>=0&&r.push(...e[i--]),a<e.length&&r.push(...e[a++]);return r}getImageIdsToLoad(){return this._getImageIdsToLoad()}get dimensionGroupNumber(){return this._dimensionGroupNumber}set timePointIndex(e){console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.dimensionGroupNumber=e+1}set dimensionGroupNumber(e){this._dimensionGroupNumber!==e&&(this._dimensionGroupNumber=e,this.voxelManager.setDimensionGroupNumber(e),this.invalidateVolume(!0),et(vt,Je.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED,{volumeId:this.volumeId,dimensionGroupNumber:e,numDimensionGroups:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}),et(vt,Je.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED,{volumeId:this.volumeId,timePointIndex:e-1,numTimePoints:this.numDimensionGroups,imageIdGroupIndex:e-1,numImageIdGroups:this.numDimensionGroups,splittingTag:this.splittingTag}))}get timePointIndex(){return console.warn("Warning: timePointIndex is deprecated. Please use dimensionGroupNumber instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this._dimensionGroupNumber-1}scroll(e){const n=this._dimensionGroupNumber+e;n<1?this.dimensionGroupNumber=this.numDimensionGroups:n>this.numDimensionGroups?this.dimensionGroupNumber=1:this.dimensionGroupNumber=n}getCurrentDimensionGroupImageIds(){return this._imageIdGroups[this._dimensionGroupNumber-1]}getCurrentTimePointImageIds(){return console.warn("Warning: getCurrentTimePointImageIds is deprecated. Please use getCurrentDimensionGroupImageIds instead."),this.getCurrentDimensionGroupImageIds()}flatImageIdIndexToTimePointIndex(e){return console.warn("Warning: flatImageIdIndexToTimePointIndex is deprecated. Please use flatImageIdIndexToDimensionGroupNumber instead."),this.flatImageIdIndexToDimensionGroupNumber(e)-1}flatImageIdIndexToDimensionGroupNumber(e){return Math.floor(e/this._imageIdGroups[0].length)+1}flatImageIdIndexToImageIdIndex(e){return e%this._imageIdGroups[0].length}get splittingTag(){return this._splittingTag}isTimePointLoaded(e){return console.warn("Warning: isTimePointLoaded is deprecated. Please use isDimensionGroupLoaded instead. Note that timePointIndex is zero-based while dimensionGroupNumber starts at 1."),this.isDimensionGroupLoaded(e+1)}isDimensionGroupLoaded(e){return this._loadedDimensionGroups.has(e)}markDimensionGroupAsLoaded(e){this._loadedDimensionGroups.add(e),et(vt,Je.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED,{volumeId:this.volumeId,dimensionGroupNumber:e}),et(vt,Je.DYNAMIC_VOLUME_TIME_POINT_LOADED,{volumeId:this.volumeId,timePointIndex:e-1})}checkTimePointCompletion(e){console.warn("Warning: checkTimePointCompletion is deprecated. Please use checkDimensionGroupCompletion instead."),this.checkDimensionGroupCompletion(e)}checkDimensionGroupCompletion(e){const n=this.flatImageIdIndexToDimensionGroupNumber(e);this._imageIdGroups[n-1].every(a=>{const o=this.getImageIdIndex(a);return this.cachedFrames[o]===jr.FULL_RESOLUTION})&&!this.isDimensionGroupLoaded(n)&&this.markDimensionGroupAsLoaded(n)}}const Hl=new Ig("imageRetrievalPool");Hl.setMaxSimultaneousRequests(St.Interaction,200);Hl.setMaxSimultaneousRequests(St.Thumbnail,200);Hl.setMaxSimultaneousRequests(St.Prefetch,200);Hl.grabDelay=0;const fy=Symbol("DefaultSettings"),hy=Symbol("RuntimeSettings"),py=Symbol("ObjectSettingsMap"),ka=Symbol("Dictionary");class yn{constructor(e){const n=Object.create(e instanceof yn&&ka in e?e[ka]:null);Object.seal(Object.defineProperty(this,ka,{value:n}))}set(e,n){return Jf(this[ka],e,n,null)}get(e){return qG(this[ka],e)}unset(e){return HG(this[ka],e+"")}forEach(e){dy(this[ka],e)}extend(){return new yn(this)}import(e){uw(e)&&Object.keys(e).forEach(n=>{Jf(this[ka],n,e[n],null)})}dump(){const e={};return dy(this[ka],(n,r)=>{typeof r<"u"&&lw(e,n,r)}),e}static assert(e){return e instanceof yn?e:yn.getRuntimeSettings()}static getDefaultSettings(e=null){let n=yn[fy];if(n instanceof yn||(n=new yn,yn[fy]=n),e){const r={};return n.forEach(i=>{if(i.startsWith(e)){const a=i.split(`${e}.`)[1];r[a]=n.get(i)}}),r}return n}static getRuntimeSettings(){let e=yn[hy];return e instanceof yn||(e=new yn(yn.getDefaultSettings()),yn[hy]=e),e}static getObjectSettings(e,n){let r=null;if(e instanceof yn)r=e;else if(typeof e=="object"&&e!==null){let i=yn[py];i instanceof WeakMap||(i=new WeakMap,yn[py]=i),r=i.get(e),r instanceof yn||(r=new yn(yn.assert(yn.getObjectSettings(n))),i.set(e,r))}return r}static extendRuntimeSettings(){return yn.getRuntimeSettings().extend()}}function HG(t,e){if(e.endsWith(".")){let n=0;const r=e,i=r.slice(0,-1),a=i.length===0;for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a||o.startsWith(r)||o===i)&&(delete t[o],++n);return n>0}return delete t[e]}function dy(t,e){for(const n in t)e(n,t[n])}function KG(t,e,n,r){let i;if(r.has(n))return Jf(t,e,null,r);r.add(n),i=0;for(const a in n)if(Object.prototype.hasOwnProperty.call(n,a)){const o=a.length===0?e:`${e}.${a}`;Jf(t,o,n[a],r)||++i}return r.delete(n),i===0}function Jf(t,e,n,r){return XG(e)?uw(n)?KG(t,e,n,r instanceof WeakSet?r:new WeakSet):(t[e]=n,!0):!1}function qG(t,e){return t[e]}function XG(t){let e,n,r;if(typeof t!="string"||(e=t.length-1)<0)return!1;for(r=-1;(n=t.indexOf(".",r+1))>=0;){if(n-r<2||n===e)return!1;r=n}return!0}function uw(t){if(typeof t=="object"&&t!==null){const e=Object.getPrototypeOf(t);if(e===Object.prototype||e===null)return!0}return!1}function lw(t,e,n){const r=e.indexOf(".");if(r>=0){const i=e.slice(0,r);let a=t[i];if(typeof a!="object"||a===null){const o=a;a={},typeof o<"u"&&(a[""]=o),t[i]=a}lw(a,e.slice(r+1,e.length),n)}else t[e]=n}yn.getDefaultSettings().set("useCursors",!0);function of(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function YG(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fw(t){let e,n,r;t.length!==2?(e=of,n=(s,c)=>of(t(s),c),r=(s,c)=>t(s)-c):(e=t===of||t===YG?t:JG,n=t,r=t);function i(s,c,l=0,f=s.length){if(l<f){if(e(c,c)!==0)return f;do{const u=l+f>>>1;n(s[u],c)<0?l=u+1:f=u}while(l<f)}return l}function a(s,c,l=0,f=s.length){if(l<f){if(e(c,c)!==0)return f;do{const u=l+f>>>1;n(s[u],c)<=0?l=u+1:f=u}while(l<f)}return l}function o(s,c,l=0,f=s.length){const u=i(s,c,l,f-1);return u>l&&r(s[u-1],c)>-r(s[u],c)?u-1:u}return{left:i,center:o,right:a}}function JG(){return 0}function ZG(t){return t===null?NaN:+t}const QG=fw(of),eW=QG.right;fw(ZG).center;const tW=Math.sqrt(50),nW=Math.sqrt(10),rW=Math.sqrt(2);function Zf(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=tW?10:a>=nW?5:a>=rW?2:1;let s,c,l;return i<0?(l=Math.pow(10,-i)/o,s=Math.round(t*l),c=Math.round(e*l),s/l<t&&++s,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*o,s=Math.round(t/l),c=Math.round(e/l),s*l<t&&++s,c*l>e&&--c),c<s&&.5<=n&&n<2?Zf(t,e,n*2):[s,c,l]}function iW(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?Zf(e,t,n):Zf(t,e,n);if(!(a>=i))return[];const s=a-i+1,c=new Array(s);if(r)if(o<0)for(let l=0;l<s;++l)c[l]=(a-l)/-o;else for(let l=0;l<s;++l)c[l]=(a-l)*o;else if(o<0)for(let l=0;l<s;++l)c[l]=(i+l)/-o;else for(let l=0;l<s;++l)c[l]=(i+l)*o;return c}function sg(t,e,n){return e=+e,t=+t,n=+n,Zf(t,e,n)[2]}function aW(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?sg(e,t,n):sg(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function oW(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function g2(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function hw(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Kl(){}var _l=.7,Qf=1/_l,Bc="\\s*([+-]?\\d+)\\s*",Sl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ha="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",sW=/^#([0-9a-f]{3,8})$/,cW=new RegExp(`^rgb\\(${Bc},${Bc},${Bc}\\)$`),uW=new RegExp(`^rgb\\(${ha},${ha},${ha}\\)$`),lW=new RegExp(`^rgba\\(${Bc},${Bc},${Bc},${Sl}\\)$`),fW=new RegExp(`^rgba\\(${ha},${ha},${ha},${Sl}\\)$`),hW=new RegExp(`^hsl\\(${Sl},${ha},${ha}\\)$`),pW=new RegExp(`^hsla\\(${Sl},${ha},${ha},${Sl}\\)$`),gy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};g2(Kl,bl,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:my,formatHex:my,formatHex8:dW,formatHsl:gW,formatRgb:vy,toString:vy});function my(){return this.rgb().formatHex()}function dW(){return this.rgb().formatHex8()}function gW(){return pw(this).formatHsl()}function vy(){return this.rgb().formatRgb()}function bl(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=sW.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?yy(e):n===3?new $r(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?C0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?C0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=cW.exec(t))?new $r(e[1],e[2],e[3],1):(e=uW.exec(t))?new $r(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=lW.exec(t))?C0(e[1],e[2],e[3],e[4]):(e=fW.exec(t))?C0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=hW.exec(t))?Cy(e[1],e[2]/100,e[3]/100,1):(e=pW.exec(t))?Cy(e[1],e[2]/100,e[3]/100,e[4]):gy.hasOwnProperty(t)?yy(gy[t]):t==="transparent"?new $r(NaN,NaN,NaN,0):null}function yy(t){return new $r(t>>16&255,t>>8&255,t&255,1)}function C0(t,e,n,r){return r<=0&&(t=e=n=NaN),new $r(t,e,n,r)}function mW(t){return t instanceof Kl||(t=bl(t)),t?(t=t.rgb(),new $r(t.r,t.g,t.b,t.opacity)):new $r}function cg(t,e,n,r){return arguments.length===1?mW(t):new $r(t,e,n,r??1)}function $r(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}g2($r,cg,hw(Kl,{brighter(t){return t=t==null?Qf:Math.pow(Qf,t),new $r(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_l:Math.pow(_l,t),new $r(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new $r(nc(this.r),nc(this.g),nc(this.b),eh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xy,formatHex:xy,formatHex8:vW,formatRgb:wy,toString:wy}));function xy(){return`#${Qs(this.r)}${Qs(this.g)}${Qs(this.b)}`}function vW(){return`#${Qs(this.r)}${Qs(this.g)}${Qs(this.b)}${Qs((isNaN(this.opacity)?1:this.opacity)*255)}`}function wy(){const t=eh(this.opacity);return`${t===1?"rgb(":"rgba("}${nc(this.r)}, ${nc(this.g)}, ${nc(this.b)}${t===1?")":`, ${t})`}`}function eh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function nc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qs(t){return t=nc(t),(t<16?"0":"")+t.toString(16)}function Cy(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ui(t,e,n,r)}function pw(t){if(t instanceof Ui)return new Ui(t.h,t.s,t.l,t.opacity);if(t instanceof Kl||(t=bl(t)),!t)return new Ui;if(t instanceof Ui)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Ui(o,s,c,t.opacity)}function yW(t,e,n,r){return arguments.length===1?pw(t):new Ui(t,e,n,r??1)}function Ui(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}g2(Ui,yW,hw(Kl,{brighter(t){return t=t==null?Qf:Math.pow(Qf,t),new Ui(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_l:Math.pow(_l,t),new Ui(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new $r(Kp(t>=240?t-240:t+120,i,r),Kp(t,i,r),Kp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ui(Ty(this.h),T0(this.s),T0(this.l),eh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=eh(this.opacity);return`${t===1?"hsl(":"hsla("}${Ty(this.h)}, ${T0(this.s)*100}%, ${T0(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ty(t){return t=(t||0)%360,t<0?t+360:t}function T0(t){return Math.max(0,Math.min(1,t||0))}function Kp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const m2=t=>()=>t;function xW(t,e){return function(n){return t+n*e}}function wW(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function CW(t){return(t=+t)==1?dw:function(e,n){return n-e?wW(e,n,t):m2(isNaN(e)?n:e)}}function dw(t,e){var n=e-t;return n?xW(t,n):m2(isNaN(t)?e:t)}const _y=function t(e){var n=CW(e);function r(i,a){var o=n((i=cg(i)).r,(a=cg(a)).r),s=n(i.g,a.g),c=n(i.b,a.b),l=dw(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=c(f),i.opacity=l(f),i+""}}return r.gamma=t,r}(1);function TW(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function _W(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function SW(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=v2(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function bW(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function th(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function EW(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=v2(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var ug=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qp=new RegExp(ug.source,"g");function DW(t){return function(){return t}}function OW(t){return function(e){return t(e)+""}}function RW(t,e){var n=ug.lastIndex=qp.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(t=t+"",e=e+"";(r=ug.exec(t))&&(i=qp.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:th(r,i)})),n=qp.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?OW(c[0].x):DW(e):(e=c.length,function(l){for(var f=0,u;f<e;++f)s[(u=c[f]).i]=u.x(l);return s.join("")})}function v2(t,e){var n=typeof e,r;return e==null||n==="boolean"?m2(e):(n==="number"?th:n==="string"?(r=bl(e))?(e=r,_y):RW:e instanceof bl?_y:e instanceof Date?bW:_W(e)?TW:Array.isArray(e)?SW:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?EW:th)(t,e)}function MW(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function NW(t){return function(){return t}}function LW(t){return+t}var Sy=[0,1];function Ec(t){return t}function lg(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:NW(isNaN(e)?NaN:.5)}function AW(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function FW(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=lg(i,r),a=n(o,a)):(r=lg(r,i),a=n(a,o)),function(s){return a(r(s))}}function IW(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=lg(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var c=eW(t,s,1,r)-1;return a[c](i[c](s))}}function PW(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function VW(){var t=Sy,e=Sy,n=v2,r,i,a,o=Ec,s,c,l;function f(){var h=Math.min(t.length,e.length);return o!==Ec&&(o=AW(t[0],t[h-1])),s=h>2?IW:FW,c=l=null,u}function u(h){return h==null||isNaN(h=+h)?a:(c||(c=s(t.map(r),e,n)))(r(o(h)))}return u.invert=function(h){return o(i((l||(l=s(e,t.map(r),th)))(h)))},u.domain=function(h){return arguments.length?(t=Array.from(h,LW),f()):t.slice()},u.range=function(h){return arguments.length?(e=Array.from(h),f()):e.slice()},u.rangeRound=function(h){return e=Array.from(h),n=MW,f()},u.clamp=function(h){return arguments.length?(o=h?!0:Ec,f()):o!==Ec},u.interpolate=function(h){return arguments.length?(n=h,f()):n},u.unknown=function(h){return arguments.length?(a=h,u):a},function(h,p){return r=h,i=p,f()}}function kW(){return VW()(Ec,Ec)}function UW(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function nh(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Yc(t){return t=nh(Math.abs(t)),t?t[1]:NaN}function BW(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function GW(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var WW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rh(t){if(!(e=WW.exec(t)))throw new Error("invalid format: "+t);var e;return new y2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}rh.prototype=y2.prototype;function y2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}y2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zW(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var gw;function jW(t,e){var n=nh(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(gw=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+nh(t,Math.max(0,e+a-1))[0]}function by(t,e){var n=nh(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Ey={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:UW,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>by(t*100,e),r:by,s:jW,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Dy(t){return t}var Oy=Array.prototype.map,Ry=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function $W(t){var e=t.grouping===void 0||t.thousands===void 0?Dy:BW(Oy.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Dy:GW(Oy.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(u){u=rh(u);var h=u.fill,p=u.align,d=u.sign,g=u.symbol,y=u.zero,x=u.width,m=u.comma,v=u.precision,w=u.trim,C=u.type;C==="n"?(m=!0,C="g"):Ey[C]||(v===void 0&&(v=12),w=!0,C="g"),(y||h==="0"&&p==="=")&&(y=!0,h="0",p="=");var T=g==="$"?n:g==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",_=g==="$"?r:/[%p]/.test(C)?o:"",S=Ey[C],b=/[defgprs%]/.test(C);v=v===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function D(E){var R=T,F=_,M,U,z;if(C==="c")F=S(E)+F,E="";else{E=+E;var Y=E<0||1/E<0;if(E=isNaN(E)?c:S(Math.abs(E),v),w&&(E=zW(E)),Y&&+E==0&&d!=="+"&&(Y=!1),R=(Y?d==="("?d:s:d==="-"||d==="("?"":d)+R,F=(C==="s"?Ry[8+gw/3]:"")+F+(Y&&d==="("?")":""),b){for(M=-1,U=E.length;++M<U;)if(z=E.charCodeAt(M),48>z||z>57){F=(z===46?i+E.slice(M+1):E.slice(M))+F,E=E.slice(0,M);break}}}m&&!y&&(E=e(E,1/0));var W=R.length+E.length+F.length,B=W<x?new Array(x-W+1).join(h):"";switch(m&&y&&(E=e(B+E,B.length?x-F.length:1/0),B=""),p){case"<":E=R+E+F+B;break;case"=":E=R+B+E+F;break;case"^":E=B.slice(0,W=B.length>>1)+R+E+F+B.slice(W);break;default:E=B+R+E+F;break}return a(E)}return D.toString=function(){return u+""},D}function f(u,h){var p=l((u=rh(u),u.type="f",u)),d=Math.max(-8,Math.min(8,Math.floor(Yc(h)/3)))*3,g=Math.pow(10,-d),y=Ry[8+d/3];return function(x){return p(g*x)+y}}return{format:l,formatPrefix:f}}var _0,mw,vw;HW({thousands:",",grouping:[3],currency:["$",""]});function HW(t){return _0=$W(t),mw=_0.format,vw=_0.formatPrefix,_0}function KW(t){return Math.max(0,-Yc(Math.abs(t)))}function qW(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yc(e)/3)))*3-Yc(Math.abs(t)))}function XW(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Yc(e)-Yc(t))+1}function YW(t,e,n,r){var i=aW(t,e,n),a;switch(r=rh(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=qW(i,o))&&(r.precision=a),vw(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=XW(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=KW(i))&&(r.precision=a-(r.type==="%")*2);break}}return mw(r)}function JW(t){var e=t.domain;return t.ticks=function(n){var r=e();return iW(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return YW(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],c,l,f=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);f-- >0;){if(l=sg(o,s,n),l===c)return r[i]=o,r[a]=s,e(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;c=l}return t},t}function x2(){var t=kW();return t.copy=function(){return PW(t,x2())},oW.apply(t,arguments),JW(t)}function ZW(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=()=>{e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=n=>{e.jsImageData!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=n,e.imageLoaded=!0,t.modified())},t.setCanvas=n=>{e.canvas!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=n,t.modified())},t.setImage=n=>{e.image!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=n,e.imageLoaded=!1,n.complete?t.imageLoaded():n.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=()=>{let n=0,r=0,i=1;if(t.getInputData()){const o=t.getInputData();n=o.getDimensions()[0],r=o.getDimensions()[1],i=o.getDimensions()[2]}return e.jsImageData&&(n=e.jsImageData.width,r=e.jsImageData.height),e.canvas&&(n=e.canvas.width,r=e.canvas.height),e.image&&(n=e.image.width,r=e.image.height),(n>1)+(r>1)+(i>1)},t.getInputAsJsImageData=()=>{if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas)return e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height);if(e.image){const n=document.createElement("canvas");n.width=e.image.width,n.height=e.image.height;const r=n.getContext("2d");return r.translate(0,n.height),r.scale(1,-1),r.drawImage(e.image,0,0,e.image.width,e.image.height),r.getImageData(0,0,n.width,n.height)}return null}}const QW=(t,e,n,r)=>{const i=[1,2,1],a=4,o=i,s=a,c=t.length/(e*n);let l=e,f=n,u=t;const h=[u];for(let p=0;p<r;p++){const d=[...u];l/=2,f/=2,u=new Uint8ClampedArray(l*f*c);const g=c*l;let y=0;for(let m=0;m<u.length;m+=c){m%g===0&&(y+=2*c*l);for(let v=0;v<c;v++){let w=d[y+v];w+=d[y+c+v],w+=d[y-2*g+v],w+=d[y-2*g+c+v],w/=4,u[m+v]=w}y+=2*c}let x=[...u];for(let m=0;m<u.length;m+=c)for(let v=0;v<c;v++){let w=-(o.length-1)/2,C=s,T=0;for(let _=0;_<o.length;_++){let S=m+v+w*c;const b=S%g-(m+v)%g;b>c&&(S+=g),b<-c&&(S-=g),x[S]?T+=x[S]*o[_]:C-=o[_],w+=1}u[m+v]=T/C}x=[...u];for(let m=0;m<u.length;m+=c)for(let v=0;v<c;v++){let w=-(o.length-1)/2,C=s,T=0;for(let _=0;_<o.length;_++){const S=m+v+w*g;x[S]?T+=x[S]*o[_]:C-=o[_],w+=1}u[m+v]=T/C}h.push(u)}return h},ez={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function yw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ez,n),J.obj(t,e),J.algo(t,e,6,0),J.get(t,e,["canvas","image","jsImageData","imageLoaded","resizable"]),J.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),ZW(t,e)}const tz=J.newInstance(yw,"vtkTexture"),nz={generateMipmaps:QW};var cu={newInstance:tz,extend:yw,...nz};const rz=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],My=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],S0=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],Ny=[0,1,0,1,0,1,0,1,2,2,2,2],vn=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],_t=new Float64Array(3),b0=new Float64Array(3),Xt=new Float64Array(3),Xs=new Float64Array(3),ks=new Float64Array(3),E0=new Float64Array(3),Xp=new Float64Array(16);function Yp(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function xw(t){const e=[],n=[];for(let r=0;r<3;r++){const i=x2().domain([t[r*2],t[r*2+1]]);e[r]=i.ticks(5);const a=i.tickFormat(5);n[r]=e[r].map(a)}return{ticks:e,tickStrings:n}}function iz(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=n=>{e.renderable!==n&&(e.renderable=n,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(n.getProperty()),e.tmActor.setParentProp(n),t.modified())},t.createPolyDataForOneLabel=(n,r,i,a,o,s,c)=>{const l=e.renderable.get_tmAtlas().get(n);if(!l)return;const f=e.renderable.getTextPolyData().getPoints().getData(),u=e.lastSize;_t[0]=f[r*3],_t[1]=f[r*3+1],_t[2]=f[r*3+2],Dt(Xt,_t,i),Xt[0]+=.1,Dt(b0,Xt,a),Ln(ks,b0,_t),Xt[0]-=.1,Xt[1]+=.1,Dt(b0,Xt,a),Ln(E0,b0,_t);for(let d=0;d<3;d++)ks[d]/=.5*.1*u[0],E0[d]/=.5*.1*u[1];let h=c.ptIdx,p=c.cellIdx;_t[0]=f[r*3],_t[1]=f[r*3+1],_t[2]=f[r*3+2],o[0]<-.5?lr(Xt,ks,o[0]*s-l.width):o[0]>.5?lr(Xt,ks,o[0]*s):lr(Xt,ks,o[0]*s-l.width/2),vi(_t,_t,Xt),lr(Xt,E0,o[1]*s-l.height/2),vi(_t,_t,Xt),c.points[h*3]=_t[0],c.points[h*3+1]=_t[1],c.points[h*3+2]=_t[2],c.tcoords[h*2]=l.tcoords[0],c.tcoords[h*2+1]=l.tcoords[1],h++,lr(Xt,ks,l.width),vi(_t,_t,Xt),c.points[h*3]=_t[0],c.points[h*3+1]=_t[1],c.points[h*3+2]=_t[2],c.tcoords[h*2]=l.tcoords[2],c.tcoords[h*2+1]=l.tcoords[3],h++,lr(Xt,E0,l.height),vi(_t,_t,Xt),c.points[h*3]=_t[0],c.points[h*3+1]=_t[1],c.points[h*3+2]=_t[2],c.tcoords[h*2]=l.tcoords[4],c.tcoords[h*2+1]=l.tcoords[5],h++,lr(Xt,ks,l.width),Ln(_t,_t,Xt),c.points[h*3]=_t[0],c.points[h*3+1]=_t[1],c.points[h*3+2]=_t[2],c.tcoords[h*2]=l.tcoords[6],c.tcoords[h*2+1]=l.tcoords[7],h++,c.polys[p*4]=3,c.polys[p*4+1]=h-4,c.polys[p*4+2]=h-3,c.polys[p*4+3]=h-2,p++,c.polys[p*4]=3,c.polys[p*4+1]=h-4,c.polys[p*4+2]=h-2,c.polys[p*4+3]=h-1,c.ptIdx+=4,c.cellIdx+=2},t.updateTexturePolyData=()=>{const n=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);Rt(n,n);const r=e.renderable.getTextValues().length,i=r*4,a=r*2,o=new Float64Array(i*3),s=new Uint16Array(a*4),c=new Float32Array(i*2);Sn(Xp,n);const l={ptIdx:0,cellIdx:0,polys:s,points:o,tcoords:c};let f=0,u=0,h=0;const p=e.renderable.getTextPolyData().getPoints().getData(),d=e.renderable.getTextValues();for(;f<p.length/3;){_t[0]=p[f*3],_t[1]=p[f*3+1],_t[2]=p[f*3+2],Dt(Xt,_t,n),_t[0]=p[f*3+3],_t[1]=p[f*3+4],_t[2]=p[f*3+5],Dt(Xs,_t,n),Ln(Xt,Xt,Xs);const y=[Xt[0],Xt[1]];$3(y),t.createPolyDataForOneLabel(d[u],f,n,Xp,y,e.renderable.getAxisTitlePixelOffset(),l),f+=2,u++;for(let x=0;x<e.renderable.getTickCounts()[h];x++)t.createPolyDataForOneLabel(d[u],f,n,Xp,y,e.renderable.getTickLabelPixelOffset(),l),f++,u++;h++}const g=ft.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(g),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(s,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=(n,r,i)=>{(e.lastSize[0]!==n[0]||e.lastSize[1]!==n[1])&&(e.lastSize[0]=n[0],e.lastSize[1]=n[1],e.lastAspectRatio=n[0]/n[1],e.forceUpdate=!0),e.camera=r,t.updateTexturePolyData()}}const az=J.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),J.obj(t,e),e.tmPolyData=Kn.newInstance(),e.tmMapper=ca.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=cc.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),J.setGet(t,e,["renderable"]),J.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},J.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},J.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],iz(t,e)},"vtkCubeAxesActorHelper");function oz(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=r=>{e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=()=>{const r=e.camera.getViewMatrix();Rt(r,r);let i=!1;const a=Kt.getDiagonalLength(e.dataBounds),o=Math.sin(e.faceVisibilityAngle*Math.PI/180);for(let s=0;s<6;s++){let c=!1;const l=Math.floor(s/2),f=(l+1)%3,u=(l+2)%3;e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&e.dataBounds[u*2]!==e.dataBounds[u*2+1]&&(_t[l]=e.dataBounds[s]-.1*a*rz[s][l],_t[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),_t[u]=.5*(e.dataBounds[u*2]+e.dataBounds[u*2+1]),Dt(Xt,_t,r),_t[l]=e.dataBounds[s],Dt(Xs,_t,r),Ln(Xt,Xs,Xt),gn(Xt,Xt),c=Xt[2]>o,e.camera.getParallelProjection()||(gn(Xs,Xs),c=zt(Xs,Xt)>o)),c!==e.lastFacesToDraw[s]&&(e.lastFacesToDraw[s]=c,i=!0)}return i},t.updatePolyData=(r,i,a)=>{let o=0,s=0;o+=8;let c=0;for(let p=0;p<12;p++)i[p]>0&&c++;if(s+=c,e.gridLines)for(let p=0;p<6;p++)r[p]&&(o+=a[vn[p][0]].length*2+a[vn[p][1]].length*2,s+=a[vn[p][0]].length+a[vn[p][1]].length);const l=new Float64Array(o*3),f=new Uint32Array(s*3);let u=0,h=0;for(let p=0;p<2;p++)for(let d=0;d<2;d++)for(let g=0;g<2;g++)l[u*3]=e.dataBounds[g],l[u*3+1]=e.dataBounds[2+d],l[u*3+2]=e.dataBounds[4+p],u++;for(let p=0;p<12;p++)i[p]>0&&(f[h*3]=2,f[h*3+1]=S0[p][0],f[h*3+2]=S0[p][1],h++);if(e.gridLines){for(let p=0;p<6;p++)if(r[p]){const d=Math.floor(p/2);let g=a[vn[p][0]];for(let y=0;y<g.length;y++)l[u*3+d]=e.dataBounds[p],l[u*3+vn[p][0]]=g[y],l[u*3+vn[p][1]]=e.dataBounds[vn[p][1]*2],u++,l[u*3+d]=e.dataBounds[p],l[u*3+vn[p][0]]=g[y],l[u*3+vn[p][1]]=e.dataBounds[vn[p][1]*2+1],u++,f[h*3]=2,f[h*3+1]=u-2,f[h*3+2]=u-1,h++;g=a[vn[p][1]];for(let y=0;y<g.length;y++)l[u*3+d]=e.dataBounds[p],l[u*3+vn[p][1]]=g[y],l[u*3+vn[p][0]]=e.dataBounds[vn[p][0]*2],u++,l[u*3+d]=e.dataBounds[p],l[u*3+vn[p][1]]=g[y],l[u*3+vn[p][0]]=e.dataBounds[vn[p][0]*2+1],u++,f[h*3]=2,f[h*3+1]=u-2,f[h*3+2]=u-1,h++}}e.polyData.getPoints().setData(l,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(f,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=(r,i,a,o)=>{let s=0;for(let p=0;p<12;p++)i[p]===1&&(s+=2,s+=a[Ny[p]].length);const c=e.polyData.getPoints().getData(),l=new Float64Array(s*3);let f=0,u=0,h=0;for(let p=0;p<6;p++)if(r[p])for(let d=0;d<4;d++){const g=My[p][d];if(i[g]===1){const y=Ny[g],x=S0[g][0]*3,m=S0[g][1]*3;l[f*3]=.5*(c[x]+c[m]),l[f*3+1]=.5*(c[x+1]+c[m+1]),l[f*3+2]=.5*(c[x+2]+c[m+2]),f++;const v=Math.floor(p/2);l[f*3+v]=e.dataBounds[p],l[f*3+vn[p][0]]=.5*(e.dataBounds[vn[p][0]*2]+e.dataBounds[vn[p][0]*2+1]),l[f*3+vn[p][1]]=.5*(e.dataBounds[vn[p][1]*2]+e.dataBounds[vn[p][1]*2+1]),f++,e.textValues[u]=e.axisLabels[y],u++;const w=(y+1)%3,C=(y+2)%3,T=a[y],_=o[y];e.tickCounts[h]=T.length;for(let S=0;S<T.length;S++)l[f*3+y]=T[S],l[f*3+w]=c[x+w],l[f*3+C]=c[x+C],f++,e.textValues[u]=_[S],u++;h++}}e.textPolyData.getPoints().setData(l,3),e.textPolyData.modified()},t.update=()=>{if(!e.camera)return;const r=t.computeFacesToDraw(),i=e.lastFacesToDraw;let a=!1;for(let o=0;o<6;o++)e.dataBounds[o]!==e.lastTickBounds[o]&&(a=!0,e.lastTickBounds[o]=e.dataBounds[o]);if(r||a||e.forceUpdate){const o=new Array(12).fill(0);for(let c=0;c<6;c++)if(i[c])for(let l=0;l<4;l++)o[My[c][l]]++;const s=e.generateTicks(e.dataBounds);t.updatePolyData(i,o,s.ticks),t.updateTextData(i,o,s.ticks,s.tickStrings),(a||e.forceUpdate)&&t.updateTextureAtlas(s.tickStrings)}e.forceUpdate=!1},t.updateTextureAtlas=r=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();let i=0,a=1;for(let o=0;o<3;o++){if(!e._tmAtlas.has(e.axisLabels[o])){Yp(e.tmContext,e.axisTextStyle);const s=e.tmContext.measureText(e.axisLabels[o]),c={height:s.actualBoundingBoxAscent+2,startingHeight:a,width:s.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[o],c),a+=c.height,i<c.width&&(i=c.width)}Yp(e.tmContext,e.tickTextStyle);for(let s=0;s<r[o].length;s++)if(!e._tmAtlas.has(r[o][s])){const c=e.tmContext.measureText(r[o][s]),l={height:c.actualBoundingBoxAscent+2,startingHeight:a,width:c.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[o][s],l),a+=l.height,i<l.width&&(i=l.width)}}i=gi(i),a=gi(a),e._tmAtlas.forEach(o=>{o.tcoords=[0,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight-o.height)/a,o.width/i,(a-o.startingHeight)/a,0,(a-o.startingHeight)/a]}),e.tmCanvas.width=i,e.tmCanvas.height=a,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,i,a),e._tmAtlas.forEach((o,s)=>{Yp(e.tmContext,o.textStyle),e.tmContext.fillText(s,1,o.startingHeight+o.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(()=>{e.forceUpdate=!0,t.update()}),t.setTickTextStyle=r=>{e.tickTextStyle={...e.tickTextStyle,...r},t.modified()},t.setAxisTextStyle=r=>{e.axisTextStyle={...e.axisTextStyle,...r},t.modified()},t.get_tmAtlas=()=>e._tmAtlas,t.getBounds=()=>(t.update(),Kt.setBounds(e.bounds,e.gridActor.getBounds()),Kt.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds);const n=J.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=r=>n(r)[0]}function sz(t,e,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...Kt.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:xw,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}function ww(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cc.extend(t,e,sz(t,e,n)),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=cu.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=ca.newInstance(),e.polyData=Kn.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=cc.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=Kn.newInstance(),J.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),J.setGetArray(t,e,["dataBounds"],6),J.setGetArray(t,e,["axisLabels"],3),J.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),oz(t,e)}const cz=J.newInstance(ww,"vtkCubeAxesActor");var Cw={newInstance:cz,extend:ww,newCubeAxesActorHelper:az,defaultGenerateTicks:xw};function uz(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const lz={};function fz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lz,n),en.extend(t,e,n),e.CubeAxesActorHelper=Cw.newCubeAxesActorHelper(),uz(t,e)}const hz=kt(fz,"vtkOpenGLCubeAxesActor");An("vtkCubeAxesActor",hz);const{ColorMode:pz,ScalarMode:Us,GetArray:Jp}=wh;function dz(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=()=>{e.lookupTable=Bf.newInstance()},t.getColorModeAsString=()=>J.enumToString(pz,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>J.enumToString(Us,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,i,a,o)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFLag:!1};let s=null,c=!1;if(r===Us.DEFAULT)s=n.getPointData().getScalars(),s||(s=n.getCellData().getScalars(),c=!0);else if(r===Us.USE_POINT_DATA)s=n.getPointData().getScalars();else if(r===Us.USE_CELL_DATA)s=n.getCellData().getScalars(),c=!0;else if(r===Us.USE_POINT_FIELD_DATA){const l=n.getPointData();i===Jp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}else if(r===Us.USE_CELL_FIELD_DATA){const l=n.getCellData();c=!0,i===Jp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}else if(r===Us.USE_FIELD_DATA){const l=n.getFieldData();i===Jp.BY_ID?s=l.getArrayByIndex(a):s=l.getArrayByName(o)}return{scalars:s,cellFlag:c}},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.mapScalars=(n,r)=>{const i=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!i){e.colorMapColors=null;return}const a=`${t.getMTime()}${i.getMTime()}${r}`;if(e.colorBuildString===a)return;e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);const o=t.getLookupTable();o&&(o.build(),e.colorMapColors=o.mapScalars(i,e.colorMode,e.fieldDataTupleId)),e.colorBuildString=`${t.getMTime()}${i.getMTime()}${r}`},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}}}const gz={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function mz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gz,n),f6.extend(t,e,n),J.get(t,e,["colorMapColors"]),J.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),J.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),dz(t,e)}J.newInstance(mz,"vtkMapper2D");var vz={},yz=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,xz=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`;const Tw={BACKGROUND:0,FOREGROUND:1};var _w={DisplayLocation:Tw};const{primTypes:Ii}=Ca,{ScalarMode:D0}=vz,{vtkErrorMacro:O0}=sr,wz={type:"StartEvent"},Cz={type:"EndEvent"};function Tz(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=r=>{r&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=r=>{r&&t.render()},t.getShaderTemplate=(r,i,a)=>{r.Vertex=xz,r.Fragment=yz,r.Geometry=""},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let o=Ii.Start;o<Ii.End;o++)e.primitives[o].setOpenGLRenderWindow(e._openGLRenderWindow)}const i=e.openGLActor2D.getRenderable(),a=e._openGLRenderer.getRenderable();t.renderPiece(a,i)},t.renderPiece=(r,i)=>{if(t.invokeEvent(wz),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(Cz),!e.currentInput){O0("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(r,i),t.renderPieceDraw(r,i),t.renderPieceFinish(r,i))},t.renderPieceStart=(r,i)=>{if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(i)}t.updateBufferObjects(r,i),e.lastBoundBO=null},t.getNeedToRebuildShaders=(r,i,a)=>r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime(),t.updateBufferObjects=(r,i)=>{t.getNeedToRebuildBufferObjects(r,i)&&t.buildBufferObjects(r,i)},t.getNeedToRebuildBufferObjects=(r,i)=>{const a=e.VBOBuildTime.getMTime();return!!(a<t.getMTime()||a<e._openGLRenderWindow.getMTime()||a<e.renderable.getMTime()||a<i.getMTime()||a<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&a<r.getMTime())},t.buildBufferObjects=(r,i)=>{const a=e.currentInput;if(a===null)return;e.renderable.mapScalars(a,i.getProperty().getOpacity());const o=e.renderable.getColorMapColors();e.haveCellScalars=!1;const s=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(s===D0.USE_CELL_DATA||s===D0.USE_CELL_FIELD_DATA||s===D0.USE_FIELD_DATA||!a.getPointData().getScalars())&&s!==D0.USE_POINT_FIELD_DATA&&o&&(e.haveCellScalars=!0);const c=i.getProperty().getRepresentation();let l=a.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(l=null);const f=e.renderable.getTransformCoordinate(),h=r.getRenderWindow().getViews()[0].getViewportSize(r),p=`${a.getMTime()}A${c}B${a.getMTime()}C${o?o.getMTime():1}D${l?l.getMTime():1}E${f?r.getMTime():1}F${h}`;if(e.VBOBuildString!==p){let d=a.getPoints();if(f){const y=Ff.newInstance(),x=d.getNumberOfPoints();y.setNumberOfPoints(x);const m=[];for(let v=0;v<x;++v){d.getPoint(v,m),f.setValue(m);const w=f.getComputedDoubleViewportValue(r);y.setPoint(v,w[0],w[1],0)}d=y}const g={points:d,tcoords:l,colors:o,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(y=>a.getPointData().getArrayByName(y))};g.cellOffset+=e.primitives[Ii.Points].getCABO().createVBO(a.getVerts(),"verts",c,g),g.cellOffset+=e.primitives[Ii.Lines].getCABO().createVBO(a.getLines(),"lines",c,g),g.cellOffset+=e.primitives[Ii.Tris].getCABO().createVBO(a.getPolys(),"polys",c,g),g.cellOffset+=e.primitives[Ii.TriStrips].getCABO().createVBO(a.getStrips(),"strips",c,g),e.VBOBuildTime.modified(),e.VBOBuildString=p}},t.renderPieceDraw=(r,i)=>{const a=i.getProperty().getRepresentation();e.context.depthMask(!0);for(let s=Ii.Start;s<Ii.End;s++)e.primitives[s].getCABO().getElementCount()&&(e.lastBoundBO=e.primitives[s],e.primitiveIDOffset+=e.primitives[s].drawArrays(r,i,a,t))},t.renderPieceFinish=(r,i)=>{e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.replaceShaderValues=(r,i,a)=>{t.replaceShaderColor(r,i,a),t.replaceShaderTCoord(r,i,a),t.replaceShaderPicking(r,i,a),t.replaceShaderPositionVC(r,i,a)},t.replaceShaderColor=(r,i,a)=>{let o=r.Vertex,s=r.Geometry,c=r.Fragment;e.haveCellScalars&&(c=Te.substitute(c,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,c=Te.substitute(c,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(o=Te.substitute(o,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,o=Te.substitute(o,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,s=Te.substitute(s,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,s=Te.substitute(s,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,c=Te.substitute(c,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,c=Te.substitute(c,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(c=Te.substitute(c,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,c=Te.substitute(c,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=c},t.replaceShaderTCoord=(r,i,a)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let o=r.Vertex,s=r.Geometry,c=r.Fragment;const l=e.lastBoundBO.getCABO().getTCoordComponents();l===1?(o=Te.substitute(o,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,o=Te.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=Te.substitute(s,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,s=Te.substitute(s,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=Te.substitute(c,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=Te.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):l===2&&(o=Te.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,o=Te.substitute(o,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,s=Te.substitute(s,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,s=Te.substitute(s,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=Te.substitute(c,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=Te.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(s=Te.substitute(s,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),r.Vertex=o,r.Geometry=s,r.Fragment=c}},t.replaceShaderPicking=(r,i,a)=>{let o=r.Fragment;o=Te.substitute(o,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,o=Te.substitute(o,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,r.Fragment=o},t.replaceShaderPositionVC=(r,i,a)=>{e.lastBoundBO.replaceShaderPositionVC(r,i,a)},t.invokeShaderCallbacks=(r,i,a)=>{const o=e.renderable.getViewSpecificProperties().ShadersCallbacks;o&&o.forEach(s=>{s.callback(s.userData,r,i,a)})},t.setMapperShaderParameters=(r,i,a)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isAttributeUsed("vertexWC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexWC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||O0("Error setting vertexWC in shader VAO.")),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach((c,l)=>{r.getProgram().isAttributeUsed(`${c}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${c}MC`,r.getCABO().getCustomData()[l].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[l].components,!1)||O0(`Error setting ${c}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||O0("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const o=e.openGLActor2D.getActiveTextures();if(o)for(let c=0;c<o.length;++c){const f=o[c].getTextureUnit(),u=`texture${f+1}`;r.getProgram().isUniformUsed(u)&&r.getProgram().setUniformi(u,f)}r.setMapperShaderParameters(i,a,e._openGLRenderer.getTiledSizeAndOrigin());const s=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=(r,i,a)=>{const o=e.renderable.getColorMapColors();if(!o||o.getNumberOfComponents()===0){const s=r.getProgram(),c=a.getProperty(),l=c.getOpacity(),f=c.getColor(),u=[f[0],f[1],f[2],l];s.setUniform4f("diffuseColor",u)}},t.setLightingShaderParameters=(r,i,a)=>{};function n(r,i,a){return i.identity(a),r.reduce((o,s,c)=>c===0?s?i.copy(o,s):i.identity(o):s?i.multiply(o,o,s):o,a)}t.setCameraShaderParameters=(r,i,a)=>{const o=r.getProgram(),c=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,f=i.getRenderWindow().getViews()[0].getViewportSize(i),u=i.getViewport(),h=a.getActualPositionCoordinate().getComputedDoubleViewportValue(i),p=[0,0,1,1],d=[0,0,1,1];if(d[0]=u[0]>=p[0]?u[0]:p[0],d[1]=u[1]>=p[1]?u[1]:p[1],d[2]=u[2]<=p[2]?u[2]:p[2],d[3]=u[3]<=p[3]?u[3]:p[3],d[0]>=d[2]||d[1]>=d[3])return;f[0]=bu(f[0]*(d[2]-d[0])/(u[2]-u[0])),f[1]=bu(f[1]*(d[3]-d[1])/(u[3]-u[1]));const g=e._openGLRenderer.getParent().getSize(),y=bu(h[0]-(d[0]-u[0])*g[0]),x=bu(h[1]-(d[1]-u[1])*g[1]),m=-y;let v=-y+f[0];const w=-x;let C=-x+f[1];m===v&&(v=m+1),w===C&&(C=w+1);const T=ut(new Float64Array(16));T[0]=2/(v-m),T[1*4+1]=2/(C-w),T[0*4+3]=-1*(v+m)/(v-m),T[1*4+3]=-1*(C+w)/(C-w),T[2*4+2]=0,T[2*4+3]=a.getProperty().getDisplayLocation()===Tw.FOREGROUND?-1:1,T[3*4+3]=1,Rt(T,T),o.setUniformMatrix("WCVCMatrix",n([T,c],hl,e.tmpMat4))},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(i=>{r+=i.getAllocatedGPUMemoryInBytes()}),r}}const _z={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function Sz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_z,n),en.extend(t,e,n),ya.implementReplaceShaderCoincidentOffset(t,e,n),ya.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=Ii,e.tmpMat4=ut(new Float64Array(16));for(let r=Ii.Start;r<Ii.End;r++)e.primitives[r]=Ca.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);bn(t,e,["context"]),e.VBOBuildTime={},an(e.VBOBuildTime,{mtime:0}),Tz(t,e)}const bz=kt(Sz,"vtkOpenGLPolyDataMapper2D");An("vtkMapper2D",bz);const{VectorMode:Ez}=Ch;function Zp(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function Sw(t,e){return n=>{const r=n.getLastSize(),i=(r[0]/700)**.8,a=(r[1]/700)**.8,o=Math.min(i,a),s=n.getAxisTextStyle(),c=n.getTickTextStyle();Object.assign(s,e.axisTextStyle),Object.assign(c,e.tickTextStyle),s.fontSize=Math.max(24*o,12),n.getLastAspectRatio()>1?c.fontSize=Math.max(20*o,10):c.fontSize=Math.max(16*o,10);const l=n.updateTextureAtlas();n.setTopTitle(!1);const f=n.getBoxSizeByReference();if(n.getLastAspectRatio()>1)n.setTickLabelPixelOffset(.3*c.fontSize),l.titleWidth<=l.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize?(n.setTopTitle(!0),n.setAxisTitlePixelOffset(.2*c.fontSize),f[0]=2*(l.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.98-f[0],-.92])):(n.setAxisTitlePixelOffset(.2*c.fontSize),f[0]=2*(l.titleHeight+n.getAxisTitlePixelOffset()+l.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.99-f[0],-.92])),f[1]=Math.max(1.2,Math.min(1.84/a,1.84));else{n.setAxisTitlePixelOffset(1.2*c.fontSize),n.setTickLabelPixelOffset(.1*c.fontSize);const u=2*(.8*c.fontSize+l.titleHeight+n.getAxisTitlePixelOffset())/r[1],h=2*l.tickWidth/r[0];f[0]=Math.min(1.9,Math.max(1.4,1.4*h*(n.getTicks().length+3))),f[1]=u,n.setBoxPosition([-.5*f[0],-.97])}n.recomputeBarSegments(l)}}function bw(t,e){return n=>{const r=n.getLastTickBounds(),i=x2().domain([r[0],r[1]]),a=i.ticks(5),o=i.tickFormat(5);n.setTicks(a),n.setTickStrings(a.map(o))}}function Dz(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=i=>{e.renderable!==i&&(e.renderable=i,e.barActor.setProperty(i.getProperty()),e.barActor.setParentProp(i),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(i.getProperty()),e.tmActor.setParentProp(i),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=i.generateTicks,e.axisTextStyle={...i.getAxisTextStyle()},e.tickTextStyle={...i.getTickTextStyle()},t.modified())},t.updateAPISpecificData=(i,a,o)=>{(e.lastSize[0]!==i[0]||e.lastSize[1]!==i[1])&&(e.lastSize[0]=i[0],e.lastSize[1]=i[1],e.lastAspectRatio=i[0]/i[1],e.forceUpdate=!0);const s=e.renderable.getScalarsToColors();if(!(!s||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(s),e.camera=a,e.renderWindow=o,e.forceUpdate||Math.max(s.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){const c=s.getMappingRange();if(e.lastTickBounds=[...c],e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle={...e.renderable.getAxisTextStyle()},e.tickTextStyle={...e.renderable.getTickTextStyle()},e.barPosition=[...e.renderable.getBarPosition()],e.barSize=[...e.renderable.getBarSize()],e.boxPosition=[...e.renderable.getBoxPosition()],e.boxSize=[...e.renderable.getBoxSize()],e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();const l=t.updateTextureAtlas();t.recomputeBarSegments(l)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=()=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";const i={},a=new Map;let o=0,s=1;Zp(e.tmContext,e.axisTextStyle);let c=e.tmContext.measureText(e.renderable.getAxisLabel()),l={height:c.actualBoundingBoxAscent+2,startingHeight:s,width:c.width+2,textStyle:e.axisTextStyle};a.set(e.renderable.getAxisLabel(),l),s+=l.height,o=l.width,i.titleWidth=l.width,i.titleHeight=l.height,i.tickWidth=0,i.tickHeight=0,Zp(e.tmContext,e.tickTextStyle);const f=[...t.getTickStrings(),"NaN","Below","Above"];for(let u=0;u<f.length;u++)a.has(f[u])||(c=e.tmContext.measureText(f[u]),l={height:c.actualBoundingBoxAscent+2,startingHeight:s,width:c.width+2,textStyle:e.tickTextStyle},a.set(f[u],l),s+=l.height,o<l.width&&(o=l.width),i.tickWidth<l.width&&(i.tickWidth=l.width),i.tickHeight<l.height&&(i.tickHeight=l.height));return o=gi(o),s=gi(s),a.forEach(u=>{u.tcoords=[0,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight-u.height)/s,u.width/o,(s-u.startingHeight)/s,0,(s-u.startingHeight)/s]}),e.tmCanvas.width=o,e.tmCanvas.height=s,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,o,s),a.forEach((u,h)=>{Zp(e.tmContext,u.textStyle),e.tmContext.fillText(h,1,u.startingHeight+u.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=a,i},t.computeBarSize=i=>{e.vertical=e.boxSize[1]>e.boxSize[0];const a=2*i.tickHeight/e.lastSize[1],o=[1,1];if(e.vertical){const s=2*(i.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){const c=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-s,e.barSize[1]=e.boxSize[1]-c}else{const c=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-c-s,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+s,e.barPosition[1]=e.boxPosition[1],o[1]=a}else{const s=(2*i.tickWidth-8)/e.lastSize[0],c=2*(i.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-c,e.barPosition[1]=e.boxPosition[1],o[0]=s}return o},t.recomputeBarSegments=i=>{const a=t.computeBarSize(i);e.barSegments=[];const o=[0,0],s=e.vertical?1:0,c=e.vertical?.01:.02;function l(h,p){e.barSegments.push({corners:[[...o],[o[0]+a[0],o[1]],[o[0]+a[0],o[1]+a[1]],[o[0],o[1]+a[1]]],scalars:p,title:h}),o[s]+=a[s]+c}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&l("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&e.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&l("Below",[-.1,-.1,-.1,-.1]);const f=e.renderable.getScalarsToColors().getUseAboveRangeColor?.();o[s]+=c;const u=a[s];a[s]=f?1-2*c-a[s]-o[s]:1-c-o[s],l("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&f&&(a[s]=u,o[s]+=c,l("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);t.createPolyDataForOneLabel=(i,a,o,s,c,l)=>{const f=e._tmAtlas.get(i);if(!f)return;let u=l.ptIdx,h=l.cellIdx;n[0]=(.5*a[0]+.5)*e.lastSize[0],n[1]=(.5*a[1]+.5)*e.lastSize[1],n[2]=a[2],n[0]+=c[0],n[1]+=c[1];const p=[],d=s==="vertical"?[1,0]:[0,1];s==="vertical"?(p[0]=f.width,p[1]=-f.height,o[0]==="middle"?n[1]-=f.width/2:o[0]==="right"&&(n[1]-=f.width),o[1]==="middle"?n[0]+=f.height/2:o[1]==="top"&&(n[0]+=f.height)):(p[0]=f.width,p[1]=f.height,o[0]==="middle"?n[0]-=f.width/2:o[0]==="right"&&(n[0]-=f.width),o[1]==="middle"?n[1]-=f.height/2:o[1]==="top"&&(n[1]-=f.height)),l.points[u*3]=n[0],l.points[u*3+1]=n[1],l.points[u*3+2]=n[2],l.tcoords[u*2]=f.tcoords[0],l.tcoords[u*2+1]=f.tcoords[1],u++,n[d[0]]+=p[0],l.points[u*3]=n[0],l.points[u*3+1]=n[1],l.points[u*3+2]=n[2],l.tcoords[u*2]=f.tcoords[2],l.tcoords[u*2+1]=f.tcoords[3],u++,n[d[1]]+=p[1],l.points[u*3]=n[0],l.points[u*3+1]=n[1],l.points[u*3+2]=n[2],l.tcoords[u*2]=f.tcoords[4],l.tcoords[u*2+1]=f.tcoords[5],u++,n[d[0]]-=p[0],l.points[u*3]=n[0],l.points[u*3+1]=n[1],l.points[u*3+2]=n[2],l.tcoords[u*2]=f.tcoords[6],l.tcoords[u*2+1]=f.tcoords[7],u++,l.polys[h*4]=3,l.polys[h*4+1]=u-4,l.polys[h*4+2]=u-3,l.polys[h*4+3]=u-2,h++,l.polys[h*4]=3,l.polys[h*4+1]=u-4,l.polys[h*4+2]=u-2,l.polys[h*4+3]=u-1,l.ptIdx+=4,l.cellIdx+=2};const r=new Float64Array(3);t.updatePolyDataForLabels=()=>{const i=t.getTickStrings().length+e.barSegments.length,a=i*4,o=i*2,s=new Float64Array(a*3),c=new Uint16Array(o*4),l=new Float32Array(a*2),f={ptIdx:0,cellIdx:0,polys:c,points:s,tcoords:l},u=e.vertical?0:1,h=e.vertical?1:0;r[2]=-.99;const p=e.vertical?["right","middle"]:["middle","bottom"];let d=[0,1];const g=[0,0];e.vertical?(g[0]=-e.tickLabelPixelOffset,e.topTitle?(r[0]=e.boxPosition[0]+.5*e.boxSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)):(r[0]=e.barPosition[0]+e.barSize[0],r[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],f)),d=[-1,0]):(g[1]=e.tickLabelPixelOffset,r[0]=e.barPosition[0]+.5*e.barSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)),r[u]=e.barPosition[u]+(.5*d[u]+.5)*e.barSize[u],r[h]=e.barPosition[h]+e.barSize[h]*.5;let y=null;for(let T=0;T<e.barSegments.length;T++){const _=e.barSegments[T];_.title==="ticks"?y=_:(r[h]=e.barPosition[h]+.5*e.barSize[h]*(_.corners[2][h]+_.corners[0][h]),t.createPolyDataForOneLabel(_.title,r,p,"horizontal",g,f))}const x=e.barPosition[h]+e.barSize[h]*y.corners[0][h],m=e.barSize[h]*(y.corners[2][h]-y.corners[0][h]),v=t.getTicks(),w=t.getTickStrings();for(let T=0;T<v.length;T++){const _=(v[T]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);r[h]=x+m*_,t.createPolyDataForOneLabel(w[T],r,p,"horizontal",g,f)}const C=ft.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(C),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(c,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=()=>{const i=e.renderable.getScalarsToColors();let a=0;e.renderable.getDrawNanAnnotation()&&i.getNanColor()&&(a+=1),e.renderable.getDrawBelowRangeSwatch()&&i.getUseBelowRangeColor?.()&&(a+=1),e.renderable.getDrawAboveRangeSwatch()&&i.getUseAboveRangeColor?.()&&(a+=1);const o=4*(1+a),s=o;let c=1;i.getVectorMode()===Ez.COMPONENT&&(c=i.getVectorComponent()+1);const l=new Float64Array(o*3),f=new Uint16Array(s*5),u=new Float32Array(o*c);let h=0,p=0;for(let g=0;g<e.barSegments.length;g++){const y=e.barSegments[g];for(let x=0;x<4;x++){r[0]=e.barPosition[0]+y.corners[x][0]*e.barSize[0],r[1]=e.barPosition[1]+y.corners[x][1]*e.barSize[1],l[h*3]=(.5*r[0]+.5)*e.lastSize[0],l[h*3+1]=(.5*r[1]+.5)*e.lastSize[1],l[h*3+2]=r[2];for(let m=0;m<c;m++)u[h*c+m]=e.lastTickBounds[0]+y.scalars[x]*(e.lastTickBounds[1]-e.lastTickBounds[0]);h++}f[p*5]=4,f[p*5+1]=h-4,f[p*5+2]=h-3,f[p*5+3]=h-2,f[p*5+4]=h-1,p++}const d=ft.newInstance({numberOfComponents:c,values:u,name:"Scalars"});e.polyData.getPointData().setScalars(d),e.polyData.getPoints().setData(l,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(f,1),e.polyData.getPolys().modified(),e.polyData.modified()}}const Oz=J.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),J.obj(t,e),J.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),J.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),J.getArray(t,e,["boxPosition","boxSize"]),J.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},J.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=ca.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=Kn.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=cc.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=Kn.newInstance(),e.tmMapper=ca.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=cu.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=cc.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],Dz(t,e)},"vtkScalarBarActorHelper");function Rz(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=n=>{e.tickTextStyle={...e.tickTextStyle,...n},t.modified()},t.setAxisTextStyle=n=>{e.axisTextStyle={...e.axisTextStyle,...n},t.modified()},t.resetAutoLayoutToDefault=()=>{t.setAutoLayout(Sw(t,e))},t.resetGenerateTicksToDefault=()=>{t.setGenerateTicks(bw())}}function Mz(t){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,...t}}function Ew(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Mz(n)),e.autoLayout||(e.autoLayout=Sw(t,e)),e.generateTicks||(e.generateTicks=bw()),cc.extend(t,e,n),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),J.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),J.get(t,e,["axisTextStyle","tickTextStyle"]),J.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),J.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),Rz(t,e)}const Nz=J.newInstance(Ew,"vtkScalarBarActor");var Dw={newInstance:Nz,extend:Ew,newScalarBarActorHelper:Oz};function Lz(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,a=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e._openGLRenderWindow.getRenderable())}}}const Az={};function Fz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Az,n),en.extend(t,e,n),e.scalarBarActorHelper=Dw.newScalarBarActorHelper(),Lz(t,e)}const Iz=kt(Fz,"vtkOpenGLScalarBarActor");An("vtkScalarBarActor",Iz);const{CoordinateSystem:Ly}=kl;function Pz(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix();e.bufferShift[0]=r[3],e.bufferShift[1]=r[7],e.bufferShift[2]=r[11];const i=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Ly.WORLD&&(e.bufferShift[0]-=i[0],e.bufferShift[1]-=i[1],e.bufferShift[2]-=i[2]),Rt(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?ut(e.keyMatrices.normalMatrix):(pn(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,Sn(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Rt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),hn(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Ly.WORLD?hn(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-i[0],-i[1],-i[2]]):pn(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const Vz={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function kz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Vz,n),en.extend(t,e,n),e.keyMatricesTime={},J.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},J.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],Pz(t,e)}const Uz=J.newInstance(kz);Ci("vtkActor",Uz);const{CoordinateSystem:Ay}=kl;function Bz(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;const r=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Ay.WORLD&&(e.bufferShift[0]-=r[0],e.bufferShift[1]-=r[1],e.bufferShift[2]-=r[2]),ut(e.keyMatrices.bcwc),ut(e.keyMatrices.normalMatrix),hn(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Ay.WORLD?hn(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):pn(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const Gz={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function Wz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gz,n),en.extend(t,e,n),e.keyMatricesTime={},J.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},J.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],Bz(t,e)}const zz=J.newInstance(Wz);Ci("vtkActor2D",zz);function jz(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const $z={};function Hz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$z,n),en.extend(t,e,n),e.CubeAxesActorHelper=Cw.newCubeAxesActorHelper(),jz(t,e)}const Kz=kt(Hz,"vtkWebGPUCubeAxesActor");Ci("vtkCubeAxesActor",Kz);const{DisplayLocation:fg}=_w;function qz(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=()=>t.setDisplayLocation(fg.BACKGROUND),t.setDisplayLocationToForeground=()=>t.setDisplayLocation(fg.FOREGROUND),t.setRepresentationToWireframe=()=>t.setRepresentation(or.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(or.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(or.POINTS),t.getRepresentationAsString=()=>J.enumToString(or,e.representation)}const Xz={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:or.SURFACE,displayLocation:fg.FOREGROUND};function Yz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xz,n),J.obj(t,e),J.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),J.setGetArray(t,e,["color"],3),qz(t,e)}J.newInstance(Yz,"vtkProperty2D");var Jz={..._w};const{BufferUsage:Yn,PrimitiveTypes:Or}=ru,{Representation:R0}=pc,{ScalarMode:M0}=ca,{CoordinateSystem:Zz}=kl,{DisplayLocation:Qz}=Jz,ej=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,tj=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1.0) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359;

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;

  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));
  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  var incoming: vec3<f32> = color * (1.0 / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);

  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);
  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);
  var _metallicMap: vec4<f32> = vec4<f32>(1.0);
  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);
  var _emissionMap: vec4<f32> = vec4<f32>(0.);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function Fy(t){return t.indexOf("edge")>=0}function nj(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=n=>{n&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==Zz.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=()=>{const r=e.WebGPUActor.getRenderable().getProperty(),i=e.UBO.getSendTime();if(t.getMTime()>i||r.getMTime()>i||e.renderable.getMTime()>i){const a=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",a.bcwc),e.UBO.setArray("BCSCMatrix",a.bcsc),e.UBO.setArray("MCWCNormals",a.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===Qz.FOREGROUND?1:0);const c=r.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[c[0],c[1],c[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{let c=r.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",r.getAmbient()),e.UBO.setArray("AmbientColor",[c[0],c[1],c[2],1]),e.UBO.setValue("DiffuseIntensity",r.getDiffuse()),c=r.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[c[0],c[1],c[2],1]),e.UBO.setValue("Roughness",r.getRoughness()),e.UBO.setValue("BaseIOR",r.getBaseIOR()),e.UBO.setValue("Metallic",r.getMetallic()),e.UBO.setValue("NormalStrength",r.getNormalStrength()),e.UBO.setValue("Emission",r.getEmission()),e.UBO.setValue("SpecularIntensity",r.getSpecular()),c=r.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[c[0],c[1],c[2],1])}const o=r.getEdgeColorByReference?.();o&&e.UBO.setArray("EdgeColor",[o[0],o[1],o[2],1]),e.UBO.setValue("LineWidth",r.getLineWidth()),e.UBO.setValue("Opacity",r.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());const s=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(s)}},t.haveWideLines=()=>{const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();return n.getProperty().getLineWidth()<=1||e.primitiveType===Or.Verts?!1:e.primitiveType===Or.Triangles||e.primitiveType===Or.TriangleStrips?r===R0.WIREFRAME:!0},t.replaceShaderPosition=(n,r,i)=>{const a=r.getShaderDescription("vertex");a.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");let o=a.getCode();e.useRendererMatrix?(o=Yt.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(o=Yt.substitute(o,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(o=Yt.substitute(o,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(o=Yt.substitute(o,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(a.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),o=Yt.substitute(o,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),o=Yt.substitute(o,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,a.setCode(o)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=(n,r,i)=>{const a=i.getBuffer("normalMC"),o=e.WebGPUActor.getRenderable();if(a){const s=r.getShaderDescription("vertex");s.hasOutput("normalVC")||s.addOutput("vec3<f32>","normalVC",a.getArrayInformation()[0].interpolation),s.hasOutput("tangentVC")||s.addOutput("vec3<f32>","tangentVC",a.getArrayInformation()[0].interpolation),s.hasOutput("bitangentVC")||s.addOutput("vec3<f32>","bitangentVC",a.getArrayInformation()[0].interpolation);let c=s.getCode();c=Yt.substitute(c,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,s.setCode(c);const l=r.getShaderDescription("fragment");c=l.getCode(),o.getProperty().getNormalTexture()?c=Yt.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:c=Yt.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,l.setCode(c)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=(n,r,i)=>{if(n.includes("sel"))return;const a=r.getShaderDescription("vertex");a.hasOutput("vertexVC")||a.addOutput("vec4<f32>","vertexVC");const o=e.WebGPURenderer.getRenderable(),s=r.getShaderDescription("fragment");let c=s.getCode();if(c.includes("var normal:")&&e.useRendererMatrix&&!Fy(n)&&!e.is2D&&!n.includes("sel")){const l=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1.0, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1.0), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];o.getEnvironmentTexture()?.getImageLoaded()&&l.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),c=Yt.substitute(c,"//VTK::Light::Impl",l).result,s.setCode(c)}else c=Yt.substitute(c,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,s.setCode(c)},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=(n,r,i)=>{if(Fy(n)){const l=r.getShaderDescription("fragment");let f=l.getCode();f=Yt.substitute(f,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,l.setCode(f);return}const a=i.getBuffer("colorVI");if(!a)return;const o=r.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",a.getArrayInformation()[0].interpolation);let s=o.getCode();s=Yt.substitute(s,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(s);const c=r.getShaderDescription("fragment");s=c.getCode(),s=Yt.substitute(s,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,c.setCode(s)},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=(n,r,i)=>{if(!i.hasAttribute("tcoord"))return;const a=r.getShaderDescription("vertex"),o=i.getBuffer("tcoord"),s=ir.getNumberOfComponentsFromBufferFormat(o.getArrayInformation()[0].format);let c=a.getCode();a.addOutput(`vec${s}<f32>`,"tcoordVS"),c=Yt.substitute(c,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,a.setCode(c);const l=r.getShaderDescription("fragment");c=l.getCode();const f=e.WebGPUActor.getRenderable(),u=p=>p?p.getDimensionality()===s:!1,h=[];(f.getProperty().getDiffuseTexture?.()?.getImageLoaded()||f.getTextures()[0]||e.colorTexture)&&(u(f.getProperty().getDiffuseTexture?.())||u(f.getTextures()[0])||u(e.colorTexture))&&h.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);"),f.getProperty().getRoughnessTexture?.()?.getImageLoaded()&&u(f.getProperty().getRoughnessTexture())&&h.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),f.getProperty().getMetallicTexture?.()?.getImageLoaded()&&u(f.getProperty().getMetallicTexture())&&h.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),f.getProperty().getNormalTexture?.()?.getImageLoaded()&&u(f.getProperty().getNormalTexture())&&h.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),f.getProperty().getAmbientOcclusionTexture?.()?.getImageLoaded()&&u(f.getProperty().getAmbientOcclusionTexture())&&h.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),f.getProperty().getEmissionTexture?.()?.getImageLoaded()&&u(f.getProperty().getEmissionTexture())&&h.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),c=Yt.substitute(c,"//VTK::TCoord::Impl",h).result,l.setCode(c)},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=(n,r,i)=>{if(n.includes("sel")){const a=r.getShaderDescription("fragment");let o=a.getCode();o=Yt.substitute(o,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,a.setCode(o)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=(n,r)=>n===R0.POINTS||r===Or.Points?Yn.Verts:r===Or.Lines?Yn.Lines:n===R0.WIREFRAME?r===Or.Triangles?Yn.LinesFromTriangles:Yn.LinesFromStrips:r===Or.Triangles?Yn.Triangles:r===Or.TriangleStrips?Yn.Strips:r===Or.TriangleEdges?Yn.LinesFromTriangles:Yn.LinesFromStrips,t.getHashFromUsage=n=>`pt${n}`,t.getTopologyFromUsage=n=>{switch(n){case Yn.Triangles:return"triangle-list";case Yn.Verts:return"point-list";case Yn.Lines:default:return"line-list"}},t.buildVertexInput=()=>{const n=e.currentInput,r=e.cellArray,i=e.primitiveType;let o=e.WebGPUActor.getRenderable().getProperty().getRepresentation();const s=e.WebGPURenderWindow.getDevice();let c=!1;i===Or.TriangleEdges&&(c=!0,o=R0.WIREFRAME);const l=e.vertexInput,f=n.getPoints();let u;if(r){const g={hash:`R${o}P${i}${r.getMTime()}`,usage:Yn.Index,cells:r,numberOfPoints:f.getNumberOfPoints(),primitiveType:i,representation:o};u=s.getBufferManager().getBuffer(g),l.setIndexBuffer(u)}else l.setIndexBuffer(null);if(f){const g=e.WebGPUActor.getBufferShift(e.WebGPURenderer),y={hash:`${f.getMTime()}I${u.getMTime()}${g.join()}float32x4`,usage:Yn.PointArray,format:"float32x4",dataArray:f,indexBuffer:u,shift:g,packExtra:!0},x=s.getBufferManager().getBuffer(y);l.addBuffer(x,["vertexBC"])}else l.removeBufferIfPresent("vertexBC");const h=t.getUsage(o,i);if(e._usesCellNormals=!1,!e.is2D&&(h===Yn.Triangles||h===Yn.Strips)){const g=n.getPointData().getNormals(),y={format:"snorm8x4",indexBuffer:u,packExtra:!0,shift:0,scale:127};if(g){y.hash=`${g.getMTime()}I${u.getMTime()}snorm8x4`,y.dataArray=g,y.usage=Yn.PointArray;const x=s.getBufferManager().getBuffer(y);l.addBuffer(x,["normalMC"])}else if(i===Or.Triangles){e._usesCellNormals=!0,y.hash=`PFN${f.getMTime()}I${u.getMTime()}snorm8x4`,y.dataArray=f,y.cells=r,y.usage=Yn.NormalsFromPoints;const x=s.getBufferManager().getBuffer(y);l.addBuffer(x,["normalMC"])}else l.removeBufferIfPresent("normalMC")}else l.removeBufferIfPresent("normalMC");let p=!1;if(e.renderable.getScalarVisibility()){const g=e.renderable.getColorMapColors();if(g&&!c){const y=e.renderable.getScalarMode();let x=!1;(y===M0.USE_CELL_DATA||y===M0.USE_CELL_FIELD_DATA||y===M0.USE_FIELD_DATA||!n.getPointData().getScalars())&&y!==M0.USE_POINT_FIELD_DATA&&g&&(x=!0);const m={usage:Yn.PointArray,format:"unorm8x4",hash:`${x}${g.getMTime()}I${u.getMTime()}unorm8x4`,dataArray:g,indexBuffer:u,cellData:x,cellOffset:0},v=s.getBufferManager().getBuffer(m);l.addBuffer(v,["colorVI"]),p=!0}}p||l.removeBufferIfPresent("colorVI");let d=null;if(e.renderable.getInterpolateScalarsBeforeMapping?.()&&e.renderable.getColorCoordinates()?d=e.renderable.getColorCoordinates():d=n.getPointData().getTCoords(),d&&!c){const g=s.getBufferManager().getBufferForPointArray(d,l.getIndexBuffer());l.addBuffer(g,["tcoord"])}else l.removeBufferIfPresent("tcoord")},t.updateTextures=()=>{const n=[],r=[],i=e.renderable.getColorTextureMap?.();i&&(e.colorTexture||(e.colorTexture=cu.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(i),r.push(["Diffuse",e.colorTexture]));const a=e.WebGPUActor.getRenderable(),o=e.WebGPURenderer.getRenderable(),s=[];if(a.getProperty().getDiffuseTexture?.()){const c=["Diffuse",a.getProperty().getDiffuseTexture()];s.push(c)}if(a.getTextures()[0]){const c=["Diffuse",a.getTextures()[0]];s.push(c)}if(e.colorTexture){const c=["Diffuse",e.colorTexture];s.push(c)}if(a.getProperty().getRoughnessTexture?.()){const c=["Roughness",a.getProperty().getRoughnessTexture()];s.push(c)}if(a.getProperty().getMetallicTexture?.()){const c=["Metallic",a.getProperty().getMetallicTexture()];s.push(c)}if(a.getProperty().getNormalTexture?.()){const c=["Normal",a.getProperty().getNormalTexture()];s.push(c)}if(a.getProperty().getAmbientOcclusionTexture?.()){const c=["AmbientOcclusion",a.getProperty().getAmbientOcclusionTexture()];s.push(c)}if(a.getProperty().getEmissionTexture?.()){const c=["Emission",a.getProperty().getEmissionTexture()];s.push(c)}if(o.getEnvironmentTexture?.()){const c=["Environment",o.getEnvironmentTexture()];s.push(c)}for(let c=0;c<s.length;c++)(s[c][1].getInputData()||s[c][1].getJsImageData()||s[c][1].getCanvas())&&r.push(s[c]),s[c][1].getImage()&&s[c][1].getImageLoaded()&&r.push(s[c]);for(let c=0;c<r.length;c++){const l=r[c][1],f=r[c][0],u=e.device.getTextureManager().getTextureForVTKTexture(l);if(u.getReady()){let h=!1;for(let p=0;p<e.textures.length;p++)e.textures[p]===u&&(h=!0,n[p]=!0);if(!h){n[e.textures.length]=!0;const p=u.createView(`${f}Texture`);e.textures.push(u),e.textureViews.push(p);const d=l.getInterpolate()?"linear":"nearest";let g=null;!g&&l.getEdgeClamp()&&l.getRepeat()&&(g="mirror-repeat"),!g&&l.getEdgeClamp()&&(g="clamp-to-edge"),!g&&l.getRepeat()&&(g="repeat"),f!=="Environment"?p.addSampler(e.device,{addressModeU:g,addressModeV:g,addressModeW:g,minFilter:d,magFilter:d}):p.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:d,magFilter:d,mipmapFilter:"linear"})}}}for(let c=e.textures.length-1;c>=0;c--)n[c]||(e.textures.splice(c,1),e.textureViews.splice(c,1))},t.computePipelineHash=()=>{let n=`pd${e.useRendererMatrix?"r":""}${e.forceZValue?"z":""}`;if(e.primitiveType===Or.TriangleEdges||e.primitiveType===Or.TriangleStripEdges)n+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(n+="n"),e.vertexInput.hasAttribute("colorVI")&&(n+="c"),e.vertexInput.hasAttribute("tcoord")){const i=e.vertexInput.getBuffer("tcoord"),a=ir.getNumberOfComponentsFromBufferFormat(i.getArrayInformation()[0].format);n+=`t${a}`}e.textures.length&&(n+=`tx${e.textures.length}`)}e._usesCellNormals&&(n+="cn"),e.SSBO&&(n+="ssbo");const r=t.getHashFromUsage(e.usage);n+=r,n+=e.renderEncoder.getPipelineHash(),e.pipelineHash=n},t.updateBuffers=()=>{e.primitiveType!==Or.TriangleEdges&&e.primitiveType!==Or.TriangleStripEdges&&t.updateTextures();const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();e.usage=t.getUsage(r,e.primitiveType),t.buildVertexInput();const i=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(i.getSizeInBytes()/i.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){const a=n.getProperty();t.setNumberOfInstances(Math.ceil(a.getLineWidth()*2))}else t.setNumberOfInstances(1)}}const rj={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function Ow(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rj,n),M8.extend(t,e,n),e.fragmentShaderTemplate=tj,e.vertexShaderTemplate=ej,e._tmpMat3=wi(new Float64Array(9)),e._tmpMat4=ut(new Float64Array(16)),e.UBO=Ic.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),bn(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],nj(t,e)}const ij=kt(Ow,"vtkWebGPUCellArrayMapper");var Rw={newInstance:ij,extend:Ow};const{PrimitiveTypes:N0}=ru;function aj(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=()=>Rw.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=N0.Points;o<=N0.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(let o=N0.TriangleEdges;o<=N0.TriangleStripEdges;o++)if(r[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o-2]),s.setCurrentInput(n),s.setCellOffset(e.primitives[o-2].getCellOffset()),s.setPrimitiveType(o),s.setRenderable(e.renderable),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}const oj={primitives:null};function sj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oj,n),en.extend(t,e,n),e.primitives=[],aj(t,e)}const cj=kt(sj,"vtkWebGPUPolyDataMapper");Ci("vtkMapper",cj);const{PrimitiveTypes:Iy}=ru;function uj(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=()=>Rw.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let a=0;for(let o=Iy.Points;o<=Iy.Triangles;o++)if(r[o].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());const s=e.primitives[o];s.setCellArray(r[o]),s.setCurrentInput(n),s.setCellOffset(a),s.setPrimitiveType(o),s.setRenderable(e.renderable),s.setIs2D(!0),a+=r[o].getNumberOfCells(),i.push(s)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(i),t.removeUnusedNodes()}}function lj(t){return{primitives:[],...t}}function fj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lj(n)),en.extend(t,e,n),e.primitives=[],uj(t,e)}const hj=kt(fj,"vtkWebGPUPolyDataMapper2D");Ci("vtkMapper2D",hj);function pj(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,a=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([a.usize,a.vsize],i,e.WebGPURenderWindow.getRenderable())}}}const dj={};function gj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dj,n),en.extend(t,e,n),e.scalarBarActorHelper=Dw.newScalarBarActorHelper(),pj(t,e)}const mj=kt(gj,"vtkWebGPUScalarBarActor");Ci("vtkScalarBarActor",mj);function vj(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=(n,r)=>{e.texture=n,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ir.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=i.sampleType},t.createFromTextureHandle=(n,r)=>{e.texture=null,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const i=ir.getDetailsFromTextureFormat(r.format);e.bindGroupLayoutEntry.texture.sampleType=i.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=()=>({resource:t.getHandle()}),t.getShaderCode=(n,r)=>{let i="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?i="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(i="u32");let a=`@binding(${n}) @group(${r}) var ${e.label}: texture_${e.options.dimension}<${i}>;`;return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(a=`@binding(${n}) @group(${r}) var ${e.label}: texture_depth_${e.options.dimension};`),a},t.addSampler=(n,r)=>{const i=k8.newInstance({label:`${e.label}Sampler`});i.create(n,r),t.setSampler(i)},t.getBindGroupTime=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime),t.getHandle=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle)}const yj={texture:null,handle:null,sampler:null,label:null};function Mw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yj,n),J.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},J.obj(e.bindGroupTime,{mtime:0}),J.get(t,e,["bindGroupTime","texture"]),J.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),vj(t,e)}const xj=J.newInstance(Mw);var wj={newInstance:xj,extend:Mw};const{BufferUsage:Py}=ru;function Cj(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=(n,r)=>{e.device=n,e.width=r.width,e.height=r.height,e.depth=r.depth?r.depth:1;const i=e.depth===1?"2d":"3d";e.format=r.format?r.format:"rgba8unorm",e.mipLevel=r.mipLevel?r.mipLevel:0,e.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:i,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=(n,r,i)=>{e.device=n,e.handle=r,e.width=i.width,e.height=i.height,e.depth=i.depth?i.depth:1,e.format=i.format?i.format:"rgba8unorm",e.usage=i.usage?i.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=n=>{let r=[];if(n.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:n.canvas,flipY:n.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}n.jsImageData&&!n.nativeArray&&(n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,n.nativeArray=n.jsImageData.data);const i=ir.getDetailsFromTextureFormat(e.format);let a=e.width*i.stride;const o=(c,l,f)=>{const u=c.length/(l*f)*c.BYTES_PER_ELEMENT,h=i.elementSize===2&&i.sampleType==="float";if(h||u%256){const p=c,d=u/p.BYTES_PER_ELEMENT,g=i.elementSize,y=256*Math.floor((d*g+255)/256),x=y/g,m=J.newTypedArray(h?"Uint16Array":p.constructor.name,x*l*f);for(let v=0;v<l*f;v++)if(h)for(let w=0;w<d;w++)m[v*x+w]=Ks.toHalf(p[v*d+w]);else m.set(p.subarray(v*d,(v+1)*d),v*x);return[m,y]}return[c,u]};if(n.nativeArray&&(r=n.nativeArray),n.image){const c=document.createElement("canvas");c.width=n.image.width,c.height=n.image.height;const l=c.getContext("2d");l.translate(0,c.height),l.scale(1,-1),l.drawImage(n.image,0,0,n.image.width,n.image.height,0,0,c.width,c.height),r=l.getImageData(0,0,n.image.width,n.image.height).data}const s=e.device.createCommandEncoder();if(t.getDimensionality()!==3){const c=cu.generateMipmaps(r,e.width,e.height,e.mipLevel);let l=e.width,f=e.height;for(let u=0;u<=e.mipLevel;u++){const h=o(c[u],f,1);a=h[1];const p={dataArray:n.dataArray?n.dataArray:null,nativeArray:h[0],usage:Py.Texture},d=e.device.getBufferManager().getBuffer(p);s.copyBufferToTexture({buffer:d.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:f},{texture:e.handle,mipLevel:u},[l,f,1]),l/=2,f/=2}e.device.submitCommandEncoder(s),e.ready=!0}else{const c=o(r,e.height,e.depth);a=c[1];const l={dataArray:n.dataArray?n.dataArray:null,usage:Py.Texture};l.nativeArray=c[0];const f=e.device.getBufferManager().getBuffer(l);s.copyBufferToTexture({buffer:f.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(s),e.ready=!0}},t.getScale=()=>{const n=ir.getDetailsFromTextureFormat(e.format);return n.elementSize===2&&n.sampleType==="float"?1:255},t.getNumberOfComponents=()=>ir.getDetailsFromTextureFormat(e.format).numComponents,t.getDimensionality=()=>{let n=0;return e.width>1&&n++,e.height>1&&n++,e.depth>1&&n++,n},t.resizeToMatch=n=>{(n.getWidth()!==e.width||n.getHeight()!==e.height||n.getDepth()!==e.depth)&&(e.width=n.getWidth(),e.height=n.getHeight(),e.depth=n.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(n!==e.width||r!==e.height||i!==e.depth)&&(e.width=n,e.height=r,e.depth=i,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r.dimension||(r.dimension=e.depth===1?"2d":"3d");const i=wj.newInstance({label:n});return i.create(t,r),i}}const Tj={device:null,handle:null,buffer:null,ready:!1,label:null};function _j(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Tj,n),J.obj(t,e),J.get(t,e,["handle","ready","width","height","depth","format","usage"]),J.setGet(t,e,["device","label"]),Cj(t,e)}J.newInstance(_j);function Sj(t){if(!t||t.data.length===0)throw new Error("Invalid contour set data, see publicContourSetData type for more info");if(!t.id)throw new Error("Invalid contour set data, each contour set must have an id");if(!t.data||!Array.isArray(t.data))throw new Error("Invalid contour set data, each contour set must have an array of contours");t.data.forEach(e=>{if(!e.points||!Array.isArray(e.points))throw new Error("Invalid contour set data, each contour must have an array of points");e.points.forEach(n=>{if(!n||!Array.isArray(n)||n.length!==3)throw new Error("Invalid contour set data, each point must be an array of length 3")})})}class Vy{constructor(e){const{points:n,type:r}=e.data;this.id=e.id,this._points=n,this._type=r,this._color=e.color,this._segmentIndex=e.segmentIndex,this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){return this._points.length*3}get points(){return this._points}set points(e){this._points=e}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}set type(e){this._type=e}get segmentIndex(){return this._segmentIndex}set segmentIndex(e){this._segmentIndex=e}get flatPointsArray(){return this._points.map(e=>[...e]).flat()}}class bj{constructor(e){this._color=[200,0,0],this.id=e.id,this._contours=[],this._color=e.color??this._color,this.frameOfReferenceUID=e.frameOfReferenceUID,this._segmentIndex=e.segmentIndex,this._createEachContour(e.data),this.sizeInBytes=this._getSizeInBytes()}_createEachContour(e){e.forEach(n=>{const{points:r,type:i,color:a}=n,o=new Vy({id:`${this.id}-segment-${this._segmentIndex}`,data:{points:r,type:i,segmentIndex:this._segmentIndex,color:a??this._color},segmentIndex:this._segmentIndex,color:a??this._color});this._contours.push(o)}),this._updateContourSetCentroid()}_updateContourSetCentroid(){const e=this.totalNumberOfPoints,n=this.flatPointsArray,r=n.reduce((o,s)=>[o[0]+s[0],o[1]+s[1],o[2]+s[2]],[0,0,0]),i=[r[0]/e,r[1]/e,r[2]/e],a=n.reduce((o,s)=>{const c=this._getDistance(i,s),l=this._getDistance(i,o);return c<l?s:o},n[0]);this._centroid=a}_getSizeInBytes(){return this._contours.reduce((e,n)=>e+n.sizeInBytes,0)}_getDistance(e,n){return Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2+(e[2]-n[2])**2)}get centroid(){return this._centroid}get segmentIndex(){return this._segmentIndex}get color(){return this._color}set color(e){this._color=e,this._contours.forEach(n=>{n instanceof Vy&&(n.color=e)})}get contours(){return this._contours}get flatPointsArray(){return this._contours.flatMap(e=>e.points)}get numberOfContours(){return this._contours.length}get totalNumberOfPoints(){return this._contours.reduce((e,n)=>e+n.points.length,0)}get numberOfPointsArray(){return this._contours.map(e=>e.points.length)}getPointsInContour(e){return this._contours[e].points}getNumberOfPointsInAContour(e){return this.getPointsInContour(e).length}}function Ej(t,e){Sj(e);const n=new bj({id:e.id,data:e.data,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:Ya.CONTOUR,data:n,sizeInBytes:n.sizeInBytes}}function Dj(t){if(!t.id)throw new Error("Surface must have an id");if(t.points?.length===0)throw new Error("Surface must have non-empty points array");if(t.polys?.length===0)throw new Error("Surface must have non-empty polys array");if(!t.frameOfReferenceUID)throw new Error("Surface must have a frameOfReferenceUID")}function Oj(t,e){Dj(e);const n=new F9({id:e.id,points:e.points,polys:e.polys,color:e.color,frameOfReferenceUID:e.frameOfReferenceUID,segmentIndex:e.segmentIndex??1});return{id:t,type:Ya.SURFACE,data:n,sizeInBytes:n.sizeInBytes}}function Rj(t){if(!t.id)throw new Error("Mesh must have an id");if(!t.arrayBuffer)throw new Error("Mesh must have an arrayBuffer");if(!(t.format in ai))throw new Error(`Mesh format must be one of the following: ${Object.values(ai).join(", ")}`)}function Mj(t,e){e.classHierarchy.push("vtkMTLReader");function n(){e.requestCount--,e.requestCount===0&&t.invokeBusy(!1)}function r(a){if(a[0]==="#"||a.length===0)return;const o=a.split(/[ \t]+/).map(s=>s.trim()).filter(s=>s.length);if(o[0]==="newmtl")o.shift(),e.currentMaterial=o.join(" ").trim();else if(e.currentMaterial){if(o.length<2)return;if(e.materials[e.currentMaterial]||(e.materials[e.currentMaterial]={}),e.materials[e.currentMaterial][o[0]]=o.slice(1),o[0]==="map_Kd"){const s=new Image;s.onload=()=>setTimeout(n,0),s.src=[e.baseURL,o[1]].join("/"),e.materials[e.currentMaterial].image=s,e.requestCount++}}}e.dataAccessHelper||(e.dataAccessHelper=zl.get("http"));function i(a,o){return e.dataAccessHelper.fetchText(t,a,o)}t.setUrl=function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(a.indexOf(".mtl")===-1&&!o.fullpath)e.baseURL=a,e.url=`${a}/index.mtl`;else{e.url=a;const s=a.split("/");s.pop(),e.baseURL=s.join("/")}return t.loadData(o)},t.loadData=a=>new Promise((o,s)=>{i(e.url,a).then(c=>{t.parseAsText(c),o()},c=>{s()})}),t.parseAsText=a=>{t.modified(),e.materials={},a.split(`
`).forEach(r)},t.isBusy=()=>!!e.requestCount,t.getMaterialNames=()=>Object.keys(e.materials),t.getMaterial=a=>e.materials[a],t.listImages=()=>Object.keys(e.materials).map(a=>e.materials[a].map_Kd).filter(a=>!!a).map(a=>a[0].trim()),t.setImageSrc=(a,o)=>new Promise((s,c)=>{const l=Object.keys(e.materials).find(u=>e.materials[u].map_Kd&&e.materials[u].map_Kd[0].trim()===a.trim()),f=e.materials[l];f&&f.image?(f.image.src=o,f.image.onload=()=>setTimeout(s,0)):s()}),t.applyMaterialToActor=(a,o)=>{const s=e.materials[a];if(s&&o){const c=[1,1,1],l={ambientColor:s.Ka?s.Ka.map(u=>Number(u)):c,specularColor:s.Ks?s.Ks.map(u=>Number(u)):c,diffuseColor:s.Kd?s.Kd.map(u=>Number(u)):c,opacity:s.d?Number(s.d):1,specularPower:s.Ns?Number(s.Ns):1},f=Number(s.illum||2);if(["ambient","diffuse","specular"].forEach((u,h)=>{l[u]=h<=f?1:0}),s.image){const u=cu.newInstance({interpolate:e.interpolateTextures});u.setImage(s.image),o.addTexture(u)}o.getProperty().set(l)}}}const Nj={numberOfOutputs:1,requestCount:0,materials:{},interpolateTextures:!0};function Nw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Nj,n),an(t,e),mr(t,e,["url","baseURL"]),bn(t,e,["dataAccessHelper","interpolateTextures","splitGroup"]),Wg(t,e,"busy"),Mj(t,e)}const Lj=kt(Nw,"vtkMTLReader");var Aj={newInstance:Lj,extend:Nw};function Lw(t,e){Rj(e);const n=new NB({...e}),r={id:t,type:Ya.MESH,data:n,sizeInBytes:n.sizeInBytes};switch(e.format){case ai.PLY:if(e.materialUrl){const i=new Image;return new Promise((a,o)=>{i.onload=()=>{try{const s=cu.newInstance();s.setInterpolate(!0),s.setImage(i),n.defaultActor.addTexture(s),a(r)}catch(s){o(s)}},i.onerror=s=>o(s),i.src=e.materialUrl})}return Promise.resolve(r);case ai.OBJ:if(e.materialUrl){const i=Aj.newInstance();return i.setUrl(e.materialUrl).then(()=>{for(let a=0;a<n.actors.length;a++){const o=n.actors[a],s=o.getMapper();if(s){const c=s.getInputData();if(c){const l=c.get("name").name;i.applyMaterialToActor(l,o)}}}return r}).catch(a=>{throw new Error(`Failed to load material: ${a}`)})}return Promise.resolve(r);case ai.STL:case ai.VTP:return Promise.resolve(r);default:return Promise.reject(new Error(`Unsupported format: ${e.format}`))}}function Fj({url:t,signal:e,onload:n,loaderOptions:r}){return new Promise((i,a)=>{const o=new XMLHttpRequest;o.open("GET",t,!0);const s={},c=r.beforeSend(o,s),l=Object.assign({},s,c);o.responseType="arraybuffer",Object.keys(l).forEach(function(p){l[p]!==null&&o.setRequestHeader(p,l[p])});const f=function(p){n&&typeof n=="function"&&n(),e&&e.removeEventListener("abort",u),i(o.response)},u=()=>{o.abort(),o.removeEventListener("load",f),a(new Error("Request aborted"))};o.addEventListener("load",f);const h=(p,d)=>{const g={url:t,loaded:p,total:d};et(vt,Je.GEOMETRY_LOAD_PROGRESS,{data:g})};o.onprogress=function(p){h(p.loaded,p.total)},e&&e.aborted?(o.abort(),a(new Error("Request aborted"))):e&&e.addEventListener("abort",u),o.send()})}function Aw(t,e,n){return{promise:new Promise((i,a)=>{Ij(t,e,n).then(i).catch(a)}),cancelFn:void 0,decache:()=>{}}}async function Ij(t,e,n){const i=t.split(":").slice(1).join(":"),a=await Fj({url:i,loaderOptions:n});if(!e||!("geometryData"in e))throw new Error("Mesh must have a geometryData");return Lw(i,{...e.geometryData,arrayBuffer:a})}let ih={beforeSend(t){}};function Pj(t){ih=Object.assign(ih,t)}function Vj(){return ih}const Fw={};let Zu;function Iw(t,e){const n=t.indexOf(":"),r=t.substring(0,n);let i=Fw[r];if(i==null){if(Zu==null||typeof Zu!="function")throw new Error(`No geometry loader for scheme ${r} has been registered`);i=Zu}const a=i(t,e,ih);return a.promise.then(function(o){et(vt,Je.GEOMETRY_LOADED,{geometry:o})},function(o){const s={geometryId:t,error:o};et(vt,Je.GEOMETRY_LOADED_FAILED,s)}),a}function kj(t,e){if(t===void 0)throw new Error("loadGeometry: parameter geometryId must not be undefined");let n=at.getGeometryLoadObject(t);return n!==void 0||(n=Iw(t,e)),n.promise}async function Uj(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=at.getGeometryLoadObject(t);return n!==void 0||(n=Iw(t,e),await at.putGeometryLoadObject(t,n)),n.promise}function Bj(t,e){if(t===void 0)throw new Error("createAndCacheGeometry: parameter geometryId must not be undefined");let n=at.getGeometry(t);if(n)return n;if(e.type===Ya.CONTOUR)n=Ej(t,e.geometryData);else if(e.type===Ya.SURFACE)n=Oj(t,e.geometryData);else if(e.type===Ya.MESH)Lw(t,e.geometryData).then(r=>{n=r});else throw new Error(`Unknown geometry type: ${e.type}`);return at.putGeometrySync(t,n),n}function Pw(t,e){Fw[t]=e}function Gj(t){const e=Zu;return Zu=t,e}Pw("mesh",Aw);const Wj=Object.freeze(Object.defineProperty({__proto__:null,createAndCacheGeometry:Bj,getOptions:Vj,loadAndCacheGeometry:Uj,loadGeometry:kj,registerGeometryLoader:Pw,registerUnknownGeometryLoader:Gj,setOptions:Pj},Symbol.toStringTag,{value:"Module"}));function zj(t,e){if(!e||!e.imageIds||!e.imageIds.length)throw new Error("ImageIds must be provided to create a 4D streaming image volume");const{imageIds:n}=e,{splittingTag:r,imageIdGroups:i}=d2(n),a=Math.floor(i.length/2),o=Ih(i[a],t),{metadata:s,dimensions:c,spacing:l,direction:f,sizeInBytes:u,origin:h,numberOfComponents:p,dataType:d}=o,g=f.slice(6,9),y=i.map(w=>$1(w,g).sortedImageIds),x=y.flat(),m=rn.createScalarDynamicVolumeVoxelManager({dimensions:c,imageIdGroups:y,dimensionGroupNumber:1,numberOfComponents:p});let v=new cw({volumeId:t,metadata:s,dimensions:c,spacing:l,origin:h,direction:f,sizeInBytes:u,imageIds:x,imageIdGroups:y,splittingTag:r,voxelManager:m,numberOfComponents:p,dataType:d},{imageIds:x,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}});return{promise:Promise.resolve(v),decache:()=>{v.destroy(),v=null},cancel:()=>{v.cancelLoading()}}}const jj=Object.freeze(Object.defineProperty({__proto__:null,BaseRenderingEngine:o2,BaseVolumeViewport:au,CONSTANTS:Q5,ContextPoolRenderingEngine:ng,EPSILON:Jd,EVENTS:Je,Enums:ph,ImageVolume:iu,ProgressiveRetrieveImages:ml,RenderingEngine:A9,Settings:yn,StackViewport:io,StreamingDynamicImageVolume:cw,StreamingImageVolume:q6,Surface:F9,TiledRenderingEngine:s2,VideoViewport:Kf,Viewport:uc,VolumeViewport:lc,VolumeViewport3D:kh,WSIViewport:qf,addImageSlicesToViewports:Hk,addVolumesToViewports:$k,cache:at,canRenderFloatTextures:dh,convertMapperToNotSharedMapper:ZP,cornerstoneMeshLoader:Aw,cornerstoneStreamingDynamicImageVolumeLoader:zj,cornerstoneStreamingImageVolumeLoader:X6,createCanvas:Wl,createViewportElement:b9,createVolumeActor:Xd,createVolumeMapper:n9,eventTarget:vt,geometryLoader:Wj,getConfiguration:hc,getEnabledElement:$l,getEnabledElementByIds:p2,getEnabledElementByViewportId:oG,getEnabledElements:sG,getOrCreateCanvas:oi,getRenderingEngine:Ol,getRenderingEngines:is,getShouldUseCPURendering:Ac,getWebWorkerManager:p3,imageLoadPoolManager:Pr,imageLoader:kP,imageRetrievalPoolManager:Hl,init:H7,isCornerstoneInitialized:h3,metaData:V6,peerImport:d3,registerImageLoader:j1,requestPoolManager:Pr,resetInitialization:J7,resetUseCPURendering:Y7,setCanvasCreator:ak,setConfiguration:Z7,setPreferSizeOverAccuracy:X7,setUseCPURendering:q7,setVolumesForViewports:N9,triggerEvent:et,utilities:$G,version:Qk,volumeLoader:JP},Symbol.toStringTag,{value:"Module"}));function $j(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++)e[a++]=t[i++],e[a++]=t[i++],e[a++]=t[i++],e[a++]=255;return}e.set(t)}function Hj(t,e,n){if(t===void 0)throw new Error("decodeRGB: rgbBuffer must be defined");if(t.length%3!==0)throw new Error(`decodeRGB: rgbBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n)for(let c=0;c<r;c++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++],e[i++]=255;else for(let c=0;c<r;c++)e[i++]=t[a++],e[i++]=t[o++],e[i++]=t[s++]}function Kj(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPixel: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPixel: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0;if(n){for(let o=0;o<r;o++){const s=t[i++],c=t[i++],l=t[i++];e[a++]=s+1.402*(l-128),e[a++]=s-.34414*(c-128)-.71414*(l-128),e[a++]=s+1.772*(c-128),e[a++]=255}return}for(let o=0;o<r;o++){const s=t[i++],c=t[i++],l=t[i++];e[a++]=s+1.402*(l-128),e[a++]=s-.34414*(c-128)-.71414*(l-128),e[a++]=s+1.772*(c-128)}}function qj(t,e,n){if(t===void 0)throw new Error("convertYBRFullByPlane: ybrBuffer must be defined");if(t.length%3!==0)throw new Error(`convertYBRFullByPlane: ybrBuffer length ${t.length} must be divisible by 3`);const r=t.length/3;let i=0,a=0,o=r,s=r*2;if(n){for(let c=0;c<r;c++){const l=t[a++],f=t[o++],u=t[s++];e[i++]=l+1.402*(u-128),e[i++]=l-.34414*(f-128)-.71414*(u-128),e[i++]=l+1.772*(f-128),e[i++]=255}return}for(let c=0;c<r;c++){const l=t[a++],f=t[o++],u=t[s++];e[i++]=l+1.402*(u-128),e[i++]=l-.34414*(f-128)-.71414*(u-128),e[i++]=l+1.772*(f-128)}}function Xj(t,e,n){if(t===void 0)throw new Error("convertYBRFull422ByPixel: ybrBuffer must be defined");if(t.length%2!==0)throw new Error(`convertYBRFull422ByPixel: ybrBuffer length ${t.length} must be divisible by 2`);const r=t.length/2;let i=0,a=0;if(n){for(let o=0;o<r;o+=2){const s=t[i++],c=t[i++],l=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(l-128)-.71414*(f-128),e[a++]=s+1.772*(l-128),e[a++]=255,e[a++]=c+1.402*(f-128),e[a++]=c-.34414*(l-128)-.71414*(f-128),e[a++]=c+1.772*(l-128),e[a++]=255}return}for(let o=0;o<r;o+=2){const s=t[i++],c=t[i++],l=t[i++],f=t[i++];e[a++]=s+1.402*(f-128),e[a++]=s-.34414*(l-128)-.71414*(f-128),e[a++]=s+1.772*(l-128),e[a++]=c+1.402*(f-128),e[a++]=c-.34414*(l-128)-.71414*(f-128),e[a++]=c+1.772*(l-128)}}function Qp(t,e){const n=t.length,r=new Uint8ClampedArray(n);for(let i=0;i<n;++i)r[i]=t[i]>>e;return r}function ed(t,e,n){const r=t[`${e}PaletteColorLookupTableData`];if(r)return Promise.resolve(r);const i=nt("imagePixelModule",t.imageId);return i&&typeof i.then=="function"?i.then(a=>a?a[`${e}PaletteColorLookupTableData`]:n):Promise.resolve(i?i[`${e}PaletteColorLookupTableData`]:n)}function Yj(t,e,n){const r=t.columns*t.rows,i=t.pixelData;Promise.all([ed(t,"red",null),ed(t,"green",null),ed(t,"blue",null)]).then(([a,o,s])=>{if(!a||!o||!s)throw new Error("The image does not have a complete color palette. R, G, and B palette data are required.");const c=a.length;let l=0,f=0;const u=t.redPaletteColorLookupTableDescriptor[1],h=t.redPaletteColorLookupTableDescriptor[2]===8?0:8,p=Qp(a,h),d=Qp(o,h),g=Qp(s,h);if(n){for(let y=0;y<r;++y){let x=i[l++];x<u?x=0:x>u+c-1?x=c-1:x-=u,e[f++]=p[x],e[f++]=d[x],e[f++]=g[x],e[f++]=255}return}for(let y=0;y<r;++y){let x=i[l++];x<u?x=0:x>u+c-1?x=c-1:x-=u,e[f++]=p[x],e[f++]=d[x],e[f++]=g[x]}})}var sf={exports:{}};/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */var Jj=sf.exports,ky;function Zj(){return ky||(ky=1,function(t,e){(function(n,r){t.exports=r(da)})(Jj,function(n){return i=[function(o,s){o.exports=n},function(o,s,c){c.r(s),c.d(s,"isStringVr",function(){return f}),c.d(s,"isPrivateTag",function(){return u}),c.d(s,"parsePN",function(){return h}),c.d(s,"parseTM",function(){return p}),c.d(s,"parseDA",function(){return g}),c.d(s,"explicitElementToString",function(){return y}),c.d(s,"explicitDataSetToJS",function(){return x}),c.d(s,"createJPEGBasicOffsetTable",function(){return w}),c.d(s,"parseDicomDataSetExplicit",function(){return ae}),c.d(s,"parseDicomDataSetImplicit",function(){return fe}),c.d(s,"readFixedString",function(){return S}),c.d(s,"alloc",function(){return Ee}),c.d(s,"version",function(){return ge}),c.d(s,"bigEndianByteArrayParser",function(){return be}),c.d(s,"ByteStream",function(){return Ce}),c.d(s,"sharedCopy",function(){return Re}),c.d(s,"DataSet",function(){return E}),c.d(s,"findAndSetUNElementLength",function(){return _}),c.d(s,"findEndOfEncapsulatedElement",function(){return T}),c.d(s,"findItemDelimitationItemAndSetElementLength",function(){return R}),c.d(s,"littleEndianByteArrayParser",function(){return P}),c.d(s,"parseDicom",function(){return L}),c.d(s,"readDicomElementExplicit",function(){return ie}),c.d(s,"readDicomElementImplicit",function(){return M}),c.d(s,"readEncapsulatedImageFrame",function(){return me}),c.d(s,"readEncapsulatedPixelData",function(){return _e}),c.d(s,"readEncapsulatedPixelDataFromFragments",function(){return $}),c.d(s,"readPart10Header",function(){return O}),c.d(s,"readSequenceItemsExplicit",function(){return B}),c.d(s,"readSequenceItemsImplicit",function(){return Y}),c.d(s,"readSequenceItem",function(){return U}),c.d(s,"readTag",function(){return C});var l={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},f=function(K){return l[K]},u=function(K){if(K=parseInt(K[4],16),isNaN(K))throw"dicomParser.isPrivateTag: cannot parse last character of group";return K%2==1},h=function(K){if(K!==void 0)return K=K.split("^"),{familyName:K[0],givenName:K[1],middleName:K[2],prefix:K[3],suffix:K[4]}};function p(K,ne){if(2<=K.length){var ce=parseInt(K.substring(0,2),10),re=4<=K.length?parseInt(K.substring(2,4),10):void 0,ue=6<=K.length?parseInt(K.substring(4,6),10):void 0,De=8<=K.length?K.substring(7,13):void 0,De=De?parseInt(De,10)*Math.pow(10,6-De.length):void 0;if(ne&&(isNaN(ce)||re!==void 0&&isNaN(re)||ue!==void 0&&isNaN(ue)||De!==void 0&&isNaN(De)||ce<0||23<ce||re&&(re<0||59<re)||ue&&(ue<0||59<ue)||De&&(De<0||999999<De)))throw"invalid TM '".concat(K,"'");return{hours:ce,minutes:re,seconds:ue,fractionalSeconds:De}}if(ne)throw"invalid TM '".concat(K,"'")}function d(K,ne,ce){return!isNaN(ce)&&0<ne&&ne<=12&&0<K&&K<=function(re,ue){switch(re){case 2:return ue%4==0&&ue%100||ue%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(ne,ce)}function g(K,ne){if(K&&K.length===8){var ce=parseInt(K.substring(0,4),10),re=parseInt(K.substring(4,6),10),ue=parseInt(K.substring(6,8),10);if(ne&&d(ue,re,ce)!==!0)throw"invalid DA '".concat(K,"'");return{year:ce,month:re,day:ue}}if(ne)throw"invalid DA '".concat(K,"'")}function y(K,ne){if(K===void 0||ne===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(ne.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var ce,re=ne.vr,ue=ne.tag;function De(Ue,Ye){for(var qe="",xe=0;xe<Ue;xe++)xe!==0&&(qe+="/"),qe+=Ye.call(K,ue,xe).toString();return qe}if(f(re)===!0)ce=K.string(ue);else{if(re==="AT"){var te=K.uint32(ue);return te===void 0?void 0:"x".concat((te=te<0?4294967295+te+1:te).toString(16).toUpperCase())}re==="US"?ce=De(ne.length/2,K.uint16):re==="SS"?ce=De(ne.length/2,K.int16):re==="UL"?ce=De(ne.length/4,K.uint32):re==="SL"?ce=De(ne.length/4,K.int32):re==="FD"?ce=De(ne.length/8,K.double):re==="FL"&&(ce=De(ne.length/4,K.float))}return ce}function x(K,ne){if(K===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";ne=ne||{omitPrivateAttibutes:!0,maxElementLength:128};var ce,re={};for(ce in K.elements){var ue=K.elements[ce];if(ne.omitPrivateAttibutes!==!0||!u(ce))if(ue.items){for(var De=[],te=0;te<ue.items.length;te++)De.push(x(ue.items[te].dataSet,ne));re[ce]=De}else{var Ue=void 0;ue.length<ne.maxElementLength&&(Ue=y(K,ue)),re[ce]=Ue!==void 0?Ue:{dataOffset:ue.dataOffset,length:ue.length}}}return re}function m(K,ne){return K.byteArray[ne]===255&&K.byteArray[ne+1]===217}function v(K,ne,ce){for(var re,ue,De=ce;De<ne.fragments.length;De++)if(re=K,ue=De,ue=ne.fragments[ue],!(!m(re,ue.position+ue.length-2)&&!m(re,ue.position+ue.length-3)))return De}function w(K,ne,ce){if(K===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(ne===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(ne.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(ne.encapsulatedPixelData!==!0||ne.hadUndefinedLength!==!0||ne.basicOffsetTable===void 0||ne.fragments===void 0||ne.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(ce&&ce.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";ce=ce||ne.fragments;for(var re=[],ue=0;;){re.push(ne.fragments[ue].offset);var De=v(K,ne,ue);if(De===void 0||De===ne.fragments.length-1)return re;ue=De+1}}function C(ce){if(ce===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var ne=256*ce.readUint16()*256,ce=ce.readUint16();return"x".concat("00000000".concat((ne+ce).toString(16)).substr(-8))}function T(K,ne,ce){if(K===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(ne===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(ne.encapsulatedPixelData=!0,ne.basicOffsetTable=[],ne.fragments=[],C(K)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var re=K.readUint32()/4,ue=0;ue<re;ue++){var De=K.readUint32();ne.basicOffsetTable.push(De)}for(var te=K.position;K.position<K.byteArray.length;){var Ue=C(K),Ye=K.readUint32();if(Ue==="xfffee0dd")return K.seek(Ye),void(ne.length=K.position-ne.dataOffset);if(Ue!=="xfffee000")return ce&&ce.push("unexpected tag ".concat(Ue," while searching for end of pixel data element with undefined length")),Ye>K.byteArray.length-K.position&&(Ye=K.byteArray.length-K.position),ne.fragments.push({offset:K.position-te-8,position:K.position,length:Ye}),K.seek(Ye),void(ne.length=K.position-ne.dataOffset);ne.fragments.push({offset:K.position-te-8,position:K.position,length:Ye}),K.seek(Ye)}ce&&ce.push("pixel data element ".concat(ne.tag," missing sequence delimiter tag xfffee0dd"))}function _(K,ne){if(K===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var ce=K.byteArray.length-8;K.position<=ce;)if(K.readUint16()===65534){var re=K.readUint16();if(re===57565)return K.readUint32()!==0&&K.warnings("encountered non zero length following item delimiter at position ".concat(K.position-4," while reading element of undefined length with tag ").concat(ne.tag)),void(ne.length=K.position-ne.dataOffset)}ne.length=K.byteArray.length-ne.dataOffset,K.seek(K.byteArray.length-K.position)}function S(K,ne,ce){if(ce<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(ne+ce>K.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var re,ue="",De=0;De<ce;De++){if((re=K[ne+De])===0)return ne+=ce,ue;ue+=String.fromCharCode(re)}return ue}function b(K,ne){for(var ce=0;ce<ne.length;ce++){var re=ne[ce];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(K,re.key,re)}}function D(K,ne){return K.parser!==void 0?K.parser:ne}var E=function(){function K(re,ue,De){(function(te,Ue){if(!(te instanceof Ue))throw new TypeError("Cannot call a class as a function")})(this,K),this.byteArrayParser=re,this.byteArray=ue,this.elements=De}var ne,ce;return ne=K,(ce=[{key:"uint16",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readUint16(this.byteArray,re.dataOffset+2*ue)}},{key:"int16",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readInt16(this.byteArray,re.dataOffset+2*ue)}},{key:"uint32",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readUint32(this.byteArray,re.dataOffset+4*ue)}},{key:"int32",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readInt32(this.byteArray,re.dataOffset+4*ue)}},{key:"float",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readFloat(this.byteArray,re.dataOffset+4*ue)}},{key:"double",value:function(re,ue){if(re=this.elements[re],ue=ue!==void 0?ue:0,re&&re.length!==0)return D(re,this.byteArrayParser).readDouble(this.byteArray,re.dataOffset+8*ue)}},{key:"numStringValues",value:function(re){if(re=this.elements[re],re&&0<re.length)return re=S(this.byteArray,re.dataOffset,re.length).match(/\\/g),re===null?1:re.length+1}},{key:"string",value:function(re,ue){if(re=this.elements[re],re&&re.Value)return re.Value;if(re&&0<re.length)return re=S(this.byteArray,re.dataOffset,re.length),0<=ue?re.split("\\")[ue].trim():re.trim()}},{key:"text",value:function(re,ue){if(re=this.elements[re],re&&0<re.length)return re=S(this.byteArray,re.dataOffset,re.length),0<=ue?re.split("\\")[ue].replace(/ +$/,""):re.replace(/ +$/,"")}},{key:"floatString",value:function(re,ue){var De=this.elements[re];if(De&&0<De.length&&(ue=this.string(re,ue=ue!==void 0?ue:0),ue!==void 0))return parseFloat(ue)}},{key:"intString",value:function(re,ue){var De=this.elements[re];if(De&&0<De.length&&(ue=this.string(re,ue=ue!==void 0?ue:0),ue!==void 0))return parseInt(ue)}},{key:"attributeTag",value:function(re){var ue=this.elements[re];if(ue&&ue.length===4){var De=D(ue,this.byteArrayParser).readUint16,re=this.byteArray,ue=ue.dataOffset;return"x".concat("00000000".concat((256*De(re,ue)*256+De(re,ue+2)).toString(16)).substr(-8))}}}])&&b(ne.prototype,ce),Object.defineProperty(ne,"prototype",{writable:!1}),K}();function R(K,ne){if(K===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var ce=K.byteArray.length-8;K.position<=ce;)if(K.readUint16()===65534){var re=K.readUint16();if(re===57357)return K.readUint32()!==0&&K.warnings("encountered non zero length following item delimiter at position ".concat(K.position-4," while reading element of undefined length with tag ").concat(ne.tag)),void(ne.length=K.position-ne.dataOffset)}ne.length=K.byteArray.length-ne.dataOffset,K.seek(K.byteArray.length-K.position)}var F=function(K,ne){return K.vr!==void 0?K.vr==="SQ":ne.position+4<=ne.byteArray.length?(K=C(ne),ne.seek(-4),K==="xfffee000"||K==="xfffee0dd"):(ne.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function M(K,ne,ce){if(K===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var re=C(K),re={tag:re,vr:ce!==void 0?ce(re):void 0,length:K.readUint32(),dataOffset:K.position};return re.length===4294967295&&(re.hadUndefinedLength=!0),re.tag===ne||(!F(re,K)||u(re.tag)&&!re.hadUndefinedLength?re.hadUndefinedLength?R(K,re):K.seek(re.length):(Y(K,re,ce),u(re.tag)&&(re.items=void 0))),re}function U(K){if(K===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var ne={tag:C(K),length:K.readUint32(),dataOffset:K.position};if(ne.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(K.position);return ne}function z(K,ne){var ce=U(K);return ce.length===4294967295?(ce.hadUndefinedLength=!0,ce.dataSet=function(re,ue){for(var De={};re.position<re.byteArray.length;){var te=M(re,void 0,ue);if((De[te.tag]=te).tag==="xfffee00d")return new E(re.byteArrayParser,re.byteArray,De)}return re.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new E(re.byteArrayParser,re.byteArray,De)}(K,ne),ce.length=K.position-ce.dataOffset):(ce.dataSet=new E(K.byteArrayParser,K.byteArray,{}),fe(ce.dataSet,K,K.position+ce.length,{vrCallback:ne})),ce}function Y(K,ne,ce){if(K===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(ne===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";ne.items=[],(ne.length===4294967295?function(re,ue,De){for(;re.position+4<=re.byteArray.length;){var te=C(re);if(re.seek(-4),te==="xfffee0dd")return ue.length=re.position-ue.dataOffset,re.seek(8);te=z(re,De),ue.items.push(te)}re.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),ue.length=re.byteArray.length-ue.dataOffset}:function(re,ue,De){for(var te=ue.dataOffset+ue.length;re.position<te;){var Ue=z(re,De);ue.items.push(Ue)}})(K,ne,ce)}function W(K,ne){var ce=U(K);return ce.length===4294967295?(ce.hadUndefinedLength=!0,ce.dataSet=function(re,ue){for(var De={};re.position<re.byteArray.length;){var te=ie(re,ue);if((De[te.tag]=te).tag==="xfffee00d")return new E(re.byteArrayParser,re.byteArray,De)}return ue.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new E(re.byteArrayParser,re.byteArray,De)}(K,ne),ce.length=K.position-ce.dataOffset):(ce.dataSet=new E(K.byteArrayParser,K.byteArray,{}),ae(ce.dataSet,K,K.position+ce.length)),ce}function B(K,ne,ce){if(K===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(ne===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";ne.items=[],(ne.length===4294967295?function(re,ue,De){for(;re.position+4<=re.byteArray.length;){var te=C(re);if(re.seek(-4),te==="xfffee0dd")return ue.length=re.position-ue.dataOffset,re.seek(8);te=W(re,De),ue.items.push(te)}De.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),ue.length=re.position-ue.dataOffset}:function(re,ue,De){for(var te=ue.dataOffset+ue.length;re.position<te;){var Ue=W(re,De);ue.items.push(Ue)}})(K,ne,ce)}var j=function(K){return K==="OB"||K==="OD"||K==="OL"||K==="OW"||K==="SQ"||K==="OF"||K==="UC"||K==="UR"||K==="UT"||K==="UN"?4:2};function ie(K,ne,ce){if(K===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var re={tag:C(K),vr:K.readFixedString(2)};return j(re.vr)===2?re.length=K.readUint16():(K.seek(2),re.length=K.readUint32()),re.dataOffset=K.position,re.length===4294967295&&(re.hadUndefinedLength=!0),re.tag===ce||(re.vr==="SQ"?B(K,re,ne):re.length===4294967295?re.tag==="x7fe00010"?T(K,re,ne):(re.vr==="UN"?Y:R)(K,re):K.seek(re.length)),re}function ae(K,ne,ce){var re=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(ce=ce===void 0?ne.byteArray.length:ce,ne===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(ce<ne.position||ce>ne.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var ue=K.elements;ne.position<ce;){var De=ie(ne,K.warnings,re.untilTag);if((ue[De.tag]=De).tag===re.untilTag)return}if(ne.position>ce)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function fe(K,ne,ce){var re=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(ce=ce===void 0?K.byteArray.length:ce,ne===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(ce<ne.position||ce>ne.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var ue=K.elements;ne.position<ce;){var De=M(ne,re.untilTag,re.vrCallback);if((ue[De.tag]=De).tag===re.untilTag)return}}function Ee(K,ne){if(typeof Buffer<"u"&&K instanceof Buffer)return Buffer.alloc(ne);if(K instanceof Uint8Array)return new Uint8Array(ne);throw"dicomParser.alloc: unknown type for byteArray"}var ge="1.8.12",be={readUint16:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(ne+2>K.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(K[ne]<<8)+K[ne+1]},readInt16:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(ne+2>K.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ne=(K[ne]<<8)+K[ne+1],ne=32768&ne?ne-65535-1:ne},readUint32:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(ne+4>K.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*K[ne]+K[ne+1])+K[ne+2])+K[ne+3]},readInt32:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(ne+4>K.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(K[ne]<<24)+(K[ne+1]<<16)+(K[ne+2]<<8)+K[ne+3]},readFloat:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(ne+4>K.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var ce=new Uint8Array(4);return ce[3]=K[ne],ce[2]=K[ne+1],ce[1]=K[ne+2],ce[0]=K[ne+3],new Float32Array(ce.buffer)[0]},readDouble:function(K,ne){if(ne<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(ne+8>K.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var ce=new Uint8Array(8);return ce[7]=K[ne],ce[6]=K[ne+1],ce[5]=K[ne+2],ce[4]=K[ne+3],ce[3]=K[ne+4],ce[2]=K[ne+5],ce[1]=K[ne+6],ce[0]=K[ne+7],new Float64Array(ce.buffer)[0]}};function Re(K,ne,ce){if(typeof Buffer<"u"&&K instanceof Buffer)return K.slice(ne,ne+ce);if(K instanceof Uint8Array)return new Uint8Array(K.buffer,K.byteOffset+ne,ce);throw"dicomParser.from: unknown type for byteArray"}function Ne(K,ne){for(var ce=0;ce<ne.length;ce++){var re=ne[ce];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(K,re.key,re)}}var Ce=function(){function K(re,ue,De){if(function(te,Ue){if(!(te instanceof Ue))throw new TypeError("Cannot call a class as a function")}(this,K),re===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(ue===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(ue instanceof Uint8Array)&&(typeof Buffer>"u"||!(ue instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(De<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(De>=ue.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=re,this.byteArray=ue,this.position=De||0,this.warnings=[]}var ne,ce;return ne=K,(ce=[{key:"seek",value:function(re){if(this.position+re<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=re}},{key:"readByteStream",value:function(re){if(this.position+re>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var ue=Re(this.byteArray,this.position,re);return this.position+=re,new K(this.byteArrayParser,ue)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var re=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,re}},{key:"readUint32",value:function(){var re=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,re}},{key:"readFixedString",value:function(re){var ue=S(this.byteArray,this.position,re);return this.position+=re,ue}}])&&Ne(ne.prototype,ce),Object.defineProperty(ne,"prototype",{writable:!1}),K}(),P={readUint16:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(ne+2>K.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return K[ne]+256*K[ne+1]},readInt16:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(ne+2>K.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return ne=K[ne]+(K[ne+1]<<8),ne=32768&ne?ne-65535-1:ne},readUint32:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(ne+4>K.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return K[ne]+256*K[ne+1]+256*K[ne+2]*256+256*K[ne+3]*256*256},readInt32:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(ne+4>K.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return K[ne]+(K[ne+1]<<8)+(K[ne+2]<<16)+(K[ne+3]<<24)},readFloat:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(ne+4>K.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var ce=new Uint8Array(4);return ce[0]=K[ne],ce[1]=K[ne+1],ce[2]=K[ne+2],ce[3]=K[ne+3],new Float32Array(ce.buffer)[0]},readDouble:function(K,ne){if(ne<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(ne+8>K.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var ce=new Uint8Array(8);return ce[0]=K[ne],ce[1]=K[ne+1],ce[2]=K[ne+2],ce[3]=K[ne+3],ce[4]=K[ne+4],ce[5]=K[ne+5],ce[6]=K[ne+6],ce[7]=K[ne+7],new Float64Array(ce.buffer)[0]}};function O(K){var ne=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(K===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var ce=ne.TransferSyntaxUID,re=new Ce(P,K);return function(){var ue=function(){if(re.getSize()<=132&&ce)return!1;if(re.seek(128),re.readFixedString(4)==="DICM")return!0;if(!(ne||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return re.seek(0),!1}(),De=[],te={};if(!ue)return re.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:ce}},warnings:De};for(;re.position<re.byteArray.length;){var Ue=re.position,Ye=ie(re,De);if("x0002ffff"<Ye.tag){re.position=Ue;break}Ye.parser=P,te[Ye.tag]=Ye}return(ue=new E(re.byteArrayParser,re.byteArray,te)).warnings=re.warnings,ue.position=re.position,ue}()}var A="1.2.840.10008.1.2.2";function L(K){var ne=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(K===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var ce,re=function(De){if(De.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return De=De.elements.x00020010,De&&De.Value||S(K,De.dataOffset,De.length)};function ue(Ye){var Ue=re(Ye),te=Ue!=="1.2.840.10008.1.2",Ue=function(qe,xe){var Fe=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(qe!=="1.2.840.10008.1.2.1.99")return new Ce(qe===A?be:P,K,xe);if(ne&&ne.inflater)return qe=ne.inflater(K,xe),new Ce(P,qe,0);if(Fe==!0){var ze=c(0),$e=Re(K,xe,K.length-xe),ze=ze.inflateRawSync($e),$e=Ee(K,ze.length+xe);return K.copy($e,0,0,xe),ze.copy($e,xe),new Ce(P,$e,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return ze=K.slice(xe),$e=pako.inflateRaw(ze),(ze=Ee(K,$e.length+xe)).set(K.slice(0,xe),0),ze.set($e,xe),new Ce(P,ze,0)}(Ue,Ye.position),Ye=new E(Ue.byteArrayParser,Ue.byteArray,{});Ye.warnings=Ue.warnings;try{(te?ae:fe)(Ye,Ue,Ue.byteArray.length,ne)}catch(qe){throw{exception:qe,dataSet:Ye}}return Ye}return function(De,te){for(var Ue in De.elements)De.elements.hasOwnProperty(Ue)&&(te.elements[Ue]=De.elements[Ue]);return De.warnings!==void 0&&(te.warnings=De.warnings.concat(te.warnings)),te}(ce=O(K,ne),ue(ce))}var k=function(K,ne,ce){for(var re=0,ue=ne;ue<ne+ce;ue++)re+=K[ue].length;return re};function $(K,te,ce,re,ue){if(ue=ue||te.fragments,K===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(te===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(ce===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((re=re||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(te.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(te.encapsulatedPixelData!==!0||te.hadUndefinedLength!==!0||te.basicOffsetTable===void 0||te.fragments===void 0||te.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(ce<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(ce>=te.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(re<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(ce+re>te.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var De=new Ce(K.byteArrayParser,K.byteArray,te.dataOffset),te=U(De);if(te.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";De.seek(te.length);var Ue=De.position;if(re===1)return Re(De.byteArray,Ue+ue[ce].offset+8,ue[ce].length);for(var te=k(ue,ce,re),Ye=Ee(De.byteArray,te),qe=0,xe=ce;xe<ce+re;xe++)for(var Fe=Ue+ue[xe].offset+8,ze=0;ze<ue[xe].length;ze++)Ye[qe++]=De.byteArray[Fe++];return Ye}var H=function(K,ne){for(var ce=0;ce<K.length;ce++)if(K[ce].offset===ne)return ce},se=function(K,ne,ce,re){if(K===ne.length-1)return ce.length-re;for(var ue=ne[K+1],De=re+1;De<ce.length;De++)if(ce[De].offset===ue)return De-re;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function me(K,ne,ce,re,ue){if(re=re||ne.basicOffsetTable,ue=ue||ne.fragments,K===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(ne===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(ce===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(re===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(ne.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(ne.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(ne.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(ne.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(re.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(ce<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(ce>=re.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var De=re[ce],De=H(ue,De);if(De===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return $(K,ne,De,se(ce,re,ue,De),ue)}var ye=!1;function _e(K,ne,ce){if(ye||(ye=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),K===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(ne===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(ce===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(ne.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(ne.encapsulatedPixelData!==!0||ne.hadUndefinedLength!==!0||ne.basicOffsetTable===void 0||ne.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(ce<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return ne.basicOffsetTable.length!==0?me(K,ne,ce):$(K,ne,0,ne.fragments.length)}s.default={isStringVr:f,isPrivateTag:u,parsePN:h,parseTM:p,parseDA:g,explicitElementToString:y,explicitDataSetToJS:x,createJPEGBasicOffsetTable:w,parseDicomDataSetExplicit:ae,parseDicomDataSetImplicit:fe,readFixedString:S,alloc:Ee,version:ge,bigEndianByteArrayParser:be,ByteStream:Ce,sharedCopy:Re,DataSet:E,findAndSetUNElementLength:_,findEndOfEncapsulatedElement:T,findItemDelimitationItemAndSetElementLength:R,littleEndianByteArrayParser:P,parseDicom:L,readDicomElementExplicit:ie,readDicomElementImplicit:M,readEncapsulatedImageFrame:me,readEncapsulatedPixelData:_e,readEncapsulatedPixelDataFromFragments:$,readPart10Header:O,readSequenceItemsExplicit:B,readSequenceItemsImplicit:Y,readSequenceItem:U,readTag:C,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],a={},r.m=i,r.c=a,r.d=function(o,s,c){r.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:c})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,s){if(1&s&&(o=r(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(r.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var l in o)r.d(c,l,(function(f){return o[f]}).bind(null,l));return c},r.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(s,"a",s),s},r.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},r.p="",r(r.s=1);function r(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return i[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}var i,a})}(sf)),sf.exports}var Ha=Zj();const Qj=wa(Ha);function w2(t){const e=t.indexOf(":");let n=t.substring(e+1);const r=n.indexOf("frame=");let i;if(r!==-1){const s=n.substring(r+6);i=parseInt(s,10),n=n.substring(0,r-1)}const a=t.substring(0,e),o=i!==void 0?i-1:void 0;return{scheme:a,url:n,frame:i,pixelDataFrame:o}}let e$={open(t,e){t.open("get",e,!0)},beforeSend(){},beforeProcessing(t){return Promise.resolve(t.response)},imageCreated(){},strict:!1};function Vw(){return e$}function kw(t,e,n={},r={}){const i=Vw(),a=c=>{if(typeof i.errorInterceptor=="function"){const l=new Error("request failed");l.request=c,l.response=c.response,l.status=c.status,i.errorInterceptor(l)}},o=new XMLHttpRequest,s=new Promise((c,l)=>{i.open(o,t,n,r);const f=i.beforeSend(o,e,n,r);o.responseType="arraybuffer";const u=Object.assign({},n,f);Object.keys(u).forEach(function(h){u[h]!==null&&(h==="Accept"&&t.indexOf("accept=")!==-1||o.setRequestHeader(h,u[h]))}),r.deferred={resolve:c,reject:l},r.url=t,r.imageId=e,o.onloadstart=function(h){i.onloadstart&&i.onloadstart(h,r),et(vt,"cornerstoneimageloadstart",{url:t,imageId:e})},o.onloadend=function(h){i.onloadend&&i.onloadend(h,r),et(vt,"cornerstoneimageloadend",{url:t,imageId:e})},o.onreadystatechange=function(h){i.onreadystatechange&&i.onreadystatechange(h,r),o.readyState===4&&(o.status===200||o.status===206?i.beforeProcessing(o).then(c).catch(()=>{a(o),l(o)}):(a(o),l(o)))},o.onprogress=function(h){const p=h.loaded;let d,g;h.lengthComputable&&(d=h.total,g=Math.round(p/d*100)),et(vt,"cornerstoneimageloadprogress",{url:t,imageId:e,loaded:p,total:d,percentComplete:g}),i.onprogress&&i.onprogress(h,r)},o.onerror=function(){a(o),l(o)},o.onabort=function(){a(o),l(o)},o.send()});return s.xhr=o,s}function t$(t){const e=t.elements.x7fe00010.fragments,n=t.byteArray.length;for(const r of e){const{position:i,length:a}=r;a>n-i&&(console.log(`Truncated fragment, changing fragment length from ${r.length} to ${n-i}`),r.length=n-i)}return t}function n$(t){let e=Ha.parseDicom(t,{untilTag:"x7fe00010"});e.elements.x7fe00010||console.warn("Pixel data not found!");let n;try{n=Ha.parseDicom(t)}catch(r){console.error(r),console.log("pixel data dataset:",r.dataSet),n=r.dataSet}return e.elements.x7fe00010=n.elements.x7fe00010,e=t$(e),e}async function Uw(t,e,n){const r=n$(t),{uri:i,imageId:a,fileTotalLength:o}=n;return r.fetchMore=async function(s){const c=Object.assign({uri:i,imageId:a,fetchedLength:t.length,lengthToFetch:o-t.length},s),{fetchedLength:l,lengthToFetch:f}=c,{arrayBuffer:u}=await e(i,a,{byteRange:`${l}-${l+f}`}),h=new Uint8Array(u),p=new Uint8Array(r.byteArray.length+h.length);return p.set(r.byteArray),p.set(h,r.byteArray.length),Uw(p,e,n)},r}function r$(t,e,n){const r={};(e?Object.values(e.items[0].dataSet.elements):[]).map(a=>r[a.tag]=a);const i={};return(t?Object.values(t.items[n-1].dataSet.elements):[]).map(a=>i[a.tag]=a),{shared:r,perFrame:i}}function i$(t){if(!t)return;const{elements:e,...n}=t,{x52009230:r,x52009229:i,...a}=e;return{NumberOfFrames:t.intString("x00280008"),PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a,otherAttributtes:n}}function a$(t,e){if(!e)return;const{NumberOfFrames:n,PerFrameFunctionalGroupsSequence:r,SharedFunctionalGroupsSequence:i,otherElements:a}=i$(e);if(r||n>1){const{shared:o,perFrame:s}=r$(r,i,t),c={elements:{...a,...o,...s}},l=Object.create(e);return Object.assign(l,c)}return e}let Hn={};const o$=()=>{Hn={}};function C2(t){if(Hn[t])return Hn[t]}function s$(t){const e=C2(t);return Bw(e)}function Bw(t){if(!t)return!1;const e=t.intString("x00280008");return e&&e>1}function c$(t){return t.indexOf("&frame=")}function u$(t){const e=c$(t),n=e===-1?t:t.slice(0,e),r=parseInt(t.slice(e+7),10)||1;let i;return Hn[n]?i=Hn[n].dataSet:i=void 0,{dataSet:i,frame:r}}function l$(t){const e=[],n=C2(t);if(Bw(n)){const r=n.intString("x00280008");for(let i=1;i<=r;i++)e.push(`${t}&frame=${i}`)}else e.push(t);return e}const f$={_get:C2,generateMultiframeWADOURIs:l$,retrieveMultiframeDataset:u$,isMultiframeDataset:s$};let Jc=0,zs={};function h$(t){return Hn[t]!==void 0}function p$(t){let e;if(t.includes("&frame=")){const{frame:n,dataSet:r}=f$.retrieveMultiframeDataset(t);e=a$(n,r)}else Hn[t]&&(e=Hn[t].dataSet);return e}function d$(t,e){const n=Hn[t];if(!n){console.error(`No loaded dataSet for uri ${t}`);return}Jc-=n.dataSet.byteArray.length,n.dataSet=e,Jc+=e.byteArray.length,et(vt,"datasetscachechanged",{uri:t,action:"updated",cacheInfo:Gh()})}function g$(t,e=kw,n){if(Hn[t])return new Promise(a=>{Hn[t].cacheCount++,a(Hn[t].dataSet)});if(zs[t])return zs[t].cacheCount++,zs[t];const r=e(t,n),i=new Promise((a,o)=>{r.then(async function(s){const c={isPartialContent:!1,fileTotalLength:null};if(!(s instanceof ArrayBuffer)){if(!s.arrayBuffer)return o(new Error("If not returning ArrayBuffer, must return object with `arrayBuffer` parameter"));c.isPartialContent=s.flags.isPartialContent,c.fileTotalLength=s.flags.fileTotalLength,s=s.arrayBuffer}const l=new Uint8Array(s);let f;try{c.isPartialContent?f=await Uw(l,e,{uri:t,imageId:n,fileTotalLength:c.fileTotalLength}):f=Ha.parseDicom(l)}catch(u){return o(u)}Hn[t]={dataSet:f,cacheCount:i.cacheCount},Jc+=f.byteArray.length,a(f),et(vt,"datasetscachechanged",{uri:t,action:"loaded",cacheInfo:Gh()})},o).then(()=>{delete zs[t]},()=>{delete zs[t]})});return i.cacheCount=1,zs[t]=i,i}function m$(t){Hn[t]&&(Hn[t].cacheCount--,Hn[t].cacheCount===0&&(Jc-=Hn[t].dataSet.byteArray.length,delete Hn[t],et(vt,"datasetscachechanged",{uri:t,action:"unloaded",cacheInfo:Gh()})))}function Gh(){return{cacheSizeInBytes:Jc,numberOfDataSetsCached:Object.keys(Hn).length}}function v$(){o$(),zs={},Jc=0}const cf={isLoaded:h$,load:g$,unload:m$,getInfo:Gh,purge:v$,get:p$,update:d$};let Wh=[];function y$(t){return`dicomfile:${Wh.push(t)-1}`}function x$(t){return Wh[t]}function w$(t){Wh[t]=void 0}function C$(){Wh=[]}const T$={add:y$,get:x$,remove:w$,purge:C$};function _$(t){const e=t.intString("x00280008"),n=t.elements.x7fe00010;return e!==n.fragments.length}function S$(t,e){if(t.elements.x7fe00010&&t.elements.x7fe00010.basicOffsetTable.length)return Ha.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e);if(_$(t)){const l=Ha.createJPEGBasicOffsetTable(t,t.elements.x7fe00010);return Ha.readEncapsulatedImageFrame(t,t.elements.x7fe00010,e,l)}const n=t.elements.x7fe00010.fragments,r=new Ha.ByteStream(t.byteArrayParser,t.byteArray,t.elements.x7fe00010.dataOffset),i=Ha.readSequenceItem(r);if(i.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";r.seek(i.length);const a=r.position;if(e+1>n.length)throw"dicomParser.readEncapsulatedPixelData: frame exceeds number of fragments";const s=a+n[e].offset+8,c=n[e].length;return new Uint8Array(r.byteArray.buffer.slice(r.byteArray.byteOffset+s,r.byteArray.byteOffset+s+c))}function b$(t,e){return t&1<<e}function E$(t,e,n){const r=new Uint8Array(n);for(let i=0;i<n;i++){const a=Math.floor(i/8),o=t[a+e],s=i%8;r[i]=b$(o,s)?1:0}return r}function D$(t,e){const n=t.elements.x7fe00010||t.elements.x7fe00008,r=t.uint16("x00280100"),i=t.uint16("x00280010"),a=t.uint16("x00280011");let o=t.uint16("x00280002");t.string("x00280004")==="YBR_FULL_422"&&(o=2,console.warn(`Using SamplesPerPixel of 2 for YBR_FULL_422 photometric interpretation.
      See http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html for more information.`));const c=n.dataOffset,l=i*a*o;let f;if(r===8){if(f=c+e*l,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+l))}else if(r===16){if(f=c+e*l*2,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+l*2))}else if(r===1){if(f=c+e*l*.125,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return E$(t.byteArray,f,l)}else if(r===32){if(f=c+e*l*4,f>=t.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(t.byteArray.buffer.slice(f,f+l*4))}throw new Error("unsupported pixel format")}function O$(t){const e=w2(t),n=parseInt(e.url,10),r=T$.get(n);return new Promise((i,a)=>{const o=new FileReader;o.onload=s=>{const c=s.target.result;i(c)},o.onerror=a,o.readAsArrayBuffer(r)})}function Gw(t,e=0){const n=t.elements.x7fe00010||t.elements.x7fe00008;return n?n.encapsulatedPixelData?S$(t,e):D$(t,e):null}function T2(t){let e=t[0],n=t[0],r;const i=t.length;for(let a=1;a<i;a++)r=t[a],e=Math.min(e,r),n=Math.max(n,r);return{min:e,max:n}}function td(t,e,n){t.planarConfiguration===0?$j(t.pixelData,e,n):Hj(t.pixelData,e,n)}function R$(t,e,n){t.planarConfiguration===0?Kj(t.pixelData,e,n):qj(t.pixelData,e,n)}function M$(t,e,n){if(t.photometricInterpretation==="RGB")td(t,e,n);else if(t.photometricInterpretation==="YBR_RCT")td(t,e,n);else if(t.photometricInterpretation==="YBR_ICT")td(t,e,n);else if(t.photometricInterpretation==="PALETTE COLOR")Yj(t,e,n);else if(t.photometricInterpretation==="YBR_FULL_422")Xj(t.pixelData,e,n);else if(t.photometricInterpretation==="YBR_FULL")R$(t,e,n);else throw new Error(`No color space conversion for photometric interpretation ${t.photometricInterpretation}`)}function N$(t){if(t===void 0)return!1;const{rows:e,columns:n,photometricInterpretation:r,pixelDataLength:i,planarConfiguration:a}=t;return i===4*n*e?!1:r==="PALETTE COLOR"?!0:r.endsWith("420")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*e:r.endsWith("422")?i===(3*Math.ceil(n/2)+Math.floor(n/2))*Math.ceil(e/2)+Math.floor(e/2)*n:r!=="RGB"||a===1}function L$(t){return A$(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(t))))}function A$(t){let e;try{return decodeURIComponent(escape(t))}catch(n){if(e=n,e instanceof URIError)return t;throw e}}function F$(t,e,n){const r=new Date().getTime(),i=new Blob([e],{type:"image/jpeg"});return new Promise((a,o)=>{const s=new FileReader;s.readAsBinaryString===void 0?s.readAsArrayBuffer(i):s.readAsBinaryString(i),s.onload=function(){const c=new Image;c.onload=function(){n.height=c.height,n.width=c.width,t.rows=c.height,t.columns=c.width;const l=n.getContext("2d");l.drawImage(this,0,0);const f=l.getImageData(0,0,c.width,c.height),u=new Date().getTime();t.pixelData=new Uint8Array(f.data.buffer),t.imageData=f,t.decodeTimeInMS=u-r;const h=T2(t.pixelData);t.smallestPixelValue=h.min,t.largestPixelValue=h.max,t.pixelDataLength=t.pixelData.length,a(t)},c.onerror=function(l){o(l)},s.readAsBinaryString===void 0?c.src=`data:image/jpeg;base64,${window.btoa(L$(s.result))}`:c.src=`data:image/jpeg;base64,${window.btoa(s.result)}`},s.onerror=c=>{o(c)}})}function Gr(t,e,n,r,i){const a={...r};delete a.loader,delete a.streamingData;const o=p3(),s=a.priority||void 0;return a.transferPixelData&&n.buffer,o.executeTask("dicomImageLoader","decodeTask",{imageFrame:t,transferSyntax:e,pixelData:n,options:a,decodeConfig:i},{priority:s,requestType:a?.requestType})}function I$(t,e,n,r,i={},a){switch(e){case"1.2.840.10008.1.2":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.1":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.2":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.1.99":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.5":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.50":return t.bitsAllocated===8&&(t.samplesPerPixel===3||t.samplesPerPixel===4)?F$(t,n,r):Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.51":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.57":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.70":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.80":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.81":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.90":return Gr(t,e,n,i,a);case"1.2.840.10008.1.2.4.91":return Gr(t,e,n,i,a);case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":return Gr(t,e,n,i,a)}return Promise.reject(new Error(`No decoder for transfer syntax ${e}`))}function P$(t){const e=nt("imagePixelModule",t);return{samplesPerPixel:e.samplesPerPixel,photometricInterpretation:e.photometricInterpretation,planarConfiguration:e.planarConfiguration,rows:e.rows,columns:e.columns,bitsAllocated:e.bitsAllocated,bitsStored:e.bitsStored,pixelRepresentation:e.pixelRepresentation,smallestPixelValue:e.smallestPixelValue,largestPixelValue:e.largestPixelValue,redPaletteColorLookupTableDescriptor:e.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:e.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:e.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:e.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:e.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:e.bluePaletteColorLookupTableData,pixelData:void 0,imageId:t}}function V$(t,e){const n=t.get("modalityLutModule",e)||{},r=t.get("generalSeriesModule",e)||{},{modality:i}=r,a={rescaleSlope:n.rescaleSlope,rescaleIntercept:n.rescaleIntercept,modality:i},o=t.get("scalingModule",e)||{};return{...a,...i==="PT"&&{suvbw:o.suvbw},...i==="RTDOSE"&&{doseGridScaling:o.DoseGridScaling,doseSummation:o.DoseSummation,doseType:o.DoseType,doseUnit:o.DoseUnit}}}function Ww(t){return t==="RGB"||t==="PALETTE COLOR"||t==="YBR_FULL"||t==="YBR_FULL_422"||t==="YBR_PARTIAL_422"||t==="YBR_PARTIAL_420"||t==="YBR_RCT"||t==="YBR_ICT"}function k$(t,e){const n=t.length/4;let r=0,i=0;for(let a=0;a<n;a++)e[i++]=t[r++],e[i++]=t[r++],e[i++]=t[r++],r++;return e}function U$(t){return t!=="1.2.840.10008.5.1.4.1.1.12.1"&&t!=="1.2.840.10008.5.1.4.1.1.12.2.1"}function _2(t,e){let n;return Number.isInteger(t)&&Number.isInteger(e)&&(t>=0?e<=255?n=Uint8Array:e<=65535?n=Uint16Array:e<=4294967295&&(n=Uint32Array):t>=-128&&e<=127?n=Int8Array:t>=-32768&&e<=32767&&(n=Int16Array)),n||Float32Array}function B$(t,e,n){return _2(t,e)===n}function G$(t){const e=t.smallestPixelValue,n=t.largestPixelValue,r=_2(e,n);if(r){const i=new r(t.pixelData);t.pixelData=i}else throw new Error("Could not apply a typed array to the pixel data")}let Uy="";function zw(t,e,n,r={}){const i=r.useRGBA;if(r.preScale={enabled:r.preScale&&r.preScale.enabled!==void 0?r.preScale.enabled:!0},!e?.length)return Promise.reject(new Error("The pixel data is missing"));const{MetadataModules:a}=ph,o=document.createElement("canvas"),s=P$(t);if(s.decodeLevel=r.decodeLevel,r.allowFloatRendering=dh(),r.preScale.enabled){const u=V$(V6,t);u&&(r.preScale={...r.preScale,scalingParameters:u})}const{decodeConfig:c}=Vw();Object.keys(s).forEach(u=>{(typeof s[u]=="function"||s[u]instanceof Promise)&&delete s[u]});const l=I$(s,n,e,o,r,c),f=Ww(s.photometricInterpretation);return new Promise((u,h)=>{l.then(function(p){let d=!1;if(r.targetBuffer&&r.targetBuffer.type&&!f){const{arrayBuffer:b,type:D,offset:E=0,length:R}=r.targetBuffer,F=p.pixelDataLength,M=E,U=R??F-M,z={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};if(U!==p.pixelDataLength)throw new Error(`target array for image does not have the same length (${U}) as the decoded image length (${p.pixelDataLength}).`);const Y=z[D],W=b?new Y(b,M,U):new Y(p.pixelData);if(U!==p.pixelDataLength)throw new Error("target array for image does not have the same length as the decoded image length.");p.pixelData=W,d=!0}d||G$(p);const g=nt(a.IMAGE_PLANE,t)||{},y=nt(a.VOI_LUT,t)||{},x=nt(a.MODALITY_LUT,t)||{},m=nt(a.SOP_COMMON,t)||{},v=nt(a.CALIBRATION,t)||{},{rows:w,columns:C}=p;if(f){if(N$(p)){o.height=p.rows,o.width=p.columns;let E=o.getContext("2d").createImageData(p.columns,p.rows);i||(E={...E,data:new Uint8ClampedArray(3*p.columns*p.rows)}),M$(p,E.data,i),p.imageData=E,p.pixelData=E.data,p.pixelDataLength=E.data.length}else if(!i&&p.pixelDataLength===4*w*C){const D=new Uint8Array(p.pixelData.length/4*3);p.pixelData=k$(p.pixelData,D),p.pixelDataLength=p.pixelData.length}const b=T2(p.pixelData);p.smallestPixelValue=b.min,p.largestPixelValue=b.max}let T=p.samplesPerPixel;p.photometricInterpretation==="PALETTE COLOR"&&(T=i?4:3);const _=rn.createImageVoxelManager({scalarData:p.pixelData,width:p.columns,height:p.rows,numberOfComponents:T}),S={imageId:t,dataType:p.pixelData.constructor.name,color:f,calibration:v,columnPixelSpacing:g.columnPixelSpacing,columns:p.columns,height:p.rows,preScale:p.preScale,intercept:x.rescaleIntercept?x.rescaleIntercept:0,slope:x.rescaleSlope?x.rescaleSlope:1,invert:p.photometricInterpretation==="MONOCHROME1",minPixelValue:p.smallestPixelValue,maxPixelValue:p.largestPixelValue,rowPixelSpacing:g.rowPixelSpacing,rows:p.rows,sizeInBytes:p.pixelData.byteLength,width:p.columns,windowCenter:y.windowCenter?y.windowCenter[0]:void 0,windowWidth:y.windowWidth?y.windowWidth[0]:void 0,voiLUTFunction:y.voiLUTFunction?y.voiLUTFunction:void 0,decodeTimeInMS:p.decodeTimeInMS,floatPixelData:void 0,imageFrame:p,voxelManager:_,rgba:f&&i,getPixelData:()=>p.pixelData,getCanvas:void 0,numberOfComponents:T};if(S.color&&(S.getCanvas=function(){if(Uy===t)return o;const b=S.columns,D=S.rows;o.height=D,o.width=b;const E=o.getContext("2d"),R=E.createImageData(b,D),F=p.pixelData;if(F.length===b*D*4)for(let M=0;M<F.length;M++)R.data[M]=F[M];else if(F.length===b*D*3){let M=0;for(let U=0;U<F.length;U+=3)R.data[M++]=F[U],R.data[M++]=F[U+1],R.data[M++]=F[U+2],R.data[M++]=255}return p.pixelData=R.data,p.pixelDataLength=R.data.length,p.imageData=R,E.putImageData(p.imageData,0,0),Uy=t,o}),x.modalityLUTSequence&&x.modalityLUTSequence.length>0&&U$(m.sopClassUID)&&(S.modalityLUT=x.modalityLUTSequence[0]),y.voiLUTSequence&&y.voiLUTSequence.length>0&&(S.voiLUT=y.voiLUTSequence[0]),S.color&&(S.windowWidth=256,S.windowCenter=128),S.windowCenter===void 0||S.windowWidth===void 0){const b=_h(S.imageFrame.smallestPixelValue,S.imageFrame.largestPixelValue);S.windowWidth=b.windowWidth,S.windowCenter=b.windowCenter}u(S)},h)})}const{ImageQualityStatus:jw}=ph;function W$(t,e){t.decache=function(){const n=w2(e);cf.unload(n.url)}}function z$(t,e,n=0,r,i,a){const o=new Date().getTime(),s={cancelFn:void 0,promise:void 0};return s.promise=new Promise((c,l)=>{t.then(f=>{const u=Gw(f,n),h=f.string("x00020010"),p=new Date().getTime(),d=zw(e,u,h,i);W$(s,e),d.then(g=>{g=g,g.data=f,g.sharedCacheKey=r;const y=new Date().getTime();g.loadTimeInMS=p-o,g.totalTimeInMS=y-o,g.imageQualityStatus=jw.FULL_RESOLUTION,a!==void 0&&a.imageDoneCallback!==void 0&&a.imageDoneCallback(g),c(g)},function(g){l({error:g,dataSet:f})})},function(f){l({error:f})})}),s}function j$(t,e,n=0,r,i){const a=new Date().getTime();return{promise:new Promise((s,c)=>{const l=new Date().getTime();let f;try{const u=Gw(t,n),h=t.string("x00020010");f=zw(e,u,h,i)}catch(u){c({error:u,dataSet:t});return}f.then(u=>{u=u,u.data=t;const h=new Date().getTime();u.loadTimeInMS=l-a,u.totalTimeInMS=h-a,u.imageQualityStatus=jw.FULL_RESOLUTION,s(u)},c)}),cancelFn:void 0}}function $$(t){if(t==="dicomweb"||t==="wadouri")return kw;if(t==="dicomfile")return O$}function H$(t,e={}){const n=w2(t);e=Object.assign({},e),delete e.loader;const r=$$(n.scheme);if(cf.isLoaded(n.url)){const a=cf.get(n.url,r,t);return j$(a,t,n.pixelDataFrame,n.url,e)}const i=cf.load(n.url,r,t);return z$(i,t,n.frame,n.url,e)}const K$={loadImage:H$};function q$(t,e){const{rows:n,columns:r,data:i}=t,{rows:a,columns:o,data:s}=e,c=[],l=[],f=[];for(let u=0;u<o;u++){const h=u*(r-1)/(o-1);c[u]=Math.floor(h),l[u]=Math.min(c[u]+1,r-1),f[u]=h-c[u]}for(let u=0;u<a;u++){const h=u*(n-1)/(a-1),p=Math.floor(h)*r,d=Math.min(p+r,(n-1)*r),g=h-Math.floor(h),y=1-g,x=u*o;for(let m=0;m<o;m++){const v=i[p+c[m]],w=i[p+l[m]],C=i[d+c[m]],T=i[d+l[m]],_=1-f[m];s[x+m]=(v*_+w*f[m])*y+(C*_+T*f[m])*g}}return s}function X$(t,e){const{rows:n,columns:r,pixelData:i,samplesPerPixel:a=1}=t,{rows:o,columns:s,pixelData:c}=e,l=[];for(let f=0;f<s;f++){const u=f*(r-1)/(s-1);l[f]=Math.floor(u)*a}for(let f=0;f<o;f++){const u=f*(n-1)/(o-1),h=Math.floor(u)*r*a,p=f*s;for(let d=0;d<s;d++)for(let g=0;g<a;g++)c[p+d+g]=i[h+l[d]+g]}return c}async function By(t,e){let n=e.buffer,r=e.byteOffset;const i=e.length;if(t.bitsAllocated===16)r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);else if(t.bitsAllocated===8||t.bitsAllocated===1)t.pixelData=e;else if(t.bitsAllocated===32){if(r%2&&(n=n.slice(r),r=0),t.floatPixelData||t.doubleFloatPixelData)throw new Error("Float pixel data is not supported for parsing into ImageFrame");t.pixelRepresentation===0?t.pixelData=new Uint32Array(n,r,i/4):t.pixelRepresentation===1?t.pixelData=new Int32Array(n,r,i/4):t.pixelData=new Float32Array(n,r,i/4)}return t}function Y$(t){return(t&255)<<8|t>>8&255}async function J$(t,e){if(t.bitsAllocated===16){let n=e.buffer,r=e.byteOffset;const i=e.length;r%2&&(n=n.slice(r),r=0),t.pixelRepresentation===0?t.pixelData=new Uint16Array(n,r,i/2):t.pixelData=new Int16Array(n,r,i/2);for(let a=0;a<t.pixelData.length;a++)t.pixelData[a]=Y$(t.pixelData[a])}else t.bitsAllocated===8&&(t.pixelData=e);return t}async function Z$(t,e){if(t.bitsAllocated===8)return t.planarConfiguration?eH(t,e):Q$(t,e);if(t.bitsAllocated===16)return tH(t,e);throw new Error("unsupported pixel format for RLE")}function Q$(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let c=0;const l=a.getInt32(0,!0);for(let f=0;f<l;++f){c=f;let u=a.getInt32((f+1)*4,!0),h=a.getInt32((f+2)*4,!0);h===0&&(h=n.length);const p=r*l;for(;u<h;){const d=o[u++];if(d>=0&&d<=127)for(let g=0;g<d+1&&c<p;++g)s[c]=o[u++],c+=t.samplesPerPixel;else if(d<=-1&&d>=-127){const g=o[u++];for(let y=0;y<-d+1&&c<p;++y)s[c]=g,c+=t.samplesPerPixel}}}return t.pixelData=new Uint8Array(i),t}function eH(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i);let c=0;const l=a.getInt32(0,!0);for(let f=0;f<l;++f){c=f*r;let u=a.getInt32((f+1)*4,!0),h=a.getInt32((f+2)*4,!0);h===0&&(h=n.length);const p=r*l;for(;u<h;){const d=o[u++];if(d>=0&&d<=127)for(let g=0;g<d+1&&c<p;++g)s[c]=o[u++],c++;else if(d<=-1&&d>=-127){const g=o[u++];for(let y=0;y<-d+1&&c<p;++y)s[c]=g,c++}}}return t.pixelData=new Uint8Array(i),t}function tH(t,e){const n=e,r=t.rows*t.columns,i=new ArrayBuffer(r*t.samplesPerPixel*2),a=new DataView(n.buffer,n.byteOffset),o=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(i),c=a.getInt32(0,!0);for(let l=0;l<c;++l){let f=0;const u=l===0?1:0;let h=a.getInt32((l+1)*4,!0),p=a.getInt32((l+2)*4,!0);for(p===0&&(p=n.length);h<p;){const d=o[h++];if(d>=0&&d<=127)for(let g=0;g<d+1&&f<r;++g)s[f*2+u]=o[h++],f++;else if(d<=-1&&d>=-127){const g=o[h++];for(let y=0;y<-d+1&&f<r;++y)s[f*2+u]=g,f++}}}return t.pixelRepresentation===0?t.pixelData=new Uint16Array(i):t.pixelData=new Int16Array(i),t}var nd={exports:{}},Gy;function nH(){return Gy||(Gy=1,function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(N,I){o=N,s=I});var c=Object.assign({},a),l="./this.program",f=(N,I)=>{throw I},u=typeof window=="object",h=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="";function g(N){return a.locateFile?a.locateFile(N,d):d+N}var y,x,m;if(p){var v=da,w=da;h?d=w.dirname(d)+"/":d=__dirname+"/",y=(N,I)=>(N=re(N)?new URL(N):w.normalize(N),v.readFileSync(N,I?void 0:"utf8")),m=N=>{var I=y(N,!0);return I.buffer||(I=new Uint8Array(I)),I},x=(N,I,q)=>{N=re(N)?new URL(N):w.normalize(N),v.readFile(N,function(oe,he){oe?q(oe):I(he.buffer)})},process.argv.length>1&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(N){if(!(N instanceof Ye))throw N}),process.on("unhandledRejection",function(N){throw N}),f=(N,I)=>{throw process.exitCode=N,I},a.inspect=function(){return"[Emscripten Module object]"}}else(u||h)&&(h?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d.indexOf("blob:")!==0?d=d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):d="",y=N=>{var I=new XMLHttpRequest;return I.open("GET",N,!1),I.send(null),I.responseText},h&&(m=N=>{var I=new XMLHttpRequest;return I.open("GET",N,!1),I.responseType="arraybuffer",I.send(null),new Uint8Array(I.response)}),x=(N,I,q)=>{var oe=new XMLHttpRequest;oe.open("GET",N,!0),oe.responseType="arraybuffer",oe.onload=()=>{if(oe.status==200||oe.status==0&&oe.response){I(oe.response);return}q()},oe.onerror=q,oe.send(null)});var C=a.print||console.log.bind(console),T=a.printErr||console.warn.bind(console);Object.assign(a,c),c=null,a.arguments&&a.arguments,a.thisProgram&&(l=a.thisProgram),a.quit&&(f=a.quit);var _;a.wasmBinary&&(_=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&K("no native wasm support detected");var S,b=!1;function D(N,I){N||K(I)}var E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(N,I,q){for(var oe=I+q,he=I;N[he]&&!(he>=oe);)++he;if(he-I>16&&N.buffer&&E)return E.decode(N.subarray(I,he));for(var de="";I<he;){var ve=N[I++];if(!(ve&128)){de+=String.fromCharCode(ve);continue}var we=N[I++]&63;if((ve&224)==192){de+=String.fromCharCode((ve&31)<<6|we);continue}var Me=N[I++]&63;if((ve&240)==224?ve=(ve&15)<<12|we<<6|Me:ve=(ve&7)<<18|we<<12|Me<<6|N[I++]&63,ve<65536)de+=String.fromCharCode(ve);else{var ke=ve-65536;de+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return de}function F(N,I){return N?R(B,N,I):""}function M(N,I,q,oe){if(!(oe>0))return 0;for(var he=q,de=q+oe-1,ve=0;ve<N.length;++ve){var we=N.charCodeAt(ve);if(we>=55296&&we<=57343){var Me=N.charCodeAt(++ve);we=65536+((we&1023)<<10)|Me&1023}if(we<=127){if(q>=de)break;I[q++]=we}else if(we<=2047){if(q+1>=de)break;I[q++]=192|we>>6,I[q++]=128|we&63}else if(we<=65535){if(q+2>=de)break;I[q++]=224|we>>12,I[q++]=128|we>>6&63,I[q++]=128|we&63}else{if(q+3>=de)break;I[q++]=240|we>>18,I[q++]=128|we>>12&63,I[q++]=128|we>>6&63,I[q++]=128|we&63}}return I[q]=0,q-he}function U(N,I,q){return M(N,B,I,q)}function z(N){for(var I=0,q=0;q<N.length;++q){var oe=N.charCodeAt(q);oe<=127?I++:oe<=2047?I+=2:oe>=55296&&oe<=57343?(I+=4,++q):I+=3}return I}var Y,W,B,j,ie,ae,fe,Ee,ge;function be(N){Y=N,a.HEAP8=W=new Int8Array(N),a.HEAP16=j=new Int16Array(N),a.HEAP32=ae=new Int32Array(N),a.HEAPU8=B=new Uint8Array(N),a.HEAPU16=ie=new Uint16Array(N),a.HEAPU32=fe=new Uint32Array(N),a.HEAPF32=Ee=new Float32Array(N),a.HEAPF64=ge=new Float64Array(N)}a.INITIAL_MEMORY;var Re,Ne=[],Ce=[],P=[];function O(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)k(a.preRun.shift());qe(Ne)}function A(){qe(Ce)}function L(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)H(a.postRun.shift());qe(P)}function k(N){Ne.unshift(N)}function $(N){Ce.unshift(N)}function H(N){P.unshift(N)}var se=0,me=null;function ye(N){se++,a.monitorRunDependencies&&a.monitorRunDependencies(se)}function _e(N){if(se--,a.monitorRunDependencies&&a.monitorRunDependencies(se),se==0&&me){var I=me;me=null,I()}}function K(N){a.onAbort&&a.onAbort(N),N="Aborted("+N+")",T(N),b=!0,N+=". Build with -sASSERTIONS for more info.";var I=new WebAssembly.RuntimeError(N);throw s(I),I}var ne="data:application/octet-stream;base64,";function ce(N){return N.startsWith(ne)}function re(N){return N.startsWith("file://")}var ue;ue="libjpegturbowasm_decode.wasm",ce(ue)||(ue=g(ue));function De(N){try{if(N==ue&&_)return new Uint8Array(_);if(m)return m(N);throw"both async and sync fetching of the wasm failed"}catch(I){K(I)}}function te(){if(!_&&(u||h)){if(typeof fetch=="function"&&!re(ue))return fetch(ue,{credentials:"same-origin"}).then(function(N){if(!N.ok)throw"failed to load wasm binary file at '"+ue+"'";return N.arrayBuffer()}).catch(function(){return De(ue)});if(x)return new Promise(function(N,I){x(ue,function(q){N(new Uint8Array(q))},I)})}return Promise.resolve().then(function(){return De(ue)})}function Ue(){var N={a:Pe};function I(ve,we){var Me=ve.exports;a.asm=Me,S=a.asm.K,be(S.buffer),Re=a.asm.M,$(a.asm.L),_e()}ye();function q(ve){I(ve.instance)}function oe(ve){return te().then(function(we){return WebAssembly.instantiate(we,N)}).then(function(we){return we}).then(ve,function(we){T("failed to asynchronously prepare wasm: "+we),K(we)})}function he(){return!_&&typeof WebAssembly.instantiateStreaming=="function"&&!ce(ue)&&!re(ue)&&!p&&typeof fetch=="function"?fetch(ue,{credentials:"same-origin"}).then(function(ve){var we=WebAssembly.instantiateStreaming(ve,N);return we.then(q,function(Me){return T("wasm streaming compile failed: "+Me),T("falling back to ArrayBuffer instantiation"),oe(q)})}):oe(q)}if(a.instantiateWasm)try{var de=a.instantiateWasm(N,I);return de}catch(ve){T("Module.instantiateWasm callback failed with error: "+ve),s(ve)}return he().catch(s),{}}function Ye(N){this.name="ExitStatus",this.message="Program terminated with exit("+N+")",this.status=N}function qe(N){for(;N.length>0;)N.shift()(a)}function xe(N){this.excPtr=N,this.ptr=N-24,this.set_type=function(I){fe[this.ptr+4>>2]=I},this.get_type=function(){return fe[this.ptr+4>>2]},this.set_destructor=function(I){fe[this.ptr+8>>2]=I},this.get_destructor=function(){return fe[this.ptr+8>>2]},this.set_refcount=function(I){ae[this.ptr>>2]=I},this.set_caught=function(I){I=I?1:0,W[this.ptr+12>>0]=I},this.get_caught=function(){return W[this.ptr+12>>0]!=0},this.set_rethrown=function(I){I=I?1:0,W[this.ptr+13>>0]=I},this.get_rethrown=function(){return W[this.ptr+13>>0]!=0},this.init=function(I,q){this.set_adjusted_ptr(0),this.set_type(I),this.set_destructor(q),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var I=ae[this.ptr>>2];ae[this.ptr>>2]=I+1},this.release_ref=function(){var I=ae[this.ptr>>2];return ae[this.ptr>>2]=I-1,I===1},this.set_adjusted_ptr=function(I){fe[this.ptr+16>>2]=I},this.get_adjusted_ptr=function(){return fe[this.ptr+16>>2]},this.get_exception_ptr=function(){var I=le(this.get_type());if(I)return fe[this.excPtr>>2];var q=this.get_adjusted_ptr();return q!==0?q:this.excPtr}}function Fe(N,I,q){var oe=new xe(N);throw oe.init(I,q),N}var ze={};function $e(N){for(;N.length;){var I=N.pop(),q=N.pop();q(I)}}function Xe(N){return this.fromWireType(ae[N>>2])}var ot={},rt={},mt={},wt=48,qt=57;function nn(N){if(N===void 0)return"_unknown";N=N.replace(/[^a-zA-Z0-9_]/g,"$");var I=N.charCodeAt(0);return I>=wt&&I<=qt?"_"+N:N}function Pt(N,I){return N=nn(N),new Function("body","return function "+N+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(I)}function Ht(N,I){var q=Pt(I,function(oe){this.name=I,this.message=oe;var he=new Error(oe).stack;he!==void 0&&(this.stack=this.toString()+`
`+he.replace(/^Error(:[^\n]*)?\n/,""))});return q.prototype=Object.create(N.prototype),q.prototype.constructor=q,q.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},q}var Vr=void 0;function On(N){throw new Vr(N)}function Le(N,I,q){N.forEach(function(we){mt[we]=I});function oe(we){var Me=q(we);Me.length!==N.length&&On("Mismatched type converter count");for(var ke=0;ke<N.length;++ke)qn(N[ke],Me[ke])}var he=new Array(I.length),de=[],ve=0;I.forEach((we,Me)=>{rt.hasOwnProperty(we)?he[Me]=rt[we]:(de.push(we),ot.hasOwnProperty(we)||(ot[we]=[]),ot[we].push(()=>{he[Me]=rt[we],++ve,ve===de.length&&oe(he)}))}),de.length===0&&oe(he)}function Ke(N){var I=ze[N];delete ze[N];var q=I.rawConstructor,oe=I.rawDestructor,he=I.fields,de=he.map(ve=>ve.getterReturnType).concat(he.map(ve=>ve.setterArgumentType));Le([N],de,ve=>{var we={};return he.forEach((Me,ke)=>{var Ze=Me.fieldName,st=ve[ke],tt=Me.getter,Ct=Me.getterContext,xt=ve[ke+he.length],jt=Me.setter,Mn=Me.setterContext;we[Ze]={read:Vn=>st.fromWireType(tt(Ct,Vn)),write:(Vn,Ds)=>{var fi=[];jt(Mn,Vn,xt.toWireType(fi,Ds)),$e(fi)}}}),[{name:I.name,fromWireType:function(Me){var ke={};for(var Ze in we)ke[Ze]=we[Ze].read(Me);return oe(Me),ke},toWireType:function(Me,ke){for(var Ze in we)if(!(Ze in ke))throw new TypeError('Missing field:  "'+Ze+'"');var st=q();for(Ze in we)we[Ze].write(st,ke[Ze]);return Me!==null&&Me.push(oe,st),st},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:oe}]})}function dt(N,I,q,oe,he){}function Vt(N){switch(N){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+N)}}function Qn(){for(var N=new Array(256),I=0;I<256;++I)N[I]=String.fromCharCode(I);ht=N}var ht=void 0;function Ut(N){for(var I="",q=N;B[q];)I+=ht[B[q++]];return I}var Tt=void 0;function yt(N){throw new Tt(N)}function qn(N,I,q={}){if(!("argPackAdvance"in I))throw new TypeError("registerType registeredInstance requires argPackAdvance");var oe=I.name;if(N||yt('type "'+oe+'" must have a positive integer typeid pointer'),rt.hasOwnProperty(N)){if(q.ignoreDuplicateRegistrations)return;yt("Cannot register type '"+oe+"' twice")}if(rt[N]=I,delete mt[N],ot.hasOwnProperty(N)){var he=ot[N];delete ot[N],he.forEach(de=>de())}}function vr(N,I,q,oe,he){var de=Vt(q);I=Ut(I),qn(N,{name:I,fromWireType:function(ve){return!!ve},toWireType:function(ve,we){return we?oe:he},argPackAdvance:8,readValueFromPointer:function(ve){var we;if(q===1)we=W;else if(q===2)we=j;else if(q===4)we=ae;else throw new TypeError("Unknown boolean type size: "+I);return this.fromWireType(we[ve>>de])},destructorFunction:null})}function Ta(N){if(!(this instanceof _r)||!(N instanceof _r))return!1;for(var I=this.$$.ptrType.registeredClass,q=this.$$.ptr,oe=N.$$.ptrType.registeredClass,he=N.$$.ptr;I.baseClass;)q=I.upcast(q),I=I.baseClass;for(;oe.baseClass;)he=oe.upcast(he),oe=oe.baseClass;return I===oe&&q===he}function $i(N){return{count:N.count,deleteScheduled:N.deleteScheduled,preservePointerOnDelete:N.preservePointerOnDelete,ptr:N.ptr,ptrType:N.ptrType,smartPtr:N.smartPtr,smartPtrType:N.smartPtrType}}function Kr(N){function I(q){return q.$$.ptrType.registeredClass.name}yt(I(N)+" instance already deleted")}var Ti=!1;function Hi(N){}function xn(N){N.smartPtr?N.smartPtrType.rawDestructor(N.smartPtr):N.ptrType.registeredClass.rawDestructor(N.ptr)}function kr(N){N.count.value-=1;var I=N.count.value===0;I&&xn(N)}function Lt(N,I,q){if(I===q)return N;if(q.baseClass===void 0)return null;var oe=Lt(N,I,q.baseClass);return oe===null?null:q.downcast(oe)}var Fn={};function _a(){return Object.keys(wr).length}function yr(){var N=[];for(var I in wr)wr.hasOwnProperty(I)&&N.push(wr[I]);return N}var qr=[];function xr(){for(;qr.length;){var N=qr.pop();N.$$.deleteScheduled=!1,N.delete()}}var er=void 0;function oo(N){er=N,qr.length&&er&&er(xr)}function _i(){a.getInheritedInstanceCount=_a,a.getLiveInheritedInstances=yr,a.flushPendingDeletes=xr,a.setDelayFunction=oo}var wr={};function so(N,I){for(I===void 0&&yt("ptr should not be undefined");N.baseClass;)I=N.upcast(I),N=N.baseClass;return I}function Cr(N,I){return I=so(N,I),wr[I]}function Ki(N,I){(!I.ptrType||!I.ptr)&&On("makeClassHandle requires ptr and ptrType");var q=!!I.smartPtrType,oe=!!I.smartPtr;return q!==oe&&On("Both smartPtrType and smartPtr must be specified"),I.count={value:1},Tr(Object.create(N,{$$:{value:I}}))}function Si(N){var I=this.getPointee(N);if(!I)return this.destructor(N),null;var q=Cr(this.registeredClass,I);if(q!==void 0){if(q.$$.count.value===0)return q.$$.ptr=I,q.$$.smartPtr=N,q.clone();var oe=q.clone();return this.destructor(N),oe}function he(){return this.isSmartPointer?Ki(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:I,smartPtrType:this,smartPtr:N}):Ki(this.registeredClass.instancePrototype,{ptrType:this,ptr:N})}var de=this.registeredClass.getActualType(I),ve=Fn[de];if(!ve)return he.call(this);var we;this.isConst?we=ve.constPointerType:we=ve.pointerType;var Me=Lt(I,this.registeredClass,we.registeredClass);return Me===null?he.call(this):this.isSmartPointer?Ki(we.registeredClass.instancePrototype,{ptrType:we,ptr:Me,smartPtrType:this,smartPtr:N}):Ki(we.registeredClass.instancePrototype,{ptrType:we,ptr:Me})}function Tr(N){return typeof FinalizationRegistry>"u"?(Tr=I=>I,N):(Ti=new FinalizationRegistry(I=>{kr(I.$$)}),Tr=I=>{var q=I.$$,oe=!!q.smartPtr;if(oe){var he={$$:q};Ti.register(I,he,I)}return I},Hi=I=>Ti.unregister(I),Tr(N))}function Sa(){if(this.$$.ptr||Kr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var N=Tr(Object.create(Object.getPrototypeOf(this),{$$:{value:$i(this.$$)}}));return N.$$.count.value+=1,N.$$.deleteScheduled=!1,N}function bi(){this.$$.ptr||Kr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&yt("Object already scheduled for deletion"),Hi(this),kr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ur(){return!this.$$.ptr}function co(){return this.$$.ptr||Kr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&yt("Object already scheduled for deletion"),qr.push(this),qr.length===1&&er&&er(xr),this.$$.deleteScheduled=!0,this}function Wn(){_r.prototype.isAliasOf=Ta,_r.prototype.clone=Sa,_r.prototype.delete=bi,_r.prototype.isDeleted=Ur,_r.prototype.deleteLater=co}function _r(){}function qi(N,I,q){if(N[I].overloadTable===void 0){var oe=N[I];N[I]=function(){return N[I].overloadTable.hasOwnProperty(arguments.length)||yt("Function '"+q+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+N[I].overloadTable+")!"),N[I].overloadTable[arguments.length].apply(this,arguments)},N[I].overloadTable=[],N[I].overloadTable[oe.argCount]=oe}}function Xi(N,I,q){a.hasOwnProperty(N)?(yt("Cannot register public name '"+N+"' twice"),qi(a,N,N),a.hasOwnProperty(q)&&yt("Cannot register multiple overloads of a function with the same number of arguments ("+q+")!"),a[N].overloadTable[q]=I):a[N]=I}function ba(N,I,q,oe,he,de,ve,we){this.name=N,this.constructor=I,this.instancePrototype=q,this.rawDestructor=oe,this.baseClass=he,this.getActualType=de,this.upcast=ve,this.downcast=we,this.pureVirtualFunctions=[]}function Xr(N,I,q){for(;I!==q;)I.upcast||yt("Expected null or instance of "+q.name+", got an instance of "+I.name),N=I.upcast(N),I=I.baseClass;return N}function as(N,I){if(I===null)return this.isReference&&yt("null is not a valid "+this.name),0;I.$$||yt('Cannot pass "'+Ri(I)+'" as a '+this.name),I.$$.ptr||yt("Cannot pass deleted object as a pointer of type "+this.name);var q=I.$$.ptrType.registeredClass,oe=Xr(I.$$.ptr,q,this.registeredClass);return oe}function os(N,I){var q;if(I===null)return this.isReference&&yt("null is not a valid "+this.name),this.isSmartPointer?(q=this.rawConstructor(),N!==null&&N.push(this.rawDestructor,q),q):0;I.$$||yt('Cannot pass "'+Ri(I)+'" as a '+this.name),I.$$.ptr||yt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&I.$$.ptrType.isConst&&yt("Cannot convert argument of type "+(I.$$.smartPtrType?I.$$.smartPtrType.name:I.$$.ptrType.name)+" to parameter type "+this.name);var oe=I.$$.ptrType.registeredClass;if(q=Xr(I.$$.ptr,oe,this.registeredClass),this.isSmartPointer)switch(I.$$.smartPtr===void 0&&yt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:I.$$.smartPtrType===this?q=I.$$.smartPtr:yt("Cannot convert argument of type "+(I.$$.smartPtrType?I.$$.smartPtrType.name:I.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:q=I.$$.smartPtr;break;case 2:if(I.$$.smartPtrType===this)q=I.$$.smartPtr;else{var he=I.clone();q=this.rawShare(q,Br.toHandle(function(){he.delete()})),N!==null&&N.push(this.rawDestructor,q)}break;default:yt("Unsupporting sharing policy")}return q}function ss(N,I){if(I===null)return this.isReference&&yt("null is not a valid "+this.name),0;I.$$||yt('Cannot pass "'+Ri(I)+'" as a '+this.name),I.$$.ptr||yt("Cannot pass deleted object as a pointer of type "+this.name),I.$$.ptrType.isConst&&yt("Cannot convert argument of type "+I.$$.ptrType.name+" to parameter type "+this.name);var q=I.$$.ptrType.registeredClass,oe=Xr(I.$$.ptr,q,this.registeredClass);return oe}function cs(N){return this.rawGetPointee&&(N=this.rawGetPointee(N)),N}function Sr(N){this.rawDestructor&&this.rawDestructor(N)}function br(N){N!==null&&N.delete()}function cr(){zn.prototype.getPointee=cs,zn.prototype.destructor=Sr,zn.prototype.argPackAdvance=8,zn.prototype.readValueFromPointer=Xe,zn.prototype.deleteObject=br,zn.prototype.fromWireType=Si}function zn(N,I,q,oe,he,de,ve,we,Me,ke,Ze){this.name=N,this.registeredClass=I,this.isReference=q,this.isConst=oe,this.isSmartPointer=he,this.pointeeType=de,this.sharingPolicy=ve,this.rawGetPointee=we,this.rawConstructor=Me,this.rawShare=ke,this.rawDestructor=Ze,!he&&I.baseClass===void 0?oe?(this.toWireType=as,this.destructorFunction=null):(this.toWireType=ss,this.destructorFunction=null):this.toWireType=os}function uo(N,I,q){a.hasOwnProperty(N)||On("Replacing nonexistant public symbol"),a[N].overloadTable!==void 0&&q!==void 0||(a[N]=I,a[N].argCount=q)}function ci(N,I,q){var oe=a["dynCall_"+N];return q&&q.length?oe.apply(null,[I].concat(q)):oe.call(null,I)}var Ei=[];function wn(N){var I=Ei[N];return I||(N>=Ei.length&&(Ei.length=N+1),Ei[N]=I=Re.get(N)),I}function lo(N,I,q){if(N.includes("j"))return ci(N,I,q);var oe=wn(I).apply(null,q);return oe}function tr(N,I){var q=[];return function(){return q.length=0,Object.assign(q,arguments),lo(N,I,q)}}function In(N,I){N=Ut(N);function q(){return N.includes("j")?tr(N,I):wn(I)}var oe=q();return typeof oe!="function"&&yt("unknown function pointer with signature "+N+": "+I),oe}var Ea=void 0;function ui(N){var I=ct(N),q=Ut(I);return Qe(I),q}function nr(N,I){var q=[],oe={};function he(de){if(!oe[de]&&!rt[de]){if(mt[de]){mt[de].forEach(he);return}q.push(de),oe[de]=!0}}throw I.forEach(he),new Ea(N+": "+q.map(ui).join([", "]))}function Di(N,I,q,oe,he,de,ve,we,Me,ke,Ze,st,tt){Ze=Ut(Ze),de=In(he,de),we&&(we=In(ve,we)),ke&&(ke=In(Me,ke)),tt=In(st,tt);var Ct=nn(Ze);Xi(Ct,function(){nr("Cannot construct "+Ze+" due to unbound types",[oe])}),Le([N,I,q],oe?[oe]:[],function(xt){xt=xt[0];var jt,Mn;oe?(jt=xt.registeredClass,Mn=jt.instancePrototype):Mn=_r.prototype;var Vn=Pt(Ct,function(){if(Object.getPrototypeOf(this)!==Ds)throw new Tt("Use 'new' to construct "+Ze);if(fi.constructor_body===void 0)throw new Tt(Ze+" has no accessible constructor");var D2=fi.constructor_body[arguments.length];if(D2===void 0)throw new Tt("Tried to invoke ctor of "+Ze+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(fi.constructor_body).toString()+") parameters instead!");return D2.apply(this,arguments)}),Ds=Object.create(Mn,{constructor:{value:Vn}});Vn.prototype=Ds;var fi=new ba(Ze,Vn,Ds,tt,jt,de,we,ke),ql=new zn(Ze,fi,!0,!1,!1),uu=new zn(Ze+"*",fi,!1,!1,!1),E2=new zn(Ze+" const*",fi,!1,!0,!1);return Fn[N]={pointerType:uu,constPointerType:E2},uo(Ct,Vn),[ql,uu,E2]})}function fo(N,I){for(var q=[],oe=0;oe<N;oe++)q.push(fe[I+oe*4>>2]);return q}function ho(N,I){if(!(N instanceof Function))throw new TypeError("new_ called with constructor type "+typeof N+" which is not a function");var q=Pt(N.name||"unknownFunctionName",function(){});q.prototype=N.prototype;var oe=new q,he=N.apply(oe,I);return he instanceof Object?he:oe}function Yi(N,I,q,oe,he){var de=I.length;de<2&&yt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var ve=I[1]!==null&&q!==null,we=!1,Me=1;Me<I.length;++Me)if(I[Me]!==null&&I[Me].destructorFunction===void 0){we=!0;break}for(var ke=I[0].name!=="void",Ze="",st="",Me=0;Me<de-2;++Me)Ze+=(Me!==0?", ":"")+"arg"+Me,st+=(Me!==0?", ":"")+"arg"+Me+"Wired";var tt="return function "+nn(N)+"("+Ze+`) {
if (arguments.length !== `+(de-2)+`) {
throwBindingError('function `+N+" called with ' + arguments.length + ' arguments, expected "+(de-2)+` args!');
}
`;we&&(tt+=`var destructors = [];
`);var Ct=we?"destructors":"null",xt=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],jt=[yt,oe,he,$e,I[0],I[1]];ve&&(tt+="var thisWired = classParam.toWireType("+Ct+`, this);
`);for(var Me=0;Me<de-2;++Me)tt+="var arg"+Me+"Wired = argType"+Me+".toWireType("+Ct+", arg"+Me+"); // "+I[Me+2].name+`
`,xt.push("argType"+Me),jt.push(I[Me+2]);if(ve&&(st="thisWired"+(st.length>0?", ":"")+st),tt+=(ke?"var rv = ":"")+"invoker(fn"+(st.length>0?", ":"")+st+`);
`,we)tt+=`runDestructors(destructors);
`;else for(var Me=ve?1:2;Me<I.length;++Me){var Mn=Me===1?"thisWired":"arg"+(Me-2)+"Wired";I[Me].destructorFunction!==null&&(tt+=Mn+"_dtor("+Mn+"); // "+I[Me].name+`
`,xt.push(Mn+"_dtor"),jt.push(I[Me].destructorFunction))}ke&&(tt+=`var ret = retType.fromWireType(rv);
return ret;
`),tt+=`}
`,xt.push(tt);var Vn=ho(Function,xt).apply(null,jt);return Vn}function on(N,I,q,oe,he,de){D(I>0);var ve=fo(I,q);he=In(oe,he),Le([],[N],function(we){we=we[0];var Me="constructor "+we.name;if(we.registeredClass.constructor_body===void 0&&(we.registeredClass.constructor_body=[]),we.registeredClass.constructor_body[I-1]!==void 0)throw new Tt("Cannot register multiple constructors with identical number of parameters ("+(I-1)+") for class '"+we.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return we.registeredClass.constructor_body[I-1]=()=>{nr("Cannot construct "+we.name+" due to unbound types",ve)},Le([],ve,function(ke){return ke.splice(1,0,null),we.registeredClass.constructor_body[I-1]=Yi(Me,ke,null,he,de),[]}),[]})}function Oi(N,I,q,oe,he,de,ve,we){var Me=fo(q,oe);I=Ut(I),de=In(he,de),Le([],[N],function(ke){ke=ke[0];var Ze=ke.name+"."+I;I.startsWith("@@")&&(I=Symbol[I.substring(2)]),we&&ke.registeredClass.pureVirtualFunctions.push(I);function st(){nr("Cannot call "+Ze+" due to unbound types",Me)}var tt=ke.registeredClass.instancePrototype,Ct=tt[I];return Ct===void 0||Ct.overloadTable===void 0&&Ct.className!==ke.name&&Ct.argCount===q-2?(st.argCount=q-2,st.className=ke.name,tt[I]=st):(qi(tt,I,Ze),tt[I].overloadTable[q-2]=st),Le([],Me,function(xt){var jt=Yi(Ze,xt,ke,de,ve);return tt[I].overloadTable===void 0?(jt.argCount=q-2,tt[I]=jt):tt[I].overloadTable[q-2]=jt,[]}),[]})}var Pn=[],Rn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function po(N){N>4&&--Rn[N].refcount===0&&(Rn[N]=void 0,Pn.push(N))}function ur(){for(var N=0,I=5;I<Rn.length;++I)Rn[I]!==void 0&&++N;return N}function us(){for(var N=5;N<Rn.length;++N)if(Rn[N]!==void 0)return Rn[N];return null}function Xn(){a.count_emval_handles=ur,a.get_first_emval=us}var Br={toValue:N=>(N||yt("Cannot use deleted val. handle = "+N),Rn[N].value),toHandle:N=>{switch(N){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var I=Pn.length?Pn.pop():Rn.length;return Rn[I]={refcount:1,value:N},I}}}};function Da(N,I){I=Ut(I),qn(N,{name:I,fromWireType:function(q){var oe=Br.toValue(q);return po(q),oe},toWireType:function(q,oe){return Br.toHandle(oe)},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:null})}function Ri(N){if(N===null)return"null";var I=typeof N;return I==="object"||I==="array"||I==="function"?N.toString():""+N}function rr(N,I){switch(I){case 2:return function(q){return this.fromWireType(Ee[q>>2])};case 3:return function(q){return this.fromWireType(ge[q>>3])};default:throw new TypeError("Unknown float type: "+N)}}function go(N,I,q){var oe=Vt(q);I=Ut(I),qn(N,{name:I,fromWireType:function(he){return he},toWireType:function(he,de){return de},argPackAdvance:8,readValueFromPointer:rr(I,oe),destructorFunction:null})}function ls(N,I,q){switch(I){case 0:return q?function(he){return W[he]}:function(he){return B[he]};case 1:return q?function(he){return j[he>>1]}:function(he){return ie[he>>1]};case 2:return q?function(he){return ae[he>>2]}:function(he){return fe[he>>2]};default:throw new TypeError("Unknown integer type: "+N)}}function fs(N,I,q,oe,he){I=Ut(I);var de=Vt(q),ve=st=>st;if(oe===0){var we=32-8*q;ve=st=>st<<we>>>we}var Me=I.includes("unsigned"),ke=(st,tt)=>{},Ze;Me?Ze=function(st,tt){return ke(tt,this.name),tt>>>0}:Ze=function(st,tt){return ke(tt,this.name),tt},qn(N,{name:I,fromWireType:ve,toWireType:Ze,argPackAdvance:8,readValueFromPointer:ls(I,de,oe!==0),destructorFunction:null})}function mo(N,I,q){var oe=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],he=oe[I];function de(ve){ve=ve>>2;var we=fe,Me=we[ve],ke=we[ve+1];return new he(Y,ke,Me)}q=Ut(q),qn(N,{name:q,fromWireType:de,argPackAdvance:8,readValueFromPointer:de},{ignoreDuplicateRegistrations:!0})}function Mi(N,I){I=Ut(I);var q=I==="std::string";qn(N,{name:I,fromWireType:function(oe){var he=fe[oe>>2],de=oe+4,ve;if(q)for(var we=de,Me=0;Me<=he;++Me){var ke=de+Me;if(Me==he||B[ke]==0){var Ze=ke-we,st=F(we,Ze);ve===void 0?ve=st:(ve+="\0",ve+=st),we=ke+1}}else{for(var tt=new Array(he),Me=0;Me<he;++Me)tt[Me]=String.fromCharCode(B[de+Me]);ve=tt.join("")}return Qe(oe),ve},toWireType:function(oe,he){he instanceof ArrayBuffer&&(he=new Uint8Array(he));var de,ve=typeof he=="string";ve||he instanceof Uint8Array||he instanceof Uint8ClampedArray||he instanceof Int8Array||yt("Cannot pass non-string to std::string"),q&&ve?de=z(he):de=he.length;var we=je(4+de+1),Me=we+4;if(fe[we>>2]=de,q&&ve)U(he,Me,de+1);else if(ve)for(var ke=0;ke<de;++ke){var Ze=he.charCodeAt(ke);Ze>255&&(Qe(Me),yt("String has UTF-16 code units that do not fit in 8 bits")),B[Me+ke]=Ze}else for(var ke=0;ke<de;++ke)B[Me+ke]=he[ke];return oe!==null&&oe.push(Qe,we),we},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:function(oe){Qe(oe)}})}var vo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Oa(N,I){for(var q=N,oe=q>>1,he=oe+I/2;!(oe>=he)&&ie[oe];)++oe;if(q=oe<<1,q-N>32&&vo)return vo.decode(B.subarray(N,q));for(var de="",ve=0;!(ve>=I/2);++ve){var we=j[N+ve*2>>1];if(we==0)break;de+=String.fromCharCode(we)}return de}function hs(N,I,q){if(q===void 0&&(q=2147483647),q<2)return 0;q-=2;for(var oe=I,he=q<N.length*2?q/2:N.length,de=0;de<he;++de){var ve=N.charCodeAt(de);j[I>>1]=ve,I+=2}return j[I>>1]=0,I-oe}function ps(N){return N.length*2}function ds(N,I){for(var q=0,oe="";!(q>=I/4);){var he=ae[N+q*4>>2];if(he==0)break;if(++q,he>=65536){var de=he-65536;oe+=String.fromCharCode(55296|de>>10,56320|de&1023)}else oe+=String.fromCharCode(he)}return oe}function gs(N,I,q){if(q===void 0&&(q=2147483647),q<4)return 0;for(var oe=I,he=oe+q-4,de=0;de<N.length;++de){var ve=N.charCodeAt(de);if(ve>=55296&&ve<=57343){var we=N.charCodeAt(++de);ve=65536+((ve&1023)<<10)|we&1023}if(ae[I>>2]=ve,I+=4,I+4>he)break}return ae[I>>2]=0,I-oe}function ms(N){for(var I=0,q=0;q<N.length;++q){var oe=N.charCodeAt(q);oe>=55296&&oe<=57343&&++q,I+=4}return I}function vs(N,I,q){q=Ut(q);var oe,he,de,ve,we;I===2?(oe=Oa,he=hs,ve=ps,de=()=>ie,we=1):I===4&&(oe=ds,he=gs,ve=ms,de=()=>fe,we=2),qn(N,{name:q,fromWireType:function(Me){for(var ke=fe[Me>>2],Ze=de(),st,tt=Me+4,Ct=0;Ct<=ke;++Ct){var xt=Me+4+Ct*I;if(Ct==ke||Ze[xt>>we]==0){var jt=xt-tt,Mn=oe(tt,jt);st===void 0?st=Mn:(st+="\0",st+=Mn),tt=xt+I}}return Qe(Me),st},toWireType:function(Me,ke){typeof ke!="string"&&yt("Cannot pass non-string to C++ string type "+q);var Ze=ve(ke),st=je(4+Ze+I);return fe[st>>2]=Ze>>we,he(ke,st+4,Ze+I),Me!==null&&Me.push(Qe,st),st},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:function(Me){Qe(Me)}})}function ys(N,I,q,oe,he,de){ze[N]={name:Ut(I),rawConstructor:In(q,oe),rawDestructor:In(he,de),fields:[]}}function yo(N,I,q,oe,he,de,ve,we,Me,ke){ze[N].fields.push({fieldName:Ut(I),getterReturnType:q,getter:In(oe,he),getterContext:de,setterArgumentType:ve,setter:In(we,Me),setterContext:ke})}function xs(N,I){I=Ut(I),qn(N,{isVoid:!0,name:I,argPackAdvance:0,fromWireType:function(){},toWireType:function(q,oe){}})}function xo(){throw 1/0}var wo={};function ws(N){var I=wo[N];return I===void 0?Ut(N):I}function Ra(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Co(N){return N===0?Br.toHandle(Ra()):(N=ws(N),Br.toHandle(Ra()[N]))}function To(N){N>4&&(Rn[N].refcount+=1)}function Ma(N,I){var q=rt[N];return q===void 0&&yt(I+" has unknown type "+ui(N)),q}function Cs(N){for(var I="",q=0;q<N;++q)I+=(q!==0?", ":"")+"arg"+q;for(var oe=()=>fe,he="return function emval_allocator_"+N+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,q=0;q<N;++q)he+="var argType"+q+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+q+`');
var arg`+q+" = argType"+q+`.readValueFromPointer(args);
args += argType`+q+`['argPackAdvance'];
argTypes += 4;
`;return he+="var obj = new constructor("+I+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",he)(Ma,a,Br.toHandle,oe)}var _o={};function Ts(N,I,q,oe){N=Br.toValue(N);var he=_o[I];return he||(he=Cs(I),_o[I]=he),he(N,q,oe)}function So(N,I){N=Ma(N,"_emval_take_value");var q=N.readValueFromPointer(I);return Br.toHandle(q)}function _s(){K("")}function Ss(N,I,q){B.copyWithin(N,I,I+q)}function bs(){return 2147483648}function Es(N){try{return S.grow(N-Y.byteLength+65535>>>16),be(S.buffer),1}catch{}}function Na(N){var I=B.length;N=N>>>0;var q=bs();if(N>q)return!1;let oe=(Me,ke)=>Me+(ke-Me%ke)%ke;for(var he=1;he<=4;he*=2){var de=I*(1+.2/he);de=Math.min(de,N+100663296);var ve=Math.min(q,oe(Math.max(N,de),65536)),we=Es(ve);if(we)return!0}return!1}var La={};function Yr(){return l||"./this.program"}function li(){if(!li.strings){var N=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",I={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:N,_:Yr()};for(var q in La)La[q]===void 0?delete I[q]:I[q]=La[q];var oe=[];for(var q in I)oe.push(q+"="+I[q]);li.strings=oe}return li.strings}function Er(N,I,q){for(var oe=0;oe<N.length;++oe)W[I++>>0]=N.charCodeAt(oe);W[I>>0]=0}function bo(N,I){var q=0;return li().forEach(function(oe,he){var de=I+q;fe[N+he*4>>2]=de,Er(oe,de),q+=oe.length+1}),0}function Eo(N,I){var q=li();fe[N>>2]=q.length;var oe=0;return q.forEach(function(he){oe+=he.length+1}),fe[I>>2]=oe,0}function Aa(N){f(N,new Ye(N))}function Do(N,I){Aa(N)}var Ji=Do;function Oo(N){return 52}function Q(N,I,q,oe,he){return 70}var ee=[null,[],[]];function pe(N,I){var q=ee[N];I===0||I===10?((N===1?C:T)(R(q,0)),q.length=0):q.push(I)}function Oe(N,I,q,oe){for(var he=0,de=0;de<q;de++){var ve=fe[I>>2],we=fe[I+4>>2];I+=8;for(var Me=0;Me<we;Me++)pe(N,B[ve+Me]);he+=we}return fe[oe>>2]=he,0}function Ie(N){var I=a["_"+N];return I}function Be(N,I){W.set(N,I)}function Ge(N,I,q,oe,he){var de={string:xt=>{var jt=0;if(xt!=null&&xt!==0){var Mn=(xt.length<<2)+1;jt=X(Mn),U(xt,jt,Mn)}return jt},array:xt=>{var jt=X(xt.length);return Be(xt,jt),jt}};function ve(xt){return I==="string"?F(xt):I==="boolean"?!!xt:xt}var we=Ie(N),Me=[],ke=0;if(oe)for(var Ze=0;Ze<oe.length;Ze++){var st=de[q[Ze]];st?(ke===0&&(ke=gt()),Me[Ze]=st(oe[Ze])):Me[Ze]=oe[Ze]}var tt=we.apply(null,Me);function Ct(xt){return ke!==0&&Z(ke),ve(xt)}return tt=Ct(tt),tt}Vr=a.InternalError=Ht(Error,"InternalError"),Qn(),Tt=a.BindingError=Ht(Error,"BindingError"),Wn(),_i(),cr(),Ea=a.UnboundTypeError=Ht(Error,"UnboundTypeError"),Xn();var Pe={g:Fe,A:Ke,w:dt,F:vr,u:Di,t:on,c:Oi,E:Da,m:go,b:fs,a:mo,l:Mi,h:vs,J:ys,d:yo,G:xs,x:xo,i:po,r:Co,p:To,q:Ts,s:So,j:_s,D:Ss,y:Na,z:bo,B:Eo,I:Ji,C:Oo,v:Q,k:Oe,o:Ae,n:Ve,H:We,f:Se,e:He};Ue(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.L).apply(null,arguments)};var je=a._malloc=function(){return(je=a._malloc=a.asm.N).apply(null,arguments)},Qe=a._free=function(){return(Qe=a._free=a.asm.O).apply(null,arguments)},ct=a.___getTypeName=function(){return(ct=a.___getTypeName=a.asm.P).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.Q).apply(null,arguments)};var pt=a._setThrew=function(){return(pt=a._setThrew=a.asm.R).apply(null,arguments)},gt=a.stackSave=function(){return(gt=a.stackSave=a.asm.S).apply(null,arguments)},Z=a.stackRestore=function(){return(Z=a.stackRestore=a.asm.T).apply(null,arguments)},X=a.stackAlloc=function(){return(X=a.stackAlloc=a.asm.U).apply(null,arguments)},le=a.___cxa_is_pointer_type=function(){return(le=a.___cxa_is_pointer_type=a.asm.V).apply(null,arguments)};a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.W).apply(null,arguments)};function Se(N,I){var q=gt();try{wn(N)(I)}catch(oe){if(Z(q),oe!==oe+0)throw oe;pt(1,0)}}function Ae(N,I){var q=gt();try{return wn(N)(I)}catch(oe){if(Z(q),oe!==oe+0)throw oe;pt(1,0)}}function He(N,I,q,oe){var he=gt();try{wn(N)(I,q,oe)}catch(de){if(Z(he),de!==de+0)throw de;pt(1,0)}}function We(N,I,q,oe){var he=gt();try{return wn(N)(I,q,oe)}catch(de){if(Z(he),de!==de+0)throw de;pt(1,0)}}function Ve(N,I,q){var oe=gt();try{return wn(N)(I,q)}catch(he){if(Z(oe),he!==he+0)throw he;pt(1,0)}}a.ccall=Ge;var V;me=function N(){V||G(),V||(me=N)};function G(N){if(se>0||(O(),se>0))return;function I(){V||(V=!0,a.calledRun=!0,!b&&(A(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),L()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),I()},1)):I()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return G(),i.ready}})();t.exports=n}(nd)),nd.exports}var rH=nH();const iH=wa(rH),aH=new URL("/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),uf={codec:void 0,decoder:void 0};function oH(){if(uf.codec)return Promise.resolve();const t=iH({locateFile:e=>e.endsWith(".wasm")?aH.toString():e});return new Promise((e,n)=>{t.then(r=>{uf.codec=r,uf.decoder=new r.JPEGDecoder,e()},n)})}async function sH(t,e){await oH();const n=uf.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer(),o={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},s=cH(i,a),c={frameInfo:i};return{...e,pixelData:s,imageInfo:o,encodeOptions:c,...c,...o}}function cH(t,e){return t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}const uH="modulepreload",lH=function(t){return"/"+t},Wy={},$w=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");i=c(n.map(l=>{if(l=lH(l),l in Wy)return;Wy[l]=!0;const f=l.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":uH,f||(h.as="script"),h.crossOrigin="",h.href=l,s&&h.setAttribute("nonce",s),document.head.appendChild(h),f)return new Promise((p,d)=>{h.addEventListener("load",p),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})},Qu={JpegImage:void 0,decodeConfig:{}};function fH(t){return Qu.decodeConfig=t,Qu.JpegImage?Promise.resolve():new Promise((e,n)=>{$w(()=>import("./jpeg-DbLkkf_e.js"),[]).then(r=>{Qu.JpegImage=r.default,e()}).catch(n)})}async function hH(t,e){if(await fH(),typeof Qu.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const n=new Qu.JpegImage;if(n.parse(e),n.colorTransform=!1,t.bitsAllocated===8)return t.pixelData=n.getData(t.columns,t.rows),t;if(t.bitsAllocated===16)return t.pixelData=n.getData16(t.columns,t.rows),t}const el={jpeg:void 0,decodeConfig:{}};function pH(t){return el.decodeConfig=t,el.jpeg?Promise.resolve():new Promise((e,n)=>{$w(async()=>{const{Decoder:r}=await import("./lossless-DVKeooSO.js");return{Decoder:r}},[]).then(({Decoder:r})=>{const i=new r;el.jpeg=i,e()},n)})}async function zy(t,e){if(await pH(),typeof el.jpeg>"u")throw new Error("No JPEG Lossless decoder loaded");const n=t.bitsAllocated<=8?1:2,r=e.buffer,i=el.jpeg.decode(r,e.byteOffset,e.length,n);return t.pixelRepresentation===0?t.bitsAllocated===16?(t.pixelData=new Uint16Array(i.buffer),t):(t.pixelData=new Uint8Array(i.buffer),t):(t.pixelData=new Int16Array(i.buffer),t)}var rd={exports:{}},jy;function dH(){return jy||(jy=1,function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(Q,ee){o=Q,s=ee});var c=Object.assign({},a),l=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function p(Q){return a.locateFile?a.locateFile(Q,h):h+Q}var d,g,y;if(u){var x=da,m=da;f?h=m.dirname(h)+"/":h=__dirname+"/",d=(Q,ee)=>(Q=K(Q)?new URL(Q):m.normalize(Q),x.readFileSync(Q,ee?void 0:"utf8")),y=Q=>{var ee=d(Q,!0);return ee.buffer||(ee=new Uint8Array(ee)),ee},g=(Q,ee,pe)=>{Q=K(Q)?new URL(Q):m.normalize(Q),x.readFile(Q,function(Oe,Ie){Oe?pe(Oe):ee(Ie.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(Q){if(!(Q instanceof De))throw Q}),process.on("unhandledRejection",function(Q){throw Q}),a.inspect=function(){return"[Emscripten Module object]"}}else(l||f)&&(f?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",d=Q=>{var ee=new XMLHttpRequest;return ee.open("GET",Q,!1),ee.send(null),ee.responseText},f&&(y=Q=>{var ee=new XMLHttpRequest;return ee.open("GET",Q,!1),ee.responseType="arraybuffer",ee.send(null),new Uint8Array(ee.response)}),g=(Q,ee,pe)=>{var Oe=new XMLHttpRequest;Oe.open("GET",Q,!0),Oe.responseType="arraybuffer",Oe.onload=()=>{if(Oe.status==200||Oe.status==0&&Oe.response){ee(Oe.response);return}pe()},Oe.onerror=pe,Oe.send(null)});a.print||console.log.bind(console);var v=a.printErr||console.warn.bind(console);Object.assign(a,c),c=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var w;a.wasmBinary&&(w=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&me("no native wasm support detected");var C,T=!1;function _(Q,ee){Q||me(ee)}var S=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function b(Q,ee,pe){for(var Oe=ee+pe,Ie=ee;Q[Ie]&&!(Ie>=Oe);)++Ie;if(Ie-ee>16&&Q.buffer&&S)return S.decode(Q.subarray(ee,Ie));for(var Be="";ee<Ie;){var Ge=Q[ee++];if(!(Ge&128)){Be+=String.fromCharCode(Ge);continue}var Pe=Q[ee++]&63;if((Ge&224)==192){Be+=String.fromCharCode((Ge&31)<<6|Pe);continue}var je=Q[ee++]&63;if((Ge&240)==224?Ge=(Ge&15)<<12|Pe<<6|je:Ge=(Ge&7)<<18|Pe<<12|je<<6|Q[ee++]&63,Ge<65536)Be+=String.fromCharCode(Ge);else{var Qe=Ge-65536;Be+=String.fromCharCode(55296|Qe>>10,56320|Qe&1023)}}return Be}function D(Q,ee){return Q?b(z,Q,ee):""}function E(Q,ee,pe,Oe){if(!(Oe>0))return 0;for(var Ie=pe,Be=pe+Oe-1,Ge=0;Ge<Q.length;++Ge){var Pe=Q.charCodeAt(Ge);if(Pe>=55296&&Pe<=57343){var je=Q.charCodeAt(++Ge);Pe=65536+((Pe&1023)<<10)|je&1023}if(Pe<=127){if(pe>=Be)break;ee[pe++]=Pe}else if(Pe<=2047){if(pe+1>=Be)break;ee[pe++]=192|Pe>>6,ee[pe++]=128|Pe&63}else if(Pe<=65535){if(pe+2>=Be)break;ee[pe++]=224|Pe>>12,ee[pe++]=128|Pe>>6&63,ee[pe++]=128|Pe&63}else{if(pe+3>=Be)break;ee[pe++]=240|Pe>>18,ee[pe++]=128|Pe>>12&63,ee[pe++]=128|Pe>>6&63,ee[pe++]=128|Pe&63}}return ee[pe]=0,pe-Ie}function R(Q,ee,pe){return E(Q,z,ee,pe)}function F(Q){for(var ee=0,pe=0;pe<Q.length;++pe){var Oe=Q.charCodeAt(pe);Oe<=127?ee++:Oe<=2047?ee+=2:Oe>=55296&&Oe<=57343?(ee+=4,++pe):ee+=3}return ee}var M,U,z,Y,W,B,j,ie,ae;function fe(Q){M=Q,a.HEAP8=U=new Int8Array(Q),a.HEAP16=Y=new Int16Array(Q),a.HEAP32=B=new Int32Array(Q),a.HEAPU8=z=new Uint8Array(Q),a.HEAPU16=W=new Uint16Array(Q),a.HEAPU32=j=new Uint32Array(Q),a.HEAPF32=ie=new Float32Array(Q),a.HEAPF64=ae=new Float64Array(Q)}a.INITIAL_MEMORY;var Ee,ge=[],be=[],Re=[];function Ne(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)O(a.preRun.shift());te(ge)}function Ce(){te(be)}function P(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)L(a.postRun.shift());te(Re)}function O(Q){ge.unshift(Q)}function A(Q){be.unshift(Q)}function L(Q){Re.unshift(Q)}var k=0,$=null;function H(Q){k++,a.monitorRunDependencies&&a.monitorRunDependencies(k)}function se(Q){if(k--,a.monitorRunDependencies&&a.monitorRunDependencies(k),k==0&&$){var ee=$;$=null,ee()}}function me(Q){a.onAbort&&a.onAbort(Q),Q="Aborted("+Q+")",v(Q),T=!0,Q+=". Build with -sASSERTIONS for more info.";var ee=new WebAssembly.RuntimeError(Q);throw s(ee),ee}var ye="data:application/octet-stream;base64,";function _e(Q){return Q.startsWith(ye)}function K(Q){return Q.startsWith("file://")}var ne;ne="charlswasm_decode.wasm",_e(ne)||(ne=p(ne));function ce(Q){try{if(Q==ne&&w)return new Uint8Array(w);if(y)return y(Q);throw"both async and sync fetching of the wasm failed"}catch(ee){me(ee)}}function re(){if(!w&&(l||f)){if(typeof fetch=="function"&&!K(ne))return fetch(ne,{credentials:"same-origin"}).then(function(Q){if(!Q.ok)throw"failed to load wasm binary file at '"+ne+"'";return Q.arrayBuffer()}).catch(function(){return ce(ne)});if(g)return new Promise(function(Q,ee){g(ne,function(pe){Q(new Uint8Array(pe))},ee)})}return Promise.resolve().then(function(){return ce(ne)})}function ue(){var Q={a:La};function ee(Ge,Pe){var je=Ge.exports;a.asm=je,C=a.asm.z,fe(C.buffer),Ee=a.asm.C,A(a.asm.A),se()}H();function pe(Ge){ee(Ge.instance)}function Oe(Ge){return re().then(function(Pe){return WebAssembly.instantiate(Pe,Q)}).then(function(Pe){return Pe}).then(Ge,function(Pe){v("failed to asynchronously prepare wasm: "+Pe),me(Pe)})}function Ie(){return!w&&typeof WebAssembly.instantiateStreaming=="function"&&!_e(ne)&&!K(ne)&&!u&&typeof fetch=="function"?fetch(ne,{credentials:"same-origin"}).then(function(Ge){var Pe=WebAssembly.instantiateStreaming(Ge,Q);return Pe.then(pe,function(je){return v("wasm streaming compile failed: "+je),v("falling back to ArrayBuffer instantiation"),Oe(pe)})}):Oe(pe)}if(a.instantiateWasm)try{var Be=a.instantiateWasm(Q,ee);return Be}catch(Ge){v("Module.instantiateWasm callback failed with error: "+Ge),s(Ge)}return Ie().catch(s),{}}function De(Q){this.name="ExitStatus",this.message="Program terminated with exit("+Q+")",this.status=Q}function te(Q){for(;Q.length>0;)Q.shift()(a)}function Ue(Q){this.excPtr=Q,this.ptr=Q-24,this.set_type=function(ee){j[this.ptr+4>>2]=ee},this.get_type=function(){return j[this.ptr+4>>2]},this.set_destructor=function(ee){j[this.ptr+8>>2]=ee},this.get_destructor=function(){return j[this.ptr+8>>2]},this.set_refcount=function(ee){B[this.ptr>>2]=ee},this.set_caught=function(ee){ee=ee?1:0,U[this.ptr+12>>0]=ee},this.get_caught=function(){return U[this.ptr+12>>0]!=0},this.set_rethrown=function(ee){ee=ee?1:0,U[this.ptr+13>>0]=ee},this.get_rethrown=function(){return U[this.ptr+13>>0]!=0},this.init=function(ee,pe){this.set_adjusted_ptr(0),this.set_type(ee),this.set_destructor(pe),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var ee=B[this.ptr>>2];B[this.ptr>>2]=ee+1},this.release_ref=function(){var ee=B[this.ptr>>2];return B[this.ptr>>2]=ee-1,ee===1},this.set_adjusted_ptr=function(ee){j[this.ptr+16>>2]=ee},this.get_adjusted_ptr=function(){return j[this.ptr+16>>2]},this.get_exception_ptr=function(){var ee=Do(this.get_type());if(ee)return j[this.excPtr>>2];var pe=this.get_adjusted_ptr();return pe!==0?pe:this.excPtr}}function Ye(Q,ee,pe){var Oe=new Ue(Q);throw Oe.init(ee,pe),Q}var qe={};function xe(Q){for(;Q.length;){var ee=Q.pop(),pe=Q.pop();pe(ee)}}function Fe(Q){return this.fromWireType(B[Q>>2])}var ze={},$e={},Xe={},ot=48,rt=57;function mt(Q){if(Q===void 0)return"_unknown";Q=Q.replace(/[^a-zA-Z0-9_]/g,"$");var ee=Q.charCodeAt(0);return ee>=ot&&ee<=rt?"_"+Q:Q}function wt(Q,ee){return Q=mt(Q),new Function("body","return function "+Q+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(ee)}function qt(Q,ee){var pe=wt(ee,function(Oe){this.name=ee,this.message=Oe;var Ie=new Error(Oe).stack;Ie!==void 0&&(this.stack=this.toString()+`
`+Ie.replace(/^Error(:[^\n]*)?\n/,""))});return pe.prototype=Object.create(Q.prototype),pe.prototype.constructor=pe,pe.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},pe}var nn=void 0;function Pt(Q){throw new nn(Q)}function Ht(Q,ee,pe){Q.forEach(function(Pe){Xe[Pe]=ee});function Oe(Pe){var je=pe(Pe);je.length!==Q.length&&Pt("Mismatched type converter count");for(var Qe=0;Qe<Q.length;++Qe)Ut(Q[Qe],je[Qe])}var Ie=new Array(ee.length),Be=[],Ge=0;ee.forEach((Pe,je)=>{$e.hasOwnProperty(Pe)?Ie[je]=$e[Pe]:(Be.push(Pe),ze.hasOwnProperty(Pe)||(ze[Pe]=[]),ze[Pe].push(()=>{Ie[je]=$e[Pe],++Ge,Ge===Be.length&&Oe(Ie)}))}),Be.length===0&&Oe(Ie)}function Vr(Q){var ee=qe[Q];delete qe[Q];var pe=ee.rawConstructor,Oe=ee.rawDestructor,Ie=ee.fields,Be=Ie.map(Ge=>Ge.getterReturnType).concat(Ie.map(Ge=>Ge.setterArgumentType));Ht([Q],Be,Ge=>{var Pe={};return Ie.forEach((je,Qe)=>{var ct=je.fieldName,pt=Ge[Qe],gt=je.getter,Z=je.getterContext,X=Ge[Qe+Ie.length],le=je.setter,Se=je.setterContext;Pe[ct]={read:Ae=>pt.fromWireType(gt(Z,Ae)),write:(Ae,He)=>{var We=[];le(Se,Ae,X.toWireType(We,He)),xe(We)}}}),[{name:ee.name,fromWireType:function(je){var Qe={};for(var ct in Pe)Qe[ct]=Pe[ct].read(je);return Oe(je),Qe},toWireType:function(je,Qe){for(var ct in Pe)if(!(ct in Qe))throw new TypeError('Missing field:  "'+ct+'"');var pt=pe();for(ct in Pe)Pe[ct].write(pt,Qe[ct]);return je!==null&&je.push(Oe,pt),pt},argPackAdvance:8,readValueFromPointer:Fe,destructorFunction:Oe}]})}function On(Q,ee,pe,Oe,Ie){}function Le(Q){switch(Q){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+Q)}}function Ke(){for(var Q=new Array(256),ee=0;ee<256;++ee)Q[ee]=String.fromCharCode(ee);dt=Q}var dt=void 0;function Vt(Q){for(var ee="",pe=Q;z[pe];)ee+=dt[z[pe++]];return ee}var Qn=void 0;function ht(Q){throw new Qn(Q)}function Ut(Q,ee,pe={}){if(!("argPackAdvance"in ee))throw new TypeError("registerType registeredInstance requires argPackAdvance");var Oe=ee.name;if(Q||ht('type "'+Oe+'" must have a positive integer typeid pointer'),$e.hasOwnProperty(Q)){if(pe.ignoreDuplicateRegistrations)return;ht("Cannot register type '"+Oe+"' twice")}if($e[Q]=ee,delete Xe[Q],ze.hasOwnProperty(Q)){var Ie=ze[Q];delete ze[Q],Ie.forEach(Be=>Be())}}function Tt(Q,ee,pe,Oe,Ie){var Be=Le(pe);ee=Vt(ee),Ut(Q,{name:ee,fromWireType:function(Ge){return!!Ge},toWireType:function(Ge,Pe){return Pe?Oe:Ie},argPackAdvance:8,readValueFromPointer:function(Ge){var Pe;if(pe===1)Pe=U;else if(pe===2)Pe=Y;else if(pe===4)Pe=B;else throw new TypeError("Unknown boolean type size: "+ee);return this.fromWireType(Pe[Ge>>Be])},destructorFunction:null})}function yt(Q){if(!(this instanceof Ur)||!(Q instanceof Ur))return!1;for(var ee=this.$$.ptrType.registeredClass,pe=this.$$.ptr,Oe=Q.$$.ptrType.registeredClass,Ie=Q.$$.ptr;ee.baseClass;)pe=ee.upcast(pe),ee=ee.baseClass;for(;Oe.baseClass;)Ie=Oe.upcast(Ie),Oe=Oe.baseClass;return ee===Oe&&pe===Ie}function qn(Q){return{count:Q.count,deleteScheduled:Q.deleteScheduled,preservePointerOnDelete:Q.preservePointerOnDelete,ptr:Q.ptr,ptrType:Q.ptrType,smartPtr:Q.smartPtr,smartPtrType:Q.smartPtrType}}function vr(Q){function ee(pe){return pe.$$.ptrType.registeredClass.name}ht(ee(Q)+" instance already deleted")}var Ta=!1;function $i(Q){}function Kr(Q){Q.smartPtr?Q.smartPtrType.rawDestructor(Q.smartPtr):Q.ptrType.registeredClass.rawDestructor(Q.ptr)}function Ti(Q){Q.count.value-=1;var ee=Q.count.value===0;ee&&Kr(Q)}function Hi(Q,ee,pe){if(ee===pe)return Q;if(pe.baseClass===void 0)return null;var Oe=Hi(Q,ee,pe.baseClass);return Oe===null?null:pe.downcast(Oe)}var xn={};function kr(){return Object.keys(er).length}function Lt(){var Q=[];for(var ee in er)er.hasOwnProperty(ee)&&Q.push(er[ee]);return Q}var Fn=[];function _a(){for(;Fn.length;){var Q=Fn.pop();Q.$$.deleteScheduled=!1,Q.delete()}}var yr=void 0;function qr(Q){yr=Q,Fn.length&&yr&&yr(_a)}function xr(){a.getInheritedInstanceCount=kr,a.getLiveInheritedInstances=Lt,a.flushPendingDeletes=_a,a.setDelayFunction=qr}var er={};function oo(Q,ee){for(ee===void 0&&ht("ptr should not be undefined");Q.baseClass;)ee=Q.upcast(ee),Q=Q.baseClass;return ee}function _i(Q,ee){return ee=oo(Q,ee),er[ee]}function wr(Q,ee){(!ee.ptrType||!ee.ptr)&&Pt("makeClassHandle requires ptr and ptrType");var pe=!!ee.smartPtrType,Oe=!!ee.smartPtr;return pe!==Oe&&Pt("Both smartPtrType and smartPtr must be specified"),ee.count={value:1},Cr(Object.create(Q,{$$:{value:ee}}))}function so(Q){var ee=this.getPointee(Q);if(!ee)return this.destructor(Q),null;var pe=_i(this.registeredClass,ee);if(pe!==void 0){if(pe.$$.count.value===0)return pe.$$.ptr=ee,pe.$$.smartPtr=Q,pe.clone();var Oe=pe.clone();return this.destructor(Q),Oe}function Ie(){return this.isSmartPointer?wr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:ee,smartPtrType:this,smartPtr:Q}):wr(this.registeredClass.instancePrototype,{ptrType:this,ptr:Q})}var Be=this.registeredClass.getActualType(ee),Ge=xn[Be];if(!Ge)return Ie.call(this);var Pe;this.isConst?Pe=Ge.constPointerType:Pe=Ge.pointerType;var je=Hi(ee,this.registeredClass,Pe.registeredClass);return je===null?Ie.call(this):this.isSmartPointer?wr(Pe.registeredClass.instancePrototype,{ptrType:Pe,ptr:je,smartPtrType:this,smartPtr:Q}):wr(Pe.registeredClass.instancePrototype,{ptrType:Pe,ptr:je})}function Cr(Q){return typeof FinalizationRegistry>"u"?(Cr=ee=>ee,Q):(Ta=new FinalizationRegistry(ee=>{Ti(ee.$$)}),Cr=ee=>{var pe=ee.$$,Oe=!!pe.smartPtr;if(Oe){var Ie={$$:pe};Ta.register(ee,Ie,ee)}return ee},$i=ee=>Ta.unregister(ee),Cr(Q))}function Ki(){if(this.$$.ptr||vr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Q=Cr(Object.create(Object.getPrototypeOf(this),{$$:{value:qn(this.$$)}}));return Q.$$.count.value+=1,Q.$$.deleteScheduled=!1,Q}function Si(){this.$$.ptr||vr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ht("Object already scheduled for deletion"),$i(this),Ti(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Tr(){return!this.$$.ptr}function Sa(){return this.$$.ptr||vr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ht("Object already scheduled for deletion"),Fn.push(this),Fn.length===1&&yr&&yr(_a),this.$$.deleteScheduled=!0,this}function bi(){Ur.prototype.isAliasOf=yt,Ur.prototype.clone=Ki,Ur.prototype.delete=Si,Ur.prototype.isDeleted=Tr,Ur.prototype.deleteLater=Sa}function Ur(){}function co(Q,ee,pe){if(Q[ee].overloadTable===void 0){var Oe=Q[ee];Q[ee]=function(){return Q[ee].overloadTable.hasOwnProperty(arguments.length)||ht("Function '"+pe+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+Q[ee].overloadTable+")!"),Q[ee].overloadTable[arguments.length].apply(this,arguments)},Q[ee].overloadTable=[],Q[ee].overloadTable[Oe.argCount]=Oe}}function Wn(Q,ee,pe){a.hasOwnProperty(Q)?((pe===void 0||a[Q].overloadTable!==void 0&&a[Q].overloadTable[pe]!==void 0)&&ht("Cannot register public name '"+Q+"' twice"),co(a,Q,Q),a.hasOwnProperty(pe)&&ht("Cannot register multiple overloads of a function with the same number of arguments ("+pe+")!"),a[Q].overloadTable[pe]=ee):(a[Q]=ee,pe!==void 0&&(a[Q].numArguments=pe))}function _r(Q,ee,pe,Oe,Ie,Be,Ge,Pe){this.name=Q,this.constructor=ee,this.instancePrototype=pe,this.rawDestructor=Oe,this.baseClass=Ie,this.getActualType=Be,this.upcast=Ge,this.downcast=Pe,this.pureVirtualFunctions=[]}function qi(Q,ee,pe){for(;ee!==pe;)ee.upcast||ht("Expected null or instance of "+pe.name+", got an instance of "+ee.name),Q=ee.upcast(Q),ee=ee.baseClass;return Q}function Xi(Q,ee){if(ee===null)return this.isReference&&ht("null is not a valid "+this.name),0;ee.$$||ht('Cannot pass "'+Xn(ee)+'" as a '+this.name),ee.$$.ptr||ht("Cannot pass deleted object as a pointer of type "+this.name);var pe=ee.$$.ptrType.registeredClass,Oe=qi(ee.$$.ptr,pe,this.registeredClass);return Oe}function ba(Q,ee){var pe;if(ee===null)return this.isReference&&ht("null is not a valid "+this.name),this.isSmartPointer?(pe=this.rawConstructor(),Q!==null&&Q.push(this.rawDestructor,pe),pe):0;ee.$$||ht('Cannot pass "'+Xn(ee)+'" as a '+this.name),ee.$$.ptr||ht("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&ee.$$.ptrType.isConst&&ht("Cannot convert argument of type "+(ee.$$.smartPtrType?ee.$$.smartPtrType.name:ee.$$.ptrType.name)+" to parameter type "+this.name);var Oe=ee.$$.ptrType.registeredClass;if(pe=qi(ee.$$.ptr,Oe,this.registeredClass),this.isSmartPointer)switch(ee.$$.smartPtr===void 0&&ht("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:ee.$$.smartPtrType===this?pe=ee.$$.smartPtr:ht("Cannot convert argument of type "+(ee.$$.smartPtrType?ee.$$.smartPtrType.name:ee.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:pe=ee.$$.smartPtr;break;case 2:if(ee.$$.smartPtrType===this)pe=ee.$$.smartPtr;else{var Ie=ee.clone();pe=this.rawShare(pe,ur.toHandle(function(){Ie.delete()})),Q!==null&&Q.push(this.rawDestructor,pe)}break;default:ht("Unsupporting sharing policy")}return pe}function Xr(Q,ee){if(ee===null)return this.isReference&&ht("null is not a valid "+this.name),0;ee.$$||ht('Cannot pass "'+Xn(ee)+'" as a '+this.name),ee.$$.ptr||ht("Cannot pass deleted object as a pointer of type "+this.name),ee.$$.ptrType.isConst&&ht("Cannot convert argument of type "+ee.$$.ptrType.name+" to parameter type "+this.name);var pe=ee.$$.ptrType.registeredClass,Oe=qi(ee.$$.ptr,pe,this.registeredClass);return Oe}function as(Q){return this.rawGetPointee&&(Q=this.rawGetPointee(Q)),Q}function os(Q){this.rawDestructor&&this.rawDestructor(Q)}function ss(Q){Q!==null&&Q.delete()}function cs(){Sr.prototype.getPointee=as,Sr.prototype.destructor=os,Sr.prototype.argPackAdvance=8,Sr.prototype.readValueFromPointer=Fe,Sr.prototype.deleteObject=ss,Sr.prototype.fromWireType=so}function Sr(Q,ee,pe,Oe,Ie,Be,Ge,Pe,je,Qe,ct){this.name=Q,this.registeredClass=ee,this.isReference=pe,this.isConst=Oe,this.isSmartPointer=Ie,this.pointeeType=Be,this.sharingPolicy=Ge,this.rawGetPointee=Pe,this.rawConstructor=je,this.rawShare=Qe,this.rawDestructor=ct,!Ie&&ee.baseClass===void 0?Oe?(this.toWireType=Xi,this.destructorFunction=null):(this.toWireType=Xr,this.destructorFunction=null):this.toWireType=ba}function br(Q,ee,pe){a.hasOwnProperty(Q)||Pt("Replacing nonexistant public symbol"),a[Q].overloadTable!==void 0&&pe!==void 0?a[Q].overloadTable[pe]=ee:(a[Q]=ee,a[Q].argCount=pe)}function cr(Q,ee,pe){var Oe=a["dynCall_"+Q];return pe&&pe.length?Oe.apply(null,[ee].concat(pe)):Oe.call(null,ee)}var zn=[];function uo(Q){var ee=zn[Q];return ee||(Q>=zn.length&&(zn.length=Q+1),zn[Q]=ee=Ee.get(Q)),ee}function ci(Q,ee,pe){if(Q.includes("j"))return cr(Q,ee,pe);var Oe=uo(ee).apply(null,pe);return Oe}function Ei(Q,ee){var pe=[];return function(){return pe.length=0,Object.assign(pe,arguments),ci(Q,ee,pe)}}function wn(Q,ee){Q=Vt(Q);function pe(){return Q.includes("j")?Ei(Q,ee):uo(ee)}var Oe=pe();return typeof Oe!="function"&&ht("unknown function pointer with signature "+Q+": "+ee),Oe}var lo=void 0;function tr(Q){var ee=li(Q),pe=Vt(ee);return Er(ee),pe}function In(Q,ee){var pe=[],Oe={};function Ie(Be){if(!Oe[Be]&&!$e[Be]){if(Xe[Be]){Xe[Be].forEach(Ie);return}pe.push(Be),Oe[Be]=!0}}throw ee.forEach(Ie),new lo(Q+": "+pe.map(tr).join([", "]))}function Ea(Q,ee,pe,Oe,Ie,Be,Ge,Pe,je,Qe,ct,pt,gt){ct=Vt(ct),Be=wn(Ie,Be),Pe&&(Pe=wn(Ge,Pe)),Qe&&(Qe=wn(je,Qe)),gt=wn(pt,gt);var Z=mt(ct);Wn(Z,function(){In("Cannot construct "+ct+" due to unbound types",[Oe])}),Ht([Q,ee,pe],Oe?[Oe]:[],function(X){X=X[0];var le,Se;Oe?(le=X.registeredClass,Se=le.instancePrototype):Se=Ur.prototype;var Ae=wt(Z,function(){if(Object.getPrototypeOf(this)!==He)throw new Qn("Use 'new' to construct "+ct);if(We.constructor_body===void 0)throw new Qn(ct+" has no accessible constructor");var N=We.constructor_body[arguments.length];if(N===void 0)throw new Qn("Tried to invoke ctor of "+ct+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(We.constructor_body).toString()+") parameters instead!");return N.apply(this,arguments)}),He=Object.create(Se,{constructor:{value:Ae}});Ae.prototype=He;var We=new _r(ct,Ae,He,gt,le,Be,Pe,Qe),Ve=new Sr(ct,We,!0,!1,!1),V=new Sr(ct+"*",We,!1,!1,!1),G=new Sr(ct+" const*",We,!1,!0,!1);return xn[Q]={pointerType:V,constPointerType:G},br(Z,Ae),[Ve,V,G]})}function ui(Q,ee){for(var pe=[],Oe=0;Oe<Q;Oe++)pe.push(j[ee+Oe*4>>2]);return pe}function nr(Q,ee){if(!(Q instanceof Function))throw new TypeError("new_ called with constructor type "+typeof Q+" which is not a function");var pe=wt(Q.name||"unknownFunctionName",function(){});pe.prototype=Q.prototype;var Oe=new pe,Ie=Q.apply(Oe,ee);return Ie instanceof Object?Ie:Oe}function Di(Q,ee,pe,Oe,Ie){var Be=ee.length;Be<2&&ht("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var Ge=ee[1]!==null&&pe!==null,Pe=!1,je=1;je<ee.length;++je)if(ee[je]!==null&&ee[je].destructorFunction===void 0){Pe=!0;break}for(var Qe=ee[0].name!=="void",ct="",pt="",je=0;je<Be-2;++je)ct+=(je!==0?", ":"")+"arg"+je,pt+=(je!==0?", ":"")+"arg"+je+"Wired";var gt="return function "+mt(Q)+"("+ct+`) {
if (arguments.length !== `+(Be-2)+`) {
throwBindingError('function `+Q+" called with ' + arguments.length + ' arguments, expected "+(Be-2)+` args!');
}
`;Pe&&(gt+=`var destructors = [];
`);var Z=Pe?"destructors":"null",X=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],le=[ht,Oe,Ie,xe,ee[0],ee[1]];Ge&&(gt+="var thisWired = classParam.toWireType("+Z+`, this);
`);for(var je=0;je<Be-2;++je)gt+="var arg"+je+"Wired = argType"+je+".toWireType("+Z+", arg"+je+"); // "+ee[je+2].name+`
`,X.push("argType"+je),le.push(ee[je+2]);if(Ge&&(pt="thisWired"+(pt.length>0?", ":"")+pt),gt+=(Qe?"var rv = ":"")+"invoker(fn"+(pt.length>0?", ":"")+pt+`);
`,Pe)gt+=`runDestructors(destructors);
`;else for(var je=Ge?1:2;je<ee.length;++je){var Se=je===1?"thisWired":"arg"+(je-2)+"Wired";ee[je].destructorFunction!==null&&(gt+=Se+"_dtor("+Se+"); // "+ee[je].name+`
`,X.push(Se+"_dtor"),le.push(ee[je].destructorFunction))}Qe&&(gt+=`var ret = retType.fromWireType(rv);
return ret;
`),gt+=`}
`,X.push(gt);var Ae=nr(Function,X).apply(null,le);return Ae}function fo(Q,ee,pe,Oe,Ie,Be){_(ee>0);var Ge=ui(ee,pe);Ie=wn(Oe,Ie),Ht([],[Q],function(Pe){Pe=Pe[0];var je="constructor "+Pe.name;if(Pe.registeredClass.constructor_body===void 0&&(Pe.registeredClass.constructor_body=[]),Pe.registeredClass.constructor_body[ee-1]!==void 0)throw new Qn("Cannot register multiple constructors with identical number of parameters ("+(ee-1)+") for class '"+Pe.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Pe.registeredClass.constructor_body[ee-1]=()=>{In("Cannot construct "+Pe.name+" due to unbound types",Ge)},Ht([],Ge,function(Qe){return Qe.splice(1,0,null),Pe.registeredClass.constructor_body[ee-1]=Di(je,Qe,null,Ie,Be),[]}),[]})}function ho(Q,ee,pe,Oe,Ie,Be,Ge,Pe){var je=ui(pe,Oe);ee=Vt(ee),Be=wn(Ie,Be),Ht([],[Q],function(Qe){Qe=Qe[0];var ct=Qe.name+"."+ee;ee.startsWith("@@")&&(ee=Symbol[ee.substring(2)]),Pe&&Qe.registeredClass.pureVirtualFunctions.push(ee);function pt(){In("Cannot call "+ct+" due to unbound types",je)}var gt=Qe.registeredClass.instancePrototype,Z=gt[ee];return Z===void 0||Z.overloadTable===void 0&&Z.className!==Qe.name&&Z.argCount===pe-2?(pt.argCount=pe-2,pt.className=Qe.name,gt[ee]=pt):(co(gt,ee,ct),gt[ee].overloadTable[pe-2]=pt),Ht([],je,function(X){var le=Di(ct,X,Qe,Be,Ge);return gt[ee].overloadTable===void 0?(le.argCount=pe-2,gt[ee]=le):gt[ee].overloadTable[pe-2]=le,[]}),[]})}var Yi=[],on=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Oi(Q){Q>4&&--on[Q].refcount===0&&(on[Q]=void 0,Yi.push(Q))}function Pn(){for(var Q=0,ee=5;ee<on.length;++ee)on[ee]!==void 0&&++Q;return Q}function Rn(){for(var Q=5;Q<on.length;++Q)if(on[Q]!==void 0)return on[Q];return null}function po(){a.count_emval_handles=Pn,a.get_first_emval=Rn}var ur={toValue:Q=>(Q||ht("Cannot use deleted val. handle = "+Q),on[Q].value),toHandle:Q=>{switch(Q){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var ee=Yi.length?Yi.pop():on.length;return on[ee]={refcount:1,value:Q},ee}}}};function us(Q,ee){ee=Vt(ee),Ut(Q,{name:ee,fromWireType:function(pe){var Oe=ur.toValue(pe);return Oi(pe),Oe},toWireType:function(pe,Oe){return ur.toHandle(Oe)},argPackAdvance:8,readValueFromPointer:Fe,destructorFunction:null})}function Xn(Q){if(Q===null)return"null";var ee=typeof Q;return ee==="object"||ee==="array"||ee==="function"?Q.toString():""+Q}function Br(Q,ee){switch(ee){case 2:return function(pe){return this.fromWireType(ie[pe>>2])};case 3:return function(pe){return this.fromWireType(ae[pe>>3])};default:throw new TypeError("Unknown float type: "+Q)}}function Da(Q,ee,pe){var Oe=Le(pe);ee=Vt(ee),Ut(Q,{name:ee,fromWireType:function(Ie){return Ie},toWireType:function(Ie,Be){return Be},argPackAdvance:8,readValueFromPointer:Br(ee,Oe),destructorFunction:null})}function Ri(Q,ee,pe,Oe,Ie,Be){var Ge=ui(ee,pe);Q=Vt(Q),Ie=wn(Oe,Ie),Wn(Q,function(){In("Cannot call "+Q+" due to unbound types",Ge)},ee-1),Ht([],Ge,function(Pe){var je=[Pe[0],null].concat(Pe.slice(1));return br(Q,Di(Q,je,null,Ie,Be),ee-1),[]})}function rr(Q,ee,pe){switch(ee){case 0:return pe?function(Ie){return U[Ie]}:function(Ie){return z[Ie]};case 1:return pe?function(Ie){return Y[Ie>>1]}:function(Ie){return W[Ie>>1]};case 2:return pe?function(Ie){return B[Ie>>2]}:function(Ie){return j[Ie>>2]};default:throw new TypeError("Unknown integer type: "+Q)}}function go(Q,ee,pe,Oe,Ie){ee=Vt(ee);var Be=Le(pe),Ge=pt=>pt;if(Oe===0){var Pe=32-8*pe;Ge=pt=>pt<<Pe>>>Pe}var je=ee.includes("unsigned"),Qe=(pt,gt)=>{},ct;je?ct=function(pt,gt){return Qe(gt,this.name),gt>>>0}:ct=function(pt,gt){return Qe(gt,this.name),gt},Ut(Q,{name:ee,fromWireType:Ge,toWireType:ct,argPackAdvance:8,readValueFromPointer:rr(ee,Be,Oe!==0),destructorFunction:null})}function ls(Q,ee,pe){var Oe=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ie=Oe[ee];function Be(Ge){Ge=Ge>>2;var Pe=j,je=Pe[Ge],Qe=Pe[Ge+1];return new Ie(M,Qe,je)}pe=Vt(pe),Ut(Q,{name:pe,fromWireType:Be,argPackAdvance:8,readValueFromPointer:Be},{ignoreDuplicateRegistrations:!0})}function fs(Q,ee){ee=Vt(ee);var pe=ee==="std::string";Ut(Q,{name:ee,fromWireType:function(Oe){var Ie=j[Oe>>2],Be=Oe+4,Ge;if(pe)for(var Pe=Be,je=0;je<=Ie;++je){var Qe=Be+je;if(je==Ie||z[Qe]==0){var ct=Qe-Pe,pt=D(Pe,ct);Ge===void 0?Ge=pt:(Ge+="\0",Ge+=pt),Pe=Qe+1}}else{for(var gt=new Array(Ie),je=0;je<Ie;++je)gt[je]=String.fromCharCode(z[Be+je]);Ge=gt.join("")}return Er(Oe),Ge},toWireType:function(Oe,Ie){Ie instanceof ArrayBuffer&&(Ie=new Uint8Array(Ie));var Be,Ge=typeof Ie=="string";Ge||Ie instanceof Uint8Array||Ie instanceof Uint8ClampedArray||Ie instanceof Int8Array||ht("Cannot pass non-string to std::string"),pe&&Ge?Be=F(Ie):Be=Ie.length;var Pe=Yr(4+Be+1),je=Pe+4;if(j[Pe>>2]=Be,pe&&Ge)R(Ie,je,Be+1);else if(Ge)for(var Qe=0;Qe<Be;++Qe){var ct=Ie.charCodeAt(Qe);ct>255&&(Er(je),ht("String has UTF-16 code units that do not fit in 8 bits")),z[je+Qe]=ct}else for(var Qe=0;Qe<Be;++Qe)z[je+Qe]=Ie[Qe];return Oe!==null&&Oe.push(Er,Pe),Pe},argPackAdvance:8,readValueFromPointer:Fe,destructorFunction:function(Oe){Er(Oe)}})}var mo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Mi(Q,ee){for(var pe=Q,Oe=pe>>1,Ie=Oe+ee/2;!(Oe>=Ie)&&W[Oe];)++Oe;if(pe=Oe<<1,pe-Q>32&&mo)return mo.decode(z.subarray(Q,pe));for(var Be="",Ge=0;!(Ge>=ee/2);++Ge){var Pe=Y[Q+Ge*2>>1];if(Pe==0)break;Be+=String.fromCharCode(Pe)}return Be}function vo(Q,ee,pe){if(pe===void 0&&(pe=2147483647),pe<2)return 0;pe-=2;for(var Oe=ee,Ie=pe<Q.length*2?pe/2:Q.length,Be=0;Be<Ie;++Be){var Ge=Q.charCodeAt(Be);Y[ee>>1]=Ge,ee+=2}return Y[ee>>1]=0,ee-Oe}function Oa(Q){return Q.length*2}function hs(Q,ee){for(var pe=0,Oe="";!(pe>=ee/4);){var Ie=B[Q+pe*4>>2];if(Ie==0)break;if(++pe,Ie>=65536){var Be=Ie-65536;Oe+=String.fromCharCode(55296|Be>>10,56320|Be&1023)}else Oe+=String.fromCharCode(Ie)}return Oe}function ps(Q,ee,pe){if(pe===void 0&&(pe=2147483647),pe<4)return 0;for(var Oe=ee,Ie=Oe+pe-4,Be=0;Be<Q.length;++Be){var Ge=Q.charCodeAt(Be);if(Ge>=55296&&Ge<=57343){var Pe=Q.charCodeAt(++Be);Ge=65536+((Ge&1023)<<10)|Pe&1023}if(B[ee>>2]=Ge,ee+=4,ee+4>Ie)break}return B[ee>>2]=0,ee-Oe}function ds(Q){for(var ee=0,pe=0;pe<Q.length;++pe){var Oe=Q.charCodeAt(pe);Oe>=55296&&Oe<=57343&&++pe,ee+=4}return ee}function gs(Q,ee,pe){pe=Vt(pe);var Oe,Ie,Be,Ge,Pe;ee===2?(Oe=Mi,Ie=vo,Ge=Oa,Be=()=>W,Pe=1):ee===4&&(Oe=hs,Ie=ps,Ge=ds,Be=()=>j,Pe=2),Ut(Q,{name:pe,fromWireType:function(je){for(var Qe=j[je>>2],ct=Be(),pt,gt=je+4,Z=0;Z<=Qe;++Z){var X=je+4+Z*ee;if(Z==Qe||ct[X>>Pe]==0){var le=X-gt,Se=Oe(gt,le);pt===void 0?pt=Se:(pt+="\0",pt+=Se),gt=X+ee}}return Er(je),pt},toWireType:function(je,Qe){typeof Qe!="string"&&ht("Cannot pass non-string to C++ string type "+pe);var ct=Ge(Qe),pt=Yr(4+ct+ee);return j[pt>>2]=ct>>Pe,Ie(Qe,pt+4,ct+ee),je!==null&&je.push(Er,pt),pt},argPackAdvance:8,readValueFromPointer:Fe,destructorFunction:function(je){Er(je)}})}function ms(Q,ee,pe,Oe,Ie,Be){qe[Q]={name:Vt(ee),rawConstructor:wn(pe,Oe),rawDestructor:wn(Ie,Be),fields:[]}}function vs(Q,ee,pe,Oe,Ie,Be,Ge,Pe,je,Qe){qe[Q].fields.push({fieldName:Vt(ee),getterReturnType:pe,getter:wn(Oe,Ie),getterContext:Be,setterArgumentType:Ge,setter:wn(Pe,je),setterContext:Qe})}function ys(Q,ee){ee=Vt(ee),Ut(Q,{isVoid:!0,name:ee,argPackAdvance:0,fromWireType:function(){},toWireType:function(pe,Oe){}})}var yo={};function xs(Q){var ee=yo[Q];return ee===void 0?Vt(Q):ee}function xo(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function wo(Q){return Q===0?ur.toHandle(xo()):(Q=xs(Q),ur.toHandle(xo()[Q]))}function ws(Q){Q>4&&(on[Q].refcount+=1)}function Ra(Q,ee){var pe=$e[Q];return pe===void 0&&ht(ee+" has unknown type "+tr(Q)),pe}function Co(Q){for(var ee="",pe=0;pe<Q;++pe)ee+=(pe!==0?", ":"")+"arg"+pe;for(var Oe=()=>j,Ie="return function emval_allocator_"+Q+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,pe=0;pe<Q;++pe)Ie+="var argType"+pe+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+pe+`');
var arg`+pe+" = argType"+pe+`.readValueFromPointer(args);
args += argType`+pe+`['argPackAdvance'];
argTypes += 4;
`;return Ie+="var obj = new constructor("+ee+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",Ie)(Ra,a,ur.toHandle,Oe)}var To={};function Ma(Q,ee,pe,Oe){Q=ur.toValue(Q);var Ie=To[ee];return Ie||(Ie=Co(ee),To[ee]=Ie),Ie(Q,pe,Oe)}function Cs(Q,ee){Q=Ra(Q,"_emval_take_value");var pe=Q.readValueFromPointer(ee);return ur.toHandle(pe)}function _o(){me("")}function Ts(Q,ee,pe){z.copyWithin(Q,ee,ee+pe)}function So(){return 2147483648}function _s(Q){try{return C.grow(Q-M.byteLength+65535>>>16),fe(C.buffer),1}catch{}}function Ss(Q){var ee=z.length;Q=Q>>>0;var pe=So();if(Q>pe)return!1;let Oe=(je,Qe)=>je+(Qe-je%Qe)%Qe;for(var Ie=1;Ie<=4;Ie*=2){var Be=ee*(1+.2/Ie);Be=Math.min(Be,Q+100663296);var Ge=Math.min(pe,Oe(Math.max(Q,Be),65536)),Pe=_s(Ge);if(Pe)return!0}return!1}function bs(Q){var ee=a["_"+Q];return ee}function Es(Q,ee){U.set(Q,ee)}function Na(Q,ee,pe,Oe,Ie){var Be={string:X=>{var le=0;if(X!=null&&X!==0){var Se=(X.length<<2)+1;le=Aa(Se),R(X,le,Se)}return le},array:X=>{var le=Aa(X.length);return Es(X,le),le}};function Ge(X){return ee==="string"?D(X):ee==="boolean"?!!X:X}var Pe=bs(Q),je=[],Qe=0;if(Oe)for(var ct=0;ct<Oe.length;ct++){var pt=Be[pe[ct]];pt?(Qe===0&&(Qe=bo()),je[ct]=pt(Oe[ct])):je[ct]=Oe[ct]}var gt=Pe.apply(null,je);function Z(X){return Qe!==0&&Eo(Qe),Ge(X)}return gt=Z(gt),gt}nn=a.InternalError=qt(Error,"InternalError"),Ke(),Qn=a.BindingError=qt(Error,"BindingError"),bi(),xr(),cs(),lo=a.UnboundTypeError=qt(Error,"UnboundTypeError"),po();var La={h:Ye,q:Vr,r:On,w:Tt,p:Ea,o:fo,c:ho,v:us,k:Da,e:Ri,b:go,a:ls,j:fs,g:gs,u:ms,d:vs,x:ys,i:Oi,m:wo,l:ws,y:Ma,n:Cs,f:_o,t:Ts,s:Ss};ue(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.A).apply(null,arguments)};var Yr=a._malloc=function(){return(Yr=a._malloc=a.asm.B).apply(null,arguments)},li=a.___getTypeName=function(){return(li=a.___getTypeName=a.asm.D).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.E).apply(null,arguments)};var Er=a._free=function(){return(Er=a._free=a.asm.F).apply(null,arguments)},bo=a.stackSave=function(){return(bo=a.stackSave=a.asm.G).apply(null,arguments)},Eo=a.stackRestore=function(){return(Eo=a.stackRestore=a.asm.H).apply(null,arguments)},Aa=a.stackAlloc=function(){return(Aa=a.stackAlloc=a.asm.I).apply(null,arguments)},Do=a.___cxa_is_pointer_type=function(){return(Do=a.___cxa_is_pointer_type=a.asm.J).apply(null,arguments)};a.ccall=Na;var Ji;$=function Q(){Ji||Oo(),Ji||($=Q)};function Oo(Q){if(k>0||(Ne(),k>0))return;function ee(){Ji||(Ji=!0,a.calledRun=!0,!T&&(Ce(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),P()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),ee()},1)):ee()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Oo(),i.ready}})();t.exports=n}(rd)),rd.exports}var gH=dH();const mH=wa(gH),vH=new URL("/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),Dc={codec:void 0,decoder:void 0,decodeConfig:{}};function yH(t){return typeof t=="number"?Dc.codec.getExceptionMessage(t):t}function xH(t){if(Dc.decodeConfig=t,Dc.codec)return Promise.resolve();const e=mH({locateFile:n=>n.endsWith(".wasm")?vH.toString():n});return new Promise((n,r)=>{e.then(i=>{Dc.codec=i,Dc.decoder=new i.JpegLSDecoder,n()},r)})}async function $y(t,e){try{await xH();const n=Dc.decoder;n.getEncodedBuffer(t.length).set(t),n.decode();const i=n.getFrameInfo(),a=n.getInterleaveMode(),o=n.getNearLossless(),s=n.getDecodedBuffer(),c={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:e.signed,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},l=wH(i,s,e.signed),f={nearLossless:o,interleaveMode:a,frameInfo:i};return{...e,pixelData:l,imageInfo:c,encodeOptions:f,...f,...c}}catch(n){throw yH(n)}}function wH(t,e,n){return t.bitsPerSample>8?n?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):n?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var id={exports:{}},Hy;function CH(){return Hy||(Hy=1,function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(i){i=i||{};var a=typeof i<"u"?i:{},o,s;a.ready=new Promise(function(Z,X){o=Z,s=X});var c=Object.assign({},a),l="./this.program",f=typeof window=="object",u=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",p="";function d(Z){return a.locateFile?a.locateFile(Z,p):p+Z}var g,y,x;if(h){var m=da,v=da;u?p=v.dirname(p)+"/":p=__dirname+"/",g=(Z,X)=>(Z=ce(Z)?new URL(Z):v.normalize(Z),m.readFileSync(Z,X?void 0:"utf8")),x=Z=>{var X=g(Z,!0);return X.buffer||(X=new Uint8Array(X)),X},y=(Z,X,le)=>{Z=ce(Z)?new URL(Z):v.normalize(Z),m.readFile(Z,function(Se,Ae){Se?le(Se):X(Ae.buffer)})},process.argv.length>1&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(Z){if(!(Z instanceof Ue))throw Z}),process.on("unhandledRejection",function(Z){throw Z}),a.inspect=function(){return"[Emscripten Module object]"}}else(f||u)&&(u?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),r&&(p=r),p.indexOf("blob:")!==0?p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):p="",g=Z=>{var X=new XMLHttpRequest;return X.open("GET",Z,!1),X.send(null),X.responseText},u&&(x=Z=>{var X=new XMLHttpRequest;return X.open("GET",Z,!1),X.responseType="arraybuffer",X.send(null),new Uint8Array(X.response)}),y=(Z,X,le)=>{var Se=new XMLHttpRequest;Se.open("GET",Z,!0),Se.responseType="arraybuffer",Se.onload=()=>{if(Se.status==200||Se.status==0&&Se.response){X(Se.response);return}le()},Se.onerror=le,Se.send(null)});var w=a.print||console.log.bind(console),C=a.printErr||console.warn.bind(console);Object.assign(a,c),c=null,a.arguments&&a.arguments,a.thisProgram&&(l=a.thisProgram),a.quit&&a.quit;var T;a.wasmBinary&&(T=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&_e("no native wasm support detected");var _,S=!1;function b(Z,X){Z||_e(X)}var D=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function E(Z,X,le){for(var Se=X+le,Ae=X;Z[Ae]&&!(Ae>=Se);)++Ae;if(Ae-X>16&&Z.buffer&&D)return D.decode(Z.subarray(X,Ae));for(var He="";X<Ae;){var We=Z[X++];if(!(We&128)){He+=String.fromCharCode(We);continue}var Ve=Z[X++]&63;if((We&224)==192){He+=String.fromCharCode((We&31)<<6|Ve);continue}var V=Z[X++]&63;if((We&240)==224?We=(We&15)<<12|Ve<<6|V:We=(We&7)<<18|Ve<<12|V<<6|Z[X++]&63,We<65536)He+=String.fromCharCode(We);else{var G=We-65536;He+=String.fromCharCode(55296|G>>10,56320|G&1023)}}return He}function R(Z,X){return Z?E(W,Z,X):""}function F(Z,X,le,Se){if(!(Se>0))return 0;for(var Ae=le,He=le+Se-1,We=0;We<Z.length;++We){var Ve=Z.charCodeAt(We);if(Ve>=55296&&Ve<=57343){var V=Z.charCodeAt(++We);Ve=65536+((Ve&1023)<<10)|V&1023}if(Ve<=127){if(le>=He)break;X[le++]=Ve}else if(Ve<=2047){if(le+1>=He)break;X[le++]=192|Ve>>6,X[le++]=128|Ve&63}else if(Ve<=65535){if(le+2>=He)break;X[le++]=224|Ve>>12,X[le++]=128|Ve>>6&63,X[le++]=128|Ve&63}else{if(le+3>=He)break;X[le++]=240|Ve>>18,X[le++]=128|Ve>>12&63,X[le++]=128|Ve>>6&63,X[le++]=128|Ve&63}}return X[le]=0,le-Ae}function M(Z,X,le){return F(Z,W,X,le)}function U(Z){for(var X=0,le=0;le<Z.length;++le){var Se=Z.charCodeAt(le);Se<=127?X++:Se<=2047?X+=2:Se>=55296&&Se<=57343?(X+=4,++le):X+=3}return X}var z,Y,W,B,j,ie,ae,fe,Ee;function ge(Z){z=Z,a.HEAP8=Y=new Int8Array(Z),a.HEAP16=B=new Int16Array(Z),a.HEAP32=ie=new Int32Array(Z),a.HEAPU8=W=new Uint8Array(Z),a.HEAPU16=j=new Uint16Array(Z),a.HEAPU32=ae=new Uint32Array(Z),a.HEAPF32=fe=new Float32Array(Z),a.HEAPF64=Ee=new Float64Array(Z)}a.INITIAL_MEMORY;var be,Re=[],Ne=[],Ce=[];function P(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)L(a.preRun.shift());Ye(Re)}function O(){Ye(Ne)}function A(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)$(a.postRun.shift());Ye(Ce)}function L(Z){Re.unshift(Z)}function k(Z){Ne.unshift(Z)}function $(Z){Ce.unshift(Z)}var H=0,se=null;function me(Z){H++,a.monitorRunDependencies&&a.monitorRunDependencies(H)}function ye(Z){if(H--,a.monitorRunDependencies&&a.monitorRunDependencies(H),H==0&&se){var X=se;se=null,X()}}function _e(Z){a.onAbort&&a.onAbort(Z),Z="Aborted("+Z+")",C(Z),S=!0,Z+=". Build with -sASSERTIONS for more info.";var X=new WebAssembly.RuntimeError(Z);throw s(X),X}var K="data:application/octet-stream;base64,";function ne(Z){return Z.startsWith(K)}function ce(Z){return Z.startsWith("file://")}var re;re="openjpegwasm_decode.wasm",ne(re)||(re=d(re));function ue(Z){try{if(Z==re&&T)return new Uint8Array(T);if(x)return x(Z);throw"both async and sync fetching of the wasm failed"}catch(X){_e(X)}}function De(){if(!T&&(f||u)){if(typeof fetch=="function"&&!ce(re))return fetch(re,{credentials:"same-origin"}).then(function(Z){if(!Z.ok)throw"failed to load wasm binary file at '"+re+"'";return Z.arrayBuffer()}).catch(function(){return ue(re)});if(y)return new Promise(function(Z,X){y(re,function(le){Z(new Uint8Array(le))},X)})}return Promise.resolve().then(function(){return ue(re)})}function te(){var Z={a:Oe};function X(We,Ve){var V=We.exports;a.asm=V,_=a.asm.E,ge(_.buffer),be=a.asm.G,k(a.asm.F),ye()}me();function le(We){X(We.instance)}function Se(We){return De().then(function(Ve){return WebAssembly.instantiate(Ve,Z)}).then(function(Ve){return Ve}).then(We,function(Ve){C("failed to asynchronously prepare wasm: "+Ve),_e(Ve)})}function Ae(){return!T&&typeof WebAssembly.instantiateStreaming=="function"&&!ne(re)&&!ce(re)&&!h&&typeof fetch=="function"?fetch(re,{credentials:"same-origin"}).then(function(We){var Ve=WebAssembly.instantiateStreaming(We,Z);return Ve.then(le,function(V){return C("wasm streaming compile failed: "+V),C("falling back to ArrayBuffer instantiation"),Se(le)})}):Se(le)}if(a.instantiateWasm)try{var He=a.instantiateWasm(Z,X);return He}catch(We){C("Module.instantiateWasm callback failed with error: "+We),s(We)}return Ae().catch(s),{}}function Ue(Z){this.name="ExitStatus",this.message="Program terminated with exit("+Z+")",this.status=Z}function Ye(Z){for(;Z.length>0;)Z.shift()(a)}function qe(Z){this.excPtr=Z,this.ptr=Z-24,this.set_type=function(X){ae[this.ptr+4>>2]=X},this.get_type=function(){return ae[this.ptr+4>>2]},this.set_destructor=function(X){ae[this.ptr+8>>2]=X},this.get_destructor=function(){return ae[this.ptr+8>>2]},this.set_refcount=function(X){ie[this.ptr>>2]=X},this.set_caught=function(X){X=X?1:0,Y[this.ptr+12>>0]=X},this.get_caught=function(){return Y[this.ptr+12>>0]!=0},this.set_rethrown=function(X){X=X?1:0,Y[this.ptr+13>>0]=X},this.get_rethrown=function(){return Y[this.ptr+13>>0]!=0},this.init=function(X,le){this.set_adjusted_ptr(0),this.set_type(X),this.set_destructor(le),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var X=ie[this.ptr>>2];ie[this.ptr>>2]=X+1},this.release_ref=function(){var X=ie[this.ptr>>2];return ie[this.ptr>>2]=X-1,X===1},this.set_adjusted_ptr=function(X){ae[this.ptr+16>>2]=X},this.get_adjusted_ptr=function(){return ae[this.ptr+16>>2]},this.get_exception_ptr=function(){var X=ct(this.get_type());if(X)return ae[this.excPtr>>2];var le=this.get_adjusted_ptr();return le!==0?le:this.excPtr}}function xe(Z,X,le){var Se=new qe(Z);throw Se.init(X,le),Z}var Fe={};function ze(Z){for(;Z.length;){var X=Z.pop(),le=Z.pop();le(X)}}function $e(Z){return this.fromWireType(ie[Z>>2])}var Xe={},ot={},rt={},mt=48,wt=57;function qt(Z){if(Z===void 0)return"_unknown";Z=Z.replace(/[^a-zA-Z0-9_]/g,"$");var X=Z.charCodeAt(0);return X>=mt&&X<=wt?"_"+Z:Z}function nn(Z,X){return Z=qt(Z),new Function("body","return function "+Z+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(X)}function Pt(Z,X){var le=nn(X,function(Se){this.name=X,this.message=Se;var Ae=new Error(Se).stack;Ae!==void 0&&(this.stack=this.toString()+`
`+Ae.replace(/^Error(:[^\n]*)?\n/,""))});return le.prototype=Object.create(Z.prototype),le.prototype.constructor=le,le.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},le}var Ht=void 0;function Vr(Z){throw new Ht(Z)}function On(Z,X,le){Z.forEach(function(Ve){rt[Ve]=X});function Se(Ve){var V=le(Ve);V.length!==Z.length&&Vr("Mismatched type converter count");for(var G=0;G<Z.length;++G)yt(Z[G],V[G])}var Ae=new Array(X.length),He=[],We=0;X.forEach((Ve,V)=>{ot.hasOwnProperty(Ve)?Ae[V]=ot[Ve]:(He.push(Ve),Xe.hasOwnProperty(Ve)||(Xe[Ve]=[]),Xe[Ve].push(()=>{Ae[V]=ot[Ve],++We,We===He.length&&Se(Ae)}))}),He.length===0&&Se(Ae)}function Le(Z){var X=Fe[Z];delete Fe[Z];var le=X.rawConstructor,Se=X.rawDestructor,Ae=X.fields,He=Ae.map(We=>We.getterReturnType).concat(Ae.map(We=>We.setterArgumentType));On([Z],He,We=>{var Ve={};return Ae.forEach((V,G)=>{var N=V.fieldName,I=We[G],q=V.getter,oe=V.getterContext,he=We[G+Ae.length],de=V.setter,ve=V.setterContext;Ve[N]={read:we=>I.fromWireType(q(oe,we)),write:(we,Me)=>{var ke=[];de(ve,we,he.toWireType(ke,Me)),ze(ke)}}}),[{name:X.name,fromWireType:function(V){var G={};for(var N in Ve)G[N]=Ve[N].read(V);return Se(V),G},toWireType:function(V,G){for(var N in Ve)if(!(N in G))throw new TypeError('Missing field:  "'+N+'"');var I=le();for(N in Ve)Ve[N].write(I,G[N]);return V!==null&&V.push(Se,I),I},argPackAdvance:8,readValueFromPointer:$e,destructorFunction:Se}]})}function Ke(Z,X,le,Se,Ae){}function dt(Z){switch(Z){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+Z)}}function Vt(){for(var Z=new Array(256),X=0;X<256;++X)Z[X]=String.fromCharCode(X);Qn=Z}var Qn=void 0;function ht(Z){for(var X="",le=Z;W[le];)X+=Qn[W[le++]];return X}var Ut=void 0;function Tt(Z){throw new Ut(Z)}function yt(Z,X,le={}){if(!("argPackAdvance"in X))throw new TypeError("registerType registeredInstance requires argPackAdvance");var Se=X.name;if(Z||Tt('type "'+Se+'" must have a positive integer typeid pointer'),ot.hasOwnProperty(Z)){if(le.ignoreDuplicateRegistrations)return;Tt("Cannot register type '"+Se+"' twice")}if(ot[Z]=X,delete rt[Z],Xe.hasOwnProperty(Z)){var Ae=Xe[Z];delete Xe[Z],Ae.forEach(He=>He())}}function qn(Z,X,le,Se,Ae){var He=dt(le);X=ht(X),yt(Z,{name:X,fromWireType:function(We){return!!We},toWireType:function(We,Ve){return Ve?Se:Ae},argPackAdvance:8,readValueFromPointer:function(We){var Ve;if(le===1)Ve=Y;else if(le===2)Ve=B;else if(le===4)Ve=ie;else throw new TypeError("Unknown boolean type size: "+X);return this.fromWireType(Ve[We>>He])},destructorFunction:null})}function vr(Z){if(!(this instanceof Wn)||!(Z instanceof Wn))return!1;for(var X=this.$$.ptrType.registeredClass,le=this.$$.ptr,Se=Z.$$.ptrType.registeredClass,Ae=Z.$$.ptr;X.baseClass;)le=X.upcast(le),X=X.baseClass;for(;Se.baseClass;)Ae=Se.upcast(Ae),Se=Se.baseClass;return X===Se&&le===Ae}function Ta(Z){return{count:Z.count,deleteScheduled:Z.deleteScheduled,preservePointerOnDelete:Z.preservePointerOnDelete,ptr:Z.ptr,ptrType:Z.ptrType,smartPtr:Z.smartPtr,smartPtrType:Z.smartPtrType}}function $i(Z){function X(le){return le.$$.ptrType.registeredClass.name}Tt(X(Z)+" instance already deleted")}var Kr=!1;function Ti(Z){}function Hi(Z){Z.smartPtr?Z.smartPtrType.rawDestructor(Z.smartPtr):Z.ptrType.registeredClass.rawDestructor(Z.ptr)}function xn(Z){Z.count.value-=1;var X=Z.count.value===0;X&&Hi(Z)}function kr(Z,X,le){if(X===le)return Z;if(le.baseClass===void 0)return null;var Se=kr(Z,X,le.baseClass);return Se===null?null:le.downcast(Se)}var Lt={};function Fn(){return Object.keys(_i).length}function _a(){var Z=[];for(var X in _i)_i.hasOwnProperty(X)&&Z.push(_i[X]);return Z}var yr=[];function qr(){for(;yr.length;){var Z=yr.pop();Z.$$.deleteScheduled=!1,Z.delete()}}var xr=void 0;function er(Z){xr=Z,yr.length&&xr&&xr(qr)}function oo(){a.getInheritedInstanceCount=Fn,a.getLiveInheritedInstances=_a,a.flushPendingDeletes=qr,a.setDelayFunction=er}var _i={};function wr(Z,X){for(X===void 0&&Tt("ptr should not be undefined");Z.baseClass;)X=Z.upcast(X),Z=Z.baseClass;return X}function so(Z,X){return X=wr(Z,X),_i[X]}function Cr(Z,X){(!X.ptrType||!X.ptr)&&Vr("makeClassHandle requires ptr and ptrType");var le=!!X.smartPtrType,Se=!!X.smartPtr;return le!==Se&&Vr("Both smartPtrType and smartPtr must be specified"),X.count={value:1},Si(Object.create(Z,{$$:{value:X}}))}function Ki(Z){var X=this.getPointee(Z);if(!X)return this.destructor(Z),null;var le=so(this.registeredClass,X);if(le!==void 0){if(le.$$.count.value===0)return le.$$.ptr=X,le.$$.smartPtr=Z,le.clone();var Se=le.clone();return this.destructor(Z),Se}function Ae(){return this.isSmartPointer?Cr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:X,smartPtrType:this,smartPtr:Z}):Cr(this.registeredClass.instancePrototype,{ptrType:this,ptr:Z})}var He=this.registeredClass.getActualType(X),We=Lt[He];if(!We)return Ae.call(this);var Ve;this.isConst?Ve=We.constPointerType:Ve=We.pointerType;var V=kr(X,this.registeredClass,Ve.registeredClass);return V===null?Ae.call(this):this.isSmartPointer?Cr(Ve.registeredClass.instancePrototype,{ptrType:Ve,ptr:V,smartPtrType:this,smartPtr:Z}):Cr(Ve.registeredClass.instancePrototype,{ptrType:Ve,ptr:V})}function Si(Z){return typeof FinalizationRegistry>"u"?(Si=X=>X,Z):(Kr=new FinalizationRegistry(X=>{xn(X.$$)}),Si=X=>{var le=X.$$,Se=!!le.smartPtr;if(Se){var Ae={$$:le};Kr.register(X,Ae,X)}return X},Ti=X=>Kr.unregister(X),Si(Z))}function Tr(){if(this.$$.ptr||$i(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Z=Si(Object.create(Object.getPrototypeOf(this),{$$:{value:Ta(this.$$)}}));return Z.$$.count.value+=1,Z.$$.deleteScheduled=!1,Z}function Sa(){this.$$.ptr||$i(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Tt("Object already scheduled for deletion"),Ti(this),xn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function bi(){return!this.$$.ptr}function Ur(){return this.$$.ptr||$i(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Tt("Object already scheduled for deletion"),yr.push(this),yr.length===1&&xr&&xr(qr),this.$$.deleteScheduled=!0,this}function co(){Wn.prototype.isAliasOf=vr,Wn.prototype.clone=Tr,Wn.prototype.delete=Sa,Wn.prototype.isDeleted=bi,Wn.prototype.deleteLater=Ur}function Wn(){}function _r(Z,X,le){if(Z[X].overloadTable===void 0){var Se=Z[X];Z[X]=function(){return Z[X].overloadTable.hasOwnProperty(arguments.length)||Tt("Function '"+le+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+Z[X].overloadTable+")!"),Z[X].overloadTable[arguments.length].apply(this,arguments)},Z[X].overloadTable=[],Z[X].overloadTable[Se.argCount]=Se}}function qi(Z,X,le){a.hasOwnProperty(Z)?(Tt("Cannot register public name '"+Z+"' twice"),_r(a,Z,Z),a.hasOwnProperty(le)&&Tt("Cannot register multiple overloads of a function with the same number of arguments ("+le+")!"),a[Z].overloadTable[le]=X):a[Z]=X}function Xi(Z,X,le,Se,Ae,He,We,Ve){this.name=Z,this.constructor=X,this.instancePrototype=le,this.rawDestructor=Se,this.baseClass=Ae,this.getActualType=He,this.upcast=We,this.downcast=Ve,this.pureVirtualFunctions=[]}function ba(Z,X,le){for(;X!==le;)X.upcast||Tt("Expected null or instance of "+le.name+", got an instance of "+X.name),Z=X.upcast(Z),X=X.baseClass;return Z}function Xr(Z,X){if(X===null)return this.isReference&&Tt("null is not a valid "+this.name),0;X.$$||Tt('Cannot pass "'+Da(X)+'" as a '+this.name),X.$$.ptr||Tt("Cannot pass deleted object as a pointer of type "+this.name);var le=X.$$.ptrType.registeredClass,Se=ba(X.$$.ptr,le,this.registeredClass);return Se}function as(Z,X){var le;if(X===null)return this.isReference&&Tt("null is not a valid "+this.name),this.isSmartPointer?(le=this.rawConstructor(),Z!==null&&Z.push(this.rawDestructor,le),le):0;X.$$||Tt('Cannot pass "'+Da(X)+'" as a '+this.name),X.$$.ptr||Tt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&X.$$.ptrType.isConst&&Tt("Cannot convert argument of type "+(X.$$.smartPtrType?X.$$.smartPtrType.name:X.$$.ptrType.name)+" to parameter type "+this.name);var Se=X.$$.ptrType.registeredClass;if(le=ba(X.$$.ptr,Se,this.registeredClass),this.isSmartPointer)switch(X.$$.smartPtr===void 0&&Tt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:X.$$.smartPtrType===this?le=X.$$.smartPtr:Tt("Cannot convert argument of type "+(X.$$.smartPtrType?X.$$.smartPtrType.name:X.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:le=X.$$.smartPtr;break;case 2:if(X.$$.smartPtrType===this)le=X.$$.smartPtr;else{var Ae=X.clone();le=this.rawShare(le,Xn.toHandle(function(){Ae.delete()})),Z!==null&&Z.push(this.rawDestructor,le)}break;default:Tt("Unsupporting sharing policy")}return le}function os(Z,X){if(X===null)return this.isReference&&Tt("null is not a valid "+this.name),0;X.$$||Tt('Cannot pass "'+Da(X)+'" as a '+this.name),X.$$.ptr||Tt("Cannot pass deleted object as a pointer of type "+this.name),X.$$.ptrType.isConst&&Tt("Cannot convert argument of type "+X.$$.ptrType.name+" to parameter type "+this.name);var le=X.$$.ptrType.registeredClass,Se=ba(X.$$.ptr,le,this.registeredClass);return Se}function ss(Z){return this.rawGetPointee&&(Z=this.rawGetPointee(Z)),Z}function cs(Z){this.rawDestructor&&this.rawDestructor(Z)}function Sr(Z){Z!==null&&Z.delete()}function br(){cr.prototype.getPointee=ss,cr.prototype.destructor=cs,cr.prototype.argPackAdvance=8,cr.prototype.readValueFromPointer=$e,cr.prototype.deleteObject=Sr,cr.prototype.fromWireType=Ki}function cr(Z,X,le,Se,Ae,He,We,Ve,V,G,N){this.name=Z,this.registeredClass=X,this.isReference=le,this.isConst=Se,this.isSmartPointer=Ae,this.pointeeType=He,this.sharingPolicy=We,this.rawGetPointee=Ve,this.rawConstructor=V,this.rawShare=G,this.rawDestructor=N,!Ae&&X.baseClass===void 0?Se?(this.toWireType=Xr,this.destructorFunction=null):(this.toWireType=os,this.destructorFunction=null):this.toWireType=as}function zn(Z,X,le){a.hasOwnProperty(Z)||Vr("Replacing nonexistant public symbol"),a[Z].overloadTable!==void 0&&le!==void 0||(a[Z]=X,a[Z].argCount=le)}function uo(Z,X,le){var Se=a["dynCall_"+Z];return le&&le.length?Se.apply(null,[X].concat(le)):Se.call(null,X)}var ci=[];function Ei(Z){var X=ci[Z];return X||(Z>=ci.length&&(ci.length=Z+1),ci[Z]=X=be.get(Z)),X}function wn(Z,X,le){if(Z.includes("j"))return uo(Z,X,le);var Se=Ei(X).apply(null,le);return Se}function lo(Z,X){var le=[];return function(){return le.length=0,Object.assign(le,arguments),wn(Z,X,le)}}function tr(Z,X){Z=ht(Z);function le(){return Z.includes("j")?lo(Z,X):Ei(X)}var Se=le();return typeof Se!="function"&&Tt("unknown function pointer with signature "+Z+": "+X),Se}var In=void 0;function Ea(Z){var X=Ge(Z),le=ht(X);return Be(X),le}function ui(Z,X){var le=[],Se={};function Ae(He){if(!Se[He]&&!ot[He]){if(rt[He]){rt[He].forEach(Ae);return}le.push(He),Se[He]=!0}}throw X.forEach(Ae),new In(Z+": "+le.map(Ea).join([", "]))}function nr(Z,X,le,Se,Ae,He,We,Ve,V,G,N,I,q){N=ht(N),He=tr(Ae,He),Ve&&(Ve=tr(We,Ve)),G&&(G=tr(V,G)),q=tr(I,q);var oe=qt(N);qi(oe,function(){ui("Cannot construct "+N+" due to unbound types",[Se])}),On([Z,X,le],Se?[Se]:[],function(he){he=he[0];var de,ve;Se?(de=he.registeredClass,ve=de.instancePrototype):ve=Wn.prototype;var we=nn(oe,function(){if(Object.getPrototypeOf(this)!==Me)throw new Ut("Use 'new' to construct "+N);if(ke.constructor_body===void 0)throw new Ut(N+" has no accessible constructor");var Ct=ke.constructor_body[arguments.length];if(Ct===void 0)throw new Ut("Tried to invoke ctor of "+N+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(ke.constructor_body).toString()+") parameters instead!");return Ct.apply(this,arguments)}),Me=Object.create(ve,{constructor:{value:we}});we.prototype=Me;var ke=new Xi(N,we,Me,q,de,He,Ve,G),Ze=new cr(N,ke,!0,!1,!1),st=new cr(N+"*",ke,!1,!1,!1),tt=new cr(N+" const*",ke,!1,!0,!1);return Lt[Z]={pointerType:st,constPointerType:tt},zn(oe,we),[Ze,st,tt]})}function Di(Z,X){for(var le=[],Se=0;Se<Z;Se++)le.push(ae[X+Se*4>>2]);return le}function fo(Z,X){if(!(Z instanceof Function))throw new TypeError("new_ called with constructor type "+typeof Z+" which is not a function");var le=nn(Z.name||"unknownFunctionName",function(){});le.prototype=Z.prototype;var Se=new le,Ae=Z.apply(Se,X);return Ae instanceof Object?Ae:Se}function ho(Z,X,le,Se,Ae){var He=X.length;He<2&&Tt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var We=X[1]!==null&&le!==null,Ve=!1,V=1;V<X.length;++V)if(X[V]!==null&&X[V].destructorFunction===void 0){Ve=!0;break}for(var G=X[0].name!=="void",N="",I="",V=0;V<He-2;++V)N+=(V!==0?", ":"")+"arg"+V,I+=(V!==0?", ":"")+"arg"+V+"Wired";var q="return function "+qt(Z)+"("+N+`) {
if (arguments.length !== `+(He-2)+`) {
throwBindingError('function `+Z+" called with ' + arguments.length + ' arguments, expected "+(He-2)+` args!');
}
`;Ve&&(q+=`var destructors = [];
`);var oe=Ve?"destructors":"null",he=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],de=[Tt,Se,Ae,ze,X[0],X[1]];We&&(q+="var thisWired = classParam.toWireType("+oe+`, this);
`);for(var V=0;V<He-2;++V)q+="var arg"+V+"Wired = argType"+V+".toWireType("+oe+", arg"+V+"); // "+X[V+2].name+`
`,he.push("argType"+V),de.push(X[V+2]);if(We&&(I="thisWired"+(I.length>0?", ":"")+I),q+=(G?"var rv = ":"")+"invoker(fn"+(I.length>0?", ":"")+I+`);
`,Ve)q+=`runDestructors(destructors);
`;else for(var V=We?1:2;V<X.length;++V){var ve=V===1?"thisWired":"arg"+(V-2)+"Wired";X[V].destructorFunction!==null&&(q+=ve+"_dtor("+ve+"); // "+X[V].name+`
`,he.push(ve+"_dtor"),de.push(X[V].destructorFunction))}G&&(q+=`var ret = retType.fromWireType(rv);
return ret;
`),q+=`}
`,he.push(q);var we=fo(Function,he).apply(null,de);return we}function Yi(Z,X,le,Se,Ae,He){b(X>0);var We=Di(X,le);Ae=tr(Se,Ae),On([],[Z],function(Ve){Ve=Ve[0];var V="constructor "+Ve.name;if(Ve.registeredClass.constructor_body===void 0&&(Ve.registeredClass.constructor_body=[]),Ve.registeredClass.constructor_body[X-1]!==void 0)throw new Ut("Cannot register multiple constructors with identical number of parameters ("+(X-1)+") for class '"+Ve.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Ve.registeredClass.constructor_body[X-1]=()=>{ui("Cannot construct "+Ve.name+" due to unbound types",We)},On([],We,function(G){return G.splice(1,0,null),Ve.registeredClass.constructor_body[X-1]=ho(V,G,null,Ae,He),[]}),[]})}function on(Z,X,le,Se,Ae,He,We,Ve){var V=Di(le,Se);X=ht(X),He=tr(Ae,He),On([],[Z],function(G){G=G[0];var N=G.name+"."+X;X.startsWith("@@")&&(X=Symbol[X.substring(2)]),Ve&&G.registeredClass.pureVirtualFunctions.push(X);function I(){ui("Cannot call "+N+" due to unbound types",V)}var q=G.registeredClass.instancePrototype,oe=q[X];return oe===void 0||oe.overloadTable===void 0&&oe.className!==G.name&&oe.argCount===le-2?(I.argCount=le-2,I.className=G.name,q[X]=I):(_r(q,X,N),q[X].overloadTable[le-2]=I),On([],V,function(he){var de=ho(N,he,G,He,We);return q[X].overloadTable===void 0?(de.argCount=le-2,q[X]=de):q[X].overloadTable[le-2]=de,[]}),[]})}var Oi=[],Pn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Rn(Z){Z>4&&--Pn[Z].refcount===0&&(Pn[Z]=void 0,Oi.push(Z))}function po(){for(var Z=0,X=5;X<Pn.length;++X)Pn[X]!==void 0&&++Z;return Z}function ur(){for(var Z=5;Z<Pn.length;++Z)if(Pn[Z]!==void 0)return Pn[Z];return null}function us(){a.count_emval_handles=po,a.get_first_emval=ur}var Xn={toValue:Z=>(Z||Tt("Cannot use deleted val. handle = "+Z),Pn[Z].value),toHandle:Z=>{switch(Z){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var X=Oi.length?Oi.pop():Pn.length;return Pn[X]={refcount:1,value:Z},X}}}};function Br(Z,X){X=ht(X),yt(Z,{name:X,fromWireType:function(le){var Se=Xn.toValue(le);return Rn(le),Se},toWireType:function(le,Se){return Xn.toHandle(Se)},argPackAdvance:8,readValueFromPointer:$e,destructorFunction:null})}function Da(Z){if(Z===null)return"null";var X=typeof Z;return X==="object"||X==="array"||X==="function"?Z.toString():""+Z}function Ri(Z,X){switch(X){case 2:return function(le){return this.fromWireType(fe[le>>2])};case 3:return function(le){return this.fromWireType(Ee[le>>3])};default:throw new TypeError("Unknown float type: "+Z)}}function rr(Z,X,le){var Se=dt(le);X=ht(X),yt(Z,{name:X,fromWireType:function(Ae){return Ae},toWireType:function(Ae,He){return He},argPackAdvance:8,readValueFromPointer:Ri(X,Se),destructorFunction:null})}function go(Z,X,le){switch(X){case 0:return le?function(Ae){return Y[Ae]}:function(Ae){return W[Ae]};case 1:return le?function(Ae){return B[Ae>>1]}:function(Ae){return j[Ae>>1]};case 2:return le?function(Ae){return ie[Ae>>2]}:function(Ae){return ae[Ae>>2]};default:throw new TypeError("Unknown integer type: "+Z)}}function ls(Z,X,le,Se,Ae){X=ht(X);var He=dt(le),We=I=>I;if(Se===0){var Ve=32-8*le;We=I=>I<<Ve>>>Ve}var V=X.includes("unsigned"),G=(I,q)=>{},N;V?N=function(I,q){return G(q,this.name),q>>>0}:N=function(I,q){return G(q,this.name),q},yt(Z,{name:X,fromWireType:We,toWireType:N,argPackAdvance:8,readValueFromPointer:go(X,He,Se!==0),destructorFunction:null})}function fs(Z,X,le){var Se=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ae=Se[X];function He(We){We=We>>2;var Ve=ae,V=Ve[We],G=Ve[We+1];return new Ae(z,G,V)}le=ht(le),yt(Z,{name:le,fromWireType:He,argPackAdvance:8,readValueFromPointer:He},{ignoreDuplicateRegistrations:!0})}function mo(Z,X){X=ht(X);var le=X==="std::string";yt(Z,{name:X,fromWireType:function(Se){var Ae=ae[Se>>2],He=Se+4,We;if(le)for(var Ve=He,V=0;V<=Ae;++V){var G=He+V;if(V==Ae||W[G]==0){var N=G-Ve,I=R(Ve,N);We===void 0?We=I:(We+="\0",We+=I),Ve=G+1}}else{for(var q=new Array(Ae),V=0;V<Ae;++V)q[V]=String.fromCharCode(W[He+V]);We=q.join("")}return Be(Se),We},toWireType:function(Se,Ae){Ae instanceof ArrayBuffer&&(Ae=new Uint8Array(Ae));var He,We=typeof Ae=="string";We||Ae instanceof Uint8Array||Ae instanceof Uint8ClampedArray||Ae instanceof Int8Array||Tt("Cannot pass non-string to std::string"),le&&We?He=U(Ae):He=Ae.length;var Ve=Ie(4+He+1),V=Ve+4;if(ae[Ve>>2]=He,le&&We)M(Ae,V,He+1);else if(We)for(var G=0;G<He;++G){var N=Ae.charCodeAt(G);N>255&&(Be(V),Tt("String has UTF-16 code units that do not fit in 8 bits")),W[V+G]=N}else for(var G=0;G<He;++G)W[V+G]=Ae[G];return Se!==null&&Se.push(Be,Ve),Ve},argPackAdvance:8,readValueFromPointer:$e,destructorFunction:function(Se){Be(Se)}})}var Mi=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function vo(Z,X){for(var le=Z,Se=le>>1,Ae=Se+X/2;!(Se>=Ae)&&j[Se];)++Se;if(le=Se<<1,le-Z>32&&Mi)return Mi.decode(W.subarray(Z,le));for(var He="",We=0;!(We>=X/2);++We){var Ve=B[Z+We*2>>1];if(Ve==0)break;He+=String.fromCharCode(Ve)}return He}function Oa(Z,X,le){if(le===void 0&&(le=2147483647),le<2)return 0;le-=2;for(var Se=X,Ae=le<Z.length*2?le/2:Z.length,He=0;He<Ae;++He){var We=Z.charCodeAt(He);B[X>>1]=We,X+=2}return B[X>>1]=0,X-Se}function hs(Z){return Z.length*2}function ps(Z,X){for(var le=0,Se="";!(le>=X/4);){var Ae=ie[Z+le*4>>2];if(Ae==0)break;if(++le,Ae>=65536){var He=Ae-65536;Se+=String.fromCharCode(55296|He>>10,56320|He&1023)}else Se+=String.fromCharCode(Ae)}return Se}function ds(Z,X,le){if(le===void 0&&(le=2147483647),le<4)return 0;for(var Se=X,Ae=Se+le-4,He=0;He<Z.length;++He){var We=Z.charCodeAt(He);if(We>=55296&&We<=57343){var Ve=Z.charCodeAt(++He);We=65536+((We&1023)<<10)|Ve&1023}if(ie[X>>2]=We,X+=4,X+4>Ae)break}return ie[X>>2]=0,X-Se}function gs(Z){for(var X=0,le=0;le<Z.length;++le){var Se=Z.charCodeAt(le);Se>=55296&&Se<=57343&&++le,X+=4}return X}function ms(Z,X,le){le=ht(le);var Se,Ae,He,We,Ve;X===2?(Se=vo,Ae=Oa,We=hs,He=()=>j,Ve=1):X===4&&(Se=ps,Ae=ds,We=gs,He=()=>ae,Ve=2),yt(Z,{name:le,fromWireType:function(V){for(var G=ae[V>>2],N=He(),I,q=V+4,oe=0;oe<=G;++oe){var he=V+4+oe*X;if(oe==G||N[he>>Ve]==0){var de=he-q,ve=Se(q,de);I===void 0?I=ve:(I+="\0",I+=ve),q=he+X}}return Be(V),I},toWireType:function(V,G){typeof G!="string"&&Tt("Cannot pass non-string to C++ string type "+le);var N=We(G),I=Ie(4+N+X);return ae[I>>2]=N>>Ve,Ae(G,I+4,N+X),V!==null&&V.push(Be,I),I},argPackAdvance:8,readValueFromPointer:$e,destructorFunction:function(V){Be(V)}})}function vs(Z,X,le,Se,Ae,He){Fe[Z]={name:ht(X),rawConstructor:tr(le,Se),rawDestructor:tr(Ae,He),fields:[]}}function ys(Z,X,le,Se,Ae,He,We,Ve,V,G){Fe[Z].fields.push({fieldName:ht(X),getterReturnType:le,getter:tr(Se,Ae),getterContext:He,setterArgumentType:We,setter:tr(Ve,V),setterContext:G})}function yo(Z,X){X=ht(X),yt(Z,{isVoid:!0,name:X,argPackAdvance:0,fromWireType:function(){},toWireType:function(le,Se){}})}var xs={};function xo(Z){var X=xs[Z];return X===void 0?ht(Z):X}function wo(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function ws(Z){return Z===0?Xn.toHandle(wo()):(Z=xo(Z),Xn.toHandle(wo()[Z]))}function Ra(Z){Z>4&&(Pn[Z].refcount+=1)}function Co(Z,X){var le=ot[Z];return le===void 0&&Tt(X+" has unknown type "+Ea(Z)),le}function To(Z){for(var X="",le=0;le<Z;++le)X+=(le!==0?", ":"")+"arg"+le;for(var Se=()=>ae,Ae="return function emval_allocator_"+Z+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,le=0;le<Z;++le)Ae+="var argType"+le+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+le+`');
var arg`+le+" = argType"+le+`.readValueFromPointer(args);
args += argType`+le+`['argPackAdvance'];
argTypes += 4;
`;return Ae+="var obj = new constructor("+X+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",Ae)(Co,a,Xn.toHandle,Se)}var Ma={};function Cs(Z,X,le,Se){Z=Xn.toValue(Z);var Ae=Ma[X];return Ae||(Ae=To(X),Ma[X]=Ae),Ae(Z,le,Se)}function _o(Z,X){Z=Co(Z,"_emval_take_value");var le=Z.readValueFromPointer(X);return Xn.toHandle(le)}function Ts(){_e("")}function So(){return 2147483648}function _s(){return So()}function Ss(Z,X,le){W.copyWithin(Z,X,X+le)}function bs(Z){try{return _.grow(Z-z.byteLength+65535>>>16),ge(_.buffer),1}catch{}}function Es(Z){var X=W.length;Z=Z>>>0;var le=So();if(Z>le)return!1;let Se=(V,G)=>V+(G-V%G)%G;for(var Ae=1;Ae<=4;Ae*=2){var He=X*(1+.2/Ae);He=Math.min(He,Z+100663296);var We=Math.min(le,Se(Math.max(Z,He),65536)),Ve=bs(We);if(Ve)return!0}return!1}var Na={};function La(){return l||"./this.program"}function Yr(){if(!Yr.strings){var Z=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",X={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:Z,_:La()};for(var le in Na)Na[le]===void 0?delete X[le]:X[le]=Na[le];var Se=[];for(var le in X)Se.push(le+"="+X[le]);Yr.strings=Se}return Yr.strings}function li(Z,X,le){for(var Se=0;Se<Z.length;++Se)Y[X++>>0]=Z.charCodeAt(Se);Y[X>>0]=0}function Er(Z,X){var le=0;return Yr().forEach(function(Se,Ae){var He=X+le;ae[Z+Ae*4>>2]=He,li(Se,He),le+=Se.length+1}),0}function bo(Z,X){var le=Yr();ae[Z>>2]=le.length;var Se=0;return le.forEach(function(Ae){Se+=Ae.length+1}),ae[X>>2]=Se,0}function Eo(Z){return 52}function Aa(Z,X,le,Se,Ae){return 70}var Do=[null,[],[]];function Ji(Z,X){var le=Do[Z];X===0||X===10?((Z===1?w:C)(E(le,0)),le.length=0):le.push(X)}function Oo(Z,X,le,Se){for(var Ae=0,He=0;He<le;He++){var We=ae[X>>2],Ve=ae[X+4>>2];X+=8;for(var V=0;V<Ve;V++)Ji(Z,W[We+V]);Ae+=Ve}return ae[Se>>2]=Ae,0}function Q(Z){var X=a["_"+Z];return X}function ee(Z,X){Y.set(Z,X)}function pe(Z,X,le,Se,Ae){var He={string:he=>{var de=0;if(he!=null&&he!==0){var ve=(he.length<<2)+1;de=Qe(ve),M(he,de,ve)}return de},array:he=>{var de=Qe(he.length);return ee(he,de),de}};function We(he){return X==="string"?R(he):X==="boolean"?!!he:he}var Ve=Q(Z),V=[],G=0;if(Se)for(var N=0;N<Se.length;N++){var I=He[le[N]];I?(G===0&&(G=Pe()),V[N]=I(Se[N])):V[N]=Se[N]}var q=Ve.apply(null,V);function oe(he){return G!==0&&je(G),We(he)}return q=oe(q),q}Ht=a.InternalError=Pt(Error,"InternalError"),Vt(),Ut=a.BindingError=Pt(Error,"BindingError"),co(),oo(),br(),In=a.UnboundTypeError=Pt(Error,"UnboundTypeError"),us();var Oe={D:xe,e:Le,t:Ke,B:qn,r:nr,q:Yi,b:on,A:Br,l:rr,d:ls,a:fs,k:mo,f:ms,g:vs,c:ys,C:yo,h:Rn,o:ws,m:Ra,n:Cs,p:_o,i:Ts,v:_s,z:Ss,u:Es,w:Er,x:bo,y:Eo,s:Aa,j:Oo};te(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.F).apply(null,arguments)};var Ie=a._malloc=function(){return(Ie=a._malloc=a.asm.H).apply(null,arguments)},Be=a._free=function(){return(Be=a._free=a.asm.I).apply(null,arguments)},Ge=a.___getTypeName=function(){return(Ge=a.___getTypeName=a.asm.J).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm.K).apply(null,arguments)};var Pe=a.stackSave=function(){return(Pe=a.stackSave=a.asm.L).apply(null,arguments)},je=a.stackRestore=function(){return(je=a.stackRestore=a.asm.M).apply(null,arguments)},Qe=a.stackAlloc=function(){return(Qe=a.stackAlloc=a.asm.N).apply(null,arguments)},ct=a.___cxa_is_pointer_type=function(){return(ct=a.___cxa_is_pointer_type=a.asm.O).apply(null,arguments)};a.dynCall_iji=function(){return(a.dynCall_iji=a.asm.P).apply(null,arguments)},a.dynCall_jji=function(){return(a.dynCall_jji=a.asm.Q).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.R).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.S).apply(null,arguments)},a.ccall=pe;var pt;se=function Z(){pt||gt(),pt||(se=Z)};function gt(Z){if(H>0||(P(),H>0))return;function X(){pt||(pt=!0,a.calledRun=!0,!S&&(O(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),A()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),X()},1)):X()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return gt(),i.ready}})();t.exports=n}(id)),id.exports}var TH=CH();const _H=wa(TH),SH=new URL("/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),Au={codec:void 0,decoder:void 0,decodeConfig:{}};function bH(t){if(Au.decodeConfig=t,Au.codec)return Promise.resolve();const e=_H({locateFile:n=>n.endsWith(".wasm")?SH.toString():n});return new Promise((n,r)=>{e.then(i=>{Au.codec=i,Au.decoder=new i.J2KDecoder,n()},r)})}async function Ky(t,e){await bH();const n=Au.decoder,r=n.getEncodedBuffer(t.length);r.set(t),n.decode();const i=n.getFrameInfo(),a=n.getDecodedBuffer();new Uint8Array(a.length).set(a);const s=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,c=n.getNumDecompositions(),l=n.getNumLayers(),f=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],u=n.getIsReversible(),h=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,p=`${n.getTileSize().width} x ${n.getTileSize().height}`,d=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,g=n.getColorSpace(),y=`${a.length.toLocaleString()} bytes`,x=`${(a.length/r.length).toFixed(2)}:1`,m={columns:i.width,rows:i.height,bitsPerPixel:i.bitsPerSample,signed:i.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:i.componentCount},v=EH(i,a),w={imageOffset:s,numDecompositions:c,numLayers:l,progessionOrder:f,reversible:u,blockDimensions:h,tileSize:p,tileOffset:d,colorTransform:g,decodedSize:y,compressionRatio:x};return{...e,pixelData:v,imageInfo:m,encodeOptions:w,...w,...m}}function EH(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var ad={exports:{}},qy;function DH(){return qy||(qy=1,function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};var a=typeof a<"u"?a:{},o,s;a.ready=new Promise(function(V,G){o=V,s=G});var c=Object.assign({},a),l=typeof window=="object",f=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function p(V){return a.locateFile?a.locateFile(V,h):h+V}var d,g,y;if(u){var x=da,m=da;f?h=m.dirname(h)+"/":h=__dirname+"/",d=(V,G)=>(V=ne(V)?new URL(V):m.normalize(V),x.readFileSync(V,G?void 0:"utf8")),y=V=>{var G=d(V,!0);return G.buffer||(G=new Uint8Array(G)),G},g=(V,G,N)=>{V=ne(V)?new URL(V):m.normalize(V),x.readFile(V,function(I,q){I?N(I):G(q.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(V){if(!(V instanceof te))throw V}),process.on("unhandledRejection",function(V){throw V}),a.inspect=function(){return"[Emscripten Module object]"}}else(l||f)&&(f?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",d=V=>{var G=new XMLHttpRequest;return G.open("GET",V,!1),G.send(null),G.responseText},f&&(y=V=>{var G=new XMLHttpRequest;return G.open("GET",V,!1),G.responseType="arraybuffer",G.send(null),new Uint8Array(G.response)}),g=(V,G,N)=>{var I=new XMLHttpRequest;I.open("GET",V,!0),I.responseType="arraybuffer",I.onload=()=>{if(I.status==200||I.status==0&&I.response){G(I.response);return}N()},I.onerror=N,I.send(null)});var v=a.print||console.log.bind(console),w=a.printErr||console.warn.bind(console);Object.assign(a,c),c=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var C;a.wasmBinary&&(C=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&ye("no native wasm support detected");var T,_=!1;function S(V,G){V||ye(G)}var b=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function D(V,G,N){for(var I=G+N,q=G;V[q]&&!(q>=I);)++q;if(q-G>16&&V.buffer&&b)return b.decode(V.subarray(G,q));for(var oe="";G<q;){var he=V[G++];if(!(he&128)){oe+=String.fromCharCode(he);continue}var de=V[G++]&63;if((he&224)==192){oe+=String.fromCharCode((he&31)<<6|de);continue}var ve=V[G++]&63;if((he&240)==224?he=(he&15)<<12|de<<6|ve:he=(he&7)<<18|de<<12|ve<<6|V[G++]&63,he<65536)oe+=String.fromCharCode(he);else{var we=he-65536;oe+=String.fromCharCode(55296|we>>10,56320|we&1023)}}return oe}function E(V,G){return V?D(Y,V,G):""}function R(V,G,N,I){if(!(I>0))return 0;for(var q=N,oe=N+I-1,he=0;he<V.length;++he){var de=V.charCodeAt(he);if(de>=55296&&de<=57343){var ve=V.charCodeAt(++he);de=65536+((de&1023)<<10)|ve&1023}if(de<=127){if(N>=oe)break;G[N++]=de}else if(de<=2047){if(N+1>=oe)break;G[N++]=192|de>>6,G[N++]=128|de&63}else if(de<=65535){if(N+2>=oe)break;G[N++]=224|de>>12,G[N++]=128|de>>6&63,G[N++]=128|de&63}else{if(N+3>=oe)break;G[N++]=240|de>>18,G[N++]=128|de>>12&63,G[N++]=128|de>>6&63,G[N++]=128|de&63}}return G[N]=0,N-q}function F(V,G,N){return R(V,Y,G,N)}function M(V){for(var G=0,N=0;N<V.length;++N){var I=V.charCodeAt(N);I<=127?G++:I<=2047?G+=2:I>=55296&&I<=57343?(G+=4,++N):G+=3}return G}var U,z,Y,W,B,j,ie,ae,fe;function Ee(V){U=V,a.HEAP8=z=new Int8Array(V),a.HEAP16=W=new Int16Array(V),a.HEAP32=j=new Int32Array(V),a.HEAPU8=Y=new Uint8Array(V),a.HEAPU16=B=new Uint16Array(V),a.HEAPU32=ie=new Uint32Array(V),a.HEAPF32=ae=new Float32Array(V),a.HEAPF64=fe=new Float64Array(V)}a.INITIAL_MEMORY;var ge,be=[],Re=[],Ne=[];function Ce(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)A(a.preRun.shift());Ue(be)}function P(){Ue(Re)}function O(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)k(a.postRun.shift());Ue(Ne)}function A(V){be.unshift(V)}function L(V){Re.unshift(V)}function k(V){Ne.unshift(V)}var $=0,H=null;function se(V){$++,a.monitorRunDependencies&&a.monitorRunDependencies($)}function me(V){if($--,a.monitorRunDependencies&&a.monitorRunDependencies($),$==0&&H){var G=H;H=null,G()}}function ye(V){a.onAbort&&a.onAbort(V),V="Aborted("+V+")",w(V),_=!0,V+=". Build with -sASSERTIONS for more info.";var G=new WebAssembly.RuntimeError(V);throw s(G),G}var _e="data:application/octet-stream;base64,";function K(V){return V.startsWith(_e)}function ne(V){return V.startsWith("file://")}var ce;ce="openjphjs.wasm",K(ce)||(ce=p(ce));function re(V){try{if(V==ce&&C)return new Uint8Array(C);if(y)return y(V);throw"both async and sync fetching of the wasm failed"}catch(G){ye(G)}}function ue(){if(!C&&(l||f)){if(typeof fetch=="function"&&!ne(ce))return fetch(ce,{credentials:"same-origin"}).then(function(V){if(!V.ok)throw"failed to load wasm binary file at '"+ce+"'";return V.arrayBuffer()}).catch(function(){return re(ce)});if(g)return new Promise(function(V,G){g(ce,function(N){V(new Uint8Array(N))},G)})}return Promise.resolve().then(function(){return re(ce)})}function De(){var V={env:Q,wasi_snapshot_preview1:Q};function G(he,de){var ve=he.exports;a.asm=ve,T=a.asm.memory,Ee(T.buffer),ge=a.asm.__indirect_function_table,L(a.asm.__wasm_call_ctors),me()}se();function N(he){G(he.instance)}function I(he){return ue().then(function(de){return WebAssembly.instantiate(de,V)}).then(function(de){return de}).then(he,function(de){w("failed to asynchronously prepare wasm: "+de),ye(de)})}function q(){return!C&&typeof WebAssembly.instantiateStreaming=="function"&&!K(ce)&&!ne(ce)&&!u&&typeof fetch=="function"?fetch(ce,{credentials:"same-origin"}).then(function(he){var de=WebAssembly.instantiateStreaming(he,V);return de.then(N,function(ve){return w("wasm streaming compile failed: "+ve),w("falling back to ArrayBuffer instantiation"),I(N)})}):I(N)}if(a.instantiateWasm)try{var oe=a.instantiateWasm(V,G);return oe}catch(he){w("Module.instantiateWasm callback failed with error: "+he),s(he)}return q().catch(s),{}}function te(V){this.name="ExitStatus",this.message="Program terminated with exit("+V+")",this.status=V}function Ue(V){for(;V.length>0;)V.shift()(a)}function Ye(V,G,N,I){ye("Assertion failed: "+E(V)+", at: "+[G?E(G):"unknown filename",N,I?E(I):"unknown function"])}var qe=[];function xe(V){V.add_ref()}function Fe(V){var G=new mt(V);return G.get_caught()||G.set_caught(!0),G.set_rethrown(!1),qe.push(G),xe(G),G.get_exception_ptr()}var ze=0,$e=[];function Xe(V){var G=$e[V];return G||(V>=$e.length&&($e.length=V+1),$e[V]=G=ge.get(V)),G}function ot(V){if(V.release_ref()&&!V.get_rethrown()){var G=V.get_destructor();G&&Xe(G)(V.excPtr),Oe(V.excPtr)}}function rt(){_setThrew(0);var V=qe.pop();ot(V),ze=0}function mt(V){this.excPtr=V,this.ptr=V-24,this.set_type=function(G){ie[this.ptr+4>>2]=G},this.get_type=function(){return ie[this.ptr+4>>2]},this.set_destructor=function(G){ie[this.ptr+8>>2]=G},this.get_destructor=function(){return ie[this.ptr+8>>2]},this.set_refcount=function(G){j[this.ptr>>2]=G},this.set_caught=function(G){G=G?1:0,z[this.ptr+12>>0]=G},this.get_caught=function(){return z[this.ptr+12>>0]!=0},this.set_rethrown=function(G){G=G?1:0,z[this.ptr+13>>0]=G},this.get_rethrown=function(){return z[this.ptr+13>>0]!=0},this.init=function(G,N){this.set_adjusted_ptr(0),this.set_type(G),this.set_destructor(N),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var G=j[this.ptr>>2];j[this.ptr>>2]=G+1},this.release_ref=function(){var G=j[this.ptr>>2];return j[this.ptr>>2]=G-1,G===1},this.set_adjusted_ptr=function(G){ie[this.ptr+16>>2]=G},this.get_adjusted_ptr=function(){return ie[this.ptr+16>>2]},this.get_exception_ptr=function(){var G=ct(this.get_type());if(G)return ie[this.excPtr>>2];var N=this.get_adjusted_ptr();return N!==0?N:this.excPtr}}function wt(V){throw ze||(ze=V),V}function qt(){var V=ze;if(!V)return Be(0),0;var G=new mt(V);G.set_adjusted_ptr(V);var N=G.get_type();if(!N)return Be(0),V;for(var I=0;I<arguments.length;I++){var q=arguments[I];if(q===0||q===N)break;var oe=G.ptr+16;if(Qe(q,N,oe))return Be(q),V}return Be(N),V}function nn(){var V=ze;if(!V)return Be(0),0;var G=new mt(V);G.set_adjusted_ptr(V);var N=G.get_type();if(!N)return Be(0),V;for(var I=0;I<arguments.length;I++){var q=arguments[I];if(q===0||q===N)break;var oe=G.ptr+16;if(Qe(q,N,oe))return Be(q),V}return Be(N),V}function Pt(V,G,N){var I=new mt(V);throw I.init(G,N),ze=V,V}var Ht={};function Vr(V){for(;V.length;){var G=V.pop(),N=V.pop();N(G)}}function On(V){return this.fromWireType(j[V>>2])}var Le={},Ke={},dt={},Vt=48,Qn=57;function ht(V){if(V===void 0)return"_unknown";V=V.replace(/[^a-zA-Z0-9_]/g,"$");var G=V.charCodeAt(0);return G>=Vt&&G<=Qn?"_"+V:V}function Ut(V,G){return V=ht(V),new Function("body","return function "+V+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(G)}function Tt(V,G){var N=Ut(G,function(I){this.name=G,this.message=I;var q=new Error(I).stack;q!==void 0&&(this.stack=this.toString()+`
`+q.replace(/^Error(:[^\n]*)?\n/,""))});return N.prototype=Object.create(V.prototype),N.prototype.constructor=N,N.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},N}var yt=void 0;function qn(V){throw new yt(V)}function vr(V,G,N){V.forEach(function(de){dt[de]=G});function I(de){var ve=N(de);ve.length!==V.length&&qn("Mismatched type converter count");for(var we=0;we<V.length;++we)Fn(V[we],ve[we])}var q=new Array(G.length),oe=[],he=0;G.forEach((de,ve)=>{Ke.hasOwnProperty(de)?q[ve]=Ke[de]:(oe.push(de),Le.hasOwnProperty(de)||(Le[de]=[]),Le[de].push(()=>{q[ve]=Ke[de],++he,he===oe.length&&I(q)}))}),oe.length===0&&I(q)}function Ta(V){var G=Ht[V];delete Ht[V];var N=G.rawConstructor,I=G.rawDestructor,q=G.fields,oe=q.map(he=>he.getterReturnType).concat(q.map(he=>he.setterArgumentType));vr([V],oe,he=>{var de={};return q.forEach((ve,we)=>{var Me=ve.fieldName,ke=he[we],Ze=ve.getter,st=ve.getterContext,tt=he[we+q.length],Ct=ve.setter,xt=ve.setterContext;de[Me]={read:jt=>ke.fromWireType(Ze(st,jt)),write:(jt,Mn)=>{var Vn=[];Ct(xt,jt,tt.toWireType(Vn,Mn)),Vr(Vn)}}}),[{name:G.name,fromWireType:function(ve){var we={};for(var Me in de)we[Me]=de[Me].read(ve);return I(ve),we},toWireType:function(ve,we){for(var Me in de)if(!(Me in we))throw new TypeError('Missing field:  "'+Me+'"');var ke=N();for(Me in de)de[Me].write(ke,we[Me]);return ve!==null&&ve.push(I,ke),ke},argPackAdvance:8,readValueFromPointer:On,destructorFunction:I}]})}function $i(V,G,N,I,q){}function Kr(V){switch(V){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+V)}}function Ti(){for(var V=new Array(256),G=0;G<256;++G)V[G]=String.fromCharCode(G);Hi=V}var Hi=void 0;function xn(V){for(var G="",N=V;Y[N];)G+=Hi[Y[N++]];return G}var kr=void 0;function Lt(V){throw new kr(V)}function Fn(V,G,N={}){if(!("argPackAdvance"in G))throw new TypeError("registerType registeredInstance requires argPackAdvance");var I=G.name;if(V||Lt('type "'+I+'" must have a positive integer typeid pointer'),Ke.hasOwnProperty(V)){if(N.ignoreDuplicateRegistrations)return;Lt("Cannot register type '"+I+"' twice")}if(Ke[V]=G,delete dt[V],Le.hasOwnProperty(V)){var q=Le[V];delete Le[V],q.forEach(oe=>oe())}}function _a(V,G,N,I,q){var oe=Kr(N);G=xn(G),Fn(V,{name:G,fromWireType:function(he){return!!he},toWireType:function(he,de){return de?I:q},argPackAdvance:8,readValueFromPointer:function(he){var de;if(N===1)de=z;else if(N===2)de=W;else if(N===4)de=j;else throw new TypeError("Unknown boolean type size: "+G);return this.fromWireType(de[he>>oe])},destructorFunction:null})}function yr(V){if(!(this instanceof br)||!(V instanceof br))return!1;for(var G=this.$$.ptrType.registeredClass,N=this.$$.ptr,I=V.$$.ptrType.registeredClass,q=V.$$.ptr;G.baseClass;)N=G.upcast(N),G=G.baseClass;for(;I.baseClass;)q=I.upcast(q),I=I.baseClass;return G===I&&N===q}function qr(V){return{count:V.count,deleteScheduled:V.deleteScheduled,preservePointerOnDelete:V.preservePointerOnDelete,ptr:V.ptr,ptrType:V.ptrType,smartPtr:V.smartPtr,smartPtrType:V.smartPtrType}}function xr(V){function G(N){return N.$$.ptrType.registeredClass.name}Lt(G(V)+" instance already deleted")}var er=!1;function oo(V){}function _i(V){V.smartPtr?V.smartPtrType.rawDestructor(V.smartPtr):V.ptrType.registeredClass.rawDestructor(V.ptr)}function wr(V){V.count.value-=1;var G=V.count.value===0;G&&_i(V)}function so(V,G,N){if(G===N)return V;if(N.baseClass===void 0)return null;var I=so(V,G,N.baseClass);return I===null?null:N.downcast(I)}var Cr={};function Ki(){return Object.keys(Wn).length}function Si(){var V=[];for(var G in Wn)Wn.hasOwnProperty(G)&&V.push(Wn[G]);return V}var Tr=[];function Sa(){for(;Tr.length;){var V=Tr.pop();V.$$.deleteScheduled=!1,V.delete()}}var bi=void 0;function Ur(V){bi=V,Tr.length&&bi&&bi(Sa)}function co(){a.getInheritedInstanceCount=Ki,a.getLiveInheritedInstances=Si,a.flushPendingDeletes=Sa,a.setDelayFunction=Ur}var Wn={};function _r(V,G){for(G===void 0&&Lt("ptr should not be undefined");V.baseClass;)G=V.upcast(G),V=V.baseClass;return G}function qi(V,G){return G=_r(V,G),Wn[G]}function Xi(V,G){(!G.ptrType||!G.ptr)&&qn("makeClassHandle requires ptr and ptrType");var N=!!G.smartPtrType,I=!!G.smartPtr;return N!==I&&qn("Both smartPtrType and smartPtr must be specified"),G.count={value:1},Xr(Object.create(V,{$$:{value:G}}))}function ba(V){var G=this.getPointee(V);if(!G)return this.destructor(V),null;var N=qi(this.registeredClass,G);if(N!==void 0){if(N.$$.count.value===0)return N.$$.ptr=G,N.$$.smartPtr=V,N.clone();var I=N.clone();return this.destructor(V),I}function q(){return this.isSmartPointer?Xi(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:G,smartPtrType:this,smartPtr:V}):Xi(this.registeredClass.instancePrototype,{ptrType:this,ptr:V})}var oe=this.registeredClass.getActualType(G),he=Cr[oe];if(!he)return q.call(this);var de;this.isConst?de=he.constPointerType:de=he.pointerType;var ve=so(G,this.registeredClass,de.registeredClass);return ve===null?q.call(this):this.isSmartPointer?Xi(de.registeredClass.instancePrototype,{ptrType:de,ptr:ve,smartPtrType:this,smartPtr:V}):Xi(de.registeredClass.instancePrototype,{ptrType:de,ptr:ve})}function Xr(V){return typeof FinalizationRegistry>"u"?(Xr=G=>G,V):(er=new FinalizationRegistry(G=>{wr(G.$$)}),Xr=G=>{var N=G.$$,I=!!N.smartPtr;if(I){var q={$$:N};er.register(G,q,G)}return G},oo=G=>er.unregister(G),Xr(V))}function as(){if(this.$$.ptr||xr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var V=Xr(Object.create(Object.getPrototypeOf(this),{$$:{value:qr(this.$$)}}));return V.$$.count.value+=1,V.$$.deleteScheduled=!1,V}function os(){this.$$.ptr||xr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Lt("Object already scheduled for deletion"),oo(this),wr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ss(){return!this.$$.ptr}function cs(){return this.$$.ptr||xr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Lt("Object already scheduled for deletion"),Tr.push(this),Tr.length===1&&bi&&bi(Sa),this.$$.deleteScheduled=!0,this}function Sr(){br.prototype.isAliasOf=yr,br.prototype.clone=as,br.prototype.delete=os,br.prototype.isDeleted=ss,br.prototype.deleteLater=cs}function br(){}function cr(V,G,N){if(V[G].overloadTable===void 0){var I=V[G];V[G]=function(){return V[G].overloadTable.hasOwnProperty(arguments.length)||Lt("Function '"+N+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+V[G].overloadTable+")!"),V[G].overloadTable[arguments.length].apply(this,arguments)},V[G].overloadTable=[],V[G].overloadTable[I.argCount]=I}}function zn(V,G,N){a.hasOwnProperty(V)?((N===void 0||a[V].overloadTable!==void 0&&a[V].overloadTable[N]!==void 0)&&Lt("Cannot register public name '"+V+"' twice"),cr(a,V,V),a.hasOwnProperty(N)&&Lt("Cannot register multiple overloads of a function with the same number of arguments ("+N+")!"),a[V].overloadTable[N]=G):(a[V]=G,N!==void 0&&(a[V].numArguments=N))}function uo(V,G,N,I,q,oe,he,de){this.name=V,this.constructor=G,this.instancePrototype=N,this.rawDestructor=I,this.baseClass=q,this.getActualType=oe,this.upcast=he,this.downcast=de,this.pureVirtualFunctions=[]}function ci(V,G,N){for(;G!==N;)G.upcast||Lt("Expected null or instance of "+N.name+", got an instance of "+G.name),V=G.upcast(V),G=G.baseClass;return V}function Ei(V,G){if(G===null)return this.isReference&&Lt("null is not a valid "+this.name),0;G.$$||Lt('Cannot pass "'+Oa(G)+'" as a '+this.name),G.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name);var N=G.$$.ptrType.registeredClass,I=ci(G.$$.ptr,N,this.registeredClass);return I}function wn(V,G){var N;if(G===null)return this.isReference&&Lt("null is not a valid "+this.name),this.isSmartPointer?(N=this.rawConstructor(),V!==null&&V.push(this.rawDestructor,N),N):0;G.$$||Lt('Cannot pass "'+Oa(G)+'" as a '+this.name),G.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&G.$$.ptrType.isConst&&Lt("Cannot convert argument of type "+(G.$$.smartPtrType?G.$$.smartPtrType.name:G.$$.ptrType.name)+" to parameter type "+this.name);var I=G.$$.ptrType.registeredClass;if(N=ci(G.$$.ptr,I,this.registeredClass),this.isSmartPointer)switch(G.$$.smartPtr===void 0&&Lt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:G.$$.smartPtrType===this?N=G.$$.smartPtr:Lt("Cannot convert argument of type "+(G.$$.smartPtrType?G.$$.smartPtrType.name:G.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:N=G.$$.smartPtr;break;case 2:if(G.$$.smartPtrType===this)N=G.$$.smartPtr;else{var q=G.clone();N=this.rawShare(N,Mi.toHandle(function(){q.delete()})),V!==null&&V.push(this.rawDestructor,N)}break;default:Lt("Unsupporting sharing policy")}return N}function lo(V,G){if(G===null)return this.isReference&&Lt("null is not a valid "+this.name),0;G.$$||Lt('Cannot pass "'+Oa(G)+'" as a '+this.name),G.$$.ptr||Lt("Cannot pass deleted object as a pointer of type "+this.name),G.$$.ptrType.isConst&&Lt("Cannot convert argument of type "+G.$$.ptrType.name+" to parameter type "+this.name);var N=G.$$.ptrType.registeredClass,I=ci(G.$$.ptr,N,this.registeredClass);return I}function tr(V){return this.rawGetPointee&&(V=this.rawGetPointee(V)),V}function In(V){this.rawDestructor&&this.rawDestructor(V)}function Ea(V){V!==null&&V.delete()}function ui(){nr.prototype.getPointee=tr,nr.prototype.destructor=In,nr.prototype.argPackAdvance=8,nr.prototype.readValueFromPointer=On,nr.prototype.deleteObject=Ea,nr.prototype.fromWireType=ba}function nr(V,G,N,I,q,oe,he,de,ve,we,Me){this.name=V,this.registeredClass=G,this.isReference=N,this.isConst=I,this.isSmartPointer=q,this.pointeeType=oe,this.sharingPolicy=he,this.rawGetPointee=de,this.rawConstructor=ve,this.rawShare=we,this.rawDestructor=Me,!q&&G.baseClass===void 0?I?(this.toWireType=Ei,this.destructorFunction=null):(this.toWireType=lo,this.destructorFunction=null):this.toWireType=wn}function Di(V,G,N){a.hasOwnProperty(V)||qn("Replacing nonexistant public symbol"),a[V].overloadTable!==void 0&&N!==void 0?a[V].overloadTable[N]=G:(a[V]=G,a[V].argCount=N)}function fo(V,G,N){var I=a["dynCall_"+V];return N&&N.length?I.apply(null,[G].concat(N)):I.call(null,G)}function ho(V,G,N){if(V.includes("j"))return fo(V,G,N);var I=Xe(G).apply(null,N);return I}function Yi(V,G){var N=[];return function(){return N.length=0,Object.assign(N,arguments),ho(V,G,N)}}function on(V,G){V=xn(V);function N(){return V.includes("j")?Yi(V,G):Xe(G)}var I=N();return typeof I!="function"&&Lt("unknown function pointer with signature "+V+": "+G),I}var Oi=void 0;function Pn(V){var G=Ie(V),N=xn(G);return pe(G),N}function Rn(V,G){var N=[],I={};function q(oe){if(!I[oe]&&!Ke[oe]){if(dt[oe]){dt[oe].forEach(q);return}N.push(oe),I[oe]=!0}}throw G.forEach(q),new Oi(V+": "+N.map(Pn).join([", "]))}function po(V,G,N,I,q,oe,he,de,ve,we,Me,ke,Ze){Me=xn(Me),oe=on(q,oe),de&&(de=on(he,de)),we&&(we=on(ve,we)),Ze=on(ke,Ze);var st=ht(Me);zn(st,function(){Rn("Cannot construct "+Me+" due to unbound types",[I])}),vr([V,G,N],I?[I]:[],function(tt){tt=tt[0];var Ct,xt;I?(Ct=tt.registeredClass,xt=Ct.instancePrototype):xt=br.prototype;var jt=Ut(st,function(){if(Object.getPrototypeOf(this)!==Mn)throw new kr("Use 'new' to construct "+Me);if(Vn.constructor_body===void 0)throw new kr(Me+" has no accessible constructor");var uu=Vn.constructor_body[arguments.length];if(uu===void 0)throw new kr("Tried to invoke ctor of "+Me+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Vn.constructor_body).toString()+") parameters instead!");return uu.apply(this,arguments)}),Mn=Object.create(xt,{constructor:{value:jt}});jt.prototype=Mn;var Vn=new uo(Me,jt,Mn,Ze,Ct,oe,de,we),Ds=new nr(Me,Vn,!0,!1,!1),fi=new nr(Me+"*",Vn,!1,!1,!1),ql=new nr(Me+" const*",Vn,!1,!0,!1);return Cr[V]={pointerType:fi,constPointerType:ql},Di(st,jt),[Ds,fi,ql]})}function ur(V,G){for(var N=[],I=0;I<V;I++)N.push(ie[G+I*4>>2]);return N}function us(V,G){if(!(V instanceof Function))throw new TypeError("new_ called with constructor type "+typeof V+" which is not a function");var N=Ut(V.name||"unknownFunctionName",function(){});N.prototype=V.prototype;var I=new N,q=V.apply(I,G);return q instanceof Object?q:I}function Xn(V,G,N,I,q){var oe=G.length;oe<2&&Lt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var he=G[1]!==null&&N!==null,de=!1,ve=1;ve<G.length;++ve)if(G[ve]!==null&&G[ve].destructorFunction===void 0){de=!0;break}for(var we=G[0].name!=="void",Me="",ke="",ve=0;ve<oe-2;++ve)Me+=(ve!==0?", ":"")+"arg"+ve,ke+=(ve!==0?", ":"")+"arg"+ve+"Wired";var Ze="return function "+ht(V)+"("+Me+`) {
if (arguments.length !== `+(oe-2)+`) {
throwBindingError('function `+V+" called with ' + arguments.length + ' arguments, expected "+(oe-2)+` args!');
}
`;de&&(Ze+=`var destructors = [];
`);var st=de?"destructors":"null",tt=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Ct=[Lt,I,q,Vr,G[0],G[1]];he&&(Ze+="var thisWired = classParam.toWireType("+st+`, this);
`);for(var ve=0;ve<oe-2;++ve)Ze+="var arg"+ve+"Wired = argType"+ve+".toWireType("+st+", arg"+ve+"); // "+G[ve+2].name+`
`,tt.push("argType"+ve),Ct.push(G[ve+2]);if(he&&(ke="thisWired"+(ke.length>0?", ":"")+ke),Ze+=(we?"var rv = ":"")+"invoker(fn"+(ke.length>0?", ":"")+ke+`);
`,de)Ze+=`runDestructors(destructors);
`;else for(var ve=he?1:2;ve<G.length;++ve){var xt=ve===1?"thisWired":"arg"+(ve-2)+"Wired";G[ve].destructorFunction!==null&&(Ze+=xt+"_dtor("+xt+"); // "+G[ve].name+`
`,tt.push(xt+"_dtor"),Ct.push(G[ve].destructorFunction))}we&&(Ze+=`var ret = retType.fromWireType(rv);
return ret;
`),Ze+=`}
`,tt.push(Ze);var jt=us(Function,tt).apply(null,Ct);return jt}function Br(V,G,N,I,q,oe){S(G>0);var he=ur(G,N);q=on(I,q),vr([],[V],function(de){de=de[0];var ve="constructor "+de.name;if(de.registeredClass.constructor_body===void 0&&(de.registeredClass.constructor_body=[]),de.registeredClass.constructor_body[G-1]!==void 0)throw new kr("Cannot register multiple constructors with identical number of parameters ("+(G-1)+") for class '"+de.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return de.registeredClass.constructor_body[G-1]=()=>{Rn("Cannot construct "+de.name+" due to unbound types",he)},vr([],he,function(we){return we.splice(1,0,null),de.registeredClass.constructor_body[G-1]=Xn(ve,we,null,q,oe),[]}),[]})}function Da(V,G,N,I,q,oe,he,de){var ve=ur(N,I);G=xn(G),oe=on(q,oe),vr([],[V],function(we){we=we[0];var Me=we.name+"."+G;G.startsWith("@@")&&(G=Symbol[G.substring(2)]),de&&we.registeredClass.pureVirtualFunctions.push(G);function ke(){Rn("Cannot call "+Me+" due to unbound types",ve)}var Ze=we.registeredClass.instancePrototype,st=Ze[G];return st===void 0||st.overloadTable===void 0&&st.className!==we.name&&st.argCount===N-2?(ke.argCount=N-2,ke.className=we.name,Ze[G]=ke):(cr(Ze,G,Me),Ze[G].overloadTable[N-2]=ke),vr([],ve,function(tt){var Ct=Xn(Me,tt,we,oe,he);return Ze[G].overloadTable===void 0?(Ct.argCount=N-2,Ze[G]=Ct):Ze[G].overloadTable[N-2]=Ct,[]}),[]})}var Ri=[],rr=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function go(V){V>4&&--rr[V].refcount===0&&(rr[V]=void 0,Ri.push(V))}function ls(){for(var V=0,G=5;G<rr.length;++G)rr[G]!==void 0&&++V;return V}function fs(){for(var V=5;V<rr.length;++V)if(rr[V]!==void 0)return rr[V];return null}function mo(){a.count_emval_handles=ls,a.get_first_emval=fs}var Mi={toValue:V=>(V||Lt("Cannot use deleted val. handle = "+V),rr[V].value),toHandle:V=>{switch(V){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var G=Ri.length?Ri.pop():rr.length;return rr[G]={refcount:1,value:V},G}}}};function vo(V,G){G=xn(G),Fn(V,{name:G,fromWireType:function(N){var I=Mi.toValue(N);return go(N),I},toWireType:function(N,I){return Mi.toHandle(I)},argPackAdvance:8,readValueFromPointer:On,destructorFunction:null})}function Oa(V){if(V===null)return"null";var G=typeof V;return G==="object"||G==="array"||G==="function"?V.toString():""+V}function hs(V,G){switch(G){case 2:return function(N){return this.fromWireType(ae[N>>2])};case 3:return function(N){return this.fromWireType(fe[N>>3])};default:throw new TypeError("Unknown float type: "+V)}}function ps(V,G,N){var I=Kr(N);G=xn(G),Fn(V,{name:G,fromWireType:function(q){return q},toWireType:function(q,oe){return oe},argPackAdvance:8,readValueFromPointer:hs(G,I),destructorFunction:null})}function ds(V,G,N,I,q,oe){var he=ur(G,N);V=xn(V),q=on(I,q),zn(V,function(){Rn("Cannot call "+V+" due to unbound types",he)},G-1),vr([],he,function(de){var ve=[de[0],null].concat(de.slice(1));return Di(V,Xn(V,ve,null,q,oe),G-1),[]})}function gs(V,G,N){switch(G){case 0:return N?function(q){return z[q]}:function(q){return Y[q]};case 1:return N?function(q){return W[q>>1]}:function(q){return B[q>>1]};case 2:return N?function(q){return j[q>>2]}:function(q){return ie[q>>2]};default:throw new TypeError("Unknown integer type: "+V)}}function ms(V,G,N,I,q){G=xn(G);var oe=Kr(N),he=ke=>ke;if(I===0){var de=32-8*N;he=ke=>ke<<de>>>de}var ve=G.includes("unsigned"),we=(ke,Ze)=>{},Me;ve?Me=function(ke,Ze){return we(Ze,this.name),Ze>>>0}:Me=function(ke,Ze){return we(Ze,this.name),Ze},Fn(V,{name:G,fromWireType:he,toWireType:Me,argPackAdvance:8,readValueFromPointer:gs(G,oe,I!==0),destructorFunction:null})}function vs(V,G,N){var I=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],q=I[G];function oe(he){he=he>>2;var de=ie,ve=de[he],we=de[he+1];return new q(U,we,ve)}N=xn(N),Fn(V,{name:N,fromWireType:oe,argPackAdvance:8,readValueFromPointer:oe},{ignoreDuplicateRegistrations:!0})}function ys(V,G){G=xn(G);var N=G==="std::string";Fn(V,{name:G,fromWireType:function(I){var q=ie[I>>2],oe=I+4,he;if(N)for(var de=oe,ve=0;ve<=q;++ve){var we=oe+ve;if(ve==q||Y[we]==0){var Me=we-de,ke=E(de,Me);he===void 0?he=ke:(he+="\0",he+=ke),de=we+1}}else{for(var Ze=new Array(q),ve=0;ve<q;++ve)Ze[ve]=String.fromCharCode(Y[oe+ve]);he=Ze.join("")}return pe(I),he},toWireType:function(I,q){q instanceof ArrayBuffer&&(q=new Uint8Array(q));var oe,he=typeof q=="string";he||q instanceof Uint8Array||q instanceof Uint8ClampedArray||q instanceof Int8Array||Lt("Cannot pass non-string to std::string"),N&&he?oe=M(q):oe=q.length;var de=ee(4+oe+1),ve=de+4;if(ie[de>>2]=oe,N&&he)F(q,ve,oe+1);else if(he)for(var we=0;we<oe;++we){var Me=q.charCodeAt(we);Me>255&&(pe(ve),Lt("String has UTF-16 code units that do not fit in 8 bits")),Y[ve+we]=Me}else for(var we=0;we<oe;++we)Y[ve+we]=q[we];return I!==null&&I.push(pe,de),de},argPackAdvance:8,readValueFromPointer:On,destructorFunction:function(I){pe(I)}})}var yo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function xs(V,G){for(var N=V,I=N>>1,q=I+G/2;!(I>=q)&&B[I];)++I;if(N=I<<1,N-V>32&&yo)return yo.decode(Y.subarray(V,N));for(var oe="",he=0;!(he>=G/2);++he){var de=W[V+he*2>>1];if(de==0)break;oe+=String.fromCharCode(de)}return oe}function xo(V,G,N){if(N===void 0&&(N=2147483647),N<2)return 0;N-=2;for(var I=G,q=N<V.length*2?N/2:V.length,oe=0;oe<q;++oe){var he=V.charCodeAt(oe);W[G>>1]=he,G+=2}return W[G>>1]=0,G-I}function wo(V){return V.length*2}function ws(V,G){for(var N=0,I="";!(N>=G/4);){var q=j[V+N*4>>2];if(q==0)break;if(++N,q>=65536){var oe=q-65536;I+=String.fromCharCode(55296|oe>>10,56320|oe&1023)}else I+=String.fromCharCode(q)}return I}function Ra(V,G,N){if(N===void 0&&(N=2147483647),N<4)return 0;for(var I=G,q=I+N-4,oe=0;oe<V.length;++oe){var he=V.charCodeAt(oe);if(he>=55296&&he<=57343){var de=V.charCodeAt(++oe);he=65536+((he&1023)<<10)|de&1023}if(j[G>>2]=he,G+=4,G+4>q)break}return j[G>>2]=0,G-I}function Co(V){for(var G=0,N=0;N<V.length;++N){var I=V.charCodeAt(N);I>=55296&&I<=57343&&++N,G+=4}return G}function To(V,G,N){N=xn(N);var I,q,oe,he,de;G===2?(I=xs,q=xo,he=wo,oe=()=>B,de=1):G===4&&(I=ws,q=Ra,he=Co,oe=()=>ie,de=2),Fn(V,{name:N,fromWireType:function(ve){for(var we=ie[ve>>2],Me=oe(),ke,Ze=ve+4,st=0;st<=we;++st){var tt=ve+4+st*G;if(st==we||Me[tt>>de]==0){var Ct=tt-Ze,xt=I(Ze,Ct);ke===void 0?ke=xt:(ke+="\0",ke+=xt),Ze=tt+G}}return pe(ve),ke},toWireType:function(ve,we){typeof we!="string"&&Lt("Cannot pass non-string to C++ string type "+N);var Me=he(we),ke=ee(4+Me+G);return ie[ke>>2]=Me>>de,q(we,ke+4,Me+G),ve!==null&&ve.push(pe,ke),ke},argPackAdvance:8,readValueFromPointer:On,destructorFunction:function(ve){pe(ve)}})}function Ma(V,G,N,I,q,oe){Ht[V]={name:xn(G),rawConstructor:on(N,I),rawDestructor:on(q,oe),fields:[]}}function Cs(V,G,N,I,q,oe,he,de,ve,we){Ht[V].fields.push({fieldName:xn(G),getterReturnType:N,getter:on(I,q),getterContext:oe,setterArgumentType:he,setter:on(de,ve),setterContext:we})}function _o(V,G){G=xn(G),Fn(V,{isVoid:!0,name:G,argPackAdvance:0,fromWireType:function(){},toWireType:function(N,I){}})}function Ts(V){V>4&&(rr[V].refcount+=1)}function So(V,G){var N=Ke[V];return N===void 0&&Lt(G+" has unknown type "+Pn(V)),N}function _s(V,G){V=So(V,"_emval_take_value");var N=V.readValueFromPointer(G);return Mi.toHandle(N)}function Ss(){ye("")}function bs(V,G,N){Y.copyWithin(V,G,G+N)}function Es(){return 2147483648}function Na(V){try{return T.grow(V-U.byteLength+65535>>>16),Ee(T.buffer),1}catch{}}function La(V){var G=Y.length;V=V>>>0;var N=Es();if(V>N)return!1;let I=(ve,we)=>ve+(we-ve%we)%we;for(var q=1;q<=4;q*=2){var oe=G*(1+.2/q);oe=Math.min(oe,V+100663296);var he=Math.min(N,I(Math.max(V,oe),65536)),de=Na(he);if(de)return!0}return!1}function Yr(V){return 52}function li(V,G,N,I,q){return 70}var Er=[null,[],[]];function bo(V,G){var N=Er[V];G===0||G===10?((V===1?v:w)(D(N,0)),N.length=0):N.push(G)}function Eo(V,G,N,I){for(var q=0,oe=0;oe<N;oe++){var he=ie[G>>2],de=ie[G+4>>2];G+=8;for(var ve=0;ve<de;ve++)bo(V,Y[he+ve]);q+=de}return ie[I>>2]=q,0}function Aa(V){return V}function Do(V){var G=a["_"+V];return G}function Ji(V,G){z.set(V,G)}function Oo(V,G,N,I,q){var oe={string:tt=>{var Ct=0;if(tt!=null&&tt!==0){var xt=(tt.length<<2)+1;Ct=je(xt),F(tt,Ct,xt)}return Ct},array:tt=>{var Ct=je(tt.length);return Ji(tt,Ct),Ct}};function he(tt){return G==="string"?E(tt):G==="boolean"?!!tt:tt}var de=Do(V),ve=[],we=0;if(I)for(var Me=0;Me<I.length;Me++){var ke=oe[N[Me]];ke?(we===0&&(we=Ge()),ve[Me]=ke(I[Me])):ve[Me]=I[Me]}var Ze=de.apply(null,ve);function st(tt){return we!==0&&Pe(we),he(tt)}return Ze=st(Ze),Ze}yt=a.InternalError=Tt(Error,"InternalError"),Ti(),kr=a.BindingError=Tt(Error,"BindingError"),Sr(),co(),ui(),Oi=a.UnboundTypeError=Tt(Error,"UnboundTypeError"),mo();var Q={__assert_fail:Ye,__cxa_begin_catch:Fe,__cxa_end_catch:rt,__cxa_find_matching_catch_2:qt,__cxa_find_matching_catch_3:nn,__cxa_throw:Pt,__resumeException:wt,_embind_finalize_value_object:Ta,_embind_register_bigint:$i,_embind_register_bool:_a,_embind_register_class:po,_embind_register_class_constructor:Br,_embind_register_class_function:Da,_embind_register_emval:vo,_embind_register_float:ps,_embind_register_function:ds,_embind_register_integer:ms,_embind_register_memory_view:vs,_embind_register_std_string:ys,_embind_register_std_wstring:To,_embind_register_value_object:Ma,_embind_register_value_object_field:Cs,_embind_register_void:_o,_emval_decref:go,_emval_incref:Ts,_emval_take_value:_s,abort:Ss,emscripten_memcpy_big:bs,emscripten_resize_heap:La,fd_close:Yr,fd_seek:li,fd_write:Eo,invoke_i:Se,invoke_ii:pt,invoke_iii:He,invoke_iiii:le,invoke_v:X,invoke_vi:gt,invoke_viiii:Z,invoke_viiiiii:Ae,llvm_eh_typeid_for:Aa};De(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)};var ee=a._malloc=function(){return(ee=a._malloc=a.asm.malloc).apply(null,arguments)},pe=a._free=function(){return(pe=a._free=a.asm.free).apply(null,arguments)},Oe=a.___cxa_free_exception=function(){return(Oe=a.___cxa_free_exception=a.asm.__cxa_free_exception).apply(null,arguments)},Ie=a.___getTypeName=function(){return(Ie=a.___getTypeName=a.asm.__getTypeName).apply(null,arguments)};a.__embind_initialize_bindings=function(){return(a.__embind_initialize_bindings=a.asm._embind_initialize_bindings).apply(null,arguments)},a.___errno_location=function(){return(a.___errno_location=a.asm.__errno_location).apply(null,arguments)};var Be=a.setTempRet0=function(){return(Be=a.setTempRet0=a.asm.setTempRet0).apply(null,arguments)},Ge=a.stackSave=function(){return(Ge=a.stackSave=a.asm.stackSave).apply(null,arguments)},Pe=a.stackRestore=function(){return(Pe=a.stackRestore=a.asm.stackRestore).apply(null,arguments)},je=a.stackAlloc=function(){return(je=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)},Qe=a.___cxa_can_catch=function(){return(Qe=a.___cxa_can_catch=a.asm.__cxa_can_catch).apply(null,arguments)},ct=a.___cxa_is_pointer_type=function(){return(ct=a.___cxa_is_pointer_type=a.asm.__cxa_is_pointer_type).apply(null,arguments)};a.dynCall_ji=function(){return(a.dynCall_ji=a.asm.dynCall_ji).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.dynCall_iiji).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)};function pt(V,G){var N=Ge();try{return Xe(V)(G)}catch(I){if(Pe(N),I!==I+0)throw I;_setThrew(1,0)}}function gt(V,G){var N=Ge();try{Xe(V)(G)}catch(I){if(Pe(N),I!==I+0)throw I;_setThrew(1,0)}}function Z(V,G,N,I,q){var oe=Ge();try{Xe(V)(G,N,I,q)}catch(he){if(Pe(oe),he!==he+0)throw he;_setThrew(1,0)}}function X(V){var G=Ge();try{Xe(V)()}catch(N){if(Pe(G),N!==N+0)throw N;_setThrew(1,0)}}function le(V,G,N,I){var q=Ge();try{return Xe(V)(G,N,I)}catch(oe){if(Pe(q),oe!==oe+0)throw oe;_setThrew(1,0)}}function Se(V){var G=Ge();try{return Xe(V)()}catch(N){if(Pe(G),N!==N+0)throw N;_setThrew(1,0)}}function Ae(V,G,N,I,q,oe,he){var de=Ge();try{Xe(V)(G,N,I,q,oe,he)}catch(ve){if(Pe(de),ve!==ve+0)throw ve;_setThrew(1,0)}}function He(V,G,N){var I=Ge();try{return Xe(V)(G,N)}catch(q){if(Pe(I),q!==q+0)throw q;_setThrew(1,0)}}a.ccall=Oo;var We;H=function V(){We||Ve(),We||(H=V)};function Ve(V){if($>0||(Ce(),$>0))return;function G(){We||(We=!0,a.calledRun=!0,!_&&(P(),o(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),O()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),G()},1)):G()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Ve(),a.ready}})();t.exports=n}(ad)),ad.exports}var OH=DH();const RH=wa(OH),MH=new URL("/assets/openjphjs-C-BUUy4a.wasm",import.meta.url),Fu={codec:void 0,decoder:void 0,decodeConfig:{}};function NH(t,e,n){const r={width:e,height:n};for(;t>0;)r.width=Math.ceil(r.width/2),r.height=Math.ceil(r.height/2),t--;return r}function LH(t){if(Fu.decodeConfig=t,Fu.codec)return Promise.resolve();const e=RH({locateFile:n=>n.endsWith(".wasm")?MH.toString():n});return new Promise((n,r)=>{e.then(i=>{Fu.codec=i,Fu.decoder=new i.HTJ2KDecoder,n()},r)})}async function AH(t,e){await LH();const n=new Fu.codec.HTJ2KDecoder,r=n.getEncodedBuffer(t.length);r.set(t);const i=e.decodeLevel||0;n.decodeSubResolution(i);const a=n.getFrameInfo();if(e.decodeLevel>0){const{width:b,height:D}=NH(e.decodeLevel,a.width,a.height);a.width=b,a.height=D}const o=n.getDecodedBuffer();new Uint8Array(o.length).set(o);const c=`x: ${n.getImageOffset().x}, y: ${n.getImageOffset().y}`,l=n.getNumDecompositions(),f=n.getNumLayers(),u=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][n.getProgressionOrder()+1],h=n.getIsReversible(),p=`${n.getBlockDimensions().width} x ${n.getBlockDimensions().height}`,d=`${n.getTileSize().width} x ${n.getTileSize().height}`,g=`${n.getTileOffset().x}, ${n.getTileOffset().y}`,y=`${o.length.toLocaleString()} bytes`,x=`${(o.length/r.length).toFixed(2)}:1`,m={columns:a.width,rows:a.height,bitsPerPixel:a.bitsPerSample,signed:a.isSigned,bytesPerPixel:e.bytesPerPixel,componentsPerPixel:a.componentCount};let v=FH(a,o);const{buffer:w,byteOffset:C,byteLength:T}=v,_=w.slice(C,C+T);v=new v.constructor(_);const S={imageOffset:c,numDecompositions:l,numLayers:f,progessionOrder:u,reversible:h,blockDimensions:p,tileSize:d,tileOffset:g,decodedSize:y,compressionRatio:x};return{...e,pixelData:v,imageInfo:m,encodeOptions:S,...S,...m}}function FH(t,e){return t.bitsPerSample>8?t.isSigned?new Int16Array(e.buffer,e.byteOffset,e.byteLength/2):new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2):t.isSigned?new Int8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function IH(t,e){const n=t.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:a,doseGridScaling:o}=e;if(e.modality==="PT"&&typeof a=="number"&&!isNaN(a))for(let s=0;s<n;s++)t[s]=a*(t[s]*r+i);else if(e.modality==="RTDOSE"&&typeof o=="number"&&!isNaN(o))for(let s=0;s<n;s++)t[s]=t[s]*o;else for(let s=0;s<n;s++)t[s]=t[s]*r+i;return!0}const PH={bilinear:q$,replicate:X$},Xy={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};function VH(t,e,n,r){const i=t.pixelRepresentation!==void 0&&t.pixelRepresentation===1,a=i&&t.bitsStored!==void 0?32-t.bitsStored:void 0;if(i&&a!==void 0)for(let m=0;m<t.pixelData.length;m++)t.pixelData[m]=t.pixelData[m]<<a>>a;let o=t.pixelData;t.pixelDataLength=t.pixelData.length;const{min:s,max:c}=T2(t.pixelData),l=typeof e.allowFloatRendering<"u"?e.allowFloatRendering:!0;let f=Ww(t.photometricInterpretation)&&e.targetBuffer?.offset===void 0;const h=e.preScale?.enabled&&Object.values(e.preScale.scalingParameters).some(m=>typeof m=="number"&&!Number.isInteger(m)),p=!e.preScale.enabled||!l&&h,d=e.targetBuffer?.type;if(d&&e.preScale.enabled&&!p){const m=e.preScale.scalingParameters,v=hg(s,c,m);f=!B$(v.min,v.max,Xy[d])}d&&!f?o=UH(e,t,Xy,o):e.preScale.enabled&&!p?o=BH(e,s,c,t):o=Hw(s,c,t);let g=s,y=c;if(e.preScale.enabled&&!p){const m=e.preScale.scalingParameters;if(Kw(m),kH(m)){IH(o,m),t.preScale={...e.preScale,scaled:!0};const w=hg(s,c,m);g=w.min,y=w.max}}else p&&(t.preScale={enabled:!0,scaled:!1},g=s,y=c);t.pixelData=o,t.smallestPixelValue=g,t.largestPixelValue=y;const x=new Date().getTime();return t.decodeTimeInMS=x-n,t}function kH(t){const{rescaleSlope:e,rescaleIntercept:n,modality:r,doseGridScaling:i,suvbw:a}=t;return typeof e=="number"&&typeof n=="number"||r==="RTDOSE"&&typeof i=="number"||r==="PT"&&typeof a=="number"}function UH(t,e,n,r){const{arrayBuffer:i,type:a,offset:o=0,length:s,rows:c}=t.targetBuffer,l=n[a];if(!l)throw new Error(`target array ${a} is not supported, or doesn't exist.`);c&&c!=e.rows&&WH(e,t.targetBuffer,l);const f=e.pixelDataLength,u=o,h=s??f-u,p=e.pixelData;if(h!==p.length)throw new Error(`target array for image does not have the same length (${h}) as the decoded image length (${p.length}).`);const d=i?new l(i,u,h):new l(h);return d.set(p,0),r=d,r}function BH(t,e,n,r){const i=t.preScale.scalingParameters;Kw(i);const a=hg(e,n,i);return Hw(a.min,a.max,r)}function Hw(t,e,n){const r=_2(t,e),i=new r(n.pixelData.length);return i.set(n.pixelData,0),i}function hg(t,e,n){const{rescaleSlope:r,rescaleIntercept:i,modality:a,doseGridScaling:o,suvbw:s}=n;return a==="PT"&&typeof s=="number"&&!isNaN(s)?{min:s*(t*r+i),max:s*(e*r+i)}:a==="RTDOSE"&&typeof o=="number"&&!isNaN(o)?{min:t*o,max:e*o}:typeof r=="number"&&typeof i=="number"?{min:r*t+i,max:r*e+i}:{min:t,max:e}}function Kw(t){if(!t)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function GH(t,e,n){const{samplesPerPixel:r}=t,{rows:i,columns:a}=e,o=i*a*r,s=new n(o),c=s.byteLength/o;return{pixelData:s,rows:i,columns:a,frameInfo:{...t.frameInfo,rows:i,columns:a},imageInfo:{...t.imageInfo,rows:i,columns:a,bytesPerPixel:c}}}function WH(t,e,n){const r=GH(t,e,n),{scalingType:i="replicate"}=e;return PH[i](t,r),Object.assign(t,r),t.pixelDataLength=t.pixelData.length,t}async function zH(t,e,n,r,i,a){const o=new Date().getTime();let s=null,c;switch(e){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":s=By(t,n);break;case"1.2.840.10008.1.2.2":s=J$(t,n);break;case"1.2.840.10008.1.2.1.99":s=By(t,n);break;case"1.2.840.10008.1.2.5":s=Z$(t,n);break;case"1.2.840.10008.1.2.4.50":c={...t},s=sH(n,c);break;case"1.2.840.10008.1.2.4.51":s=hH(t,n);break;case"1.2.840.10008.1.2.4.57":s=zy(t,n);break;case"1.2.840.10008.1.2.4.70":s=zy(t,n);break;case"1.2.840.10008.1.2.4.80":c={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=$y(n,c);break;case"1.2.840.10008.1.2.4.81":c={signed:t.pixelRepresentation===1,bytesPerPixel:t.bitsAllocated<=8?1:2,...t},s=$y(n,c);break;case"1.2.840.10008.1.2.4.90":c={...t},s=Ky(n,c);break;case"1.2.840.10008.1.2.4.91":c={...t},s=Ky(n,c);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":c={...t},s=AH(n,c);break;default:throw new Error(`no decoder for transfer syntax ${e}`)}if(!s)throw new Error("decodePromise not defined");const l=await s,f=VH(l,i,o);return a?.(f),f}const jH={decodeTask({imageFrame:t,transferSyntax:e,decodeConfig:n,options:r,pixelData:i,callbackFn:a}){return zH(t,e,i,n,r,a)}};Fg(jH);const $H={__name:"DICOMViewer",setup(t){const e=NC(null);return _5(async()=>{(void 0).cornerstone=jj,(void 0).dicomParser=Qj,j1("wadouri",K$.loadImage);const n=e.value;if(!n)return;const r="basicRenderingEngine",i="basicViewport",a=new A9(r);a.enableElement({viewportId:i,element:n,type:"STACK"});const o=a.getViewport(i),s=["wadouri:https://example-orthanc-server/dicom-web/wado?requestType=WADO&studyUID=1.2.3&seriesUID=4.5.6&objectUID=7.8.9"];await ro(s[0]),o.setStack({imageIds:s,currentImageIdIndex:0}),o.render()}),(n,r)=>(W5(),z5("div",{ref_key:"viewport",ref:e,class:"w-[512px] h-[512px] bg-black"},null,512))}},HH={class:"flex items-center justify-center min-h-screen bg-gray-100"},KH=KC({__name:"App",setup(t){return(e,n)=>(W5(),z5("div",HH,[Jo($H)]))}}),qH=x7(KH);qH.mount("#app");
//# sourceMappingURL=index-WyZa0pYP.js.map
